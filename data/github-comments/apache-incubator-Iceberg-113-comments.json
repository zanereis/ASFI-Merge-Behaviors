[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923052042","html_url":"https://github.com/apache/iceberg/pull/3040#issuecomment-923052042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3040","id":923052042,"node_id":"IC_kwDOCW7NX843BKgK","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T15:49:32Z","updated_at":"2021-09-20T15:49:32Z","author_association":"CONTRIBUTOR","body":"> @nastra, can you verify that the benchmarks still look good after the upgrade?\r\n\r\nsure thing. Will run benchmarks and update results here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923052042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923052661","html_url":"https://github.com/apache/iceberg/pull/3073#issuecomment-923052661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3073","id":923052661,"node_id":"IC_kwDOCW7NX843BKp1","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T15:50:22Z","updated_at":"2021-09-20T15:50:22Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for updating this, @WinkerDu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923052661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923055190","html_url":"https://github.com/apache/iceberg/issues/3157#issuecomment-923055190","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3157","id":923055190,"node_id":"IC_kwDOCW7NX843BLRW","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T15:53:36Z","updated_at":"2021-09-20T15:53:36Z","author_association":"MEMBER","body":"Writing the 10M row files\r\n![image](https://user-images.githubusercontent.com/413025/134033547-3196c53d-4d92-492c-b659-ba8753bfcc45.png)\r\nFor some reason on my machine this writes 10 files even though NUM_FILES is set to 5","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923055190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923091186","html_url":"https://github.com/apache/iceberg/issues/3146#issuecomment-923091186","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3146","id":923091186,"node_id":"IC_kwDOCW7NX843BUDy","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T16:36:52Z","updated_at":"2021-09-20T16:36:52Z","author_association":"CONTRIBUTOR","body":"Maybe order of the jars in the classpath is different. Is there another iceberg jar on the classpath?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923091186/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923099516","html_url":"https://github.com/apache/iceberg/pull/2957#issuecomment-923099516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2957","id":923099516,"node_id":"IC_kwDOCW7NX843BWF8","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T16:48:23Z","updated_at":"2021-09-20T16:48:23Z","author_association":"CONTRIBUTOR","body":"@nastra I think we do want to have very defined behavior and easy customization to the builder, that's why I avoid using builder classes like the one you shared.\r\n\r\n@rdblue this makes sense, I will update this based on your suggestion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923099516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923100808","html_url":"https://github.com/apache/iceberg/pull/3158#issuecomment-923100808","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3158","id":923100808,"node_id":"IC_kwDOCW7NX843BWaI","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T16:50:09Z","updated_at":"2021-09-20T16:50:09Z","author_association":"CONTRIBUTOR","body":"cc @openinx @stevenzwu @RussellSpitzer @rdblue @kbendick @karuppayya @flyrain @pvary @jackye1995 @yyanyy @szehon-ho @rymurr @jun-he","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923100808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923106782","html_url":"https://github.com/apache/iceberg/issues/2991#issuecomment-923106782","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2991","id":923106782,"node_id":"IC_kwDOCW7NX843BX3e","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T16:58:32Z","updated_at":"2021-09-20T16:58:32Z","author_association":"CONTRIBUTOR","body":"@alex-shchetkov @fcvr1010 sorry I was sick out last few days, thanks for the detailed investigations! It's true that it always creates temp file with prefix `s3fileio`, but I think we should not depend on that behavior. There seem to be 2 issues at the same time, where (1) something is wrong with EMR Spark temp directory, and (2) the program should not hang when this happens. Let me pull in a few EMR Spark folks for this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923106782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923113121","html_url":"https://github.com/apache/iceberg/issues/3131#issuecomment-923113121","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3131","id":923113121,"node_id":"IC_kwDOCW7NX843BZah","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T17:06:19Z","updated_at":"2021-09-20T17:06:19Z","author_association":"CONTRIBUTOR","body":"Looks like you dowloaded the bin and configured it to execute against a cluster. You need to make sure you have the Iceberg related jars in all the spark nodes, not just in the Spark SQL client.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923113121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923123762","html_url":"https://github.com/apache/iceberg/pull/3123#issuecomment-923123762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3123","id":923123762,"node_id":"IC_kwDOCW7NX843BcAy","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T17:18:54Z","updated_at":"2021-09-20T17:18:54Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923123762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923141488","html_url":"https://github.com/apache/iceberg/pull/3040#issuecomment-923141488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3040","id":923141488,"node_id":"IC_kwDOCW7NX843BgVw","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T17:45:25Z","updated_at":"2021-09-20T17:45:25Z","author_association":"CONTRIBUTOR","body":"@rdblue benchmark results seem to be fine. \r\n\r\n\r\n# Results on this branch\r\n```\r\nBenchmark                                                                 Mode  Cnt  Score   Error  Units\r\nVectorizedReadFlatParquetDataBenchmark.readDatesIcebergVectorized5k         ss    5  2.045 ± 0.041   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDatesSparkVectorized5k           ss    5  1.529 ± 0.052   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsIcebergVectorized5k      ss    5  9.216 ± 0.174   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsSparkVectorized5k        ss    5  8.018 ± 0.305   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesIcebergVectorized5k       ss    5  2.585 ± 0.132   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesSparkVectorized5k         ss    5  2.764 ± 0.339   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsIcebergVectorized5k        ss    5  2.808 ± 0.263   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsSparkVectorized5k          ss    5  2.304 ± 0.157   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersIcebergVectorized5k      ss    5  2.733 ± 0.109   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersSparkVectorized5k        ss    5  2.588 ± 0.155   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsIcebergVectorized5k         ss    5  2.479 ± 0.042   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsSparkVectorized5k           ss    5  2.621 ± 0.182   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsIcebergVectorized5k       ss    5  4.674 ± 0.137   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsSparkVectorized5k         ss    5  4.041 ± 0.249   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsIcebergVectorized5k    ss    5  1.945 ± 0.079   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsSparkVectorized5k      ss    5  1.572 ± 0.075   s/op\r\n```\r\n\r\n# Results on `master` (copied from https://github.com/apache/iceberg/pull/3023)\r\n```\r\nBenchmark                                                                 Mode  Cnt  Score   Error  Units\r\nVectorizedReadFlatParquetDataBenchmark.readDatesIcebergVectorized5k         ss    5  1.587 ± 0.106   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDatesSparkVectorized5k           ss    5  1.515 ± 0.061   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsIcebergVectorized5k      ss    5  9.324 ± 0.511   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsSparkVectorized5k        ss    5  7.987 ± 0.164   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesIcebergVectorized5k       ss    5  2.829 ± 0.239   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesSparkVectorized5k         ss    5  2.381 ± 0.142   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsIcebergVectorized5k        ss    5  2.399 ± 0.088   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsSparkVectorized5k          ss    5  2.584 ± 0.230   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersIcebergVectorized5k      ss    5  2.664 ± 0.083   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersSparkVectorized5k        ss    5  2.535 ± 0.090   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsIcebergVectorized5k         ss    5  2.740 ± 0.171   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsSparkVectorized5k           ss    5  2.255 ± 0.128   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsIcebergVectorized5k       ss    5  4.803 ± 0.142   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsSparkVectorized5k         ss    5  4.326 ± 0.286   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsIcebergVectorized5k    ss    5  1.946 ± 0.152   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsSparkVectorized5k      ss    5  1.551 ± 0.042   s/op\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923141488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923142292","html_url":"https://github.com/apache/iceberg/issues/757#issuecomment-923142292","issue_url":"https://api.github.com/repos/apache/iceberg/issues/757","id":923142292,"node_id":"IC_kwDOCW7NX843BgiU","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T17:46:33Z","updated_at":"2021-09-20T17:46:33Z","author_association":"CONTRIBUTOR","body":"@nssalian would definitely be great if you can pick this up! Let me know if you need any help","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923142292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923146888","html_url":"https://github.com/apache/iceberg/issues/757#issuecomment-923146888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/757","id":923146888,"node_id":"IC_kwDOCW7NX843BhqI","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T17:53:03Z","updated_at":"2021-09-20T17:53:03Z","author_association":"CONTRIBUTOR","body":"Thanks @jackye1995. I'll post back if I have questions. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923146888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923153441","html_url":"https://github.com/apache/iceberg/pull/3040#issuecomment-923153441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3040","id":923153441,"node_id":"IC_kwDOCW7NX843BjQh","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T18:02:26Z","updated_at":"2021-09-20T18:02:26Z","author_association":"CONTRIBUTOR","body":"It looks like `readDatesIcebergVectorized5k` takes 30% longer? And it looks like the difference between `readFloatsIcebergVectorized5k` is just outside where the error ranges overlap.\r\n\r\nAlso, what about `VectorizedReadDictionaryEncodedFlatParquetDataBenchmark`? Is that the one you were having trouble running?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923153441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923154932","html_url":"https://github.com/apache/iceberg/pull/3078#issuecomment-923154932","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3078","id":923154932,"node_id":"IC_kwDOCW7NX843Bjn0","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T18:04:12Z","updated_at":"2021-09-20T18:04:12Z","author_association":"CONTRIBUTOR","body":"@dungdm93 we enabled CI, but it seems like there's a style error.\r\n\r\nCould you rebase off of the latest master (so as to pick up changes to the test suite that were causing timeouts and to pick up reduced logging verbosity)?\r\n\r\nYou can run the following, assuming that the upstream repo (the Apache repo) has been set and named as `upstream`. Sometimes people might name it `apache` also. You can check via `git remote -v`.\r\n\r\n```bash\r\n$ git checkout master\r\n$ git pull upstream master --rebase\r\n$ git checkout jdbc-catalog-user\r\n$ git rebase -i master  # Then type `:wq` to keep all your commit messages, but rebase onto the updated master branch\r\n$ git push --force\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923154932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923156100","html_url":"https://github.com/apache/iceberg/pull/3024#issuecomment-923156100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3024","id":923156100,"node_id":"IC_kwDOCW7NX843Bj6E","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T18:05:38Z","updated_at":"2021-09-20T18:05:38Z","author_association":"CONTRIBUTOR","body":"Can you describe in more detail what this is changing? It isn't clear from the description what is \"expected\".","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923156100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923169841","html_url":"https://github.com/apache/iceberg/pull/2953#issuecomment-923169841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2953","id":923169841,"node_id":"IC_kwDOCW7NX843BnQx","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T18:23:06Z","updated_at":"2021-09-20T18:23:06Z","author_association":"MEMBER","body":"@rdblue patched up, I think I got that covered. Should be set now. I also removed that private function as recommended","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923169841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923186892","html_url":"https://github.com/apache/iceberg/pull/1744#issuecomment-923186892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1744","id":923186892,"node_id":"IC_kwDOCW7NX843BrbM","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T18:48:18Z","updated_at":"2021-09-20T18:48:18Z","author_association":"MEMBER","body":"Fixing with #2953","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923186892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923196969","html_url":"https://github.com/apache/iceberg/issues/757#issuecomment-923196969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/757","id":923196969,"node_id":"IC_kwDOCW7NX843Bt4p","user":{"login":"BACtaki","id":7691755,"node_id":"MDQ6VXNlcjc2OTE3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/7691755?v=4","gravatar_id":"","url":"https://api.github.com/users/BACtaki","html_url":"https://github.com/BACtaki","followers_url":"https://api.github.com/users/BACtaki/followers","following_url":"https://api.github.com/users/BACtaki/following{/other_user}","gists_url":"https://api.github.com/users/BACtaki/gists{/gist_id}","starred_url":"https://api.github.com/users/BACtaki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BACtaki/subscriptions","organizations_url":"https://api.github.com/users/BACtaki/orgs","repos_url":"https://api.github.com/users/BACtaki/repos","events_url":"https://api.github.com/users/BACtaki/events{/privacy}","received_events_url":"https://api.github.com/users/BACtaki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T19:03:11Z","updated_at":"2021-09-20T19:03:11Z","author_association":"NONE","body":"Hi @nssalian, I was working on this a while back but I got sidetracked. I have created a PR with my changes [here](https://github.com/apache/iceberg/pull/3159), please feel free to take it from there and merge it in when you are ready (and after reviews).\r\n\r\n@RussellSpitzer @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923196969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923202470","html_url":"https://github.com/apache/iceberg/pull/3158#issuecomment-923202470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3158","id":923202470,"node_id":"IC_kwDOCW7NX843BvOm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T19:09:34Z","updated_at":"2021-09-20T19:09:34Z","author_association":"CONTRIBUTOR","body":"Looks good to me. I had a couple comments, but nothing blocking.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923202470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923209381","html_url":"https://github.com/apache/iceberg/pull/3154#issuecomment-923209381","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3154","id":923209381,"node_id":"IC_kwDOCW7NX843Bw6l","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T19:19:01Z","updated_at":"2021-09-20T19:19:01Z","author_association":"CONTRIBUTOR","body":"+1 for what @rdblue says, I think just for backwards compatibility it's better to not change existing log levels. Users can always configure to ignore this in the log4j config.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923209381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923239137","html_url":"https://github.com/apache/iceberg/pull/3152#issuecomment-923239137","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3152","id":923239137,"node_id":"IC_kwDOCW7NX843B4Lh","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T19:41:25Z","updated_at":"2021-09-20T19:41:25Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for reviewing, @kbendick and @jackye1995!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923239137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923243388","html_url":"https://github.com/apache/iceberg/pull/3094#issuecomment-923243388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3094","id":923243388,"node_id":"IC_kwDOCW7NX843B5N8","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T19:48:15Z","updated_at":"2021-09-20T19:48:15Z","author_association":"CONTRIBUTOR","body":"Looks like the change that defaulted object storage tables to the folder-storage path has not been released yet: https://github.com/apache/iceberg/commit/aef12c0e702ef8c306826581893963e3dc5f6ba3\r\n\r\n@flyrain and @jackye1995, how about simplifying this by only using `write.data.path` and removing the use of `write.folder-storage.path` from the object store location provider? That simplifies the documentation and makes it easier to understand.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923243388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923253801","html_url":"https://github.com/apache/iceberg/pull/3135#issuecomment-923253801","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3135","id":923253801,"node_id":"IC_kwDOCW7NX843B7wp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T20:03:39Z","updated_at":"2021-09-20T20:03:39Z","author_association":"CONTRIBUTOR","body":"Thanks, @xloya! The implementation looks correct to me, but there are a few things to fix in the tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923253801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923318367","html_url":"https://github.com/apache/iceberg/pull/3094#issuecomment-923318367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3094","id":923318367,"node_id":"IC_kwDOCW7NX843CLhf","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T21:16:46Z","updated_at":"2021-09-20T21:20:25Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue, I like your idea to simplify the logic, but as @jackye1995 mentioned, the logic to use write.folder-storage.path in the object store location provider was introduced by #2845, which has been released in 0.12.0. #2965 is a PR to just change the constant name.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923318367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923370214","html_url":"https://github.com/apache/iceberg/issues/3142#issuecomment-923370214","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3142","id":923370214,"node_id":"IC_kwDOCW7NX843CYLm","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T22:09:38Z","updated_at":"2021-09-20T22:09:38Z","author_association":"CONTRIBUTOR","body":"There is an [open issue](https://github.com/apache/iceberg/issues/1617) to add support for relative paths in table metadata to make relocating tables easier. There is also a [design doc](https://docs.google.com/document/d/1RDEjJAVEXg1csRzyzTuM634L88vvI0iDHNQQK3kOVR0/edit#heading=h.hxmtkjthp8hm) if you are interested.\r\n\r\nUnfortunately, until this support is added, you will have to rewrite the metadata files to reflect the new paths after moving your data. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923370214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923374158","html_url":"https://github.com/apache/iceberg/pull/3158#issuecomment-923374158","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3158","id":923374158,"node_id":"IC_kwDOCW7NX843CZJO","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-20T22:13:59Z","updated_at":"2021-09-20T22:13:59Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923374158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923508735","html_url":"https://github.com/apache/iceberg/pull/3069#issuecomment-923508735","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3069","id":923508735,"node_id":"IC_kwDOCW7NX843C5__","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T01:42:24Z","updated_at":"2021-09-21T01:42:24Z","author_association":"CONTRIBUTOR","body":"Ready for another round.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923508735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923599313","html_url":"https://github.com/apache/iceberg/pull/3154#issuecomment-923599313","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3154","id":923599313,"node_id":"IC_kwDOCW7NX843DQHR","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T03:52:33Z","updated_at":"2021-09-21T03:52:33Z","author_association":"CONTRIBUTOR","body":"> +1 for what @rdblue says, I think just for backwards compatibility it's better to not change existing log levels. Users can always configure to ignore this in the log4j config.\r\n\r\n+1 to what both Ryan and Jack said. These are very often the logs that people quote when reporting issues. And relative to the frequency with which frameworks log (Spark, etc), the logging amount here is pretty minimal. If it's not possible to suppress these specific log lines via the Log4j configuration, possibly we could move them to come from their own class that could then be suppressed... but I think lowering their level globally is probably not the best approach.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923599313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923603971","html_url":"https://github.com/apache/iceberg/issues/2028#issuecomment-923603971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2028","id":923603971,"node_id":"IC_kwDOCW7NX843DRQD","user":{"login":"tuziling","id":55190938,"node_id":"MDQ6VXNlcjU1MTkwOTM4","avatar_url":"https://avatars.githubusercontent.com/u/55190938?v=4","gravatar_id":"","url":"https://api.github.com/users/tuziling","html_url":"https://github.com/tuziling","followers_url":"https://api.github.com/users/tuziling/followers","following_url":"https://api.github.com/users/tuziling/following{/other_user}","gists_url":"https://api.github.com/users/tuziling/gists{/gist_id}","starred_url":"https://api.github.com/users/tuziling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tuziling/subscriptions","organizations_url":"https://api.github.com/users/tuziling/orgs","repos_url":"https://api.github.com/users/tuziling/repos","events_url":"https://api.github.com/users/tuziling/events{/privacy}","received_events_url":"https://api.github.com/users/tuziling/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T04:05:14Z","updated_at":"2021-09-21T04:05:14Z","author_association":"NONE","body":"After writing the data to iceberg, use RowKind.DELETE to delete, use flink to read iceberg in real time and report an error. The log information is as follows:\r\n```\r\nException in thread \"main\" java.util.concurrent.ExecutionException: org.apache.flink.runtime.client.JobExecutionException: Job execution failed.\r\n\tat java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:395)\r\n\tat java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1999)\r\n\tat org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.execute(StreamExecutionEnvironment.java:1719)\r\n\tat org.apache.flink.streaming.api.environment.LocalStreamEnvironment.execute(LocalStreamEnvironment.java:74)\r\n\tat org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.execute(StreamExecutionEnvironment.java:1699)\r\n\tat com.kingsoft.data.read.StreamingRead.main(StreamingRead.java:59)\r\nCaused by: org.apache.flink.runtime.client.JobExecutionException: Job execution failed.\r\n\tat org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:147)\r\n\tat org.apache.flink.client.program.PerJobMiniClusterFactory$PerJobMiniClusterJobClient.lambda$getJobExecutionResult$2(PerJobMiniClusterFactory.java:186)\r\n\tat java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:642)\r\n\tat java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)\r\n\tat java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073)\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaInvocationHandler.lambda$invokeRpc$0(AkkaInvocationHandler.java:229)\r\n\tat java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)\r\n\tat java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)\r\n\tat java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)\r\n\tat java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073)\r\n\tat org.apache.flink.runtime.concurrent.FutureUtils$1.onComplete(FutureUtils.java:892)\r\n\tat akka.dispatch.OnComplete.internal(Future.scala:264)\r\n\tat akka.dispatch.OnComplete.internal(Future.scala:261)\r\n\tat akka.dispatch.japi$CallbackBridge.apply(Future.scala:191)\r\n\tat akka.dispatch.japi$CallbackBridge.apply(Future.scala:188)\r\n\tat scala.concurrent.impl.CallbackRunnable.run$$$capture(Promise.scala:60)\r\n\tat scala.concurrent.impl.CallbackRunnable.run(Promise.scala)\r\n\tat org.apache.flink.runtime.concurrent.Executors$DirectExecutionContext.execute(Executors.java:74)\r\n\tat scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:68)\r\n\tat scala.concurrent.impl.Promise$DefaultPromise.$anonfun$tryComplete$1(Promise.scala:284)\r\n\tat scala.concurrent.impl.Promise$DefaultPromise.$anonfun$tryComplete$1$adapted(Promise.scala:284)\r\n\tat scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:284)\r\n\tat akka.pattern.PromiseActorRef.$bang(AskSupport.scala:573)\r\n\tat akka.pattern.PipeToSupport$PipeableFuture$$anonfun$pipeTo$1.applyOrElse(PipeToSupport.scala:22)\r\n\tat akka.pattern.PipeToSupport$PipeableFuture$$anonfun$pipeTo$1.applyOrElse(PipeToSupport.scala:21)\r\n\tat scala.concurrent.Future.$anonfun$andThen$1(Future.scala:532)\r\n\tat scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:29)\r\n\tat scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:29)\r\n\tat scala.concurrent.impl.CallbackRunnable.run$$$capture(Promise.scala:60)\r\n\tat scala.concurrent.impl.CallbackRunnable.run(Promise.scala)\r\n\tat akka.dispatch.BatchingExecutor$AbstractBatch.processBatch(BatchingExecutor.scala:55)\r\n\tat akka.dispatch.BatchingExecutor$BlockableBatch.$anonfun$run$1(BatchingExecutor.scala:91)\r\n\tat scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)\r\n\tat scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:81)\r\n\tat akka.dispatch.BatchingExecutor$BlockableBatch.run(BatchingExecutor.scala:91)\r\n\tat akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:40)\r\n\tat akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(ForkJoinExecutorConfigurator.scala:44)\r\n\tat akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)\r\n\tat akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)\r\n\tat akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)\r\n\tat akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)\r\nCaused by: org.apache.flink.runtime.JobException: Recovery is suppressed by NoRestartBackoffTimeStrategy\r\n\tat org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:116)\r\n\tat org.apache.flink.runtime.executiongraph.failover.flip1.ExecutionFailureHandler.getFailureHandlingResult(ExecutionFailureHandler.java:78)\r\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.handleTaskFailure(DefaultScheduler.java:192)\r\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.maybeHandleTaskFailure(DefaultScheduler.java:185)\r\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.updateTaskExecutionStateInternal(DefaultScheduler.java:179)\r\n\tat org.apache.flink.runtime.scheduler.SchedulerBase.updateTaskExecutionState(SchedulerBase.java:503)\r\n\tat org.apache.flink.runtime.jobmaster.JobMaster.updateTaskExecutionState(JobMaster.java:386)\r\n\tat jdk.internal.reflect.GeneratedMethodAccessor17.invoke(Unknown Source)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcInvocation(AkkaRpcActor.java:284)\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleRpcMessage(AkkaRpcActor.java:199)\r\n\tat org.apache.flink.runtime.rpc.akka.FencedAkkaRpcActor.handleRpcMessage(FencedAkkaRpcActor.java:74)\r\n\tat org.apache.flink.runtime.rpc.akka.AkkaRpcActor.handleMessage(AkkaRpcActor.java:152)\r\n\tat akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:26)\r\n\tat akka.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:21)\r\n\tat scala.PartialFunction.applyOrElse(PartialFunction.scala:123)\r\n\tat scala.PartialFunction.applyOrElse$(PartialFunction.scala:122)\r\n\tat akka.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:21)\r\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:171)\r\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:172)\r\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:172)\r\n\tat akka.actor.Actor.aroundReceive(Actor.scala:517)\r\n\tat akka.actor.Actor.aroundReceive$(Actor.scala:515)\r\n\tat akka.actor.AbstractActor.aroundReceive(AbstractActor.scala:225)\r\n\tat akka.actor.ActorCell.receiveMessage(ActorCell.scala:592)\r\n\tat akka.actor.ActorCell.invoke(ActorCell.scala:561)\r\n\tat akka.dispatch.Mailbox.processMailbox(Mailbox.scala:258)\r\n\tat akka.dispatch.Mailbox.run(Mailbox.scala:225)\r\n\tat akka.dispatch.Mailbox.exec(Mailbox.scala:235)\r\n\t... 4 more\r\nCaused by: com.esotericsoftware.kryo.KryoException: java.lang.UnsupportedOperationException\r\nSerialization trace:\r\nnullValueCounts (org.apache.iceberg.GenericDataFile)\r\nfile (org.apache.iceberg.BaseFileScanTask)\r\nfileScanTask (org.apache.iceberg.BaseFileScanTask$SplitScanTask)\r\ntasks (org.apache.iceberg.BaseCombinedScanTask)\r\ntask (org.apache.iceberg.flink.source.FlinkInputSplit)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:125)\r\n\tat com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:106)\r\n\tat com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:106)\r\n\tat com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679)\r\n\tat com.esotericsoftware.kryo.serializers.DefaultArraySerializers$ObjectArraySerializer.read(DefaultArraySerializers.java:378)\r\n\tat com.esotericsoftware.kryo.serializers.DefaultArraySerializers$ObjectArraySerializer.read(DefaultArraySerializers.java:289)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:106)\r\n\tat com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:106)\r\n\tat com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:528)\r\n\tat com.esotericsoftware.kryo.Kryo.readClassAndObject(Kryo.java:761)\r\n\tat org.apache.flink.api.java.typeutils.runtime.kryo.KryoSerializer.deserialize(KryoSerializer.java:346)\r\n\tat org.apache.flink.streaming.runtime.streamrecord.StreamElementSerializer.deserialize(StreamElementSerializer.java:205)\r\n\tat org.apache.flink.streaming.runtime.streamrecord.StreamElementSerializer.deserialize(StreamElementSerializer.java:46)\r\n\tat org.apache.flink.runtime.plugable.NonReusingDeserializationDelegate.read(NonReusingDeserializationDelegate.java:55)\r\n\tat org.apache.flink.runtime.io.network.api.serialization.NonSpanningWrapper.readInto(NonSpanningWrapper.java:335)\r\n\tat org.apache.flink.runtime.io.network.api.serialization.SpillingAdaptiveSpanningRecordDeserializer.readNonSpanningRecord(SpillingAdaptiveSpanningRecordDeserializer.java:108)\r\n\tat org.apache.flink.runtime.io.network.api.serialization.SpillingAdaptiveSpanningRecordDeserializer.getNextRecord(SpillingAdaptiveSpanningRecordDeserializer.java:85)\r\n\tat org.apache.flink.streaming.runtime.io.StreamTaskNetworkInput.emitNext(StreamTaskNetworkInput.java:146)\r\n\tat org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:67)\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:345)\r\n\tat org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxStep(MailboxProcessor.java:191)\r\n\tat org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:181)\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:558)\r\n\tat org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:530)\r\n\tat org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:721)\r\n\tat org.apache.flink.runtime.taskmanager.Task.run(Task.java:546)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\nCaused by: java.lang.UnsupportedOperationException\r\n\tat java.base/java.util.Collections$UnmodifiableMap.put(Collections.java:1457)\r\n\tat com.esotericsoftware.kryo.serializers.MapSerializer.read(MapSerializer.java:144)\r\n\tat com.esotericsoftware.kryo.serializers.MapSerializer.read(MapSerializer.java:21)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:679)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:106)\r\n\t... 34 more\r\n```\r\nThe reading code is as follows:\r\n```\r\nimport org.apache.flink.streaming.api.datastream.DataStream;\r\nimport org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;\r\nimport org.apache.flink.table.data.RowData;\r\nimport org.apache.hadoop.conf.Configuration;\r\nimport org.apache.iceberg.catalog.TableIdentifier;\r\nimport org.apache.iceberg.flink.CatalogLoader;\r\nimport org.apache.iceberg.flink.TableLoader;\r\nimport org.apache.iceberg.flink.source.FlinkSource;\r\nimport org.slf4j.Logger;\r\nimport org.slf4j.LoggerFactory;\r\n\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class StreamingRead {\r\n    private static Logger log = LoggerFactory.getLogger(StreamingRead.class);\r\n\r\n    public static void main(String[] args) throws Exception{\r\n        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\r\n\r\n        String catalogName = \"songfuhao_catalog\";\r\n        Map<String,String> map = new HashMap<>();\r\n        map.put(\"warehouse\",\"s3://songfuhao-bucket/songfuhao\");\r\n        map.put(\"catalog-impl\",\"org.apache.iceberg.aws.glue.GlueCatalog\");\r\n        map.put(\"io-impl\",\"org.apache.iceberg.aws.s3.S3FileIO\");\r\n        map.put(\"lock-impl\",\"org.apache.iceberg.aws.glue.DynamoLockManager\");\r\n        map.put(\"lock.table\",\"myGlueLockTable\");\r\n\r\n        Configuration hadoopConf = new Configuration();\r\n        String impl = \"org.apache.iceberg.aws.glue.GlueCatalog\";\r\n        CatalogLoader tzlCatalog = CatalogLoader.custom(catalogName, map, hadoopConf, impl);\r\n        TableIdentifier identifier = TableIdentifier.of(\"songfh\", \"sfuhao_test\");\r\n        /*Catalog catalog = tzlCatalog.loadCatalog();\r\n        Table table = catalog.loadTable(identifier);\r\n        TableOperations operations = ((BaseTable) table).operations();\r\n        TableMetadata metadata = operations.current();\r\n        operations.commit(metadata, metadata.upgradeToFormatVersion(2));*/\r\n        TableLoader tableLoader = TableLoader.fromCatalog(tzlCatalog, identifier);\r\n\r\n\r\n        DataStream<RowData> stream = FlinkSource.forRowData()\r\n                .env(env)\r\n                .tableLoader(tableLoader)\r\n                .streaming(true)\r\n                .build();\r\n\r\n        stream.print();\r\n\r\n        env.execute(StreamingRead.class.getSimpleName());\r\n    }\r\n}\r\n```\r\nDo you know how to modify the data in iceberg to be read normally?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923603971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923604389","html_url":"https://github.com/apache/iceberg/pull/3160#issuecomment-923604389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3160","id":923604389,"node_id":"IC_kwDOCW7NX843DRWl","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T04:06:07Z","updated_at":"2021-09-21T04:06:07Z","author_association":"MEMBER","body":"All tests pass, looks good to merge. Thanks @williamhyun + @dongjoon-hyun ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923604389/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923610847","html_url":"https://github.com/apache/iceberg/pull/3160#issuecomment-923610847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3160","id":923610847,"node_id":"IC_kwDOCW7NX843DS7f","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T04:21:10Z","updated_at":"2021-09-21T04:21:10Z","author_association":"MEMBER","body":"Thank you so much, @RussellSpitzer .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923610847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923611185","html_url":"https://github.com/apache/iceberg/pull/3135#issuecomment-923611185","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3135","id":923611185,"node_id":"IC_kwDOCW7NX843DTAx","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T04:22:01Z","updated_at":"2021-09-21T04:23:19Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue for your particular review! I will fix them according to your suggestion these days","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923611185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923679424","html_url":"https://github.com/apache/iceberg/pull/3040#issuecomment-923679424","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3040","id":923679424,"node_id":"IC_kwDOCW7NX843DjrA","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T06:27:56Z","updated_at":"2021-09-21T06:27:56Z","author_association":"CONTRIBUTOR","body":"> Also, what about `VectorizedReadDictionaryEncodedFlatParquetDataBenchmark`? Is that the one you were having trouble running?\r\n\r\n`VectorizedReadDictionaryEncodedFlatParquetDataBenchmark` is currently not working and is being investigated in https://github.com/apache/iceberg/issues/3157\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923679424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923687747","html_url":"https://github.com/apache/iceberg/pull/3040#issuecomment-923687747","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3040","id":923687747,"node_id":"IC_kwDOCW7NX843DltD","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T06:44:46Z","updated_at":"2021-09-21T07:35:01Z","author_association":"CONTRIBUTOR","body":"> It looks like `readDatesIcebergVectorized5k` takes 30% longer? And it looks like the difference between `readFloatsIcebergVectorized5k` is just outside where the error ranges overlap.\r\n\r\nThe variability in the timings come from the fact because I was doing dev work while running those tests on my local machine. The other thing is that with `Mode.SingleShotTime` benchmarks we're effectively measuring the **cold** performance (we do 3 warmup iterations and 5 measurement iterations). Below is an excerpt from the Javadoc taken from [here](http://javadox.com/org.openjdk.jmh/jmh-core/0.8/org/openjdk/jmh/annotations/Mode.html#SingleShotTime):\r\n\r\n> Single shot time: measures the time for a single operation.\r\n\r\n> Runs by calling {@link Benchmark} once and measuring its time. This mode is useful to estimate the \"cold\" performance when > you don't want to hide the warmup invocations, or if you want to see the progress from call to call, or you want to record every > single sample. This mode is work-based, and will run only for a single invocation of {@link Benchmark} method.\r\n\r\n> Caveats for this mode include:\r\n\r\n> More warmup/measurement iterations are generally required.\r\n> Timers overhead might be significant if benchmarks are small; switch to {@link #SampleTime} mode if that is a problem.\r\n\r\nI also did another run on this branch and below are the new results:\r\n\r\n```\r\nBenchmark                                                                 Mode  Cnt  Score   Error  Units\r\nVectorizedReadFlatParquetDataBenchmark.readDatesIcebergVectorized5k         ss    5  1.870 ± 0.091   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDatesSparkVectorized5k           ss    5  1.511 ± 0.080   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsIcebergVectorized5k      ss    5  9.005 ± 0.539   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDecimalsSparkVectorized5k        ss    5  8.424 ± 0.462   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesIcebergVectorized5k       ss    5  2.829 ± 0.152   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readDoublesSparkVectorized5k         ss    5  2.385 ± 0.129   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsIcebergVectorized5k        ss    5  2.429 ± 0.120   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readFloatsSparkVectorized5k          ss    5  2.357 ± 0.125   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersIcebergVectorized5k      ss    5  2.434 ± 0.158   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readIntegersSparkVectorized5k        ss    5  2.587 ± 0.160   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsIcebergVectorized5k         ss    5  2.857 ± 0.138   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readLongsSparkVectorized5k           ss    5  2.638 ± 0.161   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsIcebergVectorized5k       ss    5  5.662 ± 0.411   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readStringsSparkVectorized5k         ss    5  4.693 ± 0.183   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsIcebergVectorized5k    ss    5  1.993 ± 0.139   s/op\r\nVectorizedReadFlatParquetDataBenchmark.readTimestampsSparkVectorized5k      ss    5  1.942 ± 0.053   s/op\r\n\r\n```\r\n[vectorized-read-flat-parquet-data-result-bump-arrow2.txt](https://github.com/apache/iceberg/files/7201221/vectorized-read-flat-parquet-data-result-bump-arrow2.txt)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923687747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923708877","html_url":"https://github.com/apache/iceberg/pull/3078#issuecomment-923708877","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3078","id":923708877,"node_id":"IC_kwDOCW7NX843Dq3N","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T07:20:06Z","updated_at":"2021-09-21T07:20:06Z","author_association":"CONTRIBUTOR","body":"If you can fix the style check and then move the utility function back into `JdbcUtil`, I'd be +1 on this @dungdm93  👍.\r\n\r\nThank you so much for the work you've put into this so far!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923708877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923754221","html_url":"https://github.com/apache/iceberg/pull/3024#issuecomment-923754221","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3024","id":923754221,"node_id":"IC_kwDOCW7NX843D17t","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T08:25:27Z","updated_at":"2021-09-21T08:25:27Z","author_association":"CONTRIBUTOR","body":"@rdblue I updated the PR description. Hope this makes it clearer as to what we're trying to achieve here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923754221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923813191","html_url":"https://github.com/apache/iceberg/pull/3155#issuecomment-923813191","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3155","id":923813191,"node_id":"IC_kwDOCW7NX843EEVH","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T09:44:28Z","updated_at":"2021-09-21T09:44:28Z","author_association":"CONTRIBUTOR","body":"LGTM, I'm okay with copying this over from Hive for the time being. Checkstyle errors need to be fixed though in the copied OrcSplit class.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923813191/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923828468","html_url":"https://github.com/apache/iceberg/pull/3155#issuecomment-923828468","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3155","id":923828468,"node_id":"IC_kwDOCW7NX843EID0","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T10:05:13Z","updated_at":"2021-09-21T10:05:13Z","author_association":"MEMBER","body":"> LGTM, I'm okay with copying this over from Hive for the time being. Checkstyle errors need to be fixed though in the copied OrcSplit class.\r\n\r\nThanks for the feedback. Sure, I will fix the Checkstyle errors and update the PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923828468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923870416","html_url":"https://github.com/apache/iceberg/pull/3155#issuecomment-923870416","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3155","id":923870416,"node_id":"IC_kwDOCW7NX843ESTQ","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T11:00:07Z","updated_at":"2021-09-21T11:00:07Z","author_association":"MEMBER","body":"@szlta Checkstyle should be fixed now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923870416/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923903738","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-923903738","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":923903738,"node_id":"IC_kwDOCW7NX843Eab6","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T11:47:09Z","updated_at":"2021-09-21T11:47:09Z","author_association":"CONTRIBUTOR","body":"For me if someone sets both `iceberg.catalog.<catalog_name>.type` and `iceberg.catalog.<catalog_name>.catalog-impl` is a wrong configuration. I think we should throw an exception instead of trying to define a precedence between the two.\r\n\r\nWhat do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923903738/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923970511","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-923970511","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":923970511,"node_id":"IC_kwDOCW7NX843EqvP","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T13:07:41Z","updated_at":"2021-09-21T13:07:41Z","author_association":"MEMBER","body":"> For me if someone sets both `iceberg.catalog.<catalog_name>.type` and `iceberg.catalog.<catalog_name>.catalog-impl` is a wrong configuration. I think we should throw an exception instead of trying to define a precedence between the two.\r\n> \r\n> What do you think?\r\n\r\nI thought about it for a bit and I think it is actually a good idea as well to throw an exception,  it has an advantage of being explicit to user and thus, the user is educated on how these config work.  I will update the logic shortly. Thanks for the feedback!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/923970511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924021085","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-924021085","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":924021085,"node_id":"IC_kwDOCW7NX843E3Fd","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T14:03:02Z","updated_at":"2021-09-21T14:03:02Z","author_association":"MEMBER","body":"@pvary I have changed the logic a bit to throw an exception instead. Please take a look at it and let me know what you think.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924021085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924039599","html_url":"https://github.com/apache/iceberg/pull/3161#issuecomment-924039599","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3161","id":924039599,"node_id":"IC_kwDOCW7NX843E7mv","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T14:23:06Z","updated_at":"2021-09-21T14:23:06Z","author_association":"CONTRIBUTOR","body":"@kbendick Hi thanks for the comment. Could you share what reasoning or timeline you are looking for?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924039599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924094892","html_url":"https://github.com/apache/iceberg/pull/2985#issuecomment-924094892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2985","id":924094892,"node_id":"IC_kwDOCW7NX843FJGs","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T15:22:17Z","updated_at":"2021-09-21T15:22:17Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @szehon-ho @rdblue @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924094892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924175450","html_url":"https://github.com/apache/iceberg/pull/3161#issuecomment-924175450","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3161","id":924175450,"node_id":"IC_kwDOCW7NX843Fcxa","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T16:56:59Z","updated_at":"2021-09-21T16:56:59Z","author_association":"CONTRIBUTOR","body":"> @kbendick Hi thanks for the comment. Could you share what reasoning or timeline you are looking for?\r\n\r\nHi @Terry93! First of all, thanks for fixing this. Definitely this should be fixed as well.\r\n\r\nAs to your questions, o be fully transparent I have not been able to make it to the Python refactor meetings that have happened so far. So I don't have an idea of an approximate timeline.\r\n\r\nAs for my reasoning, I was thinking it would be nice to have some sort of... I guess deprecation notice? But that could be getting a little further ahead of ourselves than we need to do (and the name sort of tells people its `legacy` / deprecated anyway).\r\n\r\nSo this is a good contribution. But it would be great if we could add more, possibly in a follow up, once there's more to add. Admittedly that time might not be now yet. 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924175450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924182776","html_url":"https://github.com/apache/iceberg/pull/3161#issuecomment-924182776","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3161","id":924182776,"node_id":"IC_kwDOCW7NX843Fej4","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T17:05:45Z","updated_at":"2021-09-21T17:05:45Z","author_association":"CONTRIBUTOR","body":"@kbendick appreciate for your transparency! However, I might not be the better person to do the follow up per your suggestion. For background, I am new to this project and I made this fix while I am trying to build the python project following the README, so I think I don't have much context about the details of deprecation. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924182776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924207210","html_url":"https://github.com/apache/iceberg/issues/757#issuecomment-924207210","issue_url":"https://api.github.com/repos/apache/iceberg/issues/757","id":924207210,"node_id":"IC_kwDOCW7NX843Fkhq","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T17:34:43Z","updated_at":"2021-09-21T17:34:43Z","author_association":"CONTRIBUTOR","body":"@BACtaki  I think you already did most/all of the work. Please go ahead. I can always pick up another issue. :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924207210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924208202","html_url":"https://github.com/apache/iceberg/issues/35#issuecomment-924208202","issue_url":"https://api.github.com/repos/apache/iceberg/issues/35","id":924208202,"node_id":"IC_kwDOCW7NX843FkxK","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T17:35:56Z","updated_at":"2021-09-21T17:35:56Z","author_association":"CONTRIBUTOR","body":"@rdblue , if no one else has picked this up, could I pick this up as a first issue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924208202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924214108","html_url":"https://github.com/apache/iceberg/issues/3070#issuecomment-924214108","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3070","id":924214108,"node_id":"IC_kwDOCW7NX843FmNc","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T17:43:15Z","updated_at":"2021-09-21T17:43:15Z","author_association":"CONTRIBUTOR","body":"I was mistaken. We don't allow setting both options. I don't know how I missed that!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924214108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924270962","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-924270962","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":924270962,"node_id":"IC_kwDOCW7NX843F0Fy","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T18:43:07Z","updated_at":"2021-09-21T18:43:07Z","author_association":"CONTRIBUTOR","body":"This brings up a larger issue (that is outside of the scope of this PR) that @kainoa21 ecently brought up recently on Slack and elsewhere, that we also experience when using `GlueCatalog` with Flink - that the custom catalog-impl's don't necessarily neatly fall into the `Hadoop` or `Hive` mindset.\r\n\r\nIn the case he brought up, he wanted to be able to use `GlueCatalog` in an AWS managed environment without having to have hadoop dependencies on the classpath. The only reason he needed them there was to satisfy some unused code constraints.\r\n\r\nHe felt that possibly it was a bit of a leaky abstraction in some places. His feeling was that maybe there should be a `GlueCatalogFileIO` or possibly even multiple possible `GlueCatalogFileIO` types - depending if one wanted to use Hive or not etc.\r\n\r\nAs this seems to be an offshoot of the same problem, tagging him and linking the issue for future reference: https://github.com/apache/iceberg/issues/3044\r\n\r\nThis is outside of the scope of this PR and I don't mean to block this PR, but this might be something we want to consider during V3 planning / as part of a larger scope of things as we do seem to be encountering some issues with what I'll call the `well known \"custom\" catalogs`? cc @rdblue (in case Jason doesn't come on Github as much) and @jackye1995 who was also working on this problem at the time.\r\n\r\nWe can continue this conversation elsewhere, sorry to thread-jack / PR-jack the discussion! \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924270962/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924309562","html_url":"https://github.com/apache/iceberg/pull/3161#issuecomment-924309562","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3161","id":924309562,"node_id":"IC_kwDOCW7NX843F9g6","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T19:17:29Z","updated_at":"2021-09-21T19:17:29Z","author_association":"CONTRIBUTOR","body":"@jun-he @danielcweeks One of us should take a crack at updating the legacy package docs with some info about where to contact the community and any links that show an updated status on the redesign effort.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924309562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924435749","html_url":"https://github.com/apache/iceberg/pull/3164#issuecomment-924435749","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3164","id":924435749,"node_id":"IC_kwDOCW7NX843GcUl","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-21T22:28:51Z","updated_at":"2021-09-21T22:28:51Z","author_association":"CONTRIBUTOR","body":"cc @openinx @stevenzwu @RussellSpitzer @rdblue @kbendick @karuppayya @flyrain @pvary @jackye1995 @yyanyy @szehon-ho @rymurr @jun-he","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924435749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924496172","html_url":"https://github.com/apache/iceberg/issues/3146#issuecomment-924496172","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3146","id":924496172,"node_id":"IC_kwDOCW7NX843GrEs","user":{"login":"Neo966","id":90825223,"node_id":"MDQ6VXNlcjkwODI1MjIz","avatar_url":"https://avatars.githubusercontent.com/u/90825223?v=4","gravatar_id":"","url":"https://api.github.com/users/Neo966","html_url":"https://github.com/Neo966","followers_url":"https://api.github.com/users/Neo966/followers","following_url":"https://api.github.com/users/Neo966/following{/other_user}","gists_url":"https://api.github.com/users/Neo966/gists{/gist_id}","starred_url":"https://api.github.com/users/Neo966/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Neo966/subscriptions","organizations_url":"https://api.github.com/users/Neo966/orgs","repos_url":"https://api.github.com/users/Neo966/repos","events_url":"https://api.github.com/users/Neo966/events{/privacy}","received_events_url":"https://api.github.com/users/Neo966/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T00:57:39Z","updated_at":"2021-09-22T00:57:39Z","author_association":"NONE","body":"no, only one jar.\r\n\r\nIt works, but does not support field filtering. throw exception: java.lang.NoSuchMethodError: org.apache.hadoop.hive.ql.io.sarg.ConvertAstToSearchArg.create(Lorg/apache/hadoop/conf/Configuration;Lorg/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc;)Lorg/apache/hadoop/hive/ql/io/sarg/SearchArgument;\r\n\r\nthe official website say support 2.x and 3.1.2 hive version, only 2.3.8 and 3.1.2 version was fully tested?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924496172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924520031","html_url":"https://github.com/apache/iceberg/issues/3147#issuecomment-924520031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3147","id":924520031,"node_id":"IC_kwDOCW7NX843Gw5f","user":{"login":"zaq1xsw2cde3vf","id":89570434,"node_id":"MDQ6VXNlcjg5NTcwNDM0","avatar_url":"https://avatars.githubusercontent.com/u/89570434?v=4","gravatar_id":"","url":"https://api.github.com/users/zaq1xsw2cde3vf","html_url":"https://github.com/zaq1xsw2cde3vf","followers_url":"https://api.github.com/users/zaq1xsw2cde3vf/followers","following_url":"https://api.github.com/users/zaq1xsw2cde3vf/following{/other_user}","gists_url":"https://api.github.com/users/zaq1xsw2cde3vf/gists{/gist_id}","starred_url":"https://api.github.com/users/zaq1xsw2cde3vf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zaq1xsw2cde3vf/subscriptions","organizations_url":"https://api.github.com/users/zaq1xsw2cde3vf/orgs","repos_url":"https://api.github.com/users/zaq1xsw2cde3vf/repos","events_url":"https://api.github.com/users/zaq1xsw2cde3vf/events{/privacy}","received_events_url":"https://api.github.com/users/zaq1xsw2cde3vf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T02:00:27Z","updated_at":"2021-09-22T02:00:27Z","author_association":"NONE","body":"> There is a different version of Caffeine included in HDP Hive and Iceberg.\r\n> \r\n> We fixed it in the Hive code:\r\n> https://issues.apache.org/jira/browse/HIVE-25201\r\n\r\nIf I can't change any thing on hive, what things I can do to run iceberg 0.12 with Hive 3.1 ?  Thanks for any advices!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924520031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924525134","html_url":"https://github.com/apache/iceberg/issues/3139#issuecomment-924525134","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3139","id":924525134,"node_id":"IC_kwDOCW7NX843GyJO","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T02:12:30Z","updated_at":"2021-09-22T02:12:30Z","author_association":"MEMBER","body":"Interesting ,  thanks for the report @lirui-apache ,  would you like to propose a PR for this bug ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924525134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924529203","html_url":"https://github.com/apache/iceberg/pull/3085#issuecomment-924529203","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3085","id":924529203,"node_id":"IC_kwDOCW7NX843GzIz","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T02:22:54Z","updated_at":"2021-09-22T02:22:54Z","author_association":"MEMBER","body":"Get this merged, thanks @stevenzwu & @jackye1995 for reviewing !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924529203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924565407","html_url":"https://github.com/apache/iceberg/issues/3129#issuecomment-924565407","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3129","id":924565407,"node_id":"IC_kwDOCW7NX843G7-f","user":{"login":"massquantity","id":28751760,"node_id":"MDQ6VXNlcjI4NzUxNzYw","avatar_url":"https://avatars.githubusercontent.com/u/28751760?v=4","gravatar_id":"","url":"https://api.github.com/users/massquantity","html_url":"https://github.com/massquantity","followers_url":"https://api.github.com/users/massquantity/followers","following_url":"https://api.github.com/users/massquantity/following{/other_user}","gists_url":"https://api.github.com/users/massquantity/gists{/gist_id}","starred_url":"https://api.github.com/users/massquantity/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massquantity/subscriptions","organizations_url":"https://api.github.com/users/massquantity/orgs","repos_url":"https://api.github.com/users/massquantity/repos","events_url":"https://api.github.com/users/massquantity/events{/privacy}","received_events_url":"https://api.github.com/users/massquantity/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T04:07:17Z","updated_at":"2021-09-22T04:07:17Z","author_association":"NONE","body":"Maybe you should turn on checkpoint in Flink? See this issue:  https://github.com/apache/iceberg/issues/2693","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924565407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924583557","html_url":"https://github.com/apache/iceberg/issues/3146#issuecomment-924583557","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3146","id":924583557,"node_id":"IC_kwDOCW7NX843HAaF","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T04:56:40Z","updated_at":"2021-09-22T04:56:40Z","author_association":"CONTRIBUTOR","body":"\r\n\r\n> the official website say support 2.x and 3.1.2 hive version, only 2.3.8 and 3.1.2 version was fully tested?\r\n\r\nThose are the versions that the unit tests are run. \r\nMaybe we should clarify in the doc. Good point! \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924583557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924584934","html_url":"https://github.com/apache/iceberg/issues/3147#issuecomment-924584934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3147","id":924584934,"node_id":"IC_kwDOCW7NX843HAvm","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T05:00:27Z","updated_at":"2021-09-22T05:00:27Z","author_association":"CONTRIBUTOR","body":"> If I can't change any thing on hive, what things I can do to run iceberg 0.12 with Hive 3.1 ? Thanks for any advices!\r\n\r\nYou can use the Apache Hive 3.1.2 version, or you can ask your vendor about the possibilities. I know that Cloudera is working on integrating Iceberg to the CDP stack, which might be useful for you. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924584934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924595298","html_url":"https://github.com/apache/iceberg/issues/3147#issuecomment-924595298","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3147","id":924595298,"node_id":"IC_kwDOCW7NX843HDRi","user":{"login":"zaq1xsw2cde3vf","id":89570434,"node_id":"MDQ6VXNlcjg5NTcwNDM0","avatar_url":"https://avatars.githubusercontent.com/u/89570434?v=4","gravatar_id":"","url":"https://api.github.com/users/zaq1xsw2cde3vf","html_url":"https://github.com/zaq1xsw2cde3vf","followers_url":"https://api.github.com/users/zaq1xsw2cde3vf/followers","following_url":"https://api.github.com/users/zaq1xsw2cde3vf/following{/other_user}","gists_url":"https://api.github.com/users/zaq1xsw2cde3vf/gists{/gist_id}","starred_url":"https://api.github.com/users/zaq1xsw2cde3vf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zaq1xsw2cde3vf/subscriptions","organizations_url":"https://api.github.com/users/zaq1xsw2cde3vf/orgs","repos_url":"https://api.github.com/users/zaq1xsw2cde3vf/repos","events_url":"https://api.github.com/users/zaq1xsw2cde3vf/events{/privacy}","received_events_url":"https://api.github.com/users/zaq1xsw2cde3vf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T05:19:16Z","updated_at":"2021-09-22T05:19:16Z","author_association":"NONE","body":"> > If I can't change any thing on hive, what things I can do to run iceberg 0.12 with Hive 3.1 ? Thanks for any advices!\r\n> \r\n> You can use the Apache Hive 3.1.2 version, or you can ask your vendor about the possibilities. I know that Cloudera is working on integrating Iceberg to the CDP stack, which might be useful for you.\r\n\r\nThanks for your help!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924595298/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924613301","html_url":"https://github.com/apache/iceberg/pull/3161#issuecomment-924613301","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3161","id":924613301,"node_id":"IC_kwDOCW7NX843HHq1","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T06:04:40Z","updated_at":"2021-09-22T06:04:40Z","author_association":"CONTRIBUTOR","body":"I think the following should be done:\r\n1. add a link to the roadmap section that is currently being added for Python dev effort #3163 \r\n2. separate java and python documentations into 2 separated tabs, and add some explanations there for legacy and new python module\r\n3. in the community section, add a section for different slack channels, google groups, community sync note links, so that people can find python specific contact information.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924613301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924621782","html_url":"https://github.com/apache/iceberg/pull/3130#issuecomment-924621782","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3130","id":924621782,"node_id":"IC_kwDOCW7NX843HJvW","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T06:20:55Z","updated_at":"2021-09-22T06:20:55Z","author_association":"NONE","body":"thanks @coolderli , First of all, I agree with you.\r\nBut the calculation method of watermark is a combination of in-parallel and between-parallel. So if the iceberg-core is modified to support, will be more difficult.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924621782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924624133","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-924624133","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":924624133,"node_id":"IC_kwDOCW7NX843HKUF","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T06:25:51Z","updated_at":"2021-09-22T06:25:51Z","author_association":"CONTRIBUTOR","body":"I also agree that this should throw an exception instead of setting null. Could you update the title to reflect that?\r\n\r\nI think we should also do a similar check in Spark and Flink code path to make sure we do not have the same issue, could you also add those checks?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924624133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924629441","html_url":"https://github.com/apache/iceberg/pull/3094#issuecomment-924629441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3094","id":924629441,"node_id":"IC_kwDOCW7NX843HLnB","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T06:36:22Z","updated_at":"2021-09-22T06:36:22Z","author_association":"CONTRIBUTOR","body":"@rdblue @flyrain \r\n\r\nI think if 1.0.0 is the next release, what @rdblue proposes is definitely the right approach to go, and we have also a way out for users of 0.12.0, which is great.\r\n\r\nIf we are still thinking about 0.13.0, we need to just be more cautious, because these config keys will be there all the time, I think it's better to keep the resolution strategy. We decided to merge #2845 mostly because services try to hide the table's root location, but the object storage mode forces user to configure a location that the user might not know. Chaining the fallback config key seems to be the only way out for the 2 use cases described here: https://github.com/apache/iceberg/pull/2845#issuecomment-897900861","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924629441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924646575","html_url":"https://github.com/apache/iceberg/pull/3099#issuecomment-924646575","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3099","id":924646575,"node_id":"IC_kwDOCW7NX843HPyv","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T07:05:50Z","updated_at":"2021-09-22T07:05:50Z","author_association":"CONTRIBUTOR","body":"1. the title does not include the fact that we are switching to use `RetryingMetaStoreClient`, can we add that information in the title?\r\n2. I have not checked yet, but you mentioned about the fact that some configs can be used for both Iceberg and non-Iceberg tables. Does that mean on Iceberg side some properties has to be re-mapped back to Hive configs after the switch?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924646575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924712667","html_url":"https://github.com/apache/iceberg/pull/3116#issuecomment-924712667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3116","id":924712667,"node_id":"IC_kwDOCW7NX843Hf7b","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T08:40:44Z","updated_at":"2021-09-22T08:40:44Z","author_association":"MEMBER","body":"@kbendick @Flyangz According to the last discussion from [mail list ](https://lists.apache.org/x/thread.html/r2b93b991efb7a584438ffda8d29c1dc6de27ec8fc3293636aeb1b092@%3Cdev.iceberg.apache.org%3E),   I think we'd better to keep the same strategy as the apache spark plan to do,  users from apache iceberg community also proposed to support both flink 1.12 & flink 1.13.  Since the difference between flink 1.12 & 1.13 is not so large,  I think it's possible to support both of them in the single flink module ( I mean we don't need to separate them into two different modules).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924712667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924824787","html_url":"https://github.com/apache/iceberg/pull/3162#issuecomment-924824787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3162","id":924824787,"node_id":"IC_kwDOCW7NX843H7TT","user":{"login":"omarsmak","id":1190920,"node_id":"MDQ6VXNlcjExOTA5MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1190920?v=4","gravatar_id":"","url":"https://api.github.com/users/omarsmak","html_url":"https://github.com/omarsmak","followers_url":"https://api.github.com/users/omarsmak/followers","following_url":"https://api.github.com/users/omarsmak/following{/other_user}","gists_url":"https://api.github.com/users/omarsmak/gists{/gist_id}","starred_url":"https://api.github.com/users/omarsmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omarsmak/subscriptions","organizations_url":"https://api.github.com/users/omarsmak/orgs","repos_url":"https://api.github.com/users/omarsmak/repos","events_url":"https://api.github.com/users/omarsmak/events{/privacy}","received_events_url":"https://api.github.com/users/omarsmak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T11:04:25Z","updated_at":"2021-09-22T11:04:25Z","author_association":"MEMBER","body":"> I also agree that this should throw an exception instead of setting null. Could you update the title to reflect that?\r\n> \r\n> I think we should also do a similar check in Spark and Flink code path to make sure we do not have the same issue, could you also add those checks?\r\n\r\nI could do that, but would it make sense to keep this PR focused on Hive and raise a new one for Spark and Flink?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924824787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924865487","html_url":"https://github.com/apache/iceberg/pull/3120#issuecomment-924865487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3120","id":924865487,"node_id":"IC_kwDOCW7NX843IFPP","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T12:04:56Z","updated_at":"2021-09-22T12:04:56Z","author_association":"CONTRIBUTOR","body":"I have been make the parallelize in configurable and let it run in a separate thread pool. \r\nCould you help review this PR again? @rdblue @stevenzwu @kbendick @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/924865487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925099414","html_url":"https://github.com/apache/iceberg/pull/3164#issuecomment-925099414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3164","id":925099414,"node_id":"IC_kwDOCW7NX843I-WW","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T16:41:36Z","updated_at":"2021-09-22T16:41:36Z","author_association":"CONTRIBUTOR","body":"I went ahead and added benchmarks to this PR.\r\n\r\n```\r\nBenchmark                                                                Mode  Cnt   Score   Error  Units\r\nParquetWritersBenchmark.writePartitionedClusteredDataWriter                ss    5  10.076 ± 0.261   s/op\r\nParquetWritersBenchmark.writePartitionedLegacyDataWriter                   ss    5  10.124 ± 0.500   s/op\r\n\r\nParquetWritersBenchmark.writePartitionedFanoutDataWriter                   ss    5  10.082 ± 0.371   s/op\r\nParquetWritersBenchmark.writePartitionedLegacyFanoutDataWriter             ss    5   9.971 ± 0.322   s/op\r\n\r\nParquetWritersBenchmark.writeUnpartitionedClusteredDataWriter              ss    5   9.075 ± 0.458   s/op\r\nParquetWritersBenchmark.writeUnpartitionedLegacyDataWriter                 ss    5   8.981 ± 0.292   s/op\r\n\r\nParquetWritersBenchmark.writePartitionedClusteredEqualityDeleteWriter      ss    5  10.136 ± 0.389   s/op\r\nParquetWritersBenchmark.writeUnpartitionedClusteredPositionDeleteWriter    ss    5   7.462 ± 0.690   s/op\r\n```\r\n```\r\nBenchmark                                                             Mode  Cnt   Score   Error  Units\r\nAvroWritersBenchmark.writePartitionedClusteredDataWriter                ss    5  11.114 ± 0.108   s/op\r\nAvroWritersBenchmark.writePartitionedLegacyDataWriter                   ss    5  11.094 ± 0.422   s/op\r\n\r\nAvroWritersBenchmark.writePartitionedFanoutDataWriter                   ss    5  11.223 ± 0.316   s/op\r\nAvroWritersBenchmark.writePartitionedLegacyFanoutDataWriter             ss    5  11.029 ± 0.283   s/op\r\n\r\nAvroWritersBenchmark.writeUnpartitionedClusteredDataWriter              ss    5  10.716 ± 0.295   s/op\r\nAvroWritersBenchmark.writeUnpartitionedLegacyDataWriter                 ss    5  10.602 ± 0.509   s/op\r\n\r\nAvroWritersBenchmark.writePartitionedClusteredEqualityDeleteWriter      ss    5  10.115 ± 0.215   s/op\r\nAvroWritersBenchmark.writeUnpartitionedClusteredPositionDeleteWriter    ss    5   7.447 ± 0.526   s/op\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925099414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925128401","html_url":"https://github.com/apache/iceberg/issues/757#issuecomment-925128401","issue_url":"https://api.github.com/repos/apache/iceberg/issues/757","id":925128401,"node_id":"IC_kwDOCW7NX843JFbR","user":{"login":"BACtaki","id":7691755,"node_id":"MDQ6VXNlcjc2OTE3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/7691755?v=4","gravatar_id":"","url":"https://api.github.com/users/BACtaki","html_url":"https://github.com/BACtaki","followers_url":"https://api.github.com/users/BACtaki/followers","following_url":"https://api.github.com/users/BACtaki/following{/other_user}","gists_url":"https://api.github.com/users/BACtaki/gists{/gist_id}","starred_url":"https://api.github.com/users/BACtaki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BACtaki/subscriptions","organizations_url":"https://api.github.com/users/BACtaki/orgs","repos_url":"https://api.github.com/users/BACtaki/repos","events_url":"https://api.github.com/users/BACtaki/events{/privacy}","received_events_url":"https://api.github.com/users/BACtaki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T17:21:22Z","updated_at":"2021-09-22T17:21:22Z","author_association":"NONE","body":"@nssalian Sounds good, thanks for understanding and apologies for the confusion! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925128401/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925130578","html_url":"https://github.com/apache/iceberg/pull/3015#issuecomment-925130578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3015","id":925130578,"node_id":"IC_kwDOCW7NX843JF9S","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T17:24:14Z","updated_at":"2021-09-22T17:24:14Z","author_association":"COLLABORATOR","body":"@rdblue , thanks for taking a look at it, I moved the field to be before the partition data, if you want to take another look.  \r\n\r\nAlso note, I had to fix a test that was depending on getting a specific index from files table, so if users have this use-case they will break as well, but I suppose we can add to release notes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925130578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925143406","html_url":"https://github.com/apache/iceberg/pull/3163#issuecomment-925143406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3163","id":925143406,"node_id":"IC_kwDOCW7NX843JJFu","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T17:42:23Z","updated_at":"2021-09-22T17:42:23Z","author_association":"CONTRIBUTOR","body":"Thanks for adding this, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925143406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925151641","html_url":"https://github.com/apache/iceberg/pull/3161#issuecomment-925151641","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3161","id":925151641,"node_id":"IC_kwDOCW7NX843JLGZ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T17:53:51Z","updated_at":"2021-09-22T17:53:51Z","author_association":"CONTRIBUTOR","body":"Running CI, but I think we can merge this. This change is clearly correct. We can document the Python refactor separately.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925151641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925170386","html_url":"https://github.com/apache/iceberg/pull/3094#issuecomment-925170386","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3094","id":925170386,"node_id":"IC_kwDOCW7NX843JPrS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T18:17:23Z","updated_at":"2021-09-22T18:17:23Z","author_association":"CONTRIBUTOR","body":"I don't think that we shouldn't make a breaking behavior change at 1.0. It isn't important enough to clean this up to warrant a breaking change. Let's just continue with the released behavior as a fallback.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925170386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925171908","html_url":"https://github.com/apache/iceberg/pull/3094#issuecomment-925171908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3094","id":925171908,"node_id":"IC_kwDOCW7NX843JQDE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T18:18:58Z","updated_at":"2021-09-22T18:18:58Z","author_association":"CONTRIBUTOR","body":"Thanks, @flyrain!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925171908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925194146","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-925194146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":925194146,"node_id":"IC_kwDOCW7NX843JVei","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T18:40:52Z","updated_at":"2021-09-22T18:40:52Z","author_association":"CONTRIBUTOR","body":"@rdblue, when you have the time, this is ready for another review. I believe I have incorporated all your feedback. I have incorporated your proposed change (after some refactoring) to the spark `Reader` to configure a base `TableScan` on construction, and let the `TableScan` get the schema for the snapshot; as well as the other suggestions. I also fixed a bug with my last change to `BaseTableScan#useSnapshot`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925194146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925206854","html_url":"https://github.com/apache/iceberg/pull/3094#issuecomment-925206854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3094","id":925206854,"node_id":"IC_kwDOCW7NX843JYlG","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T18:51:40Z","updated_at":"2021-09-22T18:51:40Z","author_association":"CONTRIBUTOR","body":"Thanks all for the review and commit. @rdblue @jackye1995 @kbendick @karuppayya @jun-he. \r\nHi @anuragmantri, fyi, this will affect the relative path design a bit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925206854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925233392","html_url":"https://github.com/apache/iceberg/pull/2925#issuecomment-925233392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2925","id":925233392,"node_id":"IC_kwDOCW7NX843JfDw","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T19:11:20Z","updated_at":"2021-09-22T19:11:20Z","author_association":"COLLABORATOR","body":"@rdblue  thanks for the suggestions.  I put validate-from-snapshot as a SparkWriteOption, and added a Spark level test for it based on it, if you want to take another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925233392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925266292","html_url":"https://github.com/apache/iceberg/issues/1617#issuecomment-925266292","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1617","id":925266292,"node_id":"IC_kwDOCW7NX843JnF0","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T19:38:04Z","updated_at":"2021-09-22T19:38:04Z","author_association":"CONTRIBUTOR","body":"The [design doc](https://docs.google.com/document/d/1RDEjJAVEXg1csRzyzTuM634L88vvI0iDHNQQK3kOVR0/edit#heading=h.hxmtkjthp8hm) has been updated to add initial support for relative paths and multiple root locations for a table. Please review the design.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925266292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925322089","html_url":"https://github.com/apache/iceberg/issues/35#issuecomment-925322089","issue_url":"https://api.github.com/repos/apache/iceberg/issues/35","id":925322089,"node_id":"IC_kwDOCW7NX843J0tp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T20:53:59Z","updated_at":"2021-09-22T20:53:59Z","author_association":"CONTRIBUTOR","body":"@nssalian, thanks for volunteering! I think that this one is already done, though. I should have closed it. (Thanks for pointing it out @waterlx!)\r\n\r\nI think there are other good first issues though!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925322089/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925325588","html_url":"https://github.com/apache/iceberg/issues/905#issuecomment-925325588","issue_url":"https://api.github.com/repos/apache/iceberg/issues/905","id":925325588,"node_id":"IC_kwDOCW7NX843J1kU","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T20:59:39Z","updated_at":"2021-09-26T19:49:03Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi  / @rdblue can I pick this up if no one is working on it already?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925325588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925357611","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-925357611","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":925357611,"node_id":"IC_kwDOCW7NX843J9Yr","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T21:53:34Z","updated_at":"2021-09-22T23:10:06Z","author_association":"CONTRIBUTOR","body":"Hi @prodeezy @hankfanchiu , sorry for the delay in getting back to you on this. I was looking into a different parquet issue,[ PARQUET-2078](https://issues.apache.org/jira/browse/PARQUET-2078) so my apologies for overlooking this one.\r\n\r\nI'm also able to reproduce this using Spark 3.1.2 with Iceberg 0.9.0 (compile only paquet@1.11.0) to Iceberg 0.11.0 (compile only parquet@1.11.1).\r\n\r\nI get the same error\r\n```\r\njava.lang.IllegalArgumentException: [mapCol, key_value, key] required binary key (STRING) = 2 is not in the store: [] 12\r\n\tat org.apache.iceberg.shaded.org.apache.parquet.hadoop.ColumnChunkPageReadStore.getPageReader(ColumnChunkPageReadStore.java:231)\r\n\tat org.apache.iceberg.parquet.ParquetValueReaders$PrimitiveReader.setPageSource(ParquetValueReaders.java:154)\r\n\tat org.apache.iceberg.parquet.ParquetValueReaders$RepeatedKeyValueReader.setPageSource(ParquetValueReaders.java:487)\r\n\tat org.apache.iceberg.parquet.ParquetValueReaders$StructReader.setPageSource(ParquetValueReaders.java:643)\r\n\tat org.apache.iceberg.parquet.ParquetReader$FileIterator.advance(ParquetReader.java:139)\r\n\tat org.apache.iceberg.parquet.ParquetReader$FileIterator.next(ParquetReader.java:110)\r\n\tat org.apache.iceberg.spark.source.BaseDataReader.next(BaseDataReader.java:69)\r\n\tat org.apache.spark.sql.execution.datasources.v2.PartitionIterator.hasNext(DataSourceRDD.scala:79)\r\n\tat org.apache.spark.sql.execution.datasources.v2.MetricsIterator.hasNext(DataSourceRDD.scala:112)\r\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\r\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:458)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:345)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\nHere's my minimal reproduction:\r\n\r\nI downloaded the Spark tarball for 3.1.2 from https://archive.apache.org/dist/spark/spark-3.1.2/spark-3.1.2-bin-hadoop2.7.tgz, untarred it, and created a test table similar to yours.\r\n\r\n**Notice that by default, OSS Spark comes with parquet-1.10.1, so I removed the parquet jars from /opt/spark/jars, however we use a shaded parquet version so it shouldn't (and doesn't) matter**. I tested it with and without the OSS parquet jars in /opt/spark/jars.\r\n```bash\r\nroot@spark:/opt/spark# ls -la jars | grep parquet\r\nparquet-column-1.10.1.jar  parquet-common-1.10.1.jar  parquet-encoding-1.10.1.jar  parquet-format-2.4.0.jar  parquet-hadoop-1.10.1.jar  parquet-jackson-1.10.1.jar\r\n\r\nroot@spark:/opt/spark# rm -f jars/parquet-*\r\n\r\nroot@spark-box:/opt/spark# ./bin/spark-shell  \\ \r\n    --packages org.apache.iceberg:iceberg-spark3-runtime:0.9.0   \\\r\n    --driver-memory 2g  \\ \r\n    --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog  \\\r\n     --conf spark.sql.catalog.spark_catalog.type=hive  \\\r\n     --conf spark.hadoop.hive.metastore.uris=thrift://hive:9083\r\n```\r\n\r\n```scala\r\nscala>  import spark.implicits._\r\nimport spark.implicits._\r\n\r\nscala> import org.apache.spark.sql._\r\nimport org.apache.spark.sql._\r\n\r\nscala> import org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.functions._\r\n\r\nscala> import org.apache.spark.sql.expressions._\r\nimport org.apache.spark.sql.expressions._\r\n\r\nscala>  spark.sql(\"CREATE TABLE IF NOT EXISTS test_parquet_map_regression_iceberg_090(mapCol MAP<STRING, STRUCT<payload: STRUCT<bool: BOOLEAN, dbl: DOUBLE, str: STRING>, str: STRING>>) USING ICEBERG TBLPROPERTIES('type'='hive')\")\r\n\r\nscala> :paste\r\n// Entering paste mode (ctrl-D to finish)\r\n\r\n    var df = spark.range(NUM_ROWS)\r\n      .withColumnRenamed(\"id\", \"longCol\")\r\n      .withColumn(\"intCol\", expr(\"CAST(longCol AS INT)\"))\r\n      .withColumn(\"dbl\", expr(\"CAST(longCol AS DOUBLE)\"))\r\n      .withColumn(\"str\", expr(\"CAST(longCol AS STRING)\"))\r\n      .withColumn(\"bool\", expr(\"IF(intCol % 2 = 0, true, false)\"))\r\n      .withColumn(\"payload\", struct($\"bool\", $\"dbl\", $\"str\"))\r\n      .withColumn(\"value\", struct($\"payload\", $\"str\"))\r\n      .withColumn(\"mapCol\", map($\"str\", $\"value\"))\r\n      .select(\"mapCol\")\r\n\r\n// Exiting paste mode, now interpreting.\r\n\r\ndf: org.apache.spark.sql.DataFrame = [mapCol: map<string,struct<payload:struct<bool:boolean,dbl:double,str:string>,str:string>>]\r\n\r\nscala> df.writeTo(\"default.test_parquet_map_regression_iceberg_090\").append\r\n\r\nscala>  spark.table(\"default.test_parquet_map_regression_iceberg_090\").show(false)\r\n+-------------------------------+\r\n|mapCol                         |\r\n+-------------------------------+\r\n|{0 -> {{true, 0.0, 0}, 0}}     |\r\n|{1 -> {{false, 1.0, 1}, 1}}    |\r\n|{2 -> {{true, 2.0, 2}, 2}}     |\r\n|{3 -> {{false, 3.0, 3}, 3}}    |\r\n|{4 -> {{true, 4.0, 4}, 4}}     |\r\n|{5 -> {{false, 5.0, 5}, 5}}    |\r\n|{6 -> {{true, 6.0, 6}, 6}}     |\r\n|{7 -> {{false, 7.0, 7}, 7}}    |\r\n|{8 -> {{true, 8.0, 8}, 8}}     |\r\n|{9 -> {{false, 9.0, 9}, 9}}    |\r\n|{10 -> {{true, 10.0, 10}, 10}} |\r\n|{11 -> {{false, 11.0, 11}, 11}}|\r\n|{12 -> {{true, 12.0, 12}, 12}} |\r\n|{13 -> {{false, 13.0, 13}, 13}}|\r\n|{14 -> {{true, 14.0, 14}, 14}} |\r\n|{15 -> {{false, 15.0, 15}, 15}}|\r\n|{16 -> {{true, 16.0, 16}, 16}} |\r\n|{17 -> {{false, 17.0, 17}, 17}}|\r\n|{18 -> {{true, 18.0, 18}, 18}} |\r\n|{19 -> {{false, 19.0, 19}, 19}}|\r\n+-------------------------------+\r\nonly showing top 20 rows\r\n\r\nscala> :quit\r\n```\r\n\r\nI then upgraded from Iceberg 0.9.0 (compiled against Parquet 0.11.0) to Iceberg 0.10.0 (compiled against Parquet 0.11.1)\r\n\r\nFirst, I tried writing a new table (to ensure that data is working when using the new format).\r\n```bash\r\nroot@spark-box:/opt/spark#  ./bin/spark-shell     --packages org.apache.iceberg:iceberg-spark3-runtime:0.10.0    --driver-memory 2g     --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog     --conf spark.sql.catalog.spark_catalog.type=hive      --conf spark.hadoop.hive.metastore.uris=thrift://hive-box:9083\r\n```\r\n\r\nFirst, I tried writing a new table (to ensure that data is working when using the new format).\r\n```scala\r\nscala>  spark.sql(\"CREATE TABLE IF NOT EXISTS test_parquet_map_regression_iceberg_010(mapCol MAP<STRING, STRUCT<payload: STRUCT<bool: BOOLEAN, dbl: DOUBLE, str: STRING>, str: STRING>>) USING ICEBERG TBLPROPERTIES('type'='hive')\")\r\n\r\n... create df as above ....\r\n\r\nscala> spark.table(\"default.test_parquet_map_regression_iceberg_010\").show(false)\r\n+-------------------------------+\r\n|mapCol                         |\r\n+-------------------------------+\r\n|{0 -> {{true, 0.0, 0}, 0}}     |\r\n|{1 -> {{false, 1.0, 1}, 1}}    |\r\n|{2 -> {{true, 2.0, 2}, 2}}     |\r\n|{3 -> {{false, 3.0, 3}, 3}}    |\r\n|{4 -> {{true, 4.0, 4}, 4}}     |\r\n|{5 -> {{false, 5.0, 5}, 5}}    |\r\n|{6 -> {{true, 6.0, 6}, 6}}     |\r\n|{7 -> {{false, 7.0, 7}, 7}}    |\r\n|{8 -> {{true, 8.0, 8}, 8}}     |\r\n|{9 -> {{false, 9.0, 9}, 9}}    |\r\n|{10 -> {{true, 10.0, 10}, 10}} |\r\n|{11 -> {{false, 11.0, 11}, 11}}|\r\n|{12 -> {{true, 12.0, 12}, 12}} |\r\n|{13 -> {{false, 13.0, 13}, 13}}|\r\n|{14 -> {{true, 14.0, 14}, 14}} |\r\n|{15 -> {{false, 15.0, 15}, 15}}|\r\n|{16 -> {{true, 16.0, 16}, 16}} |\r\n|{17 -> {{false, 17.0, 17}, 17}}|\r\n|{18 -> {{true, 18.0, 18}, 18}} |\r\n|{19 -> {{false, 19.0, 19}, 19}}|\r\n+-------------------------------+\r\nonly showing top 20 rows\r\n```\r\n\r\nSo Parquet 1.11.1 data can be written and then read.\r\n\r\nHowever, the older data written with Parquet 1.11.0 cannot be read on the newer Iceberg version.\r\n\r\n```scala\r\nscala> spark.table(\"default.test_parquet_map_regression_iceberg_090\").show(false)\r\n21/09/22 21:49:24 ERROR executor.Executor: Exception in task 0.0 in stage 2.0 (TID 2)\r\njava.lang.IllegalArgumentException: [mapCol, map, key] required binary key (STRING) = 2 is not in the store: [] 12\r\n\tat org.apache.iceberg.shaded.org.apache.parquet.hadoop.ColumnChunkPageReadStore.getPageReader(ColumnChunkPageReadStore.java:231)\r\n\tat org.apache.iceberg.parquet.ParquetValueReaders$PrimitiveReader.setPageSource(ParquetValueReaders.java:185)\r\n\tat org.apache.iceberg.parquet.ParquetValueReaders$RepeatedKeyValueReader.setPageSource(ParquetValueReaders.java:529)\r\n\tat org.apache.iceberg.parquet.ParquetValueReaders$StructReader.setPageSource(ParquetValueReaders.java:685)\r\n\tat org.apache.iceberg.parquet.ParquetReader$FileIterator.advance(ParquetReader.java:142)\r\n\tat org.apache.iceberg.parquet.ParquetReader$FileIterator.next(ParquetReader.java:112)\r\n\tat org.apache.iceberg.spark.source.BaseDataReader.next(BaseDataReader.java:81)\r\n\tat org.apache.spark.sql.execution.datasources.v2.PartitionIterator.hasNext(DataSourceRDD.scala:79)\r\n\tat org.apache.spark.sql.execution.datasources.v2.MetricsIterator.hasNext(DataSourceRDD.scala:112)\r\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\r\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:458)\r\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\r\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\r\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anon$1.hasNext(WholeStageCodegenExec.scala:755)\r\n\tat org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:345)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\nSo this issue has actually been present for this particular map data since Iceberg 0.9.1 -> Iceberg 0.10.0 Upgrade (which is when we went from Parquet 1.11.0 -> Parquet 1.11.1).\r\n\r\nWe should investigate with Iceberg 0.12.0 now that that is out. I will do that now.\r\n\r\nI'm also going to check to see if this issue affects OSS Spark and not just Iceberg (I suspect that it does not as Spark 3.1.2 is still on Parquet 1.10.2 but will double check).\r\n\r\ncc @rdblue \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925357611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925362178","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-925362178","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":925362178,"node_id":"IC_kwDOCW7NX843J-gC","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T22:02:36Z","updated_at":"2021-09-22T23:18:19Z","author_association":"CONTRIBUTOR","body":"**When running this with Iceberg 0.12.0, _all of the tables are readable_:**\r\n - tables written with Iceberg 0.9.0 ;  verified using Parquet 1.11.0 from the file header\r\n - tables written with Iceberg 0.10.0;  verified using Parquet 1.11.1 from the file header.\r\n - tables Witten with Iceberg 0.12.0;  verified using Parquet 1.12.0 from the file header.\r\n\r\nWhen running it with Iceberg 0.11.0, the issue shows and data generated with Parquet 1.11.0 is not readable.\r\n\r\n```\r\nroot@spark:/opt/spark# ./bin/spark-shell  \\\r\n  --packages org.apache.iceberg:iceberg-spark3-runtime:0.12.0  \\\r\n  --driver-memory 2g  \\\r\n  --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog  \\\r\n  --conf spark.sql.catalog.spark_catalog.type=hive  \\\r\n  --conf spark.hadoop.hive.metastore.uris=thrift://hive:9083\r\n:: loading settings :: url = jar:file:/opt/spark/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml\r\nIvy Default Cache set to: /root/.ivy2/cache\r\nThe jars for the packages stored in: /root/.ivy2/jars\r\norg.apache.iceberg#iceberg-spark3-runtime added as a dependency\r\n:: resolving dependencies :: org.apache.spark#spark-submit-parent-7a1b923a-77d9-455b-b946-72100bf36f6c;1.0\r\n\tconfs: [default]\r\n\tfound org.apache.iceberg#iceberg-spark3-runtime;0.12.0 in central\r\n:: resolution report :: resolve 144ms :: artifacts dl 2ms\r\n\t:: modules in use:\r\n\torg.apache.iceberg#iceberg-spark3-runtime;0.12.0 from central in [default]\r\n\t---------------------------------------------------------------------\r\n\t|                  |            modules            ||   artifacts   |\r\n\t|       conf       | number| search|dwnlded|evicted|| number|dwnlded|\r\n\t---------------------------------------------------------------------\r\n\t|      default     |   1   |   0   |   0   |   0   ||   1   |   0   |\r\n\t---------------------------------------------------------------------\r\n:: retrieving :: org.apache.spark#spark-submit-parent-7a1b923a-77d9-455b-b946-72100bf36f6c\r\n\tconfs: [default]\r\n\t0 artifacts copied, 1 already retrieved (0kB/5ms)\r\n21/09/22 21:55:17 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\r\nSetting default log level to \"WARN\".\r\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\r\nSpark context Web UI available at http://spark-box:4040\r\nSpark context available as 'sc' (master = local[*], app id = local-1632347722175).\r\nSpark session available as 'spark'.\r\nWelcome to\r\n      ____              __\r\n     / __/__  ___ _____/ /__\r\n    _\\ \\/ _ \\/ _ `/ __/  '_/\r\n   /___/ .__/\\_,_/_/ /_/\\_\\   version 3.1.2\r\n      /_/\r\n\r\nUsing Scala version 2.12.10 (OpenJDK 64-Bit Server VM, Java 1.8.0_292)\r\nType in expressions to have them evaluated.\r\nType :help for more information.\r\n\r\nscala> spark.table(\"default.test_parquet_map_regression_iceberg_010\").show(false)\r\n+-------------------------------+\r\n|mapCol                         |\r\n+-------------------------------+\r\n|{0 -> {{true, 0.0, 0}, 0}}     |\r\n|{1 -> {{false, 1.0, 1}, 1}}    |\r\n|{2 -> {{true, 2.0, 2}, 2}}     |\r\n|{3 -> {{false, 3.0, 3}, 3}}    |\r\n|{4 -> {{true, 4.0, 4}, 4}}     |\r\n|{5 -> {{false, 5.0, 5}, 5}}    |\r\n|{6 -> {{true, 6.0, 6}, 6}}     |\r\n|{7 -> {{false, 7.0, 7}, 7}}    |\r\n|{8 -> {{true, 8.0, 8}, 8}}     |\r\n|{9 -> {{false, 9.0, 9}, 9}}    |\r\n|{10 -> {{true, 10.0, 10}, 10}} |\r\n|{11 -> {{false, 11.0, 11}, 11}}|\r\n|{12 -> {{true, 12.0, 12}, 12}} |\r\n|{13 -> {{false, 13.0, 13}, 13}}|\r\n|{14 -> {{true, 14.0, 14}, 14}} |\r\n|{15 -> {{false, 15.0, 15}, 15}}|\r\n|{16 -> {{true, 16.0, 16}, 16}} |\r\n|{17 -> {{false, 17.0, 17}, 17}}|\r\n|{18 -> {{true, 18.0, 18}, 18}} |\r\n|{19 -> {{false, 19.0, 19}, 19}}|\r\n+-------------------------------+\r\nonly showing top 20 rows\r\n\r\n\r\nscala> spark.table(\"default.test_parquet_map_regression_iceberg_090\").show(false)\r\n+-------------------------------+\r\n|mapCol                         |\r\n+-------------------------------+\r\n|{0 -> {{true, 0.0, 0}, 0}}     |\r\n|{1 -> {{false, 1.0, 1}, 1}}    |\r\n|{2 -> {{true, 2.0, 2}, 2}}     |\r\n|{3 -> {{false, 3.0, 3}, 3}}    |\r\n|{4 -> {{true, 4.0, 4}, 4}}     |\r\n|{5 -> {{false, 5.0, 5}, 5}}    |\r\n|{6 -> {{true, 6.0, 6}, 6}}     |\r\n|{7 -> {{false, 7.0, 7}, 7}}    |\r\n|{8 -> {{true, 8.0, 8}, 8}}     |\r\n|{9 -> {{false, 9.0, 9}, 9}}    |\r\n|{10 -> {{true, 10.0, 10}, 10}} |\r\n|{11 -> {{false, 11.0, 11}, 11}}|\r\n|{12 -> {{true, 12.0, 12}, 12}} |\r\n|{13 -> {{false, 13.0, 13}, 13}}|\r\n|{14 -> {{true, 14.0, 14}, 14}} |\r\n|{15 -> {{false, 15.0, 15}, 15}}|\r\n|{16 -> {{true, 16.0, 16}, 16}} |\r\n|{17 -> {{false, 17.0, 17}, 17}}|\r\n|{18 -> {{true, 18.0, 18}, 18}} |\r\n|{19 -> {{false, 19.0, 19}, 19}}|\r\n+-------------------------------+\r\nonly showing top 20 rows\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925362178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925389129","html_url":"https://github.com/apache/iceberg/issues/2962#issuecomment-925389129","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2962","id":925389129,"node_id":"IC_kwDOCW7NX843KFFJ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T23:03:05Z","updated_at":"2021-09-22T23:03:05Z","author_association":"CONTRIBUTOR","body":"I looked at the parquet meta of one of the underlying files from both Iceberg 0.9.0 and Iceberg 0.10.0.\r\n\r\nThe difference does seem to be in the change in the MAP type definition.\r\n\r\n```\r\nFile path:  file_iceberg_010.parquet\r\nCreated by: parquet-mr version 1.11.1 (build 765bd5cd7fdef2af1cecd0755000694b992bfadd)\r\nProperties:\r\n  iceberg.schema: {\"type\":\"struct\",\"fields\":[{\"id\":1,\"name\":\"mapCol\",\"required\":true,\"type\":{\"type\":\"map\",\"key-id\":2,\"key\":\"string\",\"value-id\":3,\"value\":{\"type\":\"struct\",\"fields\":[{\"id\":4,\"name\":\"payload\",\"required\":true,\"type\":{\"type\":\"struct\",\"fields\":[{\"id\":6,\"name\":\"bool\",\"required\":true,\"type\":\"boolean\"},{\"id\":7,\"name\":\"dbl\",\"required\":true,\"type\":\"double\"},{\"id\":8,\"name\":\"str\",\"required\":true,\"type\":\"string\"}]}},{\"id\":5,\"name\":\"str\",\"required\":true,\"type\":\"string\"}]},\"value-required\":true}}]}\r\nSchema:\r\nmessage table {\r\n  required group mapCol (MAP) = 1 {\r\n    repeated group key_value {\r\n      required binary key (STRING) = 2;\r\n      required group value = 3 {\r\n        required group payload = 4 {\r\n          required boolean bool = 6;\r\n          required double dbl = 7;\r\n          required binary str (STRING) = 8;\r\n        }\r\n        required binary str (STRING) = 5;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n\r\nRow group 0:  count: 12  32.33 B records  start: 4  total: 388 B\r\n--------------------------------------------------------------------------------\r\n                                     type      encodings count     avg size   nulls   min / max\r\nmapCol.key_value.key                 BINARY    G   _     12        6.92 B     0       \"0\" / \"9\"\r\nmapCol.key_value.value.payload.bool  BOOLEAN   G   _     12        4.50 B     0       \"false\" / \"true\"\r\nmapCol.key_value.value.payload.dbl   DOUBLE    G   _     12        7.08 B     0       \"-0.0\" / \"11.0\"\r\nmapCol.key_value.value.payload.str   BINARY    G   _     12        6.92 B     0       \"0\" / \"9\"\r\nmapCol.key_value.value.str           BINARY    G   _     12        6.92 B     0       \"0\" / \"9\"\r\n```\r\n\r\nHere's the meta from one of the files in the Iceberg 0.9.0 table\r\n\r\n```\r\nFile path:  file_090.parquet\r\nCreated by: parquet-mr version 1.11.0 (build 18519eb8e059865652eee3ff0e8593f126701da4)\r\nProperties:\r\n  iceberg.schema: {\"type\":\"struct\",\"fields\":[{\"id\":1,\"name\":\"mapCol\",\"required\":true,\"type\":{\"type\":\"map\",\"key-id\":2,\"key\":\"string\",\"value-id\":3,\"value\":{\"type\":\"struct\",\"fields\":[{\"id\":4,\"name\":\"payload\",\"required\":true,\"type\":{\"type\":\"struct\",\"fields\":[{\"id\":6,\"name\":\"bool\",\"required\":true,\"type\":\"boolean\"},{\"id\":7,\"name\":\"dbl\",\"required\":true,\"type\":\"double\"},{\"id\":8,\"name\":\"str\",\"required\":true,\"type\":\"string\"}]}},{\"id\":5,\"name\":\"str\",\"required\":true,\"type\":\"string\"}]},\"value-required\":true}}]}\r\nSchema:\r\nmessage table {\r\n  required group mapCol (MAP) = 1 {\r\n    repeated group map {\r\n      required binary key (STRING) = 2;\r\n      required group value = 3 {\r\n        required group payload = 4 {\r\n          required boolean bool = 6;\r\n          required double dbl = 7;\r\n          required binary str (STRING) = 8;\r\n        }\r\n        required binary str (STRING) = 5;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n\r\nRow group 0:  count: 12  32.33 B records  start: 4  total: 388 B\r\n--------------------------------------------------------------------------------\r\n                               type      encodings count     avg size   nulls   min / max\r\nmapCol.map.key                 BINARY    G   _     12        6.92 B     0       \"0\" / \"9\"\r\nmapCol.map.value.payload.bool  BOOLEAN   G   _     12        4.50 B     0       \"false\" / \"true\"\r\nmapCol.map.value.payload.dbl   DOUBLE    G   _     12        7.08 B     0       \"-0.0\" / \"11.0\"\r\nmapCol.map.value.payload.str   BINARY    G   _     12        6.92 B     0       \"0\" / \"9\"\r\nmapCol.map.value.str           BINARY    G   _     12        6.92 B     0       \"0\" / \"9\"\r\n```\r\n\r\nHowever, as mentioned, I _am_ able to read both tables with Iceberg 0.12.0.  @hankfanchiu You said your internal fork doesn't work with Iceberg 0.12.0? Can you possibly try with OSS?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925389129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925402232","html_url":"https://github.com/apache/iceberg/issues/3055#issuecomment-925402232","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3055","id":925402232,"node_id":"IC_kwDOCW7NX843KIR4","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T23:34:09Z","updated_at":"2021-09-22T23:34:09Z","author_association":"CONTRIBUTOR","body":"@fcvr1010, are there any related exceptions in logs when you see this behavior? I'm looking into this and it looks like everything is getting correctly closed in this path to me. The only leaks I think could happen would result from exceptions in Avro classes. Can you check?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925402232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925402860","html_url":"https://github.com/apache/iceberg/pull/2984#issuecomment-925402860","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2984","id":925402860,"node_id":"IC_kwDOCW7NX843KIbs","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T23:35:47Z","updated_at":"2021-09-22T23:35:47Z","author_association":"CONTRIBUTOR","body":"I've updated this PR to focus on Spark for now. Similar functionality can be added to other query engines later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925402860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925403003","html_url":"https://github.com/apache/iceberg/pull/2984#issuecomment-925403003","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2984","id":925403003,"node_id":"IC_kwDOCW7NX843KId7","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T23:36:11Z","updated_at":"2021-09-22T23:36:11Z","author_association":"CONTRIBUTOR","body":"I'd appreciate another review round.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925403003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925403415","html_url":"https://github.com/apache/iceberg/pull/2987#issuecomment-925403415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2987","id":925403415,"node_id":"IC_kwDOCW7NX843KIkX","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-22T23:37:15Z","updated_at":"2021-09-22T23:37:15Z","author_association":"CONTRIBUTOR","body":"I'll close this for now. We can come back to this once we want to support `_partition` metadata columns in Flink.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925403415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925431090","html_url":"https://github.com/apache/iceberg/pull/3032#issuecomment-925431090","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3032","id":925431090,"node_id":"IC_kwDOCW7NX843KPUy","user":{"login":"asnowfox","id":44358181,"node_id":"MDQ6VXNlcjQ0MzU4MTgx","avatar_url":"https://avatars.githubusercontent.com/u/44358181?v=4","gravatar_id":"","url":"https://api.github.com/users/asnowfox","html_url":"https://github.com/asnowfox","followers_url":"https://api.github.com/users/asnowfox/followers","following_url":"https://api.github.com/users/asnowfox/following{/other_user}","gists_url":"https://api.github.com/users/asnowfox/gists{/gist_id}","starred_url":"https://api.github.com/users/asnowfox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asnowfox/subscriptions","organizations_url":"https://api.github.com/users/asnowfox/orgs","repos_url":"https://api.github.com/users/asnowfox/repos","events_url":"https://api.github.com/users/asnowfox/events{/privacy}","received_events_url":"https://api.github.com/users/asnowfox/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T00:44:18Z","updated_at":"2021-09-23T01:51:24Z","author_association":"NONE","body":"> @asnowfox , How did you ensure that the class was loaded by other different class loader ? Is this PR resolved your issue ?\r\n\r\nyes, I do. and I run it in my 8 nodes flink cluster.\r\n\r\n```\r\npublic static class Builder {\r\n    private final Class<?> baseClass;\r\n    // This loader is the main class thread's class loader.\r\n    private ClassLoader loader = Thread.currentThread().getContextClassLoader();\r\n    private Ctor ctor = null;\r\n    private Map<String, Throwable> problems = new HashMap<String, Throwable>();\r\n\r\n    public Builder(Class<?> baseClass) {\r\n      this.baseClass = baseClass;\r\n      //Here I think if we use the Thread.currentThread().getContextClassLoader() It will be\r\n      //the main Therad's loader. If other thread call this method. I think it should use this\r\n      //thread's class loader.\r\n      this.loader = this.baseClass.getClassLoader();\r\n    }\r\n\r\n    public Builder() {\r\n      this.baseClass = null;\r\n    }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925431090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925440538","html_url":"https://github.com/apache/iceberg/pull/2984#issuecomment-925440538","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2984","id":925440538,"node_id":"IC_kwDOCW7NX843KRoa","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T01:13:16Z","updated_at":"2021-09-23T01:13:16Z","author_association":"CONTRIBUTOR","body":"This is no longer WIP.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925440538/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925463951","html_url":"https://github.com/apache/iceberg/issues/3026#issuecomment-925463951","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3026","id":925463951,"node_id":"IC_kwDOCW7NX843KXWP","user":{"login":"EricJoy2048","id":32193458,"node_id":"MDQ6VXNlcjMyMTkzNDU4","avatar_url":"https://avatars.githubusercontent.com/u/32193458?v=4","gravatar_id":"","url":"https://api.github.com/users/EricJoy2048","html_url":"https://github.com/EricJoy2048","followers_url":"https://api.github.com/users/EricJoy2048/followers","following_url":"https://api.github.com/users/EricJoy2048/following{/other_user}","gists_url":"https://api.github.com/users/EricJoy2048/gists{/gist_id}","starred_url":"https://api.github.com/users/EricJoy2048/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EricJoy2048/subscriptions","organizations_url":"https://api.github.com/users/EricJoy2048/orgs","repos_url":"https://api.github.com/users/EricJoy2048/repos","events_url":"https://api.github.com/users/EricJoy2048/events{/privacy}","received_events_url":"https://api.github.com/users/EricJoy2048/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T02:31:19Z","updated_at":"2021-09-23T02:31:19Z","author_association":"MEMBER","body":"> Could you please give more information about how would you like to use the truncate#width to create a ranger partition ? I did not quite understand your case actually. Thanks.\r\n\r\nFrom the iceberg document I found W is the width of each partition, not the number of partitions.\r\nIf I want to divide the numbers from 1 to 100 into 3 ranger partitions, W should be 100/3 + 1 = 34 (because 100% 3 != 0).\r\nDo i have a misunderstanding?\r\n\r\nAnd then if I want to divide the numbers from Long.MIN_VALUE to Long.MAX_VALUE into 10 ranger partitions, W should be (Long.MAX_VALUE - Long.MIN_VALUE ) / 10 + 1 . ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925463951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925484647","html_url":"https://github.com/apache/iceberg/issues/3025#issuecomment-925484647","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3025","id":925484647,"node_id":"IC_kwDOCW7NX843KcZn","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T03:41:30Z","updated_at":"2021-09-23T20:24:21Z","author_association":"CONTRIBUTOR","body":"we have a tool that automatically detects a schema change and executes corresponding schema update operations. Without consistent ids operations such as `rename` can't be automated","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925484647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925485989","html_url":"https://github.com/apache/iceberg/issues/3139#issuecomment-925485989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3139","id":925485989,"node_id":"IC_kwDOCW7NX843Kcul","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T03:46:33Z","updated_at":"2021-09-23T03:46:33Z","author_association":"CONTRIBUTOR","body":"Hey @openinx , I haven't decided what's the right way to fix this. A possible solution is to improve how we generate `idToConstant` in `RowDataReader::open`. Currently we only put metadata column and partition value into that map. Perhaps we can also do a DFS walk of the required schema, and if all nested fields of a compound type are constants, then the compound column itself can be considered a constant too. Does that make sense to you?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925485989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925504787","html_url":"https://github.com/apache/iceberg/issues/3139#issuecomment-925504787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3139","id":925504787,"node_id":"IC_kwDOCW7NX843KhUT","user":{"login":"rice668","id":6520673,"node_id":"MDQ6VXNlcjY1MjA2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6520673?v=4","gravatar_id":"","url":"https://api.github.com/users/rice668","html_url":"https://github.com/rice668","followers_url":"https://api.github.com/users/rice668/followers","following_url":"https://api.github.com/users/rice668/following{/other_user}","gists_url":"https://api.github.com/users/rice668/gists{/gist_id}","starred_url":"https://api.github.com/users/rice668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rice668/subscriptions","organizations_url":"https://api.github.com/users/rice668/orgs","repos_url":"https://api.github.com/users/rice668/repos","events_url":"https://api.github.com/users/rice668/events{/privacy}","received_events_url":"https://api.github.com/users/rice668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T04:47:17Z","updated_at":"2021-09-23T04:47:17Z","author_association":"CONTRIBUTOR","body":"@lirui-apache Could you please let me take this issue ? I would like to try this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925504787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925538346","html_url":"https://github.com/apache/iceberg/pull/3164#issuecomment-925538346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3164","id":925538346,"node_id":"IC_kwDOCW7NX843Kpgq","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T06:30:15Z","updated_at":"2021-09-23T06:30:15Z","author_association":"MEMBER","body":"Thanks @aokolnychyi for pinging me, let me take a look today !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/925538346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926014364","html_url":"https://github.com/apache/iceberg/issues/2991#issuecomment-926014364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2991","id":926014364,"node_id":"IC_kwDOCW7NX843Mduc","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T17:29:45Z","updated_at":"2021-09-24T04:18:17Z","author_association":"CONTRIBUTOR","body":"@alex-shchetkov @fcvr1010 @jackye1995 I was able to reproduce the issue (Configurations: EMR 6.2.0, Iceberg 0.11.1, Master node: 1 instance, Core node: 10 instances, Spark 3.0.1). When `--conf spark.driver.extraJavaOptions=-Djava.io.tmpdir=/tmp/driver` is not passed then the `tmp` container folder looks something like this: \r\n\r\n```\r\n/mnt1/yarn/usercache/hadoop/appcache/application_1632368478936_0025/container_1632368478936_0025_02_000021/tmp\r\n/mnt1/yarn/usercache/hadoop/appcache/application_1632368478936_0025/container_1632368478936_0025_02_000021/tmp/liblz4-java-4965470198489888535.so.lck\r\n/mnt1/yarn/usercache/hadoop/appcache/application_1632368478936_0025/container_1632368478936_0025_02_000021/tmp/liblz4-java-4965470198489888535.so\r\n```\r\n\r\nHowever, I still got the issue even though the folder and temp files were there (this specific node had 4 executor tasks running on it simulatenously):\r\n```\r\nSystem.getProperty(\"java.io.tmpdir\"): /mnt1/yarn/usercache/hadoop/appcache/application_1632368478936_0025/container_1632368478936_0025_02_000021/tmp\r\n\tat org.apache.iceberg.aws.s3.S3OutputFile.createOrOverwrite(S3OutputFile.java:61)\r\n\tat org.apache.iceberg.parquet.ParquetIO$ParquetOutputFile.createOrOverwrite(ParquetIO.java:153)\r\n\tat org.apache.iceberg.shaded.org.apache.parquet.hadoop.ParquetFileWriter.<init>(ParquetFileWriter.java:293)\r\n\tat org.apache.iceberg.shaded.org.apache.parquet.hadoop.ParquetFileWriter.<init>(ParquetFileWriter.java:259)\r\n\tat org.apache.iceberg.parquet.ParquetWriter.<init>(ParquetWriter.java:101)\r\n\tat org.apache.iceberg.parquet.Parquet$WriteBuilder.build(Parquet.java:250)\r\n\tat org.apache.iceberg.spark.source.SparkAppenderFactory.newAppender(SparkAppenderFactory.java:110)\r\n\tat org.apache.iceberg.spark.source.SparkAppenderFactory.newDataWriter(SparkAppenderFactory.java:139)\r\n\tat org.apache.iceberg.io.BaseTaskWriter$RollingFileWriter.newWriter(BaseTaskWriter.java:310)\r\n\tat org.apache.iceberg.io.BaseTaskWriter$RollingFileWriter.newWriter(BaseTaskWriter.java:303)\r\n\tat org.apache.iceberg.io.BaseTaskWriter$BaseRollingWriter.openCurrent(BaseTaskWriter.java:271)\r\n\tat org.apache.iceberg.io.BaseTaskWriter$BaseRollingWriter.<init>(BaseTaskWriter.java:233)\r\n\tat org.apache.iceberg.io.BaseTaskWriter$BaseRollingWriter.<init>(BaseTaskWriter.java:223)\r\n\tat org.apache.iceberg.io.BaseTaskWriter$RollingFileWriter.<init>(BaseTaskWriter.java:305)\r\n\tat org.apache.iceberg.io.PartitionedWriter.write(PartitionedWriter.java:73)\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.$anonfun$run$7(WriteToDataSourceV2Exec.scala:441)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1411)\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.run(WriteToDataSourceV2Exec.scala:477)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.$anonfun$writeWithV2$2(WriteToDataSourceV2Exec.scala:385)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:127)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:446)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1377)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:449)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.io.IOException: No such file or directory\r\n\tat java.io.UnixFileSystem.createFileExclusively(Native Method)\r\n\tat java.io.File.createTempFile(File.java:2026)\r\n\tat org.apache.iceberg.aws.s3.S3OutputStream.newStream(S3OutputStream.java:181)\r\n\tat org.apache.iceberg.aws.s3.S3OutputStream.<init>(S3OutputStream.java:115)\r\n\tat org.apache.iceberg.aws.s3.S3OutputFile.createOrOverwrite(S3OutputFile.java:58)\r\n\t... 26 more\r\n```\r\n\r\nAlso, do note that the executor tasks running on the node where the driver is running do not fail. \r\n\r\n@jackye1995 Not sure why the temp files are not generated with prefix [s3fileio-](https://github.com/apache/iceberg/blob/0.11.x/aws/src/main/java/org/apache/iceberg/aws/s3/S3OutputStream.java#L178).\r\n\r\nI could also see that for a single core node (not the node where the driver runs) running 4 executors - one of the executor had 0 failed tasks while the other executors tend to have failed tasks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926014364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926128541","html_url":"https://github.com/apache/iceberg/issues/3168#issuecomment-926128541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3168","id":926128541,"node_id":"IC_kwDOCW7NX843M5md","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T20:25:36Z","updated_at":"2021-09-23T20:25:58Z","author_association":"CONTRIBUTOR","body":"However, if I reverse the order of columns, i.e.:\r\n\r\n```\r\nsource.sortWithinPartitions(expr(\"iceberg_bucket10(id)\"), col(\"int_field\"))\r\n```\r\n\r\nit's working\r\n\r\nis that expected behavior?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926128541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926156048","html_url":"https://github.com/apache/iceberg/issues/2914#issuecomment-926156048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2914","id":926156048,"node_id":"IC_kwDOCW7NX843NAUQ","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T21:01:22Z","updated_at":"2021-09-23T21:01:22Z","author_association":"CONTRIBUTOR","body":"Part of #3164 is to implement delete writers there","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926156048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926235367","html_url":"https://github.com/apache/iceberg/pull/3164#issuecomment-926235367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3164","id":926235367,"node_id":"IC_kwDOCW7NX843NTrn","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T23:29:35Z","updated_at":"2021-09-23T23:29:35Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @RussellSpitzer @openinx @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926235367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926243261","html_url":"https://github.com/apache/iceberg/pull/3132#issuecomment-926243261","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3132","id":926243261,"node_id":"IC_kwDOCW7NX843NVm9","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-09-23T23:47:11Z","updated_at":"2021-09-23T23:47:11Z","author_association":"CONTRIBUTOR","body":"Thank you for the refactoring! I have been thinking about the same thing for a long time. Regarding behavior change, I think it's a bug to resolve in another way, and we should definitely have option -> session -> table metadata if it's not the case anywhere.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/926243261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]