[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1482988638","html_url":"https://github.com/apache/couchdb/issues/4497#issuecomment-1482988638","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4497","id":1482988638,"node_id":"IC_kwDOAAMmUc5YZJxe","user":{"login":"man4j","id":490832,"node_id":"MDQ6VXNlcjQ5MDgzMg==","avatar_url":"https://avatars.githubusercontent.com/u/490832?v=4","gravatar_id":"","url":"https://api.github.com/users/man4j","html_url":"https://github.com/man4j","followers_url":"https://api.github.com/users/man4j/followers","following_url":"https://api.github.com/users/man4j/following{/other_user}","gists_url":"https://api.github.com/users/man4j/gists{/gist_id}","starred_url":"https://api.github.com/users/man4j/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/man4j/subscriptions","organizations_url":"https://api.github.com/users/man4j/orgs","repos_url":"https://api.github.com/users/man4j/repos","events_url":"https://api.github.com/users/man4j/events{/privacy}","received_events_url":"https://api.github.com/users/man4j/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-24T15:23:39Z","updated_at":"2023-03-24T15:23:39Z","author_association":"NONE","body":"Log file: [https://pastebin.com/HFLHsBAH](https://pastebin.com/HFLHsBAH)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1482988638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1483018835","html_url":"https://github.com/apache/couchdb/issues/4497#issuecomment-1483018835","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4497","id":1483018835,"node_id":"IC_kwDOAAMmUc5YZRJT","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-24T15:44:31Z","updated_at":"2023-03-24T15:44:31Z","author_association":"CONTRIBUTOR","body":"That's generated from a timeout when trying to query security properties from any available shards. Normally if q=2,n=3 there are quite a few of those shards for your case with n=1, q=1 there is only shard copy and if that times-out then the security properties fetch times and it results in a crash.\r\n\r\nIf you're on 3.3.1 try increasing the `[fabric] shard_timeout_min_msec` to say 5000 from the default of 100.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1483018835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1483041150","html_url":"https://github.com/apache/couchdb/issues/4497#issuecomment-1483041150","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4497","id":1483041150,"node_id":"IC_kwDOAAMmUc5YZWl-","user":{"login":"man4j","id":490832,"node_id":"MDQ6VXNlcjQ5MDgzMg==","avatar_url":"https://avatars.githubusercontent.com/u/490832?v=4","gravatar_id":"","url":"https://api.github.com/users/man4j","html_url":"https://github.com/man4j","followers_url":"https://api.github.com/users/man4j/followers","following_url":"https://api.github.com/users/man4j/following{/other_user}","gists_url":"https://api.github.com/users/man4j/gists{/gist_id}","starred_url":"https://api.github.com/users/man4j/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/man4j/subscriptions","organizations_url":"https://api.github.com/users/man4j/orgs","repos_url":"https://api.github.com/users/man4j/repos","events_url":"https://api.github.com/users/man4j/events{/privacy}","received_events_url":"https://api.github.com/users/man4j/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-24T15:58:27Z","updated_at":"2023-03-24T15:58:27Z","author_association":"NONE","body":"thanks, I will try!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1483041150/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1483215272","html_url":"https://github.com/apache/couchdb/issues/4375#issuecomment-1483215272","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4375","id":1483215272,"node_id":"IC_kwDOAAMmUc5YaBGo","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-24T18:07:16Z","updated_at":"2023-03-24T18:07:16Z","author_association":"CONTRIBUTOR","body":"For the next 3.3.1.1 patch update where we upgrade Erlang 24, I had managed to build arm64 images for ubuntu-focal. So we might get those as soon as next week.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1483215272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1484482913","html_url":"https://github.com/apache/couchdb/issues/4375#issuecomment-1484482913","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4375","id":1484482913,"node_id":"IC_kwDOAAMmUc5Ye2lh","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-27T04:47:25Z","updated_at":"2023-03-27T04:47:25Z","author_association":"CONTRIBUTOR","body":"@aricooperdavis @mikdanjey ubuntu focal arm64 deb packages should be available now","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1484482913/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1485747436","html_url":"https://github.com/apache/couchdb/pull/4291#issuecomment-1485747436","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4291","id":1485747436,"node_id":"IC_kwDOAAMmUc5YjrTs","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-27T19:29:55Z","updated_at":"2023-03-27T19:29:55Z","author_association":"MEMBER","body":"* Nouveau endpoints return 404 if disabled and no attempt is made by the nouveau erlang app to contact the JVM side for background indexing.\r\n* update=true|false is supported but stable=true|false is not. nouveau always sorts by _id as the tie-breaker so the instability that clouseau exhibits is much reduced.\r\n* mango integration is done.\r\n* I've not yet written a new _search_cleanup endpoint but the java side supports it (and is regularly exercised)\r\n* indexes are deleted if nouveau is up when the database is deleted (same as dreyfus/clouseau)\r\n* include_docs=true not yet implemented (the README says so)\r\n* nouveau indexes are independent, same as dreyfus\r\n* not sure what you mean specifically by \"Collation (sort order) checks.\"\r\n\r\n\r\n\r\n  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1485747436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1485803148","html_url":"https://github.com/apache/couchdb/issues/4499#issuecomment-1485803148","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4499","id":1485803148,"node_id":"IC_kwDOAAMmUc5Yj46M","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-27T20:13:06Z","updated_at":"2023-03-27T20:13:06Z","author_association":"CONTRIBUTOR","body":"Getting the Erlang OTP from the release tar ball is also quicker than always cloning it with git.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1485803148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1485869377","html_url":"https://github.com/apache/couchdb/issues/4499#issuecomment-1485869377","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4499","id":1485869377,"node_id":"IC_kwDOAAMmUc5YkJFB","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-27T21:12:35Z","updated_at":"2023-03-27T21:13:09Z","author_association":"CONTRIBUTOR","body":"Consider using a buildx cache for caching package install: https://github.com/esl/packages/blob/master/Makefile#L126-L127 and https://github.com/esl/packages/blob/905035c6f4aed0ead69535d85fcd1cc566e0585b/builders/erlang_debian.Dockerfile#L28-L29\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1485869377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1486220073","html_url":"https://github.com/apache/couchdb/pull/4291#issuecomment-1486220073","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4291","id":1486220073,"node_id":"IC_kwDOAAMmUc5Ylesp","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-28T05:02:41Z","updated_at":"2023-03-28T05:02:41Z","author_association":"CONTRIBUTOR","body":"> * Nouveau endpoints return 404 if disabled and no attempt is made by the nouveau erlang app to contact the JVM side for background indexing.\r\n> * update=true|false is supported but stable=true|false is not. nouveau always sorts by _id as the tie-breaker so the instability that clouseau exhibits is much reduced.\r\n> * mango integration is done.\r\n> * indexes are deleted if nouveau is up when the database is deleted (same as dreyfus/clouseau)\r\n> * nouveau indexes are independent, same as dreyfus\r\n\r\nThe idea is to have some basic coverage for those cases and others mentioned. If mango integration breaks, we'd want to find out, same for `update=false` etc. Indexes are independent but it's a good idea to actually test more than one at a time. We had a recent mishap with replication jobs unintentionally become singletons.\r\n\r\n> * I've not yet written a new _search_cleanup endpoint but the java side supports it (and is regularly exercised)\r\n> * include_docs=true not yet implemented (the README says so)\r\n\r\nI saw the README, but wasn't sure it was current with the latest update as it doesn't mention Lucene 4 at all.  No worries about cleanup and include_docs, it can implemented later.\r\n\r\n> * not sure what you mean specifically by \"Collation (sort order) checks.\"\r\n\r\nIs there any support for altering result sort order. Going by README it mentioned both sorting and facets.\r\n For collation support, it would be checking if unicode data can be indexed and returned and if there is some normalization (NFD/NFC) or a way to set a locale. It's fine if there isn't, but users will at some point pass non-ASCII encoded data so it would be good to assert what happens in that case.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1486220073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1487054984","html_url":"https://github.com/apache/couchdb/issues/4501#issuecomment-1487054984","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4501","id":1487054984,"node_id":"IC_kwDOAAMmUc5YoqiI","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-28T14:59:24Z","updated_at":"2023-03-28T14:59:24Z","author_association":"CONTRIBUTOR","body":"Good idea. It could be done step-wise, one file or feature at a time. Move from one test suite to the other over time. We did it similarly with Javascript -> Elixir move a few years back.\r\n\r\nIf bringing in Nose2 is a hassle, another way could be to try to see if Python 3's built-in https://docs.python.org/3/library/unittest.html#module-unittest has the feature nose2 uses. The tests were written during the Python2 days and Python had some improvements since.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1487054984/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1487338741","html_url":"https://github.com/apache/couchdb/issues/4501#issuecomment-1487338741","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4501","id":1487338741,"node_id":"IC_kwDOAAMmUc5Ypvz1","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-28T17:34:50Z","updated_at":"2023-03-28T17:34:50Z","author_association":"CONTRIBUTOR","body":"Personally, I do not have any problems with Nose2.  But if the integration tests were migrated to Elixir, there is no need for it any more.  On its web site, it considers itself obsolete -- but instead of moving to another Python-based framework, consider Elixir directly.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1487338741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1487521577","html_url":"https://github.com/apache/couchdb/issues/4501#issuecomment-1487521577","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4501","id":1487521577,"node_id":"IC_kwDOAAMmUc5Yqccp","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-28T20:02:33Z","updated_at":"2023-03-29T00:26:27Z","author_association":"CONTRIBUTOR","body":"That's fair re: not having another language in the mix. Not all contributors might be versed in Python. So then we have Erlang, Python and Elixir.\r\n\r\nGoing that route and seeing that we're running a single node test server anyway, we could just move them to Erlang as well. The verbosity is about the same [view_include_docs_test.exs](https://github.com/apache/couchdb/blob/main/test/elixir/test/view_include_docs_test.exs) vs [chttpd_revs_diff_tests.erl](https://github.com/apache/couchdb/blob/main/src/chttpd/test/eunit/chttpd_revs_diff_tests.erl) and it gives a chance to collect code coverage and if needed use mock intercepts for some grey-box testing or induce failures.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1487521577/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1488968527","html_url":"https://github.com/apache/couchdb/issues/4504#issuecomment-1488968527","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4504","id":1488968527,"node_id":"IC_kwDOAAMmUc5Yv9tP","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-29T16:59:15Z","updated_at":"2023-03-29T16:59:15Z","author_association":"MEMBER","body":"Seems reasonable to die on anything labeled InternalError.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1488968527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1489064857","html_url":"https://github.com/apache/couchdb/issues/4504#issuecomment-1489064857","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4504","id":1489064857,"node_id":"IC_kwDOAAMmUc5YwVOZ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-29T18:04:02Z","updated_at":"2023-03-29T18:04:02Z","author_association":"CONTRIBUTOR","body":"Quick and dirty proof of concept:\r\n\r\n`% cat ~/view_oom_small_emit.json`\r\n\r\n```json\r\n[\"reset\"]\r\n[\"add_fun\", \"function(doc) {function mkstr(l) {var r = 'r'; while (r.length < l) {r=r+r;} return r;} var s = mkstr(96*1024*1024); var a = [s,s,s,s,s,s,s,s]; var j=JSON.stringify(a); emit(42,j.length);}\"]\r\n[\"map_doc\", {\"_id\":\"foo\"}]\r\n```\r\n\r\n```\r\ncat ~/view_oom_small_emit.json | ./src/couch/priv/couchjs ./share/server/main.js\r\ntrue\r\ntrue\r\n[\"log\",\"function raised exception (new InternalError(\\\"allocation size overflow\\\", \\\"<unknown>\\\", 20)) with doc._id foo\"]\r\n[[]]\r\n```\r\n\r\nSeems to happen on both 91 and 1.8.5, so pretty much the whole range of supported JS engines","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1489064857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1489192566","html_url":"https://github.com/apache/couchdb/issues/4504#issuecomment-1489192566","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4504","id":1489192566,"node_id":"IC_kwDOAAMmUc5Yw0Z2","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-29T19:37:32Z","updated_at":"2023-03-29T19:37:32Z","author_association":"CONTRIBUTOR","body":"A PR with a above proof of concept code as a test https://github.com/apache/couchdb/pull/4505","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1489192566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1489996648","html_url":"https://github.com/apache/couchdb/pull/4291#issuecomment-1489996648","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4291","id":1489996648,"node_id":"IC_kwDOAAMmUc5Yz4to","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-30T09:36:23Z","updated_at":"2023-03-30T09:36:23Z","author_association":"MEMBER","body":"on sort order, yes, you can sort on one or more fields (string or number) in ascending or descending order, the same as dreyfus. Unlike dreyfus, nouveau uses couch_ejson_compare when comparing UTF-8 strings.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1489996648/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1490703968","html_url":"https://github.com/apache/couchdb/issues/4501#issuecomment-1490703968","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4501","id":1490703968,"node_id":"IC_kwDOAAMmUc5Y2lZg","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-30T17:57:34Z","updated_at":"2023-03-30T17:57:34Z","author_association":"CONTRIBUTOR","body":"Personally, I wouldn't write (or migrate) any test to Elixir, because I see no benefits in learning and using a second/third programming language to add contributions to CouchDB. As a new developer to CouchDB (and Erlang), I found using a second language more of an obstacle than an asset.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1490703968/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1491619340","html_url":"https://github.com/apache/couchdb/issues/4501#issuecomment-1491619340","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4501","id":1491619340,"node_id":"IC_kwDOAAMmUc5Y6E4M","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-31T09:24:20Z","updated_at":"2023-03-31T09:24:20Z","author_association":"CONTRIBUTOR","body":"I am not sure if I got you right @big-r81.  Elixir has already been used in CouchDB and there are a lot of integration tests written in that language.  And, on the top of that, there is Python for Mango.\r\n\r\nOr are you saying that we should just leave Python there, because the chances are likely that new contributors are already familiar with it?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1491619340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1491672194","html_url":"https://github.com/apache/couchdb/issues/4501#issuecomment-1491672194","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4501","id":1491672194,"node_id":"IC_kwDOAAMmUc5Y6RyC","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-31T10:06:28Z","updated_at":"2023-03-31T10:06:28Z","author_association":"CONTRIBUTOR","body":"@pgj yes, there are a lot of Elixir tests (from the migration from Javascript, if I get this right). This is only a personal preference of me, not to use Elixir for tests. I think the move to using Elixir was made back then to attract more developers. I don't think this happened...\r\nBut feel free to use Elixir. 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1491672194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1491684580","html_url":"https://github.com/apache/couchdb/issues/4501#issuecomment-1491684580","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4501","id":1491684580,"node_id":"IC_kwDOAAMmUc5Y6Uzk","user":{"login":"jjrodrig","id":1001724,"node_id":"MDQ6VXNlcjEwMDE3MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1001724?v=4","gravatar_id":"","url":"https://api.github.com/users/jjrodrig","html_url":"https://github.com/jjrodrig","followers_url":"https://api.github.com/users/jjrodrig/followers","following_url":"https://api.github.com/users/jjrodrig/following{/other_user}","gists_url":"https://api.github.com/users/jjrodrig/gists{/gist_id}","starred_url":"https://api.github.com/users/jjrodrig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jjrodrig/subscriptions","organizations_url":"https://api.github.com/users/jjrodrig/orgs","repos_url":"https://api.github.com/users/jjrodrig/repos","events_url":"https://api.github.com/users/jjrodrig/events{/privacy}","received_events_url":"https://api.github.com/users/jjrodrig/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-31T10:16:34Z","updated_at":"2023-03-31T10:16:34Z","author_association":"CONTRIBUTOR","body":"From my experience as an Elixir test suite contributor, I found that Elixir allows new contributions much easier than Erlang does. \r\n\r\nIn this case, Python is the exception in the test suite, so I think it is a good idea to simplify this part and migrate these tests to the integration test suite based on Elixir.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1491684580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1495112677","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1495112677","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1495112677,"node_id":"IC_kwDOAAMmUc5ZHZvl","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-03T23:19:35Z","updated_at":"2023-04-03T23:19:35Z","author_association":"CONTRIBUTOR","body":"Please take a look at #4372.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1495112677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1495225710","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1495225710","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1495225710,"node_id":"IC_kwDOAAMmUc5ZH1Vu","user":{"login":"whosnorman","id":6620918,"node_id":"MDQ6VXNlcjY2MjA5MTg=","avatar_url":"https://avatars.githubusercontent.com/u/6620918?v=4","gravatar_id":"","url":"https://api.github.com/users/whosnorman","html_url":"https://github.com/whosnorman","followers_url":"https://api.github.com/users/whosnorman/followers","following_url":"https://api.github.com/users/whosnorman/following{/other_user}","gists_url":"https://api.github.com/users/whosnorman/gists{/gist_id}","starred_url":"https://api.github.com/users/whosnorman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/whosnorman/subscriptions","organizations_url":"https://api.github.com/users/whosnorman/orgs","repos_url":"https://api.github.com/users/whosnorman/repos","events_url":"https://api.github.com/users/whosnorman/events{/privacy}","received_events_url":"https://api.github.com/users/whosnorman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-04T01:52:34Z","updated_at":"2023-04-04T01:52:34Z","author_association":"NONE","body":"Heyo @leanne63 / @big-r81 I found this [download link for 3.2.2](https://couchdb.neighbourhood.ie/downloads/3.2.2/mac/3.2.2-1/Apache-CouchDB.zip) by using the wayback machine! After replacing the app in Applications with this one I was able to run through all the verification steps. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1495225710/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1496088673","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1496088673","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1496088673,"node_id":"IC_kwDOAAMmUc5ZLIBh","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-04T14:37:33Z","updated_at":"2023-04-04T14:37:33Z","author_association":"NONE","body":"@big-r81, after looking at [#4372](https://github.com/apache/couchdb/issues/4372) (thanks for the related info!), I did the referenced `curl` statements (from jonathanwork at the bottom) to add the `_users` and `_reference` tables. Those both succeeded with the `{\"ok\":true}` result.\r\n\r\nAfter adding those tables, I tried the verification process again. It sill stopped at *Create View* with an *x*.\r\n\r\nMy log no longer had any error references to the `_users` table. However, here's what it did have:\r\n* Still had a ton of these:\r\n```\r\n[info] 2023-04-04T13:42:55.148123Z couchdb@localhost <0.285.0> -------- couch_proc_manager <0.14969.3> died normal\r\n[error] 2023-04-04T13:42:55.153570Z couchdb@localhost <0.1978.0> -------- OS Process Error <0.14972.3> :: {os_process_error,{exit_status,134}}\r\n[info] 2023-04-04T13:42:55.153595Z couchdb@localhost <0.285.0> -------- couch_proc_manager <0.14972.3> died normal\r\n[error] 2023-04-04T13:42:55.159023Z couchdb@localhost <0.1978.0> -------- OS Process Error <0.14975.3> :: {os_process_error,{exit_status,134}}\r\n[info] 2023-04-04T13:42:55.159045Z couchdb@localhost <0.285.0> -------- couch_proc_manager <0.14975.3> died normal\r\n```\r\n\r\n* It had a couple of these:\r\n```\r\n[error] 2023-04-04T13:54:14.498025Z couchdb@localhost <0.16443.16> -------- gen_server <0.16443.16> terminated with reason: {exit_status,134}\r\n  last msg: redacted\r\n     state: {os_proc,\"./bin/couchjs ./share/server/main.js\",#Port<0.353813>,fun couch_os_process:writejson/2,fun couch_os_process:readjson/1,5000,300000}\r\n    extra: []\r\n[error] 2023-04-04T13:54:14.498093Z couchdb@localhost <0.16443.16> -------- gen_server <0.16443.16> terminated with reason: {exit_status,134}\r\n  last msg: redacted\r\n     state: {os_proc,\"./bin/couchjs ./share/server/main.js\",#Port<0.353813>,fun couch_os_process:writejson/2,fun couch_os_process:readjson/1,5000,300000}\r\n    extra: []\r\n\t\r\n[error] 2023-04-04T13:54:14.498201Z couchdb@localhost <0.16443.16> -------- CRASH REPORT Process  (<0.16443.16>) with 0 neighbors exited with reason: {exit_status,134} at gen_server:handle_common_reply/8(line:805) <= proc_lib:init_p_do_apply/3(line:226); initial_call: {couch_os_process,init,['Argument__1']}, ancestors: [<0.16442.16>], message_queue_len: 1, links: [<0.285.0>], dictionary: [], trap_exit: false, status: running, heap_size: 1598, stack_size: 28, reductions: 1585\r\n```\r\n\r\n* And, finally, the lines seeming to relate to the verification process specifically:\r\n```\r\n[notice] 2023-04-04T13:53:03.014403Z couchdb@localhost <0.18936.13> be38c3f373 127.0.0.1:5984 127.0.0.1 undefined POST /_session 200 ok 1\r\n[notice] 2023-04-04T13:53:03.019931Z couchdb@localhost <0.18936.13> a731936b81 127.0.0.1:5984 127.0.0.1 admin GET /_session 200 ok 0\r\n[notice] 2023-04-04T13:53:03.339469Z couchdb@localhost <0.18936.13> c847ea8fb7 127.0.0.1:5984 127.0.0.1 admin GET /_all_dbs 200 ok 2\r\n[notice] 2023-04-04T13:53:03.347194Z couchdb@localhost <0.19007.13> c5dd095aa7 127.0.0.1:5984 127.0.0.1 admin GET /_users 200 ok 1\r\n[notice] 2023-04-04T13:53:03.364258Z couchdb@localhost <0.10279.14> 0b92716cde 127.0.0.1:5984 127.0.0.1 admin GET /pers90 200 ok 17\r\n[notice] 2023-04-04T13:53:03.364320Z couchdb@localhost <0.18936.13> 22724ca8fb 127.0.0.1:5984 127.0.0.1 admin GET /_replicator 200 ok 18\r\n[notice] 2023-04-04T13:53:03.737519Z couchdb@localhost <0.18936.13> 82bd308f4e 127.0.0.1:5984 127.0.0.1 admin GET /_all_dbs?startkey=%22%22&endkey=%22%E9%A6%99%22&limit=30 200 ok 1\r\n[notice] 2023-04-04T13:53:14.309856Z couchdb@localhost <0.18936.13> 32298a063b 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb 404 ok 1\r\n[notice] 2023-04-04T13:53:14.309982Z couchdb@localhost <0.19007.13> 34dcede994 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb_replicate 404 ok 0\r\n[notice] 2023-04-04T13:53:14.378827Z couchdb@localhost <0.18936.13> a370e97724 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb 201 ok 65\r\n[notice] 2023-04-04T13:53:14.402419Z couchdb@localhost <0.19007.13> 1b645172a5 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_1 201 ok 19\r\n[notice] 2023-04-04T13:53:14.419248Z couchdb@localhost <0.19007.13> 522dbeb904 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_1 201 ok 13\r\n[notice] 2023-04-04T13:53:14.440066Z couchdb@localhost <0.19007.13> 3cabff4ffc 127.0.0.1:5984 127.0.0.1 admin DELETE /verifytestdb/test_doc_1?rev=2-d588d3e93ee155c5afffdf0247a2c5ef 200 ok 17\r\n[notice] 2023-04-04T13:53:14.459130Z couchdb@localhost <0.19007.13> eccfb596bb 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_10 201 ok 15\r\n[notice] 2023-04-04T13:53:14.477635Z couchdb@localhost <0.16841.14> b5b60294ae 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_30 201 ok 28\r\n[notice] 2023-04-04T13:53:14.477633Z couchdb@localhost <0.10279.14> a1c5ffd801 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_20 201 ok 31\r\n\r\n[error] 2023-04-04T13:54:14.450752Z couchdb@localhost <0.17922.14> -------- fabric_worker_timeout update_docs,couchdb@localhost,<<\"shards/00000000-7fffffff/verifytestdb.1680616394\">>\r\n[notice] 2023-04-04T13:54:14.450923Z couchdb@localhost <0.16843.14> a5f147fde7 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/_design/view_check 500 ok 60001\r\n[notice] 2023-04-04T13:54:14.470440Z couchdb@localhost <0.16843.14> 80cac64f8c 127.0.0.1:5984 127.0.0.1 admin DELETE /verifytestdb_replicate 404 ok 1\r\n[notice] 2023-04-04T13:54:14.483810Z couchdb@localhost <0.14377.16> ab90a7f334 127.0.0.1:5984 127.0.0.1 admin DELETE /verifytestdb 200 ok 14\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1496088673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1496317115","html_url":"https://github.com/apache/couchdb/pull/4482#issuecomment-1496317115","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4482","id":1496317115,"node_id":"IC_kwDOAAMmUc5ZL_y7","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-04T17:06:37Z","updated_at":"2023-04-04T17:06:37Z","author_association":"CONTRIBUTOR","body":"This pull request was closed by accident.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1496317115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1496318569","html_url":"https://github.com/apache/couchdb/pull/4482#issuecomment-1496318569","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4482","id":1496318569,"node_id":"IC_kwDOAAMmUc5ZMAJp","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-04T17:07:50Z","updated_at":"2023-04-04T17:07:50Z","author_association":"CONTRIBUTOR","body":"The PR was re-submitted as #4512.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1496318569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1496348749","html_url":"https://github.com/apache/couchdb/issues/4511#issuecomment-1496348749","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4511","id":1496348749,"node_id":"IC_kwDOAAMmUc5ZMHhN","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-04T17:33:31Z","updated_at":"2023-04-04T17:33:49Z","author_association":"CONTRIBUTOR","body":"I would like to work on this ticket.  Committers, please assign it to me.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1496348749/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1497114550","html_url":"https://github.com/apache/couchdb/pull/4494#issuecomment-1497114550","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4494","id":1497114550,"node_id":"IC_kwDOAAMmUc5ZPCe2","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-05T08:28:43Z","updated_at":"2023-04-05T08:28:43Z","author_association":"MEMBER","body":"very nice piece of work, thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1497114550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1497472632","html_url":"https://github.com/apache/couchdb/pull/4414#issuecomment-1497472632","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4414","id":1497472632,"node_id":"IC_kwDOAAMmUc5ZQZ54","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-05T13:17:45Z","updated_at":"2023-04-05T13:17:45Z","author_association":"CONTRIBUTOR","body":"Close this PR as https://github.com/apache/couchdb/pull/4494 has been merged.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1497472632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1497854083","html_url":"https://github.com/apache/couchdb/issues/2851#issuecomment-1497854083","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2851","id":1497854083,"node_id":"IC_kwDOAAMmUc5ZR3CD","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-05T17:19:41Z","updated_at":"2023-04-05T18:02:01Z","author_association":"CONTRIBUTOR","body":"PR https://github.com/apache/couchdb/pull/4494 should have fixed this issue for single keys.\r\n```bash\r\n$ curl -X DELETE http://adm:pass@127.0.0.1:15984/db\r\n$ curl -X PUT http://adm:pass@127.0.0.1:15984/db\r\n{\"ok\":true}\r\n$ curl -X POST http://adm:pass@127.0.0.1:15984/db/_bulk_docs'?=' \\\r\n       -H 'Content-Type: application/json' \\\r\n       -d '{\"docs\": [{\"_id\": \"_design/user-emails\",\"views\": {\"getVerifiedEmails\": {\"map\": \"function(doc) {if(doc.email_verified && doc.email_verified == true){\\n  emit(doc.email, [doc.name, doc.email_verified, doc.joined]) }}\"}}},{\"_id\": \"abc123\",\"type\": \"user\",\"email\": \"amelie.smith@aol.com\",\"email_verified\": true}]}'\r\n[{\"ok\":true,\"id\":\"_design/user-emails\",\"rev\":\"1-840ca986e193b3f5df84da0befe09af6\"},{\"ok\":true,\"id\":\"abc123\",\"rev\":\"1-3e0944abf21b22d8d6fe70002edc2e82\"}]\r\n$ curl -X POST http://adm:pass@127.0.0.1:15984/db/_design_docs/queries'?=' \\\r\n       -H 'Content-Type: application/json' \\\r\n       -d '{\"queries\": [{\"keys\": [\"abc123\"]}]}'\r\n{\"results\":[{\"total_rows\":1,\"offset\":1,\"rows\":[]}]}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1497854083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1499457855","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1499457855","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1499457855,"node_id":"IC_kwDOAAMmUc5ZX-k_","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-06T18:27:20Z","updated_at":"2023-04-06T18:27:20Z","author_association":"CONTRIBUTOR","body":"@leanne63\r\n \r\nHi, if you create the `_users` database, then the log messages are gone (as you already noticed!).\r\n\r\nYou need to install the Spidermonkey library, which is normally provided via the macOS `.app` package but doesn't work with the latest release .\r\n\r\nPlease install [Homebrew](https://brew.sh/) and afterwards you can install [Spidermonkey](https://formulae.brew.sh/formula/spidermonkey#default) with:\r\n```\r\nbrew install spidermonkey\r\n```\r\n\r\nThen you should be able to successful run the \"Fauxton verification\".","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1499457855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1499492691","html_url":"https://github.com/apache/couchdb/issues/4511#issuecomment-1499492691","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4511","id":1499492691,"node_id":"IC_kwDOAAMmUc5ZYHFT","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-06T19:01:37Z","updated_at":"2023-04-06T19:01:37Z","author_association":"CONTRIBUTOR","body":"Hi @paultranvan, I have studied the source code and it seems this behavior is intended (see #962).  However, I see what you want to achieve here and why this behavior causes a problem.\r\n\r\nOn the side of CouchDB, a possible solution would be to adjust the API so that the desired semantics could be requested.  That is, by passing, say `use_index={\"candidates\": [\"_design/by_worker\"], \"strict\": true}` will result HTTP 400 (Bad Parameters) when the requested index is missing.\r\n\r\nBut I think the whole issue could be managed on the client side.  Why not to store the list of known indexes there and use it to decide on each query if an index has been in use?  This might be even faster as you would not have to look out for errors constantly but get the desired result by a single query.  When needed, the list of known indexes could be initialized / synced from a CouchDB `/{db}/_index` `GET` request.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1499492691/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1499917431","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1499917431","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1499917431,"node_id":"IC_kwDOAAMmUc5ZZux3","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-07T04:19:05Z","updated_at":"2023-04-07T04:19:05Z","author_association":"NONE","body":"Is there no way to do this without Homebrew, then? I didn't see that in the requirements, and I try to avoid brew and its ilk (personal weirdness, sorry).\r\n\r\nI did see a Mozilla page that had instructions for building spidermonkey on a Mac; however, the links are broken. A newer page exists, but it also says to use brew.\r\n\r\nIf brew is required, then I'm stuck and you can close this ticket... <sad face>","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1499917431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500060052","html_url":"https://github.com/apache/couchdb/issues/4511#issuecomment-1500060052","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4511","id":1500060052,"node_id":"IC_kwDOAAMmUc5ZaRmU","user":{"login":"paultranvan","id":7010087,"node_id":"MDQ6VXNlcjcwMTAwODc=","avatar_url":"https://avatars.githubusercontent.com/u/7010087?v=4","gravatar_id":"","url":"https://api.github.com/users/paultranvan","html_url":"https://github.com/paultranvan","followers_url":"https://api.github.com/users/paultranvan/followers","following_url":"https://api.github.com/users/paultranvan/following{/other_user}","gists_url":"https://api.github.com/users/paultranvan/gists{/gist_id}","starred_url":"https://api.github.com/users/paultranvan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/paultranvan/subscriptions","organizations_url":"https://api.github.com/users/paultranvan/orgs","repos_url":"https://api.github.com/users/paultranvan/repos","events_url":"https://api.github.com/users/paultranvan/events{/privacy}","received_events_url":"https://api.github.com/users/paultranvan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-07T08:17:42Z","updated_at":"2023-04-07T08:17:42Z","author_association":"NONE","body":"Hi @pgj, thank you for your answer.\r\n\r\nYes it could be handled by the client, but it is quite cumbersome because you have to deal with this list state and update it when there are add/edit/remove on indexes. Typically, if an index is not in the list, you don't know if it's because it does not exist yet or simply because the list is not up-to-date, which could happen if there are several clients.\r\n\r\nThat's why I prefer the idea of adjusting the API e.g. with a `strict: true` param :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500060052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500082958","html_url":"https://github.com/apache/couchdb/issues/4516#issuecomment-1500082958","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4516","id":1500082958,"node_id":"IC_kwDOAAMmUc5ZaXMO","user":{"login":"cfeltz34","id":45885838,"node_id":"MDQ6VXNlcjQ1ODg1ODM4","avatar_url":"https://avatars.githubusercontent.com/u/45885838?v=4","gravatar_id":"","url":"https://api.github.com/users/cfeltz34","html_url":"https://github.com/cfeltz34","followers_url":"https://api.github.com/users/cfeltz34/followers","following_url":"https://api.github.com/users/cfeltz34/following{/other_user}","gists_url":"https://api.github.com/users/cfeltz34/gists{/gist_id}","starred_url":"https://api.github.com/users/cfeltz34/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfeltz34/subscriptions","organizations_url":"https://api.github.com/users/cfeltz34/orgs","repos_url":"https://api.github.com/users/cfeltz34/repos","events_url":"https://api.github.com/users/cfeltz34/events{/privacy}","received_events_url":"https://api.github.com/users/cfeltz34/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-07T08:49:33Z","updated_at":"2023-04-07T08:49:33Z","author_association":"NONE","body":"Problem resolved by removing \"same_site=none\" in \"[chttpd_auth] section\"\r\nBut I don't understand why a need to create _user database whereas I use SSO","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500082958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500268183","html_url":"https://github.com/apache/couchdb/issues/4516#issuecomment-1500268183","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4516","id":1500268183,"node_id":"IC_kwDOAAMmUc5ZbEaX","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-07T13:00:25Z","updated_at":"2023-04-07T13:00:25Z","author_association":"CONTRIBUTOR","body":"Hey, you don't need the `_users` db if you don't put your user credentials in it. What you achieved while you created the user db is, that no log message of a missing user db is logged, btw. this tells you the log message.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500268183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500277954","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1500277954","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1500277954,"node_id":"IC_kwDOAAMmUc5ZbGzC","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-07T13:11:57Z","updated_at":"2023-04-07T13:11:57Z","author_association":"CONTRIBUTOR","body":"The easiest way is to use Homebrew. You can compile Spidermonkey yourself, but I don't recommend it. If you can wait some time, we will prepare a next release in the near future and maybe this problem will be solved.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500277954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500385793","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1500385793","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1500385793,"node_id":"IC_kwDOAAMmUc5ZbhIB","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-07T15:23:04Z","updated_at":"2023-04-07T15:23:04Z","author_association":"NONE","body":"Looking forward to that release! Thanks, @big-r81!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500385793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500917024","html_url":"https://github.com/apache/couchdb/issues/4519#issuecomment-1500917024","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4519","id":1500917024,"node_id":"IC_kwDOAAMmUc5Zdi0g","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-08T15:39:54Z","updated_at":"2023-04-08T15:39:54Z","author_association":"CONTRIBUTOR","body":"I believe this has been fixed in https://github.com/apache/couchdb/pull/4472 and will be available in the next release.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1500917024/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1501922441","html_url":"https://github.com/apache/couchdb/pull/4520#issuecomment-1501922441","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4520","id":1501922441,"node_id":"IC_kwDOAAMmUc5ZhYSJ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-10T15:00:42Z","updated_at":"2023-04-10T15:00:42Z","author_association":"CONTRIBUTOR","body":"<img width=\"348\" alt=\"Screen Shot 2023-04-10 at 11 00 20 AM\" src=\"https://user-images.githubusercontent.com/211822/230927715-d47c63df-4f57-49ac-8942-41e6dc707c44.png\">\r\n\r\nFull CI passed","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1501922441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1501946859","html_url":"https://github.com/apache/couchdb/pull/4520#issuecomment-1501946859","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4520","id":1501946859,"node_id":"IC_kwDOAAMmUc5ZhePr","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-10T15:20:17Z","updated_at":"2023-04-10T15:20:17Z","author_association":"CONTRIBUTOR","body":"It turns out s390x running is one of our fastest workers: 17m to build everything vs 20-23m on others.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1501946859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1502207120","html_url":"https://github.com/apache/couchdb/issues/4521#issuecomment-1502207120","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4521","id":1502207120,"node_id":"IC_kwDOAAMmUc5ZidyQ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-10T19:19:00Z","updated_at":"2023-04-10T19:19:00Z","author_association":"CONTRIBUTOR","body":"The test in question is https://github.com/apache/couchdb/blob/main/src/couch/test/eunit/couchdb_file_compression_tests.erl","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1502207120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1502740027","html_url":"https://github.com/apache/couchdb/issues/4516#issuecomment-1502740027","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4516","id":1502740027,"node_id":"IC_kwDOAAMmUc5Zkf47","user":{"login":"cfeltz34","id":45885838,"node_id":"MDQ6VXNlcjQ1ODg1ODM4","avatar_url":"https://avatars.githubusercontent.com/u/45885838?v=4","gravatar_id":"","url":"https://api.github.com/users/cfeltz34","html_url":"https://github.com/cfeltz34","followers_url":"https://api.github.com/users/cfeltz34/followers","following_url":"https://api.github.com/users/cfeltz34/following{/other_user}","gists_url":"https://api.github.com/users/cfeltz34/gists{/gist_id}","starred_url":"https://api.github.com/users/cfeltz34/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfeltz34/subscriptions","organizations_url":"https://api.github.com/users/cfeltz34/orgs","repos_url":"https://api.github.com/users/cfeltz34/repos","events_url":"https://api.github.com/users/cfeltz34/events{/privacy}","received_events_url":"https://api.github.com/users/cfeltz34/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-11T06:12:18Z","updated_at":"2023-04-11T06:12:18Z","author_association":"NONE","body":"I understand, but how can I not get the error message in CouchDB logs if I choose not to have a _users database? \r\nWould there be an option to disable the process looking for this _users database ?  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1502740027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1503015024","html_url":"https://github.com/apache/couchdb/issues/4511#issuecomment-1503015024","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4511","id":1503015024,"node_id":"IC_kwDOAAMmUc5ZljBw","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-11T09:49:46Z","updated_at":"2023-04-11T09:49:46Z","author_association":"MEMBER","body":"I like the idea of an optional behaviour to require strict index usage, and probably should have a toggle for the default behaviour in `default.ini` as well as an API option. I worry a bit about overloading the type in `use_index` as I know this causes problems with some clients as well as being difficult to specify in OpenAPI, though I know it is already a bit confused in allowing either a string or array. A distinct `strict_index_selection` or similar field would likely be simpler in that regard, and I wonder whether we might want to use it to toggle index fall-back behaviour more generally (i.e. error instead of using `all_docs` if no index is available to service a query)?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1503015024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1503313230","html_url":"https://github.com/apache/couchdb/issues/4511#issuecomment-1503313230","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4511","id":1503313230,"node_id":"IC_kwDOAAMmUc5Zmr1O","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-11T13:04:52Z","updated_at":"2023-04-11T13:04:52Z","author_association":"CONTRIBUTOR","body":"I proposed the API option because that can be controlled per query not per deployment.  My impression is that users are mostly fine with the original behavior but there are use cases (like the one featured in this issue) where \"more strictness\" would be preferred.  Nevertheless I can be fine with controlling the default from `default.ini` and let it be overridden per-query, which could then work in both directions.\r\n\r\nI fully accept the criticism about overloading `use_index` even more.  Adding a separate flag is indeed a cleaner approach.  Extending the approach to the generic case can also be a good move -- similarly to this use case, there may be others where it is not preferred to execute suboptimal queries but return an error.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1503313230/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1503451993","html_url":"https://github.com/apache/couchdb/issues/4523#issuecomment-1503451993","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4523","id":1503451993,"node_id":"IC_kwDOAAMmUc5ZnNtZ","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-11T14:18:31Z","updated_at":"2023-05-22T14:18:52Z","author_association":"CONTRIBUTOR","body":"I think you'd want to increase `[purge] max_revisions_number = 1000` to your limit.  That's the sum of all the revisions in the batch. `max_document_id_number` increases the max number of document IDs only.\r\n\r\nA bit better advice might be to break up your purge requests into smaller batches. I don't think we tested or intended batch sizes to be on the order of 100k docs. More like something below 10k or so.\r\n\r\nAn improvement here could be to auto-batch them, so we could post a large number to the API point but internally it would be broken into more manageable, smaller batches.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1503451993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1503590378","html_url":"https://github.com/apache/couchdb/pull/4512#issuecomment-1503590378","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4512","id":1503590378,"node_id":"IC_kwDOAAMmUc5Znvfq","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-11T15:17:23Z","updated_at":"2023-04-11T15:17:23Z","author_association":"MEMBER","body":"@pgj those performance numbers look very promising! I think this looks mostly good from an implementation perspective, though I'll leave others to comment on the Erlang style. One thing that's missing though is handling `execution_stats`. The `execution_stats` object anticipated covering indexes in its structure:\r\n\r\n```\r\n\"execution_stats\": {\r\n        \"total_keys_examined\": 0,\r\n        \"total_docs_examined\": 200,\r\n        \"total_quorum_docs_examined\": 0,\r\n        \"results_returned\": 2,\r\n        \"execution_time_ms\": 5.52\r\n    }\r\n```\r\n\r\n`total_keys_examined` has not been meaningful until now, and I'd expect it to equal the number of keys read to service the query, where for non-covering indexes this is returned in the `total_docs_examined` field.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1503590378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505365606","html_url":"https://github.com/apache/couchdb/pull/4512#issuecomment-1505365606","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4512","id":1505365606,"node_id":"IC_kwDOAAMmUc5Zug5m","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T14:20:05Z","updated_at":"2023-04-12T14:20:05Z","author_association":"CONTRIBUTOR","body":"@willholley you are right, the statistics counters are not yet updated.  The reason for that is twofold: @mikerhodes has started to work on this earlier independently and I was not sure of his status until recently, then I wanted to have this piece out first and work on the counters in a separate pull request.  They have their own trouble with mixed-version clusters and I did not want to complicate this change further with those parts.  There are further pull requests planned along the lines of the corresponding RFC anyway.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505365606/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505586335","html_url":"https://github.com/apache/couchdb/issues/4521#issuecomment-1505586335","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4521","id":1505586335,"node_id":"IC_kwDOAAMmUc5ZvWyf","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T16:36:07Z","updated_at":"2023-04-12T16:36:07Z","author_association":"CONTRIBUTOR","body":"Another test which fails on s390x is:\r\n\r\n```\r\n[2023-04-12T15:34:42.178Z]       [done in 39.569 s]\r\n[2023-04-12T15:34:42.178Z]     BTree with shuffled keys\r\n[2023-04-12T15:34:42.467Z]       couch_btree_tests:192: should_set_fd_correctly...ok\r\n[2023-04-12T15:34:42.467Z]       couch_btree_tests:195: should_set_root_correctly...ok\r\n[2023-04-12T15:34:42.467Z]       couch_btree_tests:198: should_create_zero_sized_btree...ok\r\n[2023-04-12T15:34:42.467Z]       couch_btree_tests:203: should_set_reduce_option...ok\r\n[2023-04-12T15:34:42.467Z]       couch_btree_tests:207: should_fold_over_empty_btree...ok\r\n[2023-04-12T15:34:48.013Z]       couch_btree_tests:220: should_return_complete_btree_on_adding_all_keys...*timed out*\r\n[2023-04-12T15:34:48.013Z] in function gen:do_call/4 (gen.erl, line 214)\r\n[2023-04-12T15:34:48.013Z] in call from gen_server:call/3 (gen_server.erl, line 243)\r\n[2023-04-12T15:34:48.013Z] in call from ioq:queued_call/3 (src/ioq.erl, line 115)\r\n[2023-04-12T15:34:48.013Z] in call from couch_file:pread_iolist/2 (src/couch_file.erl, line 170)\r\n[2023-04-12T15:34:48.013Z] in call from couch_file:pread_binary/2 (src/couch_file.erl, line 166)\r\n[2023-04-12T15:34:48.013Z] in call from couch_file:pread_term/2 (src/couch_file.erl, line 155)\r\n[2023-04-12T15:34:48.013Z] in call from couch_btree:get_node/2 (src/couch_btree.erl, line 474)\r\n[2023-04-12T15:34:48.013Z] in call from couch_btree:stream_node/8 (src/couch_btree.erl, line 1069)\r\n[2023-04-12T15:34:48.013Z]       undefined\r\n[2023-04-12T15:34:53.511Z]     Should continuously add key-values to btree\r\n[2023-04-12T15:34:56.232Z]       couch_btree_tests:537: should_produce_valid_btree...[3.693 s] ok\r\n[2023-04-12T15:34:56.233Z]       couch_btree_tests:543: should_not_be_empty...ok\r\n[2023-04-12T15:34:56.233Z]       [done in 3.709 s]\r\n[2023-04-12T15:35:03.116Z]     Should continuously remove keys from btree\r\n[2023-04-12T15:35:03.116Z]       couch_btree_tests:537: should_produce_valid_btree...ok\r\n[2023-04-12T15:35:03.116Z]       couch_btree_tests:540: should_be_empty...ok\r\n[2023-04-12T15:35:03.116Z]       [done in 0.010 s]\r\n[2023-04-12T15:35:13.139Z]     couch_btree_tests:537: should_produce_valid_btree...*timed out*\r\n[2023-04-12T15:35:13.139Z] in function gen:do_call/4 (gen.erl, line 214)\r\n[2023-04-12T15:35:13.139Z] in call from gen_server:call/3 (gen_server.erl, line 243)\r\n[2023-04-12T15:35:13.139Z] in call from ioq:queued_call/3 (src/ioq.erl, line 115)\r\n[2023-04-12T15:35:13.139Z] in call from couch_file:pread_iolist/2 (src/couch_file.erl, line 170)\r\n[2023-04-12T15:35:13.139Z] in call from couch_file:pread_binary/2 (src/couch_file.erl, line 166)\r\n[2023-04-12T15:35:13.139Z] in call from couch_file:pread_term/2 (src/couch_file.erl, line 155)\r\n[2023-04-12T15:35:13.139Z] in call from couch_btree:get_node/2 (src/couch_btree.erl, line 474)\r\n[2023-04-12T15:35:13.139Z] in call from couch_btree:stream_node/8 (src/couch_btree.erl, line 1069)\r\n[2023-04-12T15:35:13.139Z]     undefined\r\n[2023-04-12T15:35:21.620Z]   couch_btree_tests:307: should_add_every_odd_key_remove_every_even...[9.077 s] ok\r\n[2023-04-12T15:35:34.221Z]   couch_btree_tests:321: should_add_every_even_key_remove_every_old...[11.649 s] ok\r\n```\r\n\r\nOn PPC64 LE:\r\n\r\n```\r\n23-04-12T15:33:24.573Z]   module 'couch_btree_tests'\r\n[2023-04-12T15:33:24.573Z]     couch_btree_tests:84: btree_open_test_ (Ensure that created btree is really a btree record)...ok\r\n[2023-04-12T15:33:24.573Z]     BTree with sorted keys\r\n[2023-04-12T15:33:24.573Z]       couch_btree_tests:192: should_set_fd_correctly...ok\r\n[2023-04-12T15:33:24.573Z]       couch_btree_tests:195: should_set_root_correctly...ok\r\n[2023-04-12T15:33:24.573Z]       couch_btree_tests:198: should_create_zero_sized_btree...ok\r\n[2023-04-12T15:33:24.573Z]       couch_btree_tests:203: should_set_reduce_option...ok\r\n[2023-04-12T15:33:24.573Z]       couch_btree_tests:207: should_fold_over_empty_btree...ok\r\n[2023-04-12T15:33:24.573Z]       couch_btree_tests:220: should_return_complete_btree_on_adding_all_keys...[3.076 s] ok\r\n[2023-04-12T15:33:24.573Z]       couch_btree_tests:223: should_have_non_zero_size...ok\r\n[2023-04-12T15:33:24.573Z]       couch_btree_tests:226: should_have_lesser_size_than_file...ok\r\n[2023-04-12T15:33:24.573Z]       couch_btree_tests:229: should_keep_root_pointer_to_kp_node...ok\r\n[2023-04-12T15:33:24.573Z]       Should remove all the keys\r\n[2023-04-12T15:33:24.573Z]         couch_btree_tests:537: should_produce_valid_btree...ok\r\n[2023-04-12T15:33:24.573Z]         couch_btree_tests:540: should_be_empty...ok\r\n[2023-04-12T15:33:24.573Z]         [done in 0.012 s]\r\n[2023-04-12T15:33:28.260Z]       Should continuously add key-values to btree\r\n[2023-04-12T15:33:30.998Z]         couch_btree_tests:537: should_produce_valid_btree...[2.509 s] ok\r\n[2023-04-12T15:33:30.998Z]         couch_btree_tests:543: should_not_be_empty...ok\r\n[2023-04-12T15:33:30.998Z]         [done in 2.516 s]\r\n[2023-04-12T15:33:36.643Z]       Should continuously remove keys from btree\r\n[2023-04-12T15:33:36.643Z]         couch_btree_tests:537: should_produce_valid_btree...ok\r\n[2023-04-12T15:33:36.643Z]         couch_btree_tests:540: should_be_empty...ok\r\n[2023-04-12T15:33:36.643Z]         [done in 0.013 s]\r\n[2023-04-12T15:33:43.678Z]       couch_btree_tests:537: should_produce_valid_btree...[3.753 s] ok\r\n[2023-04-12T15:33:54.020Z]       couch_btree_tests:307: should_add_every_odd_key_remove_every_even...[9.762 s] ok\r\n[2023-04-12T15:34:00.926Z]       couch_btree_tests:321: should_add_every_even_key_remove_every_old...[7.574 s] ok\r\n```\r\n\r\nThe times are not drastically different in this case but it seems more like a longer IO stall which made that particular test fail.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505586335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505717934","html_url":"https://github.com/apache/couchdb/issues/4521#issuecomment-1505717934","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4521","id":1505717934,"node_id":"IC_kwDOAAMmUc5Zv26u","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T18:10:42Z","updated_at":"2023-04-12T18:10:42Z","author_association":"CONTRIBUTOR","body":"Another timeout on s390x:\r\n\r\n```\r\n[2023-04-12T17:31:45.455Z]   [done in 2.908 s]\r\n[2023-04-12T17:31:45.455Z] module 'couch_mrview_compact_tests'\r\n[2023-04-12T17:31:45.455Z]   Compaction tests\r\n[2023-04-12T17:31:53.058Z]     couch_mrview_compact_tests:51: should_swap...*timed out*\r\n[2023-04-12T17:31:53.058Z] in function gen:do_call/4 (gen.erl, line 214)\r\n[2023-04-12T17:31:53.058Z] in call from gen_server:call/3 (gen_server.erl, line 243)\r\n[2023-04-12T17:31:53.058Z] in call from couch_mrview_util:get_view_index_state/5 (src/couch_mrview_util.erl, line 194)\r\n[2023-04-12T17:31:53.058Z] in call from couch_mrview_util:get_view/4 (src/couch_mrview_util.erl, line 153)\r\n[2023-04-12T17:31:53.058Z] in call from couch_mrview:query_view/6 (src/couch_mrview.erl, line 286)\r\n[2023-04-12T17:31:53.058Z] in call from couch_mrview_compact_tests:'-should_swap/1-fun-1-'/1 (test/eunit/couch_mrview_compact_tests.erl, line 52)\r\n[2023-04-12T17:31:53.058Z] in call from eunit_test:run_testfun/1 (eunit_test.erl, line 71)\r\n[2023-04-12T17:31:53.058Z] in call from eunit_proc:run_test/1 (eunit_proc.erl, line 531)\r\n[2023-04-12T17:31:53.058Z]     undefined\r\n[2023-04-12T17:31:54.335Z]   couch_mrview_compact_tests:82: should_remove...[0.632 s] ok\r\n```\r\n\r\nThis ones also IO related doing compaction and swaps.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505717934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505729675","html_url":"https://github.com/apache/couchdb/pull/4509#issuecomment-1505729675","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4509","id":1505729675,"node_id":"IC_kwDOAAMmUc5Zv5yL","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T18:20:36Z","updated_at":"2023-04-12T18:21:18Z","author_association":"CONTRIBUTOR","body":"`-E/-r` looks great. Good find, Ilya! It makes the expression easier to read and understand.\r\n\r\nIs there a difference between `-E` and `-r` I checked `man sed` on macos and freebsd and both seem to have both options and say:\r\n\r\n```\r\n-r\t     Same as -E\tfor compatibility with GNU sed.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505729675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505738541","html_url":"https://github.com/apache/couchdb/pull/4509#issuecomment-1505738541","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4509","id":1505738541,"node_id":"IC_kwDOAAMmUc5Zv78t","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T18:27:34Z","updated_at":"2023-04-12T18:27:34Z","author_association":"CONTRIBUTOR","body":"It looks like our oldest Linux CentOS 7 doesn't support `sed -E` would we be able to use `-r` only?\r\n\r\n```\r\n[root@2dfb04f0d80c /]# sed --help\r\nUsage: sed [OPTION]... {script-only-if-no-other-script} [input-file]...\r\n\r\n  -n, --quiet, --silent\r\n                 suppress automatic printing of pattern space\r\n  -e script, --expression=script\r\n                 add the script to the commands to be executed\r\n  -f script-file, --file=script-file\r\n                 add the contents of script-file to the commands to be executed\r\n  --follow-symlinks\r\n                 follow symlinks when processing in place\r\n  -i[SUFFIX], --in-place[=SUFFIX]\r\n                 edit files in place (makes backup if SUFFIX supplied)\r\n  -c, --copy\r\n                 use copy instead of rename when shuffling files in -i mode\r\n  -b, --binary\r\n                 does nothing; for compatibility with WIN32/CYGWIN/MSDOS/EMX (\r\n                 open files in binary mode (CR+LFs are not treated specially))\r\n  -l N, --line-length=N\r\n                 specify the desired line-wrap length for the `l' command\r\n  --posix\r\n                 disable all GNU extensions.\r\n  -r, --regexp-extended\r\n                 use extended regular expressions in the script.\r\n  -s, --separate\r\n                 consider files as separate rather than as a single continuous\r\n                 long stream.\r\n  -u, --unbuffered\r\n                 load minimal amounts of data from the input files and flush\r\n                 the output buffers more often\r\n  -z, --null-data\r\n                 separate lines by NUL characters\r\n  --help\r\n                 display this help and exit\r\n  --version\r\n                 output version information and exit\r\n...\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505738541/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505958496","html_url":"https://github.com/apache/couchdb/pull/4509#issuecomment-1505958496","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4509","id":1505958496,"node_id":"IC_kwDOAAMmUc5Zwxpg","user":{"login":"jiahuili430","id":54631519,"node_id":"MDQ6VXNlcjU0NjMxNTE5","avatar_url":"https://avatars.githubusercontent.com/u/54631519?v=4","gravatar_id":"","url":"https://api.github.com/users/jiahuili430","html_url":"https://github.com/jiahuili430","followers_url":"https://api.github.com/users/jiahuili430/followers","following_url":"https://api.github.com/users/jiahuili430/following{/other_user}","gists_url":"https://api.github.com/users/jiahuili430/gists{/gist_id}","starred_url":"https://api.github.com/users/jiahuili430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiahuili430/subscriptions","organizations_url":"https://api.github.com/users/jiahuili430/orgs","repos_url":"https://api.github.com/users/jiahuili430/repos","events_url":"https://api.github.com/users/jiahuili430/events{/privacy}","received_events_url":"https://api.github.com/users/jiahuili430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-12T21:15:06Z","updated_at":"2023-04-12T21:15:06Z","author_association":"CONTRIBUTOR","body":"Changed them to `sed -r`, thanks for double-checking with different systems, Nick.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1505958496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1506268887","html_url":"https://github.com/apache/couchdb/issues/4521#issuecomment-1506268887","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4521","id":1506268887,"node_id":"IC_kwDOAAMmUc5Zx9bX","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T03:10:10Z","updated_at":"2023-04-13T03:10:10Z","author_association":"CONTRIBUTOR","body":"Another failure in couch_btree tests:\r\n\r\n```\r\n[2023-04-12T23:03:39.072Z]     couch_btree_tests:84: btree_open_test_ (Ensure that created btree is really a btree record)...ok\r\n[2023-04-12T23:03:39.072Z]     BTree with sorted keys\r\n[2023-04-12T23:03:39.072Z]       couch_btree_tests:192: should_set_fd_correctly...ok\r\n[2023-04-12T23:03:39.072Z]       couch_btree_tests:195: should_set_root_correctly...ok\r\n[2023-04-12T23:03:39.072Z]       couch_btree_tests:198: should_create_zero_sized_btree...ok\r\n[2023-04-12T23:03:39.072Z]       couch_btree_tests:203: should_set_reduce_option...ok\r\n[2023-04-12T23:03:39.072Z]       couch_btree_tests:207: should_fold_over_empty_btree...ok\r\n[2023-04-12T23:03:41.181Z]       couch_btree_tests:220: should_return_complete_btree_on_adding_all_keys...*timed out*\r\n[2023-04-12T23:03:41.181Z] in function gen:do_call/4 (gen.erl, line 214)\r\n[2023-04-12T23:03:41.181Z] in call from gen_server:call/3 (gen_server.erl, line 243)\r\n[2023-04-12T23:03:41.181Z] in call from ioq:queued_call/3 (src/ioq.erl, line 115)\r\n[2023-04-12T23:03:41.181Z] in call from couch_file:pread_iolist/2 (src/couch_file.erl, line 170)\r\n[2023-04-12T23:03:41.181Z] in call from couch_file:pread_binary/2 (src/couch_file.erl, line 166)\r\n[2023-04-12T23:03:41.181Z] in call from couch_file:pread_term/2 (src/couch_file.erl, line 155)\r\n[2023-04-12T23:03:41.181Z] in call from couch_btree:get_node/2 (src/couch_btree.erl, line 474)\r\n[2023-04-12T23:03:41.181Z] in call from couch_btree:lookup/3 (src/couch_btree.erl, line 314)\r\n[2023-04-12T23:03:41.181Z]       undefined\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1506268887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1507249091","html_url":"https://github.com/apache/couchdb/issues/4521#issuecomment-1507249091","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4521","id":1507249091,"node_id":"IC_kwDOAAMmUc5Z1svD","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T16:22:47Z","updated_at":"2023-04-13T16:22:47Z","author_association":"CONTRIBUTOR","body":"Another failure noticed on s390x only. This one doesn't seem to be related to disk IO:\r\n\r\n```\r\n[2023-04-13T16:08:57.568Z]     couch_js_tests: fun.should_exit_on_internal_error...*failed*\r\n[2023-04-13T16:08:57.568Z] in function couch_js_tests:should_exit_on_internal_error/0 (test/eunit/couch_js_tests.erl, line 273)\r\n[2023-04-13T16:08:57.568Z] in call from eunit_test:run_testfun/1 (eunit_test.erl, line 71)\r\n[2023-04-13T16:08:57.568Z] in call from eunit_proc:run_test/1 (eunit_proc.erl, line 531)\r\n[2023-04-13T16:08:57.568Z] in call from eunit_proc:with_timeout/3 (eunit_proc.erl, line 356)\r\n[2023-04-13T16:08:57.568Z] in call from eunit_proc:handle_test/2 (eunit_proc.erl, line 514)\r\n[2023-04-13T16:08:57.568Z] in call from eunit_proc:tests_inorder/3 (eunit_proc.erl, line 456)\r\n[2023-04-13T16:08:57.568Z] in call from eunit_proc:with_timeout/3 (eunit_proc.erl, line 346)\r\n[2023-04-13T16:08:57.568Z] in call from eunit_proc:run_group/2 (eunit_proc.erl, line 570)\r\n[2023-04-13T16:08:57.568Z] **error:{assertException,\r\n[2023-04-13T16:08:57.568Z]     [{module,couch_js_tests},\r\n[2023-04-13T16:08:57.568Z]      {line,273},\r\n[2023-04-13T16:08:57.568Z]      {expression,\r\n[2023-04-13T16:08:57.568Z]          \"couch_query_servers : proc_prompt ( Proc , [ << \\\"reset\\\" >> ] )\"},\r\n[2023-04-13T16:08:57.568Z]      {pattern,\"{ throw , { os_process_error , _ } , [...] }\"},\r\n[2023-04-13T16:08:57.568Z]      {unexpected_exception,\r\n[2023-04-13T16:08:57.568Z]          {exit,\r\n[2023-04-13T16:08:57.568Z]              {noproc,{gen_server,call,[<0.22316.0>,{prompt,...},infinity]}},\r\n[2023-04-13T16:08:57.568Z]              [{gen_server,call,3,[{file,...},{...}]},\r\n[2023-04-13T16:08:57.568Z]               {couch_os_process,prompt,2,[{...}|...]},\r\n[2023-04-13T16:08:57.568Z]               {couch_query_servers,proc_prompt,2,[...]},\r\n[2023-04-13T16:08:57.568Z]               {couch_js_tests,should_exit_on_internal_error,0,...},\r\n[2023-04-13T16:08:57.568Z]               {eunit_test,run_testfun,...},\r\n[2023-04-13T16:08:57.568Z]               {eunit_proc,...},\r\n[2023-04-13T16:08:57.568Z]               {...}|...]}}]}\r\n[2023-04-13T16:08:57.568Z]   output:<<\"\">>\r\n[2023-04-13T16:08:57.568Z] \r\n```\r\n\r\nThis test exercises the case where it generates large JS terms to trigger the Spidermonkey `InternalError` on OOM.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1507249091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1507500591","html_url":"https://github.com/apache/couchdb/pull/4527#issuecomment-1507500591","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4527","id":1507500591,"node_id":"IC_kwDOAAMmUc5Z2qIv","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T19:26:50Z","updated_at":"2023-04-13T21:31:03Z","author_association":"CONTRIBUTOR","body":"Automatic CI won't work for this PR. Run a manual `make check`.\r\n\r\nI used Erlang 23 and Python 3.8\r\n\r\nMore detailed environment versions:\r\n```\r\n % asdf current\r\nelixir          1.12.3-otp-23   ASDF_ELIXIR_VERSION environment variable\r\nerlang          23.3.4.18       ASDF_ERLANG_VERSION environment variable\r\nnodejs          16.17.0         /Users/..../.tool-versions\r\npython          3.8.16          ASDF_PYTHON_VERSION environment variable\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1507500591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1507631283","html_url":"https://github.com/apache/couchdb/issues/4521#issuecomment-1507631283","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4521","id":1507631283,"node_id":"IC_kwDOAAMmUc5Z3KCz","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-13T21:28:52Z","updated_at":"2023-04-13T21:28:52Z","author_association":"CONTRIBUTOR","body":"Another failure:\r\n\r\n```\r\n[2023-04-13T20:57:28.075Z] in function couchdb_db_tests:'-should_kill_caller_from_load_validation_funs_for_deleted_db/1-fun-1-'/1 (test/eunit/couchdb_db_tests.erl, line 87)\r\n[2023-04-13T20:57:28.075Z] in call from eunit_test:run_testfun/1 (eunit_test.erl, line 71)\r\n[2023-04-13T20:57:28.075Z] in call from eunit_proc:run_test/1 (eunit_proc.erl, line 531)\r\n[2023-04-13T20:57:28.075Z] in call from eunit_proc:with_timeout/3 (eunit_proc.erl, line 356)\r\n[2023-04-13T20:57:28.075Z] in call from eunit_proc:handle_test/2 (eunit_proc.erl, line 514)\r\n[2023-04-13T20:57:28.075Z] in call from eunit_proc:tests_inorder/3 (eunit_proc.erl, line 456)\r\n[2023-04-13T20:57:28.075Z] in call from eunit_proc:with_timeout/3 (eunit_proc.erl, line 346)\r\n[2023-04-13T20:57:28.075Z] in call from eunit_proc:run_group/2 (eunit_proc.erl, line 570)\r\n[2023-04-13T20:57:28.075Z] **error:{assertException,\r\n[2023-04-13T20:57:28.075Z]     [{module,couchdb_db_tests},\r\n[2023-04-13T20:57:28.075Z]      {line,87},\r\n[2023-04-13T20:57:28.075Z]      {expression,\"couch_db : load_validation_funs ( Db )\"},\r\n[2023-04-13T20:57:28.075Z]      {pattern,\"{ error , database_does_not_exist , [...] }\"},\r\n[2023-04-13T20:57:28.075Z]      {unexpected_exception,\r\n[2023-04-13T20:57:28.075Z]          {throw,internal_server_error,\r\n[2023-04-13T20:57:28.075Z]              [{couch_db,load_validation_funs,1,[{file,...},{...}]},\r\n[2023-04-13T20:57:28.075Z]               {couchdb_db_tests,\r\n[2023-04-13T20:57:28.075Z]                   '-should_kill_caller_from_load_validation_funs_for_deleted_db/1-fun-1-',\r\n[2023-04-13T20:57:28.075Z]                   1,\r\n[2023-04-13T20:57:28.075Z]                   [{...}|...]},\r\n[2023-04-13T20:57:28.075Z]               {eunit_test,run_testfun,1,[...]},\r\n[2023-04-13T20:57:28.075Z]               {eunit_proc,run_test,1,...},\r\n[2023-04-13T20:57:28.075Z]               {eunit_proc,with_timeout,...},\r\n[2023-04-13T20:57:28.075Z]               {eunit_proc,...},\r\n[2023-04-13T20:57:28.075Z]               {...}|...]}}]}\r\n[2023-04-13T20:57:28.075Z]   output:<<\"\">>\r\n[2023-04-13T20:57:28.075Z] \r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1507631283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1508667960","html_url":"https://github.com/apache/couchdb/pull/4525#issuecomment-1508667960","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4525","id":1508667960,"node_id":"IC_kwDOAAMmUc5Z7HI4","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T14:36:00Z","updated_at":"2023-04-14T14:36:12Z","author_association":"MEMBER","body":"> When in non-distributed mode, I noticed we emit the type and help line but any stats:\r\n> \r\n> ```\r\n> # TYPE couchdb_membership gauge\r\n> couchdb_membership{nodes=\"cluster_nodes\"} 1\r\n> couchdb_membership{nodes=\"all_nodes\"} 1\r\n> \r\n> # HELP couchdb_erlang_distribution_recv_oct_bytes_total Number of bytes received by the socket.\r\n> # TYPE couchdb_erlang_distribution_recv_oct_bytes_total counter\r\n> \r\n> # HELP couchdb_erlang_distribution_recv_cnt_packets_total number of packets received by the socket.\r\n> # TYPE couchdb_erlang_distribution_recv_cnt_packets_total counter\r\n> \r\n> # HELP couchdb_erlang_distribution_recv_max_bytes size of the largest packet, in bytes, received by the socket.\r\n> # TYPE couchdb_erlang_distribution_recv_max_bytes gauge\r\n> ```\r\n> \r\n> Is that expected Prometheus behavior or would it be better to not emit the type/help lines at all then?\r\n\r\n@nickva I don't think it matters from a Prometheus perspective, but I've pushed a fix as I agree the output is a bit confusing if it contains orphaned annotations.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1508667960/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1508957411","html_url":"https://github.com/apache/couchdb/issues/4523#issuecomment-1508957411","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4523","id":1508957411,"node_id":"IC_kwDOAAMmUc5Z8Nzj","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-14T16:57:18Z","updated_at":"2023-04-14T16:57:18Z","author_association":"CONTRIBUTOR","body":"@manurajsingh did the above suggestion help?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1508957411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1510639183","html_url":"https://github.com/apache/couchdb/issues/4536#issuecomment-1510639183","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4536","id":1510639183,"node_id":"IC_kwDOAAMmUc5aCoZP","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T03:24:49Z","updated_at":"2023-04-17T03:24:49Z","author_association":"CONTRIBUTOR","body":"Thank you for your report @jlami.\r\n\r\nWith `http://localhost:5984/db/_changes?feed=longpoll&timeout=200000&since=now` or `continuous` the client probably stops during the HTTP protocol phase when the client is waiting on the server to respond. If the client disappears, the server won't find out about the connection state until it tries to respond to the client.\r\n\r\nSince there is a `timeout`,  at the end of the timeout interval is when the server will try to send a response and find out the client has closed the connection.  In this case the `timeout` is not `200000` but actually `60000`. The `timeout` value is the minimum value between the parameter for the request and the the [changes_timeout](https://docs.couchdb.org/en/stable/config/http.html#chttpd/changes_timeout) setting as per https://github.com/apache/couchdb/blob/4b8b7ec9f39d1e5910f301283fd6b9051b057d0c/src/couch/src/couch_changes.erl#L400-L401 So the connection will be torn down after 60 seconds.\r\n\r\nSo one way to shorted the time until the connection is cleared is to lower that timeout either in the request parameter or the config setting.\r\n\r\nAnother option is to use a heartbeat.  \r\n\r\n```\r\n/_changes'?feed=longpoll&heartbeat=5000&since=now'\r\n```\r\n\r\nThis will ping the connection every 5 second and send a newline. If the client dropped the request, the newline send should detect the connection shutdown and clean up the connection resources on the server.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1510639183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511426246","html_url":"https://github.com/apache/couchdb/issues/4536#issuecomment-1511426246","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4536","id":1511426246,"node_id":"IC_kwDOAAMmUc5aFojG","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T14:08:28Z","updated_at":"2023-04-17T14:08:28Z","author_association":"NONE","body":"Thanks for the reply @nickva\r\n\r\nI think the heartbeat might be a good addition/change to our setup to try and hasten the detection. That hopefully helps the application side.\r\n\r\nThe other thing is that this might also happen because of continuous replication from couchdb servers. I don't think they have the option to enable heartbeats in the _replicate and _replicator endpoints. Or is there a way to set this up?\r\n\r\nIs it not possible to detect a disconnect on the erlang side? I cannot really find where the connection is setup in the erlang source, but can't the process that handles the reading of the request also try and detect `tcp_closed` for a socket? I know this will only detect 'clean' connection closing (FIN packets). But it would at least be something.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511426246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511650151","html_url":"https://github.com/apache/couchdb/issues/4536#issuecomment-1511650151","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4536","id":1511650151,"node_id":"IC_kwDOAAMmUc5aGfNn","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T15:59:03Z","updated_at":"2023-04-17T15:59:03Z","author_association":"CONTRIBUTOR","body":"For replication it's possible to adjust [connection_timeout](https://docs.couchdb.org/en/stable/config/replicator.html#replicator/connection_timeout) setting. That setting value, divided by 3, ends up being sent as the `_changes` feed `timeout` connection parameter. So if that's `30000` msec, it will use `...&timeout=10000` in the request. Shortening that could help a bit perhaps. In the normal operation, when the feed is waiting on db changes, the effect will be that absent any changes, the _changes feed request will end and restart every `timeout` milliseconds.\r\n\r\nAn apparent, improvement could be to improve couch replicator to use both a heartbeat and a timeout.  It turns out both are not really compatible, and the presence of a heartbeat overrides the timeout parameter, so the larger improvement would be to fix that actually, to allow both to work.\r\n\r\n> Is it not possible to detect a disconnect on the erlang side? I cannot really find where the connection is setup in the erlang source, but can't the process that handles the reading of the request also try and detect tcp_closed for a socket? I know this will only detect 'clean' connection closing (FIN packets). But it would at least be something.\r\n\r\nThat might be possible. It would be something in the HTTP layer mochiweb library we're using, I think. But it would be an extra periodic check or something of that sort to monitor for TCP shutdown or disconnect messages even when we're expecting  server to respond (we're not actually waiting in a socket receive).  That logic might go somewhere in here: https://github.com/mochi/mochiweb/blob/83fd22d620bbefd8779ccb6ea21706bb8a1e0ed2/src/mochiweb_http.erl#L139-L140\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511650151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511716015","html_url":"https://github.com/apache/couchdb/issues/4536#issuecomment-1511716015","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4536","id":1511716015,"node_id":"IC_kwDOAAMmUc5aGvSv","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T16:38:02Z","updated_at":"2023-04-17T16:38:02Z","author_association":"NONE","body":"> For replication it's possible to adjust [connection_timeout](https://docs.couchdb.org/en/stable/config/replicator.html#replicator/connection_timeout) setting. That setting value, divided by 3, ends up being sent as the _changes feed timeout connection parameter. So if that's 30000 msec, it will use ...&timeout=10000 in the request. Shortening that could help a bit perhaps. In the normal operation, when the feed is waiting on db changes, the effect will be that absent any changes, the _changes feed request will end and restart every timeout milliseconds.\r\n\r\nUnfurtunately our replication needs quite hight timeouts or it will timeout during normal operations.\r\n\r\n> An apparent, improvement could be to improve couch replicator to use both a heartbeat and a timeout. It turns out both are not really compatible, and the presence of a heartbeat overrides the timeout parameter, so the larger improvement would be to fix that actually, to allow both to work.\r\n\r\nThis might indeed be nice. Heartbeat now overrides the timeout, but they might be good to work together.\r\nBut I'm correct in inferring that the replicate does not support heartbeat at this moment right?\r\n\r\n> That might be possible. It would be something in the HTTP layer mochiweb library we're using, I think. But it would be an extra periodic check or something of that sort to monitor for TCP shutdown or disconnect messages even when we're expecting server to respond (we're not actually waiting in a socket receive). That logic might go somewhere in here: https://github.com/mochi/mochiweb/blob/83fd22d620bbefd8779ccb6ea21706bb8a1e0ed2/src/mochiweb_http.erl#L139-L140\r\n\r\nThanks, I was just looking at mochiweb. I'll see if I can get a feature request/issue for the tcp_closed during handling of the request body.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511716015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511724555","html_url":"https://github.com/apache/couchdb/pull/4537#issuecomment-1511724555","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4537","id":1511724555,"node_id":"IC_kwDOAAMmUc5aGxYL","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T16:43:13Z","updated_at":"2023-04-17T16:43:13Z","author_association":"CONTRIBUTOR","body":"@jaydoane it was not cleaned up when ken was updated to have both background and incremental channels. Would have to go back to Cloudant internal ken repo for that history.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511724555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511740721","html_url":"https://github.com/apache/couchdb/issues/4536#issuecomment-1511740721","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4536","id":1511740721,"node_id":"IC_kwDOAAMmUc5aG1Ux","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-17T16:55:06Z","updated_at":"2023-04-17T16:55:06Z","author_association":"CONTRIBUTOR","body":"> But I'm correct in inferring that the replicate does not support heartbeat at this moment right?\r\n\r\nYeah, that's correct. It uses timeouts only. So it periodically ends the continuous requests if there are not changes and restarts it.\r\n\r\n> I'll see if I can get a feature request/issue for the tcp_closed during handling of the request body.\r\n\r\nMochiweb is a separate project and Apache CouchDB at least in the case of long running requests is sort of abusing the typical HTTP API request pattern. User makes a request, and the callback instead of responding right away, and thus detecting a closed socket and crashing, hangs for minutes at a time. In other words, it won't be surprising if they don't want to accept this feature request.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1511740721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1514576088","html_url":"https://github.com/apache/couchdb/pull/4512#issuecomment-1514576088","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4512","id":1514576088,"node_id":"IC_kwDOAAMmUc5aRpjY","user":{"login":"pgj","id":277835,"node_id":"MDQ6VXNlcjI3NzgzNQ==","avatar_url":"https://avatars.githubusercontent.com/u/277835?v=4","gravatar_id":"","url":"https://api.github.com/users/pgj","html_url":"https://github.com/pgj","followers_url":"https://api.github.com/users/pgj/followers","following_url":"https://api.github.com/users/pgj/following{/other_user}","gists_url":"https://api.github.com/users/pgj/gists{/gist_id}","starred_url":"https://api.github.com/users/pgj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgj/subscriptions","organizations_url":"https://api.github.com/users/pgj/orgs","repos_url":"https://api.github.com/users/pgj/repos","events_url":"https://api.github.com/users/pgj/events{/privacy}","received_events_url":"https://api.github.com/users/pgj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-19T11:34:19Z","updated_at":"2023-04-19T11:34:19Z","author_association":"CONTRIBUTOR","body":"Thanks @nickva for taking the time and energy to get familiar with Mango and providing these useful comments!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1514576088/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516588504","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1516588504","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1516588504,"node_id":"IC_kwDOAAMmUc5aZU3Y","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-20T16:03:30Z","updated_at":"2023-04-20T16:03:30Z","author_association":"CONTRIBUTOR","body":"@leanne63 \r\nWould you like to test the new release candidates, if spidermonkey is linked correctly within the app itself?\r\n\r\nhttps://dist.apache.org/repos/dist/dev/couchdb/binary/mac/3.3.2/rc.1/\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516588504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516813979","html_url":"https://github.com/apache/couchdb/issues/4516#issuecomment-1516813979","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4516","id":1516813979,"node_id":"IC_kwDOAAMmUc5aaL6b","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-20T19:08:06Z","updated_at":"2023-04-20T19:08:06Z","author_association":"CONTRIBUTOR","body":"Hey, sorry for the late reply. No, there is no way to silence this notice and error message unless you create this database.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516813979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516909429","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1516909429","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1516909429,"node_id":"IC_kwDOAAMmUc5aajN1","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-20T20:32:03Z","updated_at":"2023-04-20T20:39:17Z","author_association":"NONE","body":"Yes! Installed 3.3.2/rc.1 - got this:\r\n\r\nI'm unable to login (Name or Password Incorrect message) -\r\n  * I edited the etc/local.ini in the app contents to add an admin and password. \r\n  * I made sure to close the Fauxton window and restart CouchDB after setting up the admin info.\r\n  * The path I used is: `/Applications/Apache CouchDB.app/Contents/Resources/couchdbx-core/etc/local.ini`\r\n  * I searched, but don't see a `local.ini` file anywhere else on my system.\r\n  * Here are the contents of my `local.ini` regarding admin setup:\r\n\r\n```\r\n; To create an admin account uncomment the '[admins]' section below and add a\r\n; line in the format 'username = password'. When you next start CouchDB, it\r\n; will change the password to a hash (so that your passwords don't linger\r\n; around in plain-text files). You can add more admin accounts with more\r\n; 'username = password' lines. Don't forget to restart CouchDB after\r\n; changing this.\r\n[admins]\r\nadmin1 = password1\r\n;admin = mysecretpassword\r\n```\r\n\r\nThe logs are showing this upon startup (without login) -\r\n  * Despite the line ending in `All system databases exist.`, it seems that the `_replicator` may still be missing:  toward the end of the log is an `info` line saying: `open_result error {not_found,no_db_file} for _replicator`\r\n  * The repeated errors from before are gone.\r\n\r\n```\r\n[info] 2023-04-20T20:18:44.277441Z couchdb@localhost <0.253.0> -------- Preflight check: Checking For Monsters\r\n\r\n[info] 2023-04-20T20:18:44.277456Z couchdb@localhost <0.253.0> -------- Preflight check: Asserting Admin Account\r\n\r\n[info] 2023-04-20T20:18:44.278843Z couchdb@localhost <0.253.0> -------- Apache CouchDB 3.3.2 is starting.\r\n\r\n[info] 2023-04-20T20:18:44.278855Z couchdb@localhost <0.254.0> -------- Starting couch_sup\r\n[info] 2023-04-20T20:18:44.328828Z couchdb@localhost <0.253.0> -------- Apache CouchDB has started. Time to relax.\r\n\r\n[notice] 2023-04-20T20:18:44.332081Z couchdb@localhost <0.329.0> -------- rexi_server : started servers\r\n[notice] 2023-04-20T20:18:44.332688Z couchdb@localhost <0.333.0> -------- rexi_buffer : started servers\r\n[notice] 2023-04-20T20:18:44.360944Z couchdb@localhost <0.364.0> -------- mem3_reshard_dbdoc start init()\r\n[notice] 2023-04-20T20:18:44.362506Z couchdb@localhost <0.366.0> -------- mem3_reshard start init()\r\n[notice] 2023-04-20T20:18:44.362521Z couchdb@localhost <0.367.0> -------- mem3_reshard db monitor <0.367.0> starting\r\n[notice] 2023-04-20T20:18:44.363487Z couchdb@localhost <0.366.0> -------- mem3_reshard starting reloading jobs\r\n[notice] 2023-04-20T20:18:44.363539Z couchdb@localhost <0.366.0> -------- mem3_reshard finished reloading jobs\r\n[info] 2023-04-20T20:18:44.476107Z couchdb@localhost <0.373.0> -------- Apache CouchDB has started. Time to relax.\r\n\r\n[info] 2023-04-20T20:18:44.476149Z couchdb@localhost <0.373.0> -------- Apache CouchDB has started on http://127.0.0.1:5984/\r\n[notice] 2023-04-20T20:18:44.512900Z couchdb@localhost <0.461.0> -------- All system databases exist.\r\n[notice] 2023-04-20T20:18:44.952062Z couchdb@localhost <0.378.0> e69547df93 127.0.0.1:5984 127.0.0.1 undefined GET /_up 200 ok 27\r\n[notice] 2023-04-20T20:18:45.057367Z couchdb@localhost <0.379.0> cf18f6dddb 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/ 304 ok 2\r\n[notice] 2023-04-20T20:18:45.066481Z couchdb@localhost <0.379.0> c93fcfa561 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/js/manifest.f9cde0db85e3cd97708e.js 304 ok 1\r\n[notice] 2023-04-20T20:18:45.067461Z couchdb@localhost <0.380.0> 9b393f932e 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/css/styles.5bda604c70f688307c36.css 304 ok 0\r\n[notice] 2023-04-20T20:18:45.067753Z couchdb@localhost <0.381.0> 8202f7f626 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/css/styles.2fe6f2383b82d9a7610a.css 304 ok 0\r\n[notice] 2023-04-20T20:18:45.068491Z couchdb@localhost <0.382.0> 3d25a5d31c 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/js/bundle.2fe6f2383b82d9a7610a.js 304 ok 1\r\n[notice] 2023-04-20T20:18:45.068615Z couchdb@localhost <0.383.0> 3c2dccac15 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/js/vendor.5bda604c70f688307c36.js 304 ok 1\r\n[notice] 2023-04-20T20:18:45.102974Z couchdb@localhost <0.382.0> 6666d80191 127.0.0.1:5984 127.0.0.1 undefined GET /_session 200 ok 0\r\n[notice] 2023-04-20T20:18:45.105567Z couchdb@localhost <0.382.0> 2ec4a1df1e 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/img/couchdb-logo.png 304 ok 0\r\n[notice] 2023-04-20T20:18:45.106904Z couchdb@localhost <0.379.0> e74811ff4a 127.0.0.1:5984 127.0.0.1 undefined GET / 200 ok 9\r\n[notice] 2023-04-20T20:18:45.106962Z couchdb@localhost <0.381.0> 7a2ff2fe5f 127.0.0.1:5984 127.0.0.1 undefined GET / 200 ok 4\r\n[notice] 2023-04-20T20:18:45.107010Z couchdb@localhost <0.380.0> af4b3eb70c 127.0.0.1:5984 127.0.0.1 undefined GET / 200 ok 4\r\n[notice] 2023-04-20T20:18:45.109006Z couchdb@localhost <0.379.0> 495704a593 127.0.0.1:5984 127.0.0.1 undefined GET /_session 200 ok 0\r\n[notice] 2023-04-20T20:18:45.109711Z couchdb@localhost <0.380.0> 86d0f2d999 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/img/fauxtonicon5.svg 304 ok 0\r\n[notice] 2023-04-20T20:18:45.109819Z couchdb@localhost <0.381.0> 795ee30144 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/fonts/fontawesome-webfont.woff 304 ok 0\r\n[notice] 2023-04-20T20:18:45.127295Z couchdb@localhost <0.379.0> 9d0f39239c 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/fonts/fauxtonicon5.woff 304 ok 1\r\n[notice] 2023-04-20T20:18:49.491205Z couchdb@localhost <0.423.0> -------- couch_replicator_clustering : cluster stable\r\n[notice] 2023-04-20T20:18:49.497682Z couchdb@localhost <0.445.0> -------- Started replicator db changes listener <0.573.0>\r\n[info] 2023-04-20T20:18:49.498522Z couchdb@localhost <0.575.0> -------- open_result error {not_found,no_db_file} for _replicator\r\n[notice] 2023-04-20T20:18:59.333038Z couchdb@localhost <0.329.0> -------- rexi_server : cluster stable\r\n[notice] 2023-04-20T20:18:59.333130Z couchdb@localhost <0.333.0> -------- rexi_buffer : cluster stable\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516909429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516981528","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1516981528","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1516981528,"node_id":"IC_kwDOAAMmUc5aa00Y","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-20T21:43:31Z","updated_at":"2023-04-20T21:43:31Z","author_association":"NONE","body":"Further, tried doing the `curl` command to add the `_replicator` db - it failed authorization too, so...:\r\n\r\n>% curl -X PUT 'http://admin:pass@127.0.0.1:5984/_replicator'\r\n>{\"error\":\"unauthorized\",\"reason\":\"Name or password is incorrect.\"}\r\n>% curl -X PUT 'http://admin1:password1@127.0.0.1:5984/_replicator'\r\n>{\"error\":\"unauthorized\",\"reason\":\"Name or password is incorrect.\"}\r\n\r\n\r\n```\r\n[warning] 2023-04-20T21:37:42.131975Z couchdb@localhost <0.833.0> c7bca406d4 couch_httpd_auth: Authentication failed for user admin from 127.0.0.1\r\n[notice] 2023-04-20T21:37:42.132324Z couchdb@localhost <0.833.0> c7bca406d4 127.0.0.1:5984 127.0.0.1 undefined PUT /_replicator 401 ok 8\r\n[notice] 2023-04-20T21:37:56.881497Z couchdb@localhost <0.948.0> 2b21cd4144 127.0.0.1:5984 127.0.0.1 undefined PUT /_replicator 401 ok 1\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516981528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516986778","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1516986778","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1516986778,"node_id":"IC_kwDOAAMmUc5aa2Ga","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-20T21:50:12Z","updated_at":"2023-04-20T21:50:12Z","author_association":"CONTRIBUTOR","body":"Close CouchDB and try to delete (take a backup before) `~/Library/Application Support/CouchDB2`. Iirc you should be asked to set a CouchDB password.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1516986778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517246263","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1517246263","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1517246263,"node_id":"IC_kwDOAAMmUc5ab1c3","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-21T04:38:52Z","updated_at":"2023-04-21T13:46:09Z","author_association":"NONE","body":"@big-r81 , renamed the `~/Library/Application Support/CouchDB2`; started CouchDB, and got this window:\r\n\r\n<img width=\"267\" alt=\"Screenshot 2023-04-20 at 11 28 03 PM\" src=\"https://user-images.githubusercontent.com/7043045/233541047-ece035f7-ebc0-45b8-9feb-dd534e25e6fa.png\">\r\n\r\nSelected *Set Password* - the window went away and immediately returned. Selected *Set Password* again - same thing.\r\n\r\nSelected *Cancel and Quit CouchDB*, and that did quit. Reopening just brought the above message again, with the same result.\r\n\r\nThe old directory has folders for `etc` and `var`, both with other folders and files in them. The new directory only has an `etc` folder and `etc/couchDB` with nothing else under it.\r\n\r\nOh, and no log file was produced.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517246263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517656087","html_url":"https://github.com/apache/couchdb/issues/4536#issuecomment-1517656087","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4536","id":1517656087,"node_id":"IC_kwDOAAMmUc5adZgX","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-21T11:02:51Z","updated_at":"2023-04-21T11:02:51Z","author_association":"NONE","body":"Thanks for the feedback.\r\n\r\n> Mochiweb is a separate project and Apache CouchDB at least in the case of long running requests is sort of abusing the typical HTTP API request pattern.\r\n\r\nWould that mean that a fix would be more fitting in CouchDB? Don't mean to push the issue onto CouchDB just thinking about what would be best.\r\n\r\n### Semi new issue\r\n\r\nSince we started investigating our memory issues and we found this issue, we also see that the inflated changes metric might not only be due to the timeouts. Or at least there is something else fishy going on. I don't know if you want me to open a separate issue for that, but I think it fits here.\r\n\r\nLooking at the following graph you can see 2 things:\r\n- Orange is the changes metric\r\n- Green is the amount of sockets reported as allocated minus the sockets in use according to `/proc/net/sockstat`\r\n![image](https://user-images.githubusercontent.com/8522993/233593085-d6fa7b6b-59bd-443d-b2aa-8a13af3dd7ad.png)\r\n![image](https://user-images.githubusercontent.com/8522993/233602403-1e6e6963-c594-42e9-83a6-9a8046ed67a6.png)\r\n\r\nThe drops in the lines to 0 are restarts of couchdb because of memory issues.\r\n\r\nThe first graph is of a time with extra replication going on, so inflated changes listeners. The second is with mainly external pouch listeners.\r\n\r\nWhen looking at the first image and an erlang dump from around 14:00 I could see that the changes processes where taking a lot of memory and as such found the original issue. But if this was the only problem we would expect the counts of the changes to eventually drop at lower traffic times. And we never see that. Even if you look at the night time, when there are far fewer requests coming in. It seems that the timeouts are never triggered and CouchDB is hanging somewhere else.\r\n\r\nThere are some half drops in the changes and sockets around 10:00 in the first and 18:00 and 10:00 in the second image. At that time another node was restarted. So it seems that a bunch of the lingering changes requests are inter-node based.\r\n\r\nAnother thing I can see is that there seems to be a 10 minute delay between the two graphs, exactly the timeout of our chttpd.changes_timeout config value. But the pouch clients request timeouts of 2 minutes.\r\n\r\nI'm going to see if I can get a sense of which processes are in what call graph at the time of such high changes metric and lingering sockets. But maybe you could help me what else I could be looking into?\r\n\r\nAnd one thing you might be able to answer: is it normal to see this many unused sockets? We do have many clients with bad network connections, so that might be causing network issues. But I would expect CouchDB to be able to handle this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517656087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517681072","html_url":"https://github.com/apache/couchdb/pull/4291#issuecomment-1517681072","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4291","id":1517681072,"node_id":"IC_kwDOAAMmUc5adfmw","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-21T11:25:44Z","updated_at":"2023-04-21T11:25:44Z","author_association":"MEMBER","body":"the 'expectation_failed' I think is because some tests run so quickly that the new dbname for the next test is the same. I suspect its a timestamp?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517681072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517689907","html_url":"https://github.com/apache/couchdb/pull/4291#issuecomment-1517689907","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4291","id":1517689907,"node_id":"IC_kwDOAAMmUc5adhwz","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-21T11:35:14Z","updated_at":"2023-04-21T11:35:14Z","author_association":"MEMBER","body":"@nickva thank you for the detailed review, I've pushed a commit with fixes for pretty much all of it. It helped find a silly error in _nouveau_analyze (the core of it worked, I somehow mangled the io_lib bit at some point).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517689907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517916665","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1517916665","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1517916665,"node_id":"IC_kwDOAAMmUc5aeZH5","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-21T14:26:15Z","updated_at":"2023-04-21T14:26:15Z","author_association":"MEMBER","body":"can you retry this process, but as the first two steps:\r\n\r\n1. quit the CouchDB Mac app\r\n2. run `ps ax | grep beam` to see if there are any other erlang processes, and if there are, kill those first","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1517916665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1518056786","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1518056786","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1518056786,"node_id":"IC_kwDOAAMmUc5ae7VS","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-21T16:16:14Z","updated_at":"2023-04-21T16:17:00Z","author_association":"NONE","body":"@janl : made sure app was closed, then ran the command. Got result as follows:\r\n```\r\n% ps ax | grep beam\r\n24933 s000  S+     0:00.00 grep beam\r\n```\r\n\r\nJust to double check, I also checked in Activity Monitor, searching All Processes for `beam` - it didn't find any.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1518056786/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1518664205","html_url":"https://github.com/apache/couchdb/pull/4291#issuecomment-1518664205","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4291","id":1518664205,"node_id":"IC_kwDOAAMmUc5ahPoN","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-22T13:45:52Z","updated_at":"2023-04-22T13:45:52Z","author_association":"MEMBER","body":"leaving branch alive as I squashed the history when I merged. some of the commits might be useful for understanding nascent project history.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1518664205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1520167382","html_url":"https://github.com/apache/couchdb/issues/3356#issuecomment-1520167382","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3356","id":1520167382,"node_id":"IC_kwDOAAMmUc5am-nW","user":{"login":"bravier","id":3956758,"node_id":"MDQ6VXNlcjM5NTY3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/3956758?v=4","gravatar_id":"","url":"https://api.github.com/users/bravier","html_url":"https://github.com/bravier","followers_url":"https://api.github.com/users/bravier/followers","following_url":"https://api.github.com/users/bravier/following{/other_user}","gists_url":"https://api.github.com/users/bravier/gists{/gist_id}","starred_url":"https://api.github.com/users/bravier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bravier/subscriptions","organizations_url":"https://api.github.com/users/bravier/orgs","repos_url":"https://api.github.com/users/bravier/repos","events_url":"https://api.github.com/users/bravier/events{/privacy}","received_events_url":"https://api.github.com/users/bravier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-24T13:31:00Z","updated_at":"2023-04-24T13:31:00Z","author_association":"NONE","body":"@janl we're also impacted by the exact same issue as @adrienverge described.\r\nWe were able to measure in production that 13% of our users were not able to access their database (step 5) even when sleeping at least 15 seconds after user roles are set (step 4) to get a non-403 response.\r\nThis seems abnormal to have to wait that long on a powerful cluster and seems buggy.\r\n\r\nWe would also love to understand a bit more what's happening here, so can you elaborate why CouchDB 4.x will change something when it's out?\r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1520167382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1520242128","html_url":"https://github.com/apache/couchdb/issues/4538#issuecomment-1520242128","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4538","id":1520242128,"node_id":"IC_kwDOAAMmUc5anQ3Q","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-24T14:14:34Z","updated_at":"2023-04-24T14:14:34Z","author_association":"CONTRIBUTOR","body":"```\r\n    {process_died,<0.21853.63>,\r\n        {{nocatch,{invalid_json,{7275,invalid_string}}},\r\n         [{couch_util,json_decode,2,[{file,\"src/couch_util.erl\"},{line,516}]},\r\n```\r\n\r\nInvalid json may indicate 1.7 bulk_get endpoint may not produce a valid json response.\r\n\r\nThere is an option to disable using bulk_get when replicating. The replicator will fetch documents individually then: https://docs.couchdb.org/en/stable/config/replicator.html#replicator/use_bulk_get\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1520242128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1520402890","html_url":"https://github.com/apache/couchdb/pull/4542#issuecomment-1520402890","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4542","id":1520402890,"node_id":"IC_kwDOAAMmUc5an4HK","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-24T15:35:28Z","updated_at":"2023-04-24T15:35:28Z","author_association":"CONTRIBUTOR","body":"To tests the full CI `Jenkinsfile.full` changes use a branch name prefixed with `jenkins-`, so something like `jenkins-enable-nouveau-ci` would work.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1520402890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1520541428","html_url":"https://github.com/apache/couchdb/issues/3356#issuecomment-1520541428","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3356","id":1520541428,"node_id":"IC_kwDOAAMmUc5aoZ70","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-24T17:10:58Z","updated_at":"2023-04-24T21:15:53Z","author_association":"MEMBER","body":"re-reading this, perhaps it is the auth cache instead (or in addition to).\r\n\r\n(noting that couchdb 4.x will not change this behaviour, when Jan first mentioned 4.x we were replacing the clustered code with FoundationDB. That project was abandoned since and will not now be happening).\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1520541428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1521699747","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1521699747","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1521699747,"node_id":"IC_kwDOAAMmUc5as0uj","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-25T12:24:12Z","updated_at":"2023-04-25T12:24:12Z","author_association":"MEMBER","body":"ok, and what happens when you start the install process from scratch now?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1521699747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1521705725","html_url":"https://github.com/apache/couchdb/issues/4372#issuecomment-1521705725","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4372","id":1521705725,"node_id":"IC_kwDOAAMmUc5as2L9","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-25T12:28:38Z","updated_at":"2023-04-25T12:28:38Z","author_association":"MEMBER","body":"should be fixed in 3.2.3 and 3.3.2 released today\r\n\r\n- https://blog.couchdb.org/2023/04/25/3-2-3-3-3-2/\r\n- https://github.com/janl/build-couchdb-mac/commit/8dad21c257e307e7feae7ca6dd86d778ac7d624f\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1521705725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1522052682","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1522052682","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1522052682,"node_id":"IC_kwDOAAMmUc5auK5K","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-25T16:03:41Z","updated_at":"2023-04-25T18:45:02Z","author_association":"NONE","body":"@janl :\r\n> start the install process from scratch\r\n\r\nas in [redownload the DMG](https://couchdb.apache.org/#download) (how I installed CouchDB initially), or\r\nas in [build it from scratch](https://github.com/apache/couchdb/blob/main/INSTALL.Unix.md)?\r\n\r\n**UPDATE**\r\n- Deleted the *CouchDB.app* from *Applications*\r\n- Copied the same *CouchDB.app* from the *.zip* file I used earlier (3.3.2/rc.1/) into *Applications*\r\n- Restarted the app; got the following results:\r\n\r\nThis time, the password window opened and let me set the admin password.\r\n\r\nThe Fauxton page opened, and the verification process appears to have completed with all checkmarks (passing).\r\n\r\nThe log is interesting... \r\n* still missing databases ( `_nodes`, `_dbs`, `_users`) - even though it says it's creating the missing databases\r\n* lots of `shard`-related messages; however, those seem all to be related to the missing databases\r\n\r\nI'll try adding the databases using `curl` to see how it goes from there. Here's the full log - minus a number of repeated errors (noted at the bottom) for this instance, apparently having to do with the missing `_users` database:\r\n\r\n```\r\n[info] 2023-04-25T18:18:06.078304Z couchdb@localhost <0.253.0> -------- Preflight check: Checking For Monsters\r\n\r\n[info] 2023-04-25T18:18:06.078342Z couchdb@localhost <0.253.0> -------- Preflight check: Asserting Admin Account\r\n\r\n[info] 2023-04-25T18:18:06.079580Z couchdb@localhost <0.253.0> -------- Apache CouchDB 3.3.2 is starting.\r\n\r\n[info] 2023-04-25T18:18:06.079598Z couchdb@localhost <0.254.0> -------- Starting couch_sup\r\n[notice] 2023-04-25T18:18:06.120475Z couchdb@localhost <0.109.0> -------- config: [admins] admin set to '****' for reason nil\r\n[info] 2023-04-25T18:18:06.138891Z couchdb@localhost <0.253.0> -------- Apache CouchDB has started. Time to relax.\r\n\r\n[notice] 2023-04-25T18:18:06.143140Z couchdb@localhost <0.329.0> -------- rexi_server : started servers\r\n[notice] 2023-04-25T18:18:06.143770Z couchdb@localhost <0.333.0> -------- rexi_buffer : started servers\r\n[warning] 2023-04-25T18:18:06.154760Z couchdb@localhost <0.341.0> -------- creating missing database: _nodes\r\n[info] 2023-04-25T18:18:06.154777Z couchdb@localhost <0.342.0> -------- open_result error {not_found,no_db_file} for _nodes\r\n[warning] 2023-04-25T18:18:06.177734Z couchdb@localhost <0.357.0> -------- creating missing database: _dbs\r\n[warning] 2023-04-25T18:18:06.177736Z couchdb@localhost <0.358.0> -------- creating missing database: _dbs\r\n[info] 2023-04-25T18:18:06.177751Z couchdb@localhost <0.360.0> -------- open_result error {not_found,no_db_file} for _dbs\r\n[notice] 2023-04-25T18:18:06.182414Z couchdb@localhost <0.372.0> -------- mem3_reshard_dbdoc start init()\r\n[notice] 2023-04-25T18:18:06.184170Z couchdb@localhost <0.374.0> -------- mem3_reshard start init()\r\n[notice] 2023-04-25T18:18:06.184195Z couchdb@localhost <0.375.0> -------- mem3_reshard db monitor <0.375.0> starting\r\n[notice] 2023-04-25T18:18:06.185048Z couchdb@localhost <0.374.0> -------- mem3_reshard starting reloading jobs\r\n[notice] 2023-04-25T18:18:06.185081Z couchdb@localhost <0.374.0> -------- mem3_reshard finished reloading jobs\r\n[info] 2023-04-25T18:18:06.298463Z couchdb@localhost <0.381.0> -------- Apache CouchDB has started. Time to relax.\r\n\r\n[info] 2023-04-25T18:18:06.298517Z couchdb@localhost <0.381.0> -------- Apache CouchDB has started on http://127.0.0.1:5984/\r\n[notice] 2023-04-25T18:18:06.303489Z couchdb@localhost <0.402.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2023-04-25T18:18:06.303588Z couchdb@localhost emulator -------- Error in process <0.403.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[error] 2023-04-25T18:18:06.303656Z couchdb@localhost emulator -------- Error in process <0.403.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[notice] 2023-04-25T18:18:06.325672Z couchdb@localhost <0.450.0> -------- Missing system database _users\r\n[notice] 2023-04-25T18:18:06.713640Z couchdb@localhost <0.386.0> 8c32b6406b 127.0.0.1:5984 127.0.0.1 undefined GET /_up 200 ok 30\r\n[notice] 2023-04-25T18:18:06.827760Z couchdb@localhost <0.387.0> 6a8b85b065 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/ 200 ok 2\r\n[notice] 2023-04-25T18:18:06.831962Z couchdb@localhost <0.388.0> 575de652f1 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/css/styles.5bda604c70f688307c36.css 200 ok 0\r\n[notice] 2023-04-25T18:18:06.832497Z couchdb@localhost <0.389.0> c10f64a077 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/js/manifest.f9cde0db85e3cd97708e.js 200 ok 0\r\n[notice] 2023-04-25T18:18:06.834140Z couchdb@localhost <0.390.0> 82685846ee 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/css/styles.2fe6f2383b82d9a7610a.css 200 ok 2\r\n[notice] 2023-04-25T18:18:06.836519Z couchdb@localhost <0.387.0> 7dbb2e69fb 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/js/vendor.5bda604c70f688307c36.js 200 ok 6\r\n[notice] 2023-04-25T18:18:06.836774Z couchdb@localhost <0.388.0> dc53688bc1 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/js/bundle.2fe6f2383b82d9a7610a.js 200 ok 3\r\n[notice] 2023-04-25T18:18:06.915864Z couchdb@localhost <0.109.0> -------- config: [couchdb] uuid set to e77dd7e197194c2ab9c6976fea923288 for reason nil\r\n[notice] 2023-04-25T18:18:06.923994Z couchdb@localhost <0.390.0> 5000402dfe 127.0.0.1:5984 127.0.0.1 undefined GET /_session 200 ok 0\r\n[notice] 2023-04-25T18:18:06.931623Z couchdb@localhost <0.391.0> 4f0e01a416 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/fonts/fontawesome-webfont.woff 200 ok 1\r\n[notice] 2023-04-25T18:18:06.932127Z couchdb@localhost <0.390.0> f75005cde5 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/img/fauxtonicon5.svg 200 ok 2\r\n[notice] 2023-04-25T18:18:06.937393Z couchdb@localhost <0.390.0> 8e6026d858 127.0.0.1:5984 127.0.0.1 undefined GET /_session 200 ok 0\r\n[notice] 2023-04-25T18:18:06.938506Z couchdb@localhost <0.387.0> 74d7140a2c 127.0.0.1:5984 127.0.0.1 undefined GET / 200 ok 23\r\n[notice] 2023-04-25T18:18:06.938512Z couchdb@localhost <0.389.0> 7a0cbe4c5c 127.0.0.1:5984 127.0.0.1 undefined GET / 200 ok 15\r\n[notice] 2023-04-25T18:18:06.938560Z couchdb@localhost <0.388.0> 88fbec1840 127.0.0.1:5984 127.0.0.1 undefined GET / 200 ok 15\r\n[notice] 2023-04-25T18:18:06.939671Z couchdb@localhost <0.387.0> e8871e5122 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/img/couchdb-logo.png 200 ok 0\r\n[notice] 2023-04-25T18:18:06.962852Z couchdb@localhost <0.387.0> 4a4da10b7d 127.0.0.1:5984 127.0.0.1 undefined GET /_utils/dashboard.assets/fonts/fauxtonicon5.woff 200 ok 1\r\n[notice] 2023-04-25T18:18:07.004966Z couchdb@localhost <0.392.0> 0bd25361bc 127.0.0.1:5984 127.0.0.1 undefined GET /apple-touch-icon-precomposed.png 404 ok 4\r\n[notice] 2023-04-25T18:18:07.005923Z couchdb@localhost <0.392.0> 3d8d3e940a 127.0.0.1:5984 127.0.0.1 undefined GET /apple-touch-icon.png 404 ok 0\r\n[notice] 2023-04-25T18:18:11.304672Z couchdb@localhost <0.402.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2023-04-25T18:18:11.304835Z couchdb@localhost emulator -------- Error in process <0.563.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[error] 2023-04-25T18:18:11.304918Z couchdb@localhost emulator -------- Error in process <0.563.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[notice] 2023-04-25T18:18:11.309191Z couchdb@localhost <0.424.0> -------- couch_replicator_clustering : cluster stable\r\n[notice] 2023-04-25T18:18:11.313721Z couchdb@localhost <0.434.0> -------- Started replicator db changes listener <0.564.0>\r\n[info] 2023-04-25T18:18:11.314076Z couchdb@localhost <0.566.0> -------- open_result error {not_found,no_db_file} for _replicator\r\n[notice] 2023-04-25T18:18:16.306154Z couchdb@localhost <0.402.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2023-04-25T18:18:16.306366Z couchdb@localhost emulator -------- Error in process <0.611.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[error] 2023-04-25T18:18:16.306533Z couchdb@localhost emulator -------- Error in process <0.611.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[notice] 2023-04-25T18:18:20.351596Z couchdb@localhost <0.109.0> -------- config: [chttpd_auth] secret set to fa5d65910a612a5800ad69088b19c07a for reason nil\r\n[notice] 2023-04-25T18:18:20.369202Z couchdb@localhost <0.387.0> a80f71e31a 127.0.0.1:5984 127.0.0.1 undefined POST /_session 200 ok 24\r\n[notice] 2023-04-25T18:18:20.380541Z couchdb@localhost <0.387.0> a6fad85df8 127.0.0.1:5984 127.0.0.1 admin GET /_session 200 ok 1\r\n[notice] 2023-04-25T18:18:20.441424Z couchdb@localhost <0.387.0> 8526b39327 127.0.0.1:5984 127.0.0.1 admin GET /_all_dbs 200 ok 29\r\n[notice] 2023-04-25T18:18:20.813749Z couchdb@localhost <0.387.0> 0695e09c2c 127.0.0.1:5984 127.0.0.1 admin GET /_all_dbs?startkey=%22%22&endkey=%22%E9%A6%99%22&limit=30 200 ok 2\r\n[notice] 2023-04-25T18:18:21.144338Z couchdb@localhost <0.329.0> -------- rexi_server : cluster stable\r\n[notice] 2023-04-25T18:18:21.144455Z couchdb@localhost <0.333.0> -------- rexi_buffer : cluster stable\r\n[notice] 2023-04-25T18:18:21.307880Z couchdb@localhost <0.402.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2023-04-25T18:18:21.308092Z couchdb@localhost emulator -------- Error in process <0.662.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[error] 2023-04-25T18:18:21.308196Z couchdb@localhost emulator -------- Error in process <0.662.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[notice] 2023-04-25T18:18:26.308512Z couchdb@localhost <0.402.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2023-04-25T18:18:26.308666Z couchdb@localhost emulator -------- Error in process <0.704.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[error] 2023-04-25T18:18:26.308718Z couchdb@localhost emulator -------- Error in process <0.704.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[notice] 2023-04-25T18:18:31.310029Z couchdb@localhost <0.402.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2023-04-25T18:18:31.310255Z couchdb@localhost emulator -------- Error in process <0.744.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[error] 2023-04-25T18:18:31.310361Z couchdb@localhost emulator -------- Error in process <0.744.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[notice] 2023-04-25T18:18:36.311697Z couchdb@localhost <0.402.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2023-04-25T18:18:36.311889Z couchdb@localhost emulator -------- Error in process <0.777.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[error] 2023-04-25T18:18:36.311934Z couchdb@localhost emulator -------- Error in process <0.777.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[notice] 2023-04-25T18:18:37.016148Z couchdb@localhost <0.387.0> f64652c281 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb 404 ok 2\r\n[notice] 2023-04-25T18:18:37.016534Z couchdb@localhost <0.776.0> 88419c9088 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb_replicate 404 ok 1\r\n[notice] 2023-04-25T18:18:37.051524Z couchdb@localhost <0.387.0> 1d75ca68ae 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb 201 ok 31\r\n[notice] 2023-04-25T18:18:37.085444Z couchdb@localhost <0.776.0> 27e6c4ce5f 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_1 201 ok 15\r\n[notice] 2023-04-25T18:18:37.091608Z couchdb@localhost <0.776.0> cd60d48471 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_1 201 ok 2\r\n[notice] 2023-04-25T18:18:37.096608Z couchdb@localhost <0.776.0> 47da730732 127.0.0.1:5984 127.0.0.1 admin DELETE /verifytestdb/test_doc_1?rev=2-d588d3e93ee155c5afffdf0247a2c5ef 200 ok 3\r\n[notice] 2023-04-25T18:18:37.102561Z couchdb@localhost <0.776.0> c1fe526d52 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_10 201 ok 3\r\n[notice] 2023-04-25T18:18:37.104386Z couchdb@localhost <0.778.0> 404b5ed6e2 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_20 201 ok 3\r\n[notice] 2023-04-25T18:18:37.105874Z couchdb@localhost <0.780.0> 83e6e6d568 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/test_doc_30 201 ok 3\r\n[notice] 2023-04-25T18:18:37.183861Z couchdb@localhost <0.781.0> 17ec0aaa69 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/_design/view_check 201 ok 81\r\n[info] 2023-04-25T18:18:37.201345Z couchdb@localhost <0.940.0> -------- Starting index update for db: shards/80000000-ffffffff/verifytestdb.1682446717 idx: _design/view_check\r\n[info] 2023-04-25T18:18:37.201408Z couchdb@localhost <0.941.0> -------- Starting index update for db: shards/00000000-7fffffff/verifytestdb.1682446717 idx: _design/view_check\r\n[info] 2023-04-25T18:18:37.206588Z couchdb@localhost <0.940.0> -------- Index update finished for db: shards/80000000-ffffffff/verifytestdb.1682446717 idx: _design/view_check\r\n[info] 2023-04-25T18:18:37.234564Z couchdb@localhost <0.941.0> -------- Index update finished for db: shards/00000000-7fffffff/verifytestdb.1682446717 idx: _design/view_check\r\n[notice] 2023-04-25T18:18:37.234735Z couchdb@localhost <0.776.0> 6b2c26424f 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/_design/view_check/_view/testview 200 ok 48\r\n[notice] 2023-04-25T18:18:37.249482Z couchdb@localhost <0.429.0> -------- couch_replicator_scheduler: Job {\"f88fa19a30001a54bbac190f91ddf477\",\"+create_target\"} started as <0.970.0>\r\n[notice] 2023-04-25T18:18:40.423675Z couchdb@localhost <0.977.0> 8535d28657 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/ 200 ok 1\r\n[notice] 2023-04-25T18:18:40.433948Z couchdb@localhost <0.977.0> b95c0f6e7c 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb_replicate/ 201 ok 10\r\n[notice] 2023-04-25T18:18:40.435475Z couchdb@localhost <0.977.0> d58b80e4b1 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb_replicate/ 200 ok 1\r\n[notice] 2023-04-25T18:18:40.436580Z couchdb@localhost <0.977.0> 9b00ba98c5 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/ 200 ok 1\r\n[notice] 2023-04-25T18:18:40.437674Z couchdb@localhost <0.977.0> 2b0a4062ea 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb_replicate/ 200 ok 1\r\n[notice] 2023-04-25T18:18:40.438671Z couchdb@localhost <0.977.0> 2ff689b6e6 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/_local/f88fa19a30001a54bbac190f91ddf477 404 ok 1\r\n[notice] 2023-04-25T18:18:40.439499Z couchdb@localhost <0.977.0> e803100a13 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/_local/99272134628e0dab94c8d41a3646747f 404 ok 1\r\n[notice] 2023-04-25T18:18:40.440456Z couchdb@localhost <0.977.0> 527dfbecc7 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/_local/04967ba99196d145a939f4b7e7bdf69f 404 ok 1\r\n[notice] 2023-04-25T18:18:40.441490Z couchdb@localhost <0.977.0> 654407ef46 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/_local/3e7646c29c77e4bb7a0da8558ec5f2bf 404 ok 1\r\n[notice] 2023-04-25T18:18:40.442264Z couchdb@localhost <0.977.0> 030ddb8451 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb_replicate/_local/f88fa19a30001a54bbac190f91ddf477 404 ok 0\r\n[notice] 2023-04-25T18:18:40.443040Z couchdb@localhost <0.977.0> 290a7c1315 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb_replicate/_local/99272134628e0dab94c8d41a3646747f 404 ok 1\r\n[notice] 2023-04-25T18:18:40.443866Z couchdb@localhost <0.977.0> 4f9fbec191 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb_replicate/_local/04967ba99196d145a939f4b7e7bdf69f 404 ok 0\r\n[notice] 2023-04-25T18:18:40.444597Z couchdb@localhost <0.977.0> d8eaa3b99a 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb_replicate/_local/3e7646c29c77e4bb7a0da8558ec5f2bf 404 ok 0\r\n[notice] 2023-04-25T18:18:40.447944Z couchdb@localhost <0.977.0> 65314aaa72 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/_changes?feed=normal&style=all_docs&since=0&timeout=10000 200 ok 1\r\n[notice] 2023-04-25T18:18:40.450041Z couchdb@localhost <0.977.0> d9c524a0b5 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/ 200 ok 1\r\n[notice] 2023-04-25T18:18:40.450173Z couchdb@localhost <0.970.0> -------- Starting replication f88fa19a30001a54bbac190f91ddf477+create_target (http://127.0.0.1:5984/verifytestdb/ -> http://127.0.0.1:5984/verifytestdb_replicate/) from _replicate endpoint worker_procesess:4 worker_batch_size:500 session_id:f490f8816126b8d32aac8ae86cd8bb6a\r\n[notice] 2023-04-25T18:18:40.451721Z couchdb@localhost <0.978.0> 996ef5f4fd 127.0.0.1:5984 127.0.0.1 admin POST /verifytestdb_replicate/_revs_diff 200 ok 2\r\n[notice] 2023-04-25T18:18:40.457325Z couchdb@localhost <0.978.0> a7473cbf78 127.0.0.1:5984 127.0.0.1 admin POST /verifytestdb/_bulk_get?latest=true&revs=true&attachments=false 200 ok 5\r\n[notice] 2023-04-25T18:18:40.459014Z couchdb@localhost <0.977.0> cee9a346c2 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb/_design/view_check?revs=true&open_revs=%5B%221-1845fa639169348a576a52acfc0b919b%22%5D&latest=true 200 ok 7\r\n[notice] 2023-04-25T18:18:40.464412Z couchdb@localhost <0.978.0> b729536434 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb_replicate/_design/view_check?new_edits=false 201 ok 5\r\n[notice] 2023-04-25T18:18:40.468230Z couchdb@localhost <0.978.0> a3aa3898e2 127.0.0.1:5984 127.0.0.1 admin POST /verifytestdb_replicate/_bulk_docs 201 ok 3\r\n[notice] 2023-04-25T18:18:40.469086Z couchdb@localhost <0.978.0> a68d83ec69 127.0.0.1:5984 127.0.0.1 admin POST /verifytestdb_replicate/_ensure_full_commit 201 ok 1\r\n[notice] 2023-04-25T18:18:40.469088Z couchdb@localhost <0.977.0> 49c02becbd 127.0.0.1:5984 127.0.0.1 admin POST /verifytestdb/_ensure_full_commit 201 ok 1\r\n[notice] 2023-04-25T18:18:40.469150Z couchdb@localhost <0.970.0> -------- recording a checkpoint for `http://127.0.0.1:5984/verifytestdb/` -> `http://127.0.0.1:5984/verifytestdb_replicate/` at source update_seq <<\"7-g1AAAACbeJzLYWBgYMpgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUklMiTV____PyuDOZElFyjAbmxgapBsmoJNAx5j8liAJEMDkPoPNY0ZbJqpgbF5okUyNn1ZAFw1MGw\">>\r\n[info] 2023-04-25T18:18:40.469573Z couchdb@localhost <0.1166.0> -------- Starting index update for db: shards/00000000-7fffffff/verifytestdb_replicate.1682446720 idx: _design/view_check\r\n[notice] 2023-04-25T18:18:40.471220Z couchdb@localhost <0.978.0> bcb9ff079f 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb/_local/f88fa19a30001a54bbac190f91ddf477 201 ok 2\r\n[info] 2023-04-25T18:18:40.473525Z couchdb@localhost <0.1166.0> -------- Index update finished for db: shards/00000000-7fffffff/verifytestdb_replicate.1682446720 idx: _design/view_check\r\n[notice] 2023-04-25T18:18:40.473810Z couchdb@localhost <0.978.0> 3de4ec1279 127.0.0.1:5984 127.0.0.1 admin PUT /verifytestdb_replicate/_local/f88fa19a30001a54bbac190f91ddf477 201 ok 2\r\n[notice] 2023-04-25T18:18:40.474114Z couchdb@localhost <0.429.0> -------- couch_replicator_scheduler: Job {\"f88fa19a30001a54bbac190f91ddf477\",\"+create_target\"} completed normally\r\n[notice] 2023-04-25T18:18:40.474136Z couchdb@localhost <0.776.0> 268f5dca13 127.0.0.1:5984 127.0.0.1 admin POST /_replicate 200 ok 3235\r\n[info] 2023-04-25T18:18:40.474357Z couchdb@localhost <0.1202.0> -------- Starting index update for db: shards/80000000-ffffffff/verifytestdb_replicate.1682446720 idx: _design/view_check\r\n[info] 2023-04-25T18:18:40.476682Z couchdb@localhost <0.1202.0> -------- Index update finished for db: shards/80000000-ffffffff/verifytestdb_replicate.1682446720 idx: _design/view_check\r\n[notice] 2023-04-25T18:18:40.479466Z couchdb@localhost <0.776.0> 29e27a7a10 127.0.0.1:5984 127.0.0.1 admin GET /verifytestdb_replicate 200 ok 0\r\n[notice] 2023-04-25T18:18:40.501618Z couchdb@localhost <0.778.0> f729afa007 127.0.0.1:5984 127.0.0.1 admin DELETE /verifytestdb 200 ok 4\r\n[notice] 2023-04-25T18:18:40.503912Z couchdb@localhost <0.776.0> eb01e63027 127.0.0.1:5984 127.0.0.1 admin DELETE /verifytestdb_replicate 200 ok 6\r\n[notice] 2023-04-25T18:18:41.313175Z couchdb@localhost <0.402.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2023-04-25T18:18:41.313360Z couchdb@localhost emulator -------- Error in process <0.1252.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[error] 2023-04-25T18:18:41.313463Z couchdb@localhost emulator -------- Error in process <0.1252.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n...\r\n\r\n```\r\n\r\nThis part repeats repeats repeats with different process values (`Error in process <0.1252.0> `) each time:\r\n```\r\n[notice] 2023-04-25T18:18:41.313175Z couchdb@localhost <0.402.0> -------- chttpd_auth_cache changes listener died because the _users database does not exist. Create the database to silence this notice.\r\n[error] 2023-04-25T18:18:41.313360Z couchdb@localhost emulator -------- Error in process <0.1252.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n\r\n[error] 2023-04-25T18:18:41.313463Z couchdb@localhost emulator -------- Error in process <0.1252.0> on node couchdb@localhost with exit value:\r\n{database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,430}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,405}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,434}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,100}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,39}]},{chttpd_auth_cache,ensure_auth_ddoc_exists,2,[{file,\"src/chttpd_auth_cache.erl\"},{line,214}]},{chttpd_auth_cache,listen_for_changes,1,[{file,\"src/chttpd_auth_cache.erl\"},{line,160}]}]}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1522052682/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1522218011","html_url":"https://github.com/apache/couchdb/issues/4536#issuecomment-1522218011","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4536","id":1522218011,"node_id":"IC_kwDOAAMmUc5auzQb","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-25T18:19:52Z","updated_at":"2023-04-25T18:19:52Z","author_association":"CONTRIBUTOR","body":"> Would that mean that a fix would be more fitting in CouchDB? Don't mean to push the issue onto CouchDB just thinking about what would be best.\r\n\r\nYeah I think so. I tried various options and played with sockets a bit and it seems, unless the socket mode is toggled from passive/active or we try to send something on it, we might not find out it's closed. Getting its info or stats doesn't seem to indicate it's closed even.\r\n\r\nThe new experimental `socket` network implementation may have something there but I haven't tried it yet: https://www.erlang.org/doc/man/socket.html\r\n\r\nOne obvious improvement though could be to combine heartbeats and timeouts. So even with a timeout set we still send periodic heartbeats, even if it's just to be able to detect a closed socket.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1522218011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1522278712","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1522278712","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1522278712,"node_id":"IC_kwDOAAMmUc5avCE4","user":{"login":"leanne63","id":7043045,"node_id":"MDQ6VXNlcjcwNDMwNDU=","avatar_url":"https://avatars.githubusercontent.com/u/7043045?v=4","gravatar_id":"","url":"https://api.github.com/users/leanne63","html_url":"https://github.com/leanne63","followers_url":"https://api.github.com/users/leanne63/followers","following_url":"https://api.github.com/users/leanne63/following{/other_user}","gists_url":"https://api.github.com/users/leanne63/gists{/gist_id}","starred_url":"https://api.github.com/users/leanne63/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leanne63/subscriptions","organizations_url":"https://api.github.com/users/leanne63/orgs","repos_url":"https://api.github.com/users/leanne63/repos","events_url":"https://api.github.com/users/leanne63/events{/privacy}","received_events_url":"https://api.github.com/users/leanne63/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-25T19:05:40Z","updated_at":"2023-04-25T19:06:06Z","author_association":"NONE","body":"@janl: part ii:\r\n\r\nI noticed the log was also showing this line:\r\n\r\n```\r\n[info] 2023-04-25T18:54:06.432385Z couchdb@localhost <0.574.0> -------- open_result error {not_found,no_db_file} for _replicator\r\n```\r\n\r\nSo, I also used `curl` to add the `_replicator` database. The new log still showed the same `info` item as above, but now the `_replicator` database shows when I log in.\r\n\r\nHere are the results from my `curl` commands, including the initial ones I performed after seeing the above-referenced \"missing db\" messages. I'm just noting because `_dbs` was apparently present, while the rest were missing, even though the log said they had been created:\r\n\r\n```\r\n% curl -X PUT 'http://admin:myadminpass@127.0.0.1:5984/_users' \r\n{\"ok\":true}\r\n% curl -X PUT 'http://admin:myadminpass@127.0.0.1:5984/_dbs'  \r\n{\"error\":\"file_exists\",\"reason\":\"The database could not be created, the file already exists.\"}\r\n% curl -X PUT 'http://admin:myadminpass@127.0.0.1:5984/_nodes'\r\n{\"ok\":true}\r\n% curl -X PUT 'http://admin:myadminpass@127.0.0.1:5984/_replicator'\r\n{\"ok\":true}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1522278712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1523422424","html_url":"https://github.com/apache/couchdb/issues/3356#issuecomment-1523422424","issue_url":"https://api.github.com/repos/apache/couchdb/issues/3356","id":1523422424,"node_id":"IC_kwDOAAMmUc5azZTY","user":{"login":"bravier","id":3956758,"node_id":"MDQ6VXNlcjM5NTY3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/3956758?v=4","gravatar_id":"","url":"https://api.github.com/users/bravier","html_url":"https://github.com/bravier","followers_url":"https://api.github.com/users/bravier/followers","following_url":"https://api.github.com/users/bravier/following{/other_user}","gists_url":"https://api.github.com/users/bravier/gists{/gist_id}","starred_url":"https://api.github.com/users/bravier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bravier/subscriptions","organizations_url":"https://api.github.com/users/bravier/orgs","repos_url":"https://api.github.com/users/bravier/repos","events_url":"https://api.github.com/users/bravier/events{/privacy}","received_events_url":"https://api.github.com/users/bravier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-26T13:26:46Z","updated_at":"2023-04-26T13:29:20Z","author_association":"NONE","body":"Thanks @rnewson for providing a bit more context.\r\nI understand this is something that is expected and that won't be fixed so we have to deal with it somehow, right?\r\nOtherwise is there something we can dig about the auth cache?\r\nWe tried disabling it (setting [`auth_cache_size`](https://docs.couchdb.org/en/stable/config/auth.html#chttpd_auth/auth_cache_size) to 0) and raising the value too (2000) with no visible effect.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1523422424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1523509839","html_url":"https://github.com/apache/couchdb/issues/4536#issuecomment-1523509839","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4536","id":1523509839,"node_id":"IC_kwDOAAMmUc5azupP","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-26T14:22:30Z","updated_at":"2023-04-26T14:22:30Z","author_association":"NONE","body":"I was also experimenting a bit and I could get it to work with something like this in chttpd:handle_changes_req1\r\n\r\n```erlang\r\n        Feed when Feed =:= \"continuous\"; Feed =:= \"longpoll\"; Feed =:= \"eventsource\" ->\r\n        \tOldControlling = self(),\r\n        \tMochiReq = Req#httpd.mochi_req,\r\n        \tSocket = MochiReq:get(socket),\r\n        \tcouch_log:info(\"----- socket1 ~p -----\", [Socket]),\r\n        \tSocketMonitorPid = spawn_link(fun() ->\r\n        \t\tcouch_log:info(\"----- socket2 ~p -----\", [Socket]),\r\n        \t\treceive ack -> ok end,\r\n        \t\tinet:setopts(Socket, [{active, once}]),\r\n        \t\treceive\r\n        \t\t\tack ->\r\n        \t\t\t\tcouch_log:info(\"----- stopping monitor -----\", []),\r\n        \t\t\t\tinet:setopts(Socket, [{active, false}]),\r\n        \t\t\t\tgen_tcp:controlling_process(Socket, OldControlling),\r\n        \t\t\t\tOldControlling ! ack;\r\n        \t\t\t{tcp, _} ->\r\n        \t\t\t\tcouch_log:info(\"----- data -----\", []),\r\n        \t\t\t\tcouch_stats:decrement_counter([couchdb, httpd, clients_requesting_changes]),\r\n        \t\t\t\texit(self(), {unexpected_data});\r\n        \t\t\t{tcp_closed, _} ->\r\n        \t\t\t\tcouch_log:info(\"----- closed -----\", []),\r\n        \t\t\t\tcouch_stats:decrement_counter([couchdb, httpd, clients_requesting_changes]),\r\n        \t\t\t\terror(tcp_closed_error)\r\n        \t\tend\r\n        \tend),\r\n        \tcouch_log:info(\"----- spawn ~p -----\", [SocketMonitorPid]),\r\n        \tgen_tcp:controlling_process(Socket, SocketMonitorPid),\r\n        \tSocketMonitorPid ! ack,\r\n            couch_stats:increment_counter([couchdb, httpd, clients_requesting_changes]),\r\n            Acc0 = #cacc{\r\n                feed = list_to_atom(Feed),\r\n                mochi = Req,\r\n                threshold = Max\r\n            },\r\n            try\r\n                fabric:changes(Db, fun changes_callback/2, Acc0, ChangesArgs)\r\n            after\r\n            \tSocketMonitorPid ! ack,\r\n            \tcouch_log:info(\"----- done with changes -----\", []),\r\n            \treceive ack-> ok end,\r\n            \tcouch_log:info(\"----- socket back -----\", []),\r\n                couch_stats:decrement_counter([couchdb, httpd, clients_requesting_changes])\r\n            end;\r\n```\r\n\r\nBut I'm new at erlang so there might be something easier to read from the socket in parallel. And this also might have a race condition when the socket is done and should get more data, but I think that is not legal for change feeds, but maybe it is for Keep-Alive sockets.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1523509839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1524086914","html_url":"https://github.com/apache/couchdb/pull/4551#issuecomment-1524086914","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4551","id":1524086914,"node_id":"IC_kwDOAAMmUc5a17iC","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-26T21:49:21Z","updated_at":"2023-04-26T21:49:21Z","author_association":"MEMBER","body":"noting that Content-MD5 header cannot be generalised to other digest algorithms.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1524086914/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1526014138","html_url":"https://github.com/apache/couchdb/issues/1303#issuecomment-1526014138","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1303","id":1526014138,"node_id":"IC_kwDOAAMmUc5a9SC6","user":{"login":"jason-sachs","id":10506541,"node_id":"MDQ6VXNlcjEwNTA2NTQx","avatar_url":"https://avatars.githubusercontent.com/u/10506541?v=4","gravatar_id":"","url":"https://api.github.com/users/jason-sachs","html_url":"https://github.com/jason-sachs","followers_url":"https://api.github.com/users/jason-sachs/followers","following_url":"https://api.github.com/users/jason-sachs/following{/other_user}","gists_url":"https://api.github.com/users/jason-sachs/gists{/gist_id}","starred_url":"https://api.github.com/users/jason-sachs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jason-sachs/subscriptions","organizations_url":"https://api.github.com/users/jason-sachs/orgs","repos_url":"https://api.github.com/users/jason-sachs/repos","events_url":"https://api.github.com/users/jason-sachs/events{/privacy}","received_events_url":"https://api.github.com/users/jason-sachs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-27T16:40:51Z","updated_at":"2023-04-27T16:40:51Z","author_association":"NONE","body":"How do you start nssm.exe manually? It got blocked by Carbon Black when I installed CouchDB. I have since got our IT department to whitelist nssm.exe, but now I don't know what to do. `nssm install couchdb`? `nssm start couchdb`?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1526014138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1526196591","html_url":"https://github.com/apache/couchdb/issues/1303#issuecomment-1526196591","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1303","id":1526196591,"node_id":"IC_kwDOAAMmUc5a9-lv","user":{"login":"big-r81","id":9985963,"node_id":"MDQ6VXNlcjk5ODU5NjM=","avatar_url":"https://avatars.githubusercontent.com/u/9985963?v=4","gravatar_id":"","url":"https://api.github.com/users/big-r81","html_url":"https://github.com/big-r81","followers_url":"https://api.github.com/users/big-r81/followers","following_url":"https://api.github.com/users/big-r81/following{/other_user}","gists_url":"https://api.github.com/users/big-r81/gists{/gist_id}","starred_url":"https://api.github.com/users/big-r81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/big-r81/subscriptions","organizations_url":"https://api.github.com/users/big-r81/orgs","repos_url":"https://api.github.com/users/big-r81/repos","events_url":"https://api.github.com/users/big-r81/events{/privacy}","received_events_url":"https://api.github.com/users/big-r81/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-27T19:05:37Z","updated_at":"2023-04-27T19:05:51Z","author_association":"CONTRIBUTOR","body":"The installer does something like\r\n\r\n```\r\nnssm.exe install <servicename> <program>\r\n```\r\n\r\nto install the service. Like\r\n\r\n```\r\nnssm.exe install \"Apache CouchDB\" \"C:\\PATH-TO-COUCHDB\\bin\\couchdb.cmd\"\r\n```\r\n\r\nYou can also start CouchDB manually with the provided cmd-file.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1526196591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1526892544","html_url":"https://github.com/apache/couchdb/issues/1020#issuecomment-1526892544","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1020","id":1526892544,"node_id":"IC_kwDOAAMmUc5bAogA","user":{"login":"tapiocaboy","id":4618861,"node_id":"MDQ6VXNlcjQ2MTg4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/4618861?v=4","gravatar_id":"","url":"https://api.github.com/users/tapiocaboy","html_url":"https://github.com/tapiocaboy","followers_url":"https://api.github.com/users/tapiocaboy/followers","following_url":"https://api.github.com/users/tapiocaboy/following{/other_user}","gists_url":"https://api.github.com/users/tapiocaboy/gists{/gist_id}","starred_url":"https://api.github.com/users/tapiocaboy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tapiocaboy/subscriptions","organizations_url":"https://api.github.com/users/tapiocaboy/orgs","repos_url":"https://api.github.com/users/tapiocaboy/repos","events_url":"https://api.github.com/users/tapiocaboy/events{/privacy}","received_events_url":"https://api.github.com/users/tapiocaboy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-28T02:31:51Z","updated_at":"2023-04-28T02:31:51Z","author_association":"NONE","body":"@xpagesbeast Thanks heaps\r\n\r\n```\r\nbrew list couchDB | grep ini\r\n/opt/homebrew/Cellar/couchdb/3.3.2/etc/default.ini\r\n/opt/homebrew/Cellar/couchdb/3.3.2/etc/local.ini\r\n/opt/homebrew/Cellar/couchdb/3.3.2/erts-13.2/doc/html/init.html\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1526892544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1527713660","html_url":"https://github.com/apache/couchdb/issues/4521#issuecomment-1527713660","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4521","id":1527713660,"node_id":"IC_kwDOAAMmUc5bDw98","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-28T15:10:03Z","updated_at":"2023-04-28T15:10:03Z","author_association":"CONTRIBUTOR","body":"We got a new KVM-based s390x CI runner and I haven't see the flaky disk failure on it any longer. \r\n\r\nI do keep seeing this error multiple times on it:\r\n\r\n```\r\n[2023-04-13T20:57:28.075Z]      {expression,\"couch_db : load_validation_funs ( Db )\"},\r\n[2023-04-13T20:57:28.075Z]      {pattern,\"{ error , database_does_not_exist , [...] }\"},\r\n[2023-04-13T20:57:28.075Z]      {unexpected_exception,\r\n[2023-04-13T20:57:28.075Z]          {throw,internal_server_error,\r\n[2023-04-13T20:57:28.075Z]              [{couch_db,load_validation_funs,1,[{file,...},{...}]},\r\n```\r\n\r\nBut not sure if that's related to disk issues, I saw it on the newer instance too now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1527713660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1528724843","html_url":"https://github.com/apache/couchdb/issues/4510#issuecomment-1528724843","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4510","id":1528724843,"node_id":"IC_kwDOAAMmUc5bHn1r","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-29T08:58:32Z","updated_at":"2023-04-29T08:58:32Z","author_association":"MEMBER","body":"do you have any important data in your setup, or would you be okay with nuking the database dir?\r\n\r\n```\r\nrm -rf ~/Library/Application\\ Support/CouchDB2/var/lib/couchdb\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1528724843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1528727159","html_url":"https://github.com/apache/couchdb/issues/4549#issuecomment-1528727159","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4549","id":1528727159,"node_id":"IC_kwDOAAMmUc5bHoZ3","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-29T09:07:16Z","updated_at":"2023-04-29T09:07:16Z","author_association":"MEMBER","body":"This is expected behaviour: https://lists.apache.org/thread/z79yxo9bmxwy4xdpfybx5vhmt47z12tl\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1528727159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1528852879","html_url":"https://github.com/apache/couchdb/issues/2221#issuecomment-1528852879","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2221","id":1528852879,"node_id":"IC_kwDOAAMmUc5bIHGP","user":{"login":"avtarnanrey","id":14851188,"node_id":"MDQ6VXNlcjE0ODUxMTg4","avatar_url":"https://avatars.githubusercontent.com/u/14851188?v=4","gravatar_id":"","url":"https://api.github.com/users/avtarnanrey","html_url":"https://github.com/avtarnanrey","followers_url":"https://api.github.com/users/avtarnanrey/followers","following_url":"https://api.github.com/users/avtarnanrey/following{/other_user}","gists_url":"https://api.github.com/users/avtarnanrey/gists{/gist_id}","starred_url":"https://api.github.com/users/avtarnanrey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avtarnanrey/subscriptions","organizations_url":"https://api.github.com/users/avtarnanrey/orgs","repos_url":"https://api.github.com/users/avtarnanrey/repos","events_url":"https://api.github.com/users/avtarnanrey/events{/privacy}","received_events_url":"https://api.github.com/users/avtarnanrey/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-29T19:09:59Z","updated_at":"2023-04-29T19:09:59Z","author_association":"NONE","body":"I'm using `HAProxy` and tried few things but did not work so ended up adding following temporary solution. If anybody finds a proper solution. Please let me know.\r\n\r\n`http-response replace-header Set-Cookie ^((?:.(?!\\ [Ss]ecure))*)$ \\1;\\ Secure`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1528852879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1528915035","html_url":"https://github.com/apache/couchdb/pull/4558#issuecomment-1528915035","issue_url":"https://api.github.com/repos/apache/couchdb/issues/4558","id":1528915035,"node_id":"IC_kwDOAAMmUc5bIWRb","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-30T01:37:07Z","updated_at":"2023-04-30T01:37:07Z","author_association":"CONTRIBUTOR","body":"Full CI pass: https://ci-couchdb.apache.org/blue/organizations/jenkins/jenkins-cm1%2FFullPlatformMatrix/detail/jenkins-erlang-24-min-version/1/pipeline\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1528915035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1529018637","html_url":"https://github.com/apache/couchdb/issues/2603#issuecomment-1529018637","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2603","id":1529018637,"node_id":"IC_kwDOAAMmUc5bIvkN","user":{"login":"praveen-ap","id":7005954,"node_id":"MDQ6VXNlcjcwMDU5NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/7005954?v=4","gravatar_id":"","url":"https://api.github.com/users/praveen-ap","html_url":"https://github.com/praveen-ap","followers_url":"https://api.github.com/users/praveen-ap/followers","following_url":"https://api.github.com/users/praveen-ap/following{/other_user}","gists_url":"https://api.github.com/users/praveen-ap/gists{/gist_id}","starred_url":"https://api.github.com/users/praveen-ap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/praveen-ap/subscriptions","organizations_url":"https://api.github.com/users/praveen-ap/orgs","repos_url":"https://api.github.com/users/praveen-ap/repos","events_url":"https://api.github.com/users/praveen-ap/events{/privacy}","received_events_url":"https://api.github.com/users/praveen-ap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-04-30T12:50:34Z","updated_at":"2023-04-30T12:50:34Z","author_association":"NONE","body":"I have this problem too...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1529018637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1529951632","html_url":"https://github.com/apache/couchdb/issues/2603#issuecomment-1529951632","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2603","id":1529951632,"node_id":"IC_kwDOAAMmUc5bMTWQ","user":{"login":"benel","id":597307,"node_id":"MDQ6VXNlcjU5NzMwNw==","avatar_url":"https://avatars.githubusercontent.com/u/597307?v=4","gravatar_id":"","url":"https://api.github.com/users/benel","html_url":"https://github.com/benel","followers_url":"https://api.github.com/users/benel/followers","following_url":"https://api.github.com/users/benel/following{/other_user}","gists_url":"https://api.github.com/users/benel/gists{/gist_id}","starred_url":"https://api.github.com/users/benel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benel/subscriptions","organizations_url":"https://api.github.com/users/benel/orgs","repos_url":"https://api.github.com/users/benel/repos","events_url":"https://api.github.com/users/benel/events{/privacy}","received_events_url":"https://api.github.com/users/benel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-01T17:00:13Z","updated_at":"2023-05-01T17:00:13Z","author_association":"NONE","body":"> ```yaml \r\n> environment:\r\n>   - 'COUCHDB_USER=admin'\r\n>   - 'COUCHDB_PASSWORD=password' \r\n\r\n@pavellzubkov, did you try also without the quotes?\r\n\r\nPersonally I use:\r\n\r\n```yaml\r\n    environment:\r\n      - COUCHDB_USER=${COUCHDB_USER}\r\n      - COUCHDB_PASSWORD=${COUCHDB_PASSWORD}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1529951632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1530026126","html_url":"https://github.com/apache/couchdb/issues/2603#issuecomment-1530026126","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2603","id":1530026126,"node_id":"IC_kwDOAAMmUc5bMliO","user":{"login":"pavellzubkov","id":18612709,"node_id":"MDQ6VXNlcjE4NjEyNzA5","avatar_url":"https://avatars.githubusercontent.com/u/18612709?v=4","gravatar_id":"","url":"https://api.github.com/users/pavellzubkov","html_url":"https://github.com/pavellzubkov","followers_url":"https://api.github.com/users/pavellzubkov/followers","following_url":"https://api.github.com/users/pavellzubkov/following{/other_user}","gists_url":"https://api.github.com/users/pavellzubkov/gists{/gist_id}","starred_url":"https://api.github.com/users/pavellzubkov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavellzubkov/subscriptions","organizations_url":"https://api.github.com/users/pavellzubkov/orgs","repos_url":"https://api.github.com/users/pavellzubkov/repos","events_url":"https://api.github.com/users/pavellzubkov/events{/privacy}","received_events_url":"https://api.github.com/users/pavellzubkov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-01T18:06:01Z","updated_at":"2023-05-01T18:08:06Z","author_association":"NONE","body":"@benel, @praveen-ap , @kernerdev , @git-AlexS   huh) it is funny bug. i try right now with latest official image 3.3.2 version.\r\nmy docker compose -\r\n```\r\nversion: '3'\r\n\r\nservices:\r\n  db:\r\n    image: couchdb:3.3.2\r\n    restart: always\r\n    volumes:\r\n      - ./etc:/opt/couchdb/etc/local.d\r\n      - ./data:/opt/couchdb/data\r\n      - ./log:/opt/couchdb/var/log  \r\n    ports:\r\n      - \"5984:5984\"    \r\n```\r\nlocal.ini admins part\r\n```\r\n[admins]\r\nadmin = -pbkdf2-468e5ac6817f98582967e49b0ee08f407786917d,b4ceba9e6d3f7c7f8f63e16a5b7ab533,10\r\n; admin = -pbkdf2-40bdd84d22425e3b8419548b73eff92cb721bf7c,17682ea8c1f9a5342dadf8d5f94a8407,10\r\n```\r\nif write like above - then all work fine, but **_if local.ini contain commented row after [admins]_** then couch db fail to start with admin party error.\r\n\r\nthis don't work - \r\n```\r\n[admins]\r\n; admin = -pbkdf2-40bdd84d22425e3b8419548b73eff92cb721bf7c,17682ea8c1f9a5342dadf8d5f94a8407,10\r\nadmin = -pbkdf2-468e5ac6817f98582967e49b0ee08f407786917d,b4ceba9e6d3f7c7f8f63e16a5b7ab533,10\r\n```\r\nthis work fine without environment var admin -\r\n```\r\n[admins]\r\nadmin = -pbkdf2-468e5ac6817f98582967e49b0ee08f407786917d,b4ceba9e6d3f7c7f8f63e16a5b7ab533,10\r\n; admin = -pbkdf2-40bdd84d22425e3b8419548b73eff92cb721bf7c,17682ea8c1f9a5342dadf8d5f94a8407,10\r\n```\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/1530026126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]