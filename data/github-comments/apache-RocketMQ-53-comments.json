[{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/632972114","html_url":"https://github.com/apache/rocketmq/pull/1981#issuecomment-632972114","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1981","id":632972114,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMjk3MjExNA==","user":{"login":"lebron374","id":5032169,"node_id":"MDQ6VXNlcjUwMzIxNjk=","avatar_url":"https://avatars.githubusercontent.com/u/5032169?v=4","gravatar_id":"","url":"https://api.github.com/users/lebron374","html_url":"https://github.com/lebron374","followers_url":"https://api.github.com/users/lebron374/followers","following_url":"https://api.github.com/users/lebron374/following{/other_user}","gists_url":"https://api.github.com/users/lebron374/gists{/gist_id}","starred_url":"https://api.github.com/users/lebron374/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lebron374/subscriptions","organizations_url":"https://api.github.com/users/lebron374/orgs","repos_url":"https://api.github.com/users/lebron374/repos","events_url":"https://api.github.com/users/lebron374/events{/privacy}","received_events_url":"https://api.github.com/users/lebron374/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-23T02:27:04Z","updated_at":"2020-05-23T02:27:04Z","author_association":"CONTRIBUTOR","body":"> Plz modify the code as required and do not mix in unrelated commits\r\n\r\ni meet some problem, what i can do to discard unrelated commits ?\r\nonly need help","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/632972114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/632972340","html_url":"https://github.com/apache/rocketmq/pull/2029#issuecomment-632972340","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2029","id":632972340,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMjk3MjM0MA==","user":{"login":"zhanghaou","id":5668441,"node_id":"MDQ6VXNlcjU2Njg0NDE=","avatar_url":"https://avatars.githubusercontent.com/u/5668441?v=4","gravatar_id":"","url":"https://api.github.com/users/zhanghaou","html_url":"https://github.com/zhanghaou","followers_url":"https://api.github.com/users/zhanghaou/followers","following_url":"https://api.github.com/users/zhanghaou/following{/other_user}","gists_url":"https://api.github.com/users/zhanghaou/gists{/gist_id}","starred_url":"https://api.github.com/users/zhanghaou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhanghaou/subscriptions","organizations_url":"https://api.github.com/users/zhanghaou/orgs","repos_url":"https://api.github.com/users/zhanghaou/repos","events_url":"https://api.github.com/users/zhanghaou/events{/privacy}","received_events_url":"https://api.github.com/users/zhanghaou/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-23T02:29:20Z","updated_at":"2020-05-23T02:29:20Z","author_association":"CONTRIBUTOR","body":"Link [https://github.com/apache/rocketmq/pull/1786](https://github.com/apache/rocketmq/pull/1786)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/632972340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/632977300","html_url":"https://github.com/apache/rocketmq/pull/2029#issuecomment-632977300","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2029","id":632977300,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMjk3NzMwMA==","user":{"login":"zongtanghu","id":5010883,"node_id":"MDQ6VXNlcjUwMTA4ODM=","avatar_url":"https://avatars.githubusercontent.com/u/5010883?v=4","gravatar_id":"","url":"https://api.github.com/users/zongtanghu","html_url":"https://github.com/zongtanghu","followers_url":"https://api.github.com/users/zongtanghu/followers","following_url":"https://api.github.com/users/zongtanghu/following{/other_user}","gists_url":"https://api.github.com/users/zongtanghu/gists{/gist_id}","starred_url":"https://api.github.com/users/zongtanghu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zongtanghu/subscriptions","organizations_url":"https://api.github.com/users/zongtanghu/orgs","repos_url":"https://api.github.com/users/zongtanghu/repos","events_url":"https://api.github.com/users/zongtanghu/events{/privacy}","received_events_url":"https://api.github.com/users/zongtanghu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-23T03:19:07Z","updated_at":"2020-05-23T03:19:07Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/632977300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/632997304","html_url":"https://github.com/apache/rocketmq/pull/2032#issuecomment-632997304","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2032","id":632997304,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMjk5NzMwNA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-23T06:54:07Z","updated_at":"2020-05-23T06:54:07Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/30984159/badge)](https://coveralls.io/builds/30984159)\n\nCoverage increased (+0.08%) to 50.904% when pulling **8b836b21364f40ba28d62ee71c4d25aa6f1fc33e on htf1129:master** into **8ef01a6c635f6972847c40d5540b1945180d7cbd on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/632997304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633337096","html_url":"https://github.com/apache/rocketmq/issues/2031#issuecomment-633337096","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2031","id":633337096,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzMzNzA5Ng==","user":{"login":"coder-zzzz","id":62043001,"node_id":"MDQ6VXNlcjYyMDQzMDAx","avatar_url":"https://avatars.githubusercontent.com/u/62043001?v=4","gravatar_id":"","url":"https://api.github.com/users/coder-zzzz","html_url":"https://github.com/coder-zzzz","followers_url":"https://api.github.com/users/coder-zzzz/followers","following_url":"https://api.github.com/users/coder-zzzz/following{/other_user}","gists_url":"https://api.github.com/users/coder-zzzz/gists{/gist_id}","starred_url":"https://api.github.com/users/coder-zzzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coder-zzzz/subscriptions","organizations_url":"https://api.github.com/users/coder-zzzz/orgs","repos_url":"https://api.github.com/users/coder-zzzz/repos","events_url":"https://api.github.com/users/coder-zzzz/events{/privacy}","received_events_url":"https://api.github.com/users/coder-zzzz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T01:42:33Z","updated_at":"2020-05-25T01:42:33Z","author_association":"CONTRIBUTOR","body":"你可以通过mqadmin查看consumer是否连接正常，或者通过命令行直接发送一条消息测试测试","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633337096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633446411","html_url":"https://github.com/apache/rocketmq/pull/1981#issuecomment-633446411","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1981","id":633446411,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzQ0NjQxMQ==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T08:21:47Z","updated_at":"2020-05-25T08:21:47Z","author_association":"CONTRIBUTOR","body":"> > Plz modify the code as required and do not mix in unrelated commits\r\n> \r\n> i meet some problem, what i can do to discard unrelated commits ?\r\n> only need help\r\n\r\nIMO, maybe you should checkout a new branch and cherry-pick the related commits to new branch, then submmit a new pr.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633446411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633452809","html_url":"https://github.com/apache/rocketmq/pull/1973#issuecomment-633452809","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1973","id":633452809,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzQ1MjgwOQ==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T08:35:46Z","updated_at":"2020-05-25T08:35:46Z","author_association":"CONTRIBUTOR","body":"The code is ok. but plz discard unrelated commits. ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633452809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633479115","html_url":"https://github.com/apache/rocketmq/pull/2029#issuecomment-633479115","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2029","id":633479115,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzQ3OTExNQ==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T09:33:30Z","updated_at":"2020-05-25T09:33:30Z","author_association":"CONTRIBUTOR","body":"link #1689 ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633479115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633518327","html_url":"https://github.com/apache/rocketmq/issues/2015#issuecomment-633518327","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2015","id":633518327,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzUxODMyNw==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T11:08:07Z","updated_at":"2020-05-25T11:08:07Z","author_association":"CONTRIBUTOR","body":"In my opinion, because message size is too large, exceed 8M. Split message in business level, ensure that each message size do not exceed 8M.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633518327/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633624652","html_url":"https://github.com/apache/rocketmq/pull/1973#issuecomment-633624652","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1973","id":633624652,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzYyNDY1Mg==","user":{"login":"lebron374","id":5032169,"node_id":"MDQ6VXNlcjUwMzIxNjk=","avatar_url":"https://avatars.githubusercontent.com/u/5032169?v=4","gravatar_id":"","url":"https://api.github.com/users/lebron374","html_url":"https://github.com/lebron374","followers_url":"https://api.github.com/users/lebron374/followers","following_url":"https://api.github.com/users/lebron374/following{/other_user}","gists_url":"https://api.github.com/users/lebron374/gists{/gist_id}","starred_url":"https://api.github.com/users/lebron374/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lebron374/subscriptions","organizations_url":"https://api.github.com/users/lebron374/orgs","repos_url":"https://api.github.com/users/lebron374/repos","events_url":"https://api.github.com/users/lebron374/events{/privacy}","received_events_url":"https://api.github.com/users/lebron374/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T15:33:12Z","updated_at":"2020-05-25T15:33:12Z","author_association":"CONTRIBUTOR","body":"> The code is ok. but plz discard unrelated commits.\r\n\r\ni create a new pr https://github.com/apache/rocketmq/pull/2039 @RongtongJin ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633624652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633628015","html_url":"https://github.com/apache/rocketmq/pull/1981#issuecomment-633628015","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1981","id":633628015,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzYyODAxNQ==","user":{"login":"lebron374","id":5032169,"node_id":"MDQ6VXNlcjUwMzIxNjk=","avatar_url":"https://avatars.githubusercontent.com/u/5032169?v=4","gravatar_id":"","url":"https://api.github.com/users/lebron374","html_url":"https://github.com/lebron374","followers_url":"https://api.github.com/users/lebron374/followers","following_url":"https://api.github.com/users/lebron374/following{/other_user}","gists_url":"https://api.github.com/users/lebron374/gists{/gist_id}","starred_url":"https://api.github.com/users/lebron374/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lebron374/subscriptions","organizations_url":"https://api.github.com/users/lebron374/orgs","repos_url":"https://api.github.com/users/lebron374/repos","events_url":"https://api.github.com/users/lebron374/events{/privacy}","received_events_url":"https://api.github.com/users/lebron374/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T15:42:25Z","updated_at":"2020-05-25T15:42:25Z","author_association":"CONTRIBUTOR","body":"> > > Plz modify the code as required and do not mix in unrelated commits\r\n> > \r\n> > \r\n> > i meet some problem, what i can do to discard unrelated commits ?\r\n> > only need help\r\n> \r\n> IMO, maybe you should checkout a new branch and cherry-pick the related commits to new branch, then submmit a new pr.\r\n\r\ni create new pr https://github.com/apache/rocketmq/pull/2040/ @RongtongJin ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633628015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633631283","html_url":"https://github.com/apache/rocketmq/pull/2039#issuecomment-633631283","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2039","id":633631283,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzYzMTI4Mw==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T15:51:31Z","updated_at":"2020-05-25T15:51:31Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31016891/badge)](https://coveralls.io/builds/31016891)\n\nCoverage decreased (-0.1%) to 50.892% when pulling **fae6825f880ce592fc087cd86e8812482d68818a on lebron374:comment_fix_v1** into **336599b15a6b72362f308371d863462e19f8a376 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633631283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633631316","html_url":"https://github.com/apache/rocketmq/pull/2039#issuecomment-633631316","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2039","id":633631316,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzYzMTMxNg==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T15:51:38Z","updated_at":"2020-05-25T15:51:38Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2039?src=pr&el=h1) Report\n> Merging [#2039](https://codecov.io/gh/apache/rocketmq/pull/2039?src=pr&el=desc) into [develop](https://codecov.io/gh/apache/rocketmq/commit/336599b15a6b72362f308371d863462e19f8a376&el=desc) will **decrease** coverage by `0.01%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/rocketmq/pull/2039/graphs/tree.svg?width=650&height=150&src=pr&token=4w0sxP1wZv)](https://codecov.io/gh/apache/rocketmq/pull/2039?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #2039      +/-   ##\n=============================================\n- Coverage      45.23%   45.21%   -0.02%     \n+ Complexity      4219     4213       -6     \n=============================================\n  Files            545      545              \n  Lines          35810    35810              \n  Branches        4758     4758              \n=============================================\n- Hits           16197    16193       -4     \n- Misses         17566    17571       +5     \n+ Partials        2047     2046       -1     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/2039?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [.../rocketmq/broker/filter/ConsumerFilterManager.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-YnJva2VyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9icm9rZXIvZmlsdGVyL0NvbnN1bWVyRmlsdGVyTWFuYWdlci5qYXZh) | `72.19% <ø> (ø)` | `33.00 <0.00> (ø)` | |\n| [...apache/rocketmq/remoting/netty/ResponseFuture.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L1Jlc3BvbnNlRnV0dXJlLmphdmE=) | `85.00% <0.00%> (-5.00%)` | `16.00% <0.00%> (-2.00%)` | |\n| [...rocketmq/remoting/netty/NettyRemotingAbstract.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L05ldHR5UmVtb3RpbmdBYnN0cmFjdC5qYXZh) | `46.69% <0.00%> (-4.05%)` | `20.00% <0.00%> (-2.00%)` | |\n| [...nt/impl/consumer/ConsumeMessageOrderlyService.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9Db25zdW1lTWVzc2FnZU9yZGVybHlTZXJ2aWNlLmphdmE=) | `38.98% <0.00%> (-2.53%)` | `16.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/rocketmq/filter/util/BloomFilter.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CbG9vbUZpbHRlci5qYXZh) | `59.13% <0.00%> (-2.16%)` | `25.00% <0.00%> (-1.00%)` | |\n| [...org/apache/rocketmq/common/stats/StatsItemSet.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vc3RhdHMvU3RhdHNJdGVtU2V0LmphdmE=) | `38.09% <0.00%> (-1.59%)` | `12.00% <0.00%> (-1.00%)` | |\n| [...ava/org/apache/rocketmq/filter/util/BitsArray.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CaXRzQXJyYXkuamF2YQ==) | `59.82% <0.00%> (ø)` | `30.00% <0.00%> (ø%)` | |\n| [...rocketmq/client/impl/factory/MQClientInstance.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9mYWN0b3J5L01RQ2xpZW50SW5zdGFuY2UuamF2YQ==) | `46.52% <0.00%> (+0.14%)` | `81.00% <0.00%> (+1.00%)` | |\n| [.../apache/rocketmq/logging/inner/LoggingBuilder.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-bG9nZ2luZy9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbG9nZ2luZy9pbm5lci9Mb2dnaW5nQnVpbGRlci5qYXZh) | `64.08% <0.00%> (+0.15%)` | `3.00% <0.00%> (ø%)` | |\n| [...he/rocketmq/client/trace/AsyncTraceDispatcher.java](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvdHJhY2UvQXN5bmNUcmFjZURpc3BhdGNoZXIuamF2YQ==) | `74.11% <0.00%> (+0.50%)` | `17.00% <0.00%> (ø%)` | |\n| ... and [4 more](https://codecov.io/gh/apache/rocketmq/pull/2039/diff?src=pr&el=tree-more) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/2039?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2039?src=pr&el=footer). Last update [336599b...fae6825](https://codecov.io/gh/apache/rocketmq/pull/2039?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633631316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633631698","html_url":"https://github.com/apache/rocketmq/pull/2038#issuecomment-633631698","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2038","id":633631698,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzYzMTY5OA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T15:52:47Z","updated_at":"2020-05-25T15:52:47Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31016907/badge)](https://coveralls.io/builds/31016907)\n\nCoverage increased (+0.2%) to 51.041% when pulling **fae6825f880ce592fc087cd86e8812482d68818a on lebron374:comment_fix_v1** into **8ef01a6c635f6972847c40d5540b1945180d7cbd on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633631698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633635790","html_url":"https://github.com/apache/rocketmq/pull/2000#issuecomment-633635790","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2000","id":633635790,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzYzNTc5MA==","user":{"login":"lebron374","id":5032169,"node_id":"MDQ6VXNlcjUwMzIxNjk=","avatar_url":"https://avatars.githubusercontent.com/u/5032169?v=4","gravatar_id":"","url":"https://api.github.com/users/lebron374","html_url":"https://github.com/lebron374","followers_url":"https://api.github.com/users/lebron374/followers","following_url":"https://api.github.com/users/lebron374/following{/other_user}","gists_url":"https://api.github.com/users/lebron374/gists{/gist_id}","starred_url":"https://api.github.com/users/lebron374/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lebron374/subscriptions","organizations_url":"https://api.github.com/users/lebron374/orgs","repos_url":"https://api.github.com/users/lebron374/repos","events_url":"https://api.github.com/users/lebron374/events{/privacy}","received_events_url":"https://api.github.com/users/lebron374/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T16:04:30Z","updated_at":"2020-05-25T16:04:30Z","author_association":"CONTRIBUTOR","body":"i create new pr https://github.com/apache/rocketmq/pull/2041","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633635790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633636024","html_url":"https://github.com/apache/rocketmq/pull/2040#issuecomment-633636024","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2040","id":633636024,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzYzNjAyNA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T16:05:15Z","updated_at":"2020-05-25T16:05:15Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31017149/badge)](https://coveralls.io/builds/31017149)\n\nCoverage increased (+0.006%) to 51.0% when pulling **4feb8cae0cf3d4432e7a3beb4b48377f1b33e2ae on lebron374:npe_fix_v1** into **336599b15a6b72362f308371d863462e19f8a376 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633636024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633636062","html_url":"https://github.com/apache/rocketmq/pull/2040#issuecomment-633636062","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2040","id":633636062,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzYzNjA2Mg==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T16:05:23Z","updated_at":"2020-05-25T16:05:23Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2040?src=pr&el=h1) Report\n> Merging [#2040](https://codecov.io/gh/apache/rocketmq/pull/2040?src=pr&el=desc) into [develop](https://codecov.io/gh/apache/rocketmq/commit/336599b15a6b72362f308371d863462e19f8a376&el=desc) will **decrease** coverage by `0.02%`.\n> The diff coverage is `0.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/rocketmq/pull/2040/graphs/tree.svg?width=650&height=150&src=pr&token=4w0sxP1wZv)](https://codecov.io/gh/apache/rocketmq/pull/2040?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #2040      +/-   ##\n=============================================\n- Coverage      45.23%   45.20%   -0.03%     \n+ Complexity      4219     4216       -3     \n=============================================\n  Files            545      545              \n  Lines          35810    35810              \n  Branches        4758     4760       +2     \n=============================================\n- Hits           16197    16189       -8     \n- Misses         17566    17576      +10     \n+ Partials        2047     2045       -2     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/2040?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...org/apache/rocketmq/common/message/MessageExt.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vbWVzc2FnZS9NZXNzYWdlRXh0LmphdmE=) | `68.23% <0.00%> (ø)` | `34.00 <0.00> (ø)` | |\n| [...nt/impl/consumer/ConsumeMessageOrderlyService.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9Db25zdW1lTWVzc2FnZU9yZGVybHlTZXJ2aWNlLmphdmE=) | `38.98% <0.00%> (-2.53%)` | `16.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/rocketmq/filter/util/BloomFilter.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CbG9vbUZpbHRlci5qYXZh) | `59.13% <0.00%> (-2.16%)` | `25.00% <0.00%> (-1.00%)` | |\n| [...org/apache/rocketmq/common/stats/StatsItemSet.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vc3RhdHMvU3RhdHNJdGVtU2V0LmphdmE=) | `38.09% <0.00%> (-1.59%)` | `12.00% <0.00%> (-1.00%)` | |\n| [...n/java/org/apache/rocketmq/store/ha/HAService.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL2hhL0hBU2VydmljZS5qYXZh) | `67.54% <0.00%> (-0.34%)` | `18.00% <0.00%> (ø%)` | |\n| [.../apache/rocketmq/logging/inner/LoggingBuilder.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-bG9nZ2luZy9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbG9nZ2luZy9pbm5lci9Mb2dnaW5nQnVpbGRlci5qYXZh) | `63.60% <0.00%> (-0.32%)` | `3.00% <0.00%> (ø%)` | |\n| [...ava/org/apache/rocketmq/filter/util/BitsArray.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CaXRzQXJyYXkuamF2YQ==) | `59.82% <0.00%> (ø)` | `30.00% <0.00%> (ø%)` | |\n| [...he/rocketmq/client/trace/AsyncTraceDispatcher.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvdHJhY2UvQXN5bmNUcmFjZURpc3BhdGNoZXIuamF2YQ==) | `74.11% <0.00%> (+0.50%)` | `17.00% <0.00%> (ø%)` | |\n| [...ketmq/common/protocol/body/ConsumerConnection.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vcHJvdG9jb2wvYm9keS9Db25zdW1lckNvbm5lY3Rpb24uamF2YQ==) | `100.00% <0.00%> (+4.16%)` | `14.00% <0.00%> (+1.00%)` | |\n| [...in/java/org/apache/rocketmq/test/util/MQAdmin.java](https://codecov.io/gh/apache/rocketmq/pull/2040/diff?src=pr&el=tree#diff-dGVzdC9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvdGVzdC91dGlsL01RQWRtaW4uamF2YQ==) | `44.44% <0.00%> (+4.44%)` | `8.00% <0.00%> (+1.00%)` | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/2040?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2040?src=pr&el=footer). Last update [336599b...4feb8ca](https://codecov.io/gh/apache/rocketmq/pull/2040?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633636062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633642822","html_url":"https://github.com/apache/rocketmq/pull/2041#issuecomment-633642822","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2041","id":633642822,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzY0MjgyMg==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T16:26:19Z","updated_at":"2020-05-25T16:26:19Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31017497/badge)](https://coveralls.io/builds/31017497)\n\nCoverage increased (+0.3%) to 51.261% when pulling **39901a0b6852e37838071bc49be84a1d96cc9100 on lebron374:thread_safe_fix_v1** into **336599b15a6b72362f308371d863462e19f8a376 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633642822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633642869","html_url":"https://github.com/apache/rocketmq/pull/2041#issuecomment-633642869","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2041","id":633642869,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzY0Mjg2OQ==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T16:26:27Z","updated_at":"2020-05-25T16:26:27Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2041?src=pr&el=h1) Report\n> Merging [#2041](https://codecov.io/gh/apache/rocketmq/pull/2041?src=pr&el=desc) into [develop](https://codecov.io/gh/apache/rocketmq/commit/336599b15a6b72362f308371d863462e19f8a376&el=desc) will **increase** coverage by `0.28%`.\n> The diff coverage is `85.71%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/rocketmq/pull/2041/graphs/tree.svg?width=650&height=150&src=pr&token=4w0sxP1wZv)](https://codecov.io/gh/apache/rocketmq/pull/2041?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #2041      +/-   ##\n=============================================\n+ Coverage      45.23%   45.51%   +0.28%     \n- Complexity      4219     4233      +14     \n=============================================\n  Files            545      545              \n  Lines          35810    35819       +9     \n  Branches        4758     4760       +2     \n=============================================\n+ Hits           16197    16302     +105     \n+ Misses         17566    17465     -101     \n- Partials        2047     2052       +5     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/2041?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...a/org/apache/rocketmq/store/StoreStatsService.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL1N0b3JlU3RhdHNTZXJ2aWNlLmphdmE=) | `67.09% <83.33%> (+38.24%)` | `43.00 <0.00> (+18.00)` | |\n| [.../org/apache/rocketmq/store/index/IndexService.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL2luZGV4L0luZGV4U2VydmljZS5qYXZh) | `57.36% <87.50%> (+0.37%)` | `31.00 <0.00> (+2.00)` | |\n| [...rocketmq/broker/filtersrv/FilterServerManager.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-YnJva2VyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9icm9rZXIvZmlsdGVyc3J2L0ZpbHRlclNlcnZlck1hbmFnZXIuamF2YQ==) | `20.00% <0.00%> (-14.29%)` | `5.00% <0.00%> (-2.00%)` | |\n| [...tmq/logappender/log4j2/RocketmqLog4j2Appender.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-bG9nYXBwZW5kZXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL2xvZ2FwcGVuZGVyL2xvZzRqMi9Sb2NrZXRtcUxvZzRqMkFwcGVuZGVyLmphdmE=) | `35.00% <0.00%> (-10.00%)` | `3.00% <0.00%> (-1.00%)` | |\n| [...nt/impl/consumer/ConsumeMessageOrderlyService.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9Db25zdW1lTWVzc2FnZU9yZGVybHlTZXJ2aWNlLmphdmE=) | `38.98% <0.00%> (-2.53%)` | `16.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/rocketmq/filter/util/BloomFilter.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CbG9vbUZpbHRlci5qYXZh) | `59.13% <0.00%> (-2.16%)` | `25.00% <0.00%> (-1.00%)` | |\n| [...ava/org/apache/rocketmq/filter/util/BitsArray.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CaXRzQXJyYXkuamF2YQ==) | `58.11% <0.00%> (-1.71%)` | `29.00% <0.00%> (-1.00%)` | |\n| [...rocketmq/client/impl/factory/MQClientInstance.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9mYWN0b3J5L01RQ2xpZW50SW5zdGFuY2UuamF2YQ==) | `45.93% <0.00%> (-0.45%)` | `80.00% <0.00%> (ø%)` | |\n| [.../apache/rocketmq/logging/inner/LoggingBuilder.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-bG9nZ2luZy9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbG9nZ2luZy9pbm5lci9Mb2dnaW5nQnVpbGRlci5qYXZh) | `63.60% <0.00%> (-0.32%)` | `3.00% <0.00%> (ø%)` | |\n| [...he/rocketmq/client/trace/AsyncTraceDispatcher.java](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvdHJhY2UvQXN5bmNUcmFjZURpc3BhdGNoZXIuamF2YQ==) | `74.11% <0.00%> (+0.50%)` | `17.00% <0.00%> (ø%)` | |\n| ... and [3 more](https://codecov.io/gh/apache/rocketmq/pull/2041/diff?src=pr&el=tree-more) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/2041?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2041?src=pr&el=footer). Last update [336599b...39901a0](https://codecov.io/gh/apache/rocketmq/pull/2041?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633642869/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633649959","html_url":"https://github.com/apache/rocketmq/pull/2043#issuecomment-633649959","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2043","id":633649959,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzY0OTk1OQ==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T16:49:05Z","updated_at":"2020-05-25T16:49:05Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31017949/badge)](https://coveralls.io/builds/31017949)\n\nCoverage increased (+0.09%) to 51.084% when pulling **3245bd3cc604ca7ad30b29eb8469102320478a2d on wqliang:selectNamesrv** into **336599b15a6b72362f308371d863462e19f8a376 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633649959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633649997","html_url":"https://github.com/apache/rocketmq/pull/2043#issuecomment-633649997","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2043","id":633649997,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzY0OTk5Nw==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-25T16:49:14Z","updated_at":"2025-01-24T12:59:30Z","author_association":"NONE","body":"## [Codecov](https://app.codecov.io/gh/apache/rocketmq/pull/2043?dropdown=coverage&src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) Report\nAttention: Patch coverage is `0%` with `2 lines` in your changes missing coverage. Please review.\n> Project coverage is 45.27%. Comparing base [(`336599b`)](https://app.codecov.io/gh/apache/rocketmq/commit/336599b15a6b72362f308371d863462e19f8a376?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) to head [(`3245bd3`)](https://app.codecov.io/gh/apache/rocketmq/commit/3245bd3cc604ca7ad30b29eb8469102320478a2d?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache).\n> Report is 7344 commits behind head on develop.\n\n| [Files with missing lines](https://app.codecov.io/gh/apache/rocketmq/pull/2043?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | Patch % | Lines |\n|---|---|---|\n| [...e/rocketmq/remoting/netty/NettyRemotingClient.java](https://app.codecov.io/gh/apache/rocketmq/pull/2043?src=pr&el=tree&filepath=remoting%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Frocketmq%2Fremoting%2Fnetty%2FNettyRemotingClient.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L05ldHR5UmVtb3RpbmdDbGllbnQuamF2YQ==) | 0.00% | [2 Missing :warning: ](https://app.codecov.io/gh/apache/rocketmq/pull/2043?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) |\n\n<details><summary>Additional details and impacted files</summary>\n\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #2043      +/-   ##\n=============================================\n+ Coverage      45.23%   45.27%   +0.04%     \n- Complexity      4219     4222       +3     \n=============================================\n  Files            545      545              \n  Lines          35810    35812       +2     \n  Branches        4758     4759       +1     \n=============================================\n+ Hits           16197    16213      +16     \n+ Misses         17566    17558       -8     \n+ Partials        2047     2041       -6     \n```\n\n</details>\n\n[:umbrella: View full report in Codecov by Sentry](https://app.codecov.io/gh/apache/rocketmq/pull/2043?dropdown=coverage&src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache).   \n:loudspeaker: Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633649997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633761447","html_url":"https://github.com/apache/rocketmq/issues/2033#issuecomment-633761447","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2033","id":633761447,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzc2MTQ0Nw==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-26T01:20:41Z","updated_at":"2020-05-26T01:20:41Z","author_association":"CONTRIBUTOR","body":"Generally, return CONSUME_LATER means there is no new messages or to decrease consume speed. Message is CONSUMED meaning is apparent. It seems these two statuses have no relations.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633761447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633896749","html_url":"https://github.com/apache/rocketmq/issues/1725#issuecomment-633896749","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1725","id":633896749,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzg5Njc0OQ==","user":{"login":"xyz327","id":6970681,"node_id":"MDQ6VXNlcjY5NzA2ODE=","avatar_url":"https://avatars.githubusercontent.com/u/6970681?v=4","gravatar_id":"","url":"https://api.github.com/users/xyz327","html_url":"https://github.com/xyz327","followers_url":"https://api.github.com/users/xyz327/followers","following_url":"https://api.github.com/users/xyz327/following{/other_user}","gists_url":"https://api.github.com/users/xyz327/gists{/gist_id}","starred_url":"https://api.github.com/users/xyz327/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xyz327/subscriptions","organizations_url":"https://api.github.com/users/xyz327/orgs","repos_url":"https://api.github.com/users/xyz327/repos","events_url":"https://api.github.com/users/xyz327/events{/privacy}","received_events_url":"https://api.github.com/users/xyz327/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-26T08:52:01Z","updated_at":"2020-05-26T08:52:01Z","author_association":"NONE","body":"最终是切换到4.6.0解决的问题吗？我这边4.4.0遇到类似的问题，回查返回commit/rollback后还是会继续回查","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/633896749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634138849","html_url":"https://github.com/apache/rocketmq/issues/2031#issuecomment-634138849","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2031","id":634138849,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDEzODg0OQ==","user":{"login":"lebron374","id":5032169,"node_id":"MDQ6VXNlcjUwMzIxNjk=","avatar_url":"https://avatars.githubusercontent.com/u/5032169?v=4","gravatar_id":"","url":"https://api.github.com/users/lebron374","html_url":"https://github.com/lebron374","followers_url":"https://api.github.com/users/lebron374/followers","following_url":"https://api.github.com/users/lebron374/following{/other_user}","gists_url":"https://api.github.com/users/lebron374/gists{/gist_id}","starred_url":"https://api.github.com/users/lebron374/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lebron374/subscriptions","organizations_url":"https://api.github.com/users/lebron374/orgs","repos_url":"https://api.github.com/users/lebron374/repos","events_url":"https://api.github.com/users/lebron374/events{/privacy}","received_events_url":"https://api.github.com/users/lebron374/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-26T16:38:27Z","updated_at":"2020-05-26T16:38:27Z","author_association":"CONTRIBUTOR","body":"可以通过mqadmin追踪下消息的写入和消费时间，确认是不是本身消费端的问题","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634138849/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634366329","html_url":"https://github.com/apache/rocketmq/issues/2031#issuecomment-634366329","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2031","id":634366329,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDM2NjMyOQ==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T01:17:23Z","updated_at":"2020-05-27T01:17:23Z","author_association":"CONTRIBUTOR","body":"@xiebin2015 除了上面两位同学的意见，看下consumer有多少在线，是否有订阅信息不一致的情况。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634366329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634366684","html_url":"https://github.com/apache/rocketmq/issues/2044#issuecomment-634366684","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2044","id":634366684,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDM2NjY4NA==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T01:18:36Z","updated_at":"2020-05-27T01:18:36Z","author_association":"CONTRIBUTOR","body":"yup，can you submit a pr to fix it? ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634366684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634376230","html_url":"https://github.com/apache/rocketmq/issues/1725#issuecomment-634376230","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1725","id":634376230,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDM3NjIzMA==","user":{"login":"duhenglucky","id":7938968,"node_id":"MDQ6VXNlcjc5Mzg5Njg=","avatar_url":"https://avatars.githubusercontent.com/u/7938968?v=4","gravatar_id":"","url":"https://api.github.com/users/duhenglucky","html_url":"https://github.com/duhenglucky","followers_url":"https://api.github.com/users/duhenglucky/followers","following_url":"https://api.github.com/users/duhenglucky/following{/other_user}","gists_url":"https://api.github.com/users/duhenglucky/gists{/gist_id}","starred_url":"https://api.github.com/users/duhenglucky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duhenglucky/subscriptions","organizations_url":"https://api.github.com/users/duhenglucky/orgs","repos_url":"https://api.github.com/users/duhenglucky/repos","events_url":"https://api.github.com/users/duhenglucky/events{/privacy}","received_events_url":"https://api.github.com/users/duhenglucky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T01:45:39Z","updated_at":"2020-05-27T01:45:39Z","author_association":"CONTRIBUTOR","body":"> 最终是切换到4.6.0解决的问题吗？我这边4.4.0遇到类似的问题，回查返回commit/rollback后还是会继续回查\r\n\r\n建议升级，有些corner case在4.6.0之后统一修复了。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634376230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634553033","html_url":"https://github.com/apache/rocketmq/pull/1939#issuecomment-634553033","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1939","id":634553033,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDU1MzAzMw==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T09:49:10Z","updated_at":"2020-05-27T09:49:10Z","author_association":"CONTRIBUTOR","body":"@tuobuxie Could you please submit a issue to link this pr?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634553033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634553203","html_url":"https://github.com/apache/rocketmq/pull/2032#issuecomment-634553203","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2032","id":634553203,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDU1MzIwMw==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T09:49:32Z","updated_at":"2020-05-27T09:49:32Z","author_association":"CONTRIBUTOR","body":"@htf1129 Could you please submit a issue to link this pr?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634553203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634617413","html_url":"https://github.com/apache/rocketmq/pull/1985#issuecomment-634617413","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1985","id":634617413,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDYxNzQxMw==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T12:10:01Z","updated_at":"2020-06-01T08:35:44Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/1985?src=pr&el=h1) Report\n> :exclamation: No coverage uploaded for pull request base (`develop@3974677`). [Click here to learn what that means](https://docs.codecov.io/docs/error-reference#section-missing-base-commit).\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/rocketmq/pull/1985/graphs/tree.svg?width=650&height=150&src=pr&token=4w0sxP1wZv)](https://codecov.io/gh/apache/rocketmq/pull/1985?src=pr&el=tree)\n\n```diff\n@@            Coverage Diff             @@\n##             develop    #1985   +/-   ##\n==========================================\n  Coverage           ?   45.38%           \n  Complexity         ?     4238           \n==========================================\n  Files              ?      545           \n  Lines              ?    35844           \n  Branches           ?     4762           \n==========================================\n  Hits               ?    16268           \n  Misses             ?    17523           \n  Partials           ?     2053           \n```\n\n\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/1985?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/1985?src=pr&el=footer). Last update [3974677...cff29cd](https://codecov.io/gh/apache/rocketmq/pull/1985?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634617413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634627588","html_url":"https://github.com/apache/rocketmq/issues/2045#issuecomment-634627588","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2045","id":634627588,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDYyNzU4OA==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T12:30:24Z","updated_at":"2020-05-27T12:30:24Z","author_association":"CONTRIBUTOR","body":"> Hi, I a freshmen in Github and I am not quite sure how to raise up an issue or a potential issue.\r\n> [https://github.com/apache/rocketmq/blob/master/remoting/src/main/java/org/apache/rocketmq/remoting/netty/NettyRemotingAbstract.java](url) line:229\r\n> `NettyRequestProcessor processor = pair.getObject1(); RemotingCommand response = processor.processRequest(ctx, cmd); doAfterRpcHooks(RemotingHelper.parseChannelRemoteAddr(ctx.channel()), cmd, response); callback.callback(response);`\r\n> \r\n> For NettyRequestProcessor, the method, doAfterRpcHooks(), will be executed the second time in callback.\r\n> \r\n> It may not have any practical impact and i am just wondering if that part is intended or a typo or something.\r\n\r\nI agree with you, customer's rpc callback would be called twice, it makes something wrong.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634627588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634642620","html_url":"https://github.com/apache/rocketmq/issues/2027#issuecomment-634642620","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2027","id":634642620,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDY0MjYyMA==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T12:59:16Z","updated_at":"2020-05-27T12:59:16Z","author_association":"CONTRIBUTOR","body":"> The issue tracker is **ONLY** used for bug report(feature request need to follow [RIP process](https://github.com/apache/rocketmq/wiki/RocketMQ-Improvement-Proposal)). Keep in mind, please check whether there is an existing same report before your raise a new one.\r\n> \r\n> Alternately (especially if your communication is not a bug report), you can send mail to our [mailing lists](http://rocketmq.apache.org/about/contact/). We welcome any friendly suggestions, bug fixes, collaboration and other improvements.\r\n> \r\n> Please ensure that your bug report is clear and that it is complete. Otherwise, we may be unable to understand it or to reproduce it, either of which would prevent us from fixing the bug. We strongly recommend the report(bug report or feature request) could include some hints as the following:\r\n> \r\n> Welcome any discussions~\r\n> **BUG REPORT**\r\n> \r\n> 1. Please describe the issue you observed:\r\n>    In DefaultMessageStore#findConsumeQueue(String topic, int queueId), I noticed it's implementation will create a new ConsumeQueue, if for given topic and queueId is not found in the map.\r\n> \r\n> findConsumeQueue() implementation:\r\n> \r\n> ```\r\n>     public ConsumeQueue findConsumeQueue(String topic, int queueId) {\r\n>         ConcurrentMap<Integer, ConsumeQueue> map = consumeQueueTable.get(topic);\r\n>         if (null == map) {\r\n>             ConcurrentMap<Integer, ConsumeQueue> newMap = new ConcurrentHashMap<Integer, ConsumeQueue>(128);\r\n>             ConcurrentMap<Integer, ConsumeQueue> oldMap = consumeQueueTable.putIfAbsent(topic, newMap);\r\n>             if (oldMap != null) {\r\n>                 map = oldMap;\r\n>             } else {\r\n>                 map = newMap;\r\n>             }\r\n>         }\r\n> \r\n>         ConsumeQueue logic = map.get(queueId);\r\n>         if (null == logic) {\r\n>             ConsumeQueue newLogic = new ConsumeQueue(\r\n>                 topic,\r\n>                 queueId,\r\n>                 StorePathConfigHelper.getStorePathConsumeQueue(this.messageStoreConfig.getStorePathRootDir()),\r\n>                 this.getMessageStoreConfig().getMappedFileSizeConsumeQueue(),\r\n>                 this);\r\n>             ConsumeQueue oldLogic = map.putIfAbsent(queueId, newLogic);\r\n>             if (oldLogic != null) {\r\n>                 logic = oldLogic;\r\n>             } else {\r\n>                 logic = newLogic;\r\n>             }\r\n>         }\r\n> \r\n>         return logic;\r\n>     }\r\n> ```\r\n> \r\n> This implies the return value of findConsumeQueue() is never null.\r\n> \r\n> However i searched all use cases of findConsumeQueue() like this one:\r\n> \r\n> ```\r\n>     public long getMaxOffsetInQueue(String topic, int queueId) {\r\n>         ConsumeQueue logic = this.findConsumeQueue(topic, queueId);\r\n>         if (logic != null) {\r\n>             long offset = logic.getMaxOffsetInQueue();\r\n>             return offset;\r\n>         }\r\n>         return 0;\r\n>     }\r\n> ```\r\n> \r\n> It checked whether the `logic` is null. I feel like from the use cases and the method name,findConsumeQueue() might be a read-only method. (it shouldn't change any internal state like creating, inserting queues into map). This method name might confuse developers when they simply want to do a query but mutated the states.\r\n> \r\n> Only place that leveraged its write-access feature is here :\r\n> \r\n> ```\r\n>     public void putMessagePositionInfo(DispatchRequest dispatchRequest) {\r\n>         ConsumeQueue cq = this.findConsumeQueue(dispatchRequest.getTopic(), dispatchRequest.getQueueId());\r\n>         cq.putMessagePositionInfoWrapper(dispatchRequest);\r\n>     }\r\n> ```\r\n> \r\n> It didn't do any null check and are delegating findConsumeQueue() to create the consume queue if the topic-queueId pair was not found.\r\n> \r\n> And this place relates to a bug #1852 .\r\n> \r\n> It might be better if we either change the method name to findConsumeQueueAndCreateIfNotExist() or we return null when not found. But one problem is findConsumeQueueAndCreateIfNotExist() is referebced by 20+ lines so we need to be very careful to not break anything if we want to change the behaviour of this method.\r\n> \r\n> * What did you do (The steps to reproduce)?\r\n> * What did you expect to see?\r\n> * What did you see instead?\r\n> \r\n> 1. Please tell us about your environment:\r\n> 2. Other information (e.g. detailed explanation, logs, related issues, suggestions how to fix, etc):\r\n> \r\n> **FEATURE REQUEST**\r\n> \r\n> 1. Please describe the feature you are requesting.\r\n> 2. Provide any additional detail on your proposed use case for this feature.\r\n> 3. Indicate the importance of this issue to you (blocker, must-have, should-have, nice-to-have). Are you currently using any workarounds to address this issue?\r\n> 4. If there are some sub-tasks using -[] for each subtask and create a corresponding issue to map to the sub task:\r\n> \r\n> * [sub-task1-issue-number](example_sub_issue1_link_here): sub-task1 description here,\r\n> * [sub-task2-issue-number](example_sub_issue2_link_here): sub-task2 description here,\r\n> * ...\r\n\r\nI support your suggestion, seperate findConsumeQueue() method to  findConsumeQueueAndCreateIfNotExist() and findConsumeQueue(). Thus, it does not modify consumeQueueTable.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634642620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634652299","html_url":"https://github.com/apache/rocketmq/issues/2046#issuecomment-634652299","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2046","id":634652299,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDY1MjI5OQ==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T13:15:56Z","updated_at":"2020-05-27T13:15:56Z","author_association":"CONTRIBUTOR","body":"> branch 4.7.0\r\n> class MQFaultStrategy\r\n> row 68\r\n> if (null == lastBrokerName || mq.getBrokerName().equals(lastBrokerName))\r\n> it should be:\r\n> if (null == lastBrokerName || !mq.getBrokerName().equals(lastBrokerName))\r\n\r\nAs you say, if lastBrokerName is null, it will select one MessageQueue, assuming MessageQueue-a. If it occurs some exception while producing to MessageQueue-a, it will always select MessageQueue-a since then. Can you submit a pr to fix it?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634652299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634666702","html_url":"https://github.com/apache/rocketmq/issues/2046#issuecomment-634666702","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2046","id":634666702,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDY2NjcwMg==","user":{"login":"HaoTianZhao","id":26730372,"node_id":"MDQ6VXNlcjI2NzMwMzcy","avatar_url":"https://avatars.githubusercontent.com/u/26730372?v=4","gravatar_id":"","url":"https://api.github.com/users/HaoTianZhao","html_url":"https://github.com/HaoTianZhao","followers_url":"https://api.github.com/users/HaoTianZhao/followers","following_url":"https://api.github.com/users/HaoTianZhao/following{/other_user}","gists_url":"https://api.github.com/users/HaoTianZhao/gists{/gist_id}","starred_url":"https://api.github.com/users/HaoTianZhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HaoTianZhao/subscriptions","organizations_url":"https://api.github.com/users/HaoTianZhao/orgs","repos_url":"https://api.github.com/users/HaoTianZhao/repos","events_url":"https://api.github.com/users/HaoTianZhao/events{/privacy}","received_events_url":"https://api.github.com/users/HaoTianZhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-27T13:37:31Z","updated_at":"2020-05-27T13:37:31Z","author_association":"NONE","body":"> > branch 4.7.0\r\n> > class MQFaultStrategy\r\n> > row 68\r\n> > if (null == lastBrokerName || mq.getBrokerName().equals(lastBrokerName))\r\n> > it should be:\r\n> > if (null == lastBrokerName || !mq.getBrokerName().equals(lastBrokerName))\r\n> \r\n> As you say, if lastBrokerName is null, it will select one MessageQueue, assuming MessageQueue-a. If it occurs some exception while producing to MessageQueue-a, it will always select MessageQueue-a since then. Can you submit a pr to fix it?\r\n\r\nof course","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/634666702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635040857","html_url":"https://github.com/apache/rocketmq/pull/2047#issuecomment-635040857","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2047","id":635040857,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTA0MDg1Nw==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-28T01:40:17Z","updated_at":"2020-05-28T01:40:17Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31078832/badge)](https://coveralls.io/builds/31078832)\n\nCoverage increased (+0.2%) to 51.023% when pulling **aea101b6e26f05d3677e5842702d42312537d921 on HaoTianZhao:fix-2046** into **8ef01a6c635f6972847c40d5540b1945180d7cbd on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635040857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635049920","html_url":"https://github.com/apache/rocketmq/pull/2048#issuecomment-635049920","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2048","id":635049920,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTA0OTkyMA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-28T02:08:36Z","updated_at":"2020-05-28T02:08:36Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31079222/badge)](https://coveralls.io/builds/31079222)\n\nCoverage increased (+0.07%) to 51.081% when pulling **121dfe1c83a0a036f2b21aac958a5348d1e7d81f on HaoTianZhao:fix-2046** into **67b8a2aa83a7a120e286bf7c34854cc4addfa532 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635049920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635049958","html_url":"https://github.com/apache/rocketmq/pull/2048#issuecomment-635049958","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2048","id":635049958,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTA0OTk1OA==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-28T02:08:41Z","updated_at":"2020-05-28T02:08:41Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2048?src=pr&el=h1) Report\n> Merging [#2048](https://codecov.io/gh/apache/rocketmq/pull/2048?src=pr&el=desc) into [develop](https://codecov.io/gh/apache/rocketmq/commit/67b8a2aa83a7a120e286bf7c34854cc4addfa532&el=desc) will **decrease** coverage by `0.07%`.\n> The diff coverage is `0.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/rocketmq/pull/2048/graphs/tree.svg?width=650&height=150&src=pr&token=4w0sxP1wZv)](https://codecov.io/gh/apache/rocketmq/pull/2048?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #2048      +/-   ##\n=============================================\n- Coverage      45.23%   45.16%   -0.08%     \n+ Complexity      4219     4211       -8     \n=============================================\n  Files            545      545              \n  Lines          35810    35810              \n  Branches        4760     4760              \n=============================================\n- Hits           16198    16172      -26     \n- Misses         17572    17594      +22     \n- Partials        2040     2044       +4     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/2048?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...pache/rocketmq/client/latency/MQFaultStrategy.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvbGF0ZW5jeS9NUUZhdWx0U3RyYXRlZ3kuamF2YQ==) | `17.02% <0.00%> (ø)` | `4.00 <0.00> (ø)` | |\n| [...org/apache/rocketmq/store/ha/WaitNotifyObject.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL2hhL1dhaXROb3RpZnlPYmplY3QuamF2YQ==) | `75.00% <0.00%> (-7.70%)` | `10.00% <0.00%> (-1.00%)` | |\n| [...pache/rocketmq/test/listener/AbstractListener.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-dGVzdC9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvdGVzdC9saXN0ZW5lci9BYnN0cmFjdExpc3RlbmVyLmphdmE=) | `66.66% <0.00%> (-7.41%)` | `9.00% <0.00%> (-1.00%)` | |\n| [...ache/rocketmq/common/stats/MomentStatsItemSet.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vc3RhdHMvTW9tZW50U3RhdHNJdGVtU2V0LmphdmE=) | `39.13% <0.00%> (-4.35%)` | `5.00% <0.00%> (-1.00%)` | |\n| [...e/rocketmq/client/impl/consumer/RebalanceImpl.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9SZWJhbGFuY2VJbXBsLmphdmE=) | `47.01% <0.00%> (-3.19%)` | `33.00% <0.00%> (ø%)` | |\n| [...client/consumer/store/RemoteBrokerOffsetStore.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvY29uc3VtZXIvc3RvcmUvUmVtb3RlQnJva2VyT2Zmc2V0U3RvcmUuamF2YQ==) | `64.86% <0.00%> (-2.71%)` | `19.00% <0.00%> (-1.00%)` | |\n| [...ava/org/apache/rocketmq/filter/util/BitsArray.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CaXRzQXJyYXkuamF2YQ==) | `58.11% <0.00%> (-1.71%)` | `29.00% <0.00%> (-1.00%)` | |\n| [...rocketmq/client/impl/factory/MQClientInstance.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9mYWN0b3J5L01RQ2xpZW50SW5zdGFuY2UuamF2YQ==) | `45.19% <0.00%> (-1.33%)` | `79.00% <0.00%> (-2.00%)` | |\n| [...che/rocketmq/namesrv/kvconfig/KVConfigManager.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-bmFtZXNydi9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbmFtZXNydi9rdmNvbmZpZy9LVkNvbmZpZ01hbmFnZXIuamF2YQ==) | `59.18% <0.00%> (-1.03%)` | `11.00% <0.00%> (-1.00%)` | |\n| [.../apache/rocketmq/logging/inner/LoggingBuilder.java](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree#diff-bG9nZ2luZy9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbG9nZ2luZy9pbm5lci9Mb2dnaW5nQnVpbGRlci5qYXZh) | `63.60% <0.00%> (-0.32%)` | `3.00% <0.00%> (ø%)` | |\n| ... and [2 more](https://codecov.io/gh/apache/rocketmq/pull/2048/diff?src=pr&el=tree-more) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/2048?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2048?src=pr&el=footer). Last update [67b8a2a...121dfe1](https://codecov.io/gh/apache/rocketmq/pull/2048?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635049958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635055354","html_url":"https://github.com/apache/rocketmq/issues/2046#issuecomment-635055354","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2046","id":635055354,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTA1NTM1NA==","user":{"login":"ifplusor","id":9999114,"node_id":"MDQ6VXNlcjk5OTkxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/9999114?v=4","gravatar_id":"","url":"https://api.github.com/users/ifplusor","html_url":"https://github.com/ifplusor","followers_url":"https://api.github.com/users/ifplusor/followers","following_url":"https://api.github.com/users/ifplusor/following{/other_user}","gists_url":"https://api.github.com/users/ifplusor/gists{/gist_id}","starred_url":"https://api.github.com/users/ifplusor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ifplusor/subscriptions","organizations_url":"https://api.github.com/users/ifplusor/orgs","repos_url":"https://api.github.com/users/ifplusor/repos","events_url":"https://api.github.com/users/ifplusor/events{/privacy}","received_events_url":"https://api.github.com/users/ifplusor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-28T02:24:15Z","updated_at":"2020-05-28T02:24:15Z","author_association":"CONTRIBUTOR","body":"Same as #1576 ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635055354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635056612","html_url":"https://github.com/apache/rocketmq/pull/2048#issuecomment-635056612","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2048","id":635056612,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTA1NjYxMg==","user":{"login":"ifplusor","id":9999114,"node_id":"MDQ6VXNlcjk5OTkxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/9999114?v=4","gravatar_id":"","url":"https://api.github.com/users/ifplusor","html_url":"https://github.com/ifplusor","followers_url":"https://api.github.com/users/ifplusor/followers","following_url":"https://api.github.com/users/ifplusor/following{/other_user}","gists_url":"https://api.github.com/users/ifplusor/gists{/gist_id}","starred_url":"https://api.github.com/users/ifplusor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ifplusor/subscriptions","organizations_url":"https://api.github.com/users/ifplusor/orgs","repos_url":"https://api.github.com/users/ifplusor/repos","events_url":"https://api.github.com/users/ifplusor/events{/privacy}","received_events_url":"https://api.github.com/users/ifplusor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-28T02:28:17Z","updated_at":"2020-05-28T02:28:17Z","author_association":"CONTRIBUTOR","body":"duplicated with #1577 ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635056612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635059357","html_url":"https://github.com/apache/rocketmq/issues/2046#issuecomment-635059357","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2046","id":635059357,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTA1OTM1Nw==","user":{"login":"ifplusor","id":9999114,"node_id":"MDQ6VXNlcjk5OTkxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/9999114?v=4","gravatar_id":"","url":"https://api.github.com/users/ifplusor","html_url":"https://github.com/ifplusor","followers_url":"https://api.github.com/users/ifplusor/followers","following_url":"https://api.github.com/users/ifplusor/following{/other_user}","gists_url":"https://api.github.com/users/ifplusor/gists{/gist_id}","starred_url":"https://api.github.com/users/ifplusor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ifplusor/subscriptions","organizations_url":"https://api.github.com/users/ifplusor/orgs","repos_url":"https://api.github.com/users/ifplusor/repos","events_url":"https://api.github.com/users/ifplusor/events{/privacy}","received_events_url":"https://api.github.com/users/ifplusor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-28T02:37:15Z","updated_at":"2020-05-28T02:37:15Z","author_association":"CONTRIBUTOR","body":"See #1607 ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635059357/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635064242","html_url":"https://github.com/apache/rocketmq/issues/2046#issuecomment-635064242","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2046","id":635064242,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTA2NDI0Mg==","user":{"login":"ifplusor","id":9999114,"node_id":"MDQ6VXNlcjk5OTkxMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/9999114?v=4","gravatar_id":"","url":"https://api.github.com/users/ifplusor","html_url":"https://github.com/ifplusor","followers_url":"https://api.github.com/users/ifplusor/followers","following_url":"https://api.github.com/users/ifplusor/following{/other_user}","gists_url":"https://api.github.com/users/ifplusor/gists{/gist_id}","starred_url":"https://api.github.com/users/ifplusor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ifplusor/subscriptions","organizations_url":"https://api.github.com/users/ifplusor/orgs","repos_url":"https://api.github.com/users/ifplusor/repos","events_url":"https://api.github.com/users/ifplusor/events{/privacy}","received_events_url":"https://api.github.com/users/ifplusor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-28T02:53:14Z","updated_at":"2020-05-28T02:53:14Z","author_association":"CONTRIBUTOR","body":"```latencyFaultTolerance.isAvailable(mq.getBrokerName())``` has checked the availability of the mq. ```null == lastBrokerName || mq.getBrokerName().equals(lastBrokerName)``` is redundant, and cause a bug.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635064242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635095674","html_url":"https://github.com/apache/rocketmq/issues/2049#issuecomment-635095674","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2049","id":635095674,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTA5NTY3NA==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-28T04:40:28Z","updated_at":"2020-05-28T04:40:28Z","author_association":"CONTRIBUTOR","body":"> pull模式，应用集群，mq集群，怎么处理offset比较好，初步了解到使用RemoteBrokerOffsetStore，但是疑惑存储在本地的偏移量，因为应用是集群环境导致“各个本地”存储的offset乱套了。\r\n\r\nUse LocalFileOffsetStore or RemoteBrokerOffsetStore depends on consumer's MessageModel. If BROADCASTING, use LocalFileOffsetStore, if CLUSTERING, use RemoteBrokerOffsetStore.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635095674/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635161612","html_url":"https://github.com/apache/rocketmq/pull/2050#issuecomment-635161612","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2050","id":635161612,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTE2MTYxMg==","user":{"login":"lcyanxi","id":17700693,"node_id":"MDQ6VXNlcjE3NzAwNjkz","avatar_url":"https://avatars.githubusercontent.com/u/17700693?v=4","gravatar_id":"","url":"https://api.github.com/users/lcyanxi","html_url":"https://github.com/lcyanxi","followers_url":"https://api.github.com/users/lcyanxi/followers","following_url":"https://api.github.com/users/lcyanxi/following{/other_user}","gists_url":"https://api.github.com/users/lcyanxi/gists{/gist_id}","starred_url":"https://api.github.com/users/lcyanxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcyanxi/subscriptions","organizations_url":"https://api.github.com/users/lcyanxi/orgs","repos_url":"https://api.github.com/users/lcyanxi/repos","events_url":"https://api.github.com/users/lcyanxi/events{/privacy}","received_events_url":"https://api.github.com/users/lcyanxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-28T07:25:23Z","updated_at":"2020-05-28T07:25:23Z","author_association":"NONE","body":"添加注释","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635161612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635692522","html_url":"https://github.com/apache/rocketmq/issues/2045#issuecomment-635692522","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2045","id":635692522,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTY5MjUyMg==","user":{"login":"francisoliverlee","id":5908412,"node_id":"MDQ6VXNlcjU5MDg0MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5908412?v=4","gravatar_id":"","url":"https://api.github.com/users/francisoliverlee","html_url":"https://github.com/francisoliverlee","followers_url":"https://api.github.com/users/francisoliverlee/followers","following_url":"https://api.github.com/users/francisoliverlee/following{/other_user}","gists_url":"https://api.github.com/users/francisoliverlee/gists{/gist_id}","starred_url":"https://api.github.com/users/francisoliverlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/francisoliverlee/subscriptions","organizations_url":"https://api.github.com/users/francisoliverlee/orgs","repos_url":"https://api.github.com/users/francisoliverlee/repos","events_url":"https://api.github.com/users/francisoliverlee/events{/privacy}","received_events_url":"https://api.github.com/users/francisoliverlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-29T00:45:20Z","updated_at":"2020-05-29T00:46:34Z","author_association":"MEMBER","body":"@lizhiboo do u have any idea to fix it ?\r\nduplicate with https://github.com/apache/rocketmq/issues/1931","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635692522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635699533","html_url":"https://github.com/apache/rocketmq/issues/2052#issuecomment-635699533","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2052","id":635699533,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTY5OTUzMw==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-29T01:11:41Z","updated_at":"2020-05-29T01:11:41Z","author_association":"CONTRIBUTOR","body":"> in our company，use rocketMq to process message，but sometimes we need message only consume in particular server。\r\n> \r\n> we modify the consume rebalance policy to let one server to consume all messages。\r\n> but i want know any best practice in community？\r\n\r\nTry to use the following method, business layer make sure only the particular server start consume task by using a lock.\r\n`        consumer.setMessageModel(MessageModel.BROADCASTING);\r\n`","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635699533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635717176","html_url":"https://github.com/apache/rocketmq/pull/1607#issuecomment-635717176","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1607","id":635717176,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTcxNzE3Ng==","user":{"login":"xiangwangcheng","id":8049014,"node_id":"MDQ6VXNlcjgwNDkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8049014?v=4","gravatar_id":"","url":"https://api.github.com/users/xiangwangcheng","html_url":"https://github.com/xiangwangcheng","followers_url":"https://api.github.com/users/xiangwangcheng/followers","following_url":"https://api.github.com/users/xiangwangcheng/following{/other_user}","gists_url":"https://api.github.com/users/xiangwangcheng/gists{/gist_id}","starred_url":"https://api.github.com/users/xiangwangcheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiangwangcheng/subscriptions","organizations_url":"https://api.github.com/users/xiangwangcheng/orgs","repos_url":"https://api.github.com/users/xiangwangcheng/repos","events_url":"https://api.github.com/users/xiangwangcheng/events{/privacy}","received_events_url":"https://api.github.com/users/xiangwangcheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-29T02:17:11Z","updated_at":"2020-05-29T02:17:11Z","author_association":"NONE","body":"LGTM.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635717176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635786834","html_url":"https://github.com/apache/rocketmq/issues/2051#issuecomment-635786834","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2051","id":635786834,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTc4NjgzNA==","user":{"login":"vongosling","id":635581,"node_id":"MDQ6VXNlcjYzNTU4MQ==","avatar_url":"https://avatars.githubusercontent.com/u/635581?v=4","gravatar_id":"","url":"https://api.github.com/users/vongosling","html_url":"https://github.com/vongosling","followers_url":"https://api.github.com/users/vongosling/followers","following_url":"https://api.github.com/users/vongosling/following{/other_user}","gists_url":"https://api.github.com/users/vongosling/gists{/gist_id}","starred_url":"https://api.github.com/users/vongosling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vongosling/subscriptions","organizations_url":"https://api.github.com/users/vongosling/orgs","repos_url":"https://api.github.com/users/vongosling/repos","events_url":"https://api.github.com/users/vongosling/events{/privacy}","received_events_url":"https://api.github.com/users/vongosling/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-29T06:29:10Z","updated_at":"2020-05-29T06:29:10Z","author_association":"MEMBER","body":"This is a great suggestion for meta configuration. In fact, the community has discussed the in this rip(https://github.com/apache/rocketmq/wiki/RIP-18-Metadata-management-architecture-upgrade). ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635786834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635858608","html_url":"https://github.com/apache/rocketmq/issues/2049#issuecomment-635858608","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2049","id":635858608,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTg1ODYwOA==","user":{"login":"githubyangxd","id":40851986,"node_id":"MDQ6VXNlcjQwODUxOTg2","avatar_url":"https://avatars.githubusercontent.com/u/40851986?v=4","gravatar_id":"","url":"https://api.github.com/users/githubyangxd","html_url":"https://github.com/githubyangxd","followers_url":"https://api.github.com/users/githubyangxd/followers","following_url":"https://api.github.com/users/githubyangxd/following{/other_user}","gists_url":"https://api.github.com/users/githubyangxd/gists{/gist_id}","starred_url":"https://api.github.com/users/githubyangxd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/githubyangxd/subscriptions","organizations_url":"https://api.github.com/users/githubyangxd/orgs","repos_url":"https://api.github.com/users/githubyangxd/repos","events_url":"https://api.github.com/users/githubyangxd/events{/privacy}","received_events_url":"https://api.github.com/users/githubyangxd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-29T08:56:50Z","updated_at":"2020-05-29T08:56:50Z","author_association":"NONE","body":"和网上云云一样，回答不到点上","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635858608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635859068","html_url":"https://github.com/apache/rocketmq/issues/2049#issuecomment-635859068","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2049","id":635859068,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTg1OTA2OA==","user":{"login":"githubyangxd","id":40851986,"node_id":"MDQ6VXNlcjQwODUxOTg2","avatar_url":"https://avatars.githubusercontent.com/u/40851986?v=4","gravatar_id":"","url":"https://api.github.com/users/githubyangxd","html_url":"https://github.com/githubyangxd","followers_url":"https://api.github.com/users/githubyangxd/followers","following_url":"https://api.github.com/users/githubyangxd/following{/other_user}","gists_url":"https://api.github.com/users/githubyangxd/gists{/gist_id}","starred_url":"https://api.github.com/users/githubyangxd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/githubyangxd/subscriptions","organizations_url":"https://api.github.com/users/githubyangxd/orgs","repos_url":"https://api.github.com/users/githubyangxd/repos","events_url":"https://api.github.com/users/githubyangxd/events{/privacy}","received_events_url":"https://api.github.com/users/githubyangxd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-29T08:57:55Z","updated_at":"2020-05-29T08:57:55Z","author_association":"NONE","body":"> \r\n> \r\n> > pull模式，应用集群，mq集群，怎么处理offset比较好，初步了解到使用RemoteBrokerOffsetStore，但是疑惑存储在本地的偏移量，因为应用是集群环境导致“各个本地”存储的offset乱套了。\r\n> \r\n> Use LocalFileOffsetStore or RemoteBrokerOffsetStore depends on consumer's MessageModel. If BROADCASTING, use LocalFileOffsetStore, if CLUSTERING, use RemoteBrokerOffsetStore.\r\n\r\n是否有案例，不需要分布式锁吗","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/635859068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636057142","html_url":"https://github.com/apache/rocketmq/issues/2055#issuecomment-636057142","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2055","id":636057142,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjA1NzE0Mg==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-29T16:10:42Z","updated_at":"2020-05-29T16:10:42Z","author_association":"CONTRIBUTOR","body":"Good catch! Could you submit a pr to slove it?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636057142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636267028","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636267028","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636267028,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjI2NzAyOA==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-30T03:08:15Z","updated_at":"2020-05-30T03:08:15Z","author_association":"CONTRIBUTOR","body":"> raft协议在网络抖动，机器临时故障等极小概率情况下会产生以下选举问题：\r\n> 假定有编号为【1，2，3，4，5，6，7】共7个结点构成了一个选举整体，当结点1作为候选人发起term=6的投票，该term对应投票为【1，2，3，4】所接受，结点1作为leader执行leader职责前，刚好结点7发起term=7的投票(因为网络抖动原因结点7发起的term=6刚好未被结点【1，2，3，4】所接收)，抛开上帝视角具体分析，此时存在以下两种情况：\r\n> 情况1：结点【4，5，6，7】多数结点接受结点7该term=7的选举，结点7作为leader执行职责，该情况下目前所用raft协议能保证结点1会自动失去leader资格。\r\n> 情况2:结点【5，6，7】等少数结点接受结点7该term=7的选举，结点7未作为leader执行职责，但此时因为【5，6，7】结点已经认可了term=7的任期，会导致结点1以term=6所发送提议无法被接受，但结点1因为已经此实确实获取多数结点认可，在提议被多数接受后会进行提交。可惜目前所用的raft协议未考虑该情况下的处理方案。\r\n> 解决策略:1、引入结点在接受到leader名义发起的提议后，如果term<自身已知选举认可term且term>自身已提交term时，对提议仅进行记录但拒绝接受该提议。当接受到提交请求时，如果提交所用term>自身已提交term，则找到对应提议并无条件进行提交(因为raft协议的提议提交命令发送前提为大多数已经接受了)。2、如果接受了提议，则在自身未主动探测到leader丢失下，拒绝对后续的选举term进行投票(以保证在接受结点1提议后结点7无法获取到多数结点的认可当选为leader出现双主问题).\r\n> 问题扩展:实际情况会存在网络抖动引起的N个(N>=2)结点同时误认自己是leader或当前leader因为所用term并非全局视角下的最大term在履行leader职责时未受少数结点认可存在的问题\r\n\r\nIn my opinion, the situation that you describe before is inevitable. PRE-VOTE request can minimize the probability of leadership transition.  Candidate send PRE-VOTE request before send the true VOTE request. If PRE-VOTE failed(do not receive majority's vote), candidate reset vote timeout to wait for the next PRE-VOTE. If PRE-VOTE successed(receive majority's vote), candidate will send VOTE request. \r\nOpenmessaging-dledger has already support PRE-VOTE protocol, it maybe help you. Code address is [https://github.com/openmessaging/openmessaging-storage-dledger](url) \r\nThe PRE-VOTE mechanism details please refer to RAFT paper.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636267028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636267256","html_url":"https://github.com/apache/rocketmq/issues/2045#issuecomment-636267256","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2045","id":636267256,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjI2NzI1Ng==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-30T03:10:39Z","updated_at":"2020-05-30T03:10:39Z","author_association":"CONTRIBUTOR","body":"> @lizhiboo do u have any idea to fix it ?\r\n> duplicate with #1931\r\n\r\nsure, glad to do it.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636267256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636275262","html_url":"https://github.com/apache/rocketmq/pull/2057#issuecomment-636275262","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2057","id":636275262,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjI3NTI2Mg==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-30T04:41:56Z","updated_at":"2020-05-30T04:41:56Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31130073/badge)](https://coveralls.io/builds/31130073)\n\nCoverage increased (+0.04%) to 50.972% when pulling **6cee569f2b5c15ed1b5d3416552cd130f177d667 on lizhiboo:develop** into **b3ec283c8d9d11dab95a3f0dfc4ee9789bf53749 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636275262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636275276","html_url":"https://github.com/apache/rocketmq/pull/2057#issuecomment-636275276","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2057","id":636275276,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjI3NTI3Ng==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-30T04:42:03Z","updated_at":"2020-05-30T04:42:03Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2057?src=pr&el=h1) Report\n> Merging [#2057](https://codecov.io/gh/apache/rocketmq/pull/2057?src=pr&el=desc) into [develop](https://codecov.io/gh/apache/rocketmq/commit/b3ec283c8d9d11dab95a3f0dfc4ee9789bf53749&el=desc) will **decrease** coverage by `0.07%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/rocketmq/pull/2057/graphs/tree.svg?width=650&height=150&src=pr&token=4w0sxP1wZv)](https://codecov.io/gh/apache/rocketmq/pull/2057?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #2057      +/-   ##\n=============================================\n- Coverage      45.25%   45.18%   -0.08%     \n+ Complexity      4220     4215       -5     \n=============================================\n  Files            545      545              \n  Lines          35812    35811       -1     \n  Branches        4761     4761              \n=============================================\n- Hits           16208    16181      -27     \n- Misses         17556    17589      +33     \n+ Partials        2048     2041       -7     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/2057?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...rocketmq/remoting/netty/NettyRemotingAbstract.java](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L05ldHR5UmVtb3RpbmdBYnN0cmFjdC5qYXZh) | `46.86% <ø> (-3.88%)` | `20.00 <0.00> (-2.00)` | |\n| [...org/apache/rocketmq/store/ha/WaitNotifyObject.java](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL2hhL1dhaXROb3RpZnlPYmplY3QuamF2YQ==) | `75.00% <0.00%> (-7.70%)` | `10.00% <0.00%> (-1.00%)` | |\n| [...apache/rocketmq/remoting/netty/ResponseFuture.java](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L1Jlc3BvbnNlRnV0dXJlLmphdmE=) | `85.00% <0.00%> (-5.00%)` | `16.00% <0.00%> (-2.00%)` | |\n| [...nt/impl/consumer/ConsumeMessageOrderlyService.java](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9Db25zdW1lTWVzc2FnZU9yZGVybHlTZXJ2aWNlLmphdmE=) | `38.98% <0.00%> (-3.98%)` | `16.00% <0.00%> (-3.00%)` | |\n| [...e/rocketmq/client/impl/consumer/RebalanceImpl.java](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9SZWJhbGFuY2VJbXBsLmphdmE=) | `50.19% <0.00%> (-3.59%)` | `33.00% <0.00%> (-1.00%)` | |\n| [...org/apache/rocketmq/common/stats/StatsItemSet.java](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vc3RhdHMvU3RhdHNJdGVtU2V0LmphdmE=) | `38.09% <0.00%> (-1.59%)` | `12.00% <0.00%> (-1.00%)` | |\n| [...n/java/org/apache/rocketmq/store/ha/HAService.java](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL2hhL0hBU2VydmljZS5qYXZh) | `67.88% <0.00%> (-0.34%)` | `18.00% <0.00%> (ø%)` | |\n| [...org/apache/rocketmq/store/DefaultMessageStore.java](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL0RlZmF1bHRNZXNzYWdlU3RvcmUuamF2YQ==) | `55.45% <0.00%> (-0.20%)` | `106.00% <0.00%> (ø%)` | |\n| [...etmq/client/latency/LatencyFaultToleranceImpl.java](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvbGF0ZW5jeS9MYXRlbmN5RmF1bHRUb2xlcmFuY2VJbXBsLmphdmE=) | `50.00% <0.00%> (ø)` | `8.00% <0.00%> (ø%)` | |\n| ... and [6 more](https://codecov.io/gh/apache/rocketmq/pull/2057/diff?src=pr&el=tree-more) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/2057?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2057?src=pr&el=footer). Last update [b3ec283...6cee569](https://codecov.io/gh/apache/rocketmq/pull/2057?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636275276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636291527","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636291527","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636291527,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjI5MTUyNw==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-30T07:20:31Z","updated_at":"2020-05-30T07:20:31Z","author_association":"NONE","body":"> > raft协议在网络抖动，机器临时故障等极小概率情况下会产生以下选举问题：\r\n> > 假定有编号为【1，2，3，4，5，6，7】共7个结点构成了一个选举整体，当结点1作为候选人发起term=6的投票，该term对应投票为【1，2，3，4】所接受，结点1作为leader执行leader职责前，刚好结点7发起term=7的投票(因为网络抖动原因结点7发起的term=6刚好未被结点【1，2，3，4】所接收)，抛开上帝视角具体分析，此时存在以下两种情况：\r\n> > 情况1：结点【4，5，6，7】多数结点接受结点7该term=7的选举，结点7作为leader执行职责，该情况下目前所用raft协议能保证结点1会自动失去leader资格。\r\n> > 情况2:结点【5，6，7】等少数结点接受结点7该term=7的选举，结点7未作为leader执行职责，但此时因为【5，6，7】结点已经认可了term=7的任期，会导致结点1以term=6所发送提议无法被接受，但结点1因为已经此实确实获取多数结点认可，在提议被多数接受后会进行提交。可惜目前所用的raft协议未考虑该情况下的处理方案。\r\n> > 解决策略:1、引入结点在接受到leader名义发起的提议后，如果term<自身已知选举认可term且term>自身已提交term时，对提议仅进行记录但拒绝接受该提议。当接受到提交请求时，如果提交所用term>自身已提交term，则找到对应提议并无条件进行提交(因为raft协议的提议提交命令发送前提为大多数已经接受了)。2、如果接受了提议，则在自身未主动探测到leader丢失下，拒绝对后续的选举term进行投票(以保证在接受结点1提议后结点7无法获取到多数结点的认可当选为leader出现双主问题).\r\n> > 问题扩展:实际情况会存在网络抖动引起的N个(N>=2)结点同时误认自己是leader或当前leader因为所用term并非全局视角下的最大term在履行leader职责时未受少数结点认可存在的问题\r\n> \r\n> In my opinion, the situation that you describe before is inevitable. PRE-VOTE request can minimize the probability of leadership transition. Candidate send PRE-VOTE request before send the true VOTE request. If PRE-VOTE failed(do not receive majority's vote), candidate reset vote timeout to wait for the next PRE-VOTE. If PRE-VOTE successed(receive majority's vote), candidate will send VOTE request.\r\n> Openmessaging-dledger has already support PRE-VOTE protocol, it maybe help you. Code address is [https://github.com/openmessaging/openmessaging-storage-dledger](url)\r\n> The PRE-VOTE mechanism details please refer to RAFT paper.\r\n\r\n\r\n采用pre-vote进行候选人抉择只能保证参与选举时的结点拥有了最新的日志信息，上述情况为当结点1跟结点7都具有最新信息，并在prevote阶段因此都获取了候选人资格，在获取了候选人资格后一段时间内因为网络等问题发生一定时间段的间歇性脑裂，导致了term变更期间因随机等待时常差异造成同一时刻会用不同term参与选举在特殊情况下产生了之前描述的问题。该情况发生概率较小但确实存在，并且出现时候一般不容易排查，所以引入接受到提交请求无条件提交并更新自身认可的leader为发起提交命令的结点能保证在有结点获取多数投票并担任leader之后的个别结点记录的选举term异常带来的无主问题","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636291527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636293136","html_url":"https://github.com/apache/rocketmq/issues/2045#issuecomment-636293136","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2045","id":636293136,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjI5MzEzNg==","user":{"login":"francisoliverlee","id":5908412,"node_id":"MDQ6VXNlcjU5MDg0MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5908412?v=4","gravatar_id":"","url":"https://api.github.com/users/francisoliverlee","html_url":"https://github.com/francisoliverlee","followers_url":"https://api.github.com/users/francisoliverlee/followers","following_url":"https://api.github.com/users/francisoliverlee/following{/other_user}","gists_url":"https://api.github.com/users/francisoliverlee/gists{/gist_id}","starred_url":"https://api.github.com/users/francisoliverlee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/francisoliverlee/subscriptions","organizations_url":"https://api.github.com/users/francisoliverlee/orgs","repos_url":"https://api.github.com/users/francisoliverlee/repos","events_url":"https://api.github.com/users/francisoliverlee/events{/privacy}","received_events_url":"https://api.github.com/users/francisoliverlee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-30T07:35:31Z","updated_at":"2020-05-30T07:35:31Z","author_association":"MEMBER","body":"@lizhiboo when finished it , reply with PR id ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636293136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636318438","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636318438","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636318438,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjMxODQzOA==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-30T11:35:04Z","updated_at":"2020-05-30T11:35:04Z","author_association":"NONE","body":"可以在pre-vote基础上对raft做进一步改进以对选举过程中产生的消耗做相关优化，在pre-vote阶段根据自身接受日志记录的term及日志index作为获取选举资格的凭证，但在每次选举中携带自身【termLoged，indexLogged，termWanted，nodeId】拉取选票，其中termLoged为自身接受日志记录的最新term，indexLodded为自身接受最大term日志记录的最大index，termWanted初始值为termLoged，在每次选举失败后+1，nodeId为自身结点，拉取选票会出现以下几种情况:\r\n【\r\n情况1：其他结点(如结点B)收到选举消息后经过对比发现结点B自身记录的日志term>结点A发送过来的termLoged，则反馈termSmallError异常的反对票.\r\n\r\n情况2：其他结点(如结点B)收到选举消息后发现自身记录日志term小于结点A发送过来的termLogged，或者自身记录日志term=结点A发送过来的termLogged且自身日志index<indexLogged则更新自身记录的termWanted并反馈以赞同票。\r\n\r\n情况3：其他结点(如节点B)发现自身记录日志term与A发过来的termLogged一致且自身日志index=indexLogged，则以跟自身已认可的termWanted与接受到的termWanted进行对比，如果自身已认可的termWanted>=B结点发过来的termWanted，则反馈选举失败(但不为反对票)并在反馈报文中告知自身记录的最大termWanted。\r\n】\r\n\r\n结点A根据获取到的多数反馈或经过一定超时时间后根据不同情况分别做如下策略:\r\n【\r\n情况1:如果结点A获得了多数结点的认可并未获得反对票，则以leader身份并以termWanted作为任期开始执行leader责任(如果任期失败则再次进入leader查找及选主状态)。\r\n\r\n情况2:如果结点A如果未收到反对票也未获得大多数认可时则据反馈的termWanted集合中与自身（termWanted+1)的最大值来变更termWanted并在随机等待后进行下一轮选票拉取。\r\n\r\n情况3:如果收到的投票中存在反对票，结点B会随机等待后再次判断leader是否存在及在无法知晓leader存在后经过pre-vote阶段获取自身候选人资格并判断是否存在新leader，如果不存在新leader则尝试通过pre-vote获取候选人资格并在候选人资格获得后重新发起选举(之所以如此设计是因为当结点B等少数结点是所有结点中唯一持有更大termLogged的结点并在此后因为这系列少数结点故障永久性无法通信)；\r\n】\r\n\r\n通过以上方案，避免了每次拉选票之前频繁的pre-vote中候选人资格认证阶段的消耗，并能够在获取到leader存在后及时变更自身状态，也保证了当选的leader确实拥有最新的日志记录，同时避免了出现长时间脑裂的恢复后日志term落后引发的误选及有效日志回滚，也避免了少部分记录有最新日志记录结点(因为某些原因日志未受多数认可而leader故障引发无主)集体永久性宕机后引发的无法选举问题。为了保证特殊情况下的及时获取leader信息日志，仍补充issue中所提到的策略","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636318438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636340722","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636340722","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636340722,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjM0MDcyMg==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-30T14:46:56Z","updated_at":"2020-05-30T14:46:56Z","author_association":"CONTRIBUTOR","body":"> 可以在pre-vote基础上对raft做进一步改进以对选举过程中产生的消耗做相关优化，在pre-vote阶段根据自身接受日志记录的term及日志index作为获取选举资格的凭证，但在每次选举中携带自身【termLoged，indexLogged，termWanted，nodeId】拉取选票，其中termLoged为自身接受日志记录的最新term，indexLodded为自身接受最大term日志记录的最大index，termWanted初始值为termLoged，在每次选举失败后+1，nodeId为自身结点，拉取选票会出现以下几种情况:\r\n> 【\r\n> 情况1：其他结点(如结点B)收到选举消息后经过对比发现结点B自身记录的日志term>结点A发送过来的termLoged，则反馈termSmallError异常的反对票.\r\n> \r\n> 情况2：其他结点(如结点B)收到选举消息后发现自身记录日志term小于结点A发送过来的termLogged，或者自身记录日志term=结点A发送过来的termLogged且自身日志index<indexLogged则更新自身记录的termWanted并反馈以赞同票。\r\n> \r\n> 情况3：其他结点(如节点B)发现自身记录日志term与A发过来的termLogged一致且自身日志index=indexLogged，则以跟自身已认可的termWanted与接受到的termWanted进行对比，如果自身已认可的termWanted>=B结点发过来的termWanted，则反馈选举失败(但不为反对票)并在反馈报文中告知自身记录的最大termWanted。\r\n> 】\r\n> \r\n> 结点A根据获取到的多数反馈或经过一定超时时间后根据不同情况分别做如下策略:\r\n> 【\r\n> 情况1:如果结点A获得了多数结点的认可并未获得反对票，则以leader身份并以termWanted作为任期开始执行leader责任(如果任期失败则再次进入leader查找及选主状态)。\r\n> \r\n> 情况2:如果结点A如果未收到反对票也未获得大多数认可时则据反馈的termWanted集合中与自身（termWanted+1)的最大值来变更termWanted并在随机等待后进行下一轮选票拉取。\r\n> \r\n> 情况3:如果收到的投票中存在反对票，结点B会随机等待后再次判断leader是否存在及在无法知晓leader存在后经过pre-vote阶段获取自身候选人资格并判断是否存在新leader，如果不存在新leader则尝试通过pre-vote获取候选人资格并在候选人资格获得后重新发起选举(之所以如此设计是因为当结点B等少数结点是所有结点中唯一持有更大termLogged的结点并在此后因为这系列少数结点故障永久性无法通信)；\r\n> 】\r\n> \r\n> 通过以上方案，避免了每次拉选票之前频繁的pre-vote中候选人资格认证阶段的消耗，并能够在获取到leader存在后及时变更自身状态，也保证了当选的leader确实拥有最新的日志记录，同时避免了出现长时间脑裂的恢复后日志term落后引发的误选及有效日志回滚，也避免了少部分记录有最新日志记录结点(因为某些原因日志未受多数认可而leader故障引发无主)集体永久性宕机后引发的无法选举问题。为了保证特殊情况下的及时获取leader信息日志，仍补充issue中所提到的策略\r\n\r\nThe standard leader election process in raft is comparing candidate's term, lastLogIndex, lastLogTerm. I think your solution described above modified raft election process. I'm not sure it works or not. Can you describe the whole election process in detail, and prove it ?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636340722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636414843","html_url":"https://github.com/apache/rocketmq/issues/2044#issuecomment-636414843","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2044","id":636414843,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQxNDg0Mw==","user":{"login":"lebron374","id":5032169,"node_id":"MDQ6VXNlcjUwMzIxNjk=","avatar_url":"https://avatars.githubusercontent.com/u/5032169?v=4","gravatar_id":"","url":"https://api.github.com/users/lebron374","html_url":"https://github.com/lebron374","followers_url":"https://api.github.com/users/lebron374/followers","following_url":"https://api.github.com/users/lebron374/following{/other_user}","gists_url":"https://api.github.com/users/lebron374/gists{/gist_id}","starred_url":"https://api.github.com/users/lebron374/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lebron374/subscriptions","organizations_url":"https://api.github.com/users/lebron374/orgs","repos_url":"https://api.github.com/users/lebron374/repos","events_url":"https://api.github.com/users/lebron374/events{/privacy}","received_events_url":"https://api.github.com/users/lebron374/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T03:23:17Z","updated_at":"2020-05-31T03:23:17Z","author_association":"CONTRIBUTOR","body":"> yup，can you submit a pr to fix it?\r\n\r\ni commit a pr @ https://github.com/apache/rocketmq/pull/2059","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636414843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636415449","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636415449","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636415449,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQxNTQ0OQ==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T03:32:29Z","updated_at":"2020-05-31T03:36:48Z","author_association":"CONTRIBUTOR","body":"> raft协议在网络抖动，机器临时故障等极小概率情况下会产生以下选举问题：\r\n\r\n> 情况2:结点【5，6，7】等少数结点接受结点7该term=7的选举，结点7未作为leader执行职责，但此时因为【5，6，7】结点已经认可了term=7的任期，\r\n\r\n> 会导致结点1以term=6所发送提议无法被接受，但结点1因为已经此实确实获取多数结点认可，在提议被多数接受后会进行提交。可惜目前所用的raft协议未考虑该情况下的处理方案。\r\n\r\n节点1 在发现 5，6，7 认可了term = 7 的时候，会立刻退化成为follower 状态。如果出现了这种情况说明节点1 不应该继续成为leader了。任何leader在察觉到有比自己高的term的时候就意味着有新的leader要被选取出来了。\r\n\r\n> 但结点1因为已经此实确实获取多数结点认可，在提议被多数接受后会进行提交\r\n\r\n这个多数投票只是让节点1成为了leader，entry X 的commit动作只会发生在 超过半数的node 都写入了entry X 之后才会commit。\r\n\r\n感觉情况2就是正常的raft处理leader change的情况，可能我理解有偏差，还望指正。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636415449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636417675","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636417675","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636417675,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQxNzY3NQ==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T04:07:14Z","updated_at":"2020-05-31T04:07:14Z","author_association":"CONTRIBUTOR","body":"> 可以在pre-vote基础上对raft做进一步改进以对选举过程中产生的消耗做相关优化，在pre-vote阶段根据自身接受日志记录的term及日志index作为获取选举资格的凭证，但在每次选举中携带自身【termLoged，indexLogged，termWanted，nodeId】拉取选票，其中termLoged为自身接受日志记录的最新term，indexLodded为自身接受最大term日志记录的最大index，termWanted初始值为termLoged，在每次选举失败后+1，nodeId为自身结点，拉取选票会出现以下几种情况:\r\n> 【\r\n> 情况1：其他结点(如结点B)收到选举消息后经过对比发现结点B自身记录的日志term>结点A发送过来的termLoged，则反馈termSmallError异常的反对票.\r\n> \r\n> 情况2：其他结点(如结点B)收到选举消息后发现自身记录日志term小于结点A发送过来的termLogged，或者自身记录日志term=结点A发送过来的termLogged且自身日志index<indexLogged则更新自身记录的termWanted并反馈以赞同票。\r\n> \r\n> 情况3：其他结点(如节点B)发现自身记录日志term与A发过来的termLogged一致且自身日志index=indexLogged，则以跟自身已认可的termWanted与接受到的termWanted进行对比，如果自身已认可的termWanted>=B结点发过来的termWanted，则反馈选举失败(但不为反对票)并在反馈报文中告知自身记录的最大termWanted。\r\n> 】\r\n> \r\n> 结点A根据获取到的多数反馈或经过一定超时时间后根据不同情况分别做如下策略:\r\n> 【\r\n> 情况1:如果结点A获得了多数结点的认可并未获得反对票，则以leader身份并以termWanted作为任期开始执行leader责任(如果任期失败则再次进入leader查找及选主状态)。\r\n> \r\n> 情况2:如果结点A如果未收到反对票也未获得大多数认可时则据反馈的termWanted集合中与自身（termWanted+1)的最大值来变更termWanted并在随机等待后进行下一轮选票拉取。\r\n> \r\n> 情况3:如果收到的投票中存在反对票，结点B会随机等待后再次判断leader是否存在及在无法知晓leader存在后经过pre-vote阶段获取自身候选人资格并判断是否存在新leader，如果不存在新leader则尝试通过pre-vote获取候选人资格并在候选人资格获得后重新发起选举(之所以如此设计是因为当结点B等少数结点是所有结点中唯一持有更大termLogged的结点并在此后因为这系列少数结点故障永久性无法通信)；\r\n> 】\r\n> \r\n> 通过以上方案，避免了每次拉选票之前频繁的pre-vote中候选人资格认证阶段的消耗，并能够在获取到leader存在后及时变更自身状态，也保证了当选的leader确实拥有最新的日志记录，同时避免了出现长时间脑裂的恢复后日志term落后引发的误选及有效日志回滚，也避免了少部分记录有最新日志记录结点(因为某些原因日志未受多数认可而leader故障引发无主)集体永久性宕机后引发的无法选举问题。为了保证特殊情况下的及时获取leader信息日志，仍补充issue中所提到的策略\r\n\r\n\r\n两个小问题：\r\n自身记录日志term  就是 termLoged 嘛。可以问一下为什么要拆分出term 和 termWanted 嘞，因为您说\r\n\r\n> termLoged，indexLogged，termWanted，nodeId】拉取选票，其中termLoged为自身接受日志记录的最新term，indexLodded为自身接受最大term日志记录的最大index，termWanted初始值为termLoged，在每次选举失败后+1，nodeId为自身结点\r\n\r\n如果是这样的话那我理解您定义的\r\n\r\ntermLoged 相当于dledger里的lastLogTerm,termWanted 相当于 dledger里的term。\r\n\r\n实际上如果每个node都只有一个的term值的话维护起来会方便一点，状态没那么复杂。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636417675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636421478","html_url":"https://github.com/apache/rocketmq/pull/2059#issuecomment-636421478","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2059","id":636421478,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQyMTQ3OA==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T04:51:18Z","updated_at":"2020-06-04T15:28:45Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31240524/badge)](https://coveralls.io/builds/31240524)\n\nCoverage increased (+0.07%) to 51.005% when pulling **08e4fe5a4d19a75ea5d920205bfbde5c41a2dd0f on lebron374:npe_fix** into **b3ec283c8d9d11dab95a3f0dfc4ee9789bf53749 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636421478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636421492","html_url":"https://github.com/apache/rocketmq/pull/2059#issuecomment-636421492","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2059","id":636421492,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQyMTQ5Mg==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T04:51:28Z","updated_at":"2020-06-04T15:28:54Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2059?src=pr&el=h1) Report\n> Merging [#2059](https://codecov.io/gh/apache/rocketmq/pull/2059?src=pr&el=desc) into [develop](https://codecov.io/gh/apache/rocketmq/commit/336599b15a6b72362f308371d863462e19f8a376&el=desc) will **decrease** coverage by `0.01%`.\n> The diff coverage is `0.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/rocketmq/pull/2059/graphs/tree.svg?width=650&height=150&src=pr&token=4w0sxP1wZv)](https://codecov.io/gh/apache/rocketmq/pull/2059?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #2059      +/-   ##\n=============================================\n- Coverage      45.23%   45.21%   -0.02%     \n+ Complexity      4219     4214       -5     \n=============================================\n  Files            545      545              \n  Lines          35810    35812       +2     \n  Branches        4758     4761       +3     \n=============================================\n- Hits           16197    16191       -6     \n- Misses         17566    17570       +4     \n- Partials        2047     2051       +4     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/2059?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...ent/impl/consumer/DefaultLitePullConsumerImpl.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9EZWZhdWx0TGl0ZVB1bGxDb25zdW1lckltcGwuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...apache/rocketmq/remoting/netty/ResponseFuture.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L1Jlc3BvbnNlRnV0dXJlLmphdmE=) | `85.00% <0.00%> (-5.00%)` | `16.00% <0.00%> (-2.00%)` | |\n| [...sumer/rebalance/AllocateMessageQueueAveragely.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvY29uc3VtZXIvcmViYWxhbmNlL0FsbG9jYXRlTWVzc2FnZVF1ZXVlQXZlcmFnZWx5LmphdmE=) | `56.52% <0.00%> (-4.35%)` | `7.00% <0.00%> (-2.00%)` | |\n| [...rocketmq/remoting/netty/NettyRemotingAbstract.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L05ldHR5UmVtb3RpbmdBYnN0cmFjdC5qYXZh) | `46.69% <0.00%> (-4.05%)` | `20.00% <0.00%> (-2.00%)` | |\n| [...a/org/apache/rocketmq/filter/util/BloomFilter.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CbG9vbUZpbHRlci5qYXZh) | `59.13% <0.00%> (-2.16%)` | `25.00% <0.00%> (-1.00%)` | |\n| [...org/apache/rocketmq/common/stats/StatsItemSet.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vc3RhdHMvU3RhdHNJdGVtU2V0LmphdmE=) | `38.09% <0.00%> (-1.59%)` | `12.00% <0.00%> (-1.00%)` | |\n| [.../apache/rocketmq/logging/inner/LoggingBuilder.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-bG9nZ2luZy9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbG9nZ2luZy9pbm5lci9Mb2dnaW5nQnVpbGRlci5qYXZh) | `63.60% <0.00%> (-0.32%)` | `3.00% <0.00%> (ø%)` | |\n| [...e/rocketmq/remoting/netty/NettyRemotingClient.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L05ldHR5UmVtb3RpbmdDbGllbnQuamF2YQ==) | `46.92% <0.00%> (-0.28%)` | `26.00% <0.00%> (ø%)` | |\n| [...rocketmq/client/impl/factory/MQClientInstance.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9mYWN0b3J5L01RQ2xpZW50SW5zdGFuY2UuamF2YQ==) | `46.23% <0.00%> (-0.15%)` | `81.00% <0.00%> (+1.00%)` | :arrow_down: |\n| [...main/java/org/apache/rocketmq/store/CommitLog.java](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL0NvbW1pdExvZy5qYXZh) | `67.22% <0.00%> (-0.11%)` | `80.00% <0.00%> (ø%)` | |\n| ... and [7 more](https://codecov.io/gh/apache/rocketmq/pull/2059/diff?src=pr&el=tree-more) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/2059?src=pr&el=continue).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/2059?src=pr&el=footer). Last update [0144b03...08e4fe5](https://codecov.io/gh/apache/rocketmq/pull/2059?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636421492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636427462","html_url":"https://github.com/apache/rocketmq/pull/2060#issuecomment-636427462","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2060","id":636427462,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQyNzQ2Mg==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T06:01:00Z","updated_at":"2020-05-31T06:01:00Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31140627/badge)](https://coveralls.io/builds/31140627)\n\nCoverage increased (+0.09%) to 50.919% when pulling **47b22ece87d43fcdc161e6472693044d7205a5d5 on RealBar:fix/issue1988** into **8ef01a6c635f6972847c40d5540b1945180d7cbd on apache:master**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636427462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636428598","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636428598","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636428598,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQyODU5OA==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T06:15:51Z","updated_at":"2020-05-31T06:24:14Z","author_association":"NONE","body":"> > 可以在pre-vote基础上对raft做进一步改进以对选举过程中产生的消耗做相关优化，在pre-vote阶段根据自身接受日志记录的term及日志index作为获取选举资格的凭证，但在每次选举中携带自身【termLoged，indexLogged，termWanted，nodeId】拉取选票，其中termLoged为自身接受日志记录的最新term，indexLodded为自身接受最大term日志记录的最大index，termWanted初始值为termLoged，在每次选举失败后+1，nodeId为自身结点，拉取选票会出现以下几种情况:\r\n> > 【\r\n> > 情况1：其他结点(如结点B)收到选举消息后经过对比发现结点B自身记录的日志term>结点A发送过来的termLoged，则反馈termSmallError异常的反对票.\r\n> > 情况2：其他结点(如结点B)收到选举消息后发现自身记录日志term小于结点A发送过来的termLogged，或者自身记录日志term=结点A发送过来的termLogged且自身日志index<indexLogged则更新自身记录的termWanted并反馈以赞同票。\r\n> > 情况3：其他结点(如节点B)发现自身记录日志term与A发过来的termLogged一致且自身日志index=indexLogged，则以跟自身已认可的termWanted与接受到的termWanted进行对比，如果自身已认可的termWanted>=B结点发过来的termWanted，则反馈选举失败(但不为反对票)并在反馈报文中告知自身记录的最大termWanted。\r\n> > 】\r\n> > 结点A根据获取到的多数反馈或经过一定超时时间后根据不同情况分别做如下策略:\r\n> > 【\r\n> > 情况1:如果结点A获得了多数结点的认可并未获得反对票，则以leader身份并以termWanted作为任期开始执行leader责任(如果任期失败则再次进入leader查找及选主状态)。\r\n> > 情况2:如果结点A如果未收到反对票也未获得大多数认可时则据反馈的termWanted集合中与自身（termWanted+1)的最大值来变更termWanted并在随机等待后进行下一轮选票拉取。\r\n> > 情况3:如果收到的投票中存在反对票，结点B会随机等待后再次判断leader是否存在及在无法知晓leader存在后经过pre-vote阶段获取自身候选人资格并判断是否存在新leader，如果不存在新leader则尝试通过pre-vote获取候选人资格并在候选人资格获得后重新发起选举(之所以如此设计是因为当结点B等少数结点是所有结点中唯一持有更大termLogged的结点并在此后因为这系列少数结点故障永久性无法通信)；\r\n> > 】\r\n> > 通过以上方案，避免了每次拉选票之前频繁的pre-vote中候选人资格认证阶段的消耗，并能够在获取到leader存在后及时变更自身状态，也保证了当选的leader确实拥有最新的日志记录，同时避免了出现长时间脑裂的恢复后日志term落后引发的误选及有效日志回滚，也避免了少部分记录有最新日志记录结点(因为某些原因日志未受多数认可而leader故障引发无主)集体永久性宕机后引发的无法选举问题。为了保证特殊情况下的及时获取leader信息日志，仍补充issue中所提到的策略\r\n> \r\n> 两个小问题：\r\n> 自身记录日志term 就是 termLoged 嘛。可以问一下为什么要拆分出term 和 termWanted 嘞，因为您说\r\n> \r\n> > termLoged，indexLogged，termWanted，nodeId】拉取选票，其中termLoged为自身接受日志记录的最新term，indexLodded为自身接受最大term日志记录的最大index，termWanted初始值为termLoged，在每次选举失败后+1，nodeId为自身结点\r\n> \r\n> 如果是这样的话那我理解您定义的\r\n> \r\n> termLoged 相当于dledger里的lastLogTerm,termWanted 相当于 dledger里的term。\r\n> \r\n> 实际上如果每个node都只有一个的term值的话维护起来会方便一点，状态没那么复杂。\r\n\r\n对，这部分是你理解的，跟raft协议一致，之所以引入两个不同term是为了当以失败自增的选举term拉取选票前提下保障当选为leader具有全局可见的最新日志纪录。我所提及的变更是对pre-vote这个阶段在选举失败后的重复认可（对第一次pre-vote获取选举人资格及第一次拉取选票这些步骤及之前都未做改动），为了弥补期间出现的间歇性脑裂带来的日志纪录延滞造成的候选人资格剥夺未知问题（因为脑裂期间确实存在着leader已当选问题），在正式选取拉取选票时携带自身最新日志纪录term做对比可以修复该问题。但不管哪种方案，都无法消除该issue所提及的问题（因少部分结点认可过更大的选举term导致当选leader所广播消息暂时不受自身认可（虽然可以在新一轮的比较日志纪录term后会重新正确认可其leader权））。（所涉及的讨论都以在网络或硬件在不同阶段及不同结点可能出现各种问题下如何加速选举及在不丢失历史日志纪录前提下保证最快的一致性恢复，所论述基础抛开上帝视角）。当然，正如raft协议所提及，非选举状态每个结点都只维持一个term，在进入无法获知leader则根据该term分化出日志term及失败自增的选举term。因为容易证明（非选举状态维护两个term会带来连续两次leader故障所引发的其他问题）","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636428598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636429527","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636429527","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636429527,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQyOTUyNw==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T06:29:24Z","updated_at":"2020-05-31T06:32:33Z","author_association":"CONTRIBUTOR","body":"> 因少部分结点认可过更大的选举term导致当选leader所广播消息暂时不受自身认可\r\n\r\n我觉得这可能不是一个问题，感觉这是raft协议期望发生的事情。\r\n可以再详细讲一下为什么\r\n\r\n> 情况2:结点【5，6，7】等少数结点接受结点7该term=7的选举，结点7未作为leader执行职责，但此时因为【5，6，7】结点已经认可了term=7的任期，会导致结点1以term=6所发送提议无法被接受，但结点1因为已经此实确实获取多数结点认可，在提议被多数接受后会进行提交。可惜目前所用的raft协议未考虑该情况下的处理方案。\r\n\r\n这种情况出问题了嘛，非常感谢～","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636429527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636431464","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636431464","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636431464,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQzMTQ2NA==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T06:55:03Z","updated_at":"2020-05-31T06:55:03Z","author_association":"NONE","body":"> > 因少部分结点认可过更大的选举term导致当选leader所广播消息暂时不受自身认可\r\n> \r\n> 我觉得这可能不是一个问题，感觉这是raft协议期望发生的事情。\r\n> 可以再详细讲一下为什么\r\n> \r\n> > 情况2:结点【5，6，7】等少数结点接受结点7该term=7的选举，结点7未作为leader执行职责，但此时因为【5，6，7】结点已经认可了term=7的任期，会导致结点1以term=6所发送提议无法被接受，但结点1因为已经此实确实获取多数结点认可，在提议被多数接受后会进行提交。可惜目前所用的raft协议未考虑该情况下的处理方案。\r\n> \r\n> 这种情况出问题了嘛，非常感谢～\r\n\r\n因为这样会引发部分结点对真实leader（当选leader结点已受大多数结点认可并履行职责）的不认可导致的一定时期内的分区问题。该分区问题本来可通过无条件接受提交指令（能发出提交指令肯定说明已经受到了多数结点接受）来得以快速恢复","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636431464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636441247","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636441247","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636441247,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQ0MTI0Nw==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T08:45:09Z","updated_at":"2020-05-31T08:45:09Z","author_association":"CONTRIBUTOR","body":"> > > 因少部分结点认可过更大的选举term导致当选leader所广播消息暂时不受自身认可\r\n> > \r\n> > \r\n> > 我觉得这可能不是一个问题，感觉这是raft协议期望发生的事情。\r\n> > 可以再详细讲一下为什么\r\n> > > 情况2:结点【5，6，7】等少数结点接受结点7该term=7的选举，结点7未作为leader执行职责，但此时因为【5，6，7】结点已经认可了term=7的任期，会导致结点1以term=6所发送提议无法被接受，但结点1因为已经此实确实获取多数结点认可，在提议被多数接受后会进行提交。可惜目前所用的raft协议未考虑该情况下的处理方案。\r\n> > \r\n> > \r\n> > 这种情况出问题了嘛，非常感谢～\r\n> \r\n> 因为这样会引发部分结点对真实leader（当选leader结点已受大多数结点认可并履行职责）的不认可导致的一定时期内的分区问题。该分区问题本来可通过无条件接受提交指令（能发出提交指令肯定说明已经受到了多数结点接受）来得以快速恢复\r\n\r\n可以详细解释一下什么是提交指令嘛，我记得raft里没有提交指令。提交与否是由某个log是否在当前term内copy到多数节点上决定的。term =6 的提议如果在**term = 6 期间**被复制到了多数节点上，那么这个值就一定被commit了，不需要再做额外的请求使其commit。\r\n\r\n我感觉您描述的应该不是一个safety的问题，而是一个performance的问题。并且您描述里的分区，具体指的是什么呢？node 7 肯定不可能成为 leader， 而\r\n- node 1 要么永远都联系不到 5，6，7， 因此node 1 一直都不知道有一个term 为 7 的node，因此node 1 可以继续成为leader 并正常运行\r\n\r\n- node  1 可以联系到 5 ，6 ， 7 因此退化成为follower，把自己的term 也改成 7 。 如果node 7 一直不能成为 leader， 那么某个follower 会 timeout 为candidate 并使用 term 8  进行投票\r\n\r\n这里面分区会发生在什么时候呢？\r\n\r\n非常感谢~","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636441247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636449082","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636449082","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636449082,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQ0OTA4Mg==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T10:02:01Z","updated_at":"2020-05-31T10:02:01Z","author_association":"NONE","body":"> > > > 因少部分结点认可过更大的选举term导致当选leader所广播消息暂时不受自身认可\r\n> > > \r\n> > > \r\n> > > 我觉得这可能不是一个问题，感觉这是raft协议期望发生的事情。\r\n> > > 可以再详细讲一下为什么\r\n> > > > 情况2:结点【5，6，7】等少数结点接受结点7该term=7的选举，结点7未作为leader执行职责，但此时因为【5，6，7】结点已经认可了term=7的任期，会导致结点1以term=6所发送提议无法被接受，但结点1因为已经此实确实获取多数结点认可，在提议被多数接受后会进行提交。可惜目前所用的raft协议未考虑该情况下的处理方案。\r\n> > > \r\n> > > \r\n> > > 这种情况出问题了嘛，非常感谢～\r\n> > \r\n> > \r\n> > 因为这样会引发部分结点对真实leader（当选leader结点已受大多数结点认可并履行职责）的不认可导致的一定时期内的分区问题。该分区问题本来可通过无条件接受提交指令（能发出提交指令肯定说明已经受到了多数结点接受）来得以快速恢复\r\n> \r\n> 可以详细解释一下什么是提交指令嘛，我记得raft里没有提交指令。提交与否是由某个log是否在当前term内copy到多数节点上决定的。term =6 的提议如果在**term = 6 期间**被复制到了多数节点上，那么这个值就一定被commit了，不需要再做额外的请求使其commit。\r\n> \r\n> 我感觉您描述的应该不是一个safety的问题，而是一个performance的问题。并且您描述里的分区，具体指的是什么呢？node 7 肯定不可能成为 leader， 而\r\n> \r\n> * node 1 要么永远都联系不到 5，6，7， 因此node 1 一直都不知道有一个term 为 7 的node，因此node 1 可以继续成为leader 并正常运行\r\n> * node  1 可以联系到 5 ，6 ， 7 因此退化成为follower，把自己的term 也改成 7 。 如果node 7 一直不能成为 leader， 那么某个follower 会 timeout 为candidate 并使用 term 8  进行投票\r\n> \r\n> 这里面分区会发生在什么时候呢？\r\n> \r\n> 非常感谢~\r\n\r\nraft协议中leader履行职责中在广播日志提议后如果收到了多数响应会发出提交指令的，并向客户端反馈结果（这跟zk是一样的）。而且协议本身明确了收到多数赞同票就可以作为leader，即即使567结点没赞同，但只要1234多数结点赞同就会进入leader状态（因为raft或zk的一致性在于保证提交的消息及多数认可的提议绝对不丢失，不会因为只有少数结点存在着提议日志就因噎废食）。因为通过pre-vote获取候选人资格这一前提保证了候选人持有多数结点具有的最新日志。结点7如果快了一拍，在结点234中任意一个结点收到结点1提议消息之前收到选票也是会获取leader资格的（这仅会使的结点1发现提议不收认可自动切换到寻找leader状态），该情况下结点7就进入leader状态。新选leader会将新term的空日志跟所知的旧term的记录日志一次性提议保障不落下之前的有效提议（即已提交的或多数认可的提议）。退化为follower在于自身已经感知到自身所持日志纪录并非最新，在因为未获得最新选举term不必要进入follower。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636449082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636458133","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636458133","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636458133,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQ1ODEzMw==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T11:27:02Z","updated_at":"2020-05-31T11:27:02Z","author_association":"CONTRIBUTOR","body":"> raft协议中leader履行职责中在广播日志提议后如果收到了多数响应会发出提交指令的，并向客户端反馈结果\r\n\r\nraft 里leader 的提议是指什么嘞？ 是指把某个entry复制到其他节点上吗？ 因为raft里并没有像paxos明确提出proposal的概念，所以我不太清楚“广播日志提议” 是不是指向其他节点发送\r\nAppendEntries。\r\n\r\n我是这么理解raft的commit 的：commit完成的标志应该是：如果一条log具有和leader相同的term且被复制到大多数节点上，那么在复制到大多数节点上这个行为完成的瞬间，这条log及其之前的所有log实质上就已经commit了。raft原论文中并没有明确 commit这样一个RPC call，只是在每次leader 向其他节点发送appendEntry或者心跳包（空的appendEntry）的时候，会携带上leader 的commitIndex，其他节点根据这个commitIndex来“学习”最新的commitIndex 的值。但是这个commitIndex的作用仅仅是通知。commitIndex 可能比实际已经commit的log  Index要小，但是绝对能保证commitIndex及其之前的log全都已经commit了。\r\n\r\n> 结点7如果快了一拍，在结点234中任意一个结点收到结点1提议消息之前收到选票也是会获取leader资格的（这仅会使的结点1发现提议不收认可自动切换到寻找leader状态），该情况下结点7就进入leader状态。\r\n\r\n“在结点234中任意一个结点收到结点1提议消息之前”，我认为可以改成“在节点234 任意一个节点复制了某个结点1 的term = 6 的log之前”，这样可能能消除部分歧义。\r\n\r\n\r\n> 新选leader会将新term的空日志跟所知的旧term记录日志一次性提议保障不落下之前的有效提议（即已提交的或多数认可的提议）。\r\n\r\n已提交和多数认可的协议，可以问一下这两个区别在哪里嘛～\r\n\r\n> 退化为follower在于自身已经感知到自身所持日志纪录并非最新，在因为未获得最新选举term不必要进入follower。\r\n\r\n对不起这句话后半句我没有完全理解，可以更详细的解释一下后面一句嘛～\r\n\r\n非常感谢～","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636458133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636459458","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636459458","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636459458,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjQ1OTQ1OA==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-05-31T11:39:42Z","updated_at":"2020-05-31T12:07:32Z","author_association":"NONE","body":"> > raft协议中leader履行职责中在广播日志提议后如果收到了多数响应会发出提交指令的，并向客户端反馈结果\r\n> \r\n> raft 里leader 的提议是指什么嘞？ 是指把某个entry复制到其他节点上吗？ 因为raft里并没有像paxos明确提出proposal的概念，所以我不太清楚“广播日志提议” 是不是指向其他节点发送\r\n> AppendEntries。\r\n> \r\n> 我是这么理解raft的commit 的：commit完成的标志应该是：如果一条log具有和leader相同的term且被复制到大多数节点上，那么在复制到大多数节点上这个行为完成的瞬间，这条log及其之前的所有log实质上就已经commit了。raft原论文中并没有明确 commit这样一个RPC call，只是在每次leader 向其他节点发送appendEntry或者心跳包（空的appendEntry）的时候，会携带上leader 的commitIndex，其他节点根据这个commitIndex来“学习”最新的commitIndex 的值。但是这个commitIndex的作用仅仅是通知。commitIndex 可能比实际已经commit的log Index要小，但是绝对能保证commitIndex及其之前的log全都已经commit了。\r\n> \r\n> > 结点7如果快了一拍，在结点234中任意一个结点收到结点1提议消息之前收到选票也是会获取leader资格的（这仅会使的结点1发现提议不收认可自动切换到寻找leader状态），该情况下结点7就进入leader状态。\r\n> \r\n> “在结点234中任意一个结点收到结点1提议消息之前”，我认为可以改成“在节点234 任意一个节点复制了某个结点1 的term = 6 的log之前”，这样可能能消除部分歧义。\r\n> \r\n> > 新选leader会将新term的空日志跟所知的旧term记录日志一次性提议保障不落下之前的有效提议（即已提交的或多数认可的提议）。\r\n> \r\n> 已提交和多数认可的协议，可以问一下这两个区别在哪里嘛～\r\n> \r\n> > 退化为follower在于自身已经感知到自身所持日志纪录并非最新，在因为未获得最新选举term不必要进入follower。\r\n> \r\n> 对不起这句话后半句我没有完全理解，可以更详细的解释一下后面一句嘛～\r\n> \r\n> 非常感谢～\r\n\r\ncommitindex作用就是提交指令，只是附加了心跳功能。对部分结点的commitindex确实会小于日志索引，但对多数是相等的，因为具有appendentry请求加持。其实raft的appendentry作用就是zk的proposal，commitindex对多数结点来说作用相当于是zk的commit作用。\r\n你的表述更准确。\r\n已提交是多数认可的充分非必要条件，多数认可是已提交的必要非充分条件。比如结点1发送的完appendentry指令给123456时候挂了，而且123456都记录了该appenentry时候就属于多数认可但未提交例子。\r\n分布式协议能保证有效请求（即被多数结点接受的请求）绝对纪录一致且绝对不丢失，但对于少数结点接受的请求仅做尽量不丢失（对该问题的探讨网上很多针对于zk的描述都是错误的）。具有candidator资格的结点在选举中未收到反对票情况下能绝对保证自身具有持有的纪录日志是全局最新的，在收到反对票能感知到自身纪录日志存在局部非最新，所以保险起见收到反对票才自动退化为follower更符合实际情况。对于因为选举中存在多数同意但少数不同意（但不是反对，反对是loggedterm延滞引发）则是脑裂引起的没争取到该部分结点认同的leader资格。在自身后续提议appendentry获得多数接受的情况下不会影响全局一致性问题。选举中对raft做改造，对选举投票反馈中修改为同意，不同意（含网络硬件故障引起的不可知），反对三种情况。\r\n另外以上方案隐含的优势是选举中更偏向于结点中通信更快运转更快的结点。\r\n另外可以对raft做进一步改造，类似于投票效力加权功能，让leader倾向存在于部分结点","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636459458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636571891","html_url":"https://github.com/apache/rocketmq/issues/2045#issuecomment-636571891","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2045","id":636571891,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjU3MTg5MQ==","user":{"login":"lizhiboo","id":16134780,"node_id":"MDQ6VXNlcjE2MTM0Nzgw","avatar_url":"https://avatars.githubusercontent.com/u/16134780?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhiboo","html_url":"https://github.com/lizhiboo","followers_url":"https://api.github.com/users/lizhiboo/followers","following_url":"https://api.github.com/users/lizhiboo/following{/other_user}","gists_url":"https://api.github.com/users/lizhiboo/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhiboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhiboo/subscriptions","organizations_url":"https://api.github.com/users/lizhiboo/orgs","repos_url":"https://api.github.com/users/lizhiboo/repos","events_url":"https://api.github.com/users/lizhiboo/events{/privacy}","received_events_url":"https://api.github.com/users/lizhiboo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T01:50:08Z","updated_at":"2020-06-01T01:50:08Z","author_association":"CONTRIBUTOR","body":"> @lizhiboo when finished it , reply with PR id\r\n\r\ndone, PR id #2057","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636571891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636587698","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636587698","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636587698,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjU4NzY5OA==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T03:01:47Z","updated_at":"2020-06-01T03:02:12Z","author_association":"CONTRIBUTOR","body":"> 已提交是多数认可的充分非必要条件，多数认可是已提交的必要非充分条件。比如结点1发送的完appendentry指令给123456时候挂了，而且123456都记录了该appenentry时候就属于多数认可但未提交例子。\r\n\r\n看起来这里就是我们的分歧所在了，我理解的是在raft里，123456 如果都记录了该term = 6 appendEntry（都存有该log entry的replica），那么此时该log entry 就已经提交了。这是和paxos/zab 不一样的地方。\r\n\r\n*准确来说，raft的leader选举过程相当于 paxos的phase1， raft的appendEntrys相当于paxos的phase 2。 [Paxos vs Raft](https://arxiv.org/pdf/2004.05074.pdf)*\r\n\r\n\r\n>对于因为选举中存在多数同意但少数不同意（但不是反对，反对是loggedterm延滞引发） 则是脑裂引起的没争取到该部分结点认同的leader资格。\r\n\r\n\r\n可以详细定义一下什么是同意，什么是不同意，什么是反对吗？（就是具体的判断条件），因为这是raft原论文里没有出现过的概念，为避免歧义，我们还是争取尽量准确地定义术语吧 :smile: \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636587698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636595635","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636595635","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636595635,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjU5NTYzNQ==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T03:37:42Z","updated_at":"2020-06-01T03:37:42Z","author_association":"NONE","body":"> > 已提交是多数认可的充分非必要条件，多数认可是已提交的必要非充分条件。比如结点1发送的完appendentry指令给123456时候挂了，而且123456都记录了该appenentry时候就属于多数认可但未提交例子。\r\n> \r\n> 看起来这里就是我们的分歧所在了，我理解的是在raft里，123456 如果都记录了该term = 6 appendEntry（都存有该log entry的replica），那么此时该log entry 就已经提交了。这是和paxos/zab 不一样的地方。\r\n> \r\n> _准确来说，raft的leader选举过程相当于 paxos的phase1， raft的appendEntrys相当于paxos的phase 2。 [Paxos vs Raft](https://arxiv.org/pdf/2004.05074.pdf)_\r\n> \r\n> > 对于因为选举中存在多数同意但少数不同意（但不是反对，反对是loggedterm延滞引发） 则是脑裂引起的没争取到该部分结点认同的leader资格。\r\n> \r\n> 可以详细定义一下什么是同意，什么是不同意，什么是反对吗？（就是具体的判断条件），因为这是raft原论文里没有出现过的概念，为避免歧义，我们还是争取尽量准确地定义术语吧\r\n\r\nraft只有同意跟不同意两种情况，即票数1跟票数0。为了加速感知到日志纪录的滞后性并进入follower，引入反对票。可以理解为每个结点在收到选举请求后，根据收到的loggedterm，loggedindex，termwanted进行对比，如果前两者自身更大，则反馈结果中填入票数-10000，如果前两者自身更小或相等而自身所知termwanted更大，则反馈结果中填入票数0，否则反馈结果中填入票数1。选举发起人收到多数结点反馈或超时后计算总得票数据此获得leader权","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636595635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636598234","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636598234","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636598234,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjU5ODIzNA==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T03:49:20Z","updated_at":"2020-06-01T03:49:20Z","author_association":"CONTRIBUTOR","body":"> > > 已提交是多数认可的充分非必要条件，多数认可是已提交的必要非充分条件。比如结点1发送的完appendentry指令给123456时候挂了，而且123456都记录了该appenentry时候就属于多数认可但未提交例子。\r\n> > \r\n> > \r\n> > 看起来这里就是我们的分歧所在了，我理解的是在raft里，123456 如果都记录了该term = 6 appendEntry（都存有该log entry的replica），那么此时该log entry 就已经提交了。这是和paxos/zab 不一样的地方。\r\n> > _准确来说，raft的leader选举过程相当于 paxos的phase1， raft的appendEntrys相当于paxos的phase 2。 [Paxos vs Raft](https://arxiv.org/pdf/2004.05074.pdf)_\r\n> > > 对于因为选举中存在多数同意但少数不同意（但不是反对，反对是loggedterm延滞引发） 则是脑裂引起的没争取到该部分结点认同的leader资格。\r\n> > \r\n> > \r\n> > 可以详细定义一下什么是同意，什么是不同意，什么是反对吗？（就是具体的判断条件），因为这是raft原论文里没有出现过的概念，为避免歧义，我们还是争取尽量准确地定义术语吧\r\n> \r\n> raft只有同意跟不同意两种情况，即票数1跟票数0。为了加速感知到日志纪录的滞后性并进入follower，引入反对票。可以理解为每个结点在收到选举请求后，根据收到的loggedterm，loggedindex，termwanted进行对比，如果前两者自身更大，则反馈结果中填入票数-10000，如果前两者自身更小或相等而自身所知termwanted更大，则反馈结果中填入票数0，否则反馈结果中填入票数1。选举发起人收到多数结点反馈或超时后计算总得票数据此获得leader权\r\n\r\n> termwanted进行对比，如果前两者自身更大，则反馈结果中填入票数-10000，\r\n\r\n如果前两者loggedterm，loggedindex，自身更大的话，为什么要candidate进入follower状态呢？如果loggedTerm， loggedIndex 比 candidate的日志更大的话（也就是更up-to-date），那这就应该是普通的拒绝票。candidate并不是遇到了任意一个比自己日志记录更新的follower就要退化到follower的.candidate 不一定要日志全局最新，只用比大部分节点的日志新就好了，我是这样理解的。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636598234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636600651","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636600651","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636600651,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYwMDY1MQ==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T04:01:39Z","updated_at":"2020-06-01T04:01:39Z","author_association":"NONE","body":"> > > > 已提交是多数认可的充分非必要条件，多数认可是已提交的必要非充分条件。比如结点1发送的完appendentry指令给123456时候挂了，而且123456都记录了该appenentry时候就属于多数认可但未提交例子。\r\n> > > \r\n> > > \r\n> > > 看起来这里就是我们的分歧所在了，我理解的是在raft里，123456 如果都记录了该term = 6 appendEntry（都存有该log entry的replica），那么此时该log entry 就已经提交了。这是和paxos/zab 不一样的地方。\r\n> > > _准确来说，raft的leader选举过程相当于 paxos的phase1， raft的appendEntrys相当于paxos的phase 2。 [Paxos vs Raft](https://arxiv.org/pdf/2004.05074.pdf)_\r\n> > > > 对于因为选举中存在多数同意但少数不同意（但不是反对，反对是loggedterm延滞引发） 则是脑裂引起的没争取到该部分结点认同的leader资格。\r\n> > > \r\n> > > \r\n> > > 可以详细定义一下什么是同意，什么是不同意，什么是反对吗？（就是具体的判断条件），因为这是raft原论文里没有出现过的概念，为避免歧义，我们还是争取尽量准确地定义术语吧\r\n> > \r\n> > \r\n> > raft只有同意跟不同意两种情况，即票数1跟票数0。为了加速感知到日志纪录的滞后性并进入follower，引入反对票。可以理解为每个结点在收到选举请求后，根据收到的loggedterm，loggedindex，termwanted进行对比，如果前两者自身更大，则反馈结果中填入票数-10000，如果前两者自身更小或相等而自身所知termwanted更大，则反馈结果中填入票数0，否则反馈结果中填入票数1。选举发起人收到多数结点反馈或超时后计算总得票数据此获得leader权\r\n> \r\n> > termwanted进行对比，如果前两者自身更大，则反馈结果中填入票数-10000，\r\n> \r\n> 如果前两者loggedterm，loggedindex，自身更大的话，为什么要candidate进入follower状态呢？如果loggedTerm， loggedIndex 比 candidate的日志更大的话（也就是更up-to-date），那这就应该是普通的拒绝票。candidate并不是遇到了任意一个比自己日志记录更新的follower就要退化到follower的.candidate 不一定要日志全局最新，只用比大部分节点的日志新就好了，我是这样理解的。\r\n\r\nfollower状态是选举发起人进入。根据term跟index的对比做出投票是投票者的行为。遇到-10000的票从candidator进入follower状态是为了感知到自己日志滞后之后临时不参与leader当选把机会让给强者。因为收到多数票再超时并有反对票，已经就感知到了有更强的结点可能会当选leader。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636600651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636601949","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636601949","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636601949,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYwMTk0OQ==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T04:09:08Z","updated_at":"2020-06-01T04:09:08Z","author_association":"CONTRIBUTOR","body":">  candidator进入follower状态是为了感知到自己日志滞后之后临时不参与leader当选把机会让给强者\r\n\r\n即使只有一个candidate X，该candidate仍然有可能感受到日志滞后，但这并不影响该candidate具有唯一最大的term值，它仍然应该成为leader。 如果其成为leader后，即使它的日志比部分节点落后，这也是安全的。因为比leader X 日志更新的节点一定是少数派，否则X 就不可能成为leader。如果leader X 只是感知到它的日志比少部分节点落后，那么它就可以安全的overwrite掉那些比它更新的日志记录。\r\n\r\n决定candidate 之间 强弱顺序的只有term （也就是你定义的termWanted ） 决定。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636601949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636604891","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636604891","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636604891,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYwNDg5MQ==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T04:22:31Z","updated_at":"2020-06-01T04:22:31Z","author_association":"NONE","body":"> > candidator进入follower状态是为了感知到自己日志滞后之后临时不参与leader当选把机会让给强者\r\n> \r\n> 即使只有一个candidate X，该candidate仍然有可能感受到日志滞后，但这并不影响该candidate具有唯一最大的term值，它仍然应该成为leader。 如果其成为leader后，即使它的日志比部分节点落后，这也是安全的。因为比leader X 日志更新的节点一定是少数派，否则X 就不可能成为leader。如果leader X 只是感知到它的日志比少部分节点落后，那么它就可以安全的overwrite掉那些比它更新的日志记录。\r\n> \r\n> 决定candidate 之间 强弱顺序的只有term （也就是你定义的termWanted ） 决定。\r\n\r\n这种思路存在以下这个问题，结点1获得候选人并发起term=7投票，然后因为略慢了一拍，更快的机器上的候选人结点7用更旧的term=6发起投票并获得leader地位且发起新一轮leader责权履行。引入反对票是针对这系列情况，即一旦感知到自己存在日志纪录term不为最新导致不能百分百当选就迅速退避。一旦当选就尽快履责，一旦当选无望就迅速退避。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636604891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636612872","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636612872","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636612872,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYxMjg3Mg==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T04:57:26Z","updated_at":"2020-06-01T04:57:26Z","author_association":"CONTRIBUTOR","body":"我来整理一下\r\n\r\n投票者\r\n\r\n- 投反对票：根据收到的loggedterm，loggedindex，termwanted进行对比，如果前两者自身更大，而无论自身termWanted更大或者更小或相等，则反馈结果中填入票数-10000\r\n- 投不同意票:如果前两者自身更小或相等而自身所知termwanted更大，则反馈结果中填入票数0\r\n- 投同意票： 如果前两者自身更小或相等而自身所知termwanted更小或相等，则反馈结果中填入票数1\r\n\r\n是这样嘛？\r\n\r\n所以节点 7 到底能不能感知到有term = 7 的候选人决定了节点7能不能成为leader\r\n\r\n\r\n> 即一旦感知到自己存在日志纪录term不为最新导致不能百分百当选就迅速退避\r\n为什么不能百分百当选就迅速退避呢？仍然有可能成为leader啊。\r\n\r\n\r\n完全有可能 节点A 的日志记录比B 新， 但是节点A 的term比B要小。\r\n而这个时候节点A就是普通的拒绝节点B就行了，节点B也不应该\r\n\r\n我感觉你的反对票的目的是，如果有任何一个follower在投票过程中发现自己的日志记录比candidate新，那么这个candidate就应该退化为follower。是这个意思吗\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636612872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636615709","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636615709","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636615709,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYxNTcwOQ==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T05:08:47Z","updated_at":"2020-06-01T05:11:57Z","author_association":"NONE","body":"> 我来整理一下\r\n> \r\n> 投票者\r\n> \r\n> * 投反对票：根据收到的loggedterm，loggedindex，termwanted进行对比，如果前两者自身更大，而无论自身termWanted更大或者更小或相等，则反馈结果中填入票数-10000\r\n> * 投不同意票:如果前两者自身更小或相等而自身所知termwanted更大，则反馈结果中填入票数0\r\n> * 投同意票： 如果前两者自身更小或相等而自身所知termwanted更小或相等，则反馈结果中填入票数1\r\n> \r\n> 是这样嘛？\r\n> \r\n> 所以节点 7 到底能不能感知到有term = 7 的候选人决定了节点7能不能成为leader\r\n> \r\n> > 即一旦感知到自己存在日志纪录term不为最新导致不能百分百当选就迅速退避\r\n> > 为什么不能百分百当选就迅速退避呢？仍然有可能成为leader啊。\r\n> \r\n> 完全有可能 节点A 的日志记录比B 新， 但是节点A 的term比B要小。\r\n> 而这个时候节点A就是普通的拒绝节点B就行了，节点B也不应该\r\n> \r\n> 我感觉你的反对票的目的是，如果有任何一个follower在投票过程中发现自己的日志记录比candidate新，那么这个candidate就应该退化为follower。是这个意思吗\r\n\r\n对，是这样的。但follower在等待一定时间后察觉到leader不存在还是会继续pre-vote以及过渡到候选人阶段，这是为了避免发生新leader在当选后刚提议消息只被少数结点获取就跟着这些少数结点永久性宕机这种情况时永久性不能恢复生产的及其特殊情况。设计目标是更快更健壮减少可不必要的人为干预。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636615709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636621667","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636621667","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636621667,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYyMTY2Nw==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T05:31:56Z","updated_at":"2020-06-01T05:31:56Z","author_association":"CONTRIBUTOR","body":"> 我感觉你的反对票的目的是，如果有任何一个follower在投票过程中发现自己的日志记录比candidate新，那么这个candidate就应该退化为follower。是这个意思吗\r\n\r\n问题是这样实现的话就已经不是raft协议了，我认为这样实现是不对的，会导致liveness甚至是safety的问题。\r\n\r\n考虑这样一个情况\r\n\r\nnode 7 在 term = 6 期间把一条log复制到了 node 6 上，然后node 7 宕机。\r\n\r\n这个时候，如果按照你的实现，只有可能node 6 能成为candidate，因为node 1 2 3 4 5  的日志记录都比node 6 的要旧。\r\n\r\n可是这样的话假设node 1 具有最短的timeout间隔而node 6 具有最长的timeout间隔。这也就意味着即使node 1 本应最先成为leader，却因为多出来的条件而导致不能成为leader，就违背了任意不同node采用不同timeout时长的初衷了。\r\n\r\n更重要的是这样做并没有什么意义，candidate就没有必要比每一个node的日记记录都要新，才用你说的反对票机制并不能带来额外的好处\r\n\r\n> 这是为了避免发生新leader在当选后刚提议消息只被少数结点获取就跟着这些少数结点永久性宕机这种情况时，永久性不能恢复生产的及其特殊情况\r\n\r\n我不认为这种情况会在raft协议中出现，如果只是少数派节点宕机那么raft一定能选出一个leader来继续工作，如果您能提供一个详细的example说明为什么会出现少数节点宕机会导致永久不能恢复生产的话，非常感谢～\r\n\r\n至于新的提案里的loggedTerm, loggerIndex 在raft里就有这样的概念， 叫lastLogTerm 和 lastLogIndex， termWated 就是 raft 里的 term， 不同的是raft 里的term是 “当前节点所见到过的最大term“。\r\n\r\n总而言之，新的提案对raft的核心步骤做出了修改，将一个原本宽松的条件升级成了一个更为严格的条件，必须得证明这样做不会影响livenss我们才能讨论实现的可能。（safety 被损害的可能性不大，毕竟让leader选举更严格了）\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636621667/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636624815","html_url":"https://github.com/apache/rocketmq/pull/2059#issuecomment-636624815","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2059","id":636624815,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYyNDgxNQ==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T05:43:09Z","updated_at":"2020-06-01T05:43:09Z","author_association":"CONTRIBUTOR","body":"Hi @lebron374, PR name needs to be followed as `[ISSUE #2044] Fix DefaultLitePullConsumerImpl NPE`","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636624815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636626163","html_url":"https://github.com/apache/rocketmq/pull/2058#issuecomment-636626163","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2058","id":636626163,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYyNjE2Mw==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T05:47:41Z","updated_at":"2020-06-01T05:47:41Z","author_association":"CONTRIBUTOR","body":"Hi, @RealBar You need change the target branch to develop and pass the CI.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636626163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636630269","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636630269","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636630269,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYzMDI2OQ==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T06:01:35Z","updated_at":"2020-06-01T06:01:35Z","author_association":"NONE","body":"> > 我感觉你的反对票的目的是，如果有任何一个follower在投票过程中发现自己的日志记录比candidate新，那么这个candidate就应该退化为follower。是这个意思吗\r\n> \r\n> 问题是这样实现的话就已经不是raft协议了，我认为这样实现是不对的，会导致liveness甚至是safety的问题。\r\n> \r\n> 考虑这样一个情况\r\n> \r\n> node 7 在 term = 6 期间把一条log复制到了 node 6 上，然后node 7 宕机。\r\n> \r\n> 这个时候，如果按照你的实现，只有可能node 6 能成为candidate，因为node 1 2 3 4 5 的日志记录都比node 6 的要旧。\r\n> \r\n> 可是这样的话假设node 1 具有最短的timeout间隔而node 6 具有最长的timeout间隔。这也就意味着即使node 1 本应最先成为leader，却因为多出来的条件而导致不能成为leader，就违背了任意不同node采用不同timeout时长的初衷了。\r\n> \r\n> 更重要的是这样做并没有什么意义，candidate就没有必要比每一个node的日记记录都要新，才用你说的反对票机制并不能带来额外的好处\r\n> \r\n> > 这是为了避免发生新leader在当选后刚提议消息只被少数结点获取就跟着这些少数结点永久性宕机这种情况时，永久性不能恢复生产的及其特殊情况\r\n> \r\n> 我不认为这种情况会在raft协议中出现，如果只是少数派节点宕机那么raft一定能选出一个leader来继续工作，如果您能提供一个详细的example说明为什么会出现少数节点宕机会导致永久不能恢复生产的话，非常感谢～\r\n> \r\n> 至于新的提案里的loggedTerm, loggerIndex 在raft里就有这样的概念， 叫lastLogTerm 和 lastLogIndex， termWated 就是 raft 里的 term， 不同的是raft 里的term是 “当前节点所见到过的最大term“。\r\n> \r\n> 总而言之，新的提案对raft的核心步骤做出了修改，将一个原本宽松的条件升级成了一个更为严格的条件，必须得证明这样做不会影响livenss我们才能讨论实现的可能。（safety 被损害的可能性不大，毕竟让leader选举更严格了）\r\n\r\n引入退化follower再次等待一定时长后参选，是为了保障不会所有节点同时遇到这种情况下的永久性follower。\r\n任何结点不能站在上帝视角观察整个过程。所以结点1在获取反对票时并无法确定是少数新leader如7宕机还是自己收到选票后就已经有了正常工作的新的leader出现。pre-vote候选人资格只是保证了获取资格时的日志纪录最新，不代表投票时的日志纪录最新，因为别的结点完全有可能会在这期间获得候选人资格并当选leader。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636630269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636633078","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-636633078","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":636633078,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjYzMzA3OA==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-01T06:10:27Z","updated_at":"2020-06-01T06:18:34Z","author_association":"CONTRIBUTOR","body":"我建议您最好写一个更为详细，所有术语定义较为准确的proposal出来，并说出您认为原有的raft实现哪种case没有处理好，举出一个详细准确例子（比如按照raft算法走一遍），再说说您的解决方案为什么可以解决那个例子。我感觉您在表述的时候默认了很多您心中清楚但我们并不清楚的概念，再加上您的解释没有很好的上下文，这样的话阅读起来有一点点困难，一点小建议哈～\r\n\r\n举个例子\r\n> 所以结点1在获取反对票时并无法确定是少数新leader如7宕机还是自己收到选票后就已经有了正常工作的新的leader出现\r\n\r\n以及\r\n> 这是为了避免发生新leader在当选后刚提议消息只被少数结点获取就跟着这些少数结点永久性宕机这种情况时永久性不能恢复生产的及其特殊情况。\r\n\r\n这两句话如果有例子的话会更好理解一点\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/636633078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637225616","html_url":"https://github.com/apache/rocketmq/pull/2059#issuecomment-637225616","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2059","id":637225616,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzIyNTYxNg==","user":{"login":"vongosling","id":635581,"node_id":"MDQ6VXNlcjYzNTU4MQ==","avatar_url":"https://avatars.githubusercontent.com/u/635581?v=4","gravatar_id":"","url":"https://api.github.com/users/vongosling","html_url":"https://github.com/vongosling","followers_url":"https://api.github.com/users/vongosling/followers","following_url":"https://api.github.com/users/vongosling/following{/other_user}","gists_url":"https://api.github.com/users/vongosling/gists{/gist_id}","starred_url":"https://api.github.com/users/vongosling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vongosling/subscriptions","organizations_url":"https://api.github.com/users/vongosling/orgs","repos_url":"https://api.github.com/users/vongosling/repos","events_url":"https://api.github.com/users/vongosling/events{/privacy}","received_events_url":"https://api.github.com/users/vongosling/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-02T02:11:30Z","updated_at":"2020-06-02T02:11:58Z","author_association":"MEMBER","body":"@lebron374 Good catch, could you help to add unit test for here?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637225616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637230508","html_url":"https://github.com/apache/rocketmq/issues/2062#issuecomment-637230508","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2062","id":637230508,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzIzMDUwOA==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-02T02:27:01Z","updated_at":"2020-06-02T02:27:01Z","author_association":"CONTRIBUTOR","body":"#2008 fixed it","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637230508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637232426","html_url":"https://github.com/apache/rocketmq/issues/2061#issuecomment-637232426","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2061","id":637232426,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzIzMjQyNg==","user":{"login":"vongosling","id":635581,"node_id":"MDQ6VXNlcjYzNTU4MQ==","avatar_url":"https://avatars.githubusercontent.com/u/635581?v=4","gravatar_id":"","url":"https://api.github.com/users/vongosling","html_url":"https://github.com/vongosling","followers_url":"https://api.github.com/users/vongosling/followers","following_url":"https://api.github.com/users/vongosling/following{/other_user}","gists_url":"https://api.github.com/users/vongosling/gists{/gist_id}","starred_url":"https://api.github.com/users/vongosling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vongosling/subscriptions","organizations_url":"https://api.github.com/users/vongosling/orgs","repos_url":"https://api.github.com/users/vongosling/repos","events_url":"https://api.github.com/users/vongosling/events{/privacy}","received_events_url":"https://api.github.com/users/vongosling/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-02T02:32:54Z","updated_at":"2020-06-02T02:32:54Z","author_association":"MEMBER","body":"You could set instanceName or change your codebase to https://github.com/apache/rocketmq-spring with full-featured scaffold off-the-shelf.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637232426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637556807","html_url":"https://github.com/apache/rocketmq/issues/2066#issuecomment-637556807","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2066","id":637556807,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzU1NjgwNw==","user":{"login":"lebron374","id":5032169,"node_id":"MDQ6VXNlcjUwMzIxNjk=","avatar_url":"https://avatars.githubusercontent.com/u/5032169?v=4","gravatar_id":"","url":"https://api.github.com/users/lebron374","html_url":"https://github.com/lebron374","followers_url":"https://api.github.com/users/lebron374/followers","following_url":"https://api.github.com/users/lebron374/following{/other_user}","gists_url":"https://api.github.com/users/lebron374/gists{/gist_id}","starred_url":"https://api.github.com/users/lebron374/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lebron374/subscriptions","organizations_url":"https://api.github.com/users/lebron374/orgs","repos_url":"https://api.github.com/users/lebron374/repos","events_url":"https://api.github.com/users/lebron374/events{/privacy}","received_events_url":"https://api.github.com/users/lebron374/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-02T13:51:05Z","updated_at":"2020-06-02T13:51:05Z","author_association":"CONTRIBUTOR","body":"you can print the return result and print messageKey，then you can use mqadmin to query the message to check。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637556807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637606420","html_url":"https://github.com/apache/rocketmq/issues/2066#issuecomment-637606420","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2066","id":637606420,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzYwNjQyMA==","user":{"login":"zhgdbut","id":46836979,"node_id":"MDQ6VXNlcjQ2ODM2OTc5","avatar_url":"https://avatars.githubusercontent.com/u/46836979?v=4","gravatar_id":"","url":"https://api.github.com/users/zhgdbut","html_url":"https://github.com/zhgdbut","followers_url":"https://api.github.com/users/zhgdbut/followers","following_url":"https://api.github.com/users/zhgdbut/following{/other_user}","gists_url":"https://api.github.com/users/zhgdbut/gists{/gist_id}","starred_url":"https://api.github.com/users/zhgdbut/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhgdbut/subscriptions","organizations_url":"https://api.github.com/users/zhgdbut/orgs","repos_url":"https://api.github.com/users/zhgdbut/repos","events_url":"https://api.github.com/users/zhgdbut/events{/privacy}","received_events_url":"https://api.github.com/users/zhgdbut/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-02T15:12:03Z","updated_at":"2020-06-02T15:12:03Z","author_association":"NONE","body":"I had print return result , and use msgId query in the mqadmin, but nothing found! \r\nThis kind of thing only happens once or twice。\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637606420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637916668","html_url":"https://github.com/apache/rocketmq/issues/2056#issuecomment-637916668","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2056","id":637916668,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzkxNjY2OA==","user":{"login":"zhangyixin1222","id":26356536,"node_id":"MDQ6VXNlcjI2MzU2NTM2","avatar_url":"https://avatars.githubusercontent.com/u/26356536?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangyixin1222","html_url":"https://github.com/zhangyixin1222","followers_url":"https://api.github.com/users/zhangyixin1222/followers","following_url":"https://api.github.com/users/zhangyixin1222/following{/other_user}","gists_url":"https://api.github.com/users/zhangyixin1222/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangyixin1222/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangyixin1222/subscriptions","organizations_url":"https://api.github.com/users/zhangyixin1222/orgs","repos_url":"https://api.github.com/users/zhangyixin1222/repos","events_url":"https://api.github.com/users/zhangyixin1222/events{/privacy}","received_events_url":"https://api.github.com/users/zhangyixin1222/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-03T02:34:14Z","updated_at":"2020-06-07T04:44:55Z","author_association":"NONE","body":"对当前的raft选举协议做简述\r\n![raft协议](https://user-images.githubusercontent.com/26356536/83960562-7b0d2b00-a8bc-11ea-80e6-8d8106eb865a.png)\r\n对改版后的选举方式作简述(差异之处用红色标记)\r\n![raft协议改版](https://user-images.githubusercontent.com/26356536/83960563-81030c00-a8bc-11ea-8966-a5071f403be1.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637916668/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637964667","html_url":"https://github.com/apache/rocketmq/issues/2066#issuecomment-637964667","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2066","id":637964667,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzk2NDY2Nw==","user":{"login":"lizhanhui","id":641819,"node_id":"MDQ6VXNlcjY0MTgxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/641819?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhanhui","html_url":"https://github.com/lizhanhui","followers_url":"https://api.github.com/users/lizhanhui/followers","following_url":"https://api.github.com/users/lizhanhui/following{/other_user}","gists_url":"https://api.github.com/users/lizhanhui/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhanhui/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhanhui/subscriptions","organizations_url":"https://api.github.com/users/lizhanhui/orgs","repos_url":"https://api.github.com/users/lizhanhui/repos","events_url":"https://api.github.com/users/lizhanhui/events{/privacy}","received_events_url":"https://api.github.com/users/lizhanhui/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-03T05:34:55Z","updated_at":"2020-06-03T05:34:55Z","author_association":"CONTRIBUTOR","body":"zhgdbut,\n\nHere is the checklist, which might be helpful to you.\n\n1. RocketMQ supports synchronous disk flush and asynchronous disk flush\nstrategies. If you configured to use the latter without replication, in\ncase of a power outage/OS crash, it has chances, though very unlikely, to\nlose one or a few messages as you configured those broker servers to ack\nclients before flushing data to disk.\n2.  When querying messages, RocketMQ internally queries consume queues,\nwhich are built out of commit log asynchronously. If for some reason, the\nbuilding consume-queue process lags behind, you may find the sent message\nunavailable for a while. But your message will appear once the building\ncatches up.\n Check the store.log to see if this is the case.\n3. If your broker runs out of disk, it automatically deletes the\nearliest data in order to keep serving, even if these old ones are never\nconsumed.\n\nEither case mentioned above may lead you to the conclusion that your\nmessage is 'lost'.\n\nZhanhui Li\n\n\nOn Tue, Jun 2, 2020 at 11:12 PM zhgdbut <notifications@github.com> wrote:\n\n> I had print return result , and use msgId query in the mqadmin, but\n> nothing found!\n> This kind of thing only happens once or twice。\n>\n> —\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/rocketmq/issues/2066#issuecomment-637606420>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAE4WG4BBPHTBMWOKXV7UQLRUUJFJANCNFSM4NQUIAOQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/637964667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/638214256","html_url":"https://github.com/apache/rocketmq/pull/2059#issuecomment-638214256","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2059","id":638214256,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODIxNDI1Ng==","user":{"login":"lebron374","id":5032169,"node_id":"MDQ6VXNlcjUwMzIxNjk=","avatar_url":"https://avatars.githubusercontent.com/u/5032169?v=4","gravatar_id":"","url":"https://api.github.com/users/lebron374","html_url":"https://github.com/lebron374","followers_url":"https://api.github.com/users/lebron374/followers","following_url":"https://api.github.com/users/lebron374/following{/other_user}","gists_url":"https://api.github.com/users/lebron374/gists{/gist_id}","starred_url":"https://api.github.com/users/lebron374/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lebron374/subscriptions","organizations_url":"https://api.github.com/users/lebron374/orgs","repos_url":"https://api.github.com/users/lebron374/repos","events_url":"https://api.github.com/users/lebron374/events{/privacy}","received_events_url":"https://api.github.com/users/lebron374/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-03T13:55:22Z","updated_at":"2020-06-03T13:55:22Z","author_association":"CONTRIBUTOR","body":"> It would be better to add ut for this minor bug.\r\n\r\nadd unittest testPullTaskImpl_ProcessQueueDropped","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/638214256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/638693095","html_url":"https://github.com/apache/rocketmq/issues/1852#issuecomment-638693095","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/1852","id":638693095,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODY5MzA5NQ==","user":{"login":"imaffe","id":22848576,"node_id":"MDQ6VXNlcjIyODQ4NTc2","avatar_url":"https://avatars.githubusercontent.com/u/22848576?v=4","gravatar_id":"","url":"https://api.github.com/users/imaffe","html_url":"https://github.com/imaffe","followers_url":"https://api.github.com/users/imaffe/followers","following_url":"https://api.github.com/users/imaffe/following{/other_user}","gists_url":"https://api.github.com/users/imaffe/gists{/gist_id}","starred_url":"https://api.github.com/users/imaffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imaffe/subscriptions","organizations_url":"https://api.github.com/users/imaffe/orgs","repos_url":"https://api.github.com/users/imaffe/repos","events_url":"https://api.github.com/users/imaffe/events{/privacy}","received_events_url":"https://api.github.com/users/imaffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-04T08:24:45Z","updated_at":"2020-06-04T08:25:09Z","author_association":"CONTRIBUTOR","body":"After I digged deeper into this problem, I found it rather hard to solve given we don't currently have reference to TopicConfigManager in DefaultMessageStore.\r\n\r\nTo know which topics are currently not deleted in DefaultMessageStore, we cannot rely on it's `consumeQueueTable` because `consumeQueueTable` itself is constructed using commitLog(which contains entries that belong to a deleted topic)\r\n\r\nIn order to know if an entry in the commitLog belongs to a deleted topic, we have to query topicConfigManager, )but this would be a very big change as we introduced a dependency in broker level, which complicates the synchronization schema as well).\r\n\r\nThe problem is we can't selectively delete an entry in commitLog (unless they expires themselves), and upon restart the async CQ building process will always try to create a CQ entry for each entry in the commitLog. \r\n\r\nSeems like not introducing TopicConfigManager in the DefaultMessageStore would be a better choice if we can prove that keeping the consumeQueue for a deleted topic would not hurt safety. ()\r\n\r\nSince consumers interacts directly with consume queues, it might be not safe in this case (as consume queue keeps the deleted topic information even the topic is not in TopicConfigManager). However I didn't verify this in the source code.\r\n\r\n\r\nThis exposes another problem. We are using topic Names instead of topicId as unique identifiers for a given topic, we cannot distinguish between a deleted topic and a new topic with a same name. For example, we deleted a topic \"user_info\" for application A, and we create a new \"user_info\" for topic B, they are not relevant but consumers can consume messages from older topic. We can avoid this by persuade users don't do so but these kinds of vulnerabilities would still exist. Since using one commitLog for all topics is the core feature of RocketMQ, choices we can make are very limited.\r\n\r\nWill be so happy to see different opinions~~","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/638693095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/638765785","html_url":"https://github.com/apache/rocketmq/issues/2070#issuecomment-638765785","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2070","id":638765785,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODc2NTc4NQ==","user":{"login":"startjava","id":49554320,"node_id":"MDQ6VXNlcjQ5NTU0MzIw","avatar_url":"https://avatars.githubusercontent.com/u/49554320?v=4","gravatar_id":"","url":"https://api.github.com/users/startjava","html_url":"https://github.com/startjava","followers_url":"https://api.github.com/users/startjava/followers","following_url":"https://api.github.com/users/startjava/following{/other_user}","gists_url":"https://api.github.com/users/startjava/gists{/gist_id}","starred_url":"https://api.github.com/users/startjava/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/startjava/subscriptions","organizations_url":"https://api.github.com/users/startjava/orgs","repos_url":"https://api.github.com/users/startjava/repos","events_url":"https://api.github.com/users/startjava/events{/privacy}","received_events_url":"https://api.github.com/users/startjava/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-04T10:32:08Z","updated_at":"2020-06-04T10:32:08Z","author_association":"NONE","body":"https://github.com/apache/rocketmq/tree/master/docs/cn/image\r\n\r\nall png file status is 404 !~","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/638765785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/638846064","html_url":"https://github.com/apache/rocketmq/issues/2070#issuecomment-638846064","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2070","id":638846064,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODg0NjA2NA==","user":{"login":"startjava","id":49554320,"node_id":"MDQ6VXNlcjQ5NTU0MzIw","avatar_url":"https://avatars.githubusercontent.com/u/49554320?v=4","gravatar_id":"","url":"https://api.github.com/users/startjava","html_url":"https://github.com/startjava","followers_url":"https://api.github.com/users/startjava/followers","following_url":"https://api.github.com/users/startjava/following{/other_user}","gists_url":"https://api.github.com/users/startjava/gists{/gist_id}","starred_url":"https://api.github.com/users/startjava/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/startjava/subscriptions","organizations_url":"https://api.github.com/users/startjava/orgs","repos_url":"https://api.github.com/users/startjava/repos","events_url":"https://api.github.com/users/startjava/events{/privacy}","received_events_url":"https://api.github.com/users/startjava/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-04T13:26:30Z","updated_at":"2020-06-04T13:26:30Z","author_association":"NONE","body":"自己下载源代码，里面images中的png文件，看到了，自行解决！","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/638846064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/639386746","html_url":"https://github.com/apache/rocketmq/issues/2071#issuecomment-639386746","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2071","id":639386746,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTM4Njc0Ng==","user":{"login":"fibbery","id":8580606,"node_id":"MDQ6VXNlcjg1ODA2MDY=","avatar_url":"https://avatars.githubusercontent.com/u/8580606?v=4","gravatar_id":"","url":"https://api.github.com/users/fibbery","html_url":"https://github.com/fibbery","followers_url":"https://api.github.com/users/fibbery/followers","following_url":"https://api.github.com/users/fibbery/following{/other_user}","gists_url":"https://api.github.com/users/fibbery/gists{/gist_id}","starred_url":"https://api.github.com/users/fibbery/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fibbery/subscriptions","organizations_url":"https://api.github.com/users/fibbery/orgs","repos_url":"https://api.github.com/users/fibbery/repos","events_url":"https://api.github.com/users/fibbery/events{/privacy}","received_events_url":"https://api.github.com/users/fibbery/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-05T10:12:16Z","updated_at":"2020-06-05T10:12:16Z","author_association":"NONE","body":"![image](https://user-images.githubusercontent.com/8580606/83864920-04571d00-a758-11ea-9008-c96447ce29ef.png)\r\n你可以自己定义发送的线程池的，然后你就可以动态设置了","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/639386746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/639427596","html_url":"https://github.com/apache/rocketmq/issues/2063#issuecomment-639427596","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2063","id":639427596,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTQyNzU5Ng==","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-05T11:35:57Z","updated_at":"2020-06-05T11:35:57Z","author_association":"CONTRIBUTOR","body":"@lovegang It is welcomed to submit a PR to upgrade the version of logback. ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/639427596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/639490712","html_url":"https://github.com/apache/rocketmq/issues/504#issuecomment-639490712","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/504","id":639490712,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTQ5MDcxMg==","user":{"login":"bigdogiloveyou","id":13844863,"node_id":"MDQ6VXNlcjEzODQ0ODYz","avatar_url":"https://avatars.githubusercontent.com/u/13844863?v=4","gravatar_id":"","url":"https://api.github.com/users/bigdogiloveyou","html_url":"https://github.com/bigdogiloveyou","followers_url":"https://api.github.com/users/bigdogiloveyou/followers","following_url":"https://api.github.com/users/bigdogiloveyou/following{/other_user}","gists_url":"https://api.github.com/users/bigdogiloveyou/gists{/gist_id}","starred_url":"https://api.github.com/users/bigdogiloveyou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bigdogiloveyou/subscriptions","organizations_url":"https://api.github.com/users/bigdogiloveyou/orgs","repos_url":"https://api.github.com/users/bigdogiloveyou/repos","events_url":"https://api.github.com/users/bigdogiloveyou/events{/privacy}","received_events_url":"https://api.github.com/users/bigdogiloveyou/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-05T13:48:10Z","updated_at":"2020-06-05T13:48:10Z","author_association":"NONE","body":"> > @beijing-penguin 引起no route info的主要原因是因为Broker没有正确连接到NameServer。我发现你在代码中设置namesever地址，如果设置nameserver要起作用，则设置代码须在controller.initialize()之前。另外推荐你采用其他方式配置nameserver，比如设置eclipse中设置broker程序参数 -n localhost:8888，可以看下nameserver的[最佳实践](http://rocketmq.apache.org/docs/best-practice-namesvr/)。\r\n> \r\n> 非常感谢您的专业解答，确实 是broker main方法中设置controller应该在initialize()之前。我模拟命令行,再次用代码设置 args = new String[] {\"-n\",\"127.0.0.1:9876\",\"autoCreateTopicEnable=true\"};入参的方法，问题得到解决。。再次感谢。\r\n> \r\n> ```java\r\n> public static void main(String[] args) {\r\n>         args = new String[] {\"-n\",\"127.0.0.1:9876\",\"autoCreateTopicEnable=true\"};\r\n>         start(createBrokerController(args));\r\n>     }\r\n> \r\n>     public static BrokerController start(BrokerController controller) {\r\n>         try {\r\n>             //controller.getBrokerConfig().setBrokerIP1(\"localhost\");\r\n>             //controller.getBrokerConfig().setNamesrvAddr(\"localhost:8888\");\r\n>             //controller.getBrokerConfig().setAutoCreateTopicEnable(true);\r\n>             controller.start();\r\n> \r\n>             String tip = \"The broker[\" + controller.getBrokerConfig().getBrokerName() + \", \"\r\n>                 + controller.getBrokerAddr() + \"] boot success. serializeType=\" + RemotingCommand.getSerializeTypeConfigInThisServer();\r\n> \r\n>             if (null != controller.getBrokerConfig().getNamesrvAddr()) {\r\n>                 tip += \" and name server is \" + controller.getBrokerConfig().getNamesrvAddr();\r\n>             }\r\n> \r\n>             log.info(tip);\r\n>             System.out.printf(\"%s%n\", tip);\r\n>             return controller;\r\n>         } catch (Throwable e) {\r\n>             e.printStackTrace();\r\n>             System.exit(-1);\r\n>         }\r\n> \r\n>         return null;\r\n>     }\r\n> ```\r\n\r\n谢谢你的示例，我也成功运行了","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/639490712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/639660953","html_url":"https://github.com/apache/rocketmq/pull/2073#issuecomment-639660953","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/2073","id":639660953,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTY2MDk1Mw==","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-06-05T17:43:35Z","updated_at":"2020-06-06T04:42:36Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/31278907/badge)](https://coveralls.io/builds/31278907)\n\nCoverage increased (+0.06%) to 51.318% when pulling **a7904be7d0e7da8ac90a7471e677941ad9662bf8 on ChaosYjh:examineSubscriptionGroupConfig-v2** into **b6307dfce1c201877f7a27691cad74b842c0d971 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/639660953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]