[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725676838","html_url":"https://github.com/apache/iceberg/pull/1751#issuecomment-725676838","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1751","id":725676838,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTY3NjgzOA==","user":{"login":"boroknagyz","id":12861880,"node_id":"MDQ6VXNlcjEyODYxODgw","avatar_url":"https://avatars.githubusercontent.com/u/12861880?v=4","gravatar_id":"","url":"https://api.github.com/users/boroknagyz","html_url":"https://github.com/boroknagyz","followers_url":"https://api.github.com/users/boroknagyz/followers","following_url":"https://api.github.com/users/boroknagyz/following{/other_user}","gists_url":"https://api.github.com/users/boroknagyz/gists{/gist_id}","starred_url":"https://api.github.com/users/boroknagyz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boroknagyz/subscriptions","organizations_url":"https://api.github.com/users/boroknagyz/orgs","repos_url":"https://api.github.com/users/boroknagyz/repos","events_url":"https://api.github.com/users/boroknagyz/events{/privacy}","received_events_url":"https://api.github.com/users/boroknagyz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-11T21:41:39Z","updated_at":"2020-11-11T21:41:39Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue for your response. Impala already has read support for Iceberg tables (that are stored in HadoopTables or HadoopCatalog). (Btw Impala can already write non-partitioned Iceberg tables).\r\n\r\nImpala uses HMS to store table metadata and uses the InputFormat class of the storage descriptor to determine the table format. So it doesn't use these classes, but only their names to identify the table type.\r\n\r\nCurrently Impala uses class names from Hiveberg to identify Iceberg tables:\r\nhttps://github.com/apache/impala/blob/ea13e744977c71206c11a54f65d77aeecb55703d/fe/src/main/java/org/apache/impala/catalog/HdfsFileFormat.java#L80\r\n\r\nBut there's already an upstream change request to use the new classes from Iceberg:\r\nhttps://gerrit.cloudera.org/#/c/16707/\r\n\r\nI don't think this change would introduce missing classes in Hive because HiveTableOperations already sets org.apache.iceberg.mr.hive.HiveIcebergSerDe which is in the same package.\r\n\r\nI think this change would help interoperability between Impala and Hive as they would create tables the same way, What do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725676838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725679188","html_url":"https://github.com/apache/iceberg/pull/1751#issuecomment-725679188","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1751","id":725679188,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTY3OTE4OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-11T21:47:19Z","updated_at":"2020-11-11T21:47:19Z","author_association":"CONTRIBUTOR","body":"@boroknagyz, sorry for the confusion. I thought that this was setting the formats for the path where the Hive engine is not enabled. Since this is setting only when Hive is enabled, I think it is safe. Thanks for pointing out the SerDe, that's what made me realize the error.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725679188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725679381","html_url":"https://github.com/apache/iceberg/pull/1751#issuecomment-725679381","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1751","id":725679381,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTY3OTM4MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-11T21:47:47Z","updated_at":"2020-11-11T21:47:47Z","author_association":"CONTRIBUTOR","body":"@pvary FYI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725679381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725688314","html_url":"https://github.com/apache/iceberg/pull/1751#issuecomment-725688314","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1751","id":725688314,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTY4ODMxNA==","user":{"login":"boroknagyz","id":12861880,"node_id":"MDQ6VXNlcjEyODYxODgw","avatar_url":"https://avatars.githubusercontent.com/u/12861880?v=4","gravatar_id":"","url":"https://api.github.com/users/boroknagyz","html_url":"https://github.com/boroknagyz","followers_url":"https://api.github.com/users/boroknagyz/followers","following_url":"https://api.github.com/users/boroknagyz/following{/other_user}","gists_url":"https://api.github.com/users/boroknagyz/gists{/gist_id}","starred_url":"https://api.github.com/users/boroknagyz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boroknagyz/subscriptions","organizations_url":"https://api.github.com/users/boroknagyz/orgs","repos_url":"https://api.github.com/users/boroknagyz/repos","events_url":"https://api.github.com/users/boroknagyz/events{/privacy}","received_events_url":"https://api.github.com/users/boroknagyz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-11T22:08:03Z","updated_at":"2020-11-11T22:08:03Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdblue !\r\nBtw when I said Impala \"already supports this and that\", I meant it's on the master branch, but we haven't released anything yet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725688314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725698739","html_url":"https://github.com/apache/iceberg/pull/1747#issuecomment-725698739","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1747","id":725698739,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTY5ODczOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-11T22:34:01Z","updated_at":"2020-11-11T22:34:01Z","author_association":"CONTRIBUTOR","body":"> I was thinking how we should change metrics evaluators when we exclude NaN from upper/lower bounds. Here's a table . . .\r\n\r\nI think we should not produce predicates that use `NaN` as a literal for comparison. We can easily rewrite `equal` and `notEqual` to `isNaN` and `notNaN`. We can also rewrite `in` and `notIn` to `or(in(non-NaNs), isNaN)` or `and(notIn(non-NaNs), isNotNaN)`. Then inequalities would either be converted to `alwaysFalse` or throw an exception because we don't accept the predicate. I'd lean toward throwing an exception if someone uses `floatCol < NaN`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725698739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725785845","html_url":"https://github.com/apache/iceberg/issues/1398#issuecomment-725785845","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1398","id":725785845,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTc4NTg0NQ==","user":{"login":"johnclara","id":9331049,"node_id":"MDQ6VXNlcjkzMzEwNDk=","avatar_url":"https://avatars.githubusercontent.com/u/9331049?v=4","gravatar_id":"","url":"https://api.github.com/users/johnclara","html_url":"https://github.com/johnclara","followers_url":"https://api.github.com/users/johnclara/followers","following_url":"https://api.github.com/users/johnclara/following{/other_user}","gists_url":"https://api.github.com/users/johnclara/gists{/gist_id}","starred_url":"https://api.github.com/users/johnclara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnclara/subscriptions","organizations_url":"https://api.github.com/users/johnclara/orgs","repos_url":"https://api.github.com/users/johnclara/repos","events_url":"https://api.github.com/users/johnclara/events{/privacy}","received_events_url":"https://api.github.com/users/johnclara/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-12T02:22:11Z","updated_at":"2020-11-12T02:22:11Z","author_association":"NONE","body":"Hi @davseitsev, we're also using s3a (version 2.8.4) and I'm wondering if you see this frequently or within a single operation? We're starting to have an issue which we can't identify within a single create() but it sounds like this happens from a create() and then open()?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725785845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725836609","html_url":"https://github.com/apache/iceberg/pull/1747#issuecomment-725836609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1747","id":725836609,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTgzNjYwOQ==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-12T04:55:09Z","updated_at":"2020-11-12T04:55:09Z","author_association":"CONTRIBUTOR","body":"> > I was thinking how we should change metrics evaluators when we exclude NaN from upper/lower bounds. Here's a table . . .\r\n> \r\n> I think we should not produce predicates that use `NaN` as a literal for comparison. We can easily rewrite `equal` and `notEqual` to `isNaN` and `notNaN`. We can also rewrite `in` and `notIn` to `or(in(non-NaNs), isNaN)` or `and(notIn(non-NaNs), isNotNaN)`. Then inequalities would either be converted to `alwaysFalse` or throw an exception because we don't accept the predicate. I'd lean toward throwing an exception if someone uses `floatCol < NaN`.\r\n\r\nThank you for all the comments! I'll update `Expressions` to include rewritings in this PR. \r\n\r\nDo you have comment on the case of \"this may result in v2 returning more files than v1\" when literal is not NaN but the data to be compared have NaN? We might need to accept that to keep behavior of comparing with NaN consistent across different files? \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725836609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725871678","html_url":"https://github.com/apache/iceberg/pull/1751#issuecomment-725871678","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1751","id":725871678,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTg3MTY3OA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-12T06:36:15Z","updated_at":"2020-11-12T06:36:15Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue for the notification! Discussed this with @boroknagyz offline, and this change is fine for the Hive too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725871678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725880612","html_url":"https://github.com/apache/iceberg/issues/1718#issuecomment-725880612","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1718","id":725880612,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTg4MDYxMg==","user":{"login":"qphien","id":17759741,"node_id":"MDQ6VXNlcjE3NzU5NzQx","avatar_url":"https://avatars.githubusercontent.com/u/17759741?v=4","gravatar_id":"","url":"https://api.github.com/users/qphien","html_url":"https://github.com/qphien","followers_url":"https://api.github.com/users/qphien/followers","following_url":"https://api.github.com/users/qphien/following{/other_user}","gists_url":"https://api.github.com/users/qphien/gists{/gist_id}","starred_url":"https://api.github.com/users/qphien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qphien/subscriptions","organizations_url":"https://api.github.com/users/qphien/orgs","repos_url":"https://api.github.com/users/qphien/repos","events_url":"https://api.github.com/users/qphien/events{/privacy}","received_events_url":"https://api.github.com/users/qphien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-12T06:57:10Z","updated_at":"2020-11-12T06:57:10Z","author_association":"CONTRIBUTOR","body":"> Have seen the problem when working on #1612 and fixed it there.\r\n> \r\n> The `/hive/default.db/iceberg_table` does not seem like a valid HadoopCatalog table path, so that too has to be changed to a valid path if I am correct.\r\n\r\nYes, `/hive/default.db/iceberg_table` is not in HadoopCatalog table path format `hadoopCatalogWarehouse/db/table`. #1612 solves location setting problem but we need to set `iceberg.mr.catalog.hadoop.warehouse.location` if table location prefix is inconsistent with `fs.defaultFs/iceberg/warehouse`. Is there any way to skipping setting `iceberg.mr.catalog.hadoop.warehouse.location`?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725880612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725917054","html_url":"https://github.com/apache/iceberg/issues/1750#issuecomment-725917054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1750","id":725917054,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNTkxNzA1NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-12T08:15:45Z","updated_at":"2020-11-12T08:15:45Z","author_association":"CONTRIBUTOR","body":"I usually run `./gradlew :iceberg-bundled-guava:build`, and it will automatically refresh the dependency.\r\nIf not, there is a button to force refresh:\r\n\r\n![Snip20201112_3](https://user-images.githubusercontent.com/29823233/98913354-1dd56100-247c-11eb-988e-756cba9e2d54.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/725917054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726072991","html_url":"https://github.com/apache/iceberg/issues/1756#issuecomment-726072991","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1756","id":726072991,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjA3Mjk5MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-12T13:20:35Z","updated_at":"2020-11-12T13:20:35Z","author_association":"MEMBER","body":"This occurs because of a bad error message in Spark. What it really means\nis that you attempted to read the table using a datasource v1 read path\nwhen the datasource in question is a v2 one. This is occuring because you\nare using the native spark session catalog rather than the iceberg v2\nreplacement session catalog.\n\nSo from here you have a two options I think,\n\nYou can override the session catalog with the iceberg V2 session catalog\nYou can read the table using the v2 path explicitly, spark.read.table()\n\nOn Thu, Nov 12, 2020, 5:47 AM chaiyuan2046 <notifications@github.com> wrote:\n\n> spark : spark-3.0.1-bin-hadoop2.7\n> iceberg : iceberg-spark3-runtime-0.9.1.jar\n>\n> ==============================================\n> *Step one:*\n> bin/spark-sql\n> --conf spark.sql.warehouse.dir=hdfs://xxxx:8020/user/iceberg\n>\n> *Step two:*\n> CREATE TABLE ib_test(id bigint, data string) USING iceberg; --success\n>\n> *Step three:*\n> select * from ib_test; --The error blow happens：\n>\n> Caused by: org.apache.spark.sql.AnalysisException: iceberg is not a valid\n> Spark SQL Data Source.;\n> at\n> org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:421)\n> at\n> org.apache.spark.sql.execution.datasources.FindDataSourceTable.$anonfun$readDataSourceTable$1(DataSourceStrategy.scala:256)\n> at\n> org.sparkproject.guava.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4792)\n> at\n> org.sparkproject.guava.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3599)\n> at\n> org.sparkproject.guava.cache.LocalCache$Segment.loadSync(LocalCache.java:2379)\n> ... 96 more\n>\n> Any ideas for this question？tks\n>\n> —\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/1756>, or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YPBNYRXGD3YDBWJ5PDSPPDM7ANCNFSM4TTFYMWQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726072991/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726124065","html_url":"https://github.com/apache/iceberg/pull/1612#issuecomment-726124065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1612","id":726124065,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjEyNDA2NQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-12T14:48:48Z","updated_at":"2020-11-12T14:48:48Z","author_association":"CONTRIBUTOR","body":"@rdblue: The tests added by @lcspinter in #1740 highlighted issues with the timestamp handling.\r\nEnded up with the following solution:\r\n- Hive2 - we have only TIMESTAMP in Hive, so both Iceberg Timestamps (with and without TZ) is converted to Hive TIMESTAMP\r\n- Hive3 - we have TIMESTAMP and TIMESTAMP WITH LOCAL TIMEZONE, so Iceberg Timestamp without TZ is converted to Hive TIMESTAMP, and Iceberg Timestamp with TZ is converted to TIMESTAMP WITH LOCAL TIMEZONE.\r\n\r\nI was thinking about separating schema creation and the Timestamp fix (since there are only related because the additional check I have added for table creation), but my first attempt ended up in a mess of half fixed test and such.\r\nCould you review the patch as it is, or I should spend some more cycles to separate them?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726124065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726296302","html_url":"https://github.com/apache/iceberg/pull/1641#issuecomment-726296302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1641","id":726296302,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjI5NjMwMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-12T19:36:03Z","updated_at":"2020-11-12T19:36:03Z","author_association":"CONTRIBUTOR","body":"Thanks for the update, @yyanyy! I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726296302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726297612","html_url":"https://github.com/apache/iceberg/pull/1747#issuecomment-726297612","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1747","id":726297612,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjI5NzYxMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-12T19:38:35Z","updated_at":"2020-11-12T19:38:35Z","author_association":"CONTRIBUTOR","body":"> Do you have comment on the case of \"this may result in v2 returning more files than v1\" when literal is not NaN but the data to be compared have NaN? We might need to accept that to keep behavior of comparing with NaN consistent across different files?\r\n\r\nI don't think this is a v2 problem, it is a bug in how we currently handle NaN right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726297612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726450435","html_url":"https://github.com/apache/iceberg/pull/1760#issuecomment-726450435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1760","id":726450435,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjQ1MDQzNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T01:35:12Z","updated_at":"2020-11-13T01:35:12Z","author_association":"CONTRIBUTOR","body":"Thanks, I'll merge this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726450435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726652886","html_url":"https://github.com/apache/iceberg/pull/1663#issuecomment-726652886","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1663","id":726652886,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjY1Mjg4Ng==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T09:25:39Z","updated_at":"2020-11-13T09:25:39Z","author_association":"MEMBER","body":"@rdblue  Could you pls take a look this prototype if you have time, I want to make sure that our understanding about this design is roughly the same (After that I would love to divide this big patch into several small patches for reviewing).  Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726652886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726724055","html_url":"https://github.com/apache/iceberg/pull/1748#issuecomment-726724055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1748","id":726724055,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjcyNDA1NQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T11:55:04Z","updated_at":"2020-11-13T11:55:04Z","author_association":"CONTRIBUTOR","body":"@massdosage: I try to answer all of the open questions - might miss some, so please feel free to point them out.\r\n\r\n- The property `iceberg.engine.hive.enabled`/`engine.hive.enabled` only controls how the HMS metadata values are set (InputFormat/OutputFormat/SerDe/StorageHandler)\r\n- There are different DDLs for different catalogs, these should work since they are tested with the unit tests as well\r\n```\r\n-- empty iceberg.mr.catalog means HadoopTables\r\n\r\n-- new table Hive + Iceberg\r\nCREATE EXTERNAL TABLE customers \r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\nLOCATION '<LOCATION>'\r\nTBLPROPERTIES ('iceberg.mr.table.schema'='<SCHEMA_JSON>', 'iceberg.mr.table.partition.spec'='<PART_SPEC_JSON>');\r\n\r\n-- new Hive table above existing Iceberg table\r\nCREATE EXTERNAL TABLE customers \r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\nLOCATION '<LOCATION>';\r\n\r\n-- HadoopCatalog (same as HadoopTables)\r\nset iceberg.mr.catalog=hadoop;\r\n\r\n-- new table Hive + Iceberg\r\nCREATE EXTERNAL TABLE customers \r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\nLOCATION '<LOCATION>'\r\nTBLPROPERTIES ('iceberg.mr.table.schema'='<SCHEMA_JSON>', 'iceberg.mr.table.partition.spec'='<PART_SPEC_JSON>');\r\n\r\n-- new Hive table above existing Iceberg table\r\nCREATE EXTERNAL TABLE customers \r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\nLOCATION '<LOCATION>';\r\n\r\n-- HiveCatalog\r\nset iceberg.mr.catalog=hive;\r\n\r\n-- new table Hive + Iceberg\r\nCREATE EXTERNAL TABLE customers \r\nSTORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\nTBLPROPERTIES ('iceberg.mr.table.schema'='<SCHEMA_JSON>', 'iceberg.mr.table.partition.spec'='<PART_SPEC_JSON>');\r\n\r\n-- new Hive table above existing Iceberg table is an invalid case\r\n```\r\n- You might provide the Schema json when creating the table, but the property should not be present on the created HMS table.\r\n- You said that you have problem selecting data from the tables. What is the exact Exception?\r\n\r\nThanks, and sorry for chiming in late 😢 \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726724055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726755678","html_url":"https://github.com/apache/iceberg/issues/1750#issuecomment-726755678","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1750","id":726755678,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjc1NTY3OA==","user":{"login":"zanmeipaul","id":20592867,"node_id":"MDQ6VXNlcjIwNTkyODY3","avatar_url":"https://avatars.githubusercontent.com/u/20592867?v=4","gravatar_id":"","url":"https://api.github.com/users/zanmeipaul","html_url":"https://github.com/zanmeipaul","followers_url":"https://api.github.com/users/zanmeipaul/followers","following_url":"https://api.github.com/users/zanmeipaul/following{/other_user}","gists_url":"https://api.github.com/users/zanmeipaul/gists{/gist_id}","starred_url":"https://api.github.com/users/zanmeipaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zanmeipaul/subscriptions","organizations_url":"https://api.github.com/users/zanmeipaul/orgs","repos_url":"https://api.github.com/users/zanmeipaul/repos","events_url":"https://api.github.com/users/zanmeipaul/events{/privacy}","received_events_url":"https://api.github.com/users/zanmeipaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T13:09:29Z","updated_at":"2020-11-13T13:09:29Z","author_association":"NONE","body":"hi @RussellSpitzer  @jackye1995 , Thank you for your answer. I guess it's my question about using eclipse","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726755678/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726897151","html_url":"https://github.com/apache/iceberg/issues/1763#issuecomment-726897151","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1763","id":726897151,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjg5NzE1MQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T17:29:59Z","updated_at":"2020-11-13T17:29:59Z","author_association":"CONTRIBUTOR","body":"I have an initial implementation the I can post today to discuss as a starting point.  I believe it covers most of the features, but I think there are still a number of open questions about the implementation.\r\n\r\nI'll try to get it into a reasonable state so that you can take a look and then we can iterate on addressing any outstanding implementation details.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726897151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726911715","html_url":"https://github.com/apache/iceberg/issues/1763#issuecomment-726911715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1763","id":726911715,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjkxMTcxNQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T17:45:48Z","updated_at":"2020-11-13T17:45:48Z","author_association":"CONTRIBUTOR","body":"> I have an initial implementation the I can post today to discuss as a starting point. I believe it covers most of the features, but I think there are still a number of open questions about the implementation.\r\n> \r\n> I'll try to get it into a reasonable state so that you can take a look and then we can iterate on addressing any outstanding implementation details.\r\n\r\nSounds good!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726911715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726927551","html_url":"https://github.com/apache/iceberg/issues/1766#issuecomment-726927551","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1766","id":726927551,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjkyNzU1MQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T18:06:54Z","updated_at":"2020-11-13T18:06:54Z","author_association":"CONTRIBUTOR","body":"Hi this is Jack from AWS Athena. Currently we do not have support for this. We are in the progress of adding support, but we have to wait until this Glue catalog is officially released in Iceberg, which will most likely happen in 0.11.0. Before this happens, you can use EMR (version >= 6.0.0) to create Spark 3 cluster and run all the Iceberg queries through that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726927551/reactions","total_count":7,"+1":7,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726944945","html_url":"https://github.com/apache/iceberg/pull/1767#issuecomment-726944945","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1767","id":726944945,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjk0NDk0NQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T18:25:23Z","updated_at":"2020-11-13T18:25:23Z","author_association":"CONTRIBUTOR","body":"@jackye1995 it would be great to get your thoughts on this approach.  Still needs some work and lots more testing.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726944945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726956666","html_url":"https://github.com/apache/iceberg/pull/1663#issuecomment-726956666","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1663","id":726956666,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjk1NjY2Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T18:38:43Z","updated_at":"2020-11-13T18:38:43Z","author_association":"CONTRIBUTOR","body":"Yes, will do. I meant to get to it yesterday, but I ran out of time. Thanks for your patience.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726956666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726986190","html_url":"https://github.com/apache/iceberg/issues/1766#issuecomment-726986190","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1766","id":726986190,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjk4NjE5MA==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T19:20:49Z","updated_at":"2020-11-13T19:20:49Z","author_association":"CONTRIBUTOR","body":"thank you @jackye1995","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726986190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726989256","html_url":"https://github.com/apache/iceberg/issues/1592#issuecomment-726989256","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1592","id":726989256,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjk4OTI1Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T19:28:16Z","updated_at":"2020-11-13T19:28:16Z","author_association":"CONTRIBUTOR","body":"Done in #1759.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/726989256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727026582","html_url":"https://github.com/apache/iceberg/pull/1771#issuecomment-727026582","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1771","id":727026582,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzAyNjU4Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T20:56:27Z","updated_at":"2020-11-13T20:56:27Z","author_association":"CONTRIBUTOR","body":"I don't think the test failure is related to the PR.\r\n\r\n```\r\norg.apache.iceberg.mr.hive.TestHiveIcebergStorageHandlerWithCustomCatalog > testJoinTablesSupportedTypes[fileFormat=PARQUET, engine=tez] FAILED\r\n    java.lang.IllegalArgumentException: Failed to execute Hive query 'select s.boolean_column, h.boolean_column from default.boolean_table_0 s join default.boolean_table_0 h on h.boolean_column=s.boolean_column': Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.tez.TezTask\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727026582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727081609","html_url":"https://github.com/apache/iceberg/pull/1473#issuecomment-727081609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1473","id":727081609,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzA4MTYwOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T23:21:20Z","updated_at":"2020-11-13T23:21:20Z","author_association":"CONTRIBUTOR","body":"I am going to close this one as the work has been split into smaller PRs and being merged into master.\r\n\r\n@liukun4515, could you submit your PRs against master? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727081609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727089389","html_url":"https://github.com/apache/iceberg/pull/1771#issuecomment-727089389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1771","id":727089389,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzA4OTM4OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-13T23:53:48Z","updated_at":"2020-11-13T23:53:48Z","author_association":"CONTRIBUTOR","body":"I agree, the Hive failure looks unrelated. (@marton-bod or @pvary may be able to help there)\r\n\r\nSince Java 11 checks are passing, I'm okay merging this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727089389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727097712","html_url":"https://github.com/apache/iceberg/pull/1742#issuecomment-727097712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1742","id":727097712,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzA5NzcxMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-14T00:23:11Z","updated_at":"2020-11-14T00:23:11Z","author_association":"CONTRIBUTOR","body":"Could you resolve the conflicts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727097712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727123273","html_url":"https://github.com/apache/iceberg/pull/1773#issuecomment-727123273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1773","id":727123273,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzEyMzI3Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-14T02:24:06Z","updated_at":"2020-11-14T02:24:06Z","author_association":"CONTRIBUTOR","body":"@rdblue, an alternative to introducing different classes for each write type, we may just keep one writer but introduce a commit function that may be configured.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727123273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727523054","html_url":"https://github.com/apache/iceberg/issues/1746#issuecomment-727523054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1746","id":727523054,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzUyMzA1NA==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-15T06:28:13Z","updated_at":"2020-11-15T06:30:20Z","author_association":"CONTRIBUTOR","body":"hi @HeartSaVioR  This the [PR](https://github.com/apache/iceberg/pull/1774), When you have time, please help me see this PR implementation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727523054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727594475","html_url":"https://github.com/apache/iceberg/pull/1774#issuecomment-727594475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1774","id":727594475,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzU5NDQ3NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-15T16:11:05Z","updated_at":"2020-11-15T16:11:05Z","author_association":"MEMBER","body":"Wouldn't we need to also eliminate the pre-sorting from the Spark write to benefit from this? As is all the rows that go into Partitioned writer are assumed to be pre grouped already so a fan out wouldn't really help. Maybe I'm missing something","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727594475/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727711959","html_url":"https://github.com/apache/iceberg/pull/1473#issuecomment-727711959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1473","id":727711959,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzcxMTk1OQ==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T03:22:53Z","updated_at":"2020-11-16T03:22:53Z","author_association":"NONE","body":"> I am going to close this one as the work has been split into smaller PRs and being merged into master.\r\n> \r\n> @liukun4515, could you submit your PRs against master? Thanks!\r\n\r\nok, after the extension framework merged into master, i will submit my pr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727711959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727734721","html_url":"https://github.com/apache/iceberg/pull/1774#issuecomment-727734721","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1774","id":727734721,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzczNDcyMQ==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T04:59:42Z","updated_at":"2020-11-16T16:05:50Z","author_association":"CONTRIBUTOR","body":"Seems like this provides the ability to write out non grouped records, won't this create too many possibly small files? What use-cases you have in mind for this @XuQianJin-Stars ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727734721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727821855","html_url":"https://github.com/apache/iceberg/pull/1607#issuecomment-727821855","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1607","id":727821855,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzgyMTg1NQ==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T08:30:23Z","updated_at":"2020-11-16T08:30:23Z","author_association":"CONTRIBUTOR","body":"@rdblue Could you please review my change? Thank you","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727821855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727846929","html_url":"https://github.com/apache/iceberg/pull/1774#issuecomment-727846929","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1774","id":727846929,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzg0NjkyOQ==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T09:15:45Z","updated_at":"2020-11-16T09:15:45Z","author_association":"CONTRIBUTOR","body":"> Seems like this provides the ability to write out non grouped records, won't this create too many possibly small? files? What use-cases you have in mind for this @XuQianJin-Stars ?\r\n\r\nhi @rdsr @RussellSpitzer Thanks for the reminder, I will take a closer look at this piece.  I only started learning iceberg not long ago. Hope you have more comments to discuss with me. Thanks again.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727846929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727875684","html_url":"https://github.com/apache/iceberg/pull/1612#issuecomment-727875684","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1612","id":727875684,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzg3NTY4NA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T10:06:12Z","updated_at":"2020-11-16T10:06:12Z","author_association":"CONTRIBUTOR","body":"@rdblue: Quick question: You simply just did not have time to review this last iteration, or you do not agree with my future plans with uncoupling Iceberg and Hive schema, and would like us to stick to throwing exception when Hive schema is provided and we already have an Iceberg schema too?\r\n\r\nIf it is just timing issue do you have any idea who would be also interested in Hive integration who is already a committer? Maybe @aokolnychyi?\r\n\r\nBig thanks for all your effort you already put into the Hive integration and helped us moving forward with it!\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727875684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727887896","html_url":"https://github.com/apache/iceberg/pull/1771#issuecomment-727887896","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1771","id":727887896,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzg4Nzg5Ng==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T10:27:06Z","updated_at":"2020-11-16T10:27:06Z","author_association":"CONTRIBUTOR","body":"> I agree, the Hive failure looks unrelated. (@marton-bod or @pvary may be able to help there)\r\n\r\nTrying to repro the case (without success so far 😢)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727887896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727906662","html_url":"https://github.com/apache/iceberg/pull/1720#issuecomment-727906662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1720","id":727906662,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzkwNjY2Mg==","user":{"login":"skambha","id":16563220,"node_id":"MDQ6VXNlcjE2NTYzMjIw","avatar_url":"https://avatars.githubusercontent.com/u/16563220?v=4","gravatar_id":"","url":"https://api.github.com/users/skambha","html_url":"https://github.com/skambha","followers_url":"https://api.github.com/users/skambha/followers","following_url":"https://api.github.com/users/skambha/following{/other_user}","gists_url":"https://api.github.com/users/skambha/gists{/gist_id}","starred_url":"https://api.github.com/users/skambha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skambha/subscriptions","organizations_url":"https://api.github.com/users/skambha/orgs","repos_url":"https://api.github.com/users/skambha/repos","events_url":"https://api.github.com/users/skambha/events{/privacy}","received_events_url":"https://api.github.com/users/skambha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T11:02:06Z","updated_at":"2020-11-16T11:02:06Z","author_association":"CONTRIBUTOR","body":"cc @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727906662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727933654","html_url":"https://github.com/apache/iceberg/pull/1774#issuecomment-727933654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1774","id":727933654,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzkzMzY1NA==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T11:57:47Z","updated_at":"2020-11-16T11:57:47Z","author_association":"CONTRIBUTOR","body":"> Seems like this provides the ability to write out non grouped records, won't this create too many possibly small? files? What use-cases you have in mind for this @XuQianJin-Stars ?\r\n\r\n\r\n\r\n> Seems like this provides the ability to write out non grouped records, won't this create too many possibly small? files? What use-cases you have in mind for this @XuQianJin-Stars ?\r\n\r\nwell, I can add corresponding unit tests in `TestRewriteDataFilesAction`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727933654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727955138","html_url":"https://github.com/apache/iceberg/pull/1748#issuecomment-727955138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1748","id":727955138,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzk1NTEzOA==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T12:43:45Z","updated_at":"2020-11-16T12:43:45Z","author_association":"CONTRIBUTOR","body":"@pvary thanks for the above. For now my focus is getting a new HiveCatalog table created in such a way that it can be queried. I'll try some variation of what you suggest above with various Hive configuration settings and table properties and see if I can get it working - if so I'll update the steps in this document so you and others can confirm if that's correct, if not I'll add the exceptions I'm seeing here and we can discuss.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727955138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727961161","html_url":"https://github.com/apache/iceberg/pull/1774#issuecomment-727961161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1774","id":727961161,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNzk2MTE2MQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T12:55:50Z","updated_at":"2020-11-16T12:55:50Z","author_association":"COLLABORATOR","body":"I think we could use the fanout writer for streaming write case which may be hard to group due to latency requirement. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/727961161/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728182887","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-728182887","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":728182887,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODE4Mjg4Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T16:45:53Z","updated_at":"2020-11-16T16:45:53Z","author_association":"CONTRIBUTOR","body":"Let me take a look today. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728182887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728256206","html_url":"https://github.com/apache/iceberg/pull/1774#issuecomment-728256206","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1774","id":728256206,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODI1NjIwNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T18:52:23Z","updated_at":"2020-11-16T18:52:23Z","author_association":"CONTRIBUTOR","body":"If this is not the default and there is a way to turn it on, I could see some value to this. And we may need to use it by default for streaming. This just uses higher memory consumption to avoid needing to cluster rows by partition in tasks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728256206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728256911","html_url":"https://github.com/apache/iceberg/pull/1772#issuecomment-728256911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1772","id":728256911,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODI1NjkxMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T18:53:39Z","updated_at":"2020-11-16T18:53:39Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nThanks @aokolnychyi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728256911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728258481","html_url":"https://github.com/apache/iceberg/pull/1742#issuecomment-728258481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1742","id":728258481,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODI1ODQ4MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T18:56:42Z","updated_at":"2020-11-16T18:56:42Z","author_association":"CONTRIBUTOR","body":"The merge looked simple enough to do here, so I went ahead and committed it. We'll see if tests pass and I can merge to master after that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728258481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728318340","html_url":"https://github.com/apache/iceberg/pull/1742#issuecomment-728318340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1742","id":728318340,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODMxODM0MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T20:43:53Z","updated_at":"2020-11-16T20:43:53Z","author_association":"CONTRIBUTOR","body":"Everything looks good after resolving the conflicts, so I merged this. Thanks @marton-bod!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728318340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728334523","html_url":"https://github.com/apache/iceberg/pull/1754#issuecomment-728334523","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1754","id":728334523,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODMzNDUyMw==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T21:17:08Z","updated_at":"2020-11-16T21:17:08Z","author_association":"CONTRIBUTOR","body":"@jackye1995 Thanks a lot for this!  +1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728334523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728356450","html_url":"https://github.com/apache/iceberg/pull/1767#issuecomment-728356450","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1767","id":728356450,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODM1NjQ1MA==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T22:04:24Z","updated_at":"2020-11-16T22:04:24Z","author_association":"CONTRIBUTOR","body":"@jackye1995 I've moved this PR to draft for now.  I rebased on top of your changes in #1754, but it's somewhat complicated due to the fact that now we have 3 separate requests (create multipart, upload part, put object) that all require setting the properties, but they don't inherit from a common interface.  I feel like reflection is probably the best way do simplify this, but I'll push the current state of things.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728356450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728373528","html_url":"https://github.com/apache/iceberg/pull/1773#issuecomment-728373528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1773","id":728373528,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODM3MzUyOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T22:40:34Z","updated_at":"2020-11-16T22:40:34Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer, I gave the inner class approach a try and it seems to remove the need for a write context. I've submitted #1776 so that you can compare.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728373528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728378817","html_url":"https://github.com/apache/iceberg/issues/1775#issuecomment-728378817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1775","id":728378817,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODM3ODgxNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T22:53:42Z","updated_at":"2020-11-16T22:53:42Z","author_association":"CONTRIBUTOR","body":"@rdblue was kind enough to look into the docs for 0.10.0. I am holding the announcement email till then.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728378817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728388736","html_url":"https://github.com/apache/iceberg/pull/1525#issuecomment-728388736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1525","id":728388736,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODM4ODczNg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-16T23:19:51Z","updated_at":"2020-11-16T23:19:51Z","author_association":"MEMBER","body":"@rdblue + @aokolnychyi  ready for another look when you have a minute","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728388736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728460151","html_url":"https://github.com/apache/iceberg/pull/1777#issuecomment-728460151","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1777","id":728460151,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODQ2MDE1MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T00:04:47Z","updated_at":"2020-11-17T00:04:47Z","author_association":"CONTRIBUTOR","body":"Merging without full testing because this doesn't touch the code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728460151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728475624","html_url":"https://github.com/apache/iceberg/pull/1776#issuecomment-728475624","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1776","id":728475624,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODQ3NTYyNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T00:14:13Z","updated_at":"2020-11-17T00:14:13Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nI think this is much better and I like that it removes the separate subclass for streaming.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728475624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728476534","html_url":"https://github.com/apache/iceberg/pull/1773#issuecomment-728476534","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1773","id":728476534,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODQ3NjUzNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T00:14:47Z","updated_at":"2020-11-17T00:14:47Z","author_association":"CONTRIBUTOR","body":"I prefer the implementation in #1776.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728476534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728479031","html_url":"https://github.com/apache/iceberg/issues/1775#issuecomment-728479031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1775","id":728479031,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODQ3OTAzMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T00:16:19Z","updated_at":"2020-11-17T00:16:19Z","author_association":"CONTRIBUTOR","body":"#1777 includes the update.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728479031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728636494","html_url":"https://github.com/apache/iceberg/pull/1774#issuecomment-728636494","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1774","id":728636494,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODYzNjQ5NA==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T02:00:39Z","updated_at":"2020-11-17T02:00:39Z","author_association":"CONTRIBUTOR","body":"> If this is not the default and there is a way to turn it on, I could see some value to this. And we may need to use it by default for streaming. This just uses higher memory consumption to avoid needing to cluster rows by partition in tasks.\r\n\r\nUser can turn it on according to the parameter `PARTITIONED_FANOUT_WRITER= true` in the setting table. The default is false.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728636494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728685851","html_url":"https://github.com/apache/iceberg/pull/1773#issuecomment-728685851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1773","id":728685851,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODY4NTg1MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T04:56:44Z","updated_at":"2020-11-17T04:56:44Z","author_association":"CONTRIBUTOR","body":"Closing this in favor of #1776.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728685851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728724401","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-728724401","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":728724401,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODcyNDQwMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T06:46:46Z","updated_at":"2020-11-17T06:46:46Z","author_association":"CONTRIBUTOR","body":"I took a look at the PR and have an idea. Let me try it tomorrow morning and I'll report back here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728724401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728736862","html_url":"https://github.com/apache/iceberg/pull/1774#issuecomment-728736862","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1774","id":728736862,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODczNjg2Mg==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T07:16:11Z","updated_at":"2020-11-17T07:16:11Z","author_association":"CONTRIBUTOR","body":"OK now I understand what \"fanout\" meant. Didn't know about Flink implementation. Thanks.\r\n\r\nI see the concern of the overall number of output files, but if I understand correctly, using fanout writer would produce the same number of output files - this just eliminates the necessity of \"local sort\" at the cost of multiple files opening together for write. For the best result of number of output files, we still need to repartition based on partition, regardless of using fanout writer.\r\n\r\nAnother question is, is it better to have the flag on table properties, or have the option on Spark Iceberg sink? The actual concern would be predicting how many files need to be opened together for write. This would be highly depending on the cardinality of partitions for the output, which might depend on the characteristic of the outputs, but might be also \"query dependent\" like we consider about batch vs streaming. I'm not maintaining the Iceberg table in production scale so can't say. Probably @aokolnychyi would have some insight on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728736862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728756278","html_url":"https://github.com/apache/iceberg/pull/1762#issuecomment-728756278","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1762","id":728756278,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODc1NjI3OA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T08:02:13Z","updated_at":"2020-11-17T08:02:13Z","author_association":"CONTRIBUTOR","body":"Probably better to use the word `exclude`, as `remove` may confuse to delete file which we just don't account for rewriting.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728756278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728759807","html_url":"https://github.com/apache/iceberg/issues/1699#issuecomment-728759807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1699","id":728759807,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODc1OTgwNw==","user":{"login":"qphien","id":17759741,"node_id":"MDQ6VXNlcjE3NzU5NzQx","avatar_url":"https://avatars.githubusercontent.com/u/17759741?v=4","gravatar_id":"","url":"https://api.github.com/users/qphien","html_url":"https://github.com/qphien","followers_url":"https://api.github.com/users/qphien/followers","following_url":"https://api.github.com/users/qphien/following{/other_user}","gists_url":"https://api.github.com/users/qphien/gists{/gist_id}","starred_url":"https://api.github.com/users/qphien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qphien/subscriptions","organizations_url":"https://api.github.com/users/qphien/orgs","repos_url":"https://api.github.com/users/qphien/repos","events_url":"https://api.github.com/users/qphien/events{/privacy}","received_events_url":"https://api.github.com/users/qphien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T08:09:27Z","updated_at":"2020-11-17T08:09:27Z","author_association":"CONTRIBUTOR","body":"This issuse has been fixed by #1742. Close this issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728759807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728764271","html_url":"https://github.com/apache/iceberg/pull/1762#issuecomment-728764271","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1762","id":728764271,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODc2NDI3MQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T08:14:13Z","updated_at":"2020-11-17T08:14:13Z","author_association":"CONTRIBUTOR","body":"> Probably better to use the word `exclude`, as `remove` may confuse to delete file which we just don't account for rewriting.\r\n\r\nyes,I update it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728764271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728894686","html_url":"https://github.com/apache/iceberg/pull/1742#issuecomment-728894686","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1742","id":728894686,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODg5NDY4Ng==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T12:28:08Z","updated_at":"2020-11-17T12:28:08Z","author_association":"COLLABORATOR","body":"@rdblue \r\nThanks Ryan! I'm on PTO right now that's why I couldn't get to the conflict resolution. Appreciate your help and the merge :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/728894686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729076530","html_url":"https://github.com/apache/iceberg/pull/1742#issuecomment-729076530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1742","id":729076530,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTA3NjUzMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T17:19:13Z","updated_at":"2020-11-17T17:19:13Z","author_association":"CONTRIBUTOR","body":"No problem, enjoy your time off!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729076530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729118553","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-729118553","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":729118553,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTExODU1Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T18:29:39Z","updated_at":"2020-11-17T18:29:39Z","author_association":"CONTRIBUTOR","body":"I missed the recent changes in the Actions API. I think building a hierarchy of classes to share across query engines (with engine-specific code) using single class inheritance in Java is going to be hard. I think Russell has already faced this problem in this PR and I faced it too while suggesting another way to fix it. \r\n\r\nI'd propose to share only Action interfaces between different query engines and build utility classes for common logic. That way, we have more flexibility. Right now, only certain actions in Spark extend `BaseSparkAction` which makes it hard to put common Spark logic there. Moreover, if an action extends `BaseSnapshotUpdateAction`, there is no way it can extend `BaseSparkAction`.\r\n\r\nHere is the [commit](https://github.com/aokolnychyi/incubator-iceberg/commit/f907123374f7851aeb16821fb243befe9ca9866e) with the idea in which direction this PR should go. However, we need to rework the hierarchy before that.\r\n\r\n@RussellSpitzer @openinx @zhangjun0x01 @rdblue, what are your thoughts on this? Do you think it is reasonable to share only interfaces for actions and build utility classes in core for rest?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729118553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729136598","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-729136598","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":729136598,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTEzNjU5OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T19:02:50Z","updated_at":"2020-11-17T19:02:50Z","author_association":"MEMBER","body":"I think a hierarchy in which Flink and spark actions have their own base classes makes more sense than our current situation where all Framework specific classes. Perhaps having common code in utility classes or as interfaces with default methods.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729136598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729148445","html_url":"https://github.com/apache/iceberg/issues/1779#issuecomment-729148445","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1779","id":729148445,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTE0ODQ0NQ==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T19:23:45Z","updated_at":"2020-11-17T19:23:45Z","author_association":"CONTRIBUTOR","body":"@rdblue , @aokolnychyi : can you move this to the appropriate milestone.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729148445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729205052","html_url":"https://github.com/apache/iceberg/issues/1654#issuecomment-729205052","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1654","id":729205052,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTIwNTA1Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T20:48:23Z","updated_at":"2020-11-17T20:48:23Z","author_association":"CONTRIBUTOR","body":"@mickjermsurawong-stripe, what does the Iceberg patch look like?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729205052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729232208","html_url":"https://github.com/apache/iceberg/issues/1654#issuecomment-729232208","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1654","id":729232208,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTIzMjIwOA==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T21:44:07Z","updated_at":"2020-11-17T21:44:07Z","author_association":"CONTRIBUTOR","body":"Hi ryan, it's really not a great patch we made. From the original static method [`openReader`](https://github.com/apache/avro/blob/master/lang/java/avro/src/main/java/org/apache/avro/file/DataFileReader.java#L54) which originally does two things:\r\n- header checking (where the bug is)\r\n- using public constructors for corresponding avro versions found\r\n\r\nWe simply change any invocation in Iceberg for `DataFileReader.openReader` to our new class `AvroPatch2944DataFileReader.openReader` \r\n```\r\npublic class AvroPatch2944DataFileReader {\r\n  public static <D> FileReader<D> openReader(SeekableInput in, DatumReader<D> reader) throws IOException {\r\n      // read header with corrected pointer\r\n      // instantiate DataFileReader\r\n  }\r\n}\r\n```\r\n\r\nThe alternative is to simply skip checking header. Since the avro files read here is always written by the Iceberg framework, i think it is safe to simply call constructor of the file reader for new version (instead of 1.2). I'd prefer this for upstream Iceberg.\r\n\r\nFor our internal fork, we don't want to make the same assumption, so we took a more conservative approach, maintaining the same logic with re-implementation ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729232208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729276407","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-729276407","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":729276407,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTI3NjQwNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T23:30:16Z","updated_at":"2020-11-17T23:30:16Z","author_association":"CONTRIBUTOR","body":"After thinking more about this, I tend to agree with Russell that we should limit this PR to fixing the catalog-based tables. That way, we unblock stored procedures and other items. We can change the way we structure actions in a follow-up PR but we better do it quickly until we diverged too much.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729276407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729279109","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-729279109","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":729279109,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTI3OTEwOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T23:38:14Z","updated_at":"2020-11-17T23:38:14Z","author_association":"CONTRIBUTOR","body":"This PR looks good to me in terms of logic but we should change the approach in the future. I don't see how to do that without changes to the Actions API. I'll be okay to merge it to unblock others. \r\n\r\n@rdblue @RussellSpitzer @openinx, thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729279109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729280152","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-729280152","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":729280152,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTI4MDE1Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-17T23:41:36Z","updated_at":"2020-11-17T23:41:36Z","author_association":"CONTRIBUTOR","body":"If this unblocks you, go for it. I can take a closer look later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729280152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729315067","html_url":"https://github.com/apache/iceberg/issues/1617#issuecomment-729315067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1617","id":729315067,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTMxNTA2Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T01:23:04Z","updated_at":"2020-11-18T01:23:04Z","author_association":"CONTRIBUTOR","body":"I don't think it is a good idea in general to use relative paths. We recently had an issue where using a `hdfs` location without authority caused a user's data to be deleted by the `RemoveOrphanFiles` action because the resolution of the table root changed. The main problem is that places in Iceberg would need to have some idea of \"equivalent\" paths and path resolution. Full URIs are much easier to work with and more reliable.\r\n\r\nBut there is still a way to do both. Catalogs and tables can inject their own `FileIO` implementation, which is what is used to open files. That can do any resolution that you want based on environment. So you could use an implementation that allows you to override a portion of the file URI and read it from a different underlying location. I think that works better overall because there are no mistakes about equivalent URIs, but you can still read a table copy without rewriting the metadata.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729315067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729333370","html_url":"https://github.com/apache/iceberg/pull/1633#issuecomment-729333370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1633","id":729333370,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTMzMzM3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T02:21:04Z","updated_at":"2020-11-18T02:21:04Z","author_association":"CONTRIBUTOR","body":"Thanks @jackye1995! I think this is looking close. I had a few comments on the implementation in `GlueTableOperations` that I think should be considered.\r\n\r\nAlso, what is the plan for running the integration tests for this? I'm assuming that they pass when configured correctly. How can I run them and do you think we can make them part of CI?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729333370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729402986","html_url":"https://github.com/apache/iceberg/pull/1778#issuecomment-729402986","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1778","id":729402986,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTQwMjk4Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T04:44:56Z","updated_at":"2020-11-18T04:45:59Z","author_association":"CONTRIBUTOR","body":"What is the use case of enabling/disabling vectorization per session? Do you guys find that useful internally?\r\n\r\nIf we decide to have session configs, should we have a proper place for them like our own SQL config?\r\n\r\nShall we be using `SessionConfigSupport` in Spark for this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729402986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729660164","html_url":"https://github.com/apache/iceberg/pull/1781#issuecomment-729660164","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1781","id":729660164,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTY2MDE2NA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T12:58:12Z","updated_at":"2020-11-18T12:58:12Z","author_association":"CONTRIBUTOR","body":"+1 (non-binding)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729660164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729690343","html_url":"https://github.com/apache/iceberg/pull/1587#issuecomment-729690343","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1587","id":729690343,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTY5MDM0Mw==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T13:52:46Z","updated_at":"2020-11-18T13:52:46Z","author_association":"CONTRIBUTOR","body":"Hey @rdblue, responded to some of your comments. Just a few more things to sort out now :-)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729690343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729729304","html_url":"https://github.com/apache/iceberg/pull/1417#issuecomment-729729304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1417","id":729729304,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTcyOTMwNA==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T14:50:21Z","updated_at":"2020-11-18T14:50:21Z","author_association":"COLLABORATOR","body":"Ok, so here's a quick summary: MR was relatively simpler to fix, while Tez needs an upstream fix ([TEZ-4248](https://issues.apache.org/jira/browse/TEZ-4248)) to work when vectorization is enabled. Temporarily for now, vectorized Tez executions have been disabled, and once TEZ-4248 has shipped in the next 0.9.3 release, we can upgrade to that version and remove the assertion.\r\n\r\n@rdblue @guilload @pvary can you take another look please? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729729304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729791571","html_url":"https://github.com/apache/iceberg/pull/1612#issuecomment-729791571","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1612","id":729791571,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTc5MTU3MQ==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T16:23:45Z","updated_at":"2020-11-18T16:23:45Z","author_association":"COLLABORATOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729791571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729831234","html_url":"https://github.com/apache/iceberg/pull/1587#issuecomment-729831234","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1587","id":729831234,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTgzMTIzNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T17:27:04Z","updated_at":"2020-11-18T17:27:04Z","author_association":"CONTRIBUTOR","body":"I'll take another look. Thanks for the updates!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729831234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729845204","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-729845204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":729845204,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTg0NTIwNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T17:45:21Z","updated_at":"2020-11-18T17:45:21Z","author_association":"CONTRIBUTOR","body":"The test failure seems to be related to Hive. @RussellSpitzer, could you please add `MetadataTableType` to the list of allowed static imports in our `checkstyle.xml`? We have quite a few Iceberg classes there already.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729845204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729890362","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-729890362","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":729890362,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTg5MDM2Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T19:03:48Z","updated_at":"2020-11-18T19:03:48Z","author_association":"MEMBER","body":"@aokolnychyi All fixed up, also the test failure has magically gone away.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729890362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729900080","html_url":"https://github.com/apache/iceberg/pull/1783#issuecomment-729900080","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1783","id":729900080,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTkwMDA4MA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T19:22:18Z","updated_at":"2020-11-18T19:22:18Z","author_association":"CONTRIBUTOR","body":"Why not do something like the following, which can make the whole thing more backwards compatible:\r\n\r\n```java\r\ndf.write.format(\"iceberg\")\r\n  .mode(\"append\")\r\n  .option(\"catalog-impl\", \"com.my.own.CatalogImpl\")\r\n  .save(\"testing.foo\")\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729900080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729936881","html_url":"https://github.com/apache/iceberg/pull/1784#issuecomment-729936881","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1784","id":729936881,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTkzNjg4MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T20:32:23Z","updated_at":"2020-11-18T20:32:42Z","author_association":"MEMBER","body":"@rdblue + @aokolnychyi Follow up to #1715","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729936881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729982689","html_url":"https://github.com/apache/iceberg/pull/1784#issuecomment-729982689","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1784","id":729982689,"node_id":"MDEyOklzc3VlQ29tbWVudDcyOTk4MjY4OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T21:59:03Z","updated_at":"2020-11-18T21:59:03Z","author_association":"CONTRIBUTOR","body":"The more I look at our Spark actions right now, the more I feel we should rework them. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/729982689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730018147","html_url":"https://github.com/apache/iceberg/pull/1633#issuecomment-730018147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1633","id":730018147,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDAxODE0Nw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-18T23:20:33Z","updated_at":"2020-11-18T23:20:33Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks for the comments, I have been debating with myself about the rename order, and I have changed the dropTable to be the last operation. For the commit part, I have also simplified the logic based on the suggestions.\r\n\r\nFor the integration test part, one can run it by setting AWS credentials and a test bucket using environment variable `AWS_TEST_BUCKET` and run task `:iceberg-aws:integrationTest`. This should integrate well with Github actions. I am in the progress of requesting an account to run those tests for the open source community.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730018147/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730038553","html_url":"https://github.com/apache/iceberg/pull/1767#issuecomment-730038553","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1767","id":730038553,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDAzODU1Mw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T00:15:14Z","updated_at":"2020-11-19T00:15:14Z","author_association":"CONTRIBUTOR","body":"> @jackye1995 I've moved this PR to draft for now. I rebased on top of your changes in #1754, but it's somewhat complicated due to the fact that now we have 3 separate requests (create multipart, upload part, put object) that all require setting the properties, but they don't inherit from a common interface. I feel like reflection is probably the best way do simplify this, but I'll push the current state of things.\r\n\r\nSorry I was dealing with some other errands yesterday. Please see #1786 to see if that solves this issue, I am trying to not use reflection, but we can also switch to that approach if it is simpler.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730038553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730040465","html_url":"https://github.com/apache/iceberg/pull/1767#issuecomment-730040465","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1767","id":730040465,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDA0MDQ2NQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T00:20:25Z","updated_at":"2020-11-19T00:20:25Z","author_association":"CONTRIBUTOR","body":"> > @jackye1995 I've moved this PR to draft for now. I rebased on top of your changes in #1754, but it's somewhat complicated due to the fact that now we have 3 separate requests (create multipart, upload part, put object) that all require setting the properties, but they don't inherit from a common interface. I feel like reflection is probably the best way do simplify this, but I'll push the current state of things.\r\n> \r\n> Sorry I was dealing with some other errands yesterday. Please see #1786 to see if that solves this issue, I am trying to not use reflection, but we can also switch to that approach if it is simpler.\r\n\r\nTurns out I did something very similar here: https://github.com/apache/iceberg/pull/1767/files#diff-133c36e9cbb025f7cb44c2daac330c501d85a5a6eb44126c0eb6155f2bad7407R30","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730040465/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730041485","html_url":"https://github.com/apache/iceberg/pull/1786#issuecomment-730041485","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1786","id":730041485,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDA0MTQ4NQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T00:23:21Z","updated_at":"2020-11-19T00:24:07Z","author_association":"CONTRIBUTOR","body":"This has a lot of overlap with work done in #1767.  I'd prefer to hold off on this until work there is done since it switches to using more than just get and put operations and needs to handle encryption for mutlipart operations.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730041485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730043970","html_url":"https://github.com/apache/iceberg/pull/1767#issuecomment-730043970","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1767","id":730043970,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDA0Mzk3MA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T00:30:02Z","updated_at":"2020-11-19T00:30:02Z","author_association":"CONTRIBUTOR","body":"> > > @jackye1995 I've moved this PR to draft for now. I rebased on top of your changes in #1754, but it's somewhat complicated due to the fact that now we have 3 separate requests (create multipart, upload part, put object) that all require setting the properties, but they don't inherit from a common interface. I feel like reflection is probably the best way do simplify this, but I'll push the current state of things.\r\n> > \r\n> > \r\n> > Sorry I was dealing with some other errands yesterday. Please see #1786 to see if that solves this issue, I am trying to not use reflection, but we can also switch to that approach if it is simpler.\r\n> \r\n> Turns out I did something very similar here: https://github.com/apache/iceberg/pull/1767/files#diff-133c36e9cbb025f7cb44c2daac330c501d85a5a6eb44126c0eb6155f2bad7407R30\r\n\r\nOh yes, looks like It is a generalization for that class. For the name, I would prefer the class to be more generic just to avoid creating other utils for future use cases. For reflection, I am not sure what is the community guideline here but personally I would avoid using that, which resulted in that solution using functional interface.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730043970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730050443","html_url":"https://github.com/apache/iceberg/pull/1778#issuecomment-730050443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1778","id":730050443,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDA1MDQ0Mw==","user":{"login":"samarthjain","id":1642180,"node_id":"MDQ6VXNlcjE2NDIxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1642180?v=4","gravatar_id":"","url":"https://api.github.com/users/samarthjain","html_url":"https://github.com/samarthjain","followers_url":"https://api.github.com/users/samarthjain/followers","following_url":"https://api.github.com/users/samarthjain/following{/other_user}","gists_url":"https://api.github.com/users/samarthjain/gists{/gist_id}","starred_url":"https://api.github.com/users/samarthjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samarthjain/subscriptions","organizations_url":"https://api.github.com/users/samarthjain/orgs","repos_url":"https://api.github.com/users/samarthjain/repos","events_url":"https://api.github.com/users/samarthjain/events{/privacy}","received_events_url":"https://api.github.com/users/samarthjain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T00:48:29Z","updated_at":"2020-11-19T00:48:29Z","author_association":"COLLABORATOR","body":"> Shall we be using `SessionConfigSupport` in Spark for this?\r\n\r\n@aokolnychyi - we have run into a couple of use cases internally where users have run into issues using vectorized reads on their iceberg tables. However, the only way one can currently disable vectorized reads is by changing the table property. Since a table can be read by multiple jobs/users,  disabling vectorized reads at a table property level prevents all users/jobs from using vectorized reads. By having a session level control instead, jobs/users can decide themselves instead of \"globally\" restricting everyone. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730050443/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730052003","html_url":"https://github.com/apache/iceberg/issues/1654#issuecomment-730052003","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1654","id":730052003,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDA1MjAwMw==","user":{"login":"johnclara","id":9331049,"node_id":"MDQ6VXNlcjkzMzEwNDk=","avatar_url":"https://avatars.githubusercontent.com/u/9331049?v=4","gravatar_id":"","url":"https://api.github.com/users/johnclara","html_url":"https://github.com/johnclara","followers_url":"https://api.github.com/users/johnclara/followers","following_url":"https://api.github.com/users/johnclara/following{/other_user}","gists_url":"https://api.github.com/users/johnclara/gists{/gist_id}","starred_url":"https://api.github.com/users/johnclara/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnclara/subscriptions","organizations_url":"https://api.github.com/users/johnclara/orgs","repos_url":"https://api.github.com/users/johnclara/repos","events_url":"https://api.github.com/users/johnclara/events{/privacy}","received_events_url":"https://api.github.com/users/johnclara/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T00:53:34Z","updated_at":"2020-11-19T01:11:23Z","author_association":"NONE","body":"@mickjermsurawong-stripe we just added a less clean version of the patch and it immediately fixed our dev ingestion service.\r\n\r\nWe're able to reproduce this very reliably (but not in a clean environment) if someone has any other suggestions for fixes","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730052003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730059373","html_url":"https://github.com/apache/iceberg/pull/1778#issuecomment-730059373","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1778","id":730059373,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDA1OTM3Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T01:16:18Z","updated_at":"2020-11-19T01:16:18Z","author_association":"CONTRIBUTOR","body":"> Shall we be using SessionConfigSupport in Spark for this?\r\n\r\nDoes `SessionConfigSupport` work with catalogs? I thought it was only supported in some `DataSource` paths. I typically use catalog configuration, which I think cleanly removes the need for that interface. That may be a clean way to plug in here, I don't really have a preference.\r\n\r\n@samarthjain, I think you probably want to update the Spark 3 path as well, since that's what we use in 2.4.4.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730059373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730079214","html_url":"https://github.com/apache/iceberg/pull/1587#issuecomment-730079214","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1587","id":730079214,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDA3OTIxNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T02:12:05Z","updated_at":"2020-11-19T02:12:05Z","author_association":"CONTRIBUTOR","body":"@rymurr, I did another thorough review with more time looking through the tests. Looking close, but I found a few things.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730079214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730208438","html_url":"https://github.com/apache/iceberg/pull/1786#issuecomment-730208438","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1786","id":730208438,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDIwODQzOA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T08:19:20Z","updated_at":"2020-11-19T08:19:20Z","author_association":"CONTRIBUTOR","body":"> This has a lot of overlap with work done in #1767. I'd prefer to hold off on this until work there is done since it switches to using more than just get and put operations and needs to handle encryption for mutlipart operations.\r\n\r\nYes, I am thinking if we can solve the issue here and rebase that PR so that PR can be more concise. Let me run some performance check tomorrow to see how much impact it has if we use dynamic method loader to do it versus the current way using function interface.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730208438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730431248","html_url":"https://github.com/apache/iceberg/pull/1783#issuecomment-730431248","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1783","id":730431248,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDQzMTI0OA==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T14:59:15Z","updated_at":"2020-11-19T14:59:15Z","author_association":"CONTRIBUTOR","body":"> Why not do something like the following, which can make the whole thing more backwards compatible:\r\n\r\nI was thinking similar but as per #1587 we don't want to hold catalog configs in the hadoop `Configuration`. Logically we would then put the catalog config into `option`s. To me this leads to verbose/repetitive `read`/`write` statements (see below). I am looking for a solution that still enables session wide catalog configs to be set and this [comment](https://github.com/apache/iceberg/pull/1587#discussion_r521614936) implied that it is technically possible.\r\n\r\n```\r\ndf.write.format(\"iceberg\")\r\n  .mode(\"append\")\r\n  .option(\"catalog-impl\", \"com.my.own.CatalogImpl\")\r\n  .option(\"catalog-option1\", \"value1\")\r\n  .option(\"catalog-option2\", \"value2\")\r\n  ...\r\n  .save(\"testing.foo\")\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730431248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730503042","html_url":"https://github.com/apache/iceberg/pull/1767#issuecomment-730503042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1767","id":730503042,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDUwMzA0Mg==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T16:52:38Z","updated_at":"2020-11-19T16:52:38Z","author_association":"CONTRIBUTOR","body":"> > > > @jackye1995 I've moved this PR to draft for now. I rebased on top of your changes in #1754, but it's somewhat complicated due to the fact that now we have 3 separate requests (create multipart, upload part, put object) that all require setting the properties, but they don't inherit from a common interface. I feel like reflection is probably the best way do simplify this, but I'll push the current state of things.\r\n> > > \r\n> > > \r\n> > > Sorry I was dealing with some other errands yesterday. Please see #1786 to see if that solves this issue, I am trying to not use reflection, but we can also switch to that approach if it is simpler.\r\n> > \r\n> > \r\n> > Turns out I did something very similar here: https://github.com/apache/iceberg/pull/1767/files#diff-133c36e9cbb025f7cb44c2daac330c501d85a5a6eb44126c0eb6155f2bad7407R30\r\n> \r\n> Oh yes, looks like It is a generalization for that class. For the name, I would prefer the class to be more generic just to avoid creating other utils for future use cases. For reflection, I am not sure what is the community guideline here but personally I would avoid using that, which resulted in that solution using functional interface.\r\n\r\n@jackye1995 I actually stepped back from using reflection as I found out that some request types do not set all of the same parameters (e.g. UploadPartRequest, GetObjectRequest aren't exactly the same as PutObjectRequest and CreateMultipartUploadRequest).  Since there are no common interfaces, it seems reasonable to just separate out the behavior for now.\r\n\r\nAs we get into other instances of this (like ACL, etc.), then maybe it would make sense to find a more concise solution.\r\n\r\nI've got a few small changes to make and want to expand the testing, but hopefully have something ready for review today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730503042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730518594","html_url":"https://github.com/apache/iceberg/pull/1525#issuecomment-730518594","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1525","id":730518594,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDUxODU5NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T17:18:20Z","updated_at":"2020-11-19T17:30:37Z","author_association":"CONTRIBUTOR","body":"I have two big questions:\r\n- Shall we separate SNAPSHOT and MIGRATE into different classes? They only partially overlap and that logic can be factored out into a utility class or a base class. It seems it would be simpler if we had two separate classes. Snapshot should know nothing about renaming original tables.\r\n- Shall we use V2 Catalog API wherever possible?\r\n\r\nI tried to use V2 API for snapshot and this is what I got:\r\n\r\n```\r\npublic class SnapshotTableAction implements Action<Long> {\r\n\r\n  private final SparkSession spark;\r\n\r\n  // source table config\r\n  private final TableCatalog sourceCatalog;\r\n  private final Identifier sourceIdent;\r\n  private final Table sourceTable;\r\n\r\n  // target table config\r\n  private final StagingTableCatalog targetCatalog;\r\n  private final Identifier targetIdent;\r\n\r\n  public SnapshotTableAction(SparkSession spark, TableCatalog sourceCatalog, Identifier sourceIdent,\r\n                             TableCatalog targetCatalog, Identifier targetIdent) {\r\n\r\n    Preconditions.checkArgument(isIcebergCatalog(targetCatalog), \"Target catalog is not Iceberg catalog\");\r\n\r\n    this.spark = spark;\r\n    this.sourceCatalog = sourceCatalog;\r\n    this.sourceIdent = sourceIdent;\r\n    this.sourceTable = loadTable(sourceCatalog, sourceIdent);\r\n    this.targetCatalog = (StagingTableCatalog) targetCatalog;\r\n    this.targetIdent = targetIdent;\r\n  }\r\n\r\n  @Override\r\n  public Long execute() {\r\n    checkSourceTable();\r\n\r\n    StagedTable targetTable = stageTargetTable();\r\n    org.apache.iceberg.Table targetIcebergTable = asIcebergTable(targetTable);\r\n\r\n    try {\r\n      assignDefaultNameMapping(targetIcebergTable);\r\n\r\n      // TODO: cast to v1 table until we know how to build SparkPartitions ourselves\r\n      TableIdentifier v1Identifier = Spark3Util.toTableIdentifier(sourceIdent);\r\n      String stagingLocation = stagingLocation(targetIcebergTable);\r\n      SparkTableUtil.importSparkTable(spark, v1Identifier, targetIcebergTable, stagingLocation);\r\n\r\n      Snapshot snapshot = targetIcebergTable.currentSnapshot();\r\n      String totalDataFilesAsString = snapshot.summary().get(SnapshotSummary.TOTAL_DATA_FILES_PROP);\r\n      return Long.parseLong(totalDataFilesAsString);\r\n    } catch (Exception e) {\r\n      targetCatalog.dropTable(targetIdent);\r\n      throw new RuntimeException(\"Error msg\", e);\r\n    }\r\n  }\r\n\r\n  private boolean isIcebergCatalog(TableCatalog catalog) {\r\n    return catalog instanceof SparkSessionCatalog || catalog instanceof SparkCatalog;\r\n  }\r\n\r\n  private Table loadTable(TableCatalog catalog, Identifier ident) {\r\n    try {\r\n      return catalog.loadTable(ident);\r\n    } catch (NoSuchTableException e) {\r\n      throw new IllegalArgumentException(\"Cannot load table\", e);\r\n    }\r\n  }\r\n\r\n  private void checkSourceTable() {\r\n    // TODO: check provider and other configs (can cast to V1Table if not enough info in properties)\r\n  }\r\n\r\n  private StagedTable stageTargetTable() {\r\n    try {\r\n      Map<String, String> props = targetTableProps();\r\n      StructType schema = sourceTable.schema();\r\n      Transform[] partitioning = sourceTable.partitioning();\r\n      return targetCatalog.stageCreate(targetIdent, schema, partitioning, props);\r\n    } catch (NoSuchNamespaceException e) {\r\n      throw new IllegalArgumentException(\"Cannot create a new table in a namespace which does not exist\", e);\r\n    } catch (TableAlreadyExistsException e) {\r\n      throw new IllegalArgumentException(\"Destination table already exists\", e);\r\n    }\r\n  }\r\n\r\n  private Map<String, String> targetTableProps() {\r\n    // TODO: prepare new properties based on the source table, override location\r\n    return null;\r\n  }\r\n\r\n  private String stagingLocation(org.apache.iceberg.Table table) {\r\n    // TODO: return the metadata location\r\n    return null;\r\n  }\r\n\r\n  private void assignDefaultNameMapping(org.apache.iceberg.Table table) {\r\n    // TODO: assign default name mapping\r\n  }\r\n\r\n  private org.apache.iceberg.Table asIcebergTable(Table table) {\r\n    return ((SparkTable) table).table();\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730518594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730523094","html_url":"https://github.com/apache/iceberg/issues/1617#issuecomment-730523094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1617","id":730523094,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDUyMzA5NA==","user":{"login":"pavibhai","id":7353275,"node_id":"MDQ6VXNlcjczNTMyNzU=","avatar_url":"https://avatars.githubusercontent.com/u/7353275?v=4","gravatar_id":"","url":"https://api.github.com/users/pavibhai","html_url":"https://github.com/pavibhai","followers_url":"https://api.github.com/users/pavibhai/followers","following_url":"https://api.github.com/users/pavibhai/following{/other_user}","gists_url":"https://api.github.com/users/pavibhai/gists{/gist_id}","starred_url":"https://api.github.com/users/pavibhai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pavibhai/subscriptions","organizations_url":"https://api.github.com/users/pavibhai/orgs","repos_url":"https://api.github.com/users/pavibhai/repos","events_url":"https://api.github.com/users/pavibhai/events{/privacy}","received_events_url":"https://api.github.com/users/pavibhai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-19T17:26:21Z","updated_at":"2020-11-19T17:26:21Z","author_association":"CONTRIBUTOR","body":"@jackye1995 and @rdblue \r\nThanks for your feedback.\r\n\r\nOur current thought process is as follows:\r\n1. Only the Table Path be an absolute path, with all other paths in the metadata files being relative paths\r\n2. The relative path should not be visible outside of the metadata component i.e. the relative path should be translated to an absolute path using the table path for other areas of Iceberg to consume, so only the metadata files shall store the relative path.\r\n3. The relative path references shall be confined to be within the table path i.e `../` shall not be allowed.\r\n\r\nI don't think the scenario called out about a wrong HDFS location being cleaned will be worsened or improved as a result of this change. If the absolute path of the table is incorrectly interpreted to be something else then problems shall still happen.\r\n\r\nWe will explore the option of FileIO in parallel while we discuss further the complications of using relative paths.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/730523094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]