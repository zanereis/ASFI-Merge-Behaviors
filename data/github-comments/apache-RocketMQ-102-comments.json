[{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091087578","html_url":"https://github.com/apache/rocketmq/pull/4113#issuecomment-1091087578","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4113","id":1091087578,"node_id":"IC_kwDOBHrsl85BCKza","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T05:11:32Z","updated_at":"2022-04-07T05:11:32Z","author_association":"CONTRIBUTOR","body":"@lwclover \r\n\r\n#### Thanks for your reivew and suggestion\r\n`RouteInfoManager` log is modified for doing the same logic with others.\r\n\r\nThe main propurse of this pr is that fixing the error rised from the incorrect position of `lockInterruptibly`, and not change the semantics of any method.\r\n\r\n\r\n#### 感谢建议和评论。\r\n1. `RouteInfoManager` 中的日志打印已加上异常堆栈、**以和其他处理`InterruptedException`的逻辑对齐**。但其实这是没有必要的，因为加锁方法抛出的`InterruptedException`并不会打印任何有用信息、并且抛出异常的位置也是唯一的；\r\n2. 其他建议均为同一类型：修改catch的异常类型、或者不catch某些异常。**这种修改会改变所在方法的语义**，比如之前方法的语义仅仅是 catch `InterruptedException`、修改会为catch所有异常、甚至包括 `RuntimeException`，这不是该PR的本意。该PR目的只有一个：修正 `lockInterruptibly` 使用位置导致问题导致的异常准确性和bug。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091087578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091096898","html_url":"https://github.com/apache/rocketmq/pull/4113#issuecomment-1091096898","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4113","id":1091096898,"node_id":"IC_kwDOBHrsl85BCNFC","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T05:30:16Z","updated_at":"2022-04-07T05:30:16Z","author_association":"CONTRIBUTOR","body":"@lwclover \r\n> 其他建议均为同一类型：修改catch的异常类型、或者不catch某些异常...\r\n\r\n刚才我理解成了4条**单独**的建议，其实4条评论是两个完整的修改建议、这样看代码实现的确是更加简练了。感谢建议。\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091096898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091109515","html_url":"https://github.com/apache/rocketmq/pull/4113#issuecomment-1091109515","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4113","id":1091109515,"node_id":"IC_kwDOBHrsl85BCQKL","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T05:56:20Z","updated_at":"2022-04-07T05:56:20Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48072066/badge)](https://coveralls.io/builds/48072066)\n\nCoverage increased (+0.04%) to 52.0% when pulling **c99f3a82fa9f3df3d79115a4cab496a8a6a06687 on dugenkui03:patch-10** into **fd554ab12072225325c957ff6bdf492fc67821af on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091109515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091109516","html_url":"https://github.com/apache/rocketmq/pull/4113#issuecomment-1091109516","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4113","id":1091109516,"node_id":"IC_kwDOBHrsl85BCQKM","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T05:56:20Z","updated_at":"2022-04-07T05:56:20Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48072066/badge)](https://coveralls.io/builds/48072066)\n\nCoverage increased (+0.04%) to 52.0% when pulling **c99f3a82fa9f3df3d79115a4cab496a8a6a06687 on dugenkui03:patch-10** into **fd554ab12072225325c957ff6bdf492fc67821af on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091109516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091109692","html_url":"https://github.com/apache/rocketmq/pull/4113#issuecomment-1091109692","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4113","id":1091109692,"node_id":"IC_kwDOBHrsl85BCQM8","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T05:56:41Z","updated_at":"2022-04-07T05:56:41Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4113?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#4113](https://codecov.io/gh/apache/rocketmq/pull/4113?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (c99f3a8) into [develop](https://codecov.io/gh/apache/rocketmq/commit/fd554ab12072225325c957ff6bdf492fc67821af?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (fd554ab) will **decrease** coverage by `0.02%`.\n> The diff coverage is `79.31%`.\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #4113      +/-   ##\n=============================================\n- Coverage      47.92%   47.89%   -0.03%     \n+ Complexity      5002     5001       -1     \n=============================================\n  Files            634      635       +1     \n  Lines          42529    42506      -23     \n  Branches        5573     5567       -6     \n=============================================\n- Hits           20381    20360      -21     \n- Misses         19647    19653       +6     \n+ Partials        2501     2493       -8     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/4113?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | |\n|---|---|---|\n| [...he/rocketmq/client/impl/consumer/ProcessQueue.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9Qcm9jZXNzUXVldWUuamF2YQ==) | `62.27% <64.70%> (-0.12%)` | :arrow_down: |\n| [...e/rocketmq/namesrv/routeinfo/RouteInfoManager.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-bmFtZXNydi9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbmFtZXNydi9yb3V0ZWluZm8vUm91dGVJbmZvTWFuYWdlci5qYXZh) | `81.51% <100.00%> (ø)` | |\n| [...rocketmq/broker/filtersrv/FilterServerManager.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-YnJva2VyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9icm9rZXIvZmlsdGVyc3J2L0ZpbHRlclNlcnZlck1hbmFnZXIuamF2YQ==) | `20.00% <0.00%> (-14.29%)` | :arrow_down: |\n| [...in/java/org/apache/rocketmq/test/util/MQAdmin.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-dGVzdC9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvdGVzdC91dGlsL01RQWRtaW4uamF2YQ==) | `38.88% <0.00%> (-5.56%)` | :arrow_down: |\n| [...ava/org/apache/rocketmq/test/util/VerifyUtils.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-dGVzdC9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvdGVzdC91dGlsL1ZlcmlmeVV0aWxzLmphdmE=) | `46.26% <0.00%> (-2.99%)` | :arrow_down: |\n| [...ava/org/apache/rocketmq/filter/util/BitsArray.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CaXRzQXJyYXkuamF2YQ==) | `59.82% <0.00%> (-2.57%)` | :arrow_down: |\n| [...va/org/apache/rocketmq/logging/inner/Appender.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-bG9nZ2luZy9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbG9nZ2luZy9pbm5lci9BcHBlbmRlci5qYXZh) | `34.83% <0.00%> (-2.25%)` | :arrow_down: |\n| [...ent/impl/consumer/DefaultLitePullConsumerImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9EZWZhdWx0TGl0ZVB1bGxDb25zdW1lckltcGwuamF2YQ==) | `67.75% <0.00%> (-1.56%)` | :arrow_down: |\n| [...rg/apache/rocketmq/remoting/netty/NettyLogger.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L05ldHR5TG9nZ2VyLmphdmE=) | `14.96% <0.00%> (-1.37%)` | :arrow_down: |\n| [...a/org/apache/rocketmq/store/StoreStatsService.java](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL1N0b3JlU3RhdHNTZXJ2aWNlLmphdmE=) | `35.85% <0.00%> (-1.13%)` | :arrow_down: |\n| ... and [17 more](https://codecov.io/gh/apache/rocketmq/pull/4113/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/4113?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4113?src=pr&el=footer&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Last update [fd554ab...c99f3a8](https://codecov.io/gh/apache/rocketmq/pull/4113?src=pr&el=lastupdated&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091109692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091160169","html_url":"https://github.com/apache/rocketmq/pull/4113#issuecomment-1091160169","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4113","id":1091160169,"node_id":"IC_kwDOBHrsl85BCchp","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T07:12:06Z","updated_at":"2022-04-07T07:12:06Z","author_association":"CONTRIBUTOR","body":"> 其实4条评论是两个完整的修改建议、这样看代码实现的确是更加简练了。感谢建议。\r\n\r\n客气了，共同进步","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091160169/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091267175","html_url":"https://github.com/apache/rocketmq/pull/4100#issuecomment-1091267175","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4100","id":1091267175,"node_id":"IC_kwDOBHrsl85BC2pn","user":{"login":"cserwen","id":46882838,"node_id":"MDQ6VXNlcjQ2ODgyODM4","avatar_url":"https://avatars.githubusercontent.com/u/46882838?v=4","gravatar_id":"","url":"https://api.github.com/users/cserwen","html_url":"https://github.com/cserwen","followers_url":"https://api.github.com/users/cserwen/followers","following_url":"https://api.github.com/users/cserwen/following{/other_user}","gists_url":"https://api.github.com/users/cserwen/gists{/gist_id}","starred_url":"https://api.github.com/users/cserwen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cserwen/subscriptions","organizations_url":"https://api.github.com/users/cserwen/orgs","repos_url":"https://api.github.com/users/cserwen/repos","events_url":"https://api.github.com/users/cserwen/events{/privacy}","received_events_url":"https://api.github.com/users/cserwen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T08:12:35Z","updated_at":"2022-04-07T08:12:35Z","author_association":"MEMBER","body":"@RongtongJin  Hi, can you help me to review this pr?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091267175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091323626","html_url":"https://github.com/apache/rocketmq/pull/4122#issuecomment-1091323626","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4122","id":1091323626,"node_id":"IC_kwDOBHrsl85BDEbq","user":{"login":"cserwen","id":46882838,"node_id":"MDQ6VXNlcjQ2ODgyODM4","avatar_url":"https://avatars.githubusercontent.com/u/46882838?v=4","gravatar_id":"","url":"https://api.github.com/users/cserwen","html_url":"https://github.com/cserwen","followers_url":"https://api.github.com/users/cserwen/followers","following_url":"https://api.github.com/users/cserwen/following{/other_user}","gists_url":"https://api.github.com/users/cserwen/gists{/gist_id}","starred_url":"https://api.github.com/users/cserwen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cserwen/subscriptions","organizations_url":"https://api.github.com/users/cserwen/orgs","repos_url":"https://api.github.com/users/cserwen/repos","events_url":"https://api.github.com/users/cserwen/events{/privacy}","received_events_url":"https://api.github.com/users/cserwen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T08:37:41Z","updated_at":"2022-04-07T08:37:41Z","author_association":"MEMBER","body":"@RongtongJin @Jason918 Hello, can you help me to review this pr?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1091323626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092077125","html_url":"https://github.com/apache/rocketmq/issues/3973#issuecomment-1092077125","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/3973","id":1092077125,"node_id":"IC_kwDOBHrsl85BF8ZF","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T18:35:12Z","updated_at":"2022-04-07T18:35:12Z","author_association":"CONTRIBUTOR","body":"@aaron-ai Some optimized suggestion about api-module, please take a look.\r\n1. Create masker interface `ErrorClassification`, and replace `ErrorCode` with `ErrorClassification` in `ClientException`. I think developer need custom error type, such as limitation;\r\n2. Replace `CompletableFuture` with `Future` in `Producer#sendAsync`, since `Future` is more extensibie. the default implementation of `Producer#sendAsync` still can use `CompletableFuture`;\r\n3. Replace  `BackoffRetryPolicy` with `RetryPolicy` in `ProducerBuilder#setRetryPolicy `.\r\n\r\n#### Describe in Chinese\r\n您好，关于 api-module 有些建议请评估是否采纳：\r\n1. 创建标记接口`ErrorClassification`、并使`ErrorCode`实现该接口，`ClientException`中`ErrorCode`替换为`ErrorClassification`。因为我认为开发者经常需要自定义异常和异常类型，例如限流，而现在的接口设计其实也支持用户自定义异常；\r\n2. 在`Producer#sendAsync`中使用`Future`替换`CompletableFuture`，因为前者已经可以满足接口需要，我们可以再具体实现中在返回`CompletableFuture`；\r\n3. 在`ProducerBuilder#setRetryPolicy`中使用`RetryPolicy`替换 `BackoffRetryPolicy`。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092077125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092199573","html_url":"https://github.com/apache/rocketmq/pull/4134#issuecomment-1092199573","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4134","id":1092199573,"node_id":"IC_kwDOBHrsl85BGaSV","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T21:05:53Z","updated_at":"2022-04-07T21:05:53Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48101795/badge)](https://coveralls.io/builds/48101795)\n\nCoverage decreased (-0.01%) to 47.212% when pulling **1992309bbc2ee3196ebac654178febbc6e9c2dc0 on dugenkui03:5.0.0-beta-patch-1** into **52482d4e0d610f45c139dc35b8d2d8784452331e on apache:5.0.0-beta**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092199573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092395627","html_url":"https://github.com/apache/rocketmq/pull/4100#issuecomment-1092395627","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4100","id":1092395627,"node_id":"IC_kwDOBHrsl85BHKJr","user":{"login":"cserwen","id":46882838,"node_id":"MDQ6VXNlcjQ2ODgyODM4","avatar_url":"https://avatars.githubusercontent.com/u/46882838?v=4","gravatar_id":"","url":"https://api.github.com/users/cserwen","html_url":"https://github.com/cserwen","followers_url":"https://api.github.com/users/cserwen/followers","following_url":"https://api.github.com/users/cserwen/following{/other_user}","gists_url":"https://api.github.com/users/cserwen/gists{/gist_id}","starred_url":"https://api.github.com/users/cserwen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cserwen/subscriptions","organizations_url":"https://api.github.com/users/cserwen/orgs","repos_url":"https://api.github.com/users/cserwen/repos","events_url":"https://api.github.com/users/cserwen/events{/privacy}","received_events_url":"https://api.github.com/users/cserwen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T03:03:25Z","updated_at":"2022-04-08T03:03:25Z","author_association":"MEMBER","body":"> It seems that removeBroker didn't do anything for dledger? In addition, maybe we need to modify admin（addBroker, removeBroker） comments or functions synchronously.\r\n\r\n@RongtongJin Thanks for the reminder, I forgot to add it in this method.  \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092395627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092396888","html_url":"https://github.com/apache/rocketmq/issues/3973#issuecomment-1092396888","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/3973","id":1092396888,"node_id":"IC_kwDOBHrsl85BHKdY","user":{"login":"aaron-ai","id":19537356,"node_id":"MDQ6VXNlcjE5NTM3MzU2","avatar_url":"https://avatars.githubusercontent.com/u/19537356?v=4","gravatar_id":"","url":"https://api.github.com/users/aaron-ai","html_url":"https://github.com/aaron-ai","followers_url":"https://api.github.com/users/aaron-ai/followers","following_url":"https://api.github.com/users/aaron-ai/following{/other_user}","gists_url":"https://api.github.com/users/aaron-ai/gists{/gist_id}","starred_url":"https://api.github.com/users/aaron-ai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaron-ai/subscriptions","organizations_url":"https://api.github.com/users/aaron-ai/orgs","repos_url":"https://api.github.com/users/aaron-ai/repos","events_url":"https://api.github.com/users/aaron-ai/events{/privacy}","received_events_url":"https://api.github.com/users/aaron-ai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T03:06:21Z","updated_at":"2022-04-08T06:49:41Z","author_association":"MEMBER","body":"> @aaron-ai Some optimized suggestion about api-module, please take a look.\r\n> \r\n> 1. Create masker interface `ErrorClassification`, and replace `ErrorCode` with `ErrorClassification` in `ClientException`. I think developer need custom error type, such as limitation;\r\n> 2. Replace `CompletableFuture` with `Future` in `Producer#sendAsync`, since `Future` is more extensibie. the default implementation of `Producer#sendAsync` still can use `CompletableFuture`;\r\n> 3. Replace  `BackoffRetryPolicy` with `RetryPolicy` in `ProducerBuilder#setRetryPolicy `.\r\n> \r\n> #### Describe in Chinese\r\n> 您好，关于 api-module 有些建议请评估是否采纳：\r\n> \r\n> 1. 创建标记接口`ErrorClassification`、并使`ErrorCode`实现该接口，`ClientException`中`ErrorCode`替换为`ErrorClassification`。因为我认为开发者经常需要自定义异常和异常类型，例如限流，而现在的接口设计其实也支持用户自定义异常；\r\n> 2. 在`Producer#sendAsync`中使用`Future`替换`CompletableFuture`，因为前者已经可以满足接口需要，我们可以再具体实现中在返回`CompletableFuture`；\r\n> 3. 在`ProducerBuilder#setRetryPolicy`中使用`RetryPolicy`替换 `BackoffRetryPolicy`。\r\n\r\nThanks for your suggestion, here is my opinion:\r\n1. Yes, as you said, error code may be added frequently, what's more, the new APIs is intend to unify both of RemotingCommand-based client and gRPC-based client #3949 , we need a looser structure to define error code here, so the existing design may be updated in subsequent pull request, welcome to be involved in the code review :)\r\n2. `CompletableFuture` may be essential, which allows users add their callback easily.\r\n3. In most case, `BackoffRetryPolicy` is enough, so we are not sure about that whether it is time to replace `BackoffRetryPolicy` by `RetryPolicy` now, a customized `RetryPolicy` which is not well-designed may be harmful to the server side, which is we are worried about. The design of `BackoffRetryPolicy` is refer to gRPC, and has undergone a long-term practice.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092396888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092463886","html_url":"https://github.com/apache/rocketmq/issues/3973#issuecomment-1092463886","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/3973","id":1092463886,"node_id":"IC_kwDOBHrsl85BHa0O","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T05:47:30Z","updated_at":"2022-04-08T05:49:07Z","author_association":"CONTRIBUTOR","body":"Thanks for your reply, there is already a pr for these suggestion #4134. **If some work is already done, please ignored #4134**.\r\n\r\n> CompletableFuture may be essential, which allows users add their callback easily.\r\n\r\nReturn `Future` will not stop developers use callback in `CompletableFuture` because `CompletableFuture` is a implementation of `Future`. but return a concret `CompletableFuture` will affect the extensibility of the interface —— You must accept both pros and cons, such as async timeout, and it is hard to extend `CompletableFuture`.\r\n\r\n>In most case, BackoffRetryPolicy is enough.\r\n\r\nIf `BackoffRetryPolicy` could satify developers, I think `RetryPolicy` will be redundant. The reason I think `RetryPolicy` is better is that **Developers will always want to change `maxAttempts`**.\r\n\r\n# Describe in Chinese\r\n感谢回复，针对这些建议当前已经有了一个pr、见#4134，如果有相关的代码已经实现或者正在进行中则请忽略该PR。\r\n\r\n> CompletableFuture may be essential, which allows users add their callback easily.\r\n\r\n返回`Future`并不影响开发者在后续处理中使用`CompletableFuture`中提供的回调方法、因为开发者可以在具体的实现中返回`Futrue`的实现类`CompletableFuture`。但是返回具体的类将会影响该接口的可扩展性、也意味着我们必须同时接受`CompletableFuture`的优缺点、例如异步超时机制在jdk1.9才出现、而该特性对于超时发送也许会很重要；\r\n\r\n>In most case, BackoffRetryPolicy is enough.\r\n\r\n如果`BackoffRetryPolicy`已经能够应对各种场景那`RetryPolicy`的定义似乎有些多余？\r\n我认为`RetryPolicy`使用比较恰当的原因是开发者总是想动态的修改`maxAttempts`(比如通过redis或者公司各种配置平台配置系统的一些关键参数)。`nextAttemptDelay`同理。\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092463886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092522761","html_url":"https://github.com/apache/rocketmq/issues/3973#issuecomment-1092522761","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/3973","id":1092522761,"node_id":"IC_kwDOBHrsl85BHpMJ","user":{"login":"aaron-ai","id":19537356,"node_id":"MDQ6VXNlcjE5NTM3MzU2","avatar_url":"https://avatars.githubusercontent.com/u/19537356?v=4","gravatar_id":"","url":"https://api.github.com/users/aaron-ai","html_url":"https://github.com/aaron-ai","followers_url":"https://api.github.com/users/aaron-ai/followers","following_url":"https://api.github.com/users/aaron-ai/following{/other_user}","gists_url":"https://api.github.com/users/aaron-ai/gists{/gist_id}","starred_url":"https://api.github.com/users/aaron-ai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaron-ai/subscriptions","organizations_url":"https://api.github.com/users/aaron-ai/orgs","repos_url":"https://api.github.com/users/aaron-ai/repos","events_url":"https://api.github.com/users/aaron-ai/events{/privacy}","received_events_url":"https://api.github.com/users/aaron-ai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:13:10Z","updated_at":"2022-04-08T07:13:10Z","author_association":"MEMBER","body":"> 返回 `Future` 并不影响开发者在后续处理中使用 `CompletableFuture` 中提供的回调方法、因为开发者可以在具体的实现中返回 `Futrue` 的实现类 `CompletableFuture`。\r\n\r\nCould you provide an example to add callback or convert `Future` to `CompletableFuture` if there is a method for message publishing like this?\r\n```java\r\nFuture<SendReceipt> sendAsync(Message message);\r\n```\r\n\r\nAbout the `RetryPolicy`, actually it is not public, which means it is not exposed to users, `maxAttempts` could also be modified in `BackoffRetryPolicy`, but we may reconsider that if it is reasonable enough to keep `RetryPolicy` in this module.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092522761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092562954","html_url":"https://github.com/apache/rocketmq/pull/4135#issuecomment-1092562954","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4135","id":1092562954,"node_id":"IC_kwDOBHrsl85BHzAK","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:55:53Z","updated_at":"2022-04-08T07:55:53Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48112422/badge)](https://coveralls.io/builds/48112422)\n\nCoverage increased (+0.2%) to 51.963% when pulling **d1465341c858f9095ddbf943d65da1efdf0d1955 on BurningCN:Remove_fileLock_related_code_snippets_in_IndexFile** into **8745d4c538d5c96e65a56f6278029c5765e7d922 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092562954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092562957","html_url":"https://github.com/apache/rocketmq/pull/4135#issuecomment-1092562957","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4135","id":1092562957,"node_id":"IC_kwDOBHrsl85BHzAN","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:55:53Z","updated_at":"2022-04-08T07:55:53Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48112422/badge)](https://coveralls.io/builds/48112422)\n\nCoverage increased (+0.2%) to 51.963% when pulling **d1465341c858f9095ddbf943d65da1efdf0d1955 on BurningCN:Remove_fileLock_related_code_snippets_in_IndexFile** into **8745d4c538d5c96e65a56f6278029c5765e7d922 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092562957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092563683","html_url":"https://github.com/apache/rocketmq/issues/3973#issuecomment-1092563683","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/3973","id":1092563683,"node_id":"IC_kwDOBHrsl85BHzLj","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:56:48Z","updated_at":"2022-04-08T08:57:50Z","author_association":"CONTRIBUTOR","body":"Not convert `Future` to `CompletableFuture`, but implements `#sendAsync(Message)` which return `CompletableFuture`.\r\n\r\n# Describe in Chinese\r\n并非将`Future`转换成`CompletableFuture`，而是在`Producer`中实现`#sendAsync(Message)`方法的时候将返回结果修改为`CompletableFuture`，**甚至`Future`任意的实现**，例如返回 `guava-ListenableFuture` 以使用jdk8的`CompletableFuture`中没有的特性。像这种在具体实现中在返回具体的类、以扩展或者限定接口能力的方式，在一些比较常见的类库都有使用。\r\n\r\n```java\r\npublic interface Producer {\r\n\r\n    ......\r\n\r\n    Future<SendReceipt> sendAsync(Message message);\r\n\r\n}\r\n\r\npublic class DefaultProducer {\r\n\r\n    ......\r\n\r\n    CompletableFuture<SendReceipt> sendAsync(Message message){\r\n               // 具体的实现，其逻辑的确依赖 CompletableFuture\r\n           ......\r\n    }\r\n\r\n}\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092563683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092622450","html_url":"https://github.com/apache/rocketmq/issues/3973#issuecomment-1092622450","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/3973","id":1092622450,"node_id":"IC_kwDOBHrsl85BIBhy","user":{"login":"aaron-ai","id":19537356,"node_id":"MDQ6VXNlcjE5NTM3MzU2","avatar_url":"https://avatars.githubusercontent.com/u/19537356?v=4","gravatar_id":"","url":"https://api.github.com/users/aaron-ai","html_url":"https://github.com/aaron-ai","followers_url":"https://api.github.com/users/aaron-ai/followers","following_url":"https://api.github.com/users/aaron-ai/following{/other_user}","gists_url":"https://api.github.com/users/aaron-ai/gists{/gist_id}","starred_url":"https://api.github.com/users/aaron-ai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aaron-ai/subscriptions","organizations_url":"https://api.github.com/users/aaron-ai/orgs","repos_url":"https://api.github.com/users/aaron-ai/repos","events_url":"https://api.github.com/users/aaron-ai/events{/privacy}","received_events_url":"https://api.github.com/users/aaron-ai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T08:59:24Z","updated_at":"2022-04-08T08:59:24Z","author_association":"MEMBER","body":"Actually we considered about `ListenableFuture`, unfortunately it doesn't belong to the standard library. On the other side **user will use `Producer#sendAsync` to publish message directly rather than `DefaultProducer#sendAsync` in their programs**, so the implementation is not the scope of APIs discussion.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092622450/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092644012","html_url":"https://github.com/apache/rocketmq/pull/4071#issuecomment-1092644012","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4071","id":1092644012,"node_id":"IC_kwDOBHrsl85BIGys","user":{"login":"humkum","id":50660789,"node_id":"MDQ6VXNlcjUwNjYwNzg5","avatar_url":"https://avatars.githubusercontent.com/u/50660789?v=4","gravatar_id":"","url":"https://api.github.com/users/humkum","html_url":"https://github.com/humkum","followers_url":"https://api.github.com/users/humkum/followers","following_url":"https://api.github.com/users/humkum/following{/other_user}","gists_url":"https://api.github.com/users/humkum/gists{/gist_id}","starred_url":"https://api.github.com/users/humkum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humkum/subscriptions","organizations_url":"https://api.github.com/users/humkum/orgs","repos_url":"https://api.github.com/users/humkum/repos","events_url":"https://api.github.com/users/humkum/events{/privacy}","received_events_url":"https://api.github.com/users/humkum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T09:22:51Z","updated_at":"2022-04-08T09:22:51Z","author_association":"CONTRIBUTOR","body":"@lizhiboo Hi, would you please check if this pr could be merged?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092644012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092729471","html_url":"https://github.com/apache/rocketmq/issues/4137#issuecomment-1092729471","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4137","id":1092729471,"node_id":"IC_kwDOBHrsl85BIbp_","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T10:44:29Z","updated_at":"2022-04-08T10:44:29Z","author_association":"CONTRIBUTOR","body":"rocketmq也可以的，拉取消息的时候有配置是否使用sendfile方式，默认是不使用","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092729471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092745365","html_url":"https://github.com/apache/rocketmq/issues/4137#issuecomment-1092745365","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4137","id":1092745365,"node_id":"IC_kwDOBHrsl85BIfiV","user":{"login":"AdventurerJohn","id":49260621,"node_id":"MDQ6VXNlcjQ5MjYwNjIx","avatar_url":"https://avatars.githubusercontent.com/u/49260621?v=4","gravatar_id":"","url":"https://api.github.com/users/AdventurerJohn","html_url":"https://github.com/AdventurerJohn","followers_url":"https://api.github.com/users/AdventurerJohn/followers","following_url":"https://api.github.com/users/AdventurerJohn/following{/other_user}","gists_url":"https://api.github.com/users/AdventurerJohn/gists{/gist_id}","starred_url":"https://api.github.com/users/AdventurerJohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AdventurerJohn/subscriptions","organizations_url":"https://api.github.com/users/AdventurerJohn/orgs","repos_url":"https://api.github.com/users/AdventurerJohn/repos","events_url":"https://api.github.com/users/AdventurerJohn/events{/privacy}","received_events_url":"https://api.github.com/users/AdventurerJohn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T11:05:11Z","updated_at":"2022-04-08T11:05:11Z","author_association":"NONE","body":"> RocketMQ也可以的，拉取消息的时候有配置是否使用sendfile方式，默认是不使用\r\n\r\n请教大佬，那为什么默认不使用呢？难道不是开启速度会更快一些吗？","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092745365/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092763376","html_url":"https://github.com/apache/rocketmq/issues/4137#issuecomment-1092763376","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4137","id":1092763376,"node_id":"IC_kwDOBHrsl85BIj7w","user":{"login":"AdventurerJohn","id":49260621,"node_id":"MDQ6VXNlcjQ5MjYwNjIx","avatar_url":"https://avatars.githubusercontent.com/u/49260621?v=4","gravatar_id":"","url":"https://api.github.com/users/AdventurerJohn","html_url":"https://github.com/AdventurerJohn","followers_url":"https://api.github.com/users/AdventurerJohn/followers","following_url":"https://api.github.com/users/AdventurerJohn/following{/other_user}","gists_url":"https://api.github.com/users/AdventurerJohn/gists{/gist_id}","starred_url":"https://api.github.com/users/AdventurerJohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AdventurerJohn/subscriptions","organizations_url":"https://api.github.com/users/AdventurerJohn/orgs","repos_url":"https://api.github.com/users/AdventurerJohn/repos","events_url":"https://api.github.com/users/AdventurerJohn/events{/privacy}","received_events_url":"https://api.github.com/users/AdventurerJohn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T11:27:59Z","updated_at":"2022-04-08T11:27:59Z","author_association":"NONE","body":"> rocketmq也可以的，拉取消息的时候有配置是否使用sendfile方式，默认是不使用\r\n\r\n请问大佬是哪个配置啊，我没找到","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1092763376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1093679182","html_url":"https://github.com/apache/rocketmq/pull/4138#issuecomment-1093679182","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4138","id":1093679182,"node_id":"IC_kwDOBHrsl85BMDhO","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-09T04:33:18Z","updated_at":"2022-06-09T03:37:37Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4138?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#4138](https://codecov.io/gh/apache/rocketmq/pull/4138?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (7498250) into [develop](https://codecov.io/gh/apache/rocketmq/commit/fd554ab12072225325c957ff6bdf492fc67821af?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (fd554ab) will **increase** coverage by `2.26%`.\n> The diff coverage is `93.75%`.\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #4138      +/-   ##\n=============================================\n+ Coverage      47.92%   50.18%   +2.26%     \n- Complexity      5002     5968     +966     \n=============================================\n  Files            634      646      +12     \n  Lines          42529    48487    +5958     \n  Branches        5573     7073    +1500     \n=============================================\n+ Hits           20381    24334    +3953     \n- Misses         19647    21458    +1811     \n- Partials        2501     2695     +194     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/4138?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | |\n|---|---|---|\n| [...he/rocketmq/remoting/protocol/RemotingCommand.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL3Byb3RvY29sL1JlbW90aW5nQ29tbWFuZC5qYXZh) | `79.89% <93.75%> (+1.67%)` | :arrow_up: |\n| [...s/command/acl/UpdateGlobalWhiteAddrSubCommand.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-dG9vbHMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3Rvb2xzL2NvbW1hbmQvYWNsL1VwZGF0ZUdsb2JhbFdoaXRlQWRkclN1YkNvbW1hbmQuamF2YQ==) | `29.09% <0.00%> (-5.12%)` | :arrow_down: |\n| [...ava/org/apache/rocketmq/test/util/VerifyUtils.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-dGVzdC9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvdGVzdC91dGlsL1ZlcmlmeVV0aWxzLmphdmE=) | `46.26% <0.00%> (-2.99%)` | :arrow_down: |\n| [...ava/org/apache/rocketmq/filter/util/BitsArray.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CaXRzQXJyYXkuamF2YQ==) | `59.82% <0.00%> (-2.57%)` | :arrow_down: |\n| [...ocketmq/client/consumer/DefaultMQPushConsumer.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvY29uc3VtZXIvRGVmYXVsdE1RUHVzaENvbnN1bWVyLmphdmE=) | `56.56% <0.00%> (-1.86%)` | :arrow_down: |\n| [...a/org/apache/rocketmq/store/index/IndexHeader.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL2luZGV4L0luZGV4SGVhZGVyLmphdmE=) | `93.24% <0.00%> (-1.31%)` | :arrow_down: |\n| [...ocketmq/client/consumer/DefaultMQPullConsumer.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvY29uc3VtZXIvRGVmYXVsdE1RUHVsbENvbnN1bWVyLmphdmE=) | `32.47% <0.00%> (-0.86%)` | :arrow_down: |\n| [.../java/org/apache/rocketmq/logging/inner/Level.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-bG9nZ2luZy9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbG9nZ2luZy9pbm5lci9MZXZlbC5qYXZh) | `37.28% <0.00%> (-0.72%)` | :arrow_down: |\n| [...he/rocketmq/client/producer/DefaultMQProducer.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvcHJvZHVjZXIvRGVmYXVsdE1RUHJvZHVjZXIuamF2YQ==) | `56.82% <0.00%> (-0.53%)` | :arrow_down: |\n| [...e/rocketmq/client/impl/consumer/RebalanceImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9SZWJhbGFuY2VJbXBsLmphdmE=) | `44.53% <0.00%> (-0.40%)` | :arrow_down: |\n| ... and [92 more](https://codecov.io/gh/apache/rocketmq/pull/4138/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/4138?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4138?src=pr&el=footer&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Last update [fd554ab...7498250](https://codecov.io/gh/apache/rocketmq/pull/4138?src=pr&el=lastupdated&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1093679182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1093680825","html_url":"https://github.com/apache/rocketmq/pull/4138#issuecomment-1093680825","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4138","id":1093680825,"node_id":"IC_kwDOBHrsl85BMD65","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-09T04:36:00Z","updated_at":"2022-04-09T04:36:00Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48139665/badge)](https://coveralls.io/builds/48139665)\n\nCoverage decreased (-0.02%) to 51.963% when pulling **749825073086c4f4be310f0c3789998417b728a4 on dugenkui03:patch-14** into **47561bdd855ab381113d736b5c26a09c08da590b on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1093680825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1093680830","html_url":"https://github.com/apache/rocketmq/pull/4138#issuecomment-1093680830","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4138","id":1093680830,"node_id":"IC_kwDOBHrsl85BMD6-","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-09T04:36:00Z","updated_at":"2022-06-09T03:37:25Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/49867310/badge)](https://coveralls.io/builds/49867310)\n\nCoverage increased (+0.1%) to 52.105% when pulling **749825073086c4f4be310f0c3789998417b728a4 on dugenkui03:patch-14** into **47561bdd855ab381113d736b5c26a09c08da590b on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1093680830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1093804035","html_url":"https://github.com/apache/rocketmq/pull/4100#issuecomment-1093804035","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4100","id":1093804035,"node_id":"IC_kwDOBHrsl85BMiAD","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-09T08:23:48Z","updated_at":"2022-04-09T08:23:48Z","author_association":"CONTRIBUTOR","body":"LGTM~","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1093804035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094157287","html_url":"https://github.com/apache/rocketmq/pull/4141#issuecomment-1094157287","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4141","id":1094157287,"node_id":"IC_kwDOBHrsl85BN4Pn","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T01:54:03Z","updated_at":"2022-04-10T01:54:03Z","author_association":"CONTRIBUTOR","body":"提交包括其他人commit ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094157287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094163501","html_url":"https://github.com/apache/rocketmq/issues/4140#issuecomment-1094163501","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4140","id":1094163501,"node_id":"IC_kwDOBHrsl85BN5wt","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T02:46:00Z","updated_at":"2022-04-10T02:46:00Z","author_association":"CONTRIBUTOR","body":"这是一个问题。主备之间的日志数据复制用的是brokerIP2，但元数据复制（topics.json，subscriptionGroup.json等 ）用的brokerIP1，我认为两者都应该使用brokerIP2，其他人有什么意见吗？\r\n\r\nhttps://github.com/apache/rocketmq/blob/47561bdd855ab381113d736b5c26a09c08da590b/broker/src/main/java/org/apache/rocketmq/broker/BrokerController.java#L971","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094163501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094164675","html_url":"https://github.com/apache/rocketmq/issues/4137#issuecomment-1094164675","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4137","id":1094164675,"node_id":"IC_kwDOBHrsl85BN6DD","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T02:59:11Z","updated_at":"2022-04-10T02:59:11Z","author_association":"CONTRIBUTOR","body":"当transferMsgByHeap=false的时候，拉取消息会使用fileRegion的方式实现零拷贝\r\n\r\nhttps://github.com/apache/rocketmq/blob/47561bdd855ab381113d736b5c26a09c08da590b/broker/src/main/java/org/apache/rocketmq/broker/processor/PullMessageProcessor.java#L382-L408","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094164675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094164716","html_url":"https://github.com/apache/rocketmq/issues/4140#issuecomment-1094164716","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4140","id":1094164716,"node_id":"IC_kwDOBHrsl85BN6Ds","user":{"login":"sydcph","id":37522802,"node_id":"MDQ6VXNlcjM3NTIyODAy","avatar_url":"https://avatars.githubusercontent.com/u/37522802?v=4","gravatar_id":"","url":"https://api.github.com/users/sydcph","html_url":"https://github.com/sydcph","followers_url":"https://api.github.com/users/sydcph/followers","following_url":"https://api.github.com/users/sydcph/following{/other_user}","gists_url":"https://api.github.com/users/sydcph/gists{/gist_id}","starred_url":"https://api.github.com/users/sydcph/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sydcph/subscriptions","organizations_url":"https://api.github.com/users/sydcph/orgs","repos_url":"https://api.github.com/users/sydcph/repos","events_url":"https://api.github.com/users/sydcph/events{/privacy}","received_events_url":"https://api.github.com/users/sydcph/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T02:59:38Z","updated_at":"2022-04-10T02:59:38Z","author_association":"NONE","body":"这个可以通过改源码修改么，slave元数据复制也经过公网IP，平白增加了一层，还耗费网络流量，实在是不划算，而且感觉也不太安全。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094164716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094164986","html_url":"https://github.com/apache/rocketmq/issues/4140#issuecomment-1094164986","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4140","id":1094164986,"node_id":"IC_kwDOBHrsl85BN6H6","user":{"login":"RongtongJin","id":21963954,"node_id":"MDQ6VXNlcjIxOTYzOTU0","avatar_url":"https://avatars.githubusercontent.com/u/21963954?v=4","gravatar_id":"","url":"https://api.github.com/users/RongtongJin","html_url":"https://github.com/RongtongJin","followers_url":"https://api.github.com/users/RongtongJin/followers","following_url":"https://api.github.com/users/RongtongJin/following{/other_user}","gists_url":"https://api.github.com/users/RongtongJin/gists{/gist_id}","starred_url":"https://api.github.com/users/RongtongJin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RongtongJin/subscriptions","organizations_url":"https://api.github.com/users/RongtongJin/orgs","repos_url":"https://api.github.com/users/RongtongJin/repos","events_url":"https://api.github.com/users/RongtongJin/events{/privacy}","received_events_url":"https://api.github.com/users/RongtongJin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T03:02:18Z","updated_at":"2022-04-10T03:02:18Z","author_association":"CONTRIBUTOR","body":"> rocketmq/broker/src/main/java/org/apache/rocketmq/broker/BrokerController.java\r\n\r\n源码上应该把`this.slaveSynchronize.setMasterAddr(registerBrokerResult.getMasterAddr());`改为`this.slaveSynchronize.setMasterAddr(registerBrokerResult.getHaServerAddr());`就可以。\r\n不过长久以来都是使用brokerIP1的，需要讨论下\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094164986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094165490","html_url":"https://github.com/apache/rocketmq/issues/4140#issuecomment-1094165490","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4140","id":1094165490,"node_id":"IC_kwDOBHrsl85BN6Py","user":{"login":"sydcph","id":37522802,"node_id":"MDQ6VXNlcjM3NTIyODAy","avatar_url":"https://avatars.githubusercontent.com/u/37522802?v=4","gravatar_id":"","url":"https://api.github.com/users/sydcph","html_url":"https://github.com/sydcph","followers_url":"https://api.github.com/users/sydcph/followers","following_url":"https://api.github.com/users/sydcph/following{/other_user}","gists_url":"https://api.github.com/users/sydcph/gists{/gist_id}","starred_url":"https://api.github.com/users/sydcph/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sydcph/subscriptions","organizations_url":"https://api.github.com/users/sydcph/orgs","repos_url":"https://api.github.com/users/sydcph/repos","events_url":"https://api.github.com/users/sydcph/events{/privacy}","received_events_url":"https://api.github.com/users/sydcph/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T03:07:23Z","updated_at":"2022-04-10T03:07:23Z","author_association":"NONE","body":"那有其他方法解决 消息生产者Producer在外网，如果不设置brokerIP的情况下，Producer从namesrv上获取的是内网IP的问题么？","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094165490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094168474","html_url":"https://github.com/apache/rocketmq/issues/4137#issuecomment-1094168474","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4137","id":1094168474,"node_id":"IC_kwDOBHrsl85BN6-a","user":{"login":"AdventurerJohn","id":49260621,"node_id":"MDQ6VXNlcjQ5MjYwNjIx","avatar_url":"https://avatars.githubusercontent.com/u/49260621?v=4","gravatar_id":"","url":"https://api.github.com/users/AdventurerJohn","html_url":"https://github.com/AdventurerJohn","followers_url":"https://api.github.com/users/AdventurerJohn/followers","following_url":"https://api.github.com/users/AdventurerJohn/following{/other_user}","gists_url":"https://api.github.com/users/AdventurerJohn/gists{/gist_id}","starred_url":"https://api.github.com/users/AdventurerJohn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AdventurerJohn/subscriptions","organizations_url":"https://api.github.com/users/AdventurerJohn/orgs","repos_url":"https://api.github.com/users/AdventurerJohn/repos","events_url":"https://api.github.com/users/AdventurerJohn/events{/privacy}","received_events_url":"https://api.github.com/users/AdventurerJohn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T03:38:59Z","updated_at":"2022-04-10T03:38:59Z","author_association":"NONE","body":"> \r\n\r\n这是用了mmap，但是没有用到sendfile哇","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094168474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094170178","html_url":"https://github.com/apache/rocketmq/pull/4132#issuecomment-1094170178","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4132","id":1094170178,"node_id":"IC_kwDOBHrsl85BN7ZC","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T03:55:44Z","updated_at":"2022-04-10T03:57:34Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4132?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#4132](https://codecov.io/gh/apache/rocketmq/pull/4132?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (049abc2) into [develop](https://codecov.io/gh/apache/rocketmq/commit/fd554ab12072225325c957ff6bdf492fc67821af?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (fd554ab) will **increase** coverage by `0.08%`.\n> The diff coverage is `0.00%`.\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #4132      +/-   ##\n=============================================\n+ Coverage      47.92%   48.01%   +0.08%     \n- Complexity      5002     5011       +9     \n=============================================\n  Files            634      635       +1     \n  Lines          42529    42496      -33     \n  Branches        5573     5567       -6     \n=============================================\n+ Hits           20381    20403      +22     \n+ Misses         19647    19604      -43     \n+ Partials        2501     2489      -12     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/4132?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | |\n|---|---|---|\n| [...g/apache/rocketmq/client/impl/MQClientAPIImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9NUUNsaWVudEFQSUltcGwuamF2YQ==) | `13.98% <0.00%> (+0.11%)` | :arrow_up: |\n| [...ava/org/apache/rocketmq/test/util/VerifyUtils.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-dGVzdC9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvdGVzdC91dGlsL1ZlcmlmeVV0aWxzLmphdmE=) | `46.26% <0.00%> (-2.99%)` | :arrow_down: |\n| [...ava/org/apache/rocketmq/filter/util/BitsArray.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CaXRzQXJyYXkuamF2YQ==) | `59.82% <0.00%> (-2.57%)` | :arrow_down: |\n| [...mq/client/impl/consumer/RebalanceLitePullImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9SZWJhbGFuY2VMaXRlUHVsbEltcGwuamF2YQ==) | `72.05% <0.00%> (-1.48%)` | :arrow_down: |\n| [...e/rocketmq/client/impl/consumer/RebalanceImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9SZWJhbGFuY2VJbXBsLmphdmE=) | `43.75% <0.00%> (-1.18%)` | :arrow_down: |\n| [...ketmq/common/protocol/body/RegisterBrokerBody.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vcHJvdG9jb2wvYm9keS9SZWdpc3RlckJyb2tlckJvZHkuamF2YQ==) | `83.69% <0.00%> (-1.09%)` | :arrow_down: |\n| [...he/rocketmq/client/impl/consumer/ProcessQueue.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9Qcm9jZXNzUXVldWUuamF2YQ==) | `61.92% <0.00%> (-0.46%)` | :arrow_down: |\n| [...mq/client/impl/producer/DefaultMQProducerImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9wcm9kdWNlci9EZWZhdWx0TVFQcm9kdWNlckltcGwuamF2YQ==) | `45.21% <0.00%> (-0.38%)` | :arrow_down: |\n| [...nt/impl/consumer/ConsumeMessageOrderlyService.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9Db25zdW1lTWVzc2FnZU9yZGVybHlTZXJ2aWNlLmphdmE=) | `50.00% <0.00%> (-0.36%)` | :arrow_down: |\n| [...ain/java/org/apache/rocketmq/store/MappedFile.java](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL01hcHBlZEZpbGUuamF2YQ==) | `51.40% <0.00%> (-0.36%)` | :arrow_down: |\n| ... and [15 more](https://codecov.io/gh/apache/rocketmq/pull/4132/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/4132?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4132?src=pr&el=footer&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Last update [fd554ab...049abc2](https://codecov.io/gh/apache/rocketmq/pull/4132?src=pr&el=lastupdated&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094170178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094170355","html_url":"https://github.com/apache/rocketmq/pull/4132#issuecomment-1094170355","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4132","id":1094170355,"node_id":"IC_kwDOBHrsl85BN7bz","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T03:57:24Z","updated_at":"2022-04-10T03:57:24Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48146190/badge)](https://coveralls.io/builds/48146190)\n\nCoverage increased (+0.2%) to 51.958% when pulling **049abc24342d8bc10c1b4e842b948c777235e72d on dugenkui03:patch-012** into **8745d4c538d5c96e65a56f6278029c5765e7d922 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094170355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094170356","html_url":"https://github.com/apache/rocketmq/pull/4132#issuecomment-1094170356","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4132","id":1094170356,"node_id":"IC_kwDOBHrsl85BN7b0","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T03:57:24Z","updated_at":"2022-04-10T03:57:24Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48146190/badge)](https://coveralls.io/builds/48146190)\n\nCoverage increased (+0.2%) to 51.958% when pulling **049abc24342d8bc10c1b4e842b948c777235e72d on dugenkui03:patch-012** into **8745d4c538d5c96e65a56f6278029c5765e7d922 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094170356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094171342","html_url":"https://github.com/apache/rocketmq/pull/4113#issuecomment-1094171342","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4113","id":1094171342,"node_id":"IC_kwDOBHrsl85BN7rO","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T04:05:15Z","updated_at":"2022-04-10T04:05:15Z","author_association":"CONTRIBUTOR","body":"@RongtongJin CI未通过因为单测超时，单测本地执行成功，请问这种情况需要如何处理。\r\n\r\n单测代码：\r\n```java\r\nboolean recvAll = MQWait.waitConsumeAll(30 * 1000, producer.getAllMsgBody(),\r\n            consumer1.getListener(), consumer2.getListener(), consumer3.getListener());\r\n        assertThat(recvAll).isEqualTo(true);\r\n```\r\n\r\n报错\r\n```java\r\nestThreeConsumerAndCrashOne(org.apache.rocketmq.test.client.producer.order.OrderMsgDynamicRebalanceIT)  \r\nTime elapsed: 32.405 sec  \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094171342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094171483","html_url":"https://github.com/apache/rocketmq/pull/4132#issuecomment-1094171483","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4132","id":1094171483,"node_id":"IC_kwDOBHrsl85BN7tb","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T04:06:01Z","updated_at":"2022-04-10T06:44:57Z","author_association":"CONTRIBUTOR","body":"> /home/travis/build/apache/rocketmq/srvutil/src/main/java/org/apache/rocketmq/srvutil/FileWatchService.java:26:8: error: Unused import - java.security.NoSuchAlgorithmException. Audit done.\r\n> \r\n> Hi, CI not pass\r\n\r\nThanks for your review, PR is updated.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094171483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094241263","html_url":"https://github.com/apache/rocketmq/issues/4140#issuecomment-1094241263","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4140","id":1094241263,"node_id":"IC_kwDOBHrsl85BOMvv","user":{"login":"MatrixHB","id":23614576,"node_id":"MDQ6VXNlcjIzNjE0NTc2","avatar_url":"https://avatars.githubusercontent.com/u/23614576?v=4","gravatar_id":"","url":"https://api.github.com/users/MatrixHB","html_url":"https://github.com/MatrixHB","followers_url":"https://api.github.com/users/MatrixHB/followers","following_url":"https://api.github.com/users/MatrixHB/following{/other_user}","gists_url":"https://api.github.com/users/MatrixHB/gists{/gist_id}","starred_url":"https://api.github.com/users/MatrixHB/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MatrixHB/subscriptions","organizations_url":"https://api.github.com/users/MatrixHB/orgs","repos_url":"https://api.github.com/users/MatrixHB/repos","events_url":"https://api.github.com/users/MatrixHB/events{/privacy}","received_events_url":"https://api.github.com/users/MatrixHB/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T10:37:41Z","updated_at":"2022-04-10T10:42:58Z","author_association":"CONTRIBUTOR","body":"> 那有其他方法解决 消息生产者Producer在外网，如果不设置brokerIP的情况下，Producer从namesrv上获取的是内网IP的问题么？\r\n\r\n开源rockermq的nameServer 尚不具备将内网IP映射成外网IP返回的能力，所以修改brokerIP1 是大部分开源实践者采取的做法，但确实引起你说的slave复制元数据会经过外网，您能否针对此issue提交一个PR，由社区同学review一下？","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094241263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094251213","html_url":"https://github.com/apache/rocketmq/issues/4139#issuecomment-1094251213","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4139","id":1094251213,"node_id":"IC_kwDOBHrsl85BOPLN","user":{"login":"MatrixHB","id":23614576,"node_id":"MDQ6VXNlcjIzNjE0NTc2","avatar_url":"https://avatars.githubusercontent.com/u/23614576?v=4","gravatar_id":"","url":"https://api.github.com/users/MatrixHB","html_url":"https://github.com/MatrixHB","followers_url":"https://api.github.com/users/MatrixHB/followers","following_url":"https://api.github.com/users/MatrixHB/following{/other_user}","gists_url":"https://api.github.com/users/MatrixHB/gists{/gist_id}","starred_url":"https://api.github.com/users/MatrixHB/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MatrixHB/subscriptions","organizations_url":"https://api.github.com/users/MatrixHB/orgs","repos_url":"https://api.github.com/users/MatrixHB/repos","events_url":"https://api.github.com/users/MatrixHB/events{/privacy}","received_events_url":"https://api.github.com/users/MatrixHB/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T11:32:44Z","updated_at":"2022-04-10T11:32:44Z","author_association":"CONTRIBUTOR","body":"The code shown above is not the latest develop branch. You can see this issue [ISSUE #1576](https://github.com/apache/rocketmq/issues/1576), which discussed about the problem you mentioned. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094251213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094269124","html_url":"https://github.com/apache/rocketmq/issues/4140#issuecomment-1094269124","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4140","id":1094269124,"node_id":"IC_kwDOBHrsl85BOTjE","user":{"login":"sydcph","id":37522802,"node_id":"MDQ6VXNlcjM3NTIyODAy","avatar_url":"https://avatars.githubusercontent.com/u/37522802?v=4","gravatar_id":"","url":"https://api.github.com/users/sydcph","html_url":"https://github.com/sydcph","followers_url":"https://api.github.com/users/sydcph/followers","following_url":"https://api.github.com/users/sydcph/following{/other_user}","gists_url":"https://api.github.com/users/sydcph/gists{/gist_id}","starred_url":"https://api.github.com/users/sydcph/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sydcph/subscriptions","organizations_url":"https://api.github.com/users/sydcph/orgs","repos_url":"https://api.github.com/users/sydcph/repos","events_url":"https://api.github.com/users/sydcph/events{/privacy}","received_events_url":"https://api.github.com/users/sydcph/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T13:02:45Z","updated_at":"2022-04-10T13:06:20Z","author_association":"NONE","body":"\r\n> > 那有其他方法解决 消息生产者Producer在外网，如果不设置brokerIP的情况下，Producer从namesrv上获取的是内网IP的问题么？\r\n> \r\n> 开源rockermq的nameServer 尚不具备将内网IP映射成外网IP返回的能力，所以修改brokerIP1 是大部分开源实践者采取的做法，但确实引起你说的slave复制元数据会经过外网，您能否针对此issue提交一个PR，由社区同学review一下？\r\n\r\n我不是开发，不知道怎么搞，我想到一个办法，brokerIP1使用域名，slave主机和master主机分开，slave主机上使用本地host，解析到hosts里\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094269124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094273446","html_url":"https://github.com/apache/rocketmq/issues/4137#issuecomment-1094273446","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4137","id":1094273446,"node_id":"IC_kwDOBHrsl85BOUmm","user":{"login":"MatrixHB","id":23614576,"node_id":"MDQ6VXNlcjIzNjE0NTc2","avatar_url":"https://avatars.githubusercontent.com/u/23614576?v=4","gravatar_id":"","url":"https://api.github.com/users/MatrixHB","html_url":"https://github.com/MatrixHB","followers_url":"https://api.github.com/users/MatrixHB/followers","following_url":"https://api.github.com/users/MatrixHB/following{/other_user}","gists_url":"https://api.github.com/users/MatrixHB/gists{/gist_id}","starred_url":"https://api.github.com/users/MatrixHB/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MatrixHB/subscriptions","organizations_url":"https://api.github.com/users/MatrixHB/orgs","repos_url":"https://api.github.com/users/MatrixHB/repos","events_url":"https://api.github.com/users/MatrixHB/events{/privacy}","received_events_url":"https://api.github.com/users/MatrixHB/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T13:16:53Z","updated_at":"2022-04-10T13:18:12Z","author_association":"CONTRIBUTOR","body":"> > \r\n> \r\n> 这是用了mmap，但是没有用到sendfile哇\r\n\r\n是的，这里ManyMessageTransfer重写了DefaultFileRegion的transferTo()方法，还是使用mmap，没有使用sendfile。曾经有个PR就对此做了修改：[#1933](https://github.com/apache/rocketmq/pull/1933)\r\n\r\n使用sendfile代替mmap，对读写性能会有多大的提升，是否带来其他的问题，未有定论。如果你有余力可以尝试优化和测试一把，可以加入rocketmq的性能优化SIG进一步探讨。\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094273446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094278530","html_url":"https://github.com/apache/rocketmq/pull/4138#issuecomment-1094278530","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4138","id":1094278530,"node_id":"IC_kwDOBHrsl85BOV2C","user":{"login":"MatrixHB","id":23614576,"node_id":"MDQ6VXNlcjIzNjE0NTc2","avatar_url":"https://avatars.githubusercontent.com/u/23614576?v=4","gravatar_id":"","url":"https://api.github.com/users/MatrixHB","html_url":"https://github.com/MatrixHB","followers_url":"https://api.github.com/users/MatrixHB/followers","following_url":"https://api.github.com/users/MatrixHB/following{/other_user}","gists_url":"https://api.github.com/users/MatrixHB/gists{/gist_id}","starred_url":"https://api.github.com/users/MatrixHB/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MatrixHB/subscriptions","organizations_url":"https://api.github.com/users/MatrixHB/orgs","repos_url":"https://api.github.com/users/MatrixHB/repos","events_url":"https://api.github.com/users/MatrixHB/events{/privacy}","received_events_url":"https://api.github.com/users/MatrixHB/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T13:47:29Z","updated_at":"2022-04-10T13:48:20Z","author_association":"CONTRIBUTOR","body":"Why not use ConcurrentHashMap instead of HashMap？Using ConcurrentHashMap, no need to lock when reading, and the scope of locking is smaller when writing.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094278530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094280499","html_url":"https://github.com/apache/rocketmq/issues/4142#issuecomment-1094280499","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4142","id":1094280499,"node_id":"IC_kwDOBHrsl85BOWUz","user":{"login":"MatrixHB","id":23614576,"node_id":"MDQ6VXNlcjIzNjE0NTc2","avatar_url":"https://avatars.githubusercontent.com/u/23614576?v=4","gravatar_id":"","url":"https://api.github.com/users/MatrixHB","html_url":"https://github.com/MatrixHB","followers_url":"https://api.github.com/users/MatrixHB/followers","following_url":"https://api.github.com/users/MatrixHB/following{/other_user}","gists_url":"https://api.github.com/users/MatrixHB/gists{/gist_id}","starred_url":"https://api.github.com/users/MatrixHB/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MatrixHB/subscriptions","organizations_url":"https://api.github.com/users/MatrixHB/orgs","repos_url":"https://api.github.com/users/MatrixHB/repos","events_url":"https://api.github.com/users/MatrixHB/events{/privacy}","received_events_url":"https://api.github.com/users/MatrixHB/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T13:57:46Z","updated_at":"2022-04-10T13:57:46Z","author_association":"CONTRIBUTOR","body":"[#4138](https://github.com/apache/rocketmq/pull/4138)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094280499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094282140","html_url":"https://github.com/apache/rocketmq/issues/4143#issuecomment-1094282140","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4143","id":1094282140,"node_id":"IC_kwDOBHrsl85BOWuc","user":{"login":"MatrixHB","id":23614576,"node_id":"MDQ6VXNlcjIzNjE0NTc2","avatar_url":"https://avatars.githubusercontent.com/u/23614576?v=4","gravatar_id":"","url":"https://api.github.com/users/MatrixHB","html_url":"https://github.com/MatrixHB","followers_url":"https://api.github.com/users/MatrixHB/followers","following_url":"https://api.github.com/users/MatrixHB/following{/other_user}","gists_url":"https://api.github.com/users/MatrixHB/gists{/gist_id}","starred_url":"https://api.github.com/users/MatrixHB/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MatrixHB/subscriptions","organizations_url":"https://api.github.com/users/MatrixHB/orgs","repos_url":"https://api.github.com/users/MatrixHB/repos","events_url":"https://api.github.com/users/MatrixHB/events{/privacy}","received_events_url":"https://api.github.com/users/MatrixHB/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T14:04:30Z","updated_at":"2022-04-10T14:04:30Z","author_association":"CONTRIBUTOR","body":"[#4135 ](https://github.com/apache/rocketmq/pull/4135)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094282140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094296953","html_url":"https://github.com/apache/rocketmq/pull/4138#issuecomment-1094296953","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4138","id":1094296953,"node_id":"IC_kwDOBHrsl85BOaV5","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-10T15:26:10Z","updated_at":"2022-04-10T15:29:54Z","author_association":"CONTRIBUTOR","body":"> Why not use ConcurrentHashMap instead of HashMap？Using ConcurrentHashMap, no need to lock when reading, and the scope of locking is smaller when writing.\r\n\r\nThat's my opinion: Do as little as possible to fix mistakes.\r\n\r\n# describe in Chinese\r\n我习惯做尽可能少的事情去修正bug，尽量不去破坏原有的设计。\r\n\r\n这里使用`synchronized`的原因也许是jvm对`synchronized`加锁进行了优化：如果加锁代码块没有真实的发生多线程并发访问，则永远不会真正的加锁。我简单跟踪了下代码，应该是这个原因。\r\n<img width=\"1177\" alt=\"image\" src=\"https://user-images.githubusercontent.com/18216266/162627024-8459f20e-ec9c-4e75-bac4-da0c5140ab8d.png\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094296953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094452306","html_url":"https://github.com/apache/rocketmq/issues/4137#issuecomment-1094452306","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4137","id":1094452306,"node_id":"IC_kwDOBHrsl85BPARS","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T01:29:36Z","updated_at":"2022-04-11T01:34:27Z","author_association":"CONTRIBUTOR","body":"> > \r\n> \r\n> 这是用了mmap，但是没有用到sendfile哇\r\n\r\n嗯，具体实现没有调用FileChannel的transferTo方法，还是mmap。\r\n我认为应该是rocketmq存储结构的原因，commitlog是多个topic读写，也就是针对单个topic读是小块文件。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094452306/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094458602","html_url":"https://github.com/apache/rocketmq/pull/4141#issuecomment-1094458602","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4141","id":1094458602,"node_id":"IC_kwDOBHrsl85BPBzq","user":{"login":"vongosling","id":635581,"node_id":"MDQ6VXNlcjYzNTU4MQ==","avatar_url":"https://avatars.githubusercontent.com/u/635581?v=4","gravatar_id":"","url":"https://api.github.com/users/vongosling","html_url":"https://github.com/vongosling","followers_url":"https://api.github.com/users/vongosling/followers","following_url":"https://api.github.com/users/vongosling/following{/other_user}","gists_url":"https://api.github.com/users/vongosling/gists{/gist_id}","starred_url":"https://api.github.com/users/vongosling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vongosling/subscriptions","organizations_url":"https://api.github.com/users/vongosling/orgs","repos_url":"https://api.github.com/users/vongosling/repos","events_url":"https://api.github.com/users/vongosling/events{/privacy}","received_events_url":"https://api.github.com/users/vongosling/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T01:41:27Z","updated_at":"2022-04-11T01:41:27Z","author_association":"MEMBER","body":"@gogodjzhu @dugenkui03 very much appreciate your careful revision :-) I hope to see more of you in the community.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094458602/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094487850","html_url":"https://github.com/apache/rocketmq/issues/4137#issuecomment-1094487850","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4137","id":1094487850,"node_id":"IC_kwDOBHrsl85BPI8q","user":{"login":"cserwen","id":46882838,"node_id":"MDQ6VXNlcjQ2ODgyODM4","avatar_url":"https://avatars.githubusercontent.com/u/46882838?v=4","gravatar_id":"","url":"https://api.github.com/users/cserwen","html_url":"https://github.com/cserwen","followers_url":"https://api.github.com/users/cserwen/followers","following_url":"https://api.github.com/users/cserwen/following{/other_user}","gists_url":"https://api.github.com/users/cserwen/gists{/gist_id}","starred_url":"https://api.github.com/users/cserwen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cserwen/subscriptions","organizations_url":"https://api.github.com/users/cserwen/orgs","repos_url":"https://api.github.com/users/cserwen/repos","events_url":"https://api.github.com/users/cserwen/events{/privacy}","received_events_url":"https://api.github.com/users/cserwen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T02:45:02Z","updated_at":"2022-04-11T02:45:02Z","author_association":"MEMBER","body":"我理解是这样的，RocketMQ一个CommitLog会有多个Topic的消息，服务端需要做查找过滤，也就是需要对磁盘文件读取出来的结果做加工再返回，而Kafka一个segment文件是partition级别的，不需要处理直接返回给客户端就行，所以用sendfile会更合适:-D\r\n\r\n当然，我觉得也可以进行优化和测试，看看会有什么样的提升。","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094487850/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094601612","html_url":"https://github.com/apache/rocketmq/pull/4146#issuecomment-1094601612","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4146","id":1094601612,"node_id":"IC_kwDOBHrsl85BPkuM","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T06:27:08Z","updated_at":"2022-04-25T07:04:10Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48525156/badge)](https://coveralls.io/builds/48525156)\n\nCoverage decreased (-0.002%) to 52.091% when pulling **39f8a7a220316ee9a06d231cf7347e994ac856e7 on XiaoyiPeng:issue#4145** into **5d0102396031b728f9accfa5a562fe20906ac424 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094601612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094642446","html_url":"https://github.com/apache/rocketmq/pull/4141#issuecomment-1094642446","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4141","id":1094642446,"node_id":"IC_kwDOBHrsl85BPusO","user":{"login":"gogodjzhu","id":5836099,"node_id":"MDQ6VXNlcjU4MzYwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/5836099?v=4","gravatar_id":"","url":"https://api.github.com/users/gogodjzhu","html_url":"https://github.com/gogodjzhu","followers_url":"https://api.github.com/users/gogodjzhu/followers","following_url":"https://api.github.com/users/gogodjzhu/following{/other_user}","gists_url":"https://api.github.com/users/gogodjzhu/gists{/gist_id}","starred_url":"https://api.github.com/users/gogodjzhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gogodjzhu/subscriptions","organizations_url":"https://api.github.com/users/gogodjzhu/orgs","repos_url":"https://api.github.com/users/gogodjzhu/repos","events_url":"https://api.github.com/users/gogodjzhu/events{/privacy}","received_events_url":"https://api.github.com/users/gogodjzhu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T07:20:39Z","updated_at":"2022-04-11T07:20:39Z","author_association":"CONTRIBUTOR","body":"Fresher in the town :) Thanks for the suggestions and changes has been commited. @dugenkui03 @vongosling @yuz10 ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094642446/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094675932","html_url":"https://github.com/apache/rocketmq/pull/4141#issuecomment-1094675932","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4141","id":1094675932,"node_id":"IC_kwDOBHrsl85BP23c","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:01:38Z","updated_at":"2022-04-11T08:01:38Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48159164/badge)](https://coveralls.io/builds/48159164)\n\nCoverage decreased (-0.08%) to 51.884% when pulling **6a19470548260768a3a1e6618bd031f912e3d8b5 on gogodjzhu:fix-spelling-patch** into **ead6274b3e8016ee2fa75cf0dc201b5581ee7a34 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094675932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094675941","html_url":"https://github.com/apache/rocketmq/pull/4141#issuecomment-1094675941","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4141","id":1094675941,"node_id":"IC_kwDOBHrsl85BP23l","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:01:38Z","updated_at":"2022-04-11T08:01:38Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48159164/badge)](https://coveralls.io/builds/48159164)\n\nCoverage decreased (-0.08%) to 51.884% when pulling **6a19470548260768a3a1e6618bd031f912e3d8b5 on gogodjzhu:fix-spelling-patch** into **ead6274b3e8016ee2fa75cf0dc201b5581ee7a34 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094675941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094710102","html_url":"https://github.com/apache/rocketmq/pull/4148#issuecomment-1094710102","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4148","id":1094710102,"node_id":"IC_kwDOBHrsl85BP_NW","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:35:05Z","updated_at":"2022-04-11T08:35:05Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4148?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#4148](https://codecov.io/gh/apache/rocketmq/pull/4148?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (ef82116) into [develop](https://codecov.io/gh/apache/rocketmq/commit/ead6274b3e8016ee2fa75cf0dc201b5581ee7a34?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (ead6274) will **decrease** coverage by `0.23%`.\n> The diff coverage is `n/a`.\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #4148      +/-   ##\n=============================================\n- Coverage      48.00%   47.76%   -0.24%     \n+ Complexity      5010     4979      -31     \n=============================================\n  Files            635      635              \n  Lines          42506    42506              \n  Branches        5567     5567              \n=============================================\n- Hits           20405    20304     -101     \n- Misses         19609    19709     +100     \n- Partials        2492     2493       +1     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/4148?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | |\n|---|---|---|\n| [...he/rocketmq/client/producer/DefaultMQProducer.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvcHJvZHVjZXIvRGVmYXVsdE1RUHJvZHVjZXIuamF2YQ==) | `57.34% <ø> (ø)` | |\n| [...org/apache/rocketmq/store/ha/WaitNotifyObject.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL2hhL1dhaXROb3RpZnlPYmplY3QuamF2YQ==) | `66.07% <0.00%> (-5.36%)` | :arrow_down: |\n| [...apache/rocketmq/remoting/netty/ResponseFuture.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L1Jlc3BvbnNlRnV0dXJlLmphdmE=) | `85.00% <0.00%> (-5.00%)` | :arrow_down: |\n| [...rocketmq/remoting/netty/NettyRemotingAbstract.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-cmVtb3Rpbmcvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3JlbW90aW5nL25ldHR5L05ldHR5UmVtb3RpbmdBYnN0cmFjdC5qYXZh) | `46.88% <0.00%> (-4.03%)` | :arrow_down: |\n| [...e/rocketmq/client/impl/consumer/RebalanceImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9SZWJhbGFuY2VJbXBsLmphdmE=) | `40.23% <0.00%> (-3.52%)` | :arrow_down: |\n| [...nt/impl/consumer/ConsumeMessageOrderlyService.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9Db25zdW1lTWVzc2FnZU9yZGVybHlTZXJ2aWNlLmphdmE=) | `46.83% <0.00%> (-3.17%)` | :arrow_down: |\n| [...lient/impl/consumer/DefaultMQPushConsumerImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9EZWZhdWx0TVFQdXNoQ29uc3VtZXJJbXBsLmphdmE=) | `41.05% <0.00%> (-2.99%)` | :arrow_down: |\n| [...ava/org/apache/rocketmq/filter/util/BitsArray.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-ZmlsdGVyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9maWx0ZXIvdXRpbC9CaXRzQXJyYXkuamF2YQ==) | `59.82% <0.00%> (-2.57%)` | :arrow_down: |\n| [...va/org/apache/rocketmq/logging/inner/Appender.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-bG9nZ2luZy9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbG9nZ2luZy9pbm5lci9BcHBlbmRlci5qYXZh) | `34.83% <0.00%> (-2.25%)` | :arrow_down: |\n| [...rocketmq/client/impl/factory/MQClientInstance.java](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9mYWN0b3J5L01RQ2xpZW50SW5zdGFuY2UuamF2YQ==) | `49.31% <0.00%> (-1.98%)` | :arrow_down: |\n| ... and [12 more](https://codecov.io/gh/apache/rocketmq/pull/4148/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/4148?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4148?src=pr&el=footer&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Last update [ead6274...ef82116](https://codecov.io/gh/apache/rocketmq/pull/4148?src=pr&el=lastupdated&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094710102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094710547","html_url":"https://github.com/apache/rocketmq/pull/4141#issuecomment-1094710547","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4141","id":1094710547,"node_id":"IC_kwDOBHrsl85BP_UT","user":{"login":"vongosling","id":635581,"node_id":"MDQ6VXNlcjYzNTU4MQ==","avatar_url":"https://avatars.githubusercontent.com/u/635581?v=4","gravatar_id":"","url":"https://api.github.com/users/vongosling","html_url":"https://github.com/vongosling","followers_url":"https://api.github.com/users/vongosling/followers","following_url":"https://api.github.com/users/vongosling/following{/other_user}","gists_url":"https://api.github.com/users/vongosling/gists{/gist_id}","starred_url":"https://api.github.com/users/vongosling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vongosling/subscriptions","organizations_url":"https://api.github.com/users/vongosling/orgs","repos_url":"https://api.github.com/users/vongosling/repos","events_url":"https://api.github.com/users/vongosling/events{/privacy}","received_events_url":"https://api.github.com/users/vongosling/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:35:33Z","updated_at":"2022-04-11T08:35:33Z","author_association":"MEMBER","body":"The last step. It would be helpful to create a related issue and associate with it, just like others do. It is also our basic community requirements :-)","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094710547/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094712999","html_url":"https://github.com/apache/rocketmq/pull/4146#issuecomment-1094712999","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4146","id":1094712999,"node_id":"IC_kwDOBHrsl85BP_6n","user":{"login":"vongosling","id":635581,"node_id":"MDQ6VXNlcjYzNTU4MQ==","avatar_url":"https://avatars.githubusercontent.com/u/635581?v=4","gravatar_id":"","url":"https://api.github.com/users/vongosling","html_url":"https://github.com/vongosling","followers_url":"https://api.github.com/users/vongosling/followers","following_url":"https://api.github.com/users/vongosling/following{/other_user}","gists_url":"https://api.github.com/users/vongosling/gists{/gist_id}","starred_url":"https://api.github.com/users/vongosling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vongosling/subscriptions","organizations_url":"https://api.github.com/users/vongosling/orgs","repos_url":"https://api.github.com/users/vongosling/repos","events_url":"https://api.github.com/users/vongosling/events{/privacy}","received_events_url":"https://api.github.com/users/vongosling/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:38:05Z","updated_at":"2022-04-11T08:38:05Z","author_association":"MEMBER","body":"why not follow correct like you ever done https://github.com/apache/rocketmq/pull/4148\r\n\r\nISSUE first, PR linked it. ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094712999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094721283","html_url":"https://github.com/apache/rocketmq/pull/4146#issuecomment-1094721283","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4146","id":1094721283,"node_id":"IC_kwDOBHrsl85BQB8D","user":{"login":"XiaoyiPeng","id":8653312,"node_id":"MDQ6VXNlcjg2NTMzMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8653312?v=4","gravatar_id":"","url":"https://api.github.com/users/XiaoyiPeng","html_url":"https://github.com/XiaoyiPeng","followers_url":"https://api.github.com/users/XiaoyiPeng/followers","following_url":"https://api.github.com/users/XiaoyiPeng/following{/other_user}","gists_url":"https://api.github.com/users/XiaoyiPeng/gists{/gist_id}","starred_url":"https://api.github.com/users/XiaoyiPeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XiaoyiPeng/subscriptions","organizations_url":"https://api.github.com/users/XiaoyiPeng/orgs","repos_url":"https://api.github.com/users/XiaoyiPeng/repos","events_url":"https://api.github.com/users/XiaoyiPeng/events{/privacy}","received_events_url":"https://api.github.com/users/XiaoyiPeng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:43:30Z","updated_at":"2022-04-11T08:43:30Z","author_association":"CONTRIBUTOR","body":"> why not follow correct like you ever done #4148\r\n> \r\n> ISSUE first, PR linked it.\r\n\r\nThanks for your review.\r\nI've corrected  it, ^_^","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094721283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094738569","html_url":"https://github.com/apache/rocketmq/pull/4146#issuecomment-1094738569","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4146","id":1094738569,"node_id":"IC_kwDOBHrsl85BQGKJ","user":{"login":"panzhi33","id":29321745,"node_id":"MDQ6VXNlcjI5MzIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/29321745?v=4","gravatar_id":"","url":"https://api.github.com/users/panzhi33","html_url":"https://github.com/panzhi33","followers_url":"https://api.github.com/users/panzhi33/followers","following_url":"https://api.github.com/users/panzhi33/following{/other_user}","gists_url":"https://api.github.com/users/panzhi33/gists{/gist_id}","starred_url":"https://api.github.com/users/panzhi33/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panzhi33/subscriptions","organizations_url":"https://api.github.com/users/panzhi33/orgs","repos_url":"https://api.github.com/users/panzhi33/repos","events_url":"https://api.github.com/users/panzhi33/events{/privacy}","received_events_url":"https://api.github.com/users/panzhi33/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:52:13Z","updated_at":"2022-04-11T08:52:13Z","author_association":"CONTRIBUTOR","body":"IMO,sendOneway is aimed at the producer and cannot be guaranteed to be consumed at most once","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094738569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094746507","html_url":"https://github.com/apache/rocketmq/pull/4146#issuecomment-1094746507","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4146","id":1094746507,"node_id":"IC_kwDOBHrsl85BQIGL","user":{"login":"XiaoyiPeng","id":8653312,"node_id":"MDQ6VXNlcjg2NTMzMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8653312?v=4","gravatar_id":"","url":"https://api.github.com/users/XiaoyiPeng","html_url":"https://github.com/XiaoyiPeng","followers_url":"https://api.github.com/users/XiaoyiPeng/followers","following_url":"https://api.github.com/users/XiaoyiPeng/following{/other_user}","gists_url":"https://api.github.com/users/XiaoyiPeng/gists{/gist_id}","starred_url":"https://api.github.com/users/XiaoyiPeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XiaoyiPeng/subscriptions","organizations_url":"https://api.github.com/users/XiaoyiPeng/orgs","repos_url":"https://api.github.com/users/XiaoyiPeng/repos","events_url":"https://api.github.com/users/XiaoyiPeng/events{/privacy}","received_events_url":"https://api.github.com/users/XiaoyiPeng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T08:55:58Z","updated_at":"2022-04-11T08:55:58Z","author_association":"CONTRIBUTOR","body":"> IMO,sendOneway is aimed at the producer and cannot be guaranteed to be consumed at most once\r\n\r\nYeah, Sir. \r\nSo there's no mention about consumers in this PR.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094746507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094767621","html_url":"https://github.com/apache/rocketmq/pull/4146#issuecomment-1094767621","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4146","id":1094767621,"node_id":"IC_kwDOBHrsl85BQNQF","user":{"login":"XiaoyiPeng","id":8653312,"node_id":"MDQ6VXNlcjg2NTMzMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8653312?v=4","gravatar_id":"","url":"https://api.github.com/users/XiaoyiPeng","html_url":"https://github.com/XiaoyiPeng","followers_url":"https://api.github.com/users/XiaoyiPeng/followers","following_url":"https://api.github.com/users/XiaoyiPeng/following{/other_user}","gists_url":"https://api.github.com/users/XiaoyiPeng/gists{/gist_id}","starred_url":"https://api.github.com/users/XiaoyiPeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XiaoyiPeng/subscriptions","organizations_url":"https://api.github.com/users/XiaoyiPeng/orgs","repos_url":"https://api.github.com/users/XiaoyiPeng/repos","events_url":"https://api.github.com/users/XiaoyiPeng/events{/privacy}","received_events_url":"https://api.github.com/users/XiaoyiPeng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T09:06:36Z","updated_at":"2022-04-12T00:56:39Z","author_association":"CONTRIBUTOR","body":"> IMO,sendOneway is aimed at the producer and cannot be guaranteed to be consumed at most once\r\n\r\nThis PR came to mind when I read about [idempotent producer](https://cwiki.apache.org/confluence/display/KAFKA/Idempotent+Producer) in Kafka:\r\n\r\n- [https://kafka.apache.org/documentation/#semantics](https://kafka.apache.org/documentation/#semantics)\r\n- [KIP-98](https://cwiki.apache.org/confluence/display/KAFKA/KIP-98+-+Exactly+Once+Delivery+and+Transactional+Messaging)\r\n\r\n And I think in the future, RocketMQ could consider implementing the semantics of Exactly One transport with a better design.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094767621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094827468","html_url":"https://github.com/apache/rocketmq/issues/4142#issuecomment-1094827468","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4142","id":1094827468,"node_id":"IC_kwDOBHrsl85BQb3M","user":{"login":"ni-ze","id":31175234,"node_id":"MDQ6VXNlcjMxMTc1MjM0","avatar_url":"https://avatars.githubusercontent.com/u/31175234?v=4","gravatar_id":"","url":"https://api.github.com/users/ni-ze","html_url":"https://github.com/ni-ze","followers_url":"https://api.github.com/users/ni-ze/followers","following_url":"https://api.github.com/users/ni-ze/following{/other_user}","gists_url":"https://api.github.com/users/ni-ze/gists{/gist_id}","starred_url":"https://api.github.com/users/ni-ze/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ni-ze/subscriptions","organizations_url":"https://api.github.com/users/ni-ze/orgs","repos_url":"https://api.github.com/users/ni-ze/repos","events_url":"https://api.github.com/users/ni-ze/events{/privacy}","received_events_url":"https://api.github.com/users/ni-ze/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T09:45:02Z","updated_at":"2022-04-11T09:45:02Z","author_association":"CONTRIBUTOR","body":"IMO,   there is no problem,  use synchronized just protect HaspMap.put. In your case, one thread get data which update by another is correct, it just get the latest value.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1094827468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095005719","html_url":"https://github.com/apache/rocketmq/pull/4141#issuecomment-1095005719","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4141","id":1095005719,"node_id":"IC_kwDOBHrsl85BRHYX","user":{"login":"gogodjzhu","id":5836099,"node_id":"MDQ6VXNlcjU4MzYwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/5836099?v=4","gravatar_id":"","url":"https://api.github.com/users/gogodjzhu","html_url":"https://github.com/gogodjzhu","followers_url":"https://api.github.com/users/gogodjzhu/followers","following_url":"https://api.github.com/users/gogodjzhu/following{/other_user}","gists_url":"https://api.github.com/users/gogodjzhu/gists{/gist_id}","starred_url":"https://api.github.com/users/gogodjzhu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gogodjzhu/subscriptions","organizations_url":"https://api.github.com/users/gogodjzhu/orgs","repos_url":"https://api.github.com/users/gogodjzhu/repos","events_url":"https://api.github.com/users/gogodjzhu/events{/privacy}","received_events_url":"https://api.github.com/users/gogodjzhu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-11T12:45:23Z","updated_at":"2022-04-11T12:49:49Z","author_association":"CONTRIBUTOR","body":"this pr is related to #4150\r\n\r\n@vongosling Next time will be issue first and pr follow.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095005719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095770711","html_url":"https://github.com/apache/rocketmq/issues/4149#issuecomment-1095770711","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4149","id":1095770711,"node_id":"IC_kwDOBHrsl85BUCJX","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T01:20:29Z","updated_at":"2022-04-12T01:20:29Z","author_association":"CONTRIBUTOR","body":"> send batch orderLyMessage\r\n\r\nThe batch sends to the same queue?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095770711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095860221","html_url":"https://github.com/apache/rocketmq/issues/4153#issuecomment-1095860221","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4153","id":1095860221,"node_id":"IC_kwDOBHrsl85BUX_9","user":{"login":"cserwen","id":46882838,"node_id":"MDQ6VXNlcjQ2ODgyODM4","avatar_url":"https://avatars.githubusercontent.com/u/46882838?v=4","gravatar_id":"","url":"https://api.github.com/users/cserwen","html_url":"https://github.com/cserwen","followers_url":"https://api.github.com/users/cserwen/followers","following_url":"https://api.github.com/users/cserwen/following{/other_user}","gists_url":"https://api.github.com/users/cserwen/gists{/gist_id}","starred_url":"https://api.github.com/users/cserwen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cserwen/subscriptions","organizations_url":"https://api.github.com/users/cserwen/orgs","repos_url":"https://api.github.com/users/cserwen/repos","events_url":"https://api.github.com/users/cserwen/events{/privacy}","received_events_url":"https://api.github.com/users/cserwen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T02:34:58Z","updated_at":"2022-04-12T02:34:58Z","author_association":"MEMBER","body":"@lizhiboo  @duhenglucky  It looks like implementing seconds delay messages is important for POP","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095860221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095875727","html_url":"https://github.com/apache/rocketmq/issues/4140#issuecomment-1095875727","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4140","id":1095875727,"node_id":"IC_kwDOBHrsl85BUbyP","user":{"login":"lizhimins","id":22487634,"node_id":"MDQ6VXNlcjIyNDg3NjM0","avatar_url":"https://avatars.githubusercontent.com/u/22487634?v=4","gravatar_id":"","url":"https://api.github.com/users/lizhimins","html_url":"https://github.com/lizhimins","followers_url":"https://api.github.com/users/lizhimins/followers","following_url":"https://api.github.com/users/lizhimins/following{/other_user}","gists_url":"https://api.github.com/users/lizhimins/gists{/gist_id}","starred_url":"https://api.github.com/users/lizhimins/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lizhimins/subscriptions","organizations_url":"https://api.github.com/users/lizhimins/orgs","repos_url":"https://api.github.com/users/lizhimins/repos","events_url":"https://api.github.com/users/lizhimins/events{/privacy}","received_events_url":"https://api.github.com/users/lizhimins/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T02:49:12Z","updated_at":"2022-04-12T02:49:22Z","author_association":"MEMBER","body":"可以在 Namesrv 上修改，对 TopicRouteData 进行映射","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095875727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095921716","html_url":"https://github.com/apache/rocketmq/issues/4149#issuecomment-1095921716","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4149","id":1095921716,"node_id":"IC_kwDOBHrsl85BUnA0","user":{"login":"fengxueyun","id":13745786,"node_id":"MDQ6VXNlcjEzNzQ1Nzg2","avatar_url":"https://avatars.githubusercontent.com/u/13745786?v=4","gravatar_id":"","url":"https://api.github.com/users/fengxueyun","html_url":"https://github.com/fengxueyun","followers_url":"https://api.github.com/users/fengxueyun/followers","following_url":"https://api.github.com/users/fengxueyun/following{/other_user}","gists_url":"https://api.github.com/users/fengxueyun/gists{/gist_id}","starred_url":"https://api.github.com/users/fengxueyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengxueyun/subscriptions","organizations_url":"https://api.github.com/users/fengxueyun/orgs","repos_url":"https://api.github.com/users/fengxueyun/repos","events_url":"https://api.github.com/users/fengxueyun/events{/privacy}","received_events_url":"https://api.github.com/users/fengxueyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T03:24:48Z","updated_at":"2022-04-12T03:24:48Z","author_association":"NONE","body":"I want to send messages in batches, and implement queue segmentation according to a certain attribute, so as to realize the implementation order of the same value of the attribute, that is, the sequential consumption when consuming","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1095921716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096312603","html_url":"https://github.com/apache/rocketmq/pull/4148#issuecomment-1096312603","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4148","id":1096312603,"node_id":"IC_kwDOBHrsl85BWGcb","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T08:05:20Z","updated_at":"2022-04-12T08:05:20Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48199529/badge)](https://coveralls.io/builds/48199529)\n\nCoverage increased (+0.03%) to 51.997% when pulling **a9ec4fc26c94b14ad197a1a4f6c0b33becea489a on XiaoyiPeng:polish_javadoc_of_DefaultMQProducer** into **ead6274b3e8016ee2fa75cf0dc201b5581ee7a34 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096312603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096312614","html_url":"https://github.com/apache/rocketmq/pull/4148#issuecomment-1096312614","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4148","id":1096312614,"node_id":"IC_kwDOBHrsl85BWGcm","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T08:05:20Z","updated_at":"2022-04-12T08:05:20Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48199529/badge)](https://coveralls.io/builds/48199529)\n\nCoverage increased (+0.03%) to 51.997% when pulling **a9ec4fc26c94b14ad197a1a4f6c0b33becea489a on XiaoyiPeng:polish_javadoc_of_DefaultMQProducer** into **ead6274b3e8016ee2fa75cf0dc201b5581ee7a34 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096312614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096318803","html_url":"https://github.com/apache/rocketmq/issues/4149#issuecomment-1096318803","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4149","id":1096318803,"node_id":"IC_kwDOBHrsl85BWH9T","user":{"login":"panzhi33","id":29321745,"node_id":"MDQ6VXNlcjI5MzIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/29321745?v=4","gravatar_id":"","url":"https://api.github.com/users/panzhi33","html_url":"https://github.com/panzhi33","followers_url":"https://api.github.com/users/panzhi33/followers","following_url":"https://api.github.com/users/panzhi33/following{/other_user}","gists_url":"https://api.github.com/users/panzhi33/gists{/gist_id}","starred_url":"https://api.github.com/users/panzhi33/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panzhi33/subscriptions","organizations_url":"https://api.github.com/users/panzhi33/orgs","repos_url":"https://api.github.com/users/panzhi33/repos","events_url":"https://api.github.com/users/panzhi33/events{/privacy}","received_events_url":"https://api.github.com/users/panzhi33/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T08:08:55Z","updated_at":"2022-04-12T08:08:55Z","author_association":"CONTRIBUTOR","body":"org.apache.rocketmq.client.producer.DefaultMQProducer#send(java.util.Collection<org.apache.rocketmq.common.message.Message>, org.apache.rocketmq.common.message.MessageQueue)\r\nSee if this method meets your needs","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096318803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096547854","html_url":"https://github.com/apache/rocketmq/issues/4149#issuecomment-1096547854","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4149","id":1096547854,"node_id":"IC_kwDOBHrsl85BW_4O","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T10:33:55Z","updated_at":"2022-04-12T10:34:51Z","author_association":"CONTRIBUTOR","body":"You can use the solution @panzhi33 mentioned. You need to pay attention, you can not have delay messages in the batch.\r\n\r\nIn addition, if you want to guarantee absolute order when consuming, you need to implement MessageListenerOrderly,\r\n\r\nThere is a risk use MessageListenerOrderly that if one message is not consumed, it will block the consumption of subsequent messages.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096547854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096562505","html_url":"https://github.com/apache/rocketmq/pull/4138#issuecomment-1096562505","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4138","id":1096562505,"node_id":"IC_kwDOBHrsl85BXDdJ","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T10:48:08Z","updated_at":"2022-04-12T10:48:08Z","author_association":"CONTRIBUTOR","body":"> > Why not use ConcurrentHashMap instead of HashMap？Using ConcurrentHashMap, no need to lock when reading, and the scope of locking is smaller when writing.\r\n> \r\n> That's my opinion: Do as little as possible to fix mistakes.\r\n> \r\n> # describe in Chinese\r\n> 我习惯做尽可能少的事情去修正bug，尽量不去破坏原有的设计。\r\n> \r\n> 这里使用`synchronized`的原因也许是jvm对`synchronized`加锁进行了优化：如果加锁代码块没有真实的发生多线程并发访问，则永远不会真正的加锁。我简单跟踪了下代码，应该是这个原因。 <img alt=\"image\" width=\"1177\" src=\"https://user-images.githubusercontent.com/18216266/162627024-8459f20e-ec9c-4e75-bac4-da0c5140ab8d.png\">\r\n\r\nYou were right. Synchronized has a lock upgrade process,Biased locks -> Lightweight locks -> Heavyweight locks.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096562505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096565211","html_url":"https://github.com/apache/rocketmq/issues/4153#issuecomment-1096565211","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4153","id":1096565211,"node_id":"IC_kwDOBHrsl85BXEHb","user":{"login":"hill007299","id":5370269,"node_id":"MDQ6VXNlcjUzNzAyNjk=","avatar_url":"https://avatars.githubusercontent.com/u/5370269?v=4","gravatar_id":"","url":"https://api.github.com/users/hill007299","html_url":"https://github.com/hill007299","followers_url":"https://api.github.com/users/hill007299/followers","following_url":"https://api.github.com/users/hill007299/following{/other_user}","gists_url":"https://api.github.com/users/hill007299/gists{/gist_id}","starred_url":"https://api.github.com/users/hill007299/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hill007299/subscriptions","organizations_url":"https://api.github.com/users/hill007299/orgs","repos_url":"https://api.github.com/users/hill007299/repos","events_url":"https://api.github.com/users/hill007299/events{/privacy}","received_events_url":"https://api.github.com/users/hill007299/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T10:50:51Z","updated_at":"2022-04-12T10:50:51Z","author_association":"CONTRIBUTOR","body":"> @lizhiboo @duhenglucky It looks like implementing seconds delay messages is important for POP\r\n\r\nTiming messages have become more and more important ，this feature is already planned","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096565211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096623242","html_url":"https://github.com/apache/rocketmq/pull/4122#issuecomment-1096623242","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4122","id":1096623242,"node_id":"IC_kwDOBHrsl85BXSSK","user":{"login":"cserwen","id":46882838,"node_id":"MDQ6VXNlcjQ2ODgyODM4","avatar_url":"https://avatars.githubusercontent.com/u/46882838?v=4","gravatar_id":"","url":"https://api.github.com/users/cserwen","html_url":"https://github.com/cserwen","followers_url":"https://api.github.com/users/cserwen/followers","following_url":"https://api.github.com/users/cserwen/following{/other_user}","gists_url":"https://api.github.com/users/cserwen/gists{/gist_id}","starred_url":"https://api.github.com/users/cserwen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cserwen/subscriptions","organizations_url":"https://api.github.com/users/cserwen/orgs","repos_url":"https://api.github.com/users/cserwen/repos","events_url":"https://api.github.com/users/cserwen/events{/privacy}","received_events_url":"https://api.github.com/users/cserwen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T11:49:29Z","updated_at":"2022-04-12T11:49:29Z","author_association":"MEMBER","body":"@RongtongJin ping~","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096623242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096625325","html_url":"https://github.com/apache/rocketmq/pull/4071#issuecomment-1096625325","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4071","id":1096625325,"node_id":"IC_kwDOBHrsl85BXSyt","user":{"login":"humkum","id":50660789,"node_id":"MDQ6VXNlcjUwNjYwNzg5","avatar_url":"https://avatars.githubusercontent.com/u/50660789?v=4","gravatar_id":"","url":"https://api.github.com/users/humkum","html_url":"https://github.com/humkum","followers_url":"https://api.github.com/users/humkum/followers","following_url":"https://api.github.com/users/humkum/following{/other_user}","gists_url":"https://api.github.com/users/humkum/gists{/gist_id}","starred_url":"https://api.github.com/users/humkum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humkum/subscriptions","organizations_url":"https://api.github.com/users/humkum/orgs","repos_url":"https://api.github.com/users/humkum/repos","events_url":"https://api.github.com/users/humkum/events{/privacy}","received_events_url":"https://api.github.com/users/humkum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T11:51:45Z","updated_at":"2022-04-12T11:51:45Z","author_association":"CONTRIBUTOR","body":"@lizhiboo @Git-Yang @panzhi33 ping~","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1096625325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097251689","html_url":"https://github.com/apache/rocketmq/pull/4156#issuecomment-1097251689","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4156","id":1097251689,"node_id":"IC_kwDOBHrsl85BZrtp","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T21:44:03Z","updated_at":"2022-04-12T21:50:20Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4156?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#4156](https://codecov.io/gh/apache/rocketmq/pull/4156?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (c61e48f) into [develop](https://codecov.io/gh/apache/rocketmq/commit/ead6274b3e8016ee2fa75cf0dc201b5581ee7a34?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (ead6274) will **decrease** coverage by `0.08%`.\n> The diff coverage is `n/a`.\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #4156      +/-   ##\n=============================================\n- Coverage      48.06%   47.97%   -0.09%     \n+ Complexity      5017     5010       -7     \n=============================================\n  Files            635      635              \n  Lines          42506    42506              \n  Branches        5567     5567              \n=============================================\n- Hits           20429    20393      -36     \n- Misses         19593    19619      +26     \n- Partials        2484     2494      +10     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/4156?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | |\n|---|---|---|\n| [...org/apache/rocketmq/common/stats/StatsItemSet.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vc3RhdHMvU3RhdHNJdGVtU2V0LmphdmE=) | `41.79% <0.00%> (-10.45%)` | :arrow_down: |\n| [...va/org/apache/rocketmq/store/FlushDiskWatcher.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL0ZsdXNoRGlza1dhdGNoZXIuamF2YQ==) | `81.25% <0.00%> (-9.38%)` | :arrow_down: |\n| [...org/apache/rocketmq/store/ha/WaitNotifyObject.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL2hhL1dhaXROb3RpZnlPYmplY3QuamF2YQ==) | `66.07% <0.00%> (-5.36%)` | :arrow_down: |\n| [.../rocketmq/broker/filter/ConsumerFilterManager.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-YnJva2VyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9icm9rZXIvZmlsdGVyL0NvbnN1bWVyRmlsdGVyTWFuYWdlci5qYXZh) | `72.19% <0.00%> (-1.80%)` | :arrow_down: |\n| [...he/rocketmq/client/trace/AsyncTraceDispatcher.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvdHJhY2UvQXN5bmNUcmFjZURpc3BhdGNoZXIuamF2YQ==) | `78.21% <0.00%> (-1.49%)` | :arrow_down: |\n| [...a/org/apache/rocketmq/store/StoreStatsService.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL1N0b3JlU3RhdHNTZXJ2aWNlLmphdmE=) | `36.41% <0.00%> (-1.13%)` | :arrow_down: |\n| [...n/java/org/apache/rocketmq/store/ha/HAService.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL2hhL0hBU2VydmljZS5qYXZh) | `71.66% <0.00%> (-0.67%)` | :arrow_down: |\n| [...ent/impl/consumer/DefaultLitePullConsumerImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9jb25zdW1lci9EZWZhdWx0TGl0ZVB1bGxDb25zdW1lckltcGwuamF2YQ==) | `68.79% <0.00%> (-0.52%)` | :arrow_down: |\n| [...ain/java/org/apache/rocketmq/store/MappedFile.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL01hcHBlZEZpbGUuamF2YQ==) | `51.40% <0.00%> (-0.36%)` | :arrow_down: |\n| [.../apache/rocketmq/logging/inner/LoggingBuilder.java](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-bG9nZ2luZy9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcm9ja2V0bXEvbG9nZ2luZy9pbm5lci9Mb2dnaW5nQnVpbGRlci5qYXZh) | `64.71% <0.00%> (-0.16%)` | :arrow_down: |\n| ... and [2 more](https://codecov.io/gh/apache/rocketmq/pull/4156/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/4156?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4156?src=pr&el=footer&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Last update [ead6274...c61e48f](https://codecov.io/gh/apache/rocketmq/pull/4156?src=pr&el=lastupdated&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097251689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097256966","html_url":"https://github.com/apache/rocketmq/pull/4156#issuecomment-1097256966","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4156","id":1097256966,"node_id":"IC_kwDOBHrsl85BZtAG","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T21:49:20Z","updated_at":"2022-04-12T21:49:20Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48228486/badge)](https://coveralls.io/builds/48228486)\n\nCoverage increased (+0.02%) to 51.988% when pulling **c61e48fb2378e7e4b05ed998739cb9ae6e1ae350 on caigy:fix-acl-test** into **ead6274b3e8016ee2fa75cf0dc201b5581ee7a34 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097256966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097293844","html_url":"https://github.com/apache/rocketmq/pull/4157#issuecomment-1097293844","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4157","id":1097293844,"node_id":"IC_kwDOBHrsl85BZ2AU","user":{"login":"coveralls","id":2354108,"node_id":"MDQ6VXNlcjIzNTQxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/2354108?v=4","gravatar_id":"","url":"https://api.github.com/users/coveralls","html_url":"https://github.com/coveralls","followers_url":"https://api.github.com/users/coveralls/followers","following_url":"https://api.github.com/users/coveralls/following{/other_user}","gists_url":"https://api.github.com/users/coveralls/gists{/gist_id}","starred_url":"https://api.github.com/users/coveralls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coveralls/subscriptions","organizations_url":"https://api.github.com/users/coveralls/orgs","repos_url":"https://api.github.com/users/coveralls/repos","events_url":"https://api.github.com/users/coveralls/events{/privacy}","received_events_url":"https://api.github.com/users/coveralls/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-12T22:30:14Z","updated_at":"2022-04-12T22:30:14Z","author_association":"NONE","body":"\n[![Coverage Status](https://coveralls.io/builds/48229525/badge)](https://coveralls.io/builds/48229525)\n\nCoverage increased (+0.08%) to 52.048% when pulling **8c6eae24c85bde1a953999e0700f304f73e1cc89 on yuz10:develop3** into **ead6274b3e8016ee2fa75cf0dc201b5581ee7a34 on apache:develop**.\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097293844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097449756","html_url":"https://github.com/apache/rocketmq/issues/4160#issuecomment-1097449756","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4160","id":1097449756,"node_id":"IC_kwDOBHrsl85BacEc","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T01:13:21Z","updated_at":"2022-04-13T01:13:21Z","author_association":"CONTRIBUTOR","body":"> deply\r\n\r\nYou need to use a fixed consumerGroup name.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097449756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097453931","html_url":"https://github.com/apache/rocketmq/issues/4160#issuecomment-1097453931","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4160","id":1097453931,"node_id":"IC_kwDOBHrsl85BadFr","user":{"login":"xunianchong","id":16568795,"node_id":"MDQ6VXNlcjE2NTY4Nzk1","avatar_url":"https://avatars.githubusercontent.com/u/16568795?v=4","gravatar_id":"","url":"https://api.github.com/users/xunianchong","html_url":"https://github.com/xunianchong","followers_url":"https://api.github.com/users/xunianchong/followers","following_url":"https://api.github.com/users/xunianchong/following{/other_user}","gists_url":"https://api.github.com/users/xunianchong/gists{/gist_id}","starred_url":"https://api.github.com/users/xunianchong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xunianchong/subscriptions","organizations_url":"https://api.github.com/users/xunianchong/orgs","repos_url":"https://api.github.com/users/xunianchong/repos","events_url":"https://api.github.com/users/xunianchong/events{/privacy}","received_events_url":"https://api.github.com/users/xunianchong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T01:21:54Z","updated_at":"2022-04-13T01:21:54Z","author_association":"NONE","body":"   DefaultMQPushConsumer consumer =\r\n                new DefaultMQPushConsumer(\"BB\");\r\n        consumer.setInstanceName(\"AA\");\r\n\r\nWe need to use a fixed  InstanceName or  a fixed consumerGroup name?  consumerGroup is fixed?","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097453931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097467953","html_url":"https://github.com/apache/rocketmq/issues/4154#issuecomment-1097467953","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4154","id":1097467953,"node_id":"IC_kwDOBHrsl85Baggx","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T01:51:51Z","updated_at":"2022-04-13T01:51:51Z","author_association":"CONTRIBUTOR","body":"> ![1649761765(1)](https://user-images.githubusercontent.com/42512469/162947438-82a56beb-a899-4022-a7ee-17f44a65d154.png)\r\n> \r\n> mq.setBrokerName(notBestBroker); mq.setQueueId(tpInfo.getSendWhichQueue().getAndIncrement() % writeQueueNums);\r\n> \r\n> this method of selectOneMessageQueue is executed by multiThread when send a message but the mq (messageQueue) is a shared object , thread A modify it`s brokerName to brokerB,but have not modify it queueId, still 1 , then thread B send msg and use this queue,but now,this queue `s brokerName is brokerB but it`s queueId is 1, in this case , wo can`t sure that brokerB really have queue which queueId is 1\r\n> \r\n> Isn't that really a problem?\r\n\r\nI think you are right, to be more precise, constructors should be used.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097467953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097470929","html_url":"https://github.com/apache/rocketmq/pull/4152#issuecomment-1097470929","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4152","id":1097470929,"node_id":"IC_kwDOBHrsl85BahPR","user":{"login":"ni-ze","id":31175234,"node_id":"MDQ6VXNlcjMxMTc1MjM0","avatar_url":"https://avatars.githubusercontent.com/u/31175234?v=4","gravatar_id":"","url":"https://api.github.com/users/ni-ze","html_url":"https://github.com/ni-ze","followers_url":"https://api.github.com/users/ni-ze/followers","following_url":"https://api.github.com/users/ni-ze/following{/other_user}","gists_url":"https://api.github.com/users/ni-ze/gists{/gist_id}","starred_url":"https://api.github.com/users/ni-ze/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ni-ze/subscriptions","organizations_url":"https://api.github.com/users/ni-ze/orgs","repos_url":"https://api.github.com/users/ni-ze/repos","events_url":"https://api.github.com/users/ni-ze/events{/privacy}","received_events_url":"https://api.github.com/users/ni-ze/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T01:56:05Z","updated_at":"2022-04-13T01:56:05Z","author_association":"CONTRIBUTOR","body":"@sunxi92 Travis CI have failed.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097470929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097483224","html_url":"https://github.com/apache/rocketmq/pull/4157#issuecomment-1097483224","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4157","id":1097483224,"node_id":"IC_kwDOBHrsl85BakPY","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T02:20:51Z","updated_at":"2022-04-13T02:20:51Z","author_association":"CONTRIBUTOR","body":"I think the reason may be that the channel was closed before the pull message request was sent.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097483224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097483541","html_url":"https://github.com/apache/rocketmq/pull/4045#issuecomment-1097483541","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4045","id":1097483541,"node_id":"IC_kwDOBHrsl85BakUV","user":{"login":"dongeforever","id":8434428,"node_id":"MDQ6VXNlcjg0MzQ0Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/8434428?v=4","gravatar_id":"","url":"https://api.github.com/users/dongeforever","html_url":"https://github.com/dongeforever","followers_url":"https://api.github.com/users/dongeforever/followers","following_url":"https://api.github.com/users/dongeforever/following{/other_user}","gists_url":"https://api.github.com/users/dongeforever/gists{/gist_id}","starred_url":"https://api.github.com/users/dongeforever/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongeforever/subscriptions","organizations_url":"https://api.github.com/users/dongeforever/orgs","repos_url":"https://api.github.com/users/dongeforever/repos","events_url":"https://api.github.com/users/dongeforever/events{/privacy}","received_events_url":"https://api.github.com/users/dongeforever/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T02:21:31Z","updated_at":"2022-04-13T02:21:31Z","author_association":"MEMBER","body":"@Git-Yang LGTM.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097483541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097486039","html_url":"https://github.com/apache/rocketmq/issues/4160#issuecomment-1097486039","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4160","id":1097486039,"node_id":"IC_kwDOBHrsl85Bak7X","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T02:26:25Z","updated_at":"2022-04-13T02:26:25Z","author_association":"CONTRIBUTOR","body":"> DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(\"BB\"); consumer.setInstanceName(\"AA\");\r\n> \r\n> We need to use a fixed InstanceName or a fixed consumerGroup name? consumerGroup is fixed?\r\n\r\nYes, the consumerGroup 'BB' need a Fixed name.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097486039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097486640","html_url":"https://github.com/apache/rocketmq/issues/4160#issuecomment-1097486640","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4160","id":1097486640,"node_id":"IC_kwDOBHrsl85BalEw","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T02:27:48Z","updated_at":"2022-04-13T02:27:48Z","author_association":"CONTRIBUTOR","body":"InstanceName is optional unless multiple consumers are started within a process\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097486640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097489919","html_url":"https://github.com/apache/rocketmq/issues/4154#issuecomment-1097489919","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4154","id":1097489919,"node_id":"IC_kwDOBHrsl85Bal3_","user":{"login":"ni-ze","id":31175234,"node_id":"MDQ6VXNlcjMxMTc1MjM0","avatar_url":"https://avatars.githubusercontent.com/u/31175234?v=4","gravatar_id":"","url":"https://api.github.com/users/ni-ze","html_url":"https://github.com/ni-ze","followers_url":"https://api.github.com/users/ni-ze/followers","following_url":"https://api.github.com/users/ni-ze/following{/other_user}","gists_url":"https://api.github.com/users/ni-ze/gists{/gist_id}","starred_url":"https://api.github.com/users/ni-ze/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ni-ze/subscriptions","organizations_url":"https://api.github.com/users/ni-ze/orgs","repos_url":"https://api.github.com/users/ni-ze/repos","events_url":"https://api.github.com/users/ni-ze/events{/privacy}","received_events_url":"https://api.github.com/users/ni-ze/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T02:34:35Z","updated_at":"2022-04-13T02:34:35Z","author_association":"CONTRIBUTOR","body":"I do not think so.\r\n```java\r\ntpInfo.getSendWhichQueue().incrementAndGet()\r\n```\r\nthe index is a thread local variable, would change with thread.if thread switched, index will change.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097489919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097502705","html_url":"https://github.com/apache/rocketmq/pull/4099#issuecomment-1097502705","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4099","id":1097502705,"node_id":"IC_kwDOBHrsl85Bao_x","user":{"login":"dongeforever","id":8434428,"node_id":"MDQ6VXNlcjg0MzQ0Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/8434428?v=4","gravatar_id":"","url":"https://api.github.com/users/dongeforever","html_url":"https://github.com/dongeforever","followers_url":"https://api.github.com/users/dongeforever/followers","following_url":"https://api.github.com/users/dongeforever/following{/other_user}","gists_url":"https://api.github.com/users/dongeforever/gists{/gist_id}","starred_url":"https://api.github.com/users/dongeforever/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongeforever/subscriptions","organizations_url":"https://api.github.com/users/dongeforever/orgs","repos_url":"https://api.github.com/users/dongeforever/repos","events_url":"https://api.github.com/users/dongeforever/events{/privacy}","received_events_url":"https://api.github.com/users/dongeforever/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T03:04:04Z","updated_at":"2022-04-13T03:04:04Z","author_association":"MEMBER","body":"@dugenkui03 I found another issue.\r\nIn the AsyncAppenderRequest, the max message size is 128000.\r\nSo If the byte size of the accumulated  TraceContext  is more than 128000, it cannot reduce the RPC to improve the performance, but cause delay.\r\n\r\nSo the algorithm may need to consider the byte size too. If the byte size is enough, it should be scheduled immediately.\r\n\r\nBTW, the data topic generated by \"sendTraceData\" is not used in  \"sendTraceDataByMQ\".\r\n\r\nMaybe we need to clarify the design of topic mechanism for trace.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097502705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097503418","html_url":"https://github.com/apache/rocketmq/pull/4132#issuecomment-1097503418","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4132","id":1097503418,"node_id":"IC_kwDOBHrsl85BapK6","user":{"login":"tianliuliu","id":13758677,"node_id":"MDQ6VXNlcjEzNzU4Njc3","avatar_url":"https://avatars.githubusercontent.com/u/13758677?v=4","gravatar_id":"","url":"https://api.github.com/users/tianliuliu","html_url":"https://github.com/tianliuliu","followers_url":"https://api.github.com/users/tianliuliu/followers","following_url":"https://api.github.com/users/tianliuliu/following{/other_user}","gists_url":"https://api.github.com/users/tianliuliu/gists{/gist_id}","starred_url":"https://api.github.com/users/tianliuliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tianliuliu/subscriptions","organizations_url":"https://api.github.com/users/tianliuliu/orgs","repos_url":"https://api.github.com/users/tianliuliu/repos","events_url":"https://api.github.com/users/tianliuliu/events{/privacy}","received_events_url":"https://api.github.com/users/tianliuliu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T03:05:21Z","updated_at":"2022-04-13T03:13:34Z","author_association":"CONTRIBUTOR","body":"Some businesses that use the old MQ client have catch these exceptions. When they are deleted in this new client, the business compile will fail, resulting in incompatible client versions.","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097503418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097511342","html_url":"https://github.com/apache/rocketmq/issues/4154#issuecomment-1097511342","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4154","id":1097511342,"node_id":"IC_kwDOBHrsl85BarGu","user":{"login":"lwclover","id":4252409,"node_id":"MDQ6VXNlcjQyNTI0MDk=","avatar_url":"https://avatars.githubusercontent.com/u/4252409?v=4","gravatar_id":"","url":"https://api.github.com/users/lwclover","html_url":"https://github.com/lwclover","followers_url":"https://api.github.com/users/lwclover/followers","following_url":"https://api.github.com/users/lwclover/following{/other_user}","gists_url":"https://api.github.com/users/lwclover/gists{/gist_id}","starred_url":"https://api.github.com/users/lwclover/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwclover/subscriptions","organizations_url":"https://api.github.com/users/lwclover/orgs","repos_url":"https://api.github.com/users/lwclover/repos","events_url":"https://api.github.com/users/lwclover/events{/privacy}","received_events_url":"https://api.github.com/users/lwclover/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T03:20:43Z","updated_at":"2022-04-13T03:21:15Z","author_association":"CONTRIBUTOR","body":"> I do not think so.\r\n> \r\n> ```java\r\n> tpInfo.getSendWhichQueue().incrementAndGet()\r\n> ```\r\n> \r\n> the index is a thread local variable, would change with thread.if thread switched, index will change.\r\n\r\nAnd then there's the mod","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097511342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097512832","html_url":"https://github.com/apache/rocketmq/issues/4137#issuecomment-1097512832","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4137","id":1097512832,"node_id":"IC_kwDOBHrsl85BareA","user":{"login":"dongeforever","id":8434428,"node_id":"MDQ6VXNlcjg0MzQ0Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/8434428?v=4","gravatar_id":"","url":"https://api.github.com/users/dongeforever","html_url":"https://github.com/dongeforever","followers_url":"https://api.github.com/users/dongeforever/followers","following_url":"https://api.github.com/users/dongeforever/following{/other_user}","gists_url":"https://api.github.com/users/dongeforever/gists{/gist_id}","starred_url":"https://api.github.com/users/dongeforever/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongeforever/subscriptions","organizations_url":"https://api.github.com/users/dongeforever/orgs","repos_url":"https://api.github.com/users/dongeforever/repos","events_url":"https://api.github.com/users/dongeforever/events{/privacy}","received_events_url":"https://api.github.com/users/dongeforever/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T03:22:56Z","updated_at":"2022-04-13T03:22:56Z","author_association":"MEMBER","body":"@cserwen @lwclover \r\nAs described in google's paper GFS,  the side effect of zero-copy is that if the data is not in page cache, the page fault and disk reading(usually called cold data) will hang the netty thread. \r\nWhich will cause delays in all requests.\r\n\r\nFor MQ, Keeping low latency of sending is very important, so for latency-sensitive applications, it is not suggested to use zero copy by default.\r\n ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097512832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097517281","html_url":"https://github.com/apache/rocketmq/pull/4132#issuecomment-1097517281","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4132","id":1097517281,"node_id":"IC_kwDOBHrsl85Basjh","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T03:31:29Z","updated_at":"2022-04-13T03:31:29Z","author_association":"CONTRIBUTOR","body":"> Some businesses that use the old MQ client have caught these exceptions. When they are deleted in this new client, the business compile will fail, resulting in incompatible client versions.\r\n\r\nYes, you are right. I think it is nessary to correct the method signature as soon as possible to avoid more technical debt. This pr should be a breaking change.\r\n\r\n# Describe in Chinese\r\n你是对的。但是我认为仍然有必要修正这个错误以避免更多的技术债务，这对于相关方法算是 重大更新(beaking change)。\r\n\r\n在提交此 PR 的过程中也考虑到了尽可能合理的向前兼容，例如 1处调用 永远不会抛出 2异常`MQBrokerException`、但鉴于该类实现的接口方法定义抛出了`deletePlainAccessConfig`、此处没有去掉`MQBrokerException`。\r\n<img width=\"818\" alt=\"image\" src=\"https://user-images.githubusercontent.com/18216266/163094159-adb8174c-0ca1-4d8e-9c68-eeff40a7ee36.png\">\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097517281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097543543","html_url":"https://github.com/apache/rocketmq/issues/4154#issuecomment-1097543543","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4154","id":1097543543,"node_id":"IC_kwDOBHrsl85Bay93","user":{"login":"mz0113","id":42512469,"node_id":"MDQ6VXNlcjQyNTEyNDY5","avatar_url":"https://avatars.githubusercontent.com/u/42512469?v=4","gravatar_id":"","url":"https://api.github.com/users/mz0113","html_url":"https://github.com/mz0113","followers_url":"https://api.github.com/users/mz0113/followers","following_url":"https://api.github.com/users/mz0113/following{/other_user}","gists_url":"https://api.github.com/users/mz0113/gists{/gist_id}","starred_url":"https://api.github.com/users/mz0113/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mz0113/subscriptions","organizations_url":"https://api.github.com/users/mz0113/orgs","repos_url":"https://api.github.com/users/mz0113/repos","events_url":"https://api.github.com/users/mz0113/events{/privacy}","received_events_url":"https://api.github.com/users/mz0113/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T04:29:30Z","updated_at":"2022-04-13T04:32:43Z","author_association":"NONE","body":"> I do not think so.\r\n> \r\n> ```java\r\n> tpInfo.getSendWhichQueue().incrementAndGet()\r\n> ```\r\n> \r\n> the index is a thread local variable, would change with thread.if thread switched, index will change.\r\n\r\nIt is precisely because the index has changed that other threads have the opportunity to use this queue\r\ndifferent thread has differnt index , we can`t sure that queue will not be used","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097543543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097585829","html_url":"https://github.com/apache/rocketmq/issues/4159#issuecomment-1097585829","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4159","id":1097585829,"node_id":"IC_kwDOBHrsl85Ba9Sl","user":{"login":"panzhi33","id":29321745,"node_id":"MDQ6VXNlcjI5MzIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/29321745?v=4","gravatar_id":"","url":"https://api.github.com/users/panzhi33","html_url":"https://github.com/panzhi33","followers_url":"https://api.github.com/users/panzhi33/followers","following_url":"https://api.github.com/users/panzhi33/following{/other_user}","gists_url":"https://api.github.com/users/panzhi33/gists{/gist_id}","starred_url":"https://api.github.com/users/panzhi33/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panzhi33/subscriptions","organizations_url":"https://api.github.com/users/panzhi33/orgs","repos_url":"https://api.github.com/users/panzhi33/repos","events_url":"https://api.github.com/users/panzhi33/events{/privacy}","received_events_url":"https://api.github.com/users/panzhi33/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T05:50:46Z","updated_at":"2022-04-13T05:50:46Z","author_association":"CONTRIBUTOR","body":"fileChannel.write does not directly write ByteBuffer data to disk","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097585829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097589216","html_url":"https://github.com/apache/rocketmq/issues/4159#issuecomment-1097589216","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4159","id":1097589216,"node_id":"IC_kwDOBHrsl85Ba-Hg","user":{"login":"iamqq23ue","id":70457992,"node_id":"MDQ6VXNlcjcwNDU3OTky","avatar_url":"https://avatars.githubusercontent.com/u/70457992?v=4","gravatar_id":"","url":"https://api.github.com/users/iamqq23ue","html_url":"https://github.com/iamqq23ue","followers_url":"https://api.github.com/users/iamqq23ue/followers","following_url":"https://api.github.com/users/iamqq23ue/following{/other_user}","gists_url":"https://api.github.com/users/iamqq23ue/gists{/gist_id}","starred_url":"https://api.github.com/users/iamqq23ue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iamqq23ue/subscriptions","organizations_url":"https://api.github.com/users/iamqq23ue/orgs","repos_url":"https://api.github.com/users/iamqq23ue/repos","events_url":"https://api.github.com/users/iamqq23ue/events{/privacy}","received_events_url":"https://api.github.com/users/iamqq23ue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T05:56:53Z","updated_at":"2022-04-13T05:56:53Z","author_association":"CONTRIBUTOR","body":"yes，I know that data is written to the system cache first, but eventually it is written to disk.And FlushConsumeQueueService is also executed asynchronously。\r\nIf it's to ensure data is written to disk, why not use filechannel.force.&nbsp;\r\n\r\n\r\nOr write to mappedbytebuffer like commitlog.\r\n\r\n\r\n\r\n\r\n------------------&nbsp;原始邮件&nbsp;------------------\r\n发件人:                                                                                                                        \"apache/rocketmq\"                                                                                    ***@***.***&gt;;\r\n发送时间:&nbsp;2022年4月13日(星期三) 中午1:50\r\n***@***.***&gt;;\r\n***@***.******@***.***&gt;;\r\n主题:&nbsp;Re: [apache/rocketmq] Is  FlushConsumeQueueService necessary？ (Issue #4159)\r\n\r\n\r\n\r\n\r\n\r\n \r\nfileChannel.write does not directly write ByteBuffer data to disk\r\n \r\n—\r\nReply to this email directly, view it on GitHub, or unsubscribe.\r\nYou are receiving this because you authored the thread.Message ID: ***@***.***&gt;","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097589216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097608746","html_url":"https://github.com/apache/rocketmq/issues/4154#issuecomment-1097608746","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4154","id":1097608746,"node_id":"IC_kwDOBHrsl85BbC4q","user":{"login":"ni-ze","id":31175234,"node_id":"MDQ6VXNlcjMxMTc1MjM0","avatar_url":"https://avatars.githubusercontent.com/u/31175234?v=4","gravatar_id":"","url":"https://api.github.com/users/ni-ze","html_url":"https://github.com/ni-ze","followers_url":"https://api.github.com/users/ni-ze/followers","following_url":"https://api.github.com/users/ni-ze/following{/other_user}","gists_url":"https://api.github.com/users/ni-ze/gists{/gist_id}","starred_url":"https://api.github.com/users/ni-ze/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ni-ze/subscriptions","organizations_url":"https://api.github.com/users/ni-ze/orgs","repos_url":"https://api.github.com/users/ni-ze/repos","events_url":"https://api.github.com/users/ni-ze/events{/privacy}","received_events_url":"https://api.github.com/users/ni-ze/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T06:29:29Z","updated_at":"2022-04-13T06:29:29Z","author_association":"CONTRIBUTOR","body":"```java\r\n    int writeQueueNums = tpInfo.getQueueIdByBroker(notBestBroker);\r\n   ...\r\n    mq.setBrokerName(notBestBroker);\r\n    mq.setQueueId(tpInfo.getSendWhichQueue().incrementAndGet() % writeQueueNums);\r\n```\r\na messageQueue's brokerName and queueId is consistent, because writeQueueNums is belong to the same brokerName, which is notBestBroker in this case. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097608746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097650194","html_url":"https://github.com/apache/rocketmq/pull/4132#issuecomment-1097650194","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4132","id":1097650194,"node_id":"IC_kwDOBHrsl85BbNAS","user":{"login":"tianliuliu","id":13758677,"node_id":"MDQ6VXNlcjEzNzU4Njc3","avatar_url":"https://avatars.githubusercontent.com/u/13758677?v=4","gravatar_id":"","url":"https://api.github.com/users/tianliuliu","html_url":"https://github.com/tianliuliu","followers_url":"https://api.github.com/users/tianliuliu/followers","following_url":"https://api.github.com/users/tianliuliu/following{/other_user}","gists_url":"https://api.github.com/users/tianliuliu/gists{/gist_id}","starred_url":"https://api.github.com/users/tianliuliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tianliuliu/subscriptions","organizations_url":"https://api.github.com/users/tianliuliu/orgs","repos_url":"https://api.github.com/users/tianliuliu/repos","events_url":"https://api.github.com/users/tianliuliu/events{/privacy}","received_events_url":"https://api.github.com/users/tianliuliu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T07:26:04Z","updated_at":"2022-04-13T07:26:04Z","author_association":"CONTRIBUTOR","body":"> > Some businesses that use the old MQ client have caught these exceptions. When they are deleted in this new client, the business compile will fail, resulting in incompatible client versions.\r\n> \r\n> Yes, you are right. I think it is nessary to correct the method signature as soon as possible to avoid more technical debt. This pr should be a breaking change.\r\n> \r\n> # Describe in Chinese\r\n> 你是对的。但是我认为仍然有必要修正这个错误以避免更多的技术债务，这对于相关方法算是 重大更新(beaking change)。\r\n> \r\n> 在提交此 PR 的过程中也考虑到了尽可能合理的向前兼容，例如 1处调用 永远不会抛出 2异常`MQBrokerException`、但鉴于该类实现的接口方法定义抛出了`deletePlainAccessConfig`、此处没有去掉`MQBrokerException`。 <img alt=\"image\" width=\"818\" src=\"https://user-images.githubusercontent.com/18216266/163094159-adb8174c-0ca1-4d8e-9c68-eeff40a7ee36.png\">\r\n\r\nlink @RongtongJin ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097650194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097685227","html_url":"https://github.com/apache/rocketmq/issues/4159#issuecomment-1097685227","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4159","id":1097685227,"node_id":"IC_kwDOBHrsl85BbVjr","user":{"login":"panzhi33","id":29321745,"node_id":"MDQ6VXNlcjI5MzIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/29321745?v=4","gravatar_id":"","url":"https://api.github.com/users/panzhi33","html_url":"https://github.com/panzhi33","followers_url":"https://api.github.com/users/panzhi33/followers","following_url":"https://api.github.com/users/panzhi33/following{/other_user}","gists_url":"https://api.github.com/users/panzhi33/gists{/gist_id}","starred_url":"https://api.github.com/users/panzhi33/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/panzhi33/subscriptions","organizations_url":"https://api.github.com/users/panzhi33/orgs","repos_url":"https://api.github.com/users/panzhi33/repos","events_url":"https://api.github.com/users/panzhi33/events{/privacy}","received_events_url":"https://api.github.com/users/panzhi33/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T08:06:19Z","updated_at":"2022-04-13T08:06:19Z","author_association":"CONTRIBUTOR","body":"Every time the data is written, it will be forced, and the disk io pressure will be relatively large, so it needs to be changed to this asynchronous。\r\nand 5.0 has been modified to mappedbytebuffer ","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097685227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097686739","html_url":"https://github.com/apache/rocketmq/issues/4154#issuecomment-1097686739","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4154","id":1097686739,"node_id":"IC_kwDOBHrsl85BbV7T","user":{"login":"mz0113","id":42512469,"node_id":"MDQ6VXNlcjQyNTEyNDY5","avatar_url":"https://avatars.githubusercontent.com/u/42512469?v=4","gravatar_id":"","url":"https://api.github.com/users/mz0113","html_url":"https://github.com/mz0113","followers_url":"https://api.github.com/users/mz0113/followers","following_url":"https://api.github.com/users/mz0113/following{/other_user}","gists_url":"https://api.github.com/users/mz0113/gists{/gist_id}","starred_url":"https://api.github.com/users/mz0113/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mz0113/subscriptions","organizations_url":"https://api.github.com/users/mz0113/orgs","repos_url":"https://api.github.com/users/mz0113/repos","events_url":"https://api.github.com/users/mz0113/events{/privacy}","received_events_url":"https://api.github.com/users/mz0113/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T08:08:01Z","updated_at":"2022-04-13T09:26:23Z","author_association":"NONE","body":"> ```java\r\n>     int writeQueueNums = tpInfo.getQueueIdByBroker(notBestBroker);\r\n>    ...\r\n>     mq.setBrokerName(notBestBroker);\r\n>     mq.setQueueId(tpInfo.getSendWhichQueue().incrementAndGet() % writeQueueNums);\r\n> ```\r\n> \r\n> a messageQueue's brokerName and queueId is consistent, because writeQueueNums is belong to the same brokerName, which is notBestBroker in this case.\r\n\r\n\r\n\r\n\r\n\r\nno, that is not my mean , you are right in some aspect,but what i want to say is  messagequeue it self is a shared object , it means all threads will use the same messageQueue object, for current thread, the messageQueue is consistent,but for other thread, it may not  be consistent ,\r\n`org.apache.rocketmq.client.impl.producer.TopicPublishInfo#selectOneMessageQueue() `\r\n\r\n```java    public MessageQueue selectOneMessageQueue() {\r\n        int index = this.sendWhichQueue.getAndIncrement();\r\n        int pos = Math.abs(index) % this.messageQueueList.size();\r\n        if (pos < 0)\r\n            pos = 0;\r\n        return this.messageQueueList.get(pos);\r\n    }\r\n```\r\n\r\nthis method will not sure it`s return value(messageQueue) is always belong to notBestBroker，so the method may be return a mq from brokerA or brokerB ,etc .for example, when this.sendWhichQueue is too big to becoming a number less than zero, the pos will be zero, and     \r\n'return this.messageQueueList.get(pos); '\r\nwill return a messageQueue object which may not belong to notBestBroker","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097686739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097828873","html_url":"https://github.com/apache/rocketmq/issues/4142#issuecomment-1097828873","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4142","id":1097828873,"node_id":"IC_kwDOBHrsl85Bb4oJ","user":{"login":"dugenkui03","id":18216266,"node_id":"MDQ6VXNlcjE4MjE2MjY2","avatar_url":"https://avatars.githubusercontent.com/u/18216266?v=4","gravatar_id":"","url":"https://api.github.com/users/dugenkui03","html_url":"https://github.com/dugenkui03","followers_url":"https://api.github.com/users/dugenkui03/followers","following_url":"https://api.github.com/users/dugenkui03/following{/other_user}","gists_url":"https://api.github.com/users/dugenkui03/gists{/gist_id}","starred_url":"https://api.github.com/users/dugenkui03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dugenkui03/subscriptions","organizations_url":"https://api.github.com/users/dugenkui03/orgs","repos_url":"https://api.github.com/users/dugenkui03/repos","events_url":"https://api.github.com/users/dugenkui03/events{/privacy}","received_events_url":"https://api.github.com/users/dugenkui03/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T09:47:17Z","updated_at":"2022-04-13T09:47:17Z","author_association":"CONTRIBUTOR","body":"@ni-ze The read-thread maybe get unexpected value, instread of the latest value.  Details in [jdk document](https://github.com/openjdk/jdk/blob/280aa428800043f314b92ae88076d596cb4c2fe0/src/java.base/share/classes/java/util/HashMap.java#L89).\r\n\r\n>Note that this implementation is not synchronized. If multiple threads access a hash map concurrently, and at least one of the threads modifies the map structurally, it must be synchronized externally.\r\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1097828873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1098001251","html_url":"https://github.com/apache/rocketmq/pull/4152#issuecomment-1098001251","issue_url":"https://api.github.com/repos/apache/rocketmq/issues/4152","id":1098001251,"node_id":"IC_kwDOBHrsl85Bcitj","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T12:38:25Z","updated_at":"2022-05-24T19:00:28Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4152?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#4152](https://codecov.io/gh/apache/rocketmq/pull/4152?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (76dc96e) into [develop](https://codecov.io/gh/apache/rocketmq/commit/de5e6d9e06732e88df03b4df5759aa87ea017ac3?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (de5e6d9) will **decrease** coverage by `0.14%`.\n> The diff coverage is `17.85%`.\n\n```diff\n@@              Coverage Diff              @@\n##             develop    #4152      +/-   ##\n=============================================\n- Coverage      48.34%   48.19%   -0.15%     \n+ Complexity      5105     5096       -9     \n=============================================\n  Files            642      642              \n  Lines          42780    42804      +24     \n  Branches        5597     5601       +4     \n=============================================\n- Hits           20682    20631      -51     \n- Misses         19600    19668      +68     \n- Partials        2498     2505       +7     \n```\n\n\n| [Impacted Files](https://codecov.io/gh/apache/rocketmq/pull/4152?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | |\n|---|---|---|\n| [...ocketmq/broker/processor/AdminBrokerProcessor.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-YnJva2VyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9icm9rZXIvcHJvY2Vzc29yL0FkbWluQnJva2VyUHJvY2Vzc29yLmphdmE=) | `35.19% <0.00%> (-0.04%)` | :arrow_down: |\n| [...g/apache/rocketmq/client/impl/MQClientAPIImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y2xpZW50L3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jbGllbnQvaW1wbC9NUUNsaWVudEFQSUltcGwuamF2YQ==) | `13.96% <0.00%> (-0.02%)` | :arrow_down: |\n| [...der/UpdateGlobalWhiteAddrsConfigRequestHeader.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-Y29tbW9uL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9jb21tb24vcHJvdG9jb2wvaGVhZGVyL1VwZGF0ZUdsb2JhbFdoaXRlQWRkcnNDb25maWdSZXF1ZXN0SGVhZGVyLmphdmE=) | `0.00% <0.00%> (ø)` | |\n| [...apache/rocketmq/tools/admin/DefaultMQAdminExt.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-dG9vbHMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3Rvb2xzL2FkbWluL0RlZmF1bHRNUUFkbWluRXh0LmphdmE=) | `40.76% <0.00%> (-0.64%)` | :arrow_down: |\n| [...he/rocketmq/tools/admin/DefaultMQAdminExtImpl.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-dG9vbHMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3Rvb2xzL2FkbWluL0RlZmF1bHRNUUFkbWluRXh0SW1wbC5qYXZh) | `39.67% <0.00%> (-0.17%)` | :arrow_down: |\n| [...che/rocketmq/acl/plain/PlainPermissionManager.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-YWNsL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9hY2wvcGxhaW4vUGxhaW5QZXJtaXNzaW9uTWFuYWdlci5qYXZh) | `73.93% <12.50%> (-1.77%)` | :arrow_down: |\n| [...s/command/acl/UpdateGlobalWhiteAddrSubCommand.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-dG9vbHMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3Rvb2xzL2NvbW1hbmQvYWNsL1VwZGF0ZUdsb2JhbFdoaXRlQWRkclN1YkNvbW1hbmQuamF2YQ==) | `36.36% <37.50%> (+2.15%)` | :arrow_up: |\n| [...pache/rocketmq/acl/plain/PlainAccessValidator.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-YWNsL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9hY2wvcGxhaW4vUGxhaW5BY2Nlc3NWYWxpZGF0b3IuamF2YQ==) | `91.04% <100.00%> (-1.38%)` | :arrow_down: |\n| [...rocketmq/broker/filtersrv/FilterServerManager.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-YnJva2VyL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9yb2NrZXRtcS9icm9rZXIvZmlsdGVyc3J2L0ZpbHRlclNlcnZlck1hbmFnZXIuamF2YQ==) | `20.00% <0.00%> (-14.29%)` | :arrow_down: |\n| [...va/org/apache/rocketmq/store/FlushDiskWatcher.java](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-c3RvcmUvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3JvY2tldG1xL3N0b3JlL0ZsdXNoRGlza1dhdGNoZXIuamF2YQ==) | `81.25% <0.00%> (-9.38%)` | :arrow_down: |\n| ... and [16 more](https://codecov.io/gh/apache/rocketmq/pull/4152/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n\n------\n\n[Continue to review full report at Codecov](https://codecov.io/gh/apache/rocketmq/pull/4152?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n> **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n> `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data`\n> Powered by [Codecov](https://codecov.io/gh/apache/rocketmq/pull/4152?src=pr&el=footer&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Last update [de5e6d9...76dc96e](https://codecov.io/gh/apache/rocketmq/pull/4152?src=pr&el=lastupdated&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation).\n","reactions":{"url":"https://api.github.com/repos/apache/rocketmq/issues/comments/1098001251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]