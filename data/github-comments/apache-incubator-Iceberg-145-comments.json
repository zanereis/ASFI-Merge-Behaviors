[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027485384","html_url":"https://github.com/apache/iceberg/pull/2638#issuecomment-1027485384","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2638","id":1027485384,"node_id":"IC_kwDOCW7NX849Pi7I","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T01:21:03Z","updated_at":"2022-02-02T01:21:03Z","author_association":"CONTRIBUTOR","body":"Hi @ggershinsky, the PR LGTM. Can you check the CI failure?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027485384/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027504312","html_url":"https://github.com/apache/iceberg/pull/2925#issuecomment-1027504312","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2925","id":1027504312,"node_id":"IC_kwDOCW7NX849Pni4","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T02:02:15Z","updated_at":"2022-02-02T02:02:15Z","author_association":"COLLABORATOR","body":"Note: failures look unrelated (look like random hashing makes the file count different than expected in both cases)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027504312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027596161","html_url":"https://github.com/apache/iceberg/pull/4024#issuecomment-1027596161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4024","id":1027596161,"node_id":"IC_kwDOCW7NX849P9-B","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T05:20:03Z","updated_at":"2022-02-02T05:20:03Z","author_association":"MEMBER","body":"cc @wypoon @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027596161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027610771","html_url":"https://github.com/apache/iceberg/pull/3998#issuecomment-1027610771","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3998","id":1027610771,"node_id":"IC_kwDOCW7NX849QBiT","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T05:50:12Z","updated_at":"2022-02-02T05:50:12Z","author_association":"CONTRIBUTOR","body":"initially, I misread the intention was to do partition overwrite for commit\r\n```\r\n    public Builder overwrite(boolean newOverwrite) {\r\n      this.overwrite = newOverwrite;\r\n      return this;\r\n    }\r\n```\r\n\r\nCan we update the PR title to sth like \"Support override write configuration on top of table properties in FlinkSink builder\"?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027610771/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027658982","html_url":"https://github.com/apache/iceberg/pull/2638#issuecomment-1027658982","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2638","id":1027658982,"node_id":"IC_kwDOCW7NX849QNTm","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T07:32:43Z","updated_at":"2022-02-02T07:40:28Z","author_association":"CONTRIBUTOR","body":"Done.  It was a CI glitch; I've re-opened the PR, all tests pass.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027658982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027675310","html_url":"https://github.com/apache/iceberg/pull/4029#issuecomment-1027675310","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4029","id":1027675310,"node_id":"IC_kwDOCW7NX849QRSu","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T08:01:13Z","updated_at":"2022-02-02T08:01:13Z","author_association":"CONTRIBUTOR","body":"cc @rdblue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027675310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027675496","html_url":"https://github.com/apache/iceberg/pull/4030#issuecomment-1027675496","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4030","id":1027675496,"node_id":"IC_kwDOCW7NX849QRVo","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T08:01:29Z","updated_at":"2022-02-02T08:01:29Z","author_association":"CONTRIBUTOR","body":"cc @rdblue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027675496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027910132","html_url":"https://github.com/apache/iceberg/pull/3470#issuecomment-1027910132","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3470","id":1027910132,"node_id":"IC_kwDOCW7NX849RKn0","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T12:51:04Z","updated_at":"2022-02-02T12:51:04Z","author_association":"CONTRIBUTOR","body":"> Can we have a unit test for KeyStoreKmsClient? It can demo how the client is used.\r\n\r\nWe will have such a demo / unitest in a later PR, where a table is encrypted using a kms client. However, this rudimentary client won't be a good example for developers. I think the best KmsClient example would be based on Hashicorp Vault (a real KMS; open-source), similar to what we have in Apache Parquet - developed by @andersonm . Maya - will appreciate if you'd be ok with building/contributing such client to Iceberg too :), in a separate pull request.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027910132/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027919218","html_url":"https://github.com/apache/iceberg/pull/3470#issuecomment-1027919218","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3470","id":1027919218,"node_id":"IC_kwDOCW7NX849RM1y","user":{"login":"andersonm-ibm","id":63074550,"node_id":"MDQ6VXNlcjYzMDc0NTUw","avatar_url":"https://avatars.githubusercontent.com/u/63074550?v=4","gravatar_id":"","url":"https://api.github.com/users/andersonm-ibm","html_url":"https://github.com/andersonm-ibm","followers_url":"https://api.github.com/users/andersonm-ibm/followers","following_url":"https://api.github.com/users/andersonm-ibm/following{/other_user}","gists_url":"https://api.github.com/users/andersonm-ibm/gists{/gist_id}","starred_url":"https://api.github.com/users/andersonm-ibm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andersonm-ibm/subscriptions","organizations_url":"https://api.github.com/users/andersonm-ibm/orgs","repos_url":"https://api.github.com/users/andersonm-ibm/repos","events_url":"https://api.github.com/users/andersonm-ibm/events{/privacy}","received_events_url":"https://api.github.com/users/andersonm-ibm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T13:02:20Z","updated_at":"2022-02-02T13:02:20Z","author_association":"NONE","body":"> > Can we have a unit test for KeyStoreKmsClient? It can demo how the client is used.\r\n> \r\n> We will have such a demo / unitest in a later PR, where a table is encrypted using a kms client. However, this rudimentary client won't be a good example for developers. I think the best KmsClient example would be based on Hashicorp Vault (a real KMS; open-source), similar to what we have in Apache Parquet - developed by @andersonm . Maya - will appreciate if you'd be ok with building/contributing such client to Iceberg too :), in a separate pull request.\r\n\r\nYes, @ggershinsky , I am going to work on such an example in a separate PR. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027919218/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027976504","html_url":"https://github.com/apache/iceberg/pull/4018#issuecomment-1027976504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4018","id":1027976504,"node_id":"IC_kwDOCW7NX849Ra04","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T14:08:24Z","updated_at":"2022-02-02T14:32:25Z","author_association":"COLLABORATOR","body":"@SinghAsDev Thanks for your answer, I think you're raising a valid point here.\r\nAs I see it, there are two separate issues:\r\n- When creating external tables using the Hive engine, Hive appends `external.table.purge=true` to the table properties behind the scenes in `HiveIcebergMetaHook`. This goes against user expectations even in Hive 4.0+. I'll prepare a PR to fix that up on the Hive engine side (which should fix your Hive test failures presumably).\r\n- On the HiveCatalog-level, how do we want to handle different combinations of external/managed tables with the gc.enabled flag. I think it makes sense to disallow the MANAGED + `gc.enabled=false` combination. But I would not disallow the EXTERNAL + `gc.enabled=true` combination, exactly because Hive 4.0 makes this combination valid via the `external.table.purge=true` flag\r\n\r\nPlease let me know what you think, thanks!\r\ncc @pvary ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1027976504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028133737","html_url":"https://github.com/apache/iceberg/pull/4029#issuecomment-1028133737","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4029","id":1028133737,"node_id":"IC_kwDOCW7NX849SBNp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T16:43:09Z","updated_at":"2022-02-02T16:43:09Z","author_association":"CONTRIBUTOR","body":"Thanks, @izchen!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028133737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028134330","html_url":"https://github.com/apache/iceberg/pull/4030#issuecomment-1028134330","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4030","id":1028134330,"node_id":"IC_kwDOCW7NX849SBW6","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T16:43:46Z","updated_at":"2022-02-02T16:43:46Z","author_association":"CONTRIBUTOR","body":"Thanks for porting this, @izchen! Great to have these working.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028134330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028139703","html_url":"https://github.com/apache/iceberg/pull/4027#issuecomment-1028139703","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4027","id":1028139703,"node_id":"IC_kwDOCW7NX849SCq3","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T16:49:25Z","updated_at":"2022-02-02T16:49:25Z","author_association":"CONTRIBUTOR","body":"Looks good and doesn't change the actual protocol. Thanks for the fix, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028139703/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028140944","html_url":"https://github.com/apache/iceberg/pull/4025#issuecomment-1028140944","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4025","id":1028140944,"node_id":"IC_kwDOCW7NX849SC-Q","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T16:50:46Z","updated_at":"2022-02-02T16:50:46Z","author_association":"CONTRIBUTOR","body":"What was the line length without this? Do we need to do this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028140944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028142961","html_url":"https://github.com/apache/iceberg/pull/4024#issuecomment-1028142961","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4024","id":1028142961,"node_id":"IC_kwDOCW7NX849SDdx","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T16:52:53Z","updated_at":"2022-02-02T16:52:53Z","author_association":"CONTRIBUTOR","body":"There are a couple minor things to fix, but overall good catch. Thanks, @pan3793!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028142961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028143608","html_url":"https://github.com/apache/iceberg/pull/4024#issuecomment-1028143608","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4024","id":1028143608,"node_id":"IC_kwDOCW7NX849SDn4","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T16:53:33Z","updated_at":"2022-02-02T16:53:33Z","author_association":"CONTRIBUTOR","body":"I'm adding this to 0.13.1 since it is a regression.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028143608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028145839","html_url":"https://github.com/apache/iceberg/pull/4017#issuecomment-1028145839","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4017","id":1028145839,"node_id":"IC_kwDOCW7NX849SEKv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T16:55:46Z","updated_at":"2022-02-02T16:55:46Z","author_association":"CONTRIBUTOR","body":"I think the current behavior is correct. If you want to use a single table with Hive, then you can set the table property explicitly, but this is not recommended. If you're using Hive and it is enabled in the environment, then there should be no need to also mark the table because all Hive environments should have the property set. I think the problem is when your Hive environments (that is, HiveConf across engines) differs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028145839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028175781","html_url":"https://github.com/apache/iceberg/pull/4018#issuecomment-1028175781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4018","id":1028175781,"node_id":"IC_kwDOCW7NX849SLel","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T17:26:31Z","updated_at":"2022-02-02T17:26:31Z","author_association":"CONTRIBUTOR","body":"@szehon-ho that is a good point and I was also thinking about it. However, AFAIK, among all the clients Iceberg is used from, only Spark and Hive support external table concept, right? As such, I feel it should be OK to just limit this to Hive catalog. What do you think?\r\n\r\n\r\n> When creating external tables using the Hive engine, Hive appends external.table.purge=true to the table properties behind the scenes in HiveIcebergMetaHook. This goes against user expectations even in Hive 4.0+. I'll prepare a PR to fix that up on the Hive engine side (which should fix your Hive test failures presumably).\r\n\r\n@marton-bod this is exactly I was planning to do test failures here as well. Let me know if you fix it as a separate PR and I can rebase.\r\n\r\n> On the HiveCatalog-level, how do we want to handle different combinations of external/managed tables with the gc.enabled flag. I think it makes sense to disallow the MANAGED + gc.enabled=false combination. But I would not disallow the EXTERNAL + gc.enabled=true combination, exactly because Hive 4.0 makes this combination valid via the external.table.purge=true flag\r\n\r\n@marton-bod for disallowing EXTERNAL + gc.enabled=true, I think it makes sense for Hive 4.0+, but below that I think it is expected to not allow that, right? Maybe we can make this configurable. Would that be OK with you?\r\n\r\n@szehon-ho @marton-bod @pvary @rdblue I think we are at least aligned on the issue and the need for changing the behavior? If not, please let me know if I can provide more info. Since this change is a behavior change, I am curious is there a set of steps like user communication that we usually do or do we restrict such changes to dot releases?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028175781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028204110","html_url":"https://github.com/apache/iceberg/pull/4018#issuecomment-1028204110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4018","id":1028204110,"node_id":"IC_kwDOCW7NX849SSZO","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T17:56:42Z","updated_at":"2022-02-02T17:56:42Z","author_association":"COLLABORATOR","body":"@SinghAsDev sure, I was actually thinking more the other side (catalogs), what if a Spark user wants to use a non-Hive catalog, like hadoop-catalog, glue-catalog, then they would get a different behavior from the Iceberg table when trying to drop?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028204110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028220335","html_url":"https://github.com/apache/iceberg/pull/4018#issuecomment-1028220335","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4018","id":1028220335,"node_id":"IC_kwDOCW7NX849SWWv","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T18:15:22Z","updated_at":"2022-02-02T18:15:22Z","author_association":"CONTRIBUTOR","body":"@szehon-ho I see your point now, thanks. I think it makes sense to me to do this in Spark Catalog.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028220335/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028227955","html_url":"https://github.com/apache/iceberg/pull/4024#issuecomment-1028227955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4024","id":1028227955,"node_id":"IC_kwDOCW7NX849SYNz","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T18:24:34Z","updated_at":"2022-02-02T18:24:34Z","author_association":"MEMBER","body":"Addressed comments, also ported to spark 3.0/3.1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028227955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028233193","html_url":"https://github.com/apache/iceberg/pull/4017#issuecomment-1028233193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4017","id":1028233193,"node_id":"IC_kwDOCW7NX849SZfp","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T18:29:55Z","updated_at":"2022-02-02T18:33:28Z","author_association":"CONTRIBUTOR","body":"@rdblue it is true that if your Hadoop `Configuration` has iceberg.engine.hive.enabled set to true for all your writers, this is not an issue. I'd argue that as a matter of logical consistency, the table property should be set if the table is created as Hive-enabled, so that a future writer (whose configuration we may not be in control of) that updates the table does not drop that Hive-enabledness.\r\n\r\n[In `HiveTableOperations#doCommit`, we check if `hiveEngineEnabled` by checking if \"engine.hive.enabled\" is in the `TableMetadata`'s properties and using its value if so, else use the value of \"iceberg.engine.hive.enabled\" in the Hadoop `Configuration`, **defaulting to false**. Thus there are two routes to `hiveEngineEnabled` being true, because \"engine.hive.enabled\" is in the table properties, or because of the Hadoop `Configuration`. What I'm proposing is that we always then encode it in the table properties, so future commits will keep the table being Hive-enabled, regardless of the writer's Hadoop `Configuration`. Otherwise, `hiveEngineEnabled` could be true due to the `Configuration`, and not write the property to `TableMetadata`, and another writer comes along with a different `Configuration`, and `hiveEngineEnabled` is now false from the `TableMetadata`.]\r\n\r\nWe encountered the issue in a setting with a shared HMS serving multiple clusters.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028233193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028246824","html_url":"https://github.com/apache/iceberg/pull/4024#issuecomment-1028246824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4024","id":1028246824,"node_id":"IC_kwDOCW7NX849Sc0o","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T18:46:36Z","updated_at":"2022-02-02T18:46:36Z","author_association":"CONTRIBUTOR","body":"LGTM. Thanks for catching this @pan3793!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028246824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028251190","html_url":"https://github.com/apache/iceberg/pull/3314#issuecomment-1028251190","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3314","id":1028251190,"node_id":"IC_kwDOCW7NX849Sd42","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T18:50:35Z","updated_at":"2022-02-02T18:50:35Z","author_association":"CONTRIBUTOR","body":"Obsolete. Superseded by #3722 which is merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028251190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028253273","html_url":"https://github.com/apache/iceberg/pull/3852#issuecomment-1028253273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3852","id":1028253273,"node_id":"IC_kwDOCW7NX849SeZZ","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T18:52:01Z","updated_at":"2022-02-02T18:52:01Z","author_association":"CONTRIBUTOR","body":"@rdblue when you have time, can you please review? (This seems to have fallen off the radar.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028253273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028288966","html_url":"https://github.com/apache/iceberg/pull/4028#issuecomment-1028288966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4028","id":1028288966,"node_id":"IC_kwDOCW7NX849SnHG","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T19:35:40Z","updated_at":"2022-02-02T19:35:40Z","author_association":"CONTRIBUTOR","body":"Verified the command works:\r\n\r\n```\r\n$ shasum -a 512 --check apache-iceberg-0.13.0.tar.gz.sha512 \r\napache-iceberg-0.13.0.tar.gz: OK\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028288966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028402581","html_url":"https://github.com/apache/iceberg/pull/4024#issuecomment-1028402581","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4024","id":1028402581,"node_id":"IC_kwDOCW7NX849TC2V","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T22:06:23Z","updated_at":"2022-02-02T22:06:23Z","author_association":"CONTRIBUTOR","body":"Thanks, @pan3793!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028402581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028407625","html_url":"https://github.com/apache/iceberg/pull/3965#issuecomment-1028407625","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3965","id":1028407625,"node_id":"IC_kwDOCW7NX849TEFJ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T22:13:34Z","updated_at":"2022-02-02T22:13:34Z","author_association":"CONTRIBUTOR","body":"Looks good!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028407625/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028408742","html_url":"https://github.com/apache/iceberg/pull/4016#issuecomment-1028408742","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4016","id":1028408742,"node_id":"IC_kwDOCW7NX849TEWm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T22:15:05Z","updated_at":"2022-02-02T22:15:05Z","author_association":"CONTRIBUTOR","body":"This is looking good, but I just committed @jun-he's change that adds __eq__ since it was simple and unblocks him. Can you rebase and merge in those changes? That has a Singleton class that can be used in a couple places.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028408742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028414146","html_url":"https://github.com/apache/iceberg/pull/4025#issuecomment-1028414146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4025","id":1028414146,"node_id":"IC_kwDOCW7NX849TFrC","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T22:22:51Z","updated_at":"2022-02-02T22:23:49Z","author_association":"CONTRIBUTOR","body":"@rdblue the default for black is 88. From what I've seen, that's usually bumped up to somewhere in the range of 110-130. To see some of the side-effects of a low line-length setting, see [this](https://github.com/apache/iceberg/pull/4021#discussion_r796832091) comment on another PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028414146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028416262","html_url":"https://github.com/apache/iceberg/pull/4025#issuecomment-1028416262","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4025","id":1028416262,"node_id":"IC_kwDOCW7NX849TGMG","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T22:25:39Z","updated_at":"2022-02-02T22:25:39Z","author_association":"CONTRIBUTOR","body":"88 seems a bit small to me. Since we should do this when it will introduce as few changes as possible, I'll go ahead and merge. Thanks, @samredai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028416262/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028417863","html_url":"https://github.com/apache/iceberg/pull/4025#issuecomment-1028417863","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4025","id":1028417863,"node_id":"IC_kwDOCW7NX849TGlH","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T22:27:59Z","updated_at":"2022-02-02T22:27:59Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue. I'm going to open a quick follow-up PR to autoformat again. Looks like a PR was merged after I opened this so wasn't caught here!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028417863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028418509","html_url":"https://github.com/apache/iceberg/pull/4025#issuecomment-1028418509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4025","id":1028418509,"node_id":"IC_kwDOCW7NX849TGvN","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T22:28:57Z","updated_at":"2022-02-02T22:28:57Z","author_association":"CONTRIBUTOR","body":"Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028418509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028430254","html_url":"https://github.com/apache/iceberg/pull/2925#issuecomment-1028430254","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2925","id":1028430254,"node_id":"IC_kwDOCW7NX849TJmu","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T22:48:12Z","updated_at":"2022-02-02T22:48:12Z","author_association":"COLLABORATOR","body":"FYI, filed https://github.com/apache/iceberg/pull/4033 and https://github.com/apache/iceberg/issues/4031 about the random failure of TestCopyOnWriteUpdate::testUpdateWithoutCondition","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028430254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028430832","html_url":"https://github.com/apache/iceberg/pull/4033#issuecomment-1028430832","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4033","id":1028430832,"node_id":"IC_kwDOCW7NX849TJvw","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T22:49:10Z","updated_at":"2022-02-02T22:49:10Z","author_association":"COLLABORATOR","body":"@aokolnychyi. fyi, also open if there are better ideas for making this test more deterministic","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028430832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028457154","html_url":"https://github.com/apache/iceberg/pull/4019#issuecomment-1028457154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4019","id":1028457154,"node_id":"IC_kwDOCW7NX849TQLC","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T23:31:58Z","updated_at":"2022-02-02T23:32:16Z","author_association":"CONTRIBUTOR","body":"Thanks for the work, merged! And thanks for the review @rdblue @nastra ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028457154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028461391","html_url":"https://github.com/apache/iceberg/pull/4009#issuecomment-1028461391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4009","id":1028461391,"node_id":"IC_kwDOCW7NX849TRNP","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T23:39:55Z","updated_at":"2022-02-02T23:39:55Z","author_association":"CONTRIBUTOR","body":"@fqaiser94 I'm not able to turn them on either, but if you `./gradlew clean check  -DflinkVersions=1.12,1.13,1.14 -DsparkVersions=2.4,3.0,3.1,3.2 -DhiveVersions=2,3` locally on Java 8, that's more or less every test. Some of those don't support Java 11 though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028461391/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028467451","html_url":"https://github.com/apache/iceberg/issues/732#issuecomment-1028467451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/732","id":1028467451,"node_id":"IC_kwDOCW7NX849TSr7","user":{"login":"atronchi","id":4906224,"node_id":"MDQ6VXNlcjQ5MDYyMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/4906224?v=4","gravatar_id":"","url":"https://api.github.com/users/atronchi","html_url":"https://github.com/atronchi","followers_url":"https://api.github.com/users/atronchi/followers","following_url":"https://api.github.com/users/atronchi/following{/other_user}","gists_url":"https://api.github.com/users/atronchi/gists{/gist_id}","starred_url":"https://api.github.com/users/atronchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/atronchi/subscriptions","organizations_url":"https://api.github.com/users/atronchi/orgs","repos_url":"https://api.github.com/users/atronchi/repos","events_url":"https://api.github.com/users/atronchi/events{/privacy}","received_events_url":"https://api.github.com/users/atronchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-02T23:52:43Z","updated_at":"2022-02-02T23:52:43Z","author_association":"NONE","body":"For a more realistic use case, consider swapping the partition name `identity` in @waterlx case above for `date`, and a backfill which needs to overwrite the partitions running many days in parallel. I found this thread from exactly this use case, which triggered a deluge of Spark job failures failing on the `CommitFailedException`. Probably Spark should retry the commit in such cases instead of hard failing the job, which requires us to re-run the execution.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028467451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028481011","html_url":"https://github.com/apache/iceberg/issues/732#issuecomment-1028481011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/732","id":1028481011,"node_id":"IC_kwDOCW7NX849TV_z","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T00:17:46Z","updated_at":"2023-06-19T20:42:03Z","author_association":"CONTRIBUTOR","body":"@atronchi, Spark will actually retry. You can bump up the number of retries by setting the `commit.retry.num-retries` in [table properties](https://iceberg.apache.org/configuration/#table-behavior-properties). There are other settings for retries, like the wait time and max timeout as well.\r\n\r\nWith several commits happening at the same time, you probably just need to bump up the number of retries. The situation that @waterlx hit here was that there was a lot of work needed for each retry so the likelihood of conflict was really large. If you run into something similar, then I recommend using the [`RewriteManifests`](https://iceberg.apache.org/maintenance/#rewrite-manifests) approach I mentioned. That is now available as a [stored procedure](https://iceberg.apache.org/spark-procedures/#rewrite_manifests) so it is very simple to rewrite your manifests and avoid conflicts so retries can reuse more work and commit faster.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028481011/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028497573","html_url":"https://github.com/apache/iceberg/pull/4025#issuecomment-1028497573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4025","id":1028497573,"node_id":"IC_kwDOCW7NX849TaCl","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T00:49:22Z","updated_at":"2022-02-03T00:49:22Z","author_association":"COLLABORATOR","body":"Thanks @samredai ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028497573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028497784","html_url":"https://github.com/apache/iceberg/pull/4032#issuecomment-1028497784","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4032","id":1028497784,"node_id":"IC_kwDOCW7NX849TaF4","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T00:49:47Z","updated_at":"2022-02-03T00:49:47Z","author_association":"COLLABORATOR","body":"LGTM. Thanks @samredai ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028497784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028714442","html_url":"https://github.com/apache/iceberg/issues/3997#issuecomment-1028714442","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3997","id":1028714442,"node_id":"IC_kwDOCW7NX849UO_K","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T08:19:20Z","updated_at":"2022-02-03T08:19:20Z","author_association":"CONTRIBUTOR","body":"With the new RestAPI design, we should be able to use RDBMS or key-value store to replace the metadata.json files. The new APIs is WIP, the client will be provided in Iceberg repo, but user needs to implement the server side once the APIs are ready. However, I believe the open source server will be there eventually, it is probably another project.\nOther than metadata.json file, it needs a major overhaul to put manifest-list or manifest files into RDBMS/Key-value store. It is possible theoretically, but not sure it is the way people want to go.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028714442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028715893","html_url":"https://github.com/apache/iceberg/pull/3470#issuecomment-1028715893","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3470","id":1028715893,"node_id":"IC_kwDOCW7NX849UPV1","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T08:21:07Z","updated_at":"2022-02-03T10:57:52Z","author_association":"CONTRIBUTOR","body":"> The only real concern I have is that the test class implementations are here but we don't make sure they work. That's probably fine since the actual usage of this interface will exercise those apis? If that's coming up then +1 from me\r\n\r\nYep, these implementations are placed in the test module; they'll serve as a util for a unitest that encrypts/decrypts a table using these test kms classes. This unitest is coming up in the 5th PR in this series, where we connect all parts to enable table encryption.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028715893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028868002","html_url":"https://github.com/apache/iceberg/pull/3470#issuecomment-1028868002","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3470","id":1028868002,"node_id":"IC_kwDOCW7NX849U0ei","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T11:01:35Z","updated_at":"2022-02-03T11:01:35Z","author_association":"CONTRIBUTOR","body":"the commit addresses the comments in the last round. I also made an extra change in the Keystore client (using env var instead of hadoop prop for the password; this is safer and more intuitive). ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1028868002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029003852","html_url":"https://github.com/apache/iceberg/issues/3997#issuecomment-1029003852","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3997","id":1029003852,"node_id":"IC_kwDOCW7NX849VVpM","user":{"login":"melin","id":1145830,"node_id":"MDQ6VXNlcjExNDU4MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1145830?v=4","gravatar_id":"","url":"https://api.github.com/users/melin","html_url":"https://github.com/melin","followers_url":"https://api.github.com/users/melin/followers","following_url":"https://api.github.com/users/melin/following{/other_user}","gists_url":"https://api.github.com/users/melin/gists{/gist_id}","starred_url":"https://api.github.com/users/melin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melin/subscriptions","organizations_url":"https://api.github.com/users/melin/orgs","repos_url":"https://api.github.com/users/melin/repos","events_url":"https://api.github.com/users/melin/events{/privacy}","received_events_url":"https://api.github.com/users/melin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T13:42:36Z","updated_at":"2022-02-03T13:42:36Z","author_association":"NONE","body":"Bytedance has implemented Hudi MetaStore Server，https://cwiki.apache.org/confluence/display/HUDI/RFC-36%3A+HUDI+Metastore+Server","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029003852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029035117","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-1029035117","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":1029035117,"node_id":"IC_kwDOCW7NX849VdRt","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T14:18:02Z","updated_at":"2022-02-03T14:18:02Z","author_association":"CONTRIBUTOR","body":"@rdblue Any other concerns about this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029035117/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029140521","html_url":"https://github.com/apache/iceberg/pull/4032#issuecomment-1029140521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4032","id":1029140521,"node_id":"IC_kwDOCW7NX849V3Ap","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T16:01:47Z","updated_at":"2022-02-03T16:01:47Z","author_association":"CONTRIBUTOR","body":"There are some PR's open targeting `test_types.py` which implicitly include this auto-formatting. So merging there would mean this can be closed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029140521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029142996","html_url":"https://github.com/apache/iceberg/pull/4016#issuecomment-1029142996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4016","id":1029142996,"node_id":"IC_kwDOCW7NX849V3nU","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T16:04:19Z","updated_at":"2022-02-03T16:04:19Z","author_association":"CONTRIBUTOR","body":"I took a look at this test failure and it looks like it might be transient. I suspect rerunning the 3.8 test should succeed. That being said I noticed that `--diff` is not included so we don't see any details in the logs on which lines are causing the lint failure so I opened PR #4034 to add that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029142996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029227432","html_url":"https://github.com/apache/iceberg/pull/4016#issuecomment-1029227432","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4016","id":1029227432,"node_id":"IC_kwDOCW7NX849WMOo","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T17:29:13Z","updated_at":"2022-02-03T17:29:13Z","author_association":"CONTRIBUTOR","body":"@rdblue Merged in those changes. I think it's in line with the discussion @jun-he and I were having in his PR. Singleton is as it was in his","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029227432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029231888","html_url":"https://github.com/apache/iceberg/issues/4035#issuecomment-1029231888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4035","id":1029231888,"node_id":"IC_kwDOCW7NX849WNUQ","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T17:34:07Z","updated_at":"2022-02-03T17:34:07Z","author_association":"COLLABORATOR","body":"Looks like in the log like it's actually making steady progress (up to 123/200 executors when it finished)\r\n\r\nIf you are running locally maybe there are just too many partitions after the repartition and not enough resources?\r\n\r\n```\r\n22/02/03 19:04:07 INFO Executor: Running task 117.0 in stage 1.0 (TID 121)\r\n22/02/03 19:04:07 INFO TaskSetManager: Finished task 116.0 in stage 1.0 (TID 120) in 1385 ms on LT0089527.in.ril.com (executor driver) (120/200)\r\n22/02/03 19:04:07 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks\r\n22/02/03 19:04:07 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms\r\n22/02/03 19:04:07 INFO CodecPool: Got brand-new compressor [.gz]\r\n22/02/03 19:04:09 INFO DataWritingSparkTask: Commit authorized for partition 117 (task 121, attempt 0, stage 1.0)\r\n22/02/03 19:04:09 INFO DataWritingSparkTask: Committed partition 117 (task 121, attempt 0, stage 1.0)\r\n22/02/03 19:04:09 INFO Executor: Finished task 117.0 in stage 1.0 (TID 121). 2462 bytes result sent to driver\r\n22/02/03 19:04:09 INFO TaskSetManager: Starting task 118.0 in stage 1.0 (TID 122, LT0089527.in.ril.com, executor driver, partition 118, PROCESS_LOCAL, 7325 bytes)\r\n22/02/03 19:04:09 INFO TaskSetManager: Finished task 117.0 in stage 1.0 (TID 121) in 1321 ms on LT0089527.in.ril.com (executor driver) (121/200)\r\n22/02/03 19:04:09 INFO Executor: Running task 118.0 in stage 1.0 (TID 122)\r\n22/02/03 19:04:09 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks\r\n22/02/03 19:04:09 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms\r\n22/02/03 19:04:09 INFO CodecPool: Got brand-new compressor [.gz]\r\n22/02/03 19:04:10 INFO DataWritingSparkTask: Commit authorized for partition 118 (task 122, attempt 0, stage 1.0)\r\n22/02/03 19:04:10 INFO DataWritingSparkTask: Committed partition 118 (task 122, attempt 0, stage 1.0)\r\n22/02/03 19:04:10 INFO Executor: Finished task 118.0 in stage 1.0 (TID 122). 2462 bytes result sent to driver\r\n22/02/03 19:04:10 INFO TaskSetManager: Starting task 119.0 in stage 1.0 (TID 123, LT0089527.in.ril.com, executor driver, partition 119, PROCESS_LOCAL, 7325 bytes)\r\n22/02/03 19:04:10 INFO Executor: Running task 119.0 in stage 1.0 (TID 123)\r\n22/02/03 19:04:10 INFO TaskSetManager: Finished task 118.0 in stage 1.0 (TID 122) in 1409 ms on LT0089527.in.ril.com (executor driver) (122/200)\r\n22/02/03 19:04:10 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks\r\n22/02/03 19:04:10 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms\r\n22/02/03 19:04:10 INFO CodecPool: Got brand-new compressor [.gz]\r\n22/02/03 19:04:12 INFO DataWritingSparkTask: Commit authorized for partition 119 (task 123, attempt 0, stage 1.0)\r\n22/02/03 19:04:12 INFO DataWritingSparkTask: Committed partition 119 (task 123, attempt 0, stage 1.0)\r\n22/02/03 19:04:12 INFO Executor: Finished task 119.0 in stage 1.0 (TID 123). 2462 bytes result sent to driver\r\n22/02/03 19:04:12 INFO TaskSetManager: Starting task 120.0 in stage 1.0 (TID 124, LT0089527.in.ril.com, executor driver, partition 120, PROCESS_LOCAL, 7325 bytes)\r\n22/02/03 19:04:12 INFO Executor: Running task 120.0 in stage 1.0 (TID 124)\r\n22/02/03 19:04:12 INFO TaskSetManager: Finished task 119.0 in stage 1.0 (TID 123) in 2072 ms on LT0089527.in.ril.com (executor driver) (123/200)\r\n22/02/03 19:04:12 INFO ShuffleBlockFetcherIterator: Getting 0 (0.0 B) non-empty blocks including 0 (0.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) remote blocks\r\n22/02/03 19:04:12 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms\r\n22/02/03 19:04:12 INFO CodecPool: Got brand-new compressor [.gz]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029231888/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029240505","html_url":"https://github.com/apache/iceberg/issues/4035#issuecomment-1029240505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4035","id":1029240505,"node_id":"IC_kwDOCW7NX849WPa5","user":{"login":"akghbti","id":64609106,"node_id":"MDQ6VXNlcjY0NjA5MTA2","avatar_url":"https://avatars.githubusercontent.com/u/64609106?v=4","gravatar_id":"","url":"https://api.github.com/users/akghbti","html_url":"https://github.com/akghbti","followers_url":"https://api.github.com/users/akghbti/followers","following_url":"https://api.github.com/users/akghbti/following{/other_user}","gists_url":"https://api.github.com/users/akghbti/gists{/gist_id}","starred_url":"https://api.github.com/users/akghbti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akghbti/subscriptions","organizations_url":"https://api.github.com/users/akghbti/orgs","repos_url":"https://api.github.com/users/akghbti/repos","events_url":"https://api.github.com/users/akghbti/events{/privacy}","received_events_url":"https://api.github.com/users/akghbti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T17:44:18Z","updated_at":"2022-02-03T17:44:18Z","author_association":"NONE","body":"No its not getting completed...Its actually stuck in writing the last file (deleting and recreating it) in the data folder..\r\nvideo attached.\r\n\r\nhttps://user-images.githubusercontent.com/64609106/152398681-7e1272d6-7bea-4d04-9237-5ae58739c5d6.mp4\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029240505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029241860","html_url":"https://github.com/apache/iceberg/issues/4035#issuecomment-1029241860","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4035","id":1029241860,"node_id":"IC_kwDOCW7NX849WPwE","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T17:45:54Z","updated_at":"2022-02-03T17:46:54Z","author_association":"MEMBER","body":"Your video shows it creating a different file every single time. You can watch the number increase. Most likely based on the log the repartition is producing a lot of empty tasks? That at least would be my guess since each file is 0 bytes and then disappears (maybe a file handle that is opened and then closed without modification?)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029241860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029243769","html_url":"https://github.com/apache/iceberg/issues/4035#issuecomment-1029243769","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4035","id":1029243769,"node_id":"IC_kwDOCW7NX849WQN5","user":{"login":"akghbti","id":64609106,"node_id":"MDQ6VXNlcjY0NjA5MTA2","avatar_url":"https://avatars.githubusercontent.com/u/64609106?v=4","gravatar_id":"","url":"https://api.github.com/users/akghbti","html_url":"https://github.com/akghbti","followers_url":"https://api.github.com/users/akghbti/followers","following_url":"https://api.github.com/users/akghbti/following{/other_user}","gists_url":"https://api.github.com/users/akghbti/gists{/gist_id}","starred_url":"https://api.github.com/users/akghbti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akghbti/subscriptions","organizations_url":"https://api.github.com/users/akghbti/orgs","repos_url":"https://api.github.com/users/akghbti/repos","events_url":"https://api.github.com/users/akghbti/events{/privacy}","received_events_url":"https://api.github.com/users/akghbti/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T17:48:19Z","updated_at":"2022-02-03T17:53:46Z","author_association":"NONE","body":"I will wait for a bit long and then report here..But if the partition is empty why the file is being created and deleted later..can't the writing be skipped totally. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029243769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029244367","html_url":"https://github.com/apache/iceberg/pull/2496#issuecomment-1029244367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2496","id":1029244367,"node_id":"IC_kwDOCW7NX849WQXP","user":{"login":"shenodaguirguis","id":45050883,"node_id":"MDQ6VXNlcjQ1MDUwODgz","avatar_url":"https://avatars.githubusercontent.com/u/45050883?v=4","gravatar_id":"","url":"https://api.github.com/users/shenodaguirguis","html_url":"https://github.com/shenodaguirguis","followers_url":"https://api.github.com/users/shenodaguirguis/followers","following_url":"https://api.github.com/users/shenodaguirguis/following{/other_user}","gists_url":"https://api.github.com/users/shenodaguirguis/gists{/gist_id}","starred_url":"https://api.github.com/users/shenodaguirguis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shenodaguirguis/subscriptions","organizations_url":"https://api.github.com/users/shenodaguirguis/orgs","repos_url":"https://api.github.com/users/shenodaguirguis/repos","events_url":"https://api.github.com/users/shenodaguirguis/events{/privacy}","received_events_url":"https://api.github.com/users/shenodaguirguis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T17:49:05Z","updated_at":"2022-02-03T17:49:05Z","author_association":"NONE","body":"hi @RussellSpitzer , @rymurr ,\r\n  As @wmoustafa  shared on this [thread](https://lists.apache.org/thread/z3r2wjycd9yp5l24tto5ol3dmssoqo9j),  we have deployed support for non-null default values for AVRO and ORC formats at LinkedIn in production for a while now, which enabled us to rollout Hive tables to Iceberg (as a step towards converting the tables transparently to Iceberg format). The relevant changes in LinkedIn's fork are listed below for reference. I have updated this PR to reflect the its final state. Please take a look at your earliest convenience.  \r\n\r\n**LinkedIn/Iceberg PRs related to supporting non-null default values:**\r\n-  [Support default value semantic for AVRO PR#75](https://github.com/linkedin/iceberg/pull/75)\r\n which combines the following three PRs:\r\n  [API changes PR#63](https://github.com/linkedin/iceberg/pull/63)\r\n  [Schema Mapping changes PR#69](https://github.com/linkedin/iceberg/pull/69) \r\n  [Use default values reading AVRO PR#72](https://github.com/linkedin/iceberg/pull/72)\r\n\r\n-  [Support default value read for ORC format in spark PR#76](https://github.com/linkedin/iceberg/pull/76)\r\n\r\n- [(optional) Move to Avro 1.10.2 PR#82](https://github.com/linkedin/iceberg/pull/82)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029244367/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029245968","html_url":"https://github.com/apache/iceberg/pull/4009#issuecomment-1029245968","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4009","id":1029245968,"node_id":"IC_kwDOCW7NX849WQwQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T17:51:04Z","updated_at":"2022-02-03T17:51:04Z","author_association":"CONTRIBUTOR","body":"Great to see someone working on this. Thank you, @fqaiser94!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029245968/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029255457","html_url":"https://github.com/apache/iceberg/pull/2496#issuecomment-1029255457","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2496","id":1029255457,"node_id":"IC_kwDOCW7NX849WTEh","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T18:01:51Z","updated_at":"2022-02-03T18:02:04Z","author_association":"MEMBER","body":"I Think the first step to getting default value semantics in, would be changing the Spec so that fields are allowed to have \"default values\".  We should also outline expected behaviors in case of changing defaults and and modifying of rows with default values.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029255457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029259783","html_url":"https://github.com/apache/iceberg/pull/4009#issuecomment-1029259783","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4009","id":1029259783,"node_id":"IC_kwDOCW7NX849WUIH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T18:06:26Z","updated_at":"2022-02-03T18:06:26Z","author_association":"CONTRIBUTOR","body":"This looks really close to being ready to commit to me. I'd like to separate the 2.13 tests out into a separate CI run so that we don't cause 3.1 and 3.2 tests to take twice as long.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029259783/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029266880","html_url":"https://github.com/apache/iceberg/pull/4018#issuecomment-1029266880","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4018","id":1029266880,"node_id":"IC_kwDOCW7NX849WV3A","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T18:15:04Z","updated_at":"2022-02-03T18:15:04Z","author_association":"CONTRIBUTOR","body":"I'm -1 for changing this in the Iceberg library. The right way to do this is to customize your catalog.\r\n\r\nIceberg has no concept of an \"external\" table and although it does define `gc.enabled`, I don't think it is a good idea to conflate the two. The `gc.enabled` property is set when it isn't safe to drop table files. For example, when files are shared across branches in Nessie, it isn't safe to delete files using the metadata of any single branch. Imported tables also set this flag because the files may be \"owned\" by another table. These are narrow cases and `gc.enabled` is a safety valve.\r\n\r\nIn normal operation, you never want users accidentally turning on `gc.enabled` because it will prevent old snapshots from getting cleaned up and will effectively keep all versions of the table forever. That's really bad.\r\n\r\nIf the goal here is to avoid purging table data on delete, then there is another way to do that. `gc.enabled` is not the right mechanism to do it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029266880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029315129","html_url":"https://github.com/apache/iceberg/pull/2496#issuecomment-1029315129","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2496","id":1029315129,"node_id":"IC_kwDOCW7NX849Who5","user":{"login":"shenodaguirguis","id":45050883,"node_id":"MDQ6VXNlcjQ1MDUwODgz","avatar_url":"https://avatars.githubusercontent.com/u/45050883?v=4","gravatar_id":"","url":"https://api.github.com/users/shenodaguirguis","html_url":"https://github.com/shenodaguirguis","followers_url":"https://api.github.com/users/shenodaguirguis/followers","following_url":"https://api.github.com/users/shenodaguirguis/following{/other_user}","gists_url":"https://api.github.com/users/shenodaguirguis/gists{/gist_id}","starred_url":"https://api.github.com/users/shenodaguirguis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shenodaguirguis/subscriptions","organizations_url":"https://api.github.com/users/shenodaguirguis/orgs","repos_url":"https://api.github.com/users/shenodaguirguis/repos","events_url":"https://api.github.com/users/shenodaguirguis/events{/privacy}","received_events_url":"https://api.github.com/users/shenodaguirguis/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T19:14:56Z","updated_at":"2022-02-03T19:14:56Z","author_association":"NONE","body":"@RussellSpitzer are you referring to [this](https://github.com/apache/iceberg/pull/2496/files#diff-712079321f18196c99853a45468cd71c27d6e38d12516b4fd1489fd31154f818) or something else?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029315129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029413929","html_url":"https://github.com/apache/iceberg/pull/2496#issuecomment-1029413929","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2496","id":1029413929,"node_id":"IC_kwDOCW7NX849W5wp","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T21:22:02Z","updated_at":"2022-02-03T21:26:44Z","author_association":"MEMBER","body":"> @RussellSpitzer are you referring to [this](https://github.com/apache/iceberg/pull/2496/files#diff-712079321f18196c99853a45468cd71c27d6e38d12516b4fd1489fd31154f818) or something else?\r\n\r\nI think the behaviors need to be elaborated a bit more than that and we also need information in JSON Serialzation (Appendix C)\r\n\r\nFor example, does a writer upon rewriting a file with a default value set, materialize that value? If the default for a column is changed do we change the value? I think \"manifested\" needs explanation as well. If defaults are used on writers I think we probably need to explain that in the writer section.\r\n\r\nSo to list all of the things.\r\n\r\nA field is required and has a default value, What does this mean on writing/rewriting + reading. What happens if this default is changed in the schema but the column id remains the same.\r\n\r\nA field is optional and has a default value, What does this mean on writing/rewriting + reading. What happens if this default is changed ...\r\n\r\nCan a default valued field be applied to files where the column ID of the field is not present? I believe this is part of the idea here but i'm not sure how it would be defined. Is the idea that if the column ID is not present in a given data file do we always just return the default of the current schema?\r\n\r\nDo defaults exist retroactively or are they always forward looking?\r\n\r\nAn example being:\r\n\r\nSay I have file A' without column id 3 which has a default in my spec of \"foo\". If I read rows out of fileA' with this schema do I return foo? If I later read the table where the spec has a default for column3 of \"bar\" do I read bar? If I rewrite the datafiles inbetween the schema changes do I get foo or bar or null?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029413929/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029507580","html_url":"https://github.com/apache/iceberg/issues/3896#issuecomment-1029507580","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3896","id":1029507580,"node_id":"IC_kwDOCW7NX849XQn8","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-03T23:48:44Z","updated_at":"2022-02-03T23:48:44Z","author_association":"CONTRIBUTOR","body":"There is also some more clarity with what it could look like based on the discussion in https://github.com/apache/iceberg/pull/3883 (in particular https://github.com/apache/iceberg/pull/3883#discussion_r795274832). @jackye1995 I am happy to take this issue if possible! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1029507580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030073667","html_url":"https://github.com/apache/iceberg/pull/4018#issuecomment-1030073667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4018","id":1030073667,"node_id":"IC_kwDOCW7NX849Za1D","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T15:08:41Z","updated_at":"2022-02-04T15:08:41Z","author_association":"CONTRIBUTOR","body":"Thanks for the thoughts @rdblue . I think what you said about iceberg not having a concept of 'external' is definitely a good point. However, Iceberg's spark catalog does allow spark sql users to create iceberg tables from spark sql, and spark sql supports the 'external' concept. This leads to the situation where unexpected dropping of data happen. I think we can maybe make not supporting of external tables explicit by throwing a informative exception during create tables in spark catalog. @rdblue would that be a reasonable approach?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030073667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030075657","html_url":"https://github.com/apache/iceberg/pull/4011#issuecomment-1030075657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4011","id":1030075657,"node_id":"IC_kwDOCW7NX849ZbUJ","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T15:10:46Z","updated_at":"2022-02-04T15:10:46Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue just wanted to bump this and see if you would have cycles to review this. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030075657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030078552","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1030078552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1030078552,"node_id":"IC_kwDOCW7NX849ZcBY","user":{"login":"cccs-br","id":56260250,"node_id":"MDQ6VXNlcjU2MjYwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/56260250?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-br","html_url":"https://github.com/cccs-br","followers_url":"https://api.github.com/users/cccs-br/followers","following_url":"https://api.github.com/users/cccs-br/following{/other_user}","gists_url":"https://api.github.com/users/cccs-br/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-br/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-br/subscriptions","organizations_url":"https://api.github.com/users/cccs-br/orgs","repos_url":"https://api.github.com/users/cccs-br/repos","events_url":"https://api.github.com/users/cccs-br/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-br/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T15:14:03Z","updated_at":"2022-02-04T15:44:34Z","author_association":"NONE","body":"FYI, since the official release of 0.13, the artifact is available with these coordinates...\r\n\r\nSpark: 3.2.0\r\nIceberg: 0.13\r\n\r\nsbt:\r\n```\r\n// https://mvnrepository.com/artifact/org.apache.iceberg/iceberg-spark-runtime\r\nlibraryDependencies += \"org.apache.iceberg\" %% \"iceberg-spark-runtime-3.2\" % \"0.13.0\"\r\n```\r\n\r\nmaven\r\n```\r\n<!-- https://mvnrepository.com/artifact/org.apache.iceberg/iceberg-spark-runtime-3.2 -->\r\n<dependency>\r\n    <groupId>org.apache.iceberg</groupId>\r\n    <artifactId>iceberg-spark-runtime-3.2_2.12</artifactId>\r\n    <version>0.13.0</version>\r\n</dependency>\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030078552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030135791","html_url":"https://github.com/apache/iceberg/pull/3677#issuecomment-1030135791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3677","id":1030135791,"node_id":"IC_kwDOCW7NX849Zp_v","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T16:16:23Z","updated_at":"2022-02-04T16:18:06Z","author_association":"CONTRIBUTOR","body":"I think this is ready for another look. I've rebased with the commits from the file io PR that was merged. The table metadata class has a `from_input_file` and `to_output_file` method that takes an `InputFile` or `OutputFile` instance.\r\n\r\nAnother thing I did was move the `LocalFileIO`, `LocalInputFile`, and `LocalOutputFile` implementations to `conftest.py` as a fixture that can be used across all tests (see the docstring at the top of `conftest.py` for more details).\r\n\r\nIf we can settle on the design here, I think a thorough inspection of the V1 and V2 jsonschemas defined here is needed before merging.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030135791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030205626","html_url":"https://github.com/apache/iceberg/pull/3986#issuecomment-1030205626","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3986","id":1030205626,"node_id":"IC_kwDOCW7NX849Z7C6","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T17:38:10Z","updated_at":"2022-02-04T17:38:10Z","author_association":"CONTRIBUTOR","body":"Looks good. Thanks for fixing this, @coolderli!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030205626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030208833","html_url":"https://github.com/apache/iceberg/issues/2934#issuecomment-1030208833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2934","id":1030208833,"node_id":"IC_kwDOCW7NX849Z71B","user":{"login":"cccs-br","id":56260250,"node_id":"MDQ6VXNlcjU2MjYwMjUw","avatar_url":"https://avatars.githubusercontent.com/u/56260250?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-br","html_url":"https://github.com/cccs-br","followers_url":"https://api.github.com/users/cccs-br/followers","following_url":"https://api.github.com/users/cccs-br/following{/other_user}","gists_url":"https://api.github.com/users/cccs-br/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-br/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-br/subscriptions","organizations_url":"https://api.github.com/users/cccs-br/orgs","repos_url":"https://api.github.com/users/cccs-br/repos","events_url":"https://api.github.com/users/cccs-br/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-br/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T17:42:36Z","updated_at":"2022-02-04T17:42:36Z","author_association":"NONE","body":"I confirm that this is now fixed with:\r\n\r\nSpark: 3.2.0\r\nIceberg: 0.13\r\n\r\nI've updated [spark-iceberg-issue](https://github.com/cccs-br/spark-iceberg-issue) repo with these latest artifacts and now all tests are passing.\r\n\r\nThanks everyone who worked on solving this!\r\n\r\nCheers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030208833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030315042","html_url":"https://github.com/apache/iceberg/pull/4039#issuecomment-1030315042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4039","id":1030315042,"node_id":"IC_kwDOCW7NX849aVwi","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T20:11:36Z","updated_at":"2022-02-04T20:11:36Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @danielcweeks @RussellSpitzer @jackye1995 @nastra @flyrain @szehon-ho","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030315042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030399188","html_url":"https://github.com/apache/iceberg/pull/3959#issuecomment-1030399188","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3959","id":1030399188,"node_id":"IC_kwDOCW7NX849aqTU","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T22:25:56Z","updated_at":"2022-02-04T22:25:56Z","author_association":"CONTRIBUTOR","body":"> @danielcweeks When we discussed this were you thinking about no metrics for tables with more than 100 columns? or no metrics for anything other than the first 100 columns.\r\n> \r\n> Obviously in both cases we keep sort column metrics by default\r\n\r\n@RussellSpitzer I would think it would be either all or nothing.  I'm not sure we can speculate that the first 100 columns are somehow more meaningful than those that follow (though I guess you could make that argument).\r\n\r\nFor now it seems like just taking a simple approach would be better.  There are some edge cases like what happens in the event that someone is incrementally adding columns and it crosses that threshold, but I wouldn't worry about it too much at this point.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030399188/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030417662","html_url":"https://github.com/apache/iceberg/pull/4041#issuecomment-1030417662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4041","id":1030417662,"node_id":"IC_kwDOCW7NX849auz-","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T23:05:14Z","updated_at":"2022-02-04T23:05:14Z","author_association":"CONTRIBUTOR","body":"@jun-he @TGooch44 could you take a look? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030417662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030421595","html_url":"https://github.com/apache/iceberg/pull/3984#issuecomment-1030421595","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3984","id":1030421595,"node_id":"IC_kwDOCW7NX849avxb","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T23:13:49Z","updated_at":"2022-02-04T23:13:49Z","author_association":"CONTRIBUTOR","body":"@rdblue, I've introduced a parent class to reduce the code duplication in unpartitioned and partitioned delta writers, added tests for out of order records when we update a partition column and added a test for static partition pruning. Dynamic pruning for merge-on-read is a little bit tricky to trigger (we just use the regular scan). I'll give it another try in MERGE.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030421595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030429954","html_url":"https://github.com/apache/iceberg/pull/3984#issuecomment-1030429954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3984","id":1030429954,"node_id":"IC_kwDOCW7NX849ax0C","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-04T23:34:02Z","updated_at":"2022-02-04T23:34:02Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @szehon-ho @rdblue @singhpk234! Issue #4042 remains open.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030429954/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030461083","html_url":"https://github.com/apache/iceberg/pull/4043#issuecomment-1030461083","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4043","id":1030461083,"node_id":"IC_kwDOCW7NX849a5ab","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-05T00:29:58Z","updated_at":"2022-02-05T00:29:58Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer @flyrain @szehon-ho @rdblue @kbendick ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030461083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030470872","html_url":"https://github.com/apache/iceberg/issues/4046#issuecomment-1030470872","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4046","id":1030470872,"node_id":"IC_kwDOCW7NX849a7zY","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-05T00:53:54Z","updated_at":"2022-02-05T00:53:54Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer @flyrain ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030470872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030484715","html_url":"https://github.com/apache/iceberg/issues/3630#issuecomment-1030484715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3630","id":1030484715,"node_id":"IC_kwDOCW7NX849a_Lr","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-05T01:11:36Z","updated_at":"2022-02-05T01:11:36Z","author_association":"CONTRIBUTOR","body":"Resolved by #3984.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030484715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030489321","html_url":"https://github.com/apache/iceberg/issues/4012#issuecomment-1030489321","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4012","id":1030489321,"node_id":"IC_kwDOCW7NX849bATp","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-05T01:29:00Z","updated_at":"2022-02-05T01:29:00Z","author_association":"COLLABORATOR","body":"@amogh-jahagirdar  @jackye1995  are you guys working on it?  I chatted with @dramaticlly , maybe we can give it a try if you haven't started it yet?  \r\n\r\nWas thinking we can have a new FileIO method like delete(Iterator<File>) , and default it to calling delete one by one, but in S3FileIO case can call S3#DeleteObjects like you say?  It does get a bit messier with the the user-facing API BaseDeleteOrphanFilesSparkAction.deleteWith(), not sure if we might need to add another bulk API there or just have the default implementation use the better FileIO method","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030489321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030498823","html_url":"https://github.com/apache/iceberg/issues/4012#issuecomment-1030498823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4012","id":1030498823,"node_id":"IC_kwDOCW7NX849bCoH","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-05T02:06:26Z","updated_at":"2022-02-05T02:08:49Z","author_association":"CONTRIBUTOR","body":"I have started it and have some changes on a local branch (still some more implementation and testing needed).  Will push it up so you can take a look. I am good to continue working on it if that works for you @szehon-ho @dramaticlly ? \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030498823/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030502262","html_url":"https://github.com/apache/iceberg/issues/4012#issuecomment-1030502262","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4012","id":1030502262,"node_id":"IC_kwDOCW7NX849bDd2","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-05T02:23:21Z","updated_at":"2022-02-05T02:23:21Z","author_association":"COLLABORATOR","body":"Sounds good, thanks!  Let us know if we can help any part","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030502262/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030535279","html_url":"https://github.com/apache/iceberg/pull/2891#issuecomment-1030535279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2891","id":1030535279,"node_id":"IC_kwDOCW7NX849bLhv","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-05T06:06:31Z","updated_at":"2022-02-05T06:06:31Z","author_association":"MEMBER","body":"What should happen with this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030535279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030689328","html_url":"https://github.com/apache/iceberg/pull/4050#issuecomment-1030689328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4050","id":1030689328,"node_id":"IC_kwDOCW7NX849bxIw","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-05T19:57:11Z","updated_at":"2022-02-05T19:57:11Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @jackye1995 and @szehon-ho You may be interested in this since I think you've run into issues with the FileIO implementation not reporting metrics back through Spark/Trino/Flink.  This is still work-in-progress and i just implemented to the read path to get feedback on this as an approach, but I was able to verify that the read/write metrics do appear in the Spark UI.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030689328/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030732753","html_url":"https://github.com/apache/iceberg/pull/4050#issuecomment-1030732753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4050","id":1030732753,"node_id":"IC_kwDOCW7NX849b7vR","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T01:45:46Z","updated_at":"2022-02-06T01:45:46Z","author_association":"CONTRIBUTOR","body":"Thank you @danielcweeks for getting the ball rolling  on this.\r\n\r\nThe Spark S3 metrics are a big concern to many people I talk to, so even supporting just Hadoop FileSystem metrics for S3FileIO initially would be a huge win. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030732753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030855391","html_url":"https://github.com/apache/iceberg/issues/3905#issuecomment-1030855391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3905","id":1030855391,"node_id":"IC_kwDOCW7NX849cZrf","user":{"login":"hbgstc123","id":8900183,"node_id":"MDQ6VXNlcjg5MDAxODM=","avatar_url":"https://avatars.githubusercontent.com/u/8900183?v=4","gravatar_id":"","url":"https://api.github.com/users/hbgstc123","html_url":"https://github.com/hbgstc123","followers_url":"https://api.github.com/users/hbgstc123/followers","following_url":"https://api.github.com/users/hbgstc123/following{/other_user}","gists_url":"https://api.github.com/users/hbgstc123/gists{/gist_id}","starred_url":"https://api.github.com/users/hbgstc123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbgstc123/subscriptions","organizations_url":"https://api.github.com/users/hbgstc123/orgs","repos_url":"https://api.github.com/users/hbgstc123/repos","events_url":"https://api.github.com/users/hbgstc123/events{/privacy}","received_events_url":"https://api.github.com/users/hbgstc123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T15:29:13Z","updated_at":"2022-02-06T15:29:13Z","author_association":"CONTRIBUTOR","body":"@stevenzwu @hililiwei flink source skip delete or overwrite snapshot, if a table contain these kind of snapshot, wouldn't the result be incorrect?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030855391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030876120","html_url":"https://github.com/apache/iceberg/issues/3905#issuecomment-1030876120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3905","id":1030876120,"node_id":"IC_kwDOCW7NX849cevY","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T17:22:12Z","updated_at":"2022-02-06T17:28:09Z","author_association":"CONTRIBUTOR","body":"When incremental read was initially implemented in FlinkSource. There is no row-level deletes (V2 spec) in Iceberg. Agree that it should support deletes if that is not the case.\r\n\r\nFor overwrite, I see two scenarios\r\n1. rewrite without new data (like compaction). Here incremental read should ignore overwrite snapshots. This is probably the more concern case.\r\n2. overwrite due to backfill. In this case, technically we should include (delete all rows before overwrite and insert all rows after overwrite). But that could be quite inefficient, maybe the downstream job (incremental read from Iceberg) should also do a backfill?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030876120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030887468","html_url":"https://github.com/apache/iceberg/pull/4044#issuecomment-1030887468","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4044","id":1030887468,"node_id":"IC_kwDOCW7NX849chgs","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T18:26:32Z","updated_at":"2022-02-06T18:26:32Z","author_association":"CONTRIBUTOR","body":"Looks great. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030887468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030889530","html_url":"https://github.com/apache/iceberg/pull/4041#issuecomment-1030889530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4041","id":1030889530,"node_id":"IC_kwDOCW7NX849ciA6","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T18:38:35Z","updated_at":"2022-02-06T18:38:35Z","author_association":"CONTRIBUTOR","body":"Thanks, @puchengy!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030889530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030889807","html_url":"https://github.com/apache/iceberg/pull/4048#issuecomment-1030889807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4048","id":1030889807,"node_id":"IC_kwDOCW7NX849ciFP","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T18:40:19Z","updated_at":"2022-02-06T18:40:19Z","author_association":"CONTRIBUTOR","body":"I think it would be good to remove the usage in tests as well, but I'll go ahead and merge this since it's already been tested. Thank you, @liuml07!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030889807/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030905935","html_url":"https://github.com/apache/iceberg/issues/4031#issuecomment-1030905935","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4031","id":1030905935,"node_id":"IC_kwDOCW7NX849cmBP","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T20:15:30Z","updated_at":"2022-02-06T20:15:30Z","author_association":"CONTRIBUTOR","body":"What hash function is not deterministic? That seems odd to me. Are we generating random data or something?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030905935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030907123","html_url":"https://github.com/apache/iceberg/pull/4018#issuecomment-1030907123","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4018","id":1030907123,"node_id":"IC_kwDOCW7NX849cmTz","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T20:23:30Z","updated_at":"2022-02-06T20:23:30Z","author_association":"CONTRIBUTOR","body":"I don't think it is a good idea to throw an exception and disallow `EXTERNAL`. That will break existing pipelines that use `EXTERNAL` in DDL and Iceberg really doesn't fit cleanly into the idea of `MANAGED` or `EXTERNAL`---the concept no longer fits and we can't choose one part of the definition (delete behavior) over another (overwrite behavior).\r\n\r\nI think there are 2 better ways to address this. First, https://github.com/apache/iceberg/pull/3056 adds `PURGE` and makes whether to delete data or not explicit at delete time. That would solve this problem because you're not trying to carry some state about whether to drop data through the lifetime of the table. Second, you can use your own catalog implementation and customize this behavior for your environment. Catalogs can be easily plugged in and are the intended way to change policy like this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030907123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030917342","html_url":"https://github.com/apache/iceberg/pull/4017#issuecomment-1030917342","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4017","id":1030917342,"node_id":"IC_kwDOCW7NX849coze","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T21:23:05Z","updated_at":"2022-02-06T21:23:05Z","author_association":"CONTRIBUTOR","body":"I understand the proposal, but I still think that the current behavior is correct. The Hive environment comes from Hive. If Hive is enabled in that environment, then it means that you expect to have the Iceberg classes available everywhere. There should be no need for redundant settings at the table level (which overrides the environment). And in addition, if the Hive environment changes, then so should this behavior. Adding this at the table level leaks Hive environment from some point in time into a table forever.\r\n\r\nIt would be good to hear more about how you encountered this to recommend a way to fix it. I suspect that your Hive environment was out of sync across the clusters? Did that reflect the state of the clusters as well -- meaning were you also inconsistently including Iceberg in the classpath?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030917342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030918482","html_url":"https://github.com/apache/iceberg/pull/4009#issuecomment-1030918482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4009","id":1030918482,"node_id":"IC_kwDOCW7NX849cpFS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T21:29:37Z","updated_at":"2022-02-06T21:29:37Z","author_association":"CONTRIBUTOR","body":"Looks great to me! I'll wait for tests to pass and then merge.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030918482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030919632","html_url":"https://github.com/apache/iceberg/pull/4005#issuecomment-1030919632","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4005","id":1030919632,"node_id":"IC_kwDOCW7NX849cpXQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T21:37:18Z","updated_at":"2022-02-06T21:37:18Z","author_association":"CONTRIBUTOR","body":"Thanks, @coolderli! This is going to be really helpful. Another thing that we should do is add a new metadata table that loads just delete files. Are you interested in working on that as well?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030919632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030926013","html_url":"https://github.com/apache/iceberg/pull/4009#issuecomment-1030926013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4009","id":1030926013,"node_id":"IC_kwDOCW7NX849cq69","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T22:15:50Z","updated_at":"2022-02-06T22:15:50Z","author_association":"CONTRIBUTOR","body":"Looks like some odd test failures. Somehow Scala can't compile when all Spark versions are enabled? Maybe this is a reuse problem from having multiple Scala versions in the same build? I wouldn't have a problem with adding a flag for Scala versions and running the build checks and Javadoc on just 2.12 for now, as long as we have full tests for 2.13 in a separate workflow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030926013/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030929637","html_url":"https://github.com/apache/iceberg/pull/3784#issuecomment-1030929637","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3784","id":1030929637,"node_id":"IC_kwDOCW7NX849crzl","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-06T22:36:42Z","updated_at":"2022-02-06T22:36:42Z","author_association":"CONTRIBUTOR","body":"@hililiwei, I don't understand what #3 is. Why is this tracking the data that hasn't been submitted to the writer? It seems like all you're doing is adding a constant to the estimated size. For Parquet, we use the current file offset plus the size that is buffered in memory.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1030929637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031037142","html_url":"https://github.com/apache/iceberg/pull/3956#issuecomment-1031037142","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3956","id":1031037142,"node_id":"IC_kwDOCW7NX849dGDW","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-07T03:29:59Z","updated_at":"2022-02-07T03:29:59Z","author_association":"CONTRIBUTOR","body":"ping @rdblue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031037142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031042255","html_url":"https://github.com/apache/iceberg/pull/4048#issuecomment-1031042255","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4048","id":1031042255,"node_id":"IC_kwDOCW7NX849dHTP","user":{"login":"liuml07","id":159186,"node_id":"MDQ6VXNlcjE1OTE4Ng==","avatar_url":"https://avatars.githubusercontent.com/u/159186?v=4","gravatar_id":"","url":"https://api.github.com/users/liuml07","html_url":"https://github.com/liuml07","followers_url":"https://api.github.com/users/liuml07/followers","following_url":"https://api.github.com/users/liuml07/following{/other_user}","gists_url":"https://api.github.com/users/liuml07/gists{/gist_id}","starred_url":"https://api.github.com/users/liuml07/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liuml07/subscriptions","organizations_url":"https://api.github.com/users/liuml07/orgs","repos_url":"https://api.github.com/users/liuml07/repos","events_url":"https://api.github.com/users/liuml07/events{/privacy}","received_events_url":"https://api.github.com/users/liuml07/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-07T03:42:21Z","updated_at":"2022-02-07T03:42:21Z","author_association":"MEMBER","body":"Thank you very much @rdblue for prompt review and commit. I have filed #4053 as a follow-up for fixing tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031042255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031043226","html_url":"https://github.com/apache/iceberg/pull/3990#issuecomment-1031043226","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3990","id":1031043226,"node_id":"IC_kwDOCW7NX849dHia","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-07T03:45:36Z","updated_at":"2022-02-07T03:45:36Z","author_association":"CONTRIBUTOR","body":"@rdblue @jackye1995 Could you take a look at this, please? I'm not sure if this is the right direction. Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031043226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031046509","html_url":"https://github.com/apache/iceberg/pull/4005#issuecomment-1031046509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4005","id":1031046509,"node_id":"IC_kwDOCW7NX849dIVt","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-07T03:57:29Z","updated_at":"2022-02-07T03:57:29Z","author_association":"CONTRIBUTOR","body":"> Thanks, @coolderli! This is going to be really helpful. Another thing that we should do is add a new metadata table that loads just delete files. Are you interested in working on that as well?\r\n\r\nYes, I'll do that. I will fix this and push another pr for that later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031046509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031111890","html_url":"https://github.com/apache/iceberg/pull/3784#issuecomment-1031111890","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3784","id":1031111890,"node_id":"IC_kwDOCW7NX849dYTS","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-07T06:16:48Z","updated_at":"2022-02-07T06:16:48Z","author_association":"CONTRIBUTOR","body":"> @hililiwei, I don't understand what #3 is. Why is this tracking the data that hasn't been submitted to the writer? It seems like all you're doing is adding a constant to the estimated size. For Parquet, we use the current file offset plus the size that is buffered in memory.\r\n\r\n#3 mainly refers to the data in the `VectorizedRowBatch`\r\nhttps://github.com/apache/iceberg/blob/2208b24617f2c64bb02f1a7aec79f3bbaabdc1cc/orc/src/main/java/org/apache/iceberg/orc/OrcFileAppender.java#L81-L91\r\n\r\nThe data is written to the `batch` first.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031111890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031253326","html_url":"https://github.com/apache/iceberg/pull/4005#issuecomment-1031253326","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4005","id":1031253326,"node_id":"IC_kwDOCW7NX849d61O","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-07T09:31:58Z","updated_at":"2022-02-07T09:31:58Z","author_association":"CONTRIBUTOR","body":"@rdblue I have fixed it, could you review it again, thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031253326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031285338","html_url":"https://github.com/apache/iceberg/pull/2680#issuecomment-1031285338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2680","id":1031285338,"node_id":"IC_kwDOCW7NX849eCpa","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-07T10:06:19Z","updated_at":"2022-02-07T10:06:19Z","author_association":"CONTRIBUTOR","body":"@rdblue @stevenzwu Hi, what do you think of this PR? In my company, there are some big tables such as TiDB or MySQL binlog that will use flink to load data to the iceberg. For example, we have a TiDB table that has six hundred million records. If we use flink streaming mode, it will cost too much time. If we use batch mode, the executor needs large heap memory to avoid OOM. Any suggestions about this?\r\n\r\nI think there are two different problems.\r\n1. when we use streaming, we can use rocksdb to avoid OOM when there is a peak flow.\r\n2. when we use spark or flink batch, we can introduce a configure to skip position delete in one transaction, because we can manually de-duplicate in the program or SQL.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1031285338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]