[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838243493","html_url":"https://github.com/apache/iceberg/issues/6126#issuecomment-1838243493","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6126","id":1838243493,"node_id":"IC_kwDOCW7NX85tkV6l","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T10:22:12Z","updated_at":"2023-12-04T10:22:12Z","author_association":"MEMBER","body":"> RewritePositionDeleteFiles cannot remove equality delete file, only works with position delete file?\r\n\r\nYes. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838243493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838243847","html_url":"https://github.com/apache/iceberg/pull/9183#issuecomment-1838243847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9183","id":1838243847,"node_id":"IC_kwDOCW7NX85tkWAH","user":{"login":"jbonofre","id":158903,"node_id":"MDQ6VXNlcjE1ODkwMw==","avatar_url":"https://avatars.githubusercontent.com/u/158903?v=4","gravatar_id":"","url":"https://api.github.com/users/jbonofre","html_url":"https://github.com/jbonofre","followers_url":"https://api.github.com/users/jbonofre/followers","following_url":"https://api.github.com/users/jbonofre/following{/other_user}","gists_url":"https://api.github.com/users/jbonofre/gists{/gist_id}","starred_url":"https://api.github.com/users/jbonofre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbonofre/subscriptions","organizations_url":"https://api.github.com/users/jbonofre/orgs","repos_url":"https://api.github.com/users/jbonofre/repos","events_url":"https://api.github.com/users/jbonofre/events{/privacy}","received_events_url":"https://api.github.com/users/jbonofre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T10:22:25Z","updated_at":"2023-12-04T10:22:25Z","author_association":"MEMBER","body":"I'm reviewing this. Thanks for the contribution !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838243847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838332078","html_url":"https://github.com/apache/iceberg/issues/9208#issuecomment-1838332078","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9208","id":1838332078,"node_id":"IC_kwDOCW7NX85tkriu","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T10:46:52Z","updated_at":"2023-12-04T10:46:52Z","author_association":"CONTRIBUTOR","body":"Ah, sorry about the confusion there!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838332078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838353175","html_url":"https://github.com/apache/iceberg/issues/9208#issuecomment-1838353175","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9208","id":1838353175,"node_id":"IC_kwDOCW7NX85tkwsX","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T10:48:59Z","updated_at":"2023-12-04T10:48:59Z","author_association":"MEMBER","body":"Let me know, If you guys want to remove `RuntimeIOException`. I can just rebase these two PRs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838353175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838386067","html_url":"https://github.com/apache/iceberg/issues/9209#issuecomment-1838386067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9209","id":1838386067,"node_id":"IC_kwDOCW7NX85tk4uT","user":{"login":"chenwyi2","id":19389434,"node_id":"MDQ6VXNlcjE5Mzg5NDM0","avatar_url":"https://avatars.githubusercontent.com/u/19389434?v=4","gravatar_id":"","url":"https://api.github.com/users/chenwyi2","html_url":"https://github.com/chenwyi2","followers_url":"https://api.github.com/users/chenwyi2/followers","following_url":"https://api.github.com/users/chenwyi2/following{/other_user}","gists_url":"https://api.github.com/users/chenwyi2/gists{/gist_id}","starred_url":"https://api.github.com/users/chenwyi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenwyi2/subscriptions","organizations_url":"https://api.github.com/users/chenwyi2/orgs","repos_url":"https://api.github.com/users/chenwyi2/repos","events_url":"https://api.github.com/users/chenwyi2/events{/privacy}","received_events_url":"https://api.github.com/users/chenwyi2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T10:55:26Z","updated_at":"2023-12-04T10:55:26Z","author_association":"NONE","body":"https://github.com/apache/iceberg/pull/2216 is the way to replace equality deletes to position deletes, but i don't know why it is be closed without merging\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838386067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838391821","html_url":"https://github.com/apache/iceberg/issues/9209#issuecomment-1838391821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9209","id":1838391821,"node_id":"IC_kwDOCW7NX85tk6IN","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T10:58:57Z","updated_at":"2023-12-04T10:58:57Z","author_association":"MEMBER","body":"I know. You recently pinged on that PR. There was no response. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838391821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838408997","html_url":"https://github.com/apache/iceberg/pull/9161#issuecomment-1838408997","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9161","id":1838408997,"node_id":"IC_kwDOCW7NX85tk-Ul","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T11:08:45Z","updated_at":"2023-12-04T11:08:45Z","author_association":"CONTRIBUTOR","body":"@GianlucaPrincipini can you please run `./gradlew spotlessApply` to fix the formatting?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838408997/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838537826","html_url":"https://github.com/apache/iceberg/issues/9188#issuecomment-1838537826","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9188","id":1838537826,"node_id":"IC_kwDOCW7NX85tldxi","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T12:30:06Z","updated_at":"2023-12-04T12:30:06Z","author_association":"CONTRIBUTOR","body":"This is the code which fails with `NullPointerException`:\r\n```\r\n  public static void init() {\r\n    EnvironmentContext.put(EnvironmentContext.ENGINE_NAME, \"flink\");\r\n    EnvironmentContext.put(EnvironmentContext.ENGINE_VERSION, FlinkPackage.version());\r\n  }\r\n```\r\n\r\n`FlinkPackage.version()` calls this method to get the version number:\r\n```\r\nDataStream.class.getPackage().getImplementationVersion()\r\n```\r\n\r\nMaybe an issue with the classpath?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838537826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838577648","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1838577648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1838577648,"node_id":"IC_kwDOCW7NX85tlnfw","user":{"login":"ExplorData24","id":149940691,"node_id":"U_kgDOCO_p0w","avatar_url":"https://avatars.githubusercontent.com/u/149940691?v=4","gravatar_id":"","url":"https://api.github.com/users/ExplorData24","html_url":"https://github.com/ExplorData24","followers_url":"https://api.github.com/users/ExplorData24/followers","following_url":"https://api.github.com/users/ExplorData24/following{/other_user}","gists_url":"https://api.github.com/users/ExplorData24/gists{/gist_id}","starred_url":"https://api.github.com/users/ExplorData24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ExplorData24/subscriptions","organizations_url":"https://api.github.com/users/ExplorData24/orgs","repos_url":"https://api.github.com/users/ExplorData24/repos","events_url":"https://api.github.com/users/ExplorData24/events{/privacy}","received_events_url":"https://api.github.com/users/ExplorData24/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T12:55:28Z","updated_at":"2023-12-04T12:55:28Z","author_association":"NONE","body":"@nastra \r\nThank you so much.\r\n\r\n- I actually tried following this: https://github.com/developer-advocacy-dremio/quick-guides-from-dremio/blob/main/sparknotebook.md\r\n- I specified the minio region \"us-east-1\" in an .env file.\r\n- AWS_ACCESS_KEY and AWS_SECRET_KEy, AWS _S3_ENDPOINT and S3A://warehouse / are correct and the containers are running.\r\n\r\nI tried a lot to resolve this problem such that I passed these configurations to the driver to activate the V4 signature:\r\n\r\n     .set('spark.executor.extraJavaOptions', '-Dcom.amazonaws.services.s3.enableV4=true')\r\n     .set('spark.driver.extraJavaOptions', '-Dcom.amazonaws.services.s3.enableV4=true')\r\n![image](https://github.com/apache/iceberg/assets/149940691/08b1dcde-ba1c-47b8-a357-7b33396bb1e3)\r\nI always get the same error: \r\n![image](https://github.com/apache/iceberg/assets/149940691/11d4b45e-638c-496b-b338-37ae1696b751)\r\n\r\nI don't know the exact cause of this error ?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838577648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838660883","html_url":"https://github.com/apache/iceberg/issues/9207#issuecomment-1838660883","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9207","id":1838660883,"node_id":"IC_kwDOCW7NX85tl70T","user":{"login":"yyy1000","id":69566909,"node_id":"MDQ6VXNlcjY5NTY2OTA5","avatar_url":"https://avatars.githubusercontent.com/u/69566909?v=4","gravatar_id":"","url":"https://api.github.com/users/yyy1000","html_url":"https://github.com/yyy1000","followers_url":"https://api.github.com/users/yyy1000/followers","following_url":"https://api.github.com/users/yyy1000/following{/other_user}","gists_url":"https://api.github.com/users/yyy1000/gists{/gist_id}","starred_url":"https://api.github.com/users/yyy1000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyy1000/subscriptions","organizations_url":"https://api.github.com/users/yyy1000/orgs","repos_url":"https://api.github.com/users/yyy1000/repos","events_url":"https://api.github.com/users/yyy1000/events{/privacy}","received_events_url":"https://api.github.com/users/yyy1000/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T13:37:41Z","updated_at":"2023-12-04T13:37:41Z","author_association":"CONTRIBUTOR","body":"I'm interested in this one!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838660883/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838689497","html_url":"https://github.com/apache/iceberg/issues/9210#issuecomment-1838689497","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9210","id":1838689497,"node_id":"IC_kwDOCW7NX85tmCzZ","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T13:54:29Z","updated_at":"2023-12-04T13:54:29Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/iceberg/pull/9161","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838689497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838693595","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1838693595","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1838693595,"node_id":"IC_kwDOCW7NX85tmDzb","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T13:56:47Z","updated_at":"2023-12-04T13:59:55Z","author_association":"CONTRIBUTOR","body":"I can't speak to https://github.com/developer-advocacy-dremio/quick-guides-from-dremio/blob/main/sparknotebook.md (it seems outdated) but the Quickstart example I mentioned further above is the official Iceberg one that is maintained by the community, so I'd suggest to check what you're missing from that.\r\nAlso any particular reason that you're using Iceberg 1.0.0 and not 1.4.2?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838693595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838761423","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1838761423","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1838761423,"node_id":"IC_kwDOCW7NX85tmUXP","user":{"login":"ExplorData24","id":149940691,"node_id":"U_kgDOCO_p0w","avatar_url":"https://avatars.githubusercontent.com/u/149940691?v=4","gravatar_id":"","url":"https://api.github.com/users/ExplorData24","html_url":"https://github.com/ExplorData24","followers_url":"https://api.github.com/users/ExplorData24/followers","following_url":"https://api.github.com/users/ExplorData24/following{/other_user}","gists_url":"https://api.github.com/users/ExplorData24/gists{/gist_id}","starred_url":"https://api.github.com/users/ExplorData24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ExplorData24/subscriptions","organizations_url":"https://api.github.com/users/ExplorData24/orgs","repos_url":"https://api.github.com/users/ExplorData24/repos","events_url":"https://api.github.com/users/ExplorData24/events{/privacy}","received_events_url":"https://api.github.com/users/ExplorData24/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T14:33:39Z","updated_at":"2023-12-04T14:33:39Z","author_association":"NONE","body":"@nastra \r\nYes, even I tested with iceberg 1.4.2:\r\n![image](https://github.com/apache/iceberg/assets/149940691/33d504c1-90f9-4c33-a7ce-2a17912621ce)\r\n![image](https://github.com/apache/iceberg/assets/149940691/bc6ef6df-5306-4559-9545-9ed67a837abe)\r\n\r\nimport os\r\nimport pyspark\r\nfrom pyspark.sql import SparkSession\r\n\r\nWAREHOUSE = os.environ.get(\"WAREHOUSE\", \"s3a://warehouse/\")  # Remplacez par votre emplacement S3\r\nAWS_ACCESS_KEY = os.environ.get(\"AWS_ACCESS_KEY\", \"0kzFsHD1pFazfIyvBi7S\")  \r\nAWS_SECRET_KEY = os.environ.get(\"AWS_SECRET_KEY\", \"hC0ZNEwmSuHaU5jjjAv2aMo7oucXcJoj7vfSSH7g\") \r\nAWS_S3_ENDPOINT = os.environ.get(\"AWS_S3_ENDPOINT\", \"http://minioserver:9000\")\r\nconf = (\r\n    pyspark.SparkConf()\r\n    .setAppName('example')\r\n    .set('spark.jars.packages', 'org.apache.hadoop:hadoop-aws:3.3.2,org.apache.iceberg:iceberg-spark-runtime-3.3_2.12:1.4.2,software.amazon.awssdk:bundle:2.17.178,software.amazon.awssdk:url-connection-client:2.17.178')\r\n    .set('spark.sql.extensions', 'org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions')\r\n    .set('spark.sql.catalog.iceberg', 'org.apache.iceberg.spark.SparkCatalog')\r\n    .set('spark.sql.catalog.iceberg.type', 'hadoop')\r\n    .set('spark.sql.catalog.iceberg.io-impl', 'org.apache.iceberg.aws.s3.S3FileIO')\r\n    .set('spark.sql.catalog.iceberg.warehouse', WAREHOUSE)\r\n    .set('spark.hadoop.fs.s3a.access.key', AWS_ACCESS_KEY)\r\n    .set('spark.hadoop.fs.s3a.secret.key', AWS_SECRET_KEY)\r\n    .set('spark.hadoop.fs.s3a.endpoint', AWS_S3_ENDPOINT)\r\n    .set('spark.hadoop.fs.s3a.path.style.access', 'true')\r\n    .set('spark.hadoop.fs.s3a.connection.ssl.enabled', 'true')\r\n    .set('spark.executor.extraJavaOptions', '-Dcom.amazonaws.services.s3.enableV4=true')  \r\n    .set('spark.driver.extraJavaOptions', '-Dcom.amazonaws.services.s3.enableV4=true')  \r\n)\r\nspark = SparkSession.builder.config(conf=conf).getOrCreate()\r\nprint(\"Spark Running\")\r\nspark.sql(\"CREATE TABLE iceberg.tab (name string) USING iceberg;\")\r\nIt always brings together the same error:\r\n![image](https://github.com/apache/iceberg/assets/149940691/fa612063-b619-4b40-9cc2-02a5ec9c2876)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838761423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838785955","html_url":"https://github.com/apache/iceberg/pull/8625#issuecomment-1838785955","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8625","id":1838785955,"node_id":"IC_kwDOCW7NX85tmaWj","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T14:44:33Z","updated_at":"2023-12-04T14:44:43Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi I think we can start a release somewhere soon, but I need to align this with the Avro community. I also wanted to include nanosecond timestamp in there: https://github.com/apache/avro/pull/2608","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838785955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838837878","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1838837878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1838837878,"node_id":"IC_kwDOCW7NX85tmnB2","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T15:05:15Z","updated_at":"2023-12-04T15:05:15Z","author_association":"CONTRIBUTOR","body":"Just curious, are you trying to use SigV4 signing or what exactly is -Dcom.amazonaws.services.s3.enableV4=true required for?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838837878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838842043","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1838842043","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1838842043,"node_id":"IC_kwDOCW7NX85tmoC7","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T15:07:20Z","updated_at":"2023-12-04T15:07:20Z","author_association":"CONTRIBUTOR","body":"Please try and use `spark.jars.packages', 'org.apache.hadoop:hadoop-aws:3.3.2,org.apache.iceberg:iceberg-spark-runtime-3.3_2.12:1.4.2,org.apache.iceberg:iceberg-aws-bundle:1.4.2'`. In your above example you're using the wrong AWS SDK version and in the recent Iceberg version, `iceberg-aws-bundle` contains everything that is required. See also https://iceberg.apache.org/docs/latest/aws/","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838842043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838866556","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1838866556","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1838866556,"node_id":"IC_kwDOCW7NX85tmuB8","user":{"login":"ExplorData24","id":149940691,"node_id":"U_kgDOCO_p0w","avatar_url":"https://avatars.githubusercontent.com/u/149940691?v=4","gravatar_id":"","url":"https://api.github.com/users/ExplorData24","html_url":"https://github.com/ExplorData24","followers_url":"https://api.github.com/users/ExplorData24/followers","following_url":"https://api.github.com/users/ExplorData24/following{/other_user}","gists_url":"https://api.github.com/users/ExplorData24/gists{/gist_id}","starred_url":"https://api.github.com/users/ExplorData24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ExplorData24/subscriptions","organizations_url":"https://api.github.com/users/ExplorData24/orgs","repos_url":"https://api.github.com/users/ExplorData24/repos","events_url":"https://api.github.com/users/ExplorData24/events{/privacy}","received_events_url":"https://api.github.com/users/ExplorData24/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T15:19:27Z","updated_at":"2023-12-04T15:19:27Z","author_association":"NONE","body":"@nastra \r\nthank you so much\r\n\r\n- I will try to test it with these versions right away.\r\n\r\n-  I realized that this only happened to me when reading from a bucket in the in us-east-1 with the configurations of my question I got it working right. In summary, The key was actually enabling the V4 signature.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838866556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838940568","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1838940568","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1838940568,"node_id":"IC_kwDOCW7NX85tnAGY","user":{"login":"ExplorData24","id":149940691,"node_id":"U_kgDOCO_p0w","avatar_url":"https://avatars.githubusercontent.com/u/149940691?v=4","gravatar_id":"","url":"https://api.github.com/users/ExplorData24","html_url":"https://github.com/ExplorData24","followers_url":"https://api.github.com/users/ExplorData24/followers","following_url":"https://api.github.com/users/ExplorData24/following{/other_user}","gists_url":"https://api.github.com/users/ExplorData24/gists{/gist_id}","starred_url":"https://api.github.com/users/ExplorData24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ExplorData24/subscriptions","organizations_url":"https://api.github.com/users/ExplorData24/orgs","repos_url":"https://api.github.com/users/ExplorData24/repos","events_url":"https://api.github.com/users/ExplorData24/events{/privacy}","received_events_url":"https://api.github.com/users/ExplorData24/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T15:55:08Z","updated_at":"2023-12-04T15:55:08Z","author_association":"NONE","body":"@nastra \r\nunfortunately it still brings up the same error:\r\n![image](https://github.com/apache/iceberg/assets/149940691/fb056f8d-b310-4a08-9d10-4a22cd0bf79d)\r\n\r\n\r\nI don't really know where the error is exactly.\r\nDo you have any further ideas please?\r\n\r\nPy4JJavaError: An error occurred while calling o53.sql.\r\n: software.amazon.awssdk.services.s3.model.S3Exception: null (Service: S3, Status Code: 400, Request ID: MWYYXYQBDXGZBT7C, Extended Request ID: KX3s4n5p9b4DkZcF8GfQun3+PR2kAn0AKLZbltC0ybeVABRtnAj/vQZtH/4tWEQ9YEtg1nwk2rA=)\r\n\tat software.amazon.awssdk.protocols.xml.internal.unmarshall.AwsXmlPredicatedResponseHandler.handleErrorResponse(AwsXmlPredicatedResponseHandler.java:156)\r\n\tat software.amazon.awssdk.protocols.xml.internal.unmarshall.AwsXmlPredicatedResponseHandler.handleResponse(AwsXmlPredicatedResponseHandler.java:108)\r\n\tat software.amazon.awssdk.protocols.xml.internal.unmarshall.AwsXmlPredicatedResponseHandler.handle(AwsXmlPredicatedResponseHandler.java:85)\r\n\tat software.amazon.awssdk.protocols.xml.internal.unmarshall.AwsXmlPredicatedResponseHandler.handle(AwsXmlPredicatedResponseHandler.java:43)\r\n\tat software.amazon.awssdk.awscore.client.handler.AwsSyncClientHandler$Crc32ValidationResponseHandler.handle(AwsSyncClientHandler.java:95)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseClientHandler.lambda$successTransformationResponseHandler$7(BaseClientHandler.java:245)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.HandleResponseStage.execute(HandleResponseStage.java:40)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.HandleResponseStage.execute(HandleResponseStage.java:30)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:73)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:42)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:78)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:40)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:50)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:36)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:81)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:36)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:56)\r\n\tat software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:36)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.executeWithTimer(ApiCallTimeoutTrackingStage.java:80)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:60)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:42)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:48)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:31)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:37)\r\n\tat software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:26)\r\n\tat software.amazon.awssdk.core.internal.http.AmazonSyncHttpClient$RequestExecutionBuilderImpl.execute(AmazonSyncHttpClient.java:193)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.invoke(BaseSyncClientHandler.java:103)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.doExecute(BaseSyncClientHandler.java:167)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.lambda$execute$1(BaseSyncClientHandler.java:82)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.measureApiCallSuccess(BaseSyncClientHandler.java:175)\r\n\tat software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.execute(BaseSyncClientHandler.java:76)\r\n\tat software.amazon.awssdk.core.client.handler.SdkSyncClientHandler.execute(SdkSyncClientHandler.java:45)\r\n\tat software.amazon.awssdk.awscore.client.handler.AwsSyncClientHandler.execute(AwsSyncClientHandler.java:56)\r\n\tat software.amazon.awssdk.services.s3.DefaultS3Client.headObject(DefaultS3Client.java:5438)\r\n\tat org.apache.iceberg.aws.s3.BaseS3File.getObjectMetadata(BaseS3File.java:85)\r\n\tat org.apache.iceberg.aws.s3.BaseS3File.exists(BaseS3File.java:70)\r\n\tat org.apache.iceberg.aws.s3.S3OutputFile.exists(S3OutputFile.java:32)\r\n\tat org.apache.iceberg.aws.s3.S3OutputFile.create(S3OutputFile.java:60)\r\n\tat org.apache.iceberg.TableMetadataParser.internalWrite(TableMetadataParser.java:124)\r\n\tat org.apache.iceberg.TableMetadataParser.write(TableMetadataParser.java:118)\r\n\tat org.apache.iceberg.hadoop.HadoopTableOperations.commit(HadoopTableOperations.java:155)\r\n\tat org.apache.iceberg.BaseMetastoreCatalog$BaseMetastoreCatalogTableBuilder.create(BaseMetastoreCatalog.java:199)\r\n\tat org.apache.iceberg.CachingCatalog$CachingTableBuilder.lambda$create$0(CachingCatalog.java:261)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.lambda$doComputeIfAbsent$14(BoundedLocalCache.java:2406)\r\n\tat java.base/java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1908)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.doComputeIfAbsent(BoundedLocalCache.java:2404)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.computeIfAbsent(BoundedLocalCache.java:2387)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalCache.computeIfAbsent(LocalCache.java:108)\r\n\tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalManualCache.get(LocalManualCache.java:62)\r\n\tat org.apache.iceberg.CachingCatalog$CachingTableBuilder.create(CachingCatalog.java:257)\r\n\tat org.apache.iceberg.spark.SparkCatalog.createTable(SparkCatalog.java:237)\r\n\tat org.apache.spark.sql.execution.datasources.v2.CreateTableExec.run(CreateTableExec.scala:45)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:43)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:43)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.executeCollect(V2CommandExec.scala:49)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:98)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:109)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:169)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:95)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:94)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:584)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:176)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:584)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:560)\r\n\tat org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:94)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:81)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:79)\r\n\tat org.apache.spark.sql.Dataset.<init>(Dataset.scala:220)\r\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:100)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:97)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:622)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:779)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:617)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\r\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\r\n\tat py4j.Gateway.invoke(Gateway.java:282)\r\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\r\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\r\n\tat py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\r\n\tat py4j.ClientServerConnection.run(ClientServerConnection.java:106)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1838940568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839006269","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1839006269","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1839006269,"node_id":"IC_kwDOCW7NX85tnQI9","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T16:29:15Z","updated_at":"2023-12-04T16:29:15Z","author_association":"CONTRIBUTOR","body":"I would suggest to try the Quickstart example and then modify it to your needs step-by-step to figure out where it breaks exactly","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839006269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839075388","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1839075388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1839075388,"node_id":"IC_kwDOCW7NX85tnhA8","user":{"login":"ExplorData24","id":149940691,"node_id":"U_kgDOCO_p0w","avatar_url":"https://avatars.githubusercontent.com/u/149940691?v=4","gravatar_id":"","url":"https://api.github.com/users/ExplorData24","html_url":"https://github.com/ExplorData24","followers_url":"https://api.github.com/users/ExplorData24/followers","following_url":"https://api.github.com/users/ExplorData24/following{/other_user}","gists_url":"https://api.github.com/users/ExplorData24/gists{/gist_id}","starred_url":"https://api.github.com/users/ExplorData24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ExplorData24/subscriptions","organizations_url":"https://api.github.com/users/ExplorData24/orgs","repos_url":"https://api.github.com/users/ExplorData24/repos","events_url":"https://api.github.com/users/ExplorData24/events{/privacy}","received_events_url":"https://api.github.com/users/ExplorData24/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T16:58:14Z","updated_at":"2023-12-04T16:58:14Z","author_association":"NONE","body":"@nastra \r\nokay thank you so much.\r\nI will try to test in parallel.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839075388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839214706","html_url":"https://github.com/apache/iceberg/issues/7938#issuecomment-1839214706","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7938","id":1839214706,"node_id":"IC_kwDOCW7NX85toDBy","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T18:19:33Z","updated_at":"2023-12-04T18:19:33Z","author_association":"MEMBER","body":"https://github.com/apache/spark/pull/39796#issuecomment-1839214419","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839214706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839240076","html_url":"https://github.com/apache/iceberg/pull/9183#issuecomment-1839240076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9183","id":1839240076,"node_id":"IC_kwDOCW7NX85toJOM","user":{"login":"bartash","id":1914851,"node_id":"MDQ6VXNlcjE5MTQ4NTE=","avatar_url":"https://avatars.githubusercontent.com/u/1914851?v=4","gravatar_id":"","url":"https://api.github.com/users/bartash","html_url":"https://github.com/bartash","followers_url":"https://api.github.com/users/bartash/followers","following_url":"https://api.github.com/users/bartash/following{/other_user}","gists_url":"https://api.github.com/users/bartash/gists{/gist_id}","starred_url":"https://api.github.com/users/bartash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bartash/subscriptions","organizations_url":"https://api.github.com/users/bartash/orgs","repos_url":"https://api.github.com/users/bartash/repos","events_url":"https://api.github.com/users/bartash/events{/privacy}","received_events_url":"https://api.github.com/users/bartash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T18:34:18Z","updated_at":"2023-12-04T18:34:18Z","author_association":"MEMBER","body":"Thanks @amogh-jahagirdar I pushed changes for the nits.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839240076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839245214","html_url":"https://github.com/apache/iceberg/issues/7938#issuecomment-1839245214","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7938","id":1839245214,"node_id":"IC_kwDOCW7NX85toKee","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T18:37:30Z","updated_at":"2023-12-04T18:37:30Z","author_association":"MEMBER","body":"Spark umbrella JIRA: [SPARK-31357](https://issues.apache.org/jira/browse/SPARK-31357)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839245214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839311467","html_url":"https://github.com/apache/iceberg/issues/9089#issuecomment-1839311467","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9089","id":1839311467,"node_id":"IC_kwDOCW7NX85toapr","user":{"login":"FranMorilloAWS","id":85679820,"node_id":"MDQ6VXNlcjg1Njc5ODIw","avatar_url":"https://avatars.githubusercontent.com/u/85679820?v=4","gravatar_id":"","url":"https://api.github.com/users/FranMorilloAWS","html_url":"https://github.com/FranMorilloAWS","followers_url":"https://api.github.com/users/FranMorilloAWS/followers","following_url":"https://api.github.com/users/FranMorilloAWS/following{/other_user}","gists_url":"https://api.github.com/users/FranMorilloAWS/gists{/gist_id}","starred_url":"https://api.github.com/users/FranMorilloAWS/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FranMorilloAWS/subscriptions","organizations_url":"https://api.github.com/users/FranMorilloAWS/orgs","repos_url":"https://api.github.com/users/FranMorilloAWS/repos","events_url":"https://api.github.com/users/FranMorilloAWS/events{/privacy}","received_events_url":"https://api.github.com/users/FranMorilloAWS/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T19:20:37Z","updated_at":"2023-12-04T19:20:37Z","author_association":"NONE","body":"Hi any updates o this?   I have seen that the issue happens if the table has more than 1000 Snapshots.  Could it be that as it as that many snapshots, the commit process is taking too long and it never finishes before the next checkpoint is being triggered?  And it goes on loop?   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839311467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839350869","html_url":"https://github.com/apache/iceberg/pull/9125#issuecomment-1839350869","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9125","id":1839350869,"node_id":"IC_kwDOCW7NX85tokRV","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T19:39:41Z","updated_at":"2023-12-04T19:39:41Z","author_association":"CONTRIBUTOR","body":"Thanks for the update, @emkornfield!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839350869/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839576421","html_url":"https://github.com/apache/iceberg/pull/9204#issuecomment-1839576421","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9204","id":1839576421,"node_id":"IC_kwDOCW7NX85tpbVl","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T22:15:07Z","updated_at":"2023-12-04T22:15:07Z","author_association":"CONTRIBUTOR","body":"@dependabot rebase","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839576421/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839578847","html_url":"https://github.com/apache/iceberg/pull/9204#issuecomment-1839578847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9204","id":1839578847,"node_id":"IC_kwDOCW7NX85tpb7f","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T22:16:39Z","updated_at":"2023-12-04T22:16:39Z","author_association":"CONTRIBUTOR","body":"Superseded by #9214.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839578847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":29110,"client_id":"Iv1.4f9a6346434f815e","slug":"dependabot","node_id":"MDM6QXBwMjkxMTA=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"Dependabot","description":"","external_url":"https://dependabot-api.githubapp.com","html_url":"https://github.com/apps/dependabot","created_at":"2019-04-16T22:34:25Z","updated_at":"2024-03-20T21:06:35Z","permissions":{"actions":"read","checks":"write","contents":"write","issues":"write","members":"read","metadata":"read","pull_requests":"write","statuses":"read","vulnerability_alerts":"read","workflows":"write"},"events":["check_suite","issues","issue_comment","label","pull_request","pull_request_review","pull_request_review_comment","repository"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839651809","html_url":"https://github.com/apache/iceberg/pull/9183#issuecomment-1839651809","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9183","id":1839651809,"node_id":"IC_kwDOCW7NX85tptvh","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T22:45:34Z","updated_at":"2023-12-04T22:45:34Z","author_association":"CONTRIBUTOR","body":"Thanks @bartash for the fix! Merging, @rdblue @jbonofre let me know if you have any concerns","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839651809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839672939","html_url":"https://github.com/apache/iceberg/issues/8977#issuecomment-1839672939","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8977","id":1839672939,"node_id":"IC_kwDOCW7NX85tpy5r","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-04T22:55:05Z","updated_at":"2023-12-04T22:55:29Z","author_association":"CONTRIBUTOR","body":"@singhpk234 , `rdd` ( which view1 is created on) has a reference to the logical plan which has a reference to older versions of iceberg table. After cache expires, no one is refreshing older version table in `rdd`. Iceberg should ideally refresh the tables irrespective of cache enabled or disabled.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839672939/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839779395","html_url":"https://github.com/apache/iceberg/issues/7792#issuecomment-1839779395","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7792","id":1839779395,"node_id":"IC_kwDOCW7NX85tqM5D","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T00:11:38Z","updated_at":"2023-12-05T00:11:38Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839779395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839798312","html_url":"https://github.com/apache/iceberg/pull/9216#issuecomment-1839798312","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9216","id":1839798312,"node_id":"IC_kwDOCW7NX85tqRgo","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T00:32:47Z","updated_at":"2023-12-05T00:32:47Z","author_association":"CONTRIBUTOR","body":"see an example of failed test here: https://github.com/apache/iceberg/actions/runs/7091452262/job/19300609355?pr=9212\r\n\r\n```\r\n    exception caught while trying to get the future result: java.util.concurrent.ExecutionException: java.lang.IllegalStateException: Trying to access closed classloader. Please check if you store classloaders directly or indirectly in static fields. If the stacktrace suggests that the leak occurs in a third party library and cannot be fixed immediately, you can disable this check with the configuration 'classloader.check-leaked-classloader'.\r\n    \tat java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)\r\n    \tat java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1928)\r\n    \tat org.assertj.core.internal.Futures.assertSucceededWithin(Futures.java:109)\r\n    \tat org.assertj.core.api.AbstractCompletableFutureAssert.internalSucceedsWithin(AbstractCompletableFutureAssert.java:400)\r\n    \tat org.assertj.core.api.AbstractCompletableFutureAssert.succeedsWithin(AbstractCompletableFutureAssert.java:396)\r\n    \tat org.apache.iceberg.flink.source.TestIcebergSourceWithWatermarkExtractor.waitForRecords(TestIcebergSourceWithWatermarkExtractor.java:416)\r\n    \tat org.apache.iceberg.flink.source.TestIcebergSourceWithWatermarkExtractor.testThrottling(TestIcebergSourceWithWatermarkExtractor.java:307)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839798312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839959981","html_url":"https://github.com/apache/iceberg/issues/5782#issuecomment-1839959981","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5782","id":1839959981,"node_id":"IC_kwDOCW7NX85tq4-t","user":{"login":"tanweipeng","id":45888268,"node_id":"MDQ6VXNlcjQ1ODg4MjY4","avatar_url":"https://avatars.githubusercontent.com/u/45888268?v=4","gravatar_id":"","url":"https://api.github.com/users/tanweipeng","html_url":"https://github.com/tanweipeng","followers_url":"https://api.github.com/users/tanweipeng/followers","following_url":"https://api.github.com/users/tanweipeng/following{/other_user}","gists_url":"https://api.github.com/users/tanweipeng/gists{/gist_id}","starred_url":"https://api.github.com/users/tanweipeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanweipeng/subscriptions","organizations_url":"https://api.github.com/users/tanweipeng/orgs","repos_url":"https://api.github.com/users/tanweipeng/repos","events_url":"https://api.github.com/users/tanweipeng/events{/privacy}","received_events_url":"https://api.github.com/users/tanweipeng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T03:56:14Z","updated_at":"2023-12-05T03:56:14Z","author_association":"NONE","body":"> Not sure if the error's stem is the same, but I'm facing the same behaviour when using AWS Glue as metastore\r\n\r\nYa, I faced the same issue too. Anyone knows workaround?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1839959981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840130345","html_url":"https://github.com/apache/iceberg/issues/9193#issuecomment-1840130345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9193","id":1840130345,"node_id":"IC_kwDOCW7NX85trikp","user":{"login":"Zhangg7723","id":18146312,"node_id":"MDQ6VXNlcjE4MTQ2MzEy","avatar_url":"https://avatars.githubusercontent.com/u/18146312?v=4","gravatar_id":"","url":"https://api.github.com/users/Zhangg7723","html_url":"https://github.com/Zhangg7723","followers_url":"https://api.github.com/users/Zhangg7723/followers","following_url":"https://api.github.com/users/Zhangg7723/following{/other_user}","gists_url":"https://api.github.com/users/Zhangg7723/gists{/gist_id}","starred_url":"https://api.github.com/users/Zhangg7723/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zhangg7723/subscriptions","organizations_url":"https://api.github.com/users/Zhangg7723/orgs","repos_url":"https://api.github.com/users/Zhangg7723/repos","events_url":"https://api.github.com/users/Zhangg7723/events{/privacy}","received_events_url":"https://api.github.com/users/Zhangg7723/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T07:10:37Z","updated_at":"2023-12-05T07:10:37Z","author_association":"CONTRIBUTOR","body":"upsert mode caused too many equal delete records in the table, these delete records will loaded in memory hash set.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840130345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840137972","html_url":"https://github.com/apache/iceberg/issues/9168#issuecomment-1840137972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9168","id":1840137972,"node_id":"IC_kwDOCW7NX85trkb0","user":{"login":"Zhangg7723","id":18146312,"node_id":"MDQ6VXNlcjE4MTQ2MzEy","avatar_url":"https://avatars.githubusercontent.com/u/18146312?v=4","gravatar_id":"","url":"https://api.github.com/users/Zhangg7723","html_url":"https://github.com/Zhangg7723","followers_url":"https://api.github.com/users/Zhangg7723/followers","following_url":"https://api.github.com/users/Zhangg7723/following{/other_user}","gists_url":"https://api.github.com/users/Zhangg7723/gists{/gist_id}","starred_url":"https://api.github.com/users/Zhangg7723/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zhangg7723/subscriptions","organizations_url":"https://api.github.com/users/Zhangg7723/orgs","repos_url":"https://api.github.com/users/Zhangg7723/repos","events_url":"https://api.github.com/users/Zhangg7723/events{/privacy}","received_events_url":"https://api.github.com/users/Zhangg7723/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T07:17:46Z","updated_at":"2023-12-05T07:17:46Z","author_association":"CONTRIBUTOR","body":"same problem https://github.com/apache/iceberg/issues/6066","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840137972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840151582","html_url":"https://github.com/apache/iceberg/issues/9190#issuecomment-1840151582","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9190","id":1840151582,"node_id":"IC_kwDOCW7NX85trnwe","user":{"login":"Zhangg7723","id":18146312,"node_id":"MDQ6VXNlcjE4MTQ2MzEy","avatar_url":"https://avatars.githubusercontent.com/u/18146312?v=4","gravatar_id":"","url":"https://api.github.com/users/Zhangg7723","html_url":"https://github.com/Zhangg7723","followers_url":"https://api.github.com/users/Zhangg7723/followers","following_url":"https://api.github.com/users/Zhangg7723/following{/other_user}","gists_url":"https://api.github.com/users/Zhangg7723/gists{/gist_id}","starred_url":"https://api.github.com/users/Zhangg7723/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zhangg7723/subscriptions","organizations_url":"https://api.github.com/users/Zhangg7723/orgs","repos_url":"https://api.github.com/users/Zhangg7723/repos","events_url":"https://api.github.com/users/Zhangg7723/events{/privacy}","received_events_url":"https://api.github.com/users/Zhangg7723/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T07:30:40Z","updated_at":"2023-12-05T07:30:40Z","author_association":"CONTRIBUTOR","body":"expire old snapshots will remove deleted files in partition","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840151582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840176731","html_url":"https://github.com/apache/iceberg/issues/9190#issuecomment-1840176731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9190","id":1840176731,"node_id":"IC_kwDOCW7NX85trt5b","user":{"login":"lpy148145","id":50827518,"node_id":"MDQ6VXNlcjUwODI3NTE4","avatar_url":"https://avatars.githubusercontent.com/u/50827518?v=4","gravatar_id":"","url":"https://api.github.com/users/lpy148145","html_url":"https://github.com/lpy148145","followers_url":"https://api.github.com/users/lpy148145/followers","following_url":"https://api.github.com/users/lpy148145/following{/other_user}","gists_url":"https://api.github.com/users/lpy148145/gists{/gist_id}","starred_url":"https://api.github.com/users/lpy148145/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lpy148145/subscriptions","organizations_url":"https://api.github.com/users/lpy148145/orgs","repos_url":"https://api.github.com/users/lpy148145/repos","events_url":"https://api.github.com/users/lpy148145/events{/privacy}","received_events_url":"https://api.github.com/users/lpy148145/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T07:46:43Z","updated_at":"2023-12-05T07:46:43Z","author_association":"NONE","body":"ok , thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840176731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840183519","html_url":"https://github.com/apache/iceberg/issues/9178#issuecomment-1840183519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9178","id":1840183519,"node_id":"IC_kwDOCW7NX85trvjf","user":{"login":"Zhangg7723","id":18146312,"node_id":"MDQ6VXNlcjE4MTQ2MzEy","avatar_url":"https://avatars.githubusercontent.com/u/18146312?v=4","gravatar_id":"","url":"https://api.github.com/users/Zhangg7723","html_url":"https://github.com/Zhangg7723","followers_url":"https://api.github.com/users/Zhangg7723/followers","following_url":"https://api.github.com/users/Zhangg7723/following{/other_user}","gists_url":"https://api.github.com/users/Zhangg7723/gists{/gist_id}","starred_url":"https://api.github.com/users/Zhangg7723/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zhangg7723/subscriptions","organizations_url":"https://api.github.com/users/Zhangg7723/orgs","repos_url":"https://api.github.com/users/Zhangg7723/repos","events_url":"https://api.github.com/users/Zhangg7723/events{/privacy}","received_events_url":"https://api.github.com/users/Zhangg7723/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T07:50:28Z","updated_at":"2023-12-05T07:50:28Z","author_association":"CONTRIBUTOR","body":"maybe you can change the isolation level to snapshot","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840183519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840199760","html_url":"https://github.com/apache/iceberg/pull/5026#issuecomment-1840199760","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5026","id":1840199760,"node_id":"IC_kwDOCW7NX85trzhQ","user":{"login":"chenwyi2","id":19389434,"node_id":"MDQ6VXNlcjE5Mzg5NDM0","avatar_url":"https://avatars.githubusercontent.com/u/19389434?v=4","gravatar_id":"","url":"https://api.github.com/users/chenwyi2","html_url":"https://github.com/chenwyi2","followers_url":"https://api.github.com/users/chenwyi2/followers","following_url":"https://api.github.com/users/chenwyi2/following{/other_user}","gists_url":"https://api.github.com/users/chenwyi2/gists{/gist_id}","starred_url":"https://api.github.com/users/chenwyi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenwyi2/subscriptions","organizations_url":"https://api.github.com/users/chenwyi2/orgs","repos_url":"https://api.github.com/users/chenwyi2/repos","events_url":"https://api.github.com/users/chenwyi2/events{/privacy}","received_events_url":"https://api.github.com/users/chenwyi2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T07:59:24Z","updated_at":"2023-12-05T07:59:24Z","author_association":"NONE","body":"how's it going? i think this can be a good way to reduce equality delete file","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840199760/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840229110","html_url":"https://github.com/apache/iceberg/pull/9161#issuecomment-1840229110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9161","id":1840229110,"node_id":"IC_kwDOCW7NX85tr6r2","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T08:15:36Z","updated_at":"2023-12-05T08:15:36Z","author_association":"CONTRIBUTOR","body":"@GianlucaPrincipini I would probably rename this PR so that it directly addresses https://github.com/apache/iceberg/issues/9210 (because that's what it is doing here). We might also want to convert a few more parameterized tests to using this, just to make sure we're not missing anything","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840229110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840407544","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1840407544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1840407544,"node_id":"IC_kwDOCW7NX85tsmP4","user":{"login":"ExplorData24","id":149940691,"node_id":"U_kgDOCO_p0w","avatar_url":"https://avatars.githubusercontent.com/u/149940691?v=4","gravatar_id":"","url":"https://api.github.com/users/ExplorData24","html_url":"https://github.com/ExplorData24","followers_url":"https://api.github.com/users/ExplorData24/followers","following_url":"https://api.github.com/users/ExplorData24/following{/other_user}","gists_url":"https://api.github.com/users/ExplorData24/gists{/gist_id}","starred_url":"https://api.github.com/users/ExplorData24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ExplorData24/subscriptions","organizations_url":"https://api.github.com/users/ExplorData24/orgs","repos_url":"https://api.github.com/users/ExplorData24/repos","events_url":"https://api.github.com/users/ExplorData24/events{/privacy}","received_events_url":"https://api.github.com/users/ExplorData24/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T09:52:09Z","updated_at":"2023-12-05T09:52:09Z","author_association":"NONE","body":"@nastra \r\nHello Sir.\r\n\r\nI'm really disappointed with this error.\r\n\r\nAny idea, please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840407544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840521246","html_url":"https://github.com/apache/iceberg/pull/9131#issuecomment-1840521246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9131","id":1840521246,"node_id":"IC_kwDOCW7NX85ttCAe","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T11:02:02Z","updated_at":"2023-12-05T11:02:02Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing this @rdblue, I've applied your feedback and also moved the VERSION AS OF handling to https://github.com/apache/iceberg/pull/9219","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840521246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840531555","html_url":"https://github.com/apache/iceberg/issues/9218#issuecomment-1840531555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9218","id":1840531555,"node_id":"IC_kwDOCW7NX85ttEhj","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T11:08:23Z","updated_at":"2023-12-05T11:08:23Z","author_association":"CONTRIBUTOR","body":"@AllenWee1106 Thanks for reaching out. It depends on the workload, but Iceberg handles multiple writes fairly well. Mostly because it knows when commits are conflicting: https://iceberg.apache.org/docs/latest/reliability/#concurrent-write-operations \r\n\r\nFor example, if you do two operations that don't affect each other, Iceberg can do a fairly cheap retry and this increase throughput. Can I ask which catalog you're using?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840531555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840534246","html_url":"https://github.com/apache/iceberg/pull/8857#issuecomment-1840534246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8857","id":1840534246,"node_id":"IC_kwDOCW7NX85ttFLm","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T11:09:59Z","updated_at":"2023-12-05T11:09:59Z","author_association":"MEMBER","body":"@nastra: Please help in merging this. I will rebase my view PR once this is merged.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840534246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840535211","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1840535211","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1840535211,"node_id":"IC_kwDOCW7NX85ttFar","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T11:10:35Z","updated_at":"2023-12-05T11:10:35Z","author_association":"CONTRIBUTOR","body":"@ExplorData24 I think you really have to go step-by-step and only change one thing at a time to see which change causes this error. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840535211/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840640373","html_url":"https://github.com/apache/iceberg/issues/9205#issuecomment-1840640373","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9205","id":1840640373,"node_id":"IC_kwDOCW7NX85ttfF1","user":{"login":"ExplorData24","id":149940691,"node_id":"U_kgDOCO_p0w","avatar_url":"https://avatars.githubusercontent.com/u/149940691?v=4","gravatar_id":"","url":"https://api.github.com/users/ExplorData24","html_url":"https://github.com/ExplorData24","followers_url":"https://api.github.com/users/ExplorData24/followers","following_url":"https://api.github.com/users/ExplorData24/following{/other_user}","gists_url":"https://api.github.com/users/ExplorData24/gists{/gist_id}","starred_url":"https://api.github.com/users/ExplorData24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ExplorData24/subscriptions","organizations_url":"https://api.github.com/users/ExplorData24/orgs","repos_url":"https://api.github.com/users/ExplorData24/repos","events_url":"https://api.github.com/users/ExplorData24/events{/privacy}","received_events_url":"https://api.github.com/users/ExplorData24/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T11:50:34Z","updated_at":"2023-12-05T11:50:34Z","author_association":"NONE","body":"@nastra \r\n\r\nEffectively, that's what I've done before.\r\nIt's a fuzzy problem.\r\nFor example, to check permissions, I tried to play a file from Minio: \r\n![image](https://github.com/apache/iceberg/assets/149940691/d584940c-24b0-40c7-a954-df450fe20b48)\r\n\r\n![image](https://github.com/apache/iceberg/assets/149940691/49f38407-fc0e-4690-a46b-955757ae9a6f)\r\n![image](https://github.com/apache/iceberg/assets/149940691/07bd3f5f-2a19-4274-8ed1-bb4d821950e9)\r\n![image](https://github.com/apache/iceberg/assets/149940691/1108b17c-e6af-49b1-b740-cb4d5a9be577)\r\nBut,when I tried to run this command again I get the same error:\r\n![image](https://github.com/apache/iceberg/assets/149940691/1e33f974-a6b8-4633-bdaa-b6cacb4148df)\r\nPy4JJavaError: An error occurred while calling o47.sql.\r\n: software.amazon.awssdk.services.s3.model.S3Exception: null (Service: S3, Status Code: 400, Request ID: WQS2Q0N2G0NNBJ2X, Extended Request ID: MZO/RQQj7qSlrvdKUM4hYD1ripEP0bP1/xytTlC1EoaHn0zwp2FgthRsCTolEcqs7HGR+jqFrhg=)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840640373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840654784","html_url":"https://github.com/apache/iceberg/issues/9089#issuecomment-1840654784","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9089","id":1840654784,"node_id":"IC_kwDOCW7NX85ttinA","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T11:59:41Z","updated_at":"2023-12-05T11:59:41Z","author_association":"CONTRIBUTOR","body":"When you have a table with high number of snapshots, then consecutive snapshots require more time to write out the metadata json. That said, it should only cause delays in committing the data to the Iceberg table, but the snapshot should eventually be committed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840654784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840670326","html_url":"https://github.com/apache/iceberg/pull/9216#issuecomment-1840670326","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9216","id":1840670326,"node_id":"IC_kwDOCW7NX85ttmZ2","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T12:09:01Z","updated_at":"2023-12-05T12:09:01Z","author_association":"CONTRIBUTOR","body":"Thanks for catching and fixing this @stevenzwu !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1840670326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841035245","html_url":"https://github.com/apache/iceberg/pull/9221#issuecomment-1841035245","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9221","id":1841035245,"node_id":"IC_kwDOCW7NX85tu_ft","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T15:34:19Z","updated_at":"2023-12-05T15:34:19Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/iceberg/pull/9183 @bartash  already added tests for the ExpireSnapshots case, but based on the tests passing before that implies there weren't any tests for case 2 above (since those would have caught the behavior change in deletion in case snapshots couldn't be looked up). It may be difficult to test for that case (have to force the lookup of a committed snapshot to be null right after the transaction commits) , but I'll look into it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841035245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841096970","html_url":"https://github.com/apache/iceberg/pull/7913#issuecomment-1841096970","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7913","id":1841096970,"node_id":"IC_kwDOCW7NX85tvOkK","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T16:03:58Z","updated_at":"2023-12-05T16:03:58Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra! Great to have this in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841096970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841116845","html_url":"https://github.com/apache/iceberg/issues/9172#issuecomment-1841116845","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9172","id":1841116845,"node_id":"IC_kwDOCW7NX85tvTat","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T16:13:55Z","updated_at":"2023-12-05T16:14:18Z","author_association":"CONTRIBUTOR","body":"I think https://github.com/apache/iceberg/issues/8953 is related. Could you take a look at that thread and see if it's the same behavior you're seeing?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841116845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841135980","html_url":"https://github.com/apache/iceberg/issues/8953#issuecomment-1841135980","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8953","id":1841135980,"node_id":"IC_kwDOCW7NX85tvYFs","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T16:23:08Z","updated_at":"2023-12-05T16:23:27Z","author_association":"CONTRIBUTOR","body":"Thanks for the details, yeah I  agree a UUID would of course essentially guarantee uniqueness, I'm just not sure of all the implications of changing the output path for spark streaming. There really shouldn't be any implications since it would only affect new files which get written in the streaming job. Existing files paths would be left untouched.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841135980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841164689","html_url":"https://github.com/apache/iceberg/pull/9183#issuecomment-1841164689","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9183","id":1841164689,"node_id":"IC_kwDOCW7NX85tvfGR","user":{"login":"bartash","id":1914851,"node_id":"MDQ6VXNlcjE5MTQ4NTE=","avatar_url":"https://avatars.githubusercontent.com/u/1914851?v=4","gravatar_id":"","url":"https://api.github.com/users/bartash","html_url":"https://github.com/bartash","followers_url":"https://api.github.com/users/bartash/followers","following_url":"https://api.github.com/users/bartash/following{/other_user}","gists_url":"https://api.github.com/users/bartash/gists{/gist_id}","starred_url":"https://api.github.com/users/bartash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bartash/subscriptions","organizations_url":"https://api.github.com/users/bartash/orgs","repos_url":"https://api.github.com/users/bartash/repos","events_url":"https://api.github.com/users/bartash/events{/privacy}","received_events_url":"https://api.github.com/users/bartash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T16:36:11Z","updated_at":"2023-12-05T16:36:11Z","author_association":"MEMBER","body":"> Once this gets in, can you create a PR against the `1.4.x` branch?\r\n\r\nClean cherry-pick to 1.4.x is in #9223","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841164689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841204296","html_url":"https://github.com/apache/iceberg/pull/9179#issuecomment-1841204296","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9179","id":1841204296,"node_id":"IC_kwDOCW7NX85tvoxI","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T16:48:42Z","updated_at":"2023-12-05T16:48:42Z","author_association":"CONTRIBUTOR","body":"thanks @pvary for the documentation. thanks @mas-chen for the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841204296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841209354","html_url":"https://github.com/apache/iceberg/pull/9179#issuecomment-1841209354","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9179","id":1841209354,"node_id":"IC_kwDOCW7NX85tvqAK","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T16:49:41Z","updated_at":"2023-12-05T16:49:41Z","author_association":"CONTRIBUTOR","body":"Thanks for the review and the merge @stevenzwu and @mas-chen !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841209354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841230595","html_url":"https://github.com/apache/iceberg/pull/9187#issuecomment-1841230595","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9187","id":1841230595,"node_id":"IC_kwDOCW7NX85tvvMD","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T16:58:46Z","updated_at":"2023-12-05T16:58:46Z","author_association":"MEMBER","body":"ping","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841230595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841277926","html_url":"https://github.com/apache/iceberg/pull/9222#issuecomment-1841277926","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9222","id":1841277926,"node_id":"IC_kwDOCW7NX85tv6vm","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T17:25:42Z","updated_at":"2023-12-05T17:25:42Z","author_association":"CONTRIBUTOR","body":"@jasonf20 can you please add a test that reproduces the issue you're seeing? This makes it easier to reason about the problem","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841277926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841281189","html_url":"https://github.com/apache/iceberg/pull/9189#issuecomment-1841281189","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9189","id":1841281189,"node_id":"IC_kwDOCW7NX85tv7il","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T17:27:40Z","updated_at":"2023-12-05T17:27:40Z","author_association":"CONTRIBUTOR","body":"Thanks @nastra 🙌 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841281189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841290690","html_url":"https://github.com/apache/iceberg/pull/9222#issuecomment-1841290690","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9222","id":1841290690,"node_id":"IC_kwDOCW7NX85tv93C","user":{"login":"jasonf20","id":1601106,"node_id":"MDQ6VXNlcjE2MDExMDY=","avatar_url":"https://avatars.githubusercontent.com/u/1601106?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonf20","html_url":"https://github.com/jasonf20","followers_url":"https://api.github.com/users/jasonf20/followers","following_url":"https://api.github.com/users/jasonf20/following{/other_user}","gists_url":"https://api.github.com/users/jasonf20/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonf20/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonf20/subscriptions","organizations_url":"https://api.github.com/users/jasonf20/orgs","repos_url":"https://api.github.com/users/jasonf20/repos","events_url":"https://api.github.com/users/jasonf20/events{/privacy}","received_events_url":"https://api.github.com/users/jasonf20/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T17:34:00Z","updated_at":"2023-12-05T17:34:00Z","author_association":"CONTRIBUTOR","body":"Hi @nastra \r\n\r\nI’m not very familiar with this codebase and adding tests that will fail at the right time would take me a long time. Unfortunately, I can’t do that right now.\r\n\r\nHowever, below is the code I used to reproduce the issue locally:\r\n\r\n```scala\r\nimport java.util\r\nimport java.util.UUID\r\n\r\nimport scala.collection.JavaConverters._\r\n\r\nimport org.apache.iceberg.aws.glue.GlueCatalog\r\nimport org.apache.iceberg.catalog._\r\nimport org.apache.iceberg.data.GenericRecord\r\nimport org.apache.iceberg.data.parquet.GenericParquetWriter\r\nimport org.apache.iceberg.parquet.Parquet\r\nimport org.apache.iceberg.types.Types\r\nimport org.apache.iceberg.{DataFile, PartitionSpec, Schema, Table, data}\r\n\r\nobject TestRewriteCommits {\r\n\r\n  def main(args: Array[String]): Unit = {\r\n    val catalog = new GlueCatalog()\r\n    catalog.initialize(\"iceberg\", Map.empty[String, String].asJava)\r\n\r\n    val schema = new Schema(\r\n      Types.NestedField.required(1, \"id\", Types.StringType.get()),\r\n    );\r\n    val tableName = \"temp4\"\r\n    val tableId = TableIdentifier.of(\"prod_iceberg\", tableName)\r\n    val basePath = s\"s3://s3-bucket-path/ice/tables/${tableName}/\"\r\n\r\n     val tableProperties: util.Map[String, String] = Map(\r\n      \"format-version\" -> \"2\",\r\n      \"commit.retry.num-retries\" -> \"0\" //turn off retries for more control during testing process\r\n    ).asJava\r\n    if (!catalog.tableExists(tableId)) {\r\n      catalog.createTable(tableId, schema, PartitionSpec.unpartitioned(), basePath, tableProperties)\r\n    }\r\n\r\n    val table = catalog.loadTable(tableId)\r\n\r\n    val addedFiles = (1 to 2).map(i => {\r\n      val file: DataFile = writeFile(basePath, table)\r\n      val append = table.newAppend()\r\n      append.appendFile(file)\r\n      append.commit()\r\n      file\r\n    })\r\n\r\n    val transaction = table.newTransaction()\r\n    val rewrite = transaction.newRewrite()\r\n    addedFiles.foreach(rewrite.deleteFile)\r\n    rewrite.addFile(writeFile(basePath, table))\r\n    rewrite.commit()\r\n    try {\r\n      // Make sure this commit fails (I failed it by breaking at glue.updateTable(updateTableRequest.build()); and changing the table from athena.\r\n      transaction.commitTransaction()\r\n    } catch {\r\n      case e: Throwable =>\r\n        // This retry will run successfully but the result will not contain the data file added during the rewrite. \r\n        transaction.commitTransaction()\r\n    }\r\n  }\r\n\r\n  private def writeFile(basePath: String, table: Table) = {\r\n    val writer = Parquet.writeData(\r\n        table.io().newOutputFile(basePath + UUID.randomUUID().toString + \".parquet\"))\r\n      .forTable(table)\r\n      .overwrite(true)\r\n      .createWriterFunc(GenericParquetWriter.buildWriter)\r\n      .build[data.Record]()\r\n    writer.write(Iterable(GenericRecord.create(table.schema()).copy(\"id\", \"1\")).asJava)\r\n    writer.close()\r\n    val file = writer.toDataFile\r\n    file\r\n  }\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841290690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841301960","html_url":"https://github.com/apache/iceberg/pull/9222#issuecomment-1841301960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9222","id":1841301960,"node_id":"IC_kwDOCW7NX85twAnI","user":{"login":"jasonf20","id":1601106,"node_id":"MDQ6VXNlcjE2MDExMDY=","avatar_url":"https://avatars.githubusercontent.com/u/1601106?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonf20","html_url":"https://github.com/jasonf20","followers_url":"https://api.github.com/users/jasonf20/followers","following_url":"https://api.github.com/users/jasonf20/following{/other_user}","gists_url":"https://api.github.com/users/jasonf20/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonf20/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonf20/subscriptions","organizations_url":"https://api.github.com/users/jasonf20/orgs","repos_url":"https://api.github.com/users/jasonf20/repos","events_url":"https://api.github.com/users/jasonf20/events{/privacy}","received_events_url":"https://api.github.com/users/jasonf20/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T17:41:13Z","updated_at":"2023-12-05T17:52:53Z","author_association":"CONTRIBUTOR","body":"Now that I think about it, it's possible that `cleanUncomittedFiles` is only called after all the internal retries fail, so doing manual retries will not work but automatic ones would. \r\n\r\nIf that's the case it might be a bug in my usage pattern and re-using the same transaction is invalid. I thought it should be ok, but now it seems it's more subtle than that. \r\n\r\nIf that is the case I think we should add a validation error when re-commiting the same change. Otherwise, partial commits can happen like with my example code above. But this would be a much less urgent bug.  (In the example code above the rewrite applies the deletes but the new file isn't added)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841301960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841336236","html_url":"https://github.com/apache/iceberg/pull/8502#issuecomment-1841336236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8502","id":1841336236,"node_id":"IC_kwDOCW7NX85twI-s","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T18:04:29Z","updated_at":"2023-12-05T18:04:29Z","author_association":"CONTRIBUTOR","body":"I started looking on Friday but got distracted. I will try to finish by end of Wed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841336236/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841354140","html_url":"https://github.com/apache/iceberg/pull/9222#issuecomment-1841354140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9222","id":1841354140,"node_id":"IC_kwDOCW7NX85twNWc","user":{"login":"jasonf20","id":1601106,"node_id":"MDQ6VXNlcjE2MDExMDY=","avatar_url":"https://avatars.githubusercontent.com/u/1601106?v=4","gravatar_id":"","url":"https://api.github.com/users/jasonf20","html_url":"https://github.com/jasonf20","followers_url":"https://api.github.com/users/jasonf20/followers","following_url":"https://api.github.com/users/jasonf20/following{/other_user}","gists_url":"https://api.github.com/users/jasonf20/gists{/gist_id}","starred_url":"https://api.github.com/users/jasonf20/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasonf20/subscriptions","organizations_url":"https://api.github.com/users/jasonf20/orgs","repos_url":"https://api.github.com/users/jasonf20/repos","events_url":"https://api.github.com/users/jasonf20/events{/privacy}","received_events_url":"https://api.github.com/users/jasonf20/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T18:17:16Z","updated_at":"2023-12-05T18:17:16Z","author_association":"CONTRIBUTOR","body":"I was not able to reproduce this issue with internal retries so I'm closing this and converting it to a bug that isn't as critical:\r\nhttps://github.com/apache/iceberg/issues/9227","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841354140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841356581","html_url":"https://github.com/apache/iceberg/pull/9223#issuecomment-1841356581","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9223","id":1841356581,"node_id":"IC_kwDOCW7NX85twN8l","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T18:18:57Z","updated_at":"2023-12-05T18:18:57Z","author_association":"CONTRIBUTOR","body":"Thanks @bartash . I think let's get https://github.com/apache/iceberg/pull/9221 in first and then we can rebase this change? The change for returning a new empty set was not just stylistic, it was intentional to distinguish the case where deletion can be performed (empty snapshot list from expire snapshots in a transaction) and where deletion should not be performed if we could not determine the files to delete (snapshot lookup failed)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841356581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841360572","html_url":"https://github.com/apache/iceberg/pull/9223#issuecomment-1841360572","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9223","id":1841360572,"node_id":"IC_kwDOCW7NX85twO68","user":{"login":"bartash","id":1914851,"node_id":"MDQ6VXNlcjE5MTQ4NTE=","avatar_url":"https://avatars.githubusercontent.com/u/1914851?v=4","gravatar_id":"","url":"https://api.github.com/users/bartash","html_url":"https://github.com/bartash","followers_url":"https://api.github.com/users/bartash/followers","following_url":"https://api.github.com/users/bartash/following{/other_user}","gists_url":"https://api.github.com/users/bartash/gists{/gist_id}","starred_url":"https://api.github.com/users/bartash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bartash/subscriptions","organizations_url":"https://api.github.com/users/bartash/orgs","repos_url":"https://api.github.com/users/bartash/repos","events_url":"https://api.github.com/users/bartash/events{/privacy}","received_events_url":"https://api.github.com/users/bartash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T18:21:46Z","updated_at":"2023-12-05T18:21:46Z","author_association":"MEMBER","body":"Thanks @amogh-jahagirdar sounds good","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841360572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841655753","html_url":"https://github.com/apache/iceberg/pull/9161#issuecomment-1841655753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9161","id":1841655753,"node_id":"IC_kwDOCW7NX85txW_J","user":{"login":"GianlucaPrincipini","id":13685556,"node_id":"MDQ6VXNlcjEzNjg1NTU2","avatar_url":"https://avatars.githubusercontent.com/u/13685556?v=4","gravatar_id":"","url":"https://api.github.com/users/GianlucaPrincipini","html_url":"https://github.com/GianlucaPrincipini","followers_url":"https://api.github.com/users/GianlucaPrincipini/followers","following_url":"https://api.github.com/users/GianlucaPrincipini/following{/other_user}","gists_url":"https://api.github.com/users/GianlucaPrincipini/gists{/gist_id}","starred_url":"https://api.github.com/users/GianlucaPrincipini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GianlucaPrincipini/subscriptions","organizations_url":"https://api.github.com/users/GianlucaPrincipini/orgs","repos_url":"https://api.github.com/users/GianlucaPrincipini/repos","events_url":"https://api.github.com/users/GianlucaPrincipini/events{/privacy}","received_events_url":"https://api.github.com/users/GianlucaPrincipini/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T21:38:10Z","updated_at":"2023-12-05T21:38:10Z","author_association":"CONTRIBUTOR","body":"@nastra, sounds ok to me. I will work on migrating some other class in the next few days","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841655753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841667707","html_url":"https://github.com/apache/iceberg/pull/9213#issuecomment-1841667707","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9213","id":1841667707,"node_id":"IC_kwDOCW7NX85txZ57","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T21:47:00Z","updated_at":"2023-12-05T21:47:00Z","author_association":"CONTRIBUTOR","body":"The Flink test failure does not seem related.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841667707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841668881","html_url":"https://github.com/apache/iceberg/pull/8755#issuecomment-1841668881","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8755","id":1841668881,"node_id":"IC_kwDOCW7NX85txaMR","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T21:47:50Z","updated_at":"2023-12-05T21:47:50Z","author_association":"CONTRIBUTOR","body":"The Flink test failure does not seem related.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841668881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841688683","html_url":"https://github.com/apache/iceberg/pull/9213#issuecomment-1841688683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9213","id":1841688683,"node_id":"IC_kwDOCW7NX85txfBr","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T22:01:02Z","updated_at":"2023-12-05T22:01:02Z","author_association":"CONTRIBUTOR","body":"Thank you, @yyy1000!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841688683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841776563","html_url":"https://github.com/apache/iceberg/pull/8980#issuecomment-1841776563","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8980","id":1841776563,"node_id":"IC_kwDOCW7NX85tx0ez","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-05T23:12:23Z","updated_at":"2023-12-05T23:12:23Z","author_association":"CONTRIBUTOR","body":"@cccs-jc i mean let's have changes for 3.5 with it's test only in 3.5 and we can backport the change with it's test in lower spark version like 3.4 and 3.3, 3.4 test failures are expected right as we don't have changes for SparkMicrobatch stream for 3.4 in it. \r\n\r\nAlso i would request to revert the change in core for Microbatch.java if we don't have coverage for it as i am unsure when would that fail (may be some legacy handling) \r\n\r\nApologies for getting being late in getting back at this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841776563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841859529","html_url":"https://github.com/apache/iceberg/issues/7640#issuecomment-1841859529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7640","id":1841859529,"node_id":"IC_kwDOCW7NX85tyIvJ","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T00:11:46Z","updated_at":"2023-12-06T00:11:46Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841859529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841927189","html_url":"https://github.com/apache/iceberg/pull/9181#issuecomment-1841927189","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9181","id":1841927189,"node_id":"IC_kwDOCW7NX85tyZQV","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T01:27:36Z","updated_at":"2023-12-06T01:27:36Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @nastra , merging ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841927189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841972935","html_url":"https://github.com/apache/iceberg/pull/9213#issuecomment-1841972935","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9213","id":1841972935,"node_id":"IC_kwDOCW7NX85tykbH","user":{"login":"yyy1000","id":69566909,"node_id":"MDQ6VXNlcjY5NTY2OTA5","avatar_url":"https://avatars.githubusercontent.com/u/69566909?v=4","gravatar_id":"","url":"https://api.github.com/users/yyy1000","html_url":"https://github.com/yyy1000","followers_url":"https://api.github.com/users/yyy1000/followers","following_url":"https://api.github.com/users/yyy1000/following{/other_user}","gists_url":"https://api.github.com/users/yyy1000/gists{/gist_id}","starred_url":"https://api.github.com/users/yyy1000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyy1000/subscriptions","organizations_url":"https://api.github.com/users/yyy1000/orgs","repos_url":"https://api.github.com/users/yyy1000/repos","events_url":"https://api.github.com/users/yyy1000/events{/privacy}","received_events_url":"https://api.github.com/users/yyy1000/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T02:14:16Z","updated_at":"2023-12-06T02:14:16Z","author_association":"CONTRIBUTOR","body":"Thank you for your review, @aokolnychyi!\r\nI like the project and I can definitely contribute more. :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1841972935/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842071333","html_url":"https://github.com/apache/iceberg/issues/9172#issuecomment-1842071333","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9172","id":1842071333,"node_id":"IC_kwDOCW7NX85ty8cl","user":{"login":"Abhishek-Dutta","id":7696662,"node_id":"MDQ6VXNlcjc2OTY2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/7696662?v=4","gravatar_id":"","url":"https://api.github.com/users/Abhishek-Dutta","html_url":"https://github.com/Abhishek-Dutta","followers_url":"https://api.github.com/users/Abhishek-Dutta/followers","following_url":"https://api.github.com/users/Abhishek-Dutta/following{/other_user}","gists_url":"https://api.github.com/users/Abhishek-Dutta/gists{/gist_id}","starred_url":"https://api.github.com/users/Abhishek-Dutta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Abhishek-Dutta/subscriptions","organizations_url":"https://api.github.com/users/Abhishek-Dutta/orgs","repos_url":"https://api.github.com/users/Abhishek-Dutta/repos","events_url":"https://api.github.com/users/Abhishek-Dutta/events{/privacy}","received_events_url":"https://api.github.com/users/Abhishek-Dutta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T04:35:55Z","updated_at":"2023-12-06T04:35:55Z","author_association":"NONE","body":"@amogh-jahagirdar Yes, these two are related. I am a colleague @amitmittal5, and after raising this issue later we found similar issue was opened end of October. The difference is, this we found in Azure while working in ADLS Gen2, but the behavior is same.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842071333/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842108506","html_url":"https://github.com/apache/iceberg/issues/9218#issuecomment-1842108506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9218","id":1842108506,"node_id":"IC_kwDOCW7NX85tzFha","user":{"login":"AllenWee1106","id":146182256,"node_id":"U_kgDOCLaQcA","avatar_url":"https://avatars.githubusercontent.com/u/146182256?v=4","gravatar_id":"","url":"https://api.github.com/users/AllenWee1106","html_url":"https://github.com/AllenWee1106","followers_url":"https://api.github.com/users/AllenWee1106/followers","following_url":"https://api.github.com/users/AllenWee1106/following{/other_user}","gists_url":"https://api.github.com/users/AllenWee1106/gists{/gist_id}","starred_url":"https://api.github.com/users/AllenWee1106/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AllenWee1106/subscriptions","organizations_url":"https://api.github.com/users/AllenWee1106/orgs","repos_url":"https://api.github.com/users/AllenWee1106/repos","events_url":"https://api.github.com/users/AllenWee1106/events{/privacy}","received_events_url":"https://api.github.com/users/AllenWee1106/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T05:23:47Z","updated_at":"2023-12-06T05:23:47Z","author_association":"NONE","body":"@Fokko  I am using the JDCB catalog .  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842108506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842119111","html_url":"https://github.com/apache/iceberg/issues/9208#issuecomment-1842119111","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9208","id":1842119111,"node_id":"IC_kwDOCW7NX85tzIHH","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T05:34:03Z","updated_at":"2023-12-06T05:34:03Z","author_association":"MEMBER","body":"@danielcweeks, @Fokko, @nastra: \r\nI have revived the PRs and it is ready for review. \r\n\r\nhttps://github.com/apache/iceberg/pull/6887\r\nhttps://github.com/apache/iceberg/pull/4776\r\n   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842119111/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842125593","html_url":"https://github.com/apache/iceberg/pull/9213#issuecomment-1842125593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9213","id":1842125593,"node_id":"IC_kwDOCW7NX85tzJsZ","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T05:41:53Z","updated_at":"2023-12-06T05:41:53Z","author_association":"CONTRIBUTOR","body":"The Flink flaky test is fixed by #9216. Thanks @stevenzwu!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842125593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842133235","html_url":"https://github.com/apache/iceberg/issues/9218#issuecomment-1842133235","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9218","id":1842133235,"node_id":"IC_kwDOCW7NX85tzLjz","user":{"login":"AllenWee1106","id":146182256,"node_id":"U_kgDOCLaQcA","avatar_url":"https://avatars.githubusercontent.com/u/146182256?v=4","gravatar_id":"","url":"https://api.github.com/users/AllenWee1106","html_url":"https://github.com/AllenWee1106","followers_url":"https://api.github.com/users/AllenWee1106/followers","following_url":"https://api.github.com/users/AllenWee1106/following{/other_user}","gists_url":"https://api.github.com/users/AllenWee1106/gists{/gist_id}","starred_url":"https://api.github.com/users/AllenWee1106/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AllenWee1106/subscriptions","organizations_url":"https://api.github.com/users/AllenWee1106/orgs","repos_url":"https://api.github.com/users/AllenWee1106/repos","events_url":"https://api.github.com/users/AllenWee1106/events{/privacy}","received_events_url":"https://api.github.com/users/AllenWee1106/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T05:51:51Z","updated_at":"2023-12-06T05:51:51Z","author_association":"NONE","body":"@Fokko  \r\nHowever, the following anomalies are occurring frequently now：\r\n\r\n`Caused by: org.apache.iceberg.exceptions.CommitFailedException: Cannot commit datalake.slp_quality: metadata location s3://warehouse/datalake/SLP_Quality/metadata/6390c7416eff.metadata.json has changed from s3://warehouse/datalake/SLP_Quality/metadata/b167af31b5fa.metadata.json \r\norg.apache.iceberg.jdbc.JdbcTableOperations.validateMetadataLocation(JdbcTableOperations.java:211) `\r\n\r\nregarding this question, This is the issue I raised: https://github.com/apache/iceberg/issues/9178 ,  the analysis provided by the technical personnel is likely due to a large number of concurrent operations causing this problem to occur.\r\n\r\nIceberg has a retry mechanism, but it also affects the time it takes for my task to end. It should have been around 10 minutes, but now it takes about 40 minutes for this issue to occur, and sometimes it can cause the task to fail directly.\r\n\r\nTherefore, I would like to inquire about how such issues can be quickly and efficiently resolved.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842133235/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842146242","html_url":"https://github.com/apache/iceberg/issues/9193#issuecomment-1842146242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9193","id":1842146242,"node_id":"IC_kwDOCW7NX85tzOvC","user":{"login":"bhupixb","id":30554307,"node_id":"MDQ6VXNlcjMwNTU0MzA3","avatar_url":"https://avatars.githubusercontent.com/u/30554307?v=4","gravatar_id":"","url":"https://api.github.com/users/bhupixb","html_url":"https://github.com/bhupixb","followers_url":"https://api.github.com/users/bhupixb/followers","following_url":"https://api.github.com/users/bhupixb/following{/other_user}","gists_url":"https://api.github.com/users/bhupixb/gists{/gist_id}","starred_url":"https://api.github.com/users/bhupixb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhupixb/subscriptions","organizations_url":"https://api.github.com/users/bhupixb/orgs","repos_url":"https://api.github.com/users/bhupixb/repos","events_url":"https://api.github.com/users/bhupixb/events{/privacy}","received_events_url":"https://api.github.com/users/bhupixb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T05:57:24Z","updated_at":"2023-12-06T05:57:24Z","author_association":"NONE","body":"Thank you, this helped us give some direction. We disabled the equality field column and upsert property. After that it is working correctly.\r\nThough our job does not upsert more than a hundred records apparently we are seeing `\"total-equality-deletes\" : \"25000000\"` in the manifest file. We will debug more on this, maybe bug in our implementation or something.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842146242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842175872","html_url":"https://github.com/apache/iceberg/issues/4127#issuecomment-1842175872","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4127","id":1842175872,"node_id":"IC_kwDOCW7NX85tzV-A","user":{"login":"chenwyi2","id":19389434,"node_id":"MDQ6VXNlcjE5Mzg5NDM0","avatar_url":"https://avatars.githubusercontent.com/u/19389434?v=4","gravatar_id":"","url":"https://api.github.com/users/chenwyi2","html_url":"https://github.com/chenwyi2","followers_url":"https://api.github.com/users/chenwyi2/followers","following_url":"https://api.github.com/users/chenwyi2/following{/other_user}","gists_url":"https://api.github.com/users/chenwyi2/gists{/gist_id}","starred_url":"https://api.github.com/users/chenwyi2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenwyi2/subscriptions","organizations_url":"https://api.github.com/users/chenwyi2/orgs","repos_url":"https://api.github.com/users/chenwyi2/repos","events_url":"https://api.github.com/users/chenwyi2/events{/privacy}","received_events_url":"https://api.github.com/users/chenwyi2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T06:33:14Z","updated_at":"2023-12-06T06:33:14Z","author_association":"NONE","body":"@szehon-ho Is there a plan to deal with equality delete?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842175872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842345834","html_url":"https://github.com/apache/iceberg/pull/7504#issuecomment-1842345834","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7504","id":1842345834,"node_id":"IC_kwDOCW7NX85tz_dq","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T08:01:14Z","updated_at":"2023-12-06T08:01:14Z","author_association":"CONTRIBUTOR","body":"I think this has probably gone stale, I'm going to close this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842345834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842351441","html_url":"https://github.com/apache/iceberg/pull/9162#issuecomment-1842351441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9162","id":1842351441,"node_id":"IC_kwDOCW7NX85t0A1R","user":{"login":"emkornfield","id":17869838,"node_id":"MDQ6VXNlcjE3ODY5ODM4","avatar_url":"https://avatars.githubusercontent.com/u/17869838?v=4","gravatar_id":"","url":"https://api.github.com/users/emkornfield","html_url":"https://github.com/emkornfield","followers_url":"https://api.github.com/users/emkornfield/followers","following_url":"https://api.github.com/users/emkornfield/following{/other_user}","gists_url":"https://api.github.com/users/emkornfield/gists{/gist_id}","starred_url":"https://api.github.com/users/emkornfield/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emkornfield/subscriptions","organizations_url":"https://api.github.com/users/emkornfield/orgs","repos_url":"https://api.github.com/users/emkornfield/repos","events_url":"https://api.github.com/users/emkornfield/events{/privacy}","received_events_url":"https://api.github.com/users/emkornfield/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T08:02:08Z","updated_at":"2023-12-06T08:02:08Z","author_association":"CONTRIBUTOR","body":"@Fokko do you have the ability to merge this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842351441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842370347","html_url":"https://github.com/apache/iceberg/pull/9162#issuecomment-1842370347","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9162","id":1842370347,"node_id":"IC_kwDOCW7NX85t0Fcr","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T08:07:11Z","updated_at":"2023-12-06T08:07:11Z","author_association":"CONTRIBUTOR","body":"@emkornfield Yes, I have. Just wanted to see if anyone else had some addition to this, but this looks great. Thanks for clarifying this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842370347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842441255","html_url":"https://github.com/apache/iceberg/issues/9127#issuecomment-1842441255","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9127","id":1842441255,"node_id":"IC_kwDOCW7NX85t0Wwn","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T08:45:41Z","updated_at":"2023-12-06T08:45:41Z","author_association":"CONTRIBUTOR","body":"Hey @ronkorving Thanks for raising this. That's very true, the status page seems to be very outdated.\r\n\r\nThe V1, and V2 specs are out there, and work is being done on the V3 spec (more type promotions, nanosecond support, and more). Are you interested in trimming down the section, and updating it where needed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842441255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842664896","html_url":"https://github.com/apache/iceberg/pull/9231#issuecomment-1842664896","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9231","id":1842664896,"node_id":"IC_kwDOCW7NX85t1NXA","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T11:12:49Z","updated_at":"2023-12-06T11:12:49Z","author_association":"MEMBER","body":"PR title can be \"gc.enabled\" instead of \"GC.ENABLED\" as properties are case sensitive. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842664896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842692615","html_url":"https://github.com/apache/iceberg/issues/9220#issuecomment-1842692615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9220","id":1842692615,"node_id":"IC_kwDOCW7NX85t1UIH","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T11:32:26Z","updated_at":"2023-12-06T11:33:26Z","author_association":"MEMBER","body":"I don't remember any hard coded limitation. \r\nBut Field ID of partition columns in schema starts from 10K. So if you have 300K columns it will conflict with column ids. \r\nSo, indirectly it is restricted to less than 10k columns. \r\n\r\nBTW isn't 300K columns is way too huge? Are you planning to create multiple tables from that file or initial plan was to store all of it in a single table?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842692615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842974757","html_url":"https://github.com/apache/iceberg/issues/9089#issuecomment-1842974757","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9089","id":1842974757,"node_id":"IC_kwDOCW7NX85t2ZAl","user":{"login":"FranMorilloAWS","id":85679820,"node_id":"MDQ6VXNlcjg1Njc5ODIw","avatar_url":"https://avatars.githubusercontent.com/u/85679820?v=4","gravatar_id":"","url":"https://api.github.com/users/FranMorilloAWS","html_url":"https://github.com/FranMorilloAWS","followers_url":"https://api.github.com/users/FranMorilloAWS/followers","following_url":"https://api.github.com/users/FranMorilloAWS/following{/other_user}","gists_url":"https://api.github.com/users/FranMorilloAWS/gists{/gist_id}","starred_url":"https://api.github.com/users/FranMorilloAWS/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FranMorilloAWS/subscriptions","organizations_url":"https://api.github.com/users/FranMorilloAWS/orgs","repos_url":"https://api.github.com/users/FranMorilloAWS/repos","events_url":"https://api.github.com/users/FranMorilloAWS/events{/privacy}","received_events_url":"https://api.github.com/users/FranMorilloAWS/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T14:16:29Z","updated_at":"2023-12-06T14:16:29Z","author_association":"NONE","body":"I upgraded to Iceberg 1.14 and Flink 1.15 and still am seeing the issue if the table has more than a 10000 snapshots.  Could somebody explain how writing, and comitting actually works in Flink? How does it leverage state. What could be happening that even though files are being written to s3, checkpoints are completing without issues, but no commits are happening to tables.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842974757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842988192","html_url":"https://github.com/apache/iceberg/pull/9224#issuecomment-1842988192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9224","id":1842988192,"node_id":"IC_kwDOCW7NX85t2cSg","user":{"login":"yyy1000","id":69566909,"node_id":"MDQ6VXNlcjY5NTY2OTA5","avatar_url":"https://avatars.githubusercontent.com/u/69566909?v=4","gravatar_id":"","url":"https://api.github.com/users/yyy1000","html_url":"https://github.com/yyy1000","followers_url":"https://api.github.com/users/yyy1000/followers","following_url":"https://api.github.com/users/yyy1000/following{/other_user}","gists_url":"https://api.github.com/users/yyy1000/gists{/gist_id}","starred_url":"https://api.github.com/users/yyy1000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyy1000/subscriptions","organizations_url":"https://api.github.com/users/yyy1000/orgs","repos_url":"https://api.github.com/users/yyy1000/repos","events_url":"https://api.github.com/users/yyy1000/events{/privacy}","received_events_url":"https://api.github.com/users/yyy1000/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T14:24:01Z","updated_at":"2023-12-06T14:24:01Z","author_association":"CONTRIBUTOR","body":"> Please change for other spark version too like 3.2,3.3,3.4.\r\n\r\nSure, I just change a single version for review to verify I'm doing right. :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1842988192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843129829","html_url":"https://github.com/apache/iceberg/pull/9187#issuecomment-1843129829","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9187","id":1843129829,"node_id":"IC_kwDOCW7NX85t2-3l","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T15:36:38Z","updated_at":"2023-12-06T15:36:38Z","author_association":"MEMBER","body":"Thanks @ajantha-bhat for the PR and @Fokko for review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843129829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843199768","html_url":"https://github.com/apache/iceberg/issues/9089#issuecomment-1843199768","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9089","id":1843199768,"node_id":"IC_kwDOCW7NX85t3P8Y","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T16:02:21Z","updated_at":"2023-12-06T16:02:21Z","author_association":"CONTRIBUTOR","body":"Flink Writer operators write the data files to their final place - to the data directory of the table. Then sends the file metadata (file name, statistics, etc) to the Flink Committer operator.\r\nOn snapshot/checkpoint the Flink Committer does a 2 phase commit:\r\n- Phase 1 - snapshotState - creates a single temporary manifest file in the metadata directory, which stores the metadata for every files received in the given snapshot. Also stores the manifest file path (this is a bit simplified for clarity) in the job state.\r\n- Phase 2 - notifyCheckpointComplete - reads the temporary manifest file and creates an iceberg commit from it. The commit summary for this commit will contain:\r\n    - JobId\r\n    - OperatorId\r\n    - CheckpointId\r\n\r\nWhen the Flink job restarts, it reads the table commits, and finds the highest checkpointId for the jobId and operatorId in the history. Also it reads the state, to checks if we have data which is already snapshotted, but not yet committed to the table. If we have uncommitted data we commit it at this stage.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843199768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843230107","html_url":"https://github.com/apache/iceberg/pull/9224#issuecomment-1843230107","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9224","id":1843230107,"node_id":"IC_kwDOCW7NX85t3XWb","user":{"login":"yyy1000","id":69566909,"node_id":"MDQ6VXNlcjY5NTY2OTA5","avatar_url":"https://avatars.githubusercontent.com/u/69566909?v=4","gravatar_id":"","url":"https://api.github.com/users/yyy1000","html_url":"https://github.com/yyy1000","followers_url":"https://api.github.com/users/yyy1000/followers","following_url":"https://api.github.com/users/yyy1000/following{/other_user}","gists_url":"https://api.github.com/users/yyy1000/gists{/gist_id}","starred_url":"https://api.github.com/users/yyy1000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyy1000/subscriptions","organizations_url":"https://api.github.com/users/yyy1000/orgs","repos_url":"https://api.github.com/users/yyy1000/repos","events_url":"https://api.github.com/users/yyy1000/events{/privacy}","received_events_url":"https://api.github.com/users/yyy1000/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T16:20:22Z","updated_at":"2023-12-06T16:20:22Z","author_association":"CONTRIBUTOR","body":"Hi, @nk1506\r\nIt seems that my code can't pass the unit tests.\r\nIs it because of the default waiting time is not enough? Do you have any ideas?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843230107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843399469","html_url":"https://github.com/apache/iceberg/pull/8831#issuecomment-1843399469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8831","id":1843399469,"node_id":"IC_kwDOCW7NX85t4Ast","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T18:00:30Z","updated_at":"2023-12-06T18:00:30Z","author_association":"CONTRIBUTOR","body":"+1 when tests are passing. Thanks for making the refactor to move methods into the base class.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843399469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843709180","html_url":"https://github.com/apache/iceberg/pull/9236#issuecomment-1843709180","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9236","id":1843709180,"node_id":"IC_kwDOCW7NX85t5MT8","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-06T21:20:41Z","updated_at":"2023-12-06T21:20:41Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843709180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843918076","html_url":"https://github.com/apache/iceberg/issues/7568#issuecomment-1843918076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7568","id":1843918076,"node_id":"IC_kwDOCW7NX85t5_T8","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T00:11:42Z","updated_at":"2023-12-07T00:11:42Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843918076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":{"id":15368,"client_id":"Iv1.05c79e9ad1f6bdfa","slug":"github-actions","node_id":"MDM6QXBwMTUzNjg=","owner":{"login":"github","id":9919,"node_id":"MDEyOk9yZ2FuaXphdGlvbjk5MTk=","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github","html_url":"https://github.com/github","followers_url":"https://api.github.com/users/github/followers","following_url":"https://api.github.com/users/github/following{/other_user}","gists_url":"https://api.github.com/users/github/gists{/gist_id}","starred_url":"https://api.github.com/users/github/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github/subscriptions","organizations_url":"https://api.github.com/users/github/orgs","repos_url":"https://api.github.com/users/github/repos","events_url":"https://api.github.com/users/github/events{/privacy}","received_events_url":"https://api.github.com/users/github/received_events","type":"Organization","user_view_type":"public","site_admin":false},"name":"GitHub Actions","description":"Automate your workflow from idea to production","external_url":"https://help.github.com/en/actions","html_url":"https://github.com/apps/github-actions","created_at":"2018-07-30T09:30:17Z","updated_at":"2024-04-10T20:33:16Z","permissions":{"actions":"write","administration":"read","attestations":"write","checks":"write","contents":"write","deployments":"write","discussions":"write","issues":"write","merge_queues":"write","metadata":"read","packages":"write","pages":"write","pull_requests":"write","repository_hooks":"write","repository_projects":"write","security_events":"write","statuses":"write","vulnerability_alerts":"read"},"events":["branch_protection_rule","check_run","check_suite","create","delete","deployment","deployment_status","discussion","discussion_comment","fork","gollum","issues","issue_comment","label","merge_group","milestone","page_build","project","project_card","project_column","public","pull_request","pull_request_review","pull_request_review_comment","push","registry_package","release","repository","repository_dispatch","status","watch","workflow_dispatch","workflow_run"]}},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843990810","html_url":"https://github.com/apache/iceberg/pull/9194#issuecomment-1843990810","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9194","id":1843990810,"node_id":"IC_kwDOCW7NX85t6REa","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T01:32:12Z","updated_at":"2023-12-07T01:32:12Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @qqqttt123 @jerqi @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1843990810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1844516462","html_url":"https://github.com/apache/iceberg/pull/9238#issuecomment-1844516462","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9238","id":1844516462,"node_id":"IC_kwDOCW7NX85t8RZu","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T05:35:48Z","updated_at":"2023-12-07T05:35:48Z","author_association":"CONTRIBUTOR","body":"@rdblue @jackye1995 @amogh-jahagirdar what do you think?\r\n@nastra I added a note that the identifiers may not be combined with `VERSION AS OF` since you disallowed it in https://github.com/apache/iceberg/pull/9219/.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1844516462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1844833641","html_url":"https://github.com/apache/iceberg/pull/9224#issuecomment-1844833641","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9224","id":1844833641,"node_id":"IC_kwDOCW7NX85t9e1p","user":{"login":"nk1506","id":4146188,"node_id":"MDQ6VXNlcjQxNDYxODg=","avatar_url":"https://avatars.githubusercontent.com/u/4146188?v=4","gravatar_id":"","url":"https://api.github.com/users/nk1506","html_url":"https://github.com/nk1506","followers_url":"https://api.github.com/users/nk1506/followers","following_url":"https://api.github.com/users/nk1506/following{/other_user}","gists_url":"https://api.github.com/users/nk1506/gists{/gist_id}","starred_url":"https://api.github.com/users/nk1506/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nk1506/subscriptions","organizations_url":"https://api.github.com/users/nk1506/orgs","repos_url":"https://api.github.com/users/nk1506/repos","events_url":"https://api.github.com/users/nk1506/events{/privacy}","received_events_url":"https://api.github.com/users/nk1506/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T07:49:11Z","updated_at":"2023-12-07T07:49:11Z","author_association":"CONTRIBUTOR","body":"> Hi, @nk1506 It seems that my code can't pass the unit tests. Is it because of the default waiting time is not enough? Do you have any ideas?\r\n\r\nPlease refer [here](https://github.com/apache/iceberg/blob/6a9d3c77977baff4295ee2dde0150d73c8c46af1/aws/src/integration/java/org/apache/iceberg/aws/glue/TestGlueCatalogLock.java#L146) . Also it is advisable to set the `atMost` too. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1844833641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1844912767","html_url":"https://github.com/apache/iceberg/pull/9233#issuecomment-1844912767","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9233","id":1844912767,"node_id":"IC_kwDOCW7NX85t9yJ_","user":{"login":"tmnd1991","id":7031242,"node_id":"MDQ6VXNlcjcwMzEyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/7031242?v=4","gravatar_id":"","url":"https://api.github.com/users/tmnd1991","html_url":"https://github.com/tmnd1991","followers_url":"https://api.github.com/users/tmnd1991/followers","following_url":"https://api.github.com/users/tmnd1991/following{/other_user}","gists_url":"https://api.github.com/users/tmnd1991/gists{/gist_id}","starred_url":"https://api.github.com/users/tmnd1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmnd1991/subscriptions","organizations_url":"https://api.github.com/users/tmnd1991/orgs","repos_url":"https://api.github.com/users/tmnd1991/repos","events_url":"https://api.github.com/users/tmnd1991/events{/privacy}","received_events_url":"https://api.github.com/users/tmnd1991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T08:44:25Z","updated_at":"2023-12-07T08:44:25Z","author_association":"NONE","body":"Hi @ConeyLiu, this still needs some refinement (mostly wrt testing) but do you think the change make sense? I would avoid to work more on it if I'm way off ;) \r\nThanks 🙏","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1844912767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1844981085","html_url":"https://github.com/apache/iceberg/issues/9127#issuecomment-1844981085","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9127","id":1844981085,"node_id":"IC_kwDOCW7NX85t-C1d","user":{"login":"ronkorving","id":631240,"node_id":"MDQ6VXNlcjYzMTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/631240?v=4","gravatar_id":"","url":"https://api.github.com/users/ronkorving","html_url":"https://github.com/ronkorving","followers_url":"https://api.github.com/users/ronkorving/followers","following_url":"https://api.github.com/users/ronkorving/following{/other_user}","gists_url":"https://api.github.com/users/ronkorving/gists{/gist_id}","starred_url":"https://api.github.com/users/ronkorving/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ronkorving/subscriptions","organizations_url":"https://api.github.com/users/ronkorving/orgs","repos_url":"https://api.github.com/users/ronkorving/repos","events_url":"https://api.github.com/users/ronkorving/events{/privacy}","received_events_url":"https://api.github.com/users/ronkorving/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T09:22:53Z","updated_at":"2023-12-07T09:22:53Z","author_association":"NONE","body":"@Fokko Thanks for the engagement :)\r\nWould you agree that perhaps the readme is not the best place to the \"what we're currently working on\" information, and perhaps it's better to just remove that part of it?\r\nI would be happy to make a PR 👍 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1844981085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1845066093","html_url":"https://github.com/apache/iceberg/pull/9192#issuecomment-1845066093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9192","id":1845066093,"node_id":"IC_kwDOCW7NX85t-Xlt","user":{"login":"tmnd1991","id":7031242,"node_id":"MDQ6VXNlcjcwMzEyNDI=","avatar_url":"https://avatars.githubusercontent.com/u/7031242?v=4","gravatar_id":"","url":"https://api.github.com/users/tmnd1991","html_url":"https://github.com/tmnd1991","followers_url":"https://api.github.com/users/tmnd1991/followers","following_url":"https://api.github.com/users/tmnd1991/following{/other_user}","gists_url":"https://api.github.com/users/tmnd1991/gists{/gist_id}","starred_url":"https://api.github.com/users/tmnd1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmnd1991/subscriptions","organizations_url":"https://api.github.com/users/tmnd1991/orgs","repos_url":"https://api.github.com/users/tmnd1991/repos","events_url":"https://api.github.com/users/tmnd1991/events{/privacy}","received_events_url":"https://api.github.com/users/tmnd1991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T10:18:24Z","updated_at":"2023-12-07T10:18:24Z","author_association":"NONE","body":"Can I have a feedback on this one @ConeyLiu, too? Thanks a lot","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1845066093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1845096677","html_url":"https://github.com/apache/iceberg/pull/8909#issuecomment-1845096677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/8909","id":1845096677,"node_id":"IC_kwDOCW7NX85t-fDl","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T10:36:01Z","updated_at":"2023-12-07T10:36:01Z","author_association":"MEMBER","body":"@snazy, @nastra: \r\nIf this PR is ok. Can I get an approval? If not, what more changes are expected?  \r\n\r\nI thought of waiting for https://github.com/apache/iceberg/pull/8857/ and https://github.com/apache/iceberg/pull/9012 to rebase. But they can rebase too once this PR is merged. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1845096677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1845189563","html_url":"https://github.com/apache/iceberg/pull/9177#issuecomment-1845189563","issue_url":"https://api.github.com/repos/apache/iceberg/issues/9177","id":1845189563,"node_id":"IC_kwDOCW7NX85t-1u7","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T11:38:24Z","updated_at":"2023-12-07T11:38:24Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer would you mind take a look at this? Thanks in advance!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1845189563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]