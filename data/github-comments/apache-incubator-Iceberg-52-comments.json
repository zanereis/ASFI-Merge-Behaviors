[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701595370","html_url":"https://github.com/apache/iceberg/pull/1522#issuecomment-701595370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1522","id":701595370,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTU5NTM3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T19:25:51Z","updated_at":"2020-09-30T19:25:51Z","author_association":"CONTRIBUTOR","body":"> Would the values produced by the ParquetReader iterable ever be returned directly to Spark?\r\n\r\nYes, we return an iterator with the reused containers. I believe that this is okay because Spark generally converts to unsafe immediately. What code paths can't handle reused containers?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701595370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701601287","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-701601287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":701601287,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTYwMTI4Nw==","user":{"login":"edwinchoi","id":773193,"node_id":"MDQ6VXNlcjc3MzE5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/773193?v=4","gravatar_id":"","url":"https://api.github.com/users/edwinchoi","html_url":"https://github.com/edwinchoi","followers_url":"https://api.github.com/users/edwinchoi/followers","following_url":"https://api.github.com/users/edwinchoi/following{/other_user}","gists_url":"https://api.github.com/users/edwinchoi/gists{/gist_id}","starred_url":"https://api.github.com/users/edwinchoi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edwinchoi/subscriptions","organizations_url":"https://api.github.com/users/edwinchoi/orgs","repos_url":"https://api.github.com/users/edwinchoi/repos","events_url":"https://api.github.com/users/edwinchoi/events{/privacy}","received_events_url":"https://api.github.com/users/edwinchoi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T19:37:11Z","updated_at":"2020-09-30T19:37:11Z","author_association":"NONE","body":"@rdblue, how would a snapshot be recorded in the metadata if it weren't at some point current? Intermediate snapshots are removed on commit, so I would imagine the only case where the metadata could refer to snapshots that were never current is if the commit were rejected. In that case, the snapshots wouldn't be reachable from the current commit. What am I missing?\r\n\r\nExample:\r\n```sql\r\n-- S1\r\nCREATE TABLE test.ns.tbl USING iceberg AS\r\nSELECT * FROM VALUES (1, \"Alice\"), (2, \"Bob\") AS (id, fname);\r\n\r\n-- S2\r\nCREATE OR REPLACE TABLE test.ns.tbl USING iceberg AS\r\nSELECT * FROM VALUES (1, 5, \"alice\"), (2, 3, \"bob\") AS (id, name_len, name) ;\r\n\r\n-- S3\r\nINSERT INTO test.ns.tbl VALUES (3, 5, \"carol\")\r\n```\r\n\r\nThe table `test.ns.tbl` has 3 valid states. So we should be able to read each one individually. `Table.history()`, after all 3 statements have executed, only returns entries for `S2` and `S3`; while `Table.snapshots()` returns all 3.\r\n\r\nYou can rewind to `S1`, so it seems time-travel is using snapshots not the log. Trying to read the data will fail since it tries to cast the 2nd field to an integer, but it will succeed if you rewrite the snippet to use `(id, name, name_len)`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701601287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701603547","html_url":"https://github.com/apache/iceberg/pull/1490#issuecomment-701603547","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1490","id":701603547,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTYwMzU0Nw==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T19:41:41Z","updated_at":"2020-09-30T19:41:41Z","author_association":"CONTRIBUTOR","body":"This is ready for another round of reviews.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701603547/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701603785","html_url":"https://github.com/apache/iceberg/pull/1473#issuecomment-701603785","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1473","id":701603785,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTYwMzc4NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T19:42:07Z","updated_at":"2020-09-30T19:42:07Z","author_association":"CONTRIBUTOR","body":"cc @holdenk ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701603785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701627572","html_url":"https://github.com/apache/iceberg/pull/1532#issuecomment-701627572","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1532","id":701627572,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTYyNzU3Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T20:29:58Z","updated_at":"2020-09-30T20:29:58Z","author_association":"CONTRIBUTOR","body":"Looks good to me. Would be nice to rename that method to fit the convention used elsewhere.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701627572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701630104","html_url":"https://github.com/apache/iceberg/pull/1536#issuecomment-701630104","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1536","id":701630104,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTYzMDEwNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T20:34:57Z","updated_at":"2020-09-30T20:34:57Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701630104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701630439","html_url":"https://github.com/apache/iceberg/pull/1536#issuecomment-701630439","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1536","id":701630439,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTYzMDQzOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T20:35:35Z","updated_at":"2020-09-30T20:35:35Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this, @shardulm94!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701630439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701669016","html_url":"https://github.com/apache/iceberg/issues/658#issuecomment-701669016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/658","id":701669016,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTY2OTAxNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T21:58:31Z","updated_at":"2020-09-30T21:58:31Z","author_association":"CONTRIBUTOR","body":"I'll submit a PR for this.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701669016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701689849","html_url":"https://github.com/apache/iceberg/pull/1529#issuecomment-701689849","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1529","id":701689849,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTY4OTg0OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T22:58:27Z","updated_at":"2020-09-30T22:58:27Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701689849/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701692185","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-701692185","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":701692185,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTY5MjE4NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T23:05:36Z","updated_at":"2020-09-30T23:05:36Z","author_association":"CONTRIBUTOR","body":"There are a few cases where a snapshot might not have been the current state:\r\n1. For the write-audit-publish (WAP) pattern, there is an option to only stage a commit and not update the table's current-snapshot-id. In this case, the writer updates the table by creating a new snapshot. Then an auditor reads the snapshot and validates it (with row counts, for example), and if the snapshot looks good, commits the snapshot as the current table state. This allows reports to be validated before going live.\r\n2. Single-table transactions will create individual snapshots, but the table state goes directly to the latest snapshot when the transaction commits.\r\n\r\nAlso, the table state can be rolled back to a previous snapshot and new commits will form a new history afterwards.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701692185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701695790","html_url":"https://github.com/apache/iceberg/pull/1478#issuecomment-701695790","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1478","id":701695790,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTY5NTc5MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T23:17:24Z","updated_at":"2020-09-30T23:18:04Z","author_association":"CONTRIBUTOR","body":"Looks like there are some tests failures:\r\n```\r\norg.apache.iceberg.mr.hive.TestHiveIcebergStorageHandlerWithHadoopCatalog > testScanTable FAILED\r\n    java.lang.RuntimeException: Cannot start TestHiveMetastore\r\n        Caused by:\r\n        java.lang.RuntimeException: MetaException(message:Persistence Manager has been closed)\r\n            Caused by:\r\n            MetaException(message:Persistence Manager has been closed)\r\n                Caused by:\r\n                MetaException(message:Persistence Manager has been closed)\r\n                    Caused by:\r\n                    javax.jdo.JDOFatalUserException: Persistence Manager has been closed\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701695790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701696521","html_url":"https://github.com/apache/iceberg/pull/1478#issuecomment-701696521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1478","id":701696521,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTY5NjUyMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T23:19:33Z","updated_at":"2020-09-30T23:19:33Z","author_association":"CONTRIBUTOR","body":"+1, we just need to get the tests working.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701696521/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701718100","html_url":"https://github.com/apache/iceberg/pull/1532#issuecomment-701718100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1532","id":701718100,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTcxODEwMA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T00:35:37Z","updated_at":"2020-10-01T01:29:49Z","author_association":"COLLABORATOR","body":"@rdblue , The `HadoopFileIO` contains `SerailiableSupplier<Configuration>`, so it should be serialized by `SerializationUtil` and then `Writable`, therefore satisfy the serialization requirement for MR framework. Does that make sense to you?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701718100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701725686","html_url":"https://github.com/apache/iceberg/pull/1499#issuecomment-701725686","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1499","id":701725686,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTcyNTY4Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T01:00:46Z","updated_at":"2020-10-01T01:03:10Z","author_association":"CONTRIBUTOR","body":"@electrum, it sounds like there are two parts to your concerns that I'll address. First, what is the use of restricting the scope of equality deletes? And second, why not use predicates for global deletes instead of equality files?\r\n\r\n> What doesn't make sense is recording the file name. . . . I actually can't think of any reason why we'd want to restrict it to a specific file.\r\n\r\nEquality deletes aren't restricted to a specific file. The position deletes remove a particular row in a data file, but equality deletes are like predicates applied to entire partitions.\r\n\r\nThere's good reason to be able to scope an equality delete to a partition. If we accumulated all of the equality deletes globally, then every data file could potentially have a huge number of deletes to apply. For example, consider a CDC stream that is being written to a table that changes rows through `UPSERT` operations by some row ID. If the table is also bucketed by that row ID, then we can easily reduce the number of deletes than need to be applied to the average data file by a couple orders of magnitude by restricting the scope of a delete to just one partition. This allows us to accumulate and efficiently handle more changes as deletes before it is necessary to compact.\r\n\r\nIn addition, because deletes are scoped by sequence number, we won't always be able to compact equality delete files together. If all of the deletes were at the table level, then there would necessarily be a lot more delete files to open per data file, even in a maintained table. That puts pressure on compacting deletes into data files, even if there are only a small number of deleted rows (could be one per file). Again, scoping by partition helps us avoid this causing problems.\r\n\r\n> Basic range filters would cover common use cases, such as \"delete all data older than X\".\r\n\r\nI think this suggestion was mainly motivated by the idea that all equality deletes could be globally scoped, but I think it's a good suggestion for global deletes. It would be really nice to be able to encode deletes like this for certain use cases. And global equality deletes are already a special case. Maybe we should make a way to encode expressions.\r\n\r\nMy main concerns with this are around overhead. If global deletes are equality deletes, then we can do some amount of work to determine which partitions match and re-encode the delete against those partitions. For example, in the `id = 5` case, even if the table is partitioned by time instead of id, I can go find the hours where the id was active based on lower/upper bounds in data files. That would work for lots of tables, where the record ids are correlated with time. But wouldn't be able to rewrite to more targeted deletes if any other expression were used.\r\n\r\nWe could store expressions instead of equality deletes everywhere to be able to do the rewrite, but that quickly turns into something horrible to apply at read time. A nice thing about equality deletes is that there is a small set of possible schemas (subsets of table columns) and delete files can be combined by unioning filter sets (or merging if rows are ordered).\r\n\r\nI think for now I'd opt not to add global delete filters, but if you think it is a good idea I'd be happy to discuss it more.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701725686/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701734612","html_url":"https://github.com/apache/iceberg/pull/1535#issuecomment-701734612","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1535","id":701734612,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTczNDYxMg==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T01:30:15Z","updated_at":"2020-10-01T01:30:15Z","author_association":"CONTRIBUTOR","body":"LG!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701734612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701735672","html_url":"https://github.com/apache/iceberg/pull/1525#issuecomment-701735672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1525","id":701735672,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTczNTY3Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T01:33:53Z","updated_at":"2020-10-01T01:33:53Z","author_association":"CONTRIBUTOR","body":"Let me take a look tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701735672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701743469","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-701743469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":701743469,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTc0MzQ2OQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T02:01:03Z","updated_at":"2020-10-01T02:01:03Z","author_association":"CONTRIBUTOR","body":"I have 2 concerns with this PR:\r\n\r\n1. I think we should in addition propose dynamically loading the `LocationProvider` implementation, instead of using a boolean to switch on or off each implementation. This will allow any user to easily plugin a custom implementation. I wonder if such proposal is enough to both satisfy your need and also keep the community version general.\r\n\r\n2. for this specific implementation, the approach of using table property to get `localizedDataLocationLookUp` map feels not scalable to me if we want to make it a useful generic implementation. For example, customers might want to have 1 HDFS cluster per [AWS local zone](https://aws.amazon.com/about-aws/global-infrastructure/localzones/) to read and write data due to latency requirement, and this setup easily generate hundreds to thousands of table properties. I don't know if there is any bad impact for such use case, since table properties is not designed to hold a lot of data.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701743469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701769054","html_url":"https://github.com/apache/iceberg/issues/1468#issuecomment-701769054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1468","id":701769054,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTc2OTA1NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T02:35:10Z","updated_at":"2020-10-01T02:35:10Z","author_association":"CONTRIBUTOR","body":"Hi @jacques-n this is Jack from AWS. We are planning to introduce a new `iceberg-aws` module, and we do have plan to offer a Glue + DynamoDB implementation for `Catalog` and `TableOperations`. Since you say you already have something working, let's have a sync after you have a PR and see what is the best way to have this shipped all together ðŸ˜ƒ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701769054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701788175","html_url":"https://github.com/apache/iceberg/pull/1539#issuecomment-701788175","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1539","id":701788175,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTc4ODE3NQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T02:49:05Z","updated_at":"2020-10-01T02:49:55Z","author_association":"CONTRIBUTOR","body":"In some of the tests, one of the parameters is a String[] instead of a String. Because the current JUnit set up casts the names based on index by calling `.toString()` on them, we wind up with some bad names in these edge cases. Example:\r\n\r\n```md\r\ntestReplacePartitions[catalogName=testhadoop, baseNamespace=[Ljava.lang.String;36c1c7d9], format=PARQUET, isStreaming=false]\r\n```\r\n\r\nWe can fix this in a few ways. One, there is another library that offers us the ability to have more control over parameters: https://github.com/Pragmatists/JUnitParams\r\n\r\nHowever, I'm not so sure about that. Additionally, while baseNamespace is not _exactly_ a namespace, it is in a way. And there is a class `Namespace` with a meaningful `toString` method. We can either create an additional `BaseNamespace` class or simply delegate to `Namespace` and accept that a `BaseNamespace` and a `Namespace` are essentially just references to the different possible lengths of a namespace.\r\n\r\nWhat do others think @rdblue? `baseNamespace` as shown above is the only example I have found. And `Namespace` already has a helper function in the Flink test code:\r\n\r\n```java\r\n  private Namespace toNamespace(String database) {\r\n    String[] namespace = new String[baseNamespace.length + 1];\r\n    System.arraycopy(baseNamespace, 0, namespace, 0, baseNamespace.length);\r\n    namespace[baseNamespace.length] = database;\r\n    return Namespace.of(namespace);\r\n  }\r\n```  \r\n\r\nI can also create a separate issue for the ones that generate wonky names and we can deal with them / debate the meaning of `Namespace` in another PR since this one is already huge (and intended to be a simple swap one for one).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701788175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701875823","html_url":"https://github.com/apache/iceberg/pull/1532#issuecomment-701875823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1532","id":701875823,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTg3NTgyMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T04:25:50Z","updated_at":"2020-10-01T04:25:50Z","author_association":"CONTRIBUTOR","body":"> The HadoopFileIO contains SerailiableSupplier<Configuration>, so it should be serialized by SerializationUtil and then Writable, therefore satisfy the serialization requirement for MR framework.\r\n\r\nWhere is the `HadoopFileIO` being rebuilt with `SerializableSupplier<Configuration>`? In Spark, we have to check the `FileIO` and replace it with the one that references the `SerializableSupplier`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701875823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701876419","html_url":"https://github.com/apache/iceberg/pull/1539#issuecomment-701876419","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1539","id":701876419,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTg3NjQxOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T04:27:51Z","updated_at":"2020-10-01T04:27:51Z","author_association":"CONTRIBUTOR","body":"I'd say let's reuse `Namespace`. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701876419/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701877425","html_url":"https://github.com/apache/iceberg/pull/1539#issuecomment-701877425","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1539","id":701877425,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTg3NzQyNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T04:31:36Z","updated_at":"2020-10-01T04:31:36Z","author_association":"CONTRIBUTOR","body":"Mostly looks good! Just a couple questions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701877425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701885476","html_url":"https://github.com/apache/iceberg/pull/1532#issuecomment-701885476","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1532","id":701885476,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTg4NTQ3Ng==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T05:01:40Z","updated_at":"2020-10-01T05:01:40Z","author_association":"COLLABORATOR","body":"@rdblue , Just added this. I missed that the configuration used to build `SerialableSupplier<Configuration>` also need to be serializable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701885476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701887911","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-701887911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":701887911,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTg4NzkxMQ==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T05:08:42Z","updated_at":"2020-10-01T05:08:42Z","author_association":"CONTRIBUTOR","body":"hi @jackye1995 thanks for the feedback here! This is aligned with the discussion we had during the sync for solution that folks can easily customizable their locations. I've re-purposed this PR to address this. If this is in, we can easily implement our data localization here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701887911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701892705","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-701892705","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":701892705,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTg5MjcwNQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T05:22:18Z","updated_at":"2020-10-01T05:22:18Z","author_association":"CONTRIBUTOR","body":"Thank you! I created an issue for this, can you link it to this PR? #1538 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701892705/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701894239","html_url":"https://github.com/apache/iceberg/issues/1538#issuecomment-701894239","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1538","id":701894239,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTg5NDIzOQ==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T05:26:34Z","updated_at":"2020-10-01T05:27:33Z","author_association":"CONTRIBUTOR","body":"This PR https://github.com/apache/iceberg/pull/1531 was re-purposed from solving specific problem of data localization to address this more general use case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701894239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701901546","html_url":"https://github.com/apache/iceberg/issues/1540#issuecomment-701901546","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1540","id":701901546,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTkwMTU0Ng==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T05:47:35Z","updated_at":"2020-10-01T05:47:35Z","author_association":"CONTRIBUTOR","body":"If this is implemented, the parameter group for `vectorized` should be updated to include `true` here: https://github.com/apache/iceberg/blob/44c1d00b37f0d7fc2e978baad4f7a861a8335cf0/spark/src/test/java/org/apache/iceberg/spark/data/TestSparkParquetReadMetadataColumns.java#L109","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701901546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701902606","html_url":"https://github.com/apache/iceberg/pull/1539#issuecomment-701902606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1539","id":701902606,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTkwMjYwNg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T05:50:21Z","updated_at":"2020-10-01T05:50:21Z","author_association":"CONTRIBUTOR","body":"I was wondering why the tags didn't get updated for this, but I think it's because I initially opened this as a draft. I've noticed on push in other people's PRs that they _eventually_ populate (like when we added `flink_runtime` to the labeler config and later on the `flink` tag appeared in the PR).\r\n\r\nI'll look into this issue and if the tests are somehow not triggering labels appropriately, I'll make a change. But I don't think that's the case here as I have also edited some `flink` files that are not underneath any `test` directory.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701902606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701907253","html_url":"https://github.com/apache/iceberg/pull/1539#issuecomment-701907253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1539","id":701907253,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTkwNzI1Mw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T06:02:59Z","updated_at":"2020-10-01T06:02:59Z","author_association":"CONTRIBUTOR","body":"> I'd say let's reuse `Namespace`. Thanks!\r\n\r\nI agree. I've created an issue to follow up on that as it will ever so slightly require us to change the code in `src` and given the size of this PR, I wanted to keep the changes limited to things underneath `test`. I will follow up. ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701907253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701908441","html_url":"https://github.com/apache/iceberg/issues/1541#issuecomment-701908441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1541","id":701908441,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTkwODQ0MQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T06:06:08Z","updated_at":"2020-10-01T06:06:08Z","author_association":"CONTRIBUTOR","body":"Currently, the test output for the parameterized name looks like the following when the tests are run (for reference)\r\n```\r\ntestReplacePartitions[catalogName=testhadoop, baseNamespace=[Ljava.lang.String;36c1c7d9], format=PARQUET, isStreaming=false]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/701908441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702190687","html_url":"https://github.com/apache/iceberg/pull/1529#issuecomment-702190687","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1529","id":702190687,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjE5MDY4Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T14:52:57Z","updated_at":"2020-10-01T14:52:57Z","author_association":"MEMBER","body":"Thanks for taking care of this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702190687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702191761","html_url":"https://github.com/apache/iceberg/pull/1478#issuecomment-702191761","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1478","id":702191761,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjE5MTc2MQ==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T14:54:33Z","updated_at":"2020-10-01T14:54:33Z","author_association":"COLLABORATOR","body":"Thanks. I'm looking into the flaky test, it still occurs intermittently.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702191761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702198282","html_url":"https://github.com/apache/iceberg/issues/1533#issuecomment-702198282","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1533","id":702198282,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjE5ODI4Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T15:03:55Z","updated_at":"2020-10-01T15:03:55Z","author_association":"MEMBER","body":"I believe this is caused by an incompatibility between the hive client\nbeing used and the hive metastore being used. The Inner error is\n\nCaused by: InvalidObjectException(message:db)\nat\norg.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result$create_table_with_environment_context_resultStandardScheme.read(ThriftHiveMetastore.java:42216)\n\nWhich should be thrown when the thrift api makes a call and is unable to\nwork with the results. My guess would be that the hive client being\nincluded at runtime within Spark is not compatible with the metastore you\nare running. I know there are several incompatibilities between certain\nmetastore versions and certain versions of spark. I couldn't find any\ntickets for a 2.7x metastore in the Spark jira but I did see support for\n2.3, 2.4 and 3.0 and 3.1. So it may be related to that? What version of the\nmetastore are you using?\n\nOn Wed, Sep 30, 2020 at 9:17 AM Vijay Akkineni <notifications@github.com>\nwrote:\n\n> Hi,\n>\n> I am new to iceberg and trying to follow get started section. But running into an error while creating a table using iceberg.  Below is my environment setup. Any help is appreciated.\n>\n> Hive - 2.7.3 using Postgres as metastore.\n> Spark - 3.0.1 with hadoop 2.7.4 with S3A\n> spark.sql.warehouse.dir ('s3a://testbucket')\n>\n> ./spark-sql\n> --conf\n> spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog\n>\n> --conf spark.sql.catalog.spark_catalog.type=hive\n> --conf spark.sql.catalog.local=org.apache.iceberg.spark.SparkCatalog\n> --conf spark.sql.catalog.local.type=hive\n> --conf spark.sql.catalog.local.uri=thrift://192.168.86.240:9083\n>\n> SQL command: CREATE TABLE local.db.sample (id bigint COMMENT 'unique id',\n> data string, category string) USING iceberg PARTITIONED BY (category);\n>\n> I do see a directory getting created in s3 bucket\n> testbucket/db.db/sample/metadata, but fails with the below error.\n>\n> The exception while creating table is\n> 20/09/30 10:01:00 ERROR SparkSQLDriver: Failed in [CREATE TABLE\n> local.db.sample (id bigint COMMENT 'unique id', data string,category\n> string) USING iceberg PARTITIONED BY (category)]\n> java.lang.RuntimeException: Metastore operation failed for db.sample\n> at\n> org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:200)\n> at\n> org.apache.iceberg.BaseMetastoreTableOperations.commit(BaseMetastoreTableOperations.java:103)\n> at\n> org.apache.iceberg.BaseMetastoreCatalog.createTable(BaseMetastoreCatalog.java:71)\n> at\n> org.apache.iceberg.CachingCatalog.lambda$createTable$0(CachingCatalog.java:75)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.lambda$doComputeIfAbsent$14(BoundedLocalCache.java:2337)\n> at\n> java.base/java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1908)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.doComputeIfAbsent(BoundedLocalCache.java:2335)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.computeIfAbsent(BoundedLocalCache.java:2318)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalCache.computeIfAbsent(LocalCache.java:111)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalManualCache.get(LocalManualCache.java:54)\n> at org.apache.iceberg.CachingCatalog.createTable(CachingCatalog.java:73)\n> at org.apache.iceberg.spark.SparkCatalog.createTable(SparkCatalog.java:136)\n> at org.apache.iceberg.spark.SparkCatalog.createTable(SparkCatalog.java:78)\n> at\n> org.apache.spark.sql.execution.datasources.v2.CreateTableExec.run(CreateTableExec.scala:41)\n> at\n> org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:39)\n> at\n> org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:39)\n> at\n> org.apache.spark.sql.execution.datasources.v2.V2CommandExec.executeCollect(V2CommandExec.scala:45)\n> at org.apache.spark.sql.Dataset.$anonfun$logicalPlan$1(Dataset.scala:229)\n> at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3618)\n> at\n> org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:100)\n> at\n> org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:160)\n> at\n> org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:87)\n> at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\n> at\n> org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\n> at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3616)\n> at org.apache.spark.sql.Dataset.(Dataset.scala:229)\n> at org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:100)\n> at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\n> at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:97)\n> at org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:607)\n> at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\n> at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:602)\n> at org.apache.spark.sql.SQLContext.sql(SQLContext.scala:650)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLDriver.run(SparkSQLDriver.scala:63)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processCmd(SparkSQLCLIDriver.scala:377)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1(SparkSQLCLIDriver.scala:496)\n> at scala.collection.Iterator.foreach(Iterator.scala:941)\n> at scala.collection.Iterator.foreach$(Iterator.scala:941)\n> at scala.collection.AbstractIterator.foreach(Iterator.scala:1429)\n> at scala.collection.IterableLike.foreach(IterableLike.scala:74)\n> at scala.collection.IterableLike.foreach$(IterableLike.scala:73)\n> at scala.collection.AbstractIterable.foreach(Iterable.scala:56)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processLine(SparkSQLCLIDriver.scala:490)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver$.main(SparkSQLCLIDriver.scala:282)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.main(SparkSQLCLIDriver.scala)\n> at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native\n> Method)\n> at\n> java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n> at\n> java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n> at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n> at\n> org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\n> at org.apache.spark.deploy.SparkSubmit.org\n> $apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:928)\n> at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)\n> at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)\n> at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)\n> at\n> org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)\n> at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)\n> at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\n> Caused by: InvalidObjectException(message:db)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result$create_table_with_environment_context_resultStandardScheme.read(ThriftHiveMetastore.java:42216)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result$create_table_with_environment_context_resultStandardScheme.read(ThriftHiveMetastore.java:42193)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result.read(ThriftHiveMetastore.java:42119)\n> at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:88)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_create_table_with_environment_context(ThriftHiveMetastore.java:1203)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.create_table_with_environment_context(ThriftHiveMetastore.java:1189)\n> at\n> org.apache.hadoop.hive.metastore.HiveMetaStoreClient.create_table_with_environment_context(HiveMetaStoreClient.java:2405)\n> at\n> org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:752)\n> at\n> org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:740)\n> at\n> org.apache.iceberg.hive.HiveTableOperations.lambda$doCommit$3(HiveTableOperations.java:185)\n> at org.apache.iceberg.hive.ClientPool.run(ClientPool.java:54)\n> at\n> org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:184)\n> ... 56 more\n> java.lang.RuntimeException: Metastore operation failed for db.sample\n> at\n> org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:200)\n> at\n> org.apache.iceberg.BaseMetastoreTableOperations.commit(BaseMetastoreTableOperations.java:103)\n> at\n> org.apache.iceberg.BaseMetastoreCatalog.createTable(BaseMetastoreCatalog.java:71)\n> at\n> org.apache.iceberg.CachingCatalog.lambda$createTable$0(CachingCatalog.java:75)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.lambda$doComputeIfAbsent$14(BoundedLocalCache.java:2337)\n> at\n> java.base/java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1908)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.doComputeIfAbsent(BoundedLocalCache.java:2335)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.computeIfAbsent(BoundedLocalCache.java:2318)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalCache.computeIfAbsent(LocalCache.java:111)\n> at\n> org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalManualCache.get(LocalManualCache.java:54)\n> at org.apache.iceberg.CachingCatalog.createTable(CachingCatalog.java:73)\n> at org.apache.iceberg.spark.SparkCatalog.createTable(SparkCatalog.java:136)\n> at org.apache.iceberg.spark.SparkCatalog.createTable(SparkCatalog.java:78)\n> at\n> org.apache.spark.sql.execution.datasources.v2.CreateTableExec.run(CreateTableExec.scala:41)\n> at\n> org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:39)\n> at\n> org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:39)\n> at\n> org.apache.spark.sql.execution.datasources.v2.V2CommandExec.executeCollect(V2CommandExec.scala:45)\n> at org.apache.spark.sql.Dataset.$anonfun$logicalPlan$1(Dataset.scala:229)\n> at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3618)\n> at\n> org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:100)\n> at\n> org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:160)\n> at\n> org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:87)\n> at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\n> at\n> org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\n> at org.apache.spark.sql.Dataset.withAction(Dataset.scala:3616)\n> at org.apache.spark.sql.Dataset.(Dataset.scala:229)\n> at org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:100)\n> at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\n> at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:97)\n> at org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:607)\n> at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\n> at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:602)\n> at org.apache.spark.sql.SQLContext.sql(SQLContext.scala:650)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLDriver.run(SparkSQLDriver.scala:63)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processCmd(SparkSQLCLIDriver.scala:377)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1(SparkSQLCLIDriver.scala:496)\n> at scala.collection.Iterator.foreach(Iterator.scala:941)\n> at scala.collection.Iterator.foreach$(Iterator.scala:941)\n> at scala.collection.AbstractIterator.foreach(Iterator.scala:1429)\n> at scala.collection.IterableLike.foreach(IterableLike.scala:74)\n> at scala.collection.IterableLike.foreach$(IterableLike.scala:73)\n> at scala.collection.AbstractIterable.foreach(Iterable.scala:56)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processLine(SparkSQLCLIDriver.scala:490)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver$.main(SparkSQLCLIDriver.scala:282)\n> at\n> org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.main(SparkSQLCLIDriver.scala)\n> at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native\n> Method)\n> at\n> java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n> at\n> java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n> at java.base/java.lang.reflect.Method.invoke(Method.java:566)\n> at\n> org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\n> at org.apache.spark.deploy.SparkSubmit.org\n> $apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:928)\n> at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)\n> at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)\n> at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)\n> at\n> org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1007)\n> at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1016)\n> at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\n> Caused by: InvalidObjectException(message:db)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result$create_table_with_environment_context_resultStandardScheme.read(ThriftHiveMetastore.java:42216)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result$create_table_with_environment_context_resultStandardScheme.read(ThriftHiveMetastore.java:42193)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$create_table_with_environment_context_result.read(ThriftHiveMetastore.java:42119)\n> at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:88)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.recv_create_table_with_environment_context(ThriftHiveMetastore.java:1203)\n> at\n> org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Client.create_table_with_environment_context(ThriftHiveMetastore.java:1189)\n> at\n> org.apache.hadoop.hive.metastore.HiveMetaStoreClient.create_table_with_environment_context(HiveMetaStoreClient.java:2405)\n> at\n> org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:752)\n> at\n> org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:740)\n> at\n> org.apache.iceberg.hive.HiveTableOperations.lambda$doCommit$3(HiveTableOperations.java:185)\n> at org.apache.iceberg.hive.ClientPool.run(ClientPool.java:54)\n> at\n> org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:184)\n> ... 56 more\n>\n> â€”\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/1533>, or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YNS4FE3KGUV5RSUN6DSIM4Y7ANCNFSM4R7E322A>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702198282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702204465","html_url":"https://github.com/apache/iceberg/issues/1533#issuecomment-702204465","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1533","id":702204465,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjIwNDQ2NQ==","user":{"login":"akkinenivijay","id":334752,"node_id":"MDQ6VXNlcjMzNDc1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/334752?v=4","gravatar_id":"","url":"https://api.github.com/users/akkinenivijay","html_url":"https://github.com/akkinenivijay","followers_url":"https://api.github.com/users/akkinenivijay/followers","following_url":"https://api.github.com/users/akkinenivijay/following{/other_user}","gists_url":"https://api.github.com/users/akkinenivijay/gists{/gist_id}","starred_url":"https://api.github.com/users/akkinenivijay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akkinenivijay/subscriptions","organizations_url":"https://api.github.com/users/akkinenivijay/orgs","repos_url":"https://api.github.com/users/akkinenivijay/repos","events_url":"https://api.github.com/users/akkinenivijay/events{/privacy}","received_events_url":"https://api.github.com/users/akkinenivijay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T15:12:56Z","updated_at":"2020-10-01T15:12:56Z","author_association":"NONE","body":"Hive metastore version is 2.3.7 and i am using spark 3.0.1 with hadoop 2.7. Spark has the same version of hive metastore jars 2.3.7. One difference i noticed is hive by default comes with libthrift 0.9.3 and spark has 0.12.0. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702204465/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702208672","html_url":"https://github.com/apache/iceberg/issues/1533#issuecomment-702208672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1533","id":702208672,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjIwODY3Mg==","user":{"login":"akkinenivijay","id":334752,"node_id":"MDQ6VXNlcjMzNDc1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/334752?v=4","gravatar_id":"","url":"https://api.github.com/users/akkinenivijay","html_url":"https://github.com/akkinenivijay","followers_url":"https://api.github.com/users/akkinenivijay/followers","following_url":"https://api.github.com/users/akkinenivijay/following{/other_user}","gists_url":"https://api.github.com/users/akkinenivijay/gists{/gist_id}","starred_url":"https://api.github.com/users/akkinenivijay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akkinenivijay/subscriptions","organizations_url":"https://api.github.com/users/akkinenivijay/orgs","repos_url":"https://api.github.com/users/akkinenivijay/repos","events_url":"https://api.github.com/users/akkinenivijay/events{/privacy}","received_events_url":"https://api.github.com/users/akkinenivijay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T15:19:16Z","updated_at":"2020-10-01T15:19:16Z","author_association":"NONE","body":"I am sorry i just noticed that i had a hive version typo in the original question, its actually 2.3.7","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702208672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702224483","html_url":"https://github.com/apache/iceberg/issues/1533#issuecomment-702224483","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1533","id":702224483,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjIyNDQ4Mw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T15:43:57Z","updated_at":"2020-10-01T15:43:57Z","author_association":"MEMBER","body":"Could you try making a normal Hive table with Spark SQL? See if there is a\nsimilar error and we can eliminate Iceberg from being a part of  the\nproblem?\n\nOn Thu, Oct 1, 2020 at 10:19 AM Vijay Akkineni <notifications@github.com>\nwrote:\n\n> I am sorry i just noticed that i had a hive version typo in the original\n> question, its actually 2.3.7\n>\n> â€”\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/1533#issuecomment-702208672>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YNFH43JKQGODNWH5FTSISMYLANCNFSM4R7E322A>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702224483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702252476","html_url":"https://github.com/apache/iceberg/issues/1533#issuecomment-702252476","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1533","id":702252476,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI1MjQ3Ng==","user":{"login":"akkinenivijay","id":334752,"node_id":"MDQ6VXNlcjMzNDc1Mg==","avatar_url":"https://avatars.githubusercontent.com/u/334752?v=4","gravatar_id":"","url":"https://api.github.com/users/akkinenivijay","html_url":"https://github.com/akkinenivijay","followers_url":"https://api.github.com/users/akkinenivijay/followers","following_url":"https://api.github.com/users/akkinenivijay/following{/other_user}","gists_url":"https://api.github.com/users/akkinenivijay/gists{/gist_id}","starred_url":"https://api.github.com/users/akkinenivijay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akkinenivijay/subscriptions","organizations_url":"https://api.github.com/users/akkinenivijay/orgs","repos_url":"https://api.github.com/users/akkinenivijay/repos","events_url":"https://api.github.com/users/akkinenivijay/events{/privacy}","received_events_url":"https://api.github.com/users/akkinenivijay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T16:29:16Z","updated_at":"2020-10-01T16:29:16Z","author_association":"NONE","body":"Yes i am able to create normal hive tables with spark sql.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702252476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702271168","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-702271168","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":702271168,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI3MTE2OA==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:02:40Z","updated_at":"2020-10-01T17:02:40Z","author_association":"CONTRIBUTOR","body":"cc @stripe/iceberg-reviewers, I iterated on this based on feedback to have pluggable impl for location provider instead","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702271168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702272183","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-702272183","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":702272183,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI3MjE4Mw==","user":{"login":"edwinchoi","id":773193,"node_id":"MDQ6VXNlcjc3MzE5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/773193?v=4","gravatar_id":"","url":"https://api.github.com/users/edwinchoi","html_url":"https://github.com/edwinchoi","followers_url":"https://api.github.com/users/edwinchoi/followers","following_url":"https://api.github.com/users/edwinchoi/following{/other_user}","gists_url":"https://api.github.com/users/edwinchoi/gists{/gist_id}","starred_url":"https://api.github.com/users/edwinchoi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edwinchoi/subscriptions","organizations_url":"https://api.github.com/users/edwinchoi/orgs","repos_url":"https://api.github.com/users/edwinchoi/repos","events_url":"https://api.github.com/users/edwinchoi/events{/privacy}","received_events_url":"https://api.github.com/users/edwinchoi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:04:29Z","updated_at":"2020-10-01T17:04:29Z","author_association":"NONE","body":"Thanks for elaborating. My thoughts...\r\n\r\n> For the write-audit-publish (WAP) pattern, there is an option to only stage a commit and not update the table's current-snapshot-id. In this case, the writer updates the table by creating a new snapshot. Then an auditor reads the snapshot and validates it (with row counts, for example), and if the snapshot looks good, commits the snapshot as the current table state. This allows reports to be validated before going live.\r\n\r\nI don't think WAP is working as expected under RTAS.\r\n\r\n```scala\r\nspark.sql(\"\"\"\r\nCREATE TABLE test.ns.tbl\r\nUSING iceberg\r\nTBLPROPERTIES ('write.wap.enabled'='true')\r\nAS SELECT * FROM VALUES (1, \"Alice\"), (2, \"Bob\") AS (id, fname)\r\n\"\"\")\r\nspark.conf.set(\"spark.wap.id\", \"12345\")\r\nspark.sql(\"\"\"\r\nCREATE OR REPLACE TABLE test.ns.tbl\r\nUSING iceberg\r\nAS SELECT * FROM VALUES (1, 5, \"alice\"), (2, 3, \"bob\") AS (id, name_len, name)\r\n\"\"\")\r\nspark.conf.unset(\"spark.wap.id\")\r\n```\r\n\r\nAfter running this, the schema from the staged change is showing up but the data that _should_ exist isn't accessible, i.e., `DESC test.ns.tbl` shows the new schema and `SELECT * FROM test.ns.tbl` is coming up empty. Even under a simple schema change `ALTER TABLE ... ADD COLUMN ...`, the change is taking effect prematurely.\r\n\r\n> Also, the table state can be rolled back to a previous snapshot and new commits will form a new history afterwards.\r\n\r\nI don't believe this changes the notion of what was current at some point in time. If you view the timeline as being from the database's point of view, then rolling back doesn't change the fact that at _some point in time_, a snapshot, that is now inaccessible, was visible in the database.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702272183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702275943","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-702275943","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":702275943,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI3NTk0Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:11:36Z","updated_at":"2020-10-01T17:11:36Z","author_association":"CONTRIBUTOR","body":"Looks like there are test failures:\r\n\r\n* https://travis-ci.org/github/apache/iceberg/jobs/731967979#L5315-L5319\r\n* https://travis-ci.org/github/apache/iceberg/jobs/731967979#L5359-L5363\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702275943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702278857","html_url":"https://github.com/apache/iceberg/pull/1478#issuecomment-702278857","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1478","id":702278857,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI3ODg1Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:17:01Z","updated_at":"2020-10-01T17:17:01Z","author_association":"CONTRIBUTOR","body":"@marton-bod, we were just talking about test metastores on #1495: https://github.com/apache/iceberg/pull/1495#discussion_r498394239\r\n\r\nI think part of the problem is that this is creating a new metastore instance for each test case. That's going to take longer and doesn't catch connection leaks. That's probably also causing the issue here, where something isn't cleaned up properly. I recommend moving Metastore setup to a `@BeforeClass`, like in [`SparkTestBase`](https://github.com/apache/iceberg/blob/d8a6f7fd19025005df75e06bfa5ab7417aad803a/spark/src/test/java/org/apache/iceberg/spark/SparkTestBase.java#L51).\r\n\r\nI think that would address the issue here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702278857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702279594","html_url":"https://github.com/apache/iceberg/pull/1535#issuecomment-702279594","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1535","id":702279594,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI3OTU5NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:18:14Z","updated_at":"2020-10-01T17:18:14Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702279594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702280257","html_url":"https://github.com/apache/iceberg/pull/1527#issuecomment-702280257","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1527","id":702280257,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI4MDI1Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:19:31Z","updated_at":"2020-10-01T17:19:31Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01, looks like this is picking up changes from other PRs. Could you fix that, please?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702280257/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702283492","html_url":"https://github.com/apache/iceberg/pull/1508#issuecomment-702283492","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1508","id":702283492,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI4MzQ5Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:25:22Z","updated_at":"2020-10-01T17:25:22Z","author_association":"CONTRIBUTOR","body":"> I don't think WAP is working as expected under RTAS.\r\n\r\nYou're right. I think we should disable WAP with RTAS until we figure out what the behavior should be.\r\n\r\n> I don't believe [a rollback] changes the notion of what was current at some point in time.\r\n\r\nThat's right, but it is an example of not being able to simply use the list of snapshots. This was a side point that supports the idea that point in time lookup should be done using the snapshot log, or metadata file log if it is not available, and snapshot lookup should be done strictly by id.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702283492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702285040","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-702285040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":702285040,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI4NTA0MA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:28:02Z","updated_at":"2020-10-01T17:28:02Z","author_association":"CONTRIBUTOR","body":"> Looks like there are test failures:\r\n> \r\n> * https://travis-ci.org/github/apache/iceberg/jobs/731967979#L5315-L5319\r\n> * https://travis-ci.org/github/apache/iceberg/jobs/731967979#L5359-L5363\r\n\r\nHave to check. Seems like flaky stuff - or java 11 specific? Trying to repro locally. Have to investigate.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702285040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702297720","html_url":"https://github.com/apache/iceberg/pull/1490#issuecomment-702297720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1490","id":702297720,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI5NzcyMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:50:50Z","updated_at":"2020-10-01T17:50:50Z","author_association":"CONTRIBUTOR","body":"Thanks, @massdosage! As we talked about in the sync, I think we can make incremental improvements. I'll merge this now so everyone can add changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702297720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702298519","html_url":"https://github.com/apache/iceberg/pull/1464#issuecomment-702298519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1464","id":702298519,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjI5ODUxOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T17:52:17Z","updated_at":"2020-10-01T17:52:17Z","author_association":"CONTRIBUTOR","body":"I'm going to go ahead and merge this so we have something to work from in smaller PRs. Thanks @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702298519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702319314","html_url":"https://github.com/apache/iceberg/issues/1331#issuecomment-702319314","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1331","id":702319314,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjMxOTMxNA==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T18:30:03Z","updated_at":"2020-10-01T18:30:03Z","author_association":"CONTRIBUTOR","body":"I'm starting to work on this to get familiar with the parquet reading code paths :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702319314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702338717","html_url":"https://github.com/apache/iceberg/pull/1420#issuecomment-702338717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1420","id":702338717,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjMzODcxNw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T19:06:18Z","updated_at":"2020-10-01T19:06:18Z","author_association":"MEMBER","body":"We decided to go with the other approach, Goodnight sweet prince","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702338717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702342815","html_url":"https://github.com/apache/iceberg/pull/1537#issuecomment-702342815","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1537","id":702342815,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjM0MjgxNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T19:14:22Z","updated_at":"2020-10-01T19:14:22Z","author_association":"CONTRIBUTOR","body":"Thanks for the review, @rdblue. I went ahead and updated minor comments as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702342815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702409093","html_url":"https://github.com/apache/iceberg/issues/417#issuecomment-702409093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/417","id":702409093,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQwOTA5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T21:31:02Z","updated_at":"2020-10-01T21:31:02Z","author_association":"CONTRIBUTOR","body":"I don't think I understand why you prefer extending partition specs instead of promoting from a long to a timestamp. To be clear, I'm not suggesting a solution that requires adding a new field set in ETL, or an additional derived field, or changing the way data is stored. I'm suggesting that you can convert an existing long field into a timestamp. New data would be written as a regular timestamp, existing data would be interpreted correctly and would appear to be a timestamp.\r\n\r\nDo you want to store data as a long directly and not use it as a timestamp? If so, what is the use case for keeping the data as it is and not using timestamp?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702409093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702410473","html_url":"https://github.com/apache/iceberg/issues/1468#issuecomment-702410473","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1468","id":702410473,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQxMDQ3Mw==","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T21:34:21Z","updated_at":"2020-10-01T21:34:21Z","author_association":"NONE","body":"Hey guys, we just posted more information on the new stuff we've been building for Iceberg + DynamoDB. You can check it out here: https://projectnessie.org/\r\n\r\nWe'll have a PR up against Iceberg shortly to contribute the Iceberg integrations: \r\nhttps://github.com/projectnessie/nessie/tree/main/clients/iceberg","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702410473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702411604","html_url":"https://github.com/apache/iceberg/pull/1532#issuecomment-702411604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1532","id":702411604,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQxMTYwNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T21:37:13Z","updated_at":"2020-10-01T21:37:13Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing it, @chenjunjiedada! I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702411604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702411954","html_url":"https://github.com/apache/iceberg/issues/1468#issuecomment-702411954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1468","id":702411954,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQxMTk1NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T21:38:04Z","updated_at":"2020-10-01T21:38:04Z","author_association":"MEMBER","body":"Very cool!\n\nOn Thu, Oct 1, 2020 at 4:34 PM Jacques Nadeau <notifications@github.com>\nwrote:\n\n> Hey guys, we just posted more information on the new stuff we've been\n> building for Iceberg + DynamoDB. You can check it out here:\n> https://projectnessie.org/\n>\n> We'll have a PR up against Iceberg shortly to contribute the Iceberg\n> integrations:\n> https://github.com/projectnessie/nessie/tree/main/clients/iceberg\n>\n> â€”\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/1468#issuecomment-702410473>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YKA6G5T55NR2OUSRVLSITYWXANCNFSM4RPIUBNQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702411954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702440200","html_url":"https://github.com/apache/iceberg/issues/417#issuecomment-702440200","issue_url":"https://api.github.com/repos/apache/iceberg/issues/417","id":702440200,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQ0MDIwMA==","user":{"login":"ericsun2","id":8866410,"node_id":"MDQ6VXNlcjg4NjY0MTA=","avatar_url":"https://avatars.githubusercontent.com/u/8866410?v=4","gravatar_id":"","url":"https://api.github.com/users/ericsun2","html_url":"https://github.com/ericsun2","followers_url":"https://api.github.com/users/ericsun2/followers","following_url":"https://api.github.com/users/ericsun2/following{/other_user}","gists_url":"https://api.github.com/users/ericsun2/gists{/gist_id}","starred_url":"https://api.github.com/users/ericsun2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ericsun2/subscriptions","organizations_url":"https://api.github.com/users/ericsun2/orgs","repos_url":"https://api.github.com/users/ericsun2/repos","events_url":"https://api.github.com/users/ericsun2/events{/privacy}","received_events_url":"https://api.github.com/users/ericsun2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T23:01:16Z","updated_at":"2020-10-01T23:07:51Z","author_association":"NONE","body":"With long to timestamp promotion, we can cover the epoch_millis migration use case. But not epoch_second or time zone.\r\n\r\n> Do you want to store data as a long directly and not use it as a timestamp?\r\n\r\nThank you so much for this great question. In Li***n, epoch offset millisecond/second (bigint/long) is the standard way to store time. And in the foreseeable future that might still be the case. The reason behind it is really related to Avro.\r\n\r\nBefore I can push TIMESTAMP data type into any standard data model, neither can I create a new field with TIMESTAMP as type, nor replace the bigint epoch_millis with TIMESTAMP.\r\n\r\nI understand that this choice probably does not make much sense to Netflix, because who does not want to use TIMESTAMP natively, huh? But sometimes epoch second/millisecond dies hard, this is why @shardulm94 raised this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702440200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702450378","html_url":"https://github.com/apache/iceberg/pull/1532#issuecomment-702450378","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1532","id":702450378,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQ1MDM3OA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T23:35:43Z","updated_at":"2020-10-01T23:35:43Z","author_association":"COLLABORATOR","body":"Thanks for merging!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702450378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702453101","html_url":"https://github.com/apache/iceberg/pull/1530#issuecomment-702453101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1530","id":702453101,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQ1MzEwMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-01T23:46:32Z","updated_at":"2020-10-01T23:46:32Z","author_association":"CONTRIBUTOR","body":"Thanks everyone for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702453101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702458011","html_url":"https://github.com/apache/iceberg/issues/417#issuecomment-702458011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/417","id":702458011,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQ1ODAxMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T00:03:50Z","updated_at":"2020-10-02T00:03:50Z","author_association":"CONTRIBUTOR","body":"Thanks for the response, @ericsun2! I think it makes sense now.\r\n\r\nI think that it would be reasonable in that case to extend the partition spec to handle this rather than promoting a long. But I'll have to think more about whether it's a good idea to do that in Iceberg or not. While I see the utility if you have lots of code that expects this, I'm not sure I'd make it easy to do this for new use cases.\r\n\r\nWe have something similar, where we partition dates by an integer value, like `20201001`. Right now, we have no way to automatically derive these and take advantage of hidden partitioning. I've been considering the idea of custom transform functions to solve this. So we would be able to define and plug in transforms specific to our use cases. That would solve a few problems. What do you think about defining these transforms as custom transforms and plugging them in for your environment?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702458011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702842983","html_url":"https://github.com/apache/iceberg/pull/1545#issuecomment-702842983","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1545","id":702842983,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjg0Mjk4Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T16:53:08Z","updated_at":"2020-10-02T16:53:08Z","author_association":"CONTRIBUTOR","body":"@rdblue I remember we had a note somewhere in the docs about this behavior but I couldn't find it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702842983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702883822","html_url":"https://github.com/apache/iceberg/pull/1497#issuecomment-702883822","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1497","id":702883822,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjg4MzgyMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T18:15:38Z","updated_at":"2020-10-02T18:15:38Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, I went ahead and fixed the remaining issues and opened a PR against your branch. Could you please take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702883822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702884661","html_url":"https://github.com/apache/iceberg/pull/1539#issuecomment-702884661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1539","id":702884661,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjg4NDY2MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T18:17:22Z","updated_at":"2020-10-02T18:17:22Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick! This is really helpful.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702884661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702890336","html_url":"https://github.com/apache/iceberg/pull/1546#issuecomment-702890336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1546","id":702890336,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjg5MDMzNg==","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T18:28:05Z","updated_at":"2020-10-02T18:28:05Z","author_association":"MEMBER","body":"Thank you for review and approval, @aokolnychyi !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702890336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702929447","html_url":"https://github.com/apache/iceberg/pull/1546#issuecomment-702929447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1546","id":702929447,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjkyOTQ0Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T19:55:39Z","updated_at":"2020-10-02T19:55:39Z","author_association":"CONTRIBUTOR","body":"Thank you, @dongjoon-hyun!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702929447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702936438","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-702936438","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":702936438,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjkzNjQzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T20:11:56Z","updated_at":"2020-10-02T20:11:56Z","author_association":"CONTRIBUTOR","body":"Thanks for working on this, @mickjermsurawong-stripe!\r\n\r\nI like dynamically loading a location provider, and I like that the changes required are pretty small. That looks good to me.\r\n\r\nWhat I'd like to change is how this is tested. There are two main issues with it. First, the tests are in an unrelated suite for Spark that is mainly testing that Spark works with a variety of different schemas. It doesn't seem appropriate to put the tests for injecting a location provider in a different module and into this suite. Second, the `TestLocationProvider` returns real paths and the tests work by writing data files and validating that files are underneath those paths. That does test that it works, but I think this makes validation much harder. This approach requires a lot of test code and runs a lot of unrelated cases through to validate the location provider.\r\n\r\nI would prefer a more targeted test in a new suited in core, `TestLocationProvider`. That would have a case that injects a `TestLocationProvider` that keeps track of calls in static variables, so you'd be able to inject the provider, get it from `table.operations().locationProvider()`, call some methods, and validate that `TestLocationProvider` received the calls.\r\n\r\nWe also need negative tests for when the provider can't be found. I'd like to have a good error message like \"Cannot find location provider class: %s\".","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702936438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702960501","html_url":"https://github.com/apache/iceberg/issues/1549#issuecomment-702960501","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1549","id":702960501,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjk2MDUwMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T21:13:30Z","updated_at":"2020-10-02T21:13:30Z","author_association":"CONTRIBUTOR","body":"This should replace the existing logic that finds out what files must be removed on the driver.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702960501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702967333","html_url":"https://github.com/apache/iceberg/pull/1546#issuecomment-702967333","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1546","id":702967333,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjk2NzMzMw==","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T21:31:50Z","updated_at":"2020-10-02T21:31:50Z","author_association":"MEMBER","body":"Thank you for reviewing and merging, @rdblue !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702967333/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702986390","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-702986390","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":702986390,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjk4NjM5MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T22:37:13Z","updated_at":"2020-10-02T22:37:13Z","author_association":"CONTRIBUTOR","body":"@jackye1995, I think this dynamic loading approach might be a good idea for injecting S3FileIO as well. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702986390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702988954","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-702988954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":702988954,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjk4ODk1NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T22:47:13Z","updated_at":"2020-10-02T22:47:13Z","author_association":"CONTRIBUTOR","body":"@rdblue yes, that is exactly how I implement, just waiting for your branch to cross check all details about S3FileIO before opening a PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702988954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702997838","html_url":"https://github.com/apache/iceberg/pull/1499#issuecomment-702997838","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1499","id":702997838,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjk5NzgzOA==","user":{"login":"electrum","id":9230,"node_id":"MDQ6VXNlcjkyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9230?v=4","gravatar_id":"","url":"https://api.github.com/users/electrum","html_url":"https://github.com/electrum","followers_url":"https://api.github.com/users/electrum/followers","following_url":"https://api.github.com/users/electrum/following{/other_user}","gists_url":"https://api.github.com/users/electrum/gists{/gist_id}","starred_url":"https://api.github.com/users/electrum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrum/subscriptions","organizations_url":"https://api.github.com/users/electrum/orgs","repos_url":"https://api.github.com/users/electrum/repos","events_url":"https://api.github.com/users/electrum/events{/privacy}","received_events_url":"https://api.github.com/users/electrum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-02T23:22:19Z","updated_at":"2020-10-02T23:22:19Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks for the detailed and thoughtful response. I'm embarrassed that I misread the specification and thought equality deletes were at the file level. At the partition level makes sense given how manifest files work. However, for their usage by a relational `DELETE` query, storing them in separate files is still very expensive at read time, since we have to do a file read for a single value.\r\n\r\nI can think of a couple of ways to address this cost:\r\n\r\n* Allow storing the equality delete inline in the manifest (we could have a strict or recommended size limit)\r\n* Share the same equality delete file across multiple partitions (is this allowed? how does cleanup work?)\r\n\r\nWe might also allow predicates in the inline version, as the inline version would be limited to a small number of predicates. Since they are at the partition level, they are naturally filtered to partitions that existed at the time of the delete. Maybe think of this as a third type of delete operation, rather than as a special variant of equality delete.\r\n\r\nEquality deletes in external files for CDC operations by row ID is clever and makes sense, as it makes those operations far less expensive (no need to read the original files and join to find the matching rows). I had not considered that type of operation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/702997838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703018707","html_url":"https://github.com/apache/iceberg/pull/1469#issuecomment-703018707","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1469","id":703018707,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzAxODcwNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-03T01:02:12Z","updated_at":"2020-10-03T01:02:12Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, I updated this to support all of the cases in your table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703018707/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703030934","html_url":"https://github.com/apache/iceberg/pull/1499#issuecomment-703030934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1499","id":703030934,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzAzMDkzNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-03T02:14:25Z","updated_at":"2020-10-03T02:14:25Z","author_association":"CONTRIBUTOR","body":"> However, for their usage by a relational DELETE query, storing them in separate files is still very expensive at read time, since we have to do a file read for a single value.\r\n\r\nFor a relational DELETE query, I would either encode it as a global equality delete, or scan through data files and use position deletes. Position deletes are the best for readers, so we generally want `DELETE FROM` to use them. Equality deletes are mostly for cases where you can't find where the matching rows are, like streaming.\r\n\r\nAnd just to be clear, equality delete files can have an arbitrary number of deletes, one per row. While in the worst case it could be a file read for a single delete, we would not expect that in normal operation.\r\n\r\nI don't think I would add deletes inline in manifests. That would require a lot of complication in manifests and would greatly expand table-level metadata in some use cases. I'd prefer to keep deletes distributed like data files, instead of centralized like table metadata.\r\n\r\nThe idea to share some equality delete files across partitions has occurred to me, but I think it is reasonable to either use a global delete (that is written once and shared) or a partition-level delete. We can also write a global delete once and have a background process rewrite to partition-level deletes. If you need to write fast, then use a global. For more targeted reads, use partition-level.\r\n\r\nAnd better yet, use position deletes to minimize overhead. I really don't see equality deletes being used for SQL cases, because position deletes are so much better for readers. If there isn't time to find the data, use a global delete, but then rewrite to position deletes -- not equality -- because that's better as long as you're doing work in the background.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703030934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703048101","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-703048101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":703048101,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzA0ODEwMQ==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-03T05:07:43Z","updated_at":"2020-10-03T05:07:43Z","author_association":"CONTRIBUTOR","body":"@rdblue, ah thank you for the feedback on test! I guess the complicated test here is the artifacts of me trying to test the logic in my first data localization feature. \r\n\r\nI created a separate test as suggested; I made use of the existing `TableTestBase` and construct tests based on `table.locationProvider()` instead of its underlying operations (though that also directly delegates to the ops). I also addressed feedback on error message.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703048101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703392456","html_url":"https://github.com/apache/iceberg/issues/1534#issuecomment-703392456","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1534","id":703392456,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzM5MjQ1Ng==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T04:42:29Z","updated_at":"2020-10-05T04:42:29Z","author_association":"CONTRIBUTOR","body":"Looks like the PR got merged - mind closing the issue? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703392456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703456786","html_url":"https://github.com/apache/iceberg/issues/1534#issuecomment-703456786","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1534","id":703456786,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzQ1Njc4Ng==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T07:34:07Z","updated_at":"2020-10-05T07:34:07Z","author_association":"COLLABORATOR","body":"Sure, thanks for the reminder!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703456786/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703692358","html_url":"https://github.com/apache/iceberg/pull/1514#issuecomment-703692358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1514","id":703692358,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzY5MjM1OA==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T15:04:56Z","updated_at":"2020-10-05T15:04:56Z","author_association":"CONTRIBUTOR","body":"@rdblue I think this missed the attention. Please take a look. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703692358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703735285","html_url":"https://github.com/apache/iceberg/pull/1421#issuecomment-703735285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1421","id":703735285,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzczNTI4NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T16:15:24Z","updated_at":"2020-10-05T16:15:24Z","author_association":"MEMBER","body":"Alright crew, this WIP is fully operational and I would be glad to hear any feedback or comments you have on it, Please take a look at your convience -\r\n\r\nCC: @aokolnychyi , @rdblue , @kbendick  + Anyone else who would like to be involved","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703735285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703745083","html_url":"https://github.com/apache/iceberg/pull/1469#issuecomment-703745083","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1469","id":703745083,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzc0NTA4Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T16:32:23Z","updated_at":"2020-10-05T16:32:23Z","author_association":"CONTRIBUTOR","body":"@rdblue, I see this PR failed due to `OverloadMethodsDeclarationOrder`. I faced this in a couple of other PRs and I think we also had an agreement to disable this rule a while ago. I've created #1550.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703745083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703747874","html_url":"https://github.com/apache/iceberg/pull/1550#issuecomment-703747874","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1550","id":703747874,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzc0Nzg3NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T16:37:24Z","updated_at":"2020-10-05T16:37:24Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nThanks for following up on this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703747874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703761919","html_url":"https://github.com/apache/iceberg/pull/1497#issuecomment-703761919","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1497","id":703761919,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzc2MTkxOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T17:02:15Z","updated_at":"2020-10-05T17:02:15Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks, @chenjunjiedada!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703761919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703770779","html_url":"https://github.com/apache/iceberg/pull/1514#issuecomment-703770779","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1514","id":703770779,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzc3MDc3OQ==","user":{"login":"mehtaashish23","id":75326,"node_id":"MDQ6VXNlcjc1MzI2","avatar_url":"https://avatars.githubusercontent.com/u/75326?v=4","gravatar_id":"","url":"https://api.github.com/users/mehtaashish23","html_url":"https://github.com/mehtaashish23","followers_url":"https://api.github.com/users/mehtaashish23/followers","following_url":"https://api.github.com/users/mehtaashish23/following{/other_user}","gists_url":"https://api.github.com/users/mehtaashish23/gists{/gist_id}","starred_url":"https://api.github.com/users/mehtaashish23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mehtaashish23/subscriptions","organizations_url":"https://api.github.com/users/mehtaashish23/orgs","repos_url":"https://api.github.com/users/mehtaashish23/repos","events_url":"https://api.github.com/users/mehtaashish23/events{/privacy}","received_events_url":"https://api.github.com/users/mehtaashish23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T17:18:42Z","updated_at":"2020-10-05T17:18:42Z","author_association":"CONTRIBUTOR","body":"Resolving conflicts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703770779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703790040","html_url":"https://github.com/apache/iceberg/pull/1514#issuecomment-703790040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1514","id":703790040,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzc5MDA0MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T17:54:02Z","updated_at":"2020-10-05T17:54:02Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nThanks for fixing this, @mehtaashish23! I'll merge it when the conflicts are resolved.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703790040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703819242","html_url":"https://github.com/apache/iceberg/pull/1550#issuecomment-703819242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1550","id":703819242,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzgxOTI0Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T18:46:57Z","updated_at":"2020-10-05T18:46:57Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing! I've merged to unblock other PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703819242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703850831","html_url":"https://github.com/apache/iceberg/pull/1505#issuecomment-703850831","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1505","id":703850831,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzg1MDgzMQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T19:49:13Z","updated_at":"2020-10-05T19:49:13Z","author_association":"CONTRIBUTOR","body":"> > Spark is using a v1 command to drop the table: `org.apache.spark.sql.execution.command.DropTableCommand`. That is unexpected because the test should be using an Iceberg implementation of Spark's `TableCatalog` for all of these operations. Can you find out what catalog was being used? My guess is that it was the built-in [`spark_catalog`](https://github.com/apache/iceberg/blob/1772f4f27b8a12d3e89a7f65b8b600b717e1f09d/spark3/src/test/java/org/apache/iceberg/spark/SparkCatalogTestBase.java#L66-L71) and that somehow the session catalog wrapper that we injected did not correctly detect that this table is Iceberg and not Hive.\r\n\r\nI guess this is a spark bug.\r\n\r\nWhat I see is that the spark_catalog is correctly set (CatalogManager.defaultSessionCatalog is the original inner HiveSessionCatalog, but the CatalogManager.catalogs has a value for spark_catalog pointing to our very own SparkSessionCatalog).\r\nSadly this code does not trigger DropTable command creation during the planning:\r\n```\r\n    case DropTableStatement(NonSessionCatalogAndTable(catalog, tbl), ifExists, _) =>\r\n      DropTable(catalog.asTableCatalog, tbl.asIdentifier, ifExists)\r\n```\r\nhttps://github.com/apache/spark/blob/v3.0.0/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/analysis/ResolveCatalogs.scala#L175-L176\r\n\r\nI know from debugging that the NonSessionCatalogAndTable is None (since with spark_catalog we replace session catalog so it is not a NonSessionCatalogAndTable), so I guess we do not translate the DropTableStatement to DropTable.\r\nWe fall back to ResolvaSessionCatalog and convert the statement to DropTableCommand which does not care about the catalog\r\n```\r\n    case DropTableStatement(TempViewOrV1Table(name), ifExists, purge) =>\r\n      DropTableCommand(name.asTableIdentifier, ifExists, isView = false, purge = purge)\r\n```\r\nhttps://github.com/apache/spark/blob/v3.0.0/sql/core/src/main/scala/org/apache/spark/sql/catalyst/analysis/ResolveSessionCatalog.scala#L331-L332\r\n\r\nMy theory is that we are missing the checks and different code paths for V2 providers which we have for CreateTableStatement for example:\r\n```\r\n      if (!isV2Provider(provider)) {\r\n[..]\r\n      } else {\r\n[..]\r\n      }\r\n```\r\nhttps://github.com/apache/spark/blob/v3.0.0/sql/core/src/main/scala/org/apache/spark/sql/catalyst/analysis/ResolveSessionCatalog.scala#L248\r\n\r\nSo to summarize the things again:\r\n- This is a Spark bug, where the `ResolveSessionCatalog` should use different code for V1 and V2 providers when a DropTableStatement is issued\r\n\r\n@rdblue: I am not an expert in Scala, so happy to hear any objections if I made mistakes. Does my analysis makes sense? How should we proceed?\r\n\r\nThanks,\r\nPeter ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703850831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703852389","html_url":"https://github.com/apache/iceberg/pull/1505#issuecomment-703852389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1505","id":703852389,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzg1MjM4OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T19:52:15Z","updated_at":"2020-10-05T19:52:15Z","author_association":"CONTRIBUTOR","body":"If it's a Spark bug, then let's just add an `Assume` for the failing test to exclude it when the catalog is `spark_catalog`. Thanks for looking into it further, @pvary!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703852389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703891451","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-703891451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":703891451,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzg5MTQ1MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T21:11:55Z","updated_at":"2020-10-05T21:11:55Z","author_association":"CONTRIBUTOR","body":"Thanks for the update, @mickjermsurawong-stripe! I think the implementation can be quite a bit simpler and more like the original, even with support for the no-arg constructor. Sorry I didn't mention that earlier, before you went ahead and implemented it this way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703891451/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703903819","html_url":"https://github.com/apache/iceberg/pull/1505#issuecomment-703903819","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1505","id":703903819,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzkwMzgxOQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T21:39:28Z","updated_at":"2020-10-05T21:39:28Z","author_association":"CONTRIBUTOR","body":"> If it's a Spark bug, then let's just add an `Assume` for the failing test to exclude it when the catalog is `spark_catalog`. Thanks for looking into it further, @pvary!\r\n\r\nCurrently in our spark tests we set `engine.hive.enabled` to `false` (and also we default to there so no breaking change in the release). That is way with the code in this PR does not trigger the issue.\r\n\r\nSo I think we are good on this. Unless we want specific tests in spark sql to have `engine.hive.enabled` set to `true` and test this code path as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703903819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703929659","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-703929659","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":703929659,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzkyOTY1OQ==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T22:47:54Z","updated_at":"2020-10-05T22:47:54Z","author_association":"CONTRIBUTOR","body":"thanks @rdblue for the review so far! I believe this should be ready for another review. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703929659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703934609","html_url":"https://github.com/apache/iceberg/pull/1505#issuecomment-703934609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1505","id":703934609,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzkzNDYwOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T23:03:07Z","updated_at":"2020-10-05T23:03:07Z","author_association":"CONTRIBUTOR","body":"That sounds fine to me. I thought this was a problem because you were hitting it in tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703934609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703935176","html_url":"https://github.com/apache/iceberg/pull/1505#issuecomment-703935176","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1505","id":703935176,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzkzNTE3Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T23:04:57Z","updated_at":"2020-10-05T23:04:57Z","author_association":"CONTRIBUTOR","body":"Thanks @pvary! I've merged this. We should also update the docs to explain when the storage handler will be set so that people can update their hive-site.xml if they choose.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703935176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703944728","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-703944728","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":703944728,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzk0NDcyOA==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-05T23:35:33Z","updated_at":"2020-10-05T23:35:57Z","author_association":"CONTRIBUTOR","body":"Propagating the causes now should give stacktrace for these two cases, with more specific causes.\r\n\r\n```\r\n java.lang.IllegalArgumentException: Unable to find a constructor for implementation org.apache.iceberg.TestLocationProvider$InvalidArgTypesDynamicallyLoadedLocationProvider of interface org.apache.iceberg.io.LocationProvider. Make sure the implementation is in classpath, and that it either has a public no-arg constructor or a two-arg constructor taking in the string base table location and its property string map.\r\n        at org.apache.iceberg.LocationProviders.locationsFor(LocationProviders.java:48)\r\n        at org.apache.iceberg.TestTables$TestTableOperations.locationProvider(TestTables.java:212)\r\n        at org.apache.iceberg.BaseTable.locationProvider(BaseTable.java:199)\r\n        at org.apache.iceberg.TestLocationProvider.testInvalidArgTypesDynamicallyLoadedLocationProvider(TestLocationProvider.java:208)\r\n\r\n        Caused by:\r\n        java.lang.NoSuchMethodException: Cannot find constructor for interface org.apache.iceberg.io.LocationProvider\r\n                Missing org.apache.iceberg.TestLocationProvider$InvalidArgTypesDynamicallyLoadedLocationProvider() [java.lang.NoSuchMethodException: org.apache.iceberg.TestLocationProvider$InvalidArgTypesDynamicallyLoadedLocationProvider.<init>()]\r\n                Missing org.apache.iceberg.TestLocationProvider$InvalidArgTypesDynamicallyLoadedLocationProvider(java.lang.String,java.util.Map) [java.lang.NoSuchMethodException: org.apache.iceberg.TestLocationProvider$InvalidArgTypesDynamicallyLoadedLocationProvider.<init>(java.lang.String, java.util.Map)]\r\n```\r\n\r\nand\r\n\r\n```\r\njava.lang.IllegalArgumentException: Provided implementation for dynamic instantiation should implement interface org.apache.iceberg.io.LocationProvider.\r\n        at org.apache.iceberg.LocationProviders.locationsFor(LocationProviders.java:59)\r\n        at org.apache.iceberg.TestTables$TestTableOperations.locationProvider(TestTables.java:212)\r\n        at org.apache.iceberg.BaseTable.locationProvider(BaseTable.java:199)\r\n        at org.apache.iceberg.TestLocationProvider.testInvalidNoInterfaceDynamicallyLoadedLocationProvider(TestLocationProvider.java:190)\r\n\r\n        Caused by:\r\n        java.lang.ClassCastException: org.apache.iceberg.TestLocationProvider$InvalidNoInterfaceDynamicallyLoadedLocationProvider cannot be cast to org.apache.iceberg.io.LocationProvider\r\n            at org.apache.iceberg.LocationProviders.locationsFor(LocationProviders.java:56)\r\n            ... 3 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703944728/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703958511","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-703958511","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":703958511,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzk1ODUxMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T00:25:08Z","updated_at":"2020-10-06T00:25:08Z","author_association":"CONTRIBUTOR","body":"I reran to see if the tests were flaky and it failed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703958511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703993802","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-703993802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":703993802,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzk5MzgwMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T02:39:21Z","updated_at":"2020-10-06T02:39:21Z","author_association":"CONTRIBUTOR","body":"Thanks, @mickjermsurawong-stripe! I merged this. Nice work, and thank you for your patience and quick turn-around with the review comments!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703993802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703996865","html_url":"https://github.com/apache/iceberg/pull/1531#issuecomment-703996865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1531","id":703996865,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzk5Njg2NQ==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T02:51:53Z","updated_at":"2020-10-06T02:51:53Z","author_association":"CONTRIBUTOR","body":"Thank _you_ Ryan! This will help with our internal feature :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/703996865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704314443","html_url":"https://github.com/apache/iceberg/pull/1505#issuecomment-704314443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1505","id":704314443,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDMxNDQ0Mw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T14:38:24Z","updated_at":"2020-10-06T14:38:24Z","author_association":"CONTRIBUTOR","body":"> Thanks @pvary! I've merged this. We should also update the docs to explain when the storage handler will be set so that people can update their hive-site.xml if they choose.\r\n\r\nAm I right when I think this should be in https://github.com/apache/iceberg/blob/master/site/docs/hive.md?\r\n\r\nThanks\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704314443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704320460","html_url":"https://github.com/apache/iceberg/pull/1505#issuecomment-704320460","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1505","id":704320460,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDMyMDQ2MA==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T14:47:14Z","updated_at":"2020-10-06T14:47:14Z","author_association":"CONTRIBUTOR","body":"> > Thanks @pvary! I've merged this. We should also update the docs to explain when the storage handler will be set so that people can update their hive-site.xml if they choose.\r\n> \r\n> Am I right when I think this should be in https://github.com/apache/iceberg/blob/master/site/docs/hive.md?\r\n> \r\n> Thanks\r\n> Peter\r\n\r\nYes, I was going to add a section under `Using Hadoop Tables`, something like  `Using Hive Catalog` and this was going to be about finding the Hive table created by Iceberg if you use that method and then how to add the StorageHandler to this table. I think we still need something like that (for existing tables and those created without the config changes in this PR) but we also need a section describing how that can automatically be done at Table creation time from this PR and the `hive-site.xml` etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704320460/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704358007","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-704358007","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":704358007,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDM1ODAwNw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T15:38:01Z","updated_at":"2020-10-06T15:38:01Z","author_association":"CONTRIBUTOR","body":"> I reran to see if the tests were flaky and it failed.\r\n\r\nYeah, seen those before too - some flaky stuff I have to investigate. ðŸ˜¢ \r\nThis is the one on my list ðŸ˜„ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704358007/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704386809","html_url":"https://github.com/apache/iceberg/issues/1513#issuecomment-704386809","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1513","id":704386809,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDM4NjgwOQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T16:09:56Z","updated_at":"2020-10-06T16:09:56Z","author_association":"CONTRIBUTOR","body":"@rdblue your suggestion makes sense to me. I created a PR for that: https://github.com/apache/iceberg/pull/1553","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704386809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704401225","html_url":"https://github.com/apache/iceberg/pull/1514#issuecomment-704401225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1514","id":704401225,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQwMTIyNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T16:34:51Z","updated_at":"2020-10-06T16:34:51Z","author_association":"CONTRIBUTOR","body":"Thanks @mehtaashish23! I merged this. Good catch!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704401225/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704407528","html_url":"https://github.com/apache/iceberg/pull/1329#issuecomment-704407528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1329","id":704407528,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQwNzUyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T16:46:17Z","updated_at":"2020-10-06T16:46:17Z","author_association":"CONTRIBUTOR","body":"@duanmeng, sorry I didn't see this PR sooner. I think you would probably be interested in other PRs that have recently implemented functionality that is similar:\r\n\r\n* #1267 added an iceberg-hive-runtime Jar with Iceberg dependencies bundled in\r\n* #1505 makes tables readable in Hive when created in Spark, if the table or environment has a flag set\r\n\r\nPlease have a look at those and see if they do everything you need.\r\n\r\nI'll close this PR since it overlaps the others, but feel free to open a new one if you have anything else to fix. Ping me and I'll take a look at future PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704407528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704408199","html_url":"https://github.com/apache/iceberg/pull/1477#issuecomment-704408199","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1477","id":704408199,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQwODE5OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-06T16:47:25Z","updated_at":"2020-10-06T16:47:25Z","author_association":"CONTRIBUTOR","body":"@openinx, any update on this PR? I think we would like to get it done for the 0.10.0 release, which should be in the next week or two.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/704408199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]