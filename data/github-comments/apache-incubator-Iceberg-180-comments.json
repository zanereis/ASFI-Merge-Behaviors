[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161601539","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1161601539","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1161601539,"node_id":"IC_kwDOCW7NX85FPKID","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T11:11:24Z","updated_at":"2022-06-21T11:11:24Z","author_association":"CONTRIBUTOR","body":"@wuwenchi, Thank you first.\r\n\r\nIn batch case, this problem does not occur. Unfortunately, in our production, data is streaming. Batch tasks are executed using Spark. But the current trend (at least within our department) is that more and more tasks are moving from batch to stream.\r\n\r\nPersonally, if there is no blocking, then it seems like a good time to use the new Sink API.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161601539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161615951","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1161615951","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1161615951,"node_id":"IC_kwDOCW7NX85FPNpP","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T11:25:28Z","updated_at":"2022-06-21T11:25:28Z","author_association":"CONTRIBUTOR","body":"Many thanks @rdblue, for the feedbacks, have addressed most of them and reverted on the rest.\r\n\r\n> It would be great if @aokolnychyi could take a look as well.\r\n\r\n+1, it would be awesome :) !!!\r\n\r\nHere is a gist post addressing feedbacks : https://gist.github.com/singhpk234/640953c2658a6b16fa94c60c8066c4c0\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161615951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161733381","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1161733381","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1161733381,"node_id":"IC_kwDOCW7NX85FPqUF","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T13:15:05Z","updated_at":"2022-06-21T13:15:05Z","author_association":"CONTRIBUTOR","body":"Just as a reminder:\r\n\r\n`move spark/v3.2 to spark/v3.3` requires a separate Commiter history, so dont use squash when merging this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161733381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161743689","html_url":"https://github.com/apache/iceberg/pull/3998#issuecomment-1161743689","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3998","id":1161743689,"node_id":"IC_kwDOCW7NX85FPs1J","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T13:23:26Z","updated_at":"2022-06-21T13:23:26Z","author_association":"CONTRIBUTOR","body":"cc @rdblue, PTAL, thx\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161743689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161839654","html_url":"https://github.com/apache/iceberg/pull/4946#issuecomment-1161839654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4946","id":1161839654,"node_id":"IC_kwDOCW7NX85FQEQm","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T14:40:34Z","updated_at":"2022-06-21T14:40:34Z","author_association":"CONTRIBUTOR","body":"> @pvary : I have addressed the comments. Please check. Thanks.\r\n\r\nLet's give him a few more days, then I will merge.\r\nThanks, Peter ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161839654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161856385","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1161856385","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1161856385,"node_id":"IC_kwDOCW7NX85FQIWB","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T14:54:36Z","updated_at":"2022-06-21T14:54:36Z","author_association":"MEMBER","body":"Few questions: \r\n\r\n1.  Why the expected results is  the following ?  Does the record `<id=6, data=20220505>` really to be the expected record in the output for a __LEFT JOIN__ ? \r\n\r\n```bash\r\nid                      data\r\n 1                  20220607\r\n 3                  20220505\r\n 6                  20220505\r\n 2                  20220504\r\n```\r\n\r\n2. As we apache iceberg format v2 don't support incremental streaming reading, then how could we accomplish this streaming read and streaming join ?  Shouldn't we solve the incremental streaming read semantics firstly and then handle the complex join semantic ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161856385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161912109","html_url":"https://github.com/apache/iceberg/issues/4510#issuecomment-1161912109","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4510","id":1161912109,"node_id":"IC_kwDOCW7NX85FQV8t","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T15:24:40Z","updated_at":"2022-06-21T15:24:40Z","author_association":"CONTRIBUTOR","body":"I think the problem is that this is a v1 table. In v1, the `some_date` partition field is not actually dropped, it is replaced with a null / void transform. So you still need the original column ref. If you update your table to v2 and then try the write it should work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161912109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161970817","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1161970817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1161970817,"node_id":"IC_kwDOCW7NX85FQkSB","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T16:16:18Z","updated_at":"2022-06-22T01:44:05Z","author_association":"CONTRIBUTOR","body":"1. condition :`where t1.data > t2.data or t2.data is null`\r\nThe data we should get from the JOIN is\r\n```\r\nid                      data\r\n 1                  20220607\r\n 3                  20220505\r\n```\r\n\r\n<id=6, data=20220505> Is native data and should not be overwirte. So it's one of our expectations.\r\n\r\n\r\n2. In general, the two tables to be join do not have to be iceberg table. In fact, in some of our case, the two join tables are Kafka and dim table, the target is an iceberg table. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161970817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161997824","html_url":"https://github.com/apache/iceberg/issues/5064#issuecomment-1161997824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5064","id":1161997824,"node_id":"IC_kwDOCW7NX85FQq4A","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T16:40:00Z","updated_at":"2022-06-21T16:40:00Z","author_association":"COLLABORATOR","body":"Yea the trick is both StructLikeWrapper need the same type to compare.  It may be risky to change it at this point?\r\n\r\n@findinpath there's a few prs on master fixing partitions table, not released yet, did you check with those?  In particular #4560 and #4516 and #4637 (the first one being perhaps the more pertinent for this issue).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1161997824/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162085783","html_url":"https://github.com/apache/iceberg/pull/5105#issuecomment-1162085783","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5105","id":1162085783,"node_id":"IC_kwDOCW7NX85FRAWX","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T17:45:36Z","updated_at":"2022-06-21T17:45:36Z","author_association":"CONTRIBUTOR","body":"cc @kbendick @rdblue @flyrain @karuppayya @szehon-ho @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162085783/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162089200","html_url":"https://github.com/apache/iceberg/pull/5010#issuecomment-1162089200","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5010","id":1162089200,"node_id":"IC_kwDOCW7NX85FRBLw","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T17:47:27Z","updated_at":"2022-06-21T17:47:42Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar Thanks for your review ! Incorporated the changes requested.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162089200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162191395","html_url":"https://github.com/apache/iceberg/pull/5108#issuecomment-1162191395","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5108","id":1162191395,"node_id":"IC_kwDOCW7NX85FRaIj","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T18:52:07Z","updated_at":"2022-06-21T18:52:07Z","author_association":"CONTRIBUTOR","body":"cc @kbendick @rdblue @flyrain @karuppayya @szehon-ho @RussellSpitzer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162191395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162201379","html_url":"https://github.com/apache/iceberg/pull/4926#issuecomment-1162201379","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4926","id":1162201379,"node_id":"IC_kwDOCW7NX85FRckj","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T19:00:54Z","updated_at":"2022-06-21T20:28:30Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar @rdblue For operations like - BaseOverwriteFiles we call `validationHistory` method which is fetching ancestors between starting snapshot and current snapshot. After branching is introduced, this can cause inconsistencies. Is my understanding right or am I missing something wrt to validations?\r\n\r\nFor now if we just introduce branching for append and delete operations, is it going to be fine ? We can extend to overwrite later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162201379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162366350","html_url":"https://github.com/apache/iceberg/pull/3126#issuecomment-1162366350","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3126","id":1162366350,"node_id":"IC_kwDOCW7NX85FSE2O","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-21T21:08:34Z","updated_at":"2022-06-21T21:08:34Z","author_association":"CONTRIBUTOR","body":"Hi @itachi-sharingan, are you still working on it? Otherwise, I can pick it up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162366350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162490073","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1162490073","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1162490073,"node_id":"IC_kwDOCW7NX85FSjDZ","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T00:25:22Z","updated_at":"2022-06-22T00:25:22Z","author_association":"CONTRIBUTOR","body":"I'll be able to take a look today. Sorry for the delay!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162490073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162498407","html_url":"https://github.com/apache/iceberg/pull/5057#issuecomment-1162498407","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5057","id":1162498407,"node_id":"IC_kwDOCW7NX85FSlFn","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T00:43:04Z","updated_at":"2022-06-22T00:43:04Z","author_association":"COLLABORATOR","body":"Looks like some violation in Spark 3.0?  Also fyi , @kbendick ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162498407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162501148","html_url":"https://github.com/apache/iceberg/issues/4271#issuecomment-1162501148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4271","id":1162501148,"node_id":"IC_kwDOCW7NX85FSlwc","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T00:47:39Z","updated_at":"2022-06-22T00:47:39Z","author_association":"COLLABORATOR","body":"Fixed by https://github.com/apache/iceberg/pull/4520","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162501148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162501933","html_url":"https://github.com/apache/iceberg/issues/5058#issuecomment-1162501933","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5058","id":1162501933,"node_id":"IC_kwDOCW7NX85FSl8t","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T00:48:45Z","updated_at":"2022-06-22T00:49:26Z","author_association":"COLLABORATOR","body":"Would it happen to be because https://github.com/apache/iceberg/issues/4127. ?  (Check the sequence number of the delete file, maybe it's the same as your data files and hence it's not getting deleted)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162501933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162505656","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1162505656","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1162505656,"node_id":"IC_kwDOCW7NX85FSm24","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T00:54:36Z","updated_at":"2022-06-22T00:56:44Z","author_association":"CONTRIBUTOR","body":"I am a little bit confused. Shouldn't #5056 be reviewed and merged first?\r\n\r\nWe can't squash changes in this PR to keep history but we also can't rebase as the commit history in this PR is not clean. What's the plan? Do we plan to clean up the history in this PR or merge #5056 first?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162505656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162515676","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1162515676","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1162515676,"node_id":"IC_kwDOCW7NX85FSpTc","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T01:15:37Z","updated_at":"2022-06-22T01:17:17Z","author_association":"CONTRIBUTOR","body":"Oh,  it seems that #5056 should be merged first so that history can be keeped.\r\nThis PR should not include the move.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162515676/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162517529","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1162517529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1162517529,"node_id":"IC_kwDOCW7NX85FSpwZ","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T01:19:39Z","updated_at":"2022-06-22T01:19:39Z","author_association":"CONTRIBUTOR","body":"Okay, I'll review this PR for changes regarding 3.3 support and then we can either remove the 3.2 part from this PR or add appropriate changes to #5056.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162517529/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162629299","html_url":"https://github.com/apache/iceberg/pull/5039#issuecomment-1162629299","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5039","id":1162629299,"node_id":"IC_kwDOCW7NX85FTFCz","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T04:36:00Z","updated_at":"2022-06-22T04:36:00Z","author_association":"CONTRIBUTOR","body":"Thanks @krisdas for the PR, and for the team for the review comments!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162629299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162671648","html_url":"https://github.com/apache/iceberg/pull/5083#issuecomment-1162671648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5083","id":1162671648,"node_id":"IC_kwDOCW7NX85FTPYg","user":{"login":"CodingCat","id":678008,"node_id":"MDQ6VXNlcjY3ODAwOA==","avatar_url":"https://avatars.githubusercontent.com/u/678008?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingCat","html_url":"https://github.com/CodingCat","followers_url":"https://api.github.com/users/CodingCat/followers","following_url":"https://api.github.com/users/CodingCat/following{/other_user}","gists_url":"https://api.github.com/users/CodingCat/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingCat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingCat/subscriptions","organizations_url":"https://api.github.com/users/CodingCat/orgs","repos_url":"https://api.github.com/users/CodingCat/repos","events_url":"https://api.github.com/users/CodingCat/events{/privacy}","received_events_url":"https://api.github.com/users/CodingCat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T05:50:39Z","updated_at":"2022-06-22T05:50:39Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi would you please giving a review when you have a chance? thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162671648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162675524","html_url":"https://github.com/apache/iceberg/issues/4996#issuecomment-1162675524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4996","id":1162675524,"node_id":"IC_kwDOCW7NX85FTQVE","user":{"login":"jingli430","id":4213288,"node_id":"MDQ6VXNlcjQyMTMyODg=","avatar_url":"https://avatars.githubusercontent.com/u/4213288?v=4","gravatar_id":"","url":"https://api.github.com/users/jingli430","html_url":"https://github.com/jingli430","followers_url":"https://api.github.com/users/jingli430/followers","following_url":"https://api.github.com/users/jingli430/following{/other_user}","gists_url":"https://api.github.com/users/jingli430/gists{/gist_id}","starred_url":"https://api.github.com/users/jingli430/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jingli430/subscriptions","organizations_url":"https://api.github.com/users/jingli430/orgs","repos_url":"https://api.github.com/users/jingli430/repos","events_url":"https://api.github.com/users/jingli430/events{/privacy}","received_events_url":"https://api.github.com/users/jingli430/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T05:56:19Z","updated_at":"2022-06-22T05:56:19Z","author_association":"NONE","body":"I am seeing the same issue. I am ok If there is new position-delete found and then we cannot commit here, but could we have a strategy to auto-retry?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162675524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162750225","html_url":"https://github.com/apache/iceberg/pull/5057#issuecomment-1162750225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5057","id":1162750225,"node_id":"IC_kwDOCW7NX85FTikR","user":{"login":"xrl1","id":5931042,"node_id":"MDQ6VXNlcjU5MzEwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/5931042?v=4","gravatar_id":"","url":"https://api.github.com/users/xrl1","html_url":"https://github.com/xrl1","followers_url":"https://api.github.com/users/xrl1/followers","following_url":"https://api.github.com/users/xrl1/following{/other_user}","gists_url":"https://api.github.com/users/xrl1/gists{/gist_id}","starred_url":"https://api.github.com/users/xrl1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xrl1/subscriptions","organizations_url":"https://api.github.com/users/xrl1/orgs","repos_url":"https://api.github.com/users/xrl1/repos","events_url":"https://api.github.com/users/xrl1/events{/privacy}","received_events_url":"https://api.github.com/users/xrl1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T07:30:17Z","updated_at":"2022-06-22T07:30:17Z","author_association":"CONTRIBUTOR","body":"@szehon-ho I committed a fixup to the violation (missed it while running the checkstyle locally in the IDE for some reason)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162750225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162752242","html_url":"https://github.com/apache/iceberg/pull/5060#issuecomment-1162752242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5060","id":1162752242,"node_id":"IC_kwDOCW7NX85FTjDy","user":{"login":"wang-x-xia","id":83057695,"node_id":"MDQ6VXNlcjgzMDU3Njk1","avatar_url":"https://avatars.githubusercontent.com/u/83057695?v=4","gravatar_id":"","url":"https://api.github.com/users/wang-x-xia","html_url":"https://github.com/wang-x-xia","followers_url":"https://api.github.com/users/wang-x-xia/followers","following_url":"https://api.github.com/users/wang-x-xia/following{/other_user}","gists_url":"https://api.github.com/users/wang-x-xia/gists{/gist_id}","starred_url":"https://api.github.com/users/wang-x-xia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wang-x-xia/subscriptions","organizations_url":"https://api.github.com/users/wang-x-xia/orgs","repos_url":"https://api.github.com/users/wang-x-xia/repos","events_url":"https://api.github.com/users/wang-x-xia/events{/privacy}","received_events_url":"https://api.github.com/users/wang-x-xia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T07:32:39Z","updated_at":"2022-06-22T07:32:39Z","author_association":"CONTRIBUTOR","body":"@rdblue \r\nThe dell module has no external **runtime** dependencies now.\r\nShould I prepare the LICENSE of **compile-only** dependencies, that won't be in the runtime Jar? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162752242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162756905","html_url":"https://github.com/apache/iceberg/issues/5099#issuecomment-1162756905","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5099","id":1162756905,"node_id":"IC_kwDOCW7NX85FTkMp","user":{"login":"cbwn123","id":94812844,"node_id":"U_kgDOBaa6rA","avatar_url":"https://avatars.githubusercontent.com/u/94812844?v=4","gravatar_id":"","url":"https://api.github.com/users/cbwn123","html_url":"https://github.com/cbwn123","followers_url":"https://api.github.com/users/cbwn123/followers","following_url":"https://api.github.com/users/cbwn123/following{/other_user}","gists_url":"https://api.github.com/users/cbwn123/gists{/gist_id}","starred_url":"https://api.github.com/users/cbwn123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbwn123/subscriptions","organizations_url":"https://api.github.com/users/cbwn123/orgs","repos_url":"https://api.github.com/users/cbwn123/repos","events_url":"https://api.github.com/users/cbwn123/events{/privacy}","received_events_url":"https://api.github.com/users/cbwn123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T07:37:54Z","updated_at":"2022-06-22T07:37:54Z","author_association":"NONE","body":"try this\r\nset spark.sql.shuffle.partitions = num-executors  * executor-cores * 2","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162756905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162756919","html_url":"https://github.com/apache/iceberg/pull/4662#issuecomment-1162756919","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4662","id":1162756919,"node_id":"IC_kwDOCW7NX85FTkM3","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T07:37:55Z","updated_at":"2022-06-22T07:37:55Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix @szlta and the @szehon-ho and @rdblue for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162756919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162822289","html_url":"https://github.com/apache/iceberg/pull/5100#issuecomment-1162822289","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5100","id":1162822289,"node_id":"IC_kwDOCW7NX85FT0KR","user":{"login":"Zhangg7723","id":18146312,"node_id":"MDQ6VXNlcjE4MTQ2MzEy","avatar_url":"https://avatars.githubusercontent.com/u/18146312?v=4","gravatar_id":"","url":"https://api.github.com/users/Zhangg7723","html_url":"https://github.com/Zhangg7723","followers_url":"https://api.github.com/users/Zhangg7723/followers","following_url":"https://api.github.com/users/Zhangg7723/following{/other_user}","gists_url":"https://api.github.com/users/Zhangg7723/gists{/gist_id}","starred_url":"https://api.github.com/users/Zhangg7723/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zhangg7723/subscriptions","organizations_url":"https://api.github.com/users/Zhangg7723/orgs","repos_url":"https://api.github.com/users/Zhangg7723/repos","events_url":"https://api.github.com/users/Zhangg7723/events{/privacy}","received_events_url":"https://api.github.com/users/Zhangg7723/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T08:43:27Z","updated_at":"2022-06-22T08:43:27Z","author_association":"CONTRIBUTOR","body":"@rdblue can you give a review? thank you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162822289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162859934","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1162859934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1162859934,"node_id":"IC_kwDOCW7NX85FT9We","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T09:20:37Z","updated_at":"2022-06-22T09:31:54Z","author_association":"CONTRIBUTOR","body":"> I am a little bit confused. Shouldn't https://github.com/apache/iceberg/pull/5056 be reviewed and merged first?\r\n\r\nIt was what I had in mind originally as well : \r\n1. we would first merge https://github.com/apache/iceberg/pull/5056, which will make master have only 3.3 and not 3.2\r\n2. then we would merge this pr adding back 3.2 and make ci work with 3.3.\r\n\r\nsince we started with this pr, I think post finalizing 3.3 changes will make this pr 3.3 only and move 3.2 to https://github.com/apache/iceberg/pull/5056.\r\n\r\nwhich @aokolnychyi  suggested as well. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162859934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162861647","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1162861647","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1162861647,"node_id":"IC_kwDOCW7NX85FT9xP","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T09:22:24Z","updated_at":"2022-06-22T09:22:58Z","author_association":"CONTRIBUTOR","body":"Thanks @aokolnychyi for reviewing this PR, have addressed the feedbacks from round 1 of your review.\r\n\r\nHere is the updated gist post addressing feedbacks: https://gist.github.com/singhpk234/640953c2658a6b16fa94c60c8066c4c0","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162861647/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162952600","html_url":"https://github.com/apache/iceberg/issues/5058#issuecomment-1162952600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5058","id":1162952600,"node_id":"IC_kwDOCW7NX85FUT-Y","user":{"login":"eric666666","id":51162281,"node_id":"MDQ6VXNlcjUxMTYyMjgx","avatar_url":"https://avatars.githubusercontent.com/u/51162281?v=4","gravatar_id":"","url":"https://api.github.com/users/eric666666","html_url":"https://github.com/eric666666","followers_url":"https://api.github.com/users/eric666666/followers","following_url":"https://api.github.com/users/eric666666/following{/other_user}","gists_url":"https://api.github.com/users/eric666666/gists{/gist_id}","starred_url":"https://api.github.com/users/eric666666/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric666666/subscriptions","organizations_url":"https://api.github.com/users/eric666666/orgs","repos_url":"https://api.github.com/users/eric666666/repos","events_url":"https://api.github.com/users/eric666666/events{/privacy}","received_events_url":"https://api.github.com/users/eric666666/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T10:58:47Z","updated_at":"2022-06-22T10:58:47Z","author_association":"NONE","body":"> Would it happen to be because #4127. ? (Check the sequence number of the delete file, maybe it's the same as your data files and hence it's not getting deleted)\r\n\r\nI test again. It seems because of partition table's sequence number problem. Do you have a test with PR #3990.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1162952600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163052891","html_url":"https://github.com/apache/iceberg/pull/4904#issuecomment-1163052891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4904","id":1163052891,"node_id":"IC_kwDOCW7NX85FUsdb","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T12:45:33Z","updated_at":"2022-06-22T12:45:33Z","author_association":"COLLABORATOR","body":"Thanks for ping me, I will take a look this week.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163052891/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163062143","html_url":"https://github.com/apache/iceberg/issues/4510#issuecomment-1163062143","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4510","id":1163062143,"node_id":"IC_kwDOCW7NX85FUut_","user":{"login":"itaise","id":64745584,"node_id":"MDQ6VXNlcjY0NzQ1NTg0","avatar_url":"https://avatars.githubusercontent.com/u/64745584?v=4","gravatar_id":"","url":"https://api.github.com/users/itaise","html_url":"https://github.com/itaise","followers_url":"https://api.github.com/users/itaise/followers","following_url":"https://api.github.com/users/itaise/following{/other_user}","gists_url":"https://api.github.com/users/itaise/gists{/gist_id}","starred_url":"https://api.github.com/users/itaise/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itaise/subscriptions","organizations_url":"https://api.github.com/users/itaise/orgs","repos_url":"https://api.github.com/users/itaise/repos","events_url":"https://api.github.com/users/itaise/events{/privacy}","received_events_url":"https://api.github.com/users/itaise/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T12:54:40Z","updated_at":"2022-06-22T12:54:40Z","author_association":"NONE","body":"@romibuzi  thanks i will try it out and update!\r\n\r\n@rdblue thanks a lot! What do you mean by updating the table to V2?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163062143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163236562","html_url":"https://github.com/apache/iceberg/issues/4510#issuecomment-1163236562","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4510","id":1163236562,"node_id":"IC_kwDOCW7NX85FVZTS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T15:11:33Z","updated_at":"2022-06-22T15:11:33Z","author_association":"CONTRIBUTOR","body":"@itaise, by default tables use the v1 format, which didn't use unique IDs for partition fields in metadata. That was fixed in v2. So when you upgrade a table to v2, (set the `table-format` property to 2) your changes will actually remove the unnecessary field that references the old column, rather than keeping a placeholder partition field around for it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163236562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163460681","html_url":"https://github.com/apache/iceberg/pull/5077#issuecomment-1163460681","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5077","id":1163460681,"node_id":"IC_kwDOCW7NX85FWQBJ","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T18:20:19Z","updated_at":"2022-06-22T18:20:19Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163460681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163525761","html_url":"https://github.com/apache/iceberg/pull/4847#issuecomment-1163525761","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4847","id":1163525761,"node_id":"IC_kwDOCW7NX85FWf6B","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T19:35:53Z","updated_at":"2022-06-22T19:35:53Z","author_association":"CONTRIBUTOR","body":"I'll have time to take a look today. Sorry for the delay!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163525761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163533152","html_url":"https://github.com/apache/iceberg/pull/5021#issuecomment-1163533152","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5021","id":1163533152,"node_id":"IC_kwDOCW7NX85FWhtg","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T19:44:59Z","updated_at":"2022-06-22T19:44:59Z","author_association":"MEMBER","body":"@rdblue updated this to have one stats file for a table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163533152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163565786","html_url":"https://github.com/apache/iceberg/pull/4817#issuecomment-1163565786","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4817","id":1163565786,"node_id":"IC_kwDOCW7NX85FWpra","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T20:24:40Z","updated_at":"2022-06-22T20:24:40Z","author_association":"CONTRIBUTOR","body":"I can take a look at this after #4652 is in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163565786/reactions","total_count":2,"+1":1,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163566255","html_url":"https://github.com/apache/iceberg/pull/4652#issuecomment-1163566255","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4652","id":1163566255,"node_id":"IC_kwDOCW7NX85FWpyv","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T20:25:15Z","updated_at":"2022-06-22T20:25:15Z","author_association":"CONTRIBUTOR","body":"Let me take another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163566255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163644211","html_url":"https://github.com/apache/iceberg/issues/5058#issuecomment-1163644211","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5058","id":1163644211,"node_id":"IC_kwDOCW7NX85FW80z","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T21:52:43Z","updated_at":"2022-06-22T21:52:43Z","author_association":"COLLABORATOR","body":"I think pr #3990 wont work, it is too much to do in the commit phase, and we need a spark action.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163644211/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163646199","html_url":"https://github.com/apache/iceberg/issues/4127#issuecomment-1163646199","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4127","id":1163646199,"node_id":"IC_kwDOCW7NX85FW9T3","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T21:55:15Z","updated_at":"2022-06-22T21:55:15Z","author_association":"COLLABORATOR","body":"Looks like more people hit this issue.\r\n\r\n@rdblue @aokolnychyi @RussellSpitzer @jackye1995 (or anyone else) fyi if any thoughts on this.  Its probably not a huge issue as delete files will not apply, and we plan eventually to have removeDanglingDeleteFiles, but not sure if we need to document this for time being or any other quick fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163646199/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163769266","html_url":"https://github.com/apache/iceberg/pull/4888#issuecomment-1163769266","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4888","id":1163769266,"node_id":"IC_kwDOCW7NX85FXbWy","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-22T23:37:38Z","updated_at":"2022-06-23T22:05:56Z","author_association":"CONTRIBUTOR","body":"Hi @aokolnychyi and @RussellSpitzer, vectorized read is enabled by default several months ago. But the benchmark still assumes it false by default. I have set it false explicitly, and run the benchmark again. Now we can see the big performance gain between vectorized and non-vectorized read, as the following diagram shows.\r\n<img width=\"996\" alt=\"Screen Shot 2022-06-22 at 4 22 09 PM\" src=\"https://user-images.githubusercontent.com/1322359/175173362-e2e6d636-4e5c-4ed4-bcc5-a8888c6b1e1c.png\">\r\nI also profile the benchmarks. Here is the flame graph for vectorized read with 25% row deleted. It looks normal to me. The program spent majority time to read pos delete file and the data file. The read of position delete file is still non-vectorized, that's why it takes a big portion. Would suggest to enable the vectorized read on delete files to improve the overall perf. That's probably next step we can do.\r\n<img width=\"1543\" alt=\"Screen Shot 2022-06-22 at 4 26 57 PM\" src=\"https://user-images.githubusercontent.com/1322359/175176096-e52048aa-5524-49b8-9645-7cdfdc9463e7.png\">\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163769266/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163781495","html_url":"https://github.com/apache/iceberg/pull/5057#issuecomment-1163781495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5057","id":1163781495,"node_id":"IC_kwDOCW7NX85FXeV3","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T00:02:11Z","updated_at":"2022-06-23T00:02:11Z","author_association":"COLLABORATOR","body":"Sounds good, sorry i am pretty bad at regex, what do you mean:\r\n\r\n> Used [^;]* instead of .*, because this is a multiline search and the dotall regex param (enabled by matchAcrossLines config) is aggressive and this is the best way to break its search.\r\n\r\n> It can be removed and the \"\\s+\" can be enough\r\n\r\nThe [^;]* can be removed?  The purpose now is to not match %d in the Precondition.checkArgument()'s first argument (or is it for something else)?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163781495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163836498","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1163836498","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1163836498,"node_id":"IC_kwDOCW7NX85FXrxS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T01:54:14Z","updated_at":"2022-06-23T01:54:14Z","author_association":"CONTRIBUTOR","body":"> In Flink SQL, data is transferred from one operator to another as a Chanlog Stream.\r\n\r\nThe stream of changes from the debugger screenshot appears incorrect to me. Even if join outputs are modeled this way, there should not be a delete and an insert for ID 2. Why would an unmatched row produce anything from the join?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163836498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163837120","html_url":"https://github.com/apache/iceberg/issues/5069#issuecomment-1163837120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5069","id":1163837120,"node_id":"IC_kwDOCW7NX85FXr7A","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T01:55:28Z","updated_at":"2022-06-23T01:55:28Z","author_association":"CONTRIBUTOR","body":"@felixYyu, is this valid Spark syntax? If not, I don't see how Iceberg would add it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163837120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163837835","html_url":"https://github.com/apache/iceberg/pull/5079#issuecomment-1163837835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5079","id":1163837835,"node_id":"IC_kwDOCW7NX85FXsGL","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T01:56:52Z","updated_at":"2022-06-23T01:56:52Z","author_association":"CONTRIBUTOR","body":"Thanks, @huaxingao!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163837835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163839966","html_url":"https://github.com/apache/iceberg/pull/5079#issuecomment-1163839966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5079","id":1163839966,"node_id":"IC_kwDOCW7NX85FXsne","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T02:01:08Z","updated_at":"2022-06-23T02:01:08Z","author_association":"CONTRIBUTOR","body":"Thank you very much! @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163839966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163854868","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1163854868","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1163854868,"node_id":"IC_kwDOCW7NX85FXwQU","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T02:30:46Z","updated_at":"2022-06-23T02:30:46Z","author_association":"CONTRIBUTOR","body":"> Note: This occurs occasionally.\r\n\r\nDoes this mean that sometimes you get one set of results from the `select *` query and sometimes you get the other set of results listed in your “actual results”?\r\n\r\nThe result set with id = 3 in it twice is concerning to me. When I’ve seen that before, it’s usually a clear sign of an issue. Often times it has occurred because one of the rows has a different kind in it, but it’s coming out on read with the schema without rowkind so then there is duplicate data.\r\n\r\nI cannot confirm that is what is happening here, but I’ve seen that before in other occurrences.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163854868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163858387","html_url":"https://github.com/apache/iceberg/issues/5069#issuecomment-1163858387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5069","id":1163858387,"node_id":"IC_kwDOCW7NX85FXxHT","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T02:37:34Z","updated_at":"2022-06-23T02:37:34Z","author_association":"CONTRIBUTOR","body":"@rdblue, It is not valid Spark syntax, However, there is no way to build a primary key if you create a table using spark syntax.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163858387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163860210","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1163860210","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1163860210,"node_id":"IC_kwDOCW7NX85FXxjy","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T02:41:17Z","updated_at":"2022-06-23T02:41:17Z","author_association":"CONTRIBUTOR","body":"If the INSERT INTO statements are all run one by one, is the result more stable?\r\n\r\nAlso, can you provide the intermediate result set for the LEFT JOIN and then the final result of `upsert_test` (the target table that records are being inserted into?\r\n\r\nIt seems some people are somewhat hung up on the LEFT JOIN result vs the final result.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163860210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163860861","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1163860861","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1163860861,"node_id":"IC_kwDOCW7NX85FXxt9","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T02:42:38Z","updated_at":"2022-06-23T02:42:38Z","author_association":"CONTRIBUTOR","body":"Also, for clarity, in the SELECT statement before the insert, did you mean to use `select upsert_sample.id, upsert_sample.data`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163860861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163863451","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1163863451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1163863451,"node_id":"IC_kwDOCW7NX85FXyWb","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T02:48:01Z","updated_at":"2022-06-23T02:48:01Z","author_association":"CONTRIBUTOR","body":"Also, do you know what the Flink DAG for this looks like? Does `UNIQUE` add a node to the graph that could cause data to wind up seemingly “out of order” by some kind of Union operation being added to satisfy the unique constraint or something?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163863451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163873667","html_url":"https://github.com/apache/iceberg/pull/5061#issuecomment-1163873667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5061","id":1163873667,"node_id":"IC_kwDOCW7NX85FX02D","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T03:09:21Z","updated_at":"2022-06-23T03:09:21Z","author_association":"CONTRIBUTOR","body":"> > In Flink SQL, data is transferred from one operator to another as a Chanlog Stream.\r\n> \r\n> The stream of changes from the debugger screenshot appears incorrect to me. Even if join outputs are modeled this way, there should not be a delete and an insert for ID 2. Why would an unmatched row produce anything from the join?\r\n\r\nI believe we get a +I and -D row in the changelog because a row for ID=2 entered the join and then was not selected for the join. \r\n\r\nAs we’re selecting from `upsert_sample` as the left side of the join (aka t1), that has the row `('2','20220503')` in it. I am wondering if the `unique` keyword is adding an operator to the DAG to cause the left join to have to consider `('2','20220503')` during the join (and thus a temporary +I record) because of the enforced uniqueness constraint.\r\n\r\nSo id=2 is inserted due to its existence in upsert_sample and then deleted because it’s not an output of the join. But it is an input of the join. Is that not what’s happening in the debugger output?\r\n\r\nAlso @hililiwei what happens if you remove the `UNIQUE` constraint? Is that even possible for `id` to the the primary key? And what happens if you `select *` and not specify t1.id and t1.data?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163873667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163915875","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1163915875","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1163915875,"node_id":"IC_kwDOCW7NX85FX_Jj","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T04:30:57Z","updated_at":"2022-06-23T04:30:57Z","author_association":"CONTRIBUTOR","body":"> Let me be clear. In my scene, my machine has 96 cores, when `iceberg.scan.plan-in-worker-pool` is enabled, the `iceberg.worker.num-threads` will be number of available processors in default, i.e. 96. So the input speed of queue is far greater than outpu speed of queue. Then OOM occurs.\r\n\r\nForgive me if I missed this as I’m just coming back to it, but what happens if you lower the core count in iceberg.sc.plan-in-worker-pool via iceberg.worker.num-threads?\r\n\r\nI’ve heard of other issues with machines with very large number of cores.\r\n\r\nMaybe, possibly in addition to this, we might consider a configurable max limit and default it to something sane? The other report was from a Spark driver iirc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163915875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163942570","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1163942570","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1163942570,"node_id":"IC_kwDOCW7NX85FYFqq","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T05:19:08Z","updated_at":"2022-06-23T05:19:08Z","author_association":"CONTRIBUTOR","body":"Also @uncleGen,\r\n\r\nYou might be interested in these two PRs which might help your use case (increase output speed of queue): - https://github.com/apache/iceberg/pull/4911 (merged in master and will be released in 0.14.0)\r\n- https://github.com/apache/iceberg/pull/4943 (yet to be merged but will also help this situation generally speaking)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1163942570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164153523","html_url":"https://github.com/apache/iceberg/pull/5057#issuecomment-1164153523","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5057","id":1164153523,"node_id":"IC_kwDOCW7NX85FY5Kz","user":{"login":"xrl1","id":5931042,"node_id":"MDQ6VXNlcjU5MzEwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/5931042?v=4","gravatar_id":"","url":"https://api.github.com/users/xrl1","html_url":"https://github.com/xrl1","followers_url":"https://api.github.com/users/xrl1/followers","following_url":"https://api.github.com/users/xrl1/following{/other_user}","gists_url":"https://api.github.com/users/xrl1/gists{/gist_id}","starred_url":"https://api.github.com/users/xrl1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xrl1/subscriptions","organizations_url":"https://api.github.com/users/xrl1/orgs","repos_url":"https://api.github.com/users/xrl1/repos","events_url":"https://api.github.com/users/xrl1/events{/privacy}","received_events_url":"https://api.github.com/users/xrl1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T09:08:47Z","updated_at":"2022-06-23T09:08:47Z","author_association":"CONTRIBUTOR","body":"@szehon-ho I'll explain a little bit more:\r\nAs requested, I used a multi-line regex search as asked, and I set `matchAcrossLines` to `true` to enable \"DOTALL flag\" as we don't know on which line the \"%d\" expression will appear after the function call.\r\nOnce this value is set, if I insert `.*` before the `%d` in the expression (to match the first argument to `checkArgument`, and not only to skip `%d` in it as you asked), it will search for matches for the second part of the regex, in all the file, even after checkArugment statement.\r\nFor example:\r\n```\r\nPreconditions.checkArgument(partitionFields.size() >= 1, \"some text %s\", 1);\r\nsomeOtherFunc(\"%d\", 100);\r\n```\r\nmight be mistakenly matched.\r\n\r\nTo avoid matching it, the `[^;]` will terminate the search upon the first `;` it encounters, and problem solved.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164153523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164155161","html_url":"https://github.com/apache/iceberg/pull/5057#issuecomment-1164155161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5057","id":1164155161,"node_id":"IC_kwDOCW7NX85FY5kZ","user":{"login":"xrl1","id":5931042,"node_id":"MDQ6VXNlcjU5MzEwNDI=","avatar_url":"https://avatars.githubusercontent.com/u/5931042?v=4","gravatar_id":"","url":"https://api.github.com/users/xrl1","html_url":"https://github.com/xrl1","followers_url":"https://api.github.com/users/xrl1/followers","following_url":"https://api.github.com/users/xrl1/following{/other_user}","gists_url":"https://api.github.com/users/xrl1/gists{/gist_id}","starred_url":"https://api.github.com/users/xrl1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xrl1/subscriptions","organizations_url":"https://api.github.com/users/xrl1/orgs","repos_url":"https://api.github.com/users/xrl1/repos","events_url":"https://api.github.com/users/xrl1/events{/privacy}","received_events_url":"https://api.github.com/users/xrl1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T09:10:28Z","updated_at":"2022-06-23T09:10:28Z","author_association":"CONTRIBUTOR","body":"Updated the PR again, and now also tested the build locally to pass, sorry for that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164155161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164188977","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1164188977","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1164188977,"node_id":"IC_kwDOCW7NX85FZB0x","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T09:43:26Z","updated_at":"2022-06-23T09:43:26Z","author_association":"CONTRIBUTOR","body":"I also want to mention that if `close` and `hasNext` in ParallelIterator are called concurrently, there might be thread safety issues, e.g. new tasks submitted during close can be leaked in the pool. I think it's safer to make the producer thread periodically check the `closed` flag, rather than block on the queue forever.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164188977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164317922","html_url":"https://github.com/apache/iceberg/pull/5094#issuecomment-1164317922","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5094","id":1164317922,"node_id":"IC_kwDOCW7NX85FZhTi","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T11:57:44Z","updated_at":"2022-06-23T11:57:44Z","author_association":"CONTRIBUTOR","body":"Thanks @RussellSpitzer, for the feedbacks, have addressed most of them and reverted on the rest\r\n\r\nHere is the updated gist post addressing feedbacks: https://gist.github.com/singhpk234/640953c2658a6b16fa94c60c8066c4c0","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164317922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164328125","html_url":"https://github.com/apache/iceberg/pull/5033#issuecomment-1164328125","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5033","id":1164328125,"node_id":"IC_kwDOCW7NX85FZjy9","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T12:09:18Z","updated_at":"2022-06-23T12:09:18Z","author_association":"CONTRIBUTOR","body":"Merged to master.\r\nThanks for the work @ajantha-bhat and @snazy and @nastra for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164328125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164330308","html_url":"https://github.com/apache/iceberg/pull/5033#issuecomment-1164330308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5033","id":1164330308,"node_id":"IC_kwDOCW7NX85FZkVE","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T12:11:47Z","updated_at":"2022-06-23T12:12:00Z","author_association":"MEMBER","body":"@pvary : Thanks for the merge and review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164330308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164331302","html_url":"https://github.com/apache/iceberg/pull/4945#issuecomment-1164331302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4945","id":1164331302,"node_id":"IC_kwDOCW7NX85FZkkm","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T12:12:49Z","updated_at":"2022-06-23T12:12:49Z","author_association":"MEMBER","body":"@rdblue updated this to have one stats file for a table.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164331302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164381627","html_url":"https://github.com/apache/iceberg/pull/5048#issuecomment-1164381627","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5048","id":1164381627,"node_id":"IC_kwDOCW7NX85FZw27","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T13:02:28Z","updated_at":"2022-06-23T13:02:28Z","author_association":"MEMBER","body":"I think I don't know how to fix the iceberg-mr classpath to include jackson databind, with the right version.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164381627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164477703","html_url":"https://github.com/apache/iceberg/issues/5122#issuecomment-1164477703","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5122","id":1164477703,"node_id":"IC_kwDOCW7NX85FaIUH","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T14:26:21Z","updated_at":"2022-06-23T14:26:21Z","author_association":"CONTRIBUTOR","body":"Hi @THUMarkLau, currently there is no C++ Iceberg client but it's been recently discussed on the Iceberg dev list and a number of people are in support of developing one (as well as a Rust client). It's an effort that would take some time and significant community support, as well as a compatibility framework as @emkornfield suggested.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164477703/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164612148","html_url":"https://github.com/apache/iceberg/pull/4817#issuecomment-1164612148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4817","id":1164612148,"node_id":"IC_kwDOCW7NX85FapI0","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T16:15:21Z","updated_at":"2022-06-23T16:15:21Z","author_association":"MEMBER","body":"> I can take a look at this after #4652 is in.\r\n\r\nSame","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164612148/reactions","total_count":2,"+1":1,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164719475","html_url":"https://github.com/apache/iceberg/pull/5125#issuecomment-1164719475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5125","id":1164719475,"node_id":"IC_kwDOCW7NX85FbDVz","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T18:10:06Z","updated_at":"2022-06-23T18:10:06Z","author_association":"CONTRIBUTOR","body":"This looks good to me.\r\n\r\nFor anyone looking at this later, the context is that we no longer need to create a client per table now that the Authorization HTTP header is handled by sessions rather than by client. That was the purpose of adding sessions, since we don't need to create a different client (and connection pool) for every auth session.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164719475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164777716","html_url":"https://github.com/apache/iceberg/pull/5125#issuecomment-1164777716","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5125","id":1164777716,"node_id":"IC_kwDOCW7NX85FbRj0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T19:16:54Z","updated_at":"2022-06-23T19:16:54Z","author_association":"CONTRIBUTOR","body":"Thanks, @danielcweeks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164777716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164820988","html_url":"https://github.com/apache/iceberg/pull/4847#issuecomment-1164820988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4847","id":1164820988,"node_id":"IC_kwDOCW7NX85FbcH8","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T20:08:32Z","updated_at":"2022-06-23T20:08:32Z","author_association":"COLLABORATOR","body":"Thanks for review, addressed the round of comments","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164820988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164859981","html_url":"https://github.com/apache/iceberg/pull/5115#issuecomment-1164859981","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5115","id":1164859981,"node_id":"IC_kwDOCW7NX85FblpN","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T20:49:13Z","updated_at":"2022-06-23T20:49:13Z","author_association":"CONTRIBUTOR","body":"Looks good. Thanks, @samredai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164859981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164885578","html_url":"https://github.com/apache/iceberg/pull/5034#issuecomment-1164885578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5034","id":1164885578,"node_id":"IC_kwDOCW7NX85Fbr5K","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T21:22:36Z","updated_at":"2022-06-23T21:22:36Z","author_association":"CONTRIBUTOR","body":"@rdblue Why do we need to set `setMaxSnapshotAgeMs(\"branch\", Long.MAX_VALUE)` in the test case ? anyway the snapshots still referenced by a branch will be added to referenced snapshots.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164885578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164901986","html_url":"https://github.com/apache/iceberg/pull/5118#issuecomment-1164901986","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5118","id":1164901986,"node_id":"IC_kwDOCW7NX85Fbv5i","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T21:34:47Z","updated_at":"2022-06-23T21:34:47Z","author_association":"CONTRIBUTOR","body":"Not sure why the Flink CI suite was cancelled after many hours, so I’m going to close and reopen to have CI run again.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164901986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164904208","html_url":"https://github.com/apache/iceberg/pull/5118#issuecomment-1164904208","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5118","id":1164904208,"node_id":"IC_kwDOCW7NX85FbwcQ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T21:38:05Z","updated_at":"2022-06-23T21:38:13Z","author_association":"CONTRIBUTOR","body":"Since we’re only testing `LoadTableResponse` here and not `TableMetadata` specifically, it might be better to write the JSON out as external files and use `TableMetadataParser` after reading them in.\r\n\r\nWe’d still be building the `LoadTableResponse` via the builder and testing that, but we wouldn’t need to create the `TableMetadata` instances programmatically.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164904208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164907954","html_url":"https://github.com/apache/iceberg/pull/5118#issuecomment-1164907954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5118","id":1164907954,"node_id":"IC_kwDOCW7NX85FbxWy","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T21:43:09Z","updated_at":"2022-06-23T21:43:09Z","author_association":"CONTRIBUTOR","body":"On reflecting on this a bit, I think writing the JSON out into test files and then parsing it is probably the ideal way to go, given we’re not testing `TableMetadata` here specifically, just `LoadTableResponse`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164907954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164925668","html_url":"https://github.com/apache/iceberg/pull/5057#issuecomment-1164925668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5057","id":1164925668,"node_id":"IC_kwDOCW7NX85Fb1rk","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T22:05:03Z","updated_at":"2022-06-23T22:05:03Z","author_association":"COLLABORATOR","body":"@xrl1 thanks for the explanation for those points.  How about the last point:\r\n\r\n> Added the quote and comma to avoid matching the first argument, but I can simplify the regex and not handle the edge cases where there is \"%d\" in the first argument\r\n\r\nDo you think we should simplify this?  I don't see much possibility of %d in the first argument of Precondition (which is evaluating a boolean), other than a modulo operation but in that case there is a space after %.  Or let me know if I missed what you mean.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164925668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164978717","html_url":"https://github.com/apache/iceberg/pull/5126#issuecomment-1164978717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5126","id":1164978717,"node_id":"IC_kwDOCW7NX85FcCod","user":{"login":"hmit","id":1560613,"node_id":"MDQ6VXNlcjE1NjA2MTM=","avatar_url":"https://avatars.githubusercontent.com/u/1560613?v=4","gravatar_id":"","url":"https://api.github.com/users/hmit","html_url":"https://github.com/hmit","followers_url":"https://api.github.com/users/hmit/followers","following_url":"https://api.github.com/users/hmit/following{/other_user}","gists_url":"https://api.github.com/users/hmit/gists{/gist_id}","starred_url":"https://api.github.com/users/hmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hmit/subscriptions","organizations_url":"https://api.github.com/users/hmit/orgs","repos_url":"https://api.github.com/users/hmit/repos","events_url":"https://api.github.com/users/hmit/events{/privacy}","received_events_url":"https://api.github.com/users/hmit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T22:35:17Z","updated_at":"2022-06-23T22:35:17Z","author_association":"CONTRIBUTOR","body":"I discovered this after switching to `ParquetWriter` from iceberg project.\r\nWithout this, we see [this log message](https://github.com/rdblue/brotli-codec/blob/master/src/main/java/org/apache/hadoop/io/compress/brotli/BrotliCompressor.java#L249) when using Brotli compression to write data files to iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164978717/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164982089","html_url":"https://github.com/apache/iceberg/pull/4812#issuecomment-1164982089","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4812","id":1164982089,"node_id":"IC_kwDOCW7NX85FcDdJ","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T22:41:09Z","updated_at":"2022-06-23T22:41:18Z","author_association":"COLLABORATOR","body":"Added partition column and got filter push down working, with all the partition spec evolution scenarios.  Added a lot of tests in dedicated file (TestPositionDeletesTable).\r\n\r\nWill look to see how to incorporate #5077 when it is in.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1164982089/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165014228","html_url":"https://github.com/apache/iceberg/pull/4943#issuecomment-1165014228","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4943","id":1165014228,"node_id":"IC_kwDOCW7NX85FcLTU","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-23T23:38:47Z","updated_at":"2022-06-23T23:38:47Z","author_association":"COLLABORATOR","body":"@rdblue @kbendick, Could you please take another look? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165014228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165055509","html_url":"https://github.com/apache/iceberg/pull/5113#issuecomment-1165055509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5113","id":1165055509,"node_id":"IC_kwDOCW7NX85FcVYV","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T00:56:48Z","updated_at":"2022-06-24T01:14:02Z","author_association":"COLLABORATOR","body":"By the way, was experimenting and was wondering, are comparison for struct literal expected to be supported in Spark?  \r\n\r\nToday in Spark on Iceberg table, we get:\r\n\r\nselect * from table where table.struct_field = struct(10)\r\n> org.apache.spark.sql.AnalysisException: cannot resolve '(table.struct_field = struct(10))' due to data type mismatch: differing types in '(table.struct_field = struct(1))' (struct<nested:int> and struct<col1:int>).; line 1 pos 39;\r\n\r\n\r\nselect * from table where table.struct_field in (struct(10))\r\n```\r\njava.lang.IllegalArgumentException: Cannot create expression literal from org.apache.spark.sql.catalyst.expressions.GenericRowWithSchema: [1]\r\n  at org.apache.iceberg.expressions.Literals.from(Literals.java:87)\r\n  at org.apache.iceberg.expressions.UnboundPredicate.<init>(UnboundPredicate.java:40)\r\n  at org.apache.iceberg.expressions.Expressions.equal(Expressions.java:175)\r\n  at org.apache.iceberg.spark.SparkFilters.handleEqual(SparkFilters.java:239)\r\n  at org.apache.iceberg.spark.SparkFilters.convert(SparkFilters.java:152)\r\n  at org.apache.iceberg.spark.source.SparkScanBuilder.pushFilters(SparkScanBuilder.java:106)\r\n  at org.apache.spark.sql.execution.datasources.v2.PushDownUtils$.pushFilters(PushDownUtils.scala:69)\r\n  at org.apache.spark.sql.execution.datasources.v2.V2ScanRelationPushDown$$anonfun$pushDownFilters$1.applyOrElse(V2ScanRelationPushDown.scala:60)\r\n  at org.apache.spark.sql.execution.datasources.v2.V2ScanRelationPushDown$$anonfun$pushDownFilters$1.applyOrElse(V2ScanRelationPushDown.scala:47)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165055509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165098128","html_url":"https://github.com/apache/iceberg/issues/5122#issuecomment-1165098128","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5122","id":1165098128,"node_id":"IC_kwDOCW7NX85FcfyQ","user":{"login":"a49a","id":12015546,"node_id":"MDQ6VXNlcjEyMDE1NTQ2","avatar_url":"https://avatars.githubusercontent.com/u/12015546?v=4","gravatar_id":"","url":"https://api.github.com/users/a49a","html_url":"https://github.com/a49a","followers_url":"https://api.github.com/users/a49a/followers","following_url":"https://api.github.com/users/a49a/following{/other_user}","gists_url":"https://api.github.com/users/a49a/gists{/gist_id}","starred_url":"https://api.github.com/users/a49a/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/a49a/subscriptions","organizations_url":"https://api.github.com/users/a49a/orgs","repos_url":"https://api.github.com/users/a49a/repos","events_url":"https://api.github.com/users/a49a/events{/privacy}","received_events_url":"https://api.github.com/users/a49a/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T01:51:51Z","updated_at":"2022-06-24T01:51:51Z","author_association":"CONTRIBUTOR","body":"In the future, we can support a Rust SDK.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165098128/reactions","total_count":16,"+1":16,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165168440","html_url":"https://github.com/apache/iceberg/issues/4092#issuecomment-1165168440","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4092","id":1165168440,"node_id":"IC_kwDOCW7NX85Fcw84","user":{"login":"HamaWhiteGG","id":97529774,"node_id":"U_kgDOBdAvrg","avatar_url":"https://avatars.githubusercontent.com/u/97529774?v=4","gravatar_id":"","url":"https://api.github.com/users/HamaWhiteGG","html_url":"https://github.com/HamaWhiteGG","followers_url":"https://api.github.com/users/HamaWhiteGG/followers","following_url":"https://api.github.com/users/HamaWhiteGG/following{/other_user}","gists_url":"https://api.github.com/users/HamaWhiteGG/gists{/gist_id}","starred_url":"https://api.github.com/users/HamaWhiteGG/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HamaWhiteGG/subscriptions","organizations_url":"https://api.github.com/users/HamaWhiteGG/orgs","repos_url":"https://api.github.com/users/HamaWhiteGG/repos","events_url":"https://api.github.com/users/HamaWhiteGG/events{/privacy}","received_events_url":"https://api.github.com/users/HamaWhiteGG/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T04:01:28Z","updated_at":"2022-06-24T04:01:28Z","author_association":"NONE","body":"you should add 'catalog-table' = 'iceberg_table'  when create all_users_sink, then it will run ok","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165168440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165168632","html_url":"https://github.com/apache/iceberg/issues/4092#issuecomment-1165168632","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4092","id":1165168632,"node_id":"IC_kwDOCW7NX85Fcw_4","user":{"login":"gcnote","id":10720842,"node_id":"MDQ6VXNlcjEwNzIwODQy","avatar_url":"https://avatars.githubusercontent.com/u/10720842?v=4","gravatar_id":"","url":"https://api.github.com/users/gcnote","html_url":"https://github.com/gcnote","followers_url":"https://api.github.com/users/gcnote/followers","following_url":"https://api.github.com/users/gcnote/following{/other_user}","gists_url":"https://api.github.com/users/gcnote/gists{/gist_id}","starred_url":"https://api.github.com/users/gcnote/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gcnote/subscriptions","organizations_url":"https://api.github.com/users/gcnote/orgs","repos_url":"https://api.github.com/users/gcnote/repos","events_url":"https://api.github.com/users/gcnote/events{/privacy}","received_events_url":"https://api.github.com/users/gcnote/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T04:01:50Z","updated_at":"2022-06-24T04:01:50Z","author_association":"NONE","body":"您好，您发的邮件我已收到，谢谢！！！","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165168632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165251411","html_url":"https://github.com/apache/iceberg/issues/4471#issuecomment-1165251411","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4471","id":1165251411,"node_id":"IC_kwDOCW7NX85FdFNT","user":{"login":"eric666666","id":51162281,"node_id":"MDQ6VXNlcjUxMTYyMjgx","avatar_url":"https://avatars.githubusercontent.com/u/51162281?v=4","gravatar_id":"","url":"https://api.github.com/users/eric666666","html_url":"https://github.com/eric666666","followers_url":"https://api.github.com/users/eric666666/followers","following_url":"https://api.github.com/users/eric666666/following{/other_user}","gists_url":"https://api.github.com/users/eric666666/gists{/gist_id}","starred_url":"https://api.github.com/users/eric666666/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eric666666/subscriptions","organizations_url":"https://api.github.com/users/eric666666/orgs","repos_url":"https://api.github.com/users/eric666666/repos","events_url":"https://api.github.com/users/eric666666/events{/privacy}","received_events_url":"https://api.github.com/users/eric666666/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T06:37:37Z","updated_at":"2022-06-24T06:37:37Z","author_association":"NONE","body":"> @eric666666 改了下确实可以，local模式不会阻塞了。另外有个问题请教下，我在合并小文件时，对于分区表老是有些等值删除文件没有清理掉，导致小文件很多。如果对表做一次比较重的数据文件重写（比如设定的条件能覆盖到所有分区的所有数据文件）有可能就清理掉了，但这么做代价太高了。难道也是local模式下才会这样？on yarn或on k8s能正常清理掉？\r\n\r\n我们可以加下好友交流下，eq-delete file和pos-delete file，重写后，过期快照不删除的问题，我一直再尝试修，目前还没有能解决","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165251411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165258548","html_url":"https://github.com/apache/iceberg/pull/5113#issuecomment-1165258548","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5113","id":1165258548,"node_id":"IC_kwDOCW7NX85FdG80","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T06:48:35Z","updated_at":"2022-06-24T06:48:35Z","author_association":"CONTRIBUTOR","body":"> are comparison for struct literal expected to be supported in Spark?\r\n\r\nIt's not supported in Spark.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165258548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165260229","html_url":"https://github.com/apache/iceberg/pull/5113#issuecomment-1165260229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5113","id":1165260229,"node_id":"IC_kwDOCW7NX85FdHXF","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T06:51:07Z","updated_at":"2022-06-24T06:51:07Z","author_association":"CONTRIBUTOR","body":"@szehon-ho Thank you very much for your review! I have addressed the comments. Could you please take one more look when you have a chance?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165260229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165433241","html_url":"https://github.com/apache/iceberg/pull/5021#issuecomment-1165433241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5021","id":1165433241,"node_id":"IC_kwDOCW7NX85FdxmZ","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T10:24:01Z","updated_at":"2022-06-24T10:24:01Z","author_association":"MEMBER","body":"Per offline ask from @rdblue , I extracted prep change here: https://github.com/apache/iceberg/pull/5129","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165433241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165711374","html_url":"https://github.com/apache/iceberg/pull/5024#issuecomment-1165711374","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5024","id":1165711374,"node_id":"IC_kwDOCW7NX85Fe1gO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T15:58:22Z","updated_at":"2022-06-24T15:58:22Z","author_association":"CONTRIBUTOR","body":"@pan3793, Iceberg should declare its dependencies correctly. If you want to use a shaded version downstream, you can exclude and change the dependency tree.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165711374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165715545","html_url":"https://github.com/apache/iceberg/pull/4943#issuecomment-1165715545","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4943","id":1165715545,"node_id":"IC_kwDOCW7NX85Fe2hZ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T16:03:16Z","updated_at":"2022-06-24T16:03:16Z","author_association":"CONTRIBUTOR","body":"Thanks, @chenjunjiedada! Nice work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165715545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165716433","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1165716433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1165716433,"node_id":"IC_kwDOCW7NX85Fe2vR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T16:04:14Z","updated_at":"2022-06-24T16:04:14Z","author_association":"CONTRIBUTOR","body":"@lirui-apache, do you want to open a PR for that fix?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165716433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165717805","html_url":"https://github.com/apache/iceberg/pull/5108#issuecomment-1165717805","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5108","id":1165717805,"node_id":"IC_kwDOCW7NX85Fe3Et","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T16:05:47Z","updated_at":"2022-06-24T16:05:47Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi can you rebase?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165717805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165718421","html_url":"https://github.com/apache/iceberg/pull/5070#issuecomment-1165718421","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5070","id":1165718421,"node_id":"IC_kwDOCW7NX85Fe3OV","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T16:06:25Z","updated_at":"2022-06-24T16:06:25Z","author_association":"CONTRIBUTOR","body":"Thanks, @williamhyun!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165718421/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165734284","html_url":"https://github.com/apache/iceberg/pull/5113#issuecomment-1165734284","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5113","id":1165734284,"node_id":"IC_kwDOCW7NX85Fe7GM","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T16:25:27Z","updated_at":"2022-06-24T16:29:03Z","author_association":"COLLABORATOR","body":"> It's not supported in Spark.\r\n\r\nDo you know if that is documented somewhere?  Actually I tried on Spark non-Iceberg table and it seems to support it.  Now, I am just wondering whether we should somehow skip pushing these filters into Iceberg in the first place so we don't block these kind of queries from being evaluated on Spark?\r\n\r\n```\r\nspark.sql(\"select * from test_struct_non_iceberg where struct_field in(struct(10))\").show\r\n+------------+\r\n|struct_field|\r\n+------------+\r\n|        {10}|\r\n+------------+\r\n\r\n\r\nscala> spark.sql(\"select * from test_struct_non_iceberg where struct_field = struct(10)\").show\r\n+------------+\r\n|struct_field|\r\n+------------+\r\n|        {10}|\r\n+------------+\r\n```\r\n\r\nNote: it's all orthogonal to this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165734284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165747848","html_url":"https://github.com/apache/iceberg/issues/2468#issuecomment-1165747848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2468","id":1165747848,"node_id":"IC_kwDOCW7NX85Fe-aI","user":{"login":"jtLiBrain","id":45853763,"node_id":"MDQ6VXNlcjQ1ODUzNzYz","avatar_url":"https://avatars.githubusercontent.com/u/45853763?v=4","gravatar_id":"","url":"https://api.github.com/users/jtLiBrain","html_url":"https://github.com/jtLiBrain","followers_url":"https://api.github.com/users/jtLiBrain/followers","following_url":"https://api.github.com/users/jtLiBrain/following{/other_user}","gists_url":"https://api.github.com/users/jtLiBrain/gists{/gist_id}","starred_url":"https://api.github.com/users/jtLiBrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtLiBrain/subscriptions","organizations_url":"https://api.github.com/users/jtLiBrain/orgs","repos_url":"https://api.github.com/users/jtLiBrain/repos","events_url":"https://api.github.com/users/jtLiBrain/events{/privacy}","received_events_url":"https://api.github.com/users/jtLiBrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T16:41:48Z","updated_at":"2022-06-24T16:41:48Z","author_association":"NONE","body":"> I build a jar file from master branch. when i create a hive catalog on flink sql client ,it comes a problem.\r\n> \r\n> **the SQL is :**\r\n> \r\n> ```\r\n> drop catalog if exists iceberg_catalog;\r\n> CREATE CATALOG iceberg_catalog WITH (\r\n>   'type'='iceberg',\r\n>   'catalog-type'='hive',\r\n>   'uri'='thrift://xxx1:9083,thrift://xxx2:9083',\r\n>   'clients'='5',\r\n>   'property-version'='1',\r\n>   'warehouse'='hdfs://hacluster/user/hive/warehouse'\r\n> );\r\n> ```\r\n> \r\n> **error info:**\r\n> \r\n> ```\r\n> java.lang.IllegalArgumentException: Cannot initialize Catalog, org.apache.iceberg.hive.HiveCatalog does not implement Catalog.\r\n> \tat org.apache.iceberg.CatalogUtil.loadCatalog(CatalogUtil.java:176)\r\n> \tat org.apache.iceberg.flink.CatalogLoader$HiveCatalogLoader.loadCatalog(CatalogLoader.java:112)\r\n> \tat org.apache.iceberg.flink.FlinkCatalog.<init>(FlinkCatalog.java:110)\r\n> \tat org.apache.iceberg.flink.FlinkCatalogFactory.createCatalog(FlinkCatalogFactory.java:130)\r\n> \tat org.apache.iceberg.flink.FlinkCatalogFactory.createCatalog(FlinkCatalogFactory.java:117)\r\n> \tat org.apache.flink.table.api.internal.TableEnvironmentImpl.createCatalog(TableEnvironmentImpl.java:1085)\r\n> \tat org.apache.flink.table.api.internal.TableEnvironmentImpl.executeOperation(TableEnvironmentImpl.java:1019)\r\n> \tat org.apache.flink.table.api.internal.TableEnvironmentImpl.executeSql(TableEnvironmentImpl.java:690)\r\n> \tat org.apache.zeppelin.flink.Flink111Shims.executeSql(Flink111Shims.java:374)\r\n> \tat org.apache.zeppelin.flink.FlinkSqlInterrpeter.callCreateCatalog(FlinkSqlInterrpeter.java:391)\r\n> \tat org.apache.zeppelin.flink.FlinkSqlInterrpeter.callCommand(FlinkSqlInterrpeter.java:244)\r\n> \tat org.apache.zeppelin.flink.FlinkSqlInterrpeter.runSqlList(FlinkSqlInterrpeter.java:151)\r\n> \tat org.apache.zeppelin.flink.FlinkSqlInterrpeter.internalInterpret(FlinkSqlInterrpeter.java:111)\r\n> \tat org.apache.zeppelin.interpreter.AbstractInterpreter.interpret(AbstractInterpreter.java:47)\r\n> \tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:110)\r\n> \tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:808)\r\n> \tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:700)\r\n> \tat org.apache.zeppelin.scheduler.Job.run(Job.java:172)\r\n> \tat org.apache.zeppelin.scheduler.AbstractScheduler.runJob(AbstractScheduler.java:132)\r\n> \tat org.apache.zeppelin.scheduler.ParallelScheduler.lambda$runJobInScheduler$0(ParallelScheduler.java:46)\r\n> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n> \tat java.lang.Thread.run(Thread.java:748)\r\n> Caused by: java.lang.ClassCastException: org.apache.iceberg.hive.HiveCatalog cannot be cast to org.apache.iceberg.catalog.Catalog\r\n> \tat org.apache.iceberg.CatalogUtil.loadCatalog(CatalogUtil.java:172)\r\n> \t... 22 more\r\n> ```\r\n> \r\n> but when i'm using iceberg-flink-runtime-0.11.1.jar . it‘s seems ok. could you tell me how to fix this.\r\n\r\nI got the same exception when i use iceberg in Zeppline","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165747848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165775556","html_url":"https://github.com/apache/iceberg/issues/4471#issuecomment-1165775556","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4471","id":1165775556,"node_id":"IC_kwDOCW7NX85FfFLE","user":{"login":"peterxiong13","id":40230517,"node_id":"MDQ6VXNlcjQwMjMwNTE3","avatar_url":"https://avatars.githubusercontent.com/u/40230517?v=4","gravatar_id":"","url":"https://api.github.com/users/peterxiong13","html_url":"https://github.com/peterxiong13","followers_url":"https://api.github.com/users/peterxiong13/followers","following_url":"https://api.github.com/users/peterxiong13/following{/other_user}","gists_url":"https://api.github.com/users/peterxiong13/gists{/gist_id}","starred_url":"https://api.github.com/users/peterxiong13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peterxiong13/subscriptions","organizations_url":"https://api.github.com/users/peterxiong13/orgs","repos_url":"https://api.github.com/users/peterxiong13/repos","events_url":"https://api.github.com/users/peterxiong13/events{/privacy}","received_events_url":"https://api.github.com/users/peterxiong13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T17:16:56Z","updated_at":"2022-06-24T17:16:56Z","author_association":"NONE","body":"> > @eric666666 改了下确实可以，local模式不会阻塞了。另外有个问题请教下，我在合并小文件时，对于分区表老是有些等值删除文件没有清理掉，导致小文件很多。如果对表做一次比较重的数据文件重写（比如设定的条件能覆盖到所有分区的所有数据文件）有可能就清理掉了，但这么做代价太高了。难道也是local模式下才会这样？on yarn或on k8s能正常清理掉？\r\n> \r\n> 我们可以加下好友交流下，eq-delete file和pos-delete file，重写后，过期快照不删除的问题，我一直再尝试修，目前还没有能解决\r\n\r\n好啊，qq：4612815\r\n我想我已经找到原因了，qq上详聊","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165775556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165787979","html_url":"https://github.com/apache/iceberg/pull/5126#issuecomment-1165787979","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5126","id":1165787979,"node_id":"IC_kwDOCW7NX85FfINL","user":{"login":"hmit","id":1560613,"node_id":"MDQ6VXNlcjE1NjA2MTM=","avatar_url":"https://avatars.githubusercontent.com/u/1560613?v=4","gravatar_id":"","url":"https://api.github.com/users/hmit","html_url":"https://github.com/hmit","followers_url":"https://api.github.com/users/hmit/followers","following_url":"https://api.github.com/users/hmit/following{/other_user}","gists_url":"https://api.github.com/users/hmit/gists{/gist_id}","starred_url":"https://api.github.com/users/hmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hmit/subscriptions","organizations_url":"https://api.github.com/users/hmit/orgs","repos_url":"https://api.github.com/users/hmit/repos","events_url":"https://api.github.com/users/hmit/events{/privacy}","received_events_url":"https://api.github.com/users/hmit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T17:33:17Z","updated_at":"2022-06-24T17:33:17Z","author_association":"CONTRIBUTOR","body":"> +1. Good catch @hmit!\r\n> \r\n> I tried to find a place where this could be tested, but there didn't seem to be anywhere that was already testing whether or not things were closed so I think it's fine without it.\r\n\r\nYeah, I didn't find a good unit-test to add this to. However, we did test it by deploying (with brotli compression) and it seems to do the trick.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165787979/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165787994","html_url":"https://github.com/apache/iceberg/pull/5036#issuecomment-1165787994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5036","id":1165787994,"node_id":"IC_kwDOCW7NX85FfINa","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T17:33:19Z","updated_at":"2022-06-24T17:33:19Z","author_association":"COLLABORATOR","body":"> Since Hive 4 is around the release, we might try to add a checkAndSet method to the HMS API for setting the metadata_location atomically. This could be the ultimate solution for the issue, if we find this fix important.\r\n\r\nI think that would be awesome.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165787994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165848916","html_url":"https://github.com/apache/iceberg/pull/5129#issuecomment-1165848916","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5129","id":1165848916,"node_id":"IC_kwDOCW7NX85FfXFU","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T18:57:48Z","updated_at":"2022-06-24T18:57:48Z","author_association":"CONTRIBUTOR","body":"Mostly looks good. Just need to agree on and fix the names.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165848916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165953564","html_url":"https://github.com/apache/iceberg/pull/5113#issuecomment-1165953564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5113","id":1165953564,"node_id":"IC_kwDOCW7NX85Ffwoc","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T21:27:27Z","updated_at":"2022-06-24T21:27:27Z","author_association":"CONTRIBUTOR","body":"Sorry, I was wrong, Spark actually supports nested types comparison. I didn't construct the struct literal correctly when I tried the struct comparison earlier. I checked again just now and it works OK for me.\r\n\r\nI need to rethink about this PR. I will close this for now and reopen when I am ready. Thanks a lot for helping me on this! @szehon-ho \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1165953564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1166054249","html_url":"https://github.com/apache/iceberg/pull/5131#issuecomment-1166054249","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5131","id":1166054249,"node_id":"IC_kwDOCW7NX85FgJNp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T23:00:46Z","updated_at":"2022-06-24T23:00:46Z","author_association":"CONTRIBUTOR","body":"FYI @bryanck and @ajreid21","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1166054249/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1166061421","html_url":"https://github.com/apache/iceberg/pull/5130#issuecomment-1166061421","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5130","id":1166061421,"node_id":"IC_kwDOCW7NX85FgK9t","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-24T23:20:16Z","updated_at":"2022-06-24T23:20:16Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1166061421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]