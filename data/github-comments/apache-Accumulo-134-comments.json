[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101263285","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2101263285","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2101263285,"node_id":"IC_kwDOACaFSM59Pru1","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T19:16:31Z","updated_at":"2024-05-08T19:16:31Z","author_association":"CONTRIBUTOR","body":"The LoggingMetrics are useful for development and testing, but in production, another solution should be used - statsD, Prometheus should be two that we strive to support. Trying a different collection system may be informative.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101263285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101301730","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2101301730","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2101301730,"node_id":"IC_kwDOACaFSM59P1Hi","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T19:41:31Z","updated_at":"2024-05-08T19:43:38Z","author_association":"MEMBER","body":"> I believe the `accumulo.fate.ops.in.progress.by.type` were modeled on a monotonically increasing counter and then should not be reset. Not sure about the reporting through.\r\n\r\nIt just seems like a bug that it is continually reported as being in progress on a certain step when it has already completed.\r\n\r\n> The FATE metrics should provide a window / snapshot into system activity. If the UserFateStore/FATE table is necessary for a complete view - then yes, it should be included.\r\n\r\nThe UserFateStore includes the fate transactions on user tables (user creating a table, user compacting a table, etc.), so this may or may not be a part of \"system activity\" (I'm just not sure what is/isn't considered system activity)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101301730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101314882","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2101314882","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2101314882,"node_id":"IC_kwDOACaFSM59P4VC","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T19:50:25Z","updated_at":"2024-05-08T19:50:25Z","author_association":"CONTRIBUTOR","body":"`It just seems like a bug that it is continually reported as being in progress on a certain step when it has already completed.`\r\n\r\nAre you questioning the reporting or the value?  If it is a counter, then systems like Prometheus will end up calculating the delta between measurements.  If it should be a gauge, then yes, it should be reset","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101314882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101324257","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2101324257","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2101324257,"node_id":"IC_kwDOACaFSM59P6nh","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T19:57:06Z","updated_at":"2024-05-08T20:00:18Z","author_association":"CONTRIBUTOR","body":"`I'm just not sure what is/isn't considered system activity`\r\n\r\nMy interpretation is anything that is occurring.  While users may want visibility into specific Accumulo internals (say metadata, gc...) Overall what they care about is how is Accumulo performing - is it ingesting data when received in a timely fashion? Are user queries being served, and returned?  Is the system under strain and are there specific bottlenecks or failures?  Are compactions running and completing as expected.  Are files being deleted as intended so they don't run out of space ....\r\n\r\nThe metrics should be able to answer these types of questions as well as provide feedback for tuning system parameters.  Increasing number of threads for... Allocating more memory to... Adding / decreasing compactors, scan servers, tservers to provide enough capability in an efficient maner","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101324257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101341880","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2101341880","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2101341880,"node_id":"IC_kwDOACaFSM59P-64","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T20:08:29Z","updated_at":"2024-05-08T20:08:29Z","author_association":"MEMBER","body":"> `It just seems like a bug that it is continually reported as being in progress on a certain step when it has already completed.`\r\n> \r\n> Are you questioning the reporting or the value? If it is a counter, then systems like Prometheus will end up calculating the delta between measurements. If it should be a gauge, then yes, it should be reset\r\n\r\nWe can see in the first set of logs that there is one transaction in progress:\r\n```\r\n2024-05-08T10:32:56,013 [accumulo.METRICS] INFO : accumulo.fate.tx{host=groot,instance.name=miniInstance,port=34595,process.name=manager,state=in_progress} value=1\r\n```\r\nIt also shows the operation that transaction is currently on in that same set of logs:\r\n```\r\n2024-05-08T10:32:56,013 [accumulo.METRICS] INFO : accumulo.fate.ops.in.progress.by.type{host=groot,instance.name=miniInstance,op.type=TABLE_COMPACT,port=34595,process.name=manager} value=1\r\n```\r\nThis is all fine/expected\r\n\r\nOne second later, when the next set of logs occur, there are zero transactions in progress:\r\n```\r\n2024-05-08T10:32:57,014 [accumulo.METRICS] INFO : accumulo.fate.tx{host=groot,instance.name=miniInstance,port=34595,process.name=manager,state=in_progress} value=0\r\n```\r\nBut we still see the same log that there is a transaction on operation TABLE_COMPACT:\r\n```\r\n2024-05-08T10:32:57,014 [accumulo.METRICS] INFO : accumulo.fate.ops.in.progress.by.type{host=groot,instance.name=miniInstance,op.type=TABLE_COMPACT,port=34595,process.name=manager} value=1\r\n```\r\nThe compaction has completed, so it seems wrong that this is still logged","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101341880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101355094","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2101355094","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2101355094,"node_id":"IC_kwDOACaFSM59QCJW","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T20:17:33Z","updated_at":"2024-05-08T20:17:33Z","author_association":"MEMBER","body":"> `I'm just not sure what is/isn't considered system activity`\r\n> \r\n> My interpretation is anything that is occurring. While users may want visibility into specific Accumulo internals (say metadata, gc...) Overall what they care about is how is Accumulo performing - is it ingesting data when received in a timely fashion? Are user queries being served, and returned? Is the system under strain and are there specific bottlenecks or failures? Are compactions running and completing as expected. Are files being deleted as intended so they don't run out of space ....\r\n> \r\n> The metrics should be able to answer these types of questions as well as provide feedback for tuning system parameters. Increasing number of threads for... Allocating more memory to... Adding / decreasing compactors, scan servers, tservers to provide enough capability in an efficient maner\r\n\r\nBased on this, it seems like UserFateStore should be included. I will create an issue for this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101355094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101370056","html_url":"https://github.com/apache/accumulo/issues/4532#issuecomment-2101370056","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4532","id":2101370056,"node_id":"IC_kwDOACaFSM59QFzI","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T20:28:34Z","updated_at":"2024-05-08T20:28:34Z","author_association":"CONTRIBUTOR","body":"> I think it makes sense for the ConfigurableScanServerSelector to wait for ScanServers to be available instead of immediately falling back to TabletServers. However, I think there should be a timeout set, I don't think the client should wait forever.\r\n\r\nInstead of the config being a boolean, it could be a timeout.  Maybe something like the following.\r\n\r\n```\r\n    [\r\n     {\r\n       \"isDefault\":true,\r\n       \"maxBusyTimeout\":\"5m\",\r\n       \"busyTimeoutMultiplier\":4,\r\n       \"timeToWaitForScanServers\":\"120s\"\r\n       \"attemptPlans\":[\r\n         {\"servers\":\"3\", \"busyTimeout\":\"33ms\"},\r\n         {\"servers\":\"100%\", \"busyTimeout\":\"100ms\"}\r\n       ]\r\n     }\r\n    ]\r\n```\r\n\r\nThen if someone wants to wait forever they can set that config really high.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101370056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101412344","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2101412344","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2101412344,"node_id":"IC_kwDOACaFSM59QQH4","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T20:48:12Z","updated_at":"2024-05-08T20:48:12Z","author_association":"CONTRIBUTOR","body":"The tension between a counter and a gauge is what the intended usage is.\r\n\r\nYour interpretation seems to be that the by_type should be a snapshot of an instant in time.  That is not necessarily incorrect.\r\n\r\nUsing a counter provides a different view.  Because a counter is always increasing you can reason about things between measurements.  It is not the instantaneous value  but the absolute value that is reported.  The absolute value allows using the delta and the rate of change of the value over time to be determined.  The counter answers how many X's have ever occurred. \r\n\r\nFor example, how many compactions have occurred over the last T?  One way the counter is useful - say you look at an instantaneous snapshot and there are 0 compactions.  No problem, that seems normal.  However, if you looked over the last 24 hours and there were never any compactions you might need to look at things.  \r\n\r\nThe counter allows you to look at things like how many compactions happened over the last reporting period - has that increased?  Counters also allow you to aggregate between reporting periods.  With a snapshot you just need to hope that it hits at the measurement time. \r\n\r\nA counter also provides a way to trend things.  For example you may want to trend bulk imports - Is there a surge at certain times?  Does it vary by day? A counter can answer that, a gauge cannot.\r\n\r\nUsing a combination of gauges (a snapshot of state) as well as counters to provide for trending and history may be appropriate.  Think how it would be displayed on a dashboard.  The gauges are the state right now.  The counters could be graphs. showing the activity over the last few hours.\r\n\r\nSo using a counter provides a view into activity over-time.  Which is also not incorrect.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101412344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101619141","html_url":"https://github.com/apache/accumulo/issues/4519#issuecomment-2101619141","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4519","id":2101619141,"node_id":"IC_kwDOACaFSM59RCnF","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-08T22:42:54Z","updated_at":"2024-05-08T22:42:54Z","author_association":"MEMBER","body":"I don't think we need to do this for 2.1. It may be useful in future versions, but we should be aware that it's possible other best practices (deleting empty splits in the metadata) may conflict with this change, if those best practices are also used, and one isn't careful about when/how to use them together with this change. We could make it so that specific split points cannot be deleted at all... but I'm not sure that's a good idea either. If all these reserved sections are moved to their own separate tables in the accumulo namespace, that would avoid the need to do this.\r\n\r\nI seem to recall we also recently discussed the idea of possibly moving the `~del` section to be interspersed throughout the tablets, but I've momentarily forgotten why that was proposed, and don't have time to look up the ticket at the moment.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2101619141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102501491","html_url":"https://github.com/apache/accumulo/pull/4536#issuecomment-2102501491","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4536","id":2102501491,"node_id":"IC_kwDOACaFSM59UaBz","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-09T11:41:07Z","updated_at":"2024-05-09T11:41:07Z","author_association":"CONTRIBUTOR","body":"Implementation seems fine. Hashing to the hostname is what we'd like to happen for leveraging a shared cache.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102501491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102694343","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2102694343","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2102694343,"node_id":"IC_kwDOACaFSM59VJHH","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-09T13:45:34Z","updated_at":"2024-05-09T13:45:34Z","author_association":"MEMBER","body":"Thank you for the detailed explanation. That makes sense. \r\nIt seemed like that could have been a potential issue, so thought I would point it out. Glad that this is the expected behavior, and the \"issue\" was instead stemming from my misunderstanding of how the metrics are used.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102694343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102713843","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2102713843","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2102713843,"node_id":"IC_kwDOACaFSM59VN3z","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-09T13:56:31Z","updated_at":"2024-05-09T13:56:31Z","author_association":"MEMBER","body":"A couple more things that I'm still curious about from my original comment:\r\n\r\n> So, it appears that the values of 0 are correct, they are just not updated as frequently as they are logged, making it seem like the count of 0 is more frequent than it actually is. Perhaps for this test we could increase the logging time to 5 seconds, or decrease the update time to 1 second so it is more clear in the logs what is actually happening at what time.\r\n\r\n\r\nShould any of the timings be adjusted for this test? Might be confusing not having the log and update intervals be the same. This seemed to be the basis of the original issue - unsure if the FATE metric counts were correct.\r\n\r\n> One thing I noticed when looking at this, accumulo.fate.ops.in.progress is a sum of all current txns (failed_in_progress, in_progress, new, unknown, successful, failed, and submitted). The \"in.progress\" may be a bit misleading since the \"in.progress\" in this case is different from the state \"in_progress\". Maybe something like accumulo.fate.ops.total or accumulo.fate.ops.current.ops would be clearer? Or maybe this was intended to only include txns that are in_progress? This doesn't seem to apply to accumulo.fate.ops.in.progress.by.type since this only includes those that are in_progress.\r\n\r\nShould the naming for `accumulo.fate.ops.in.progress` be changed?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102713843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102870537","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2102870537","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2102870537,"node_id":"IC_kwDOACaFSM59V0IJ","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-09T15:19:20Z","updated_at":"2024-05-09T15:19:20Z","author_association":"CONTRIBUTOR","body":"> Should the naming for accumulo.fate.ops.in.progress be changed?\r\n\r\nMaybe `accumulo.fate.ops.in.progress.total`  if it is a counter?  ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102870537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102936979","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2102936979","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2102936979,"node_id":"IC_kwDOACaFSM59WEWT","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-09T15:51:11Z","updated_at":"2024-05-09T15:51:11Z","author_association":"MEMBER","body":"My concern was more with the \"in.progress\" part. `accumulo.fate.ops.in.progress` is a count of all the current transactions (failed_in_progress, in_progress, new, unknown, successful, failed, and submitted), so it seems misleading to be named \"in.progress\".","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102936979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102957044","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2102957044","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2102957044,"node_id":"IC_kwDOACaFSM59WJP0","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-09T16:02:59Z","updated_at":"2024-05-09T16:02:59Z","author_association":"CONTRIBUTOR","body":"Then maybe in_progress would be better specified as a gauge?  My comments earlier were generic.  One suggestion that I have seen is that `total` may be common for a unit-less accumulating count.  Maybe we adopt `info` for instantaneous counts?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2102957044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104576249","html_url":"https://github.com/apache/accumulo/issues/4528#issuecomment-2104576249","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4528","id":2104576249,"node_id":"IC_kwDOACaFSM59cUj5","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T13:05:03Z","updated_at":"2024-05-10T13:05:29Z","author_association":"CONTRIBUTOR","body":"This only applies to elasticity, but would we also want to disallow eventual scans on the new [FATE](https://github.com/apache/accumulo/blob/b0f02ea6dec86297bd752aba73ee67ff11c06c16/core/src/main/java/org/apache/accumulo/core/metadata/AccumuloTable.java#L33) table that is now part of the accumulo namespace?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104576249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104603308","html_url":"https://github.com/apache/accumulo/pull/4175#issuecomment-2104603308","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4175","id":2104603308,"node_id":"IC_kwDOACaFSM59cbKs","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T13:23:09Z","updated_at":"2024-05-10T13:23:09Z","author_association":"CONTRIBUTOR","body":"Superceded by #4486 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104603308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104604165","html_url":"https://github.com/apache/accumulo/issues/3522#issuecomment-2104604165","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3522","id":2104604165,"node_id":"IC_kwDOACaFSM59cbYF","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T13:23:42Z","updated_at":"2024-05-10T13:23:42Z","author_association":"CONTRIBUTOR","body":"Closed by #4486 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104604165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104670066","html_url":"https://github.com/apache/accumulo/pull/4543#issuecomment-2104670066","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4543","id":2104670066,"node_id":"IC_kwDOACaFSM59crdy","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T14:04:05Z","updated_at":"2024-05-10T14:04:05Z","author_association":"CONTRIBUTOR","body":"This should be documented - maybe it could be added to the html table in MetricsProducer that maps old -> new metric names?  Not sure if it fit there, but we should signal the name change to users.  Maybe that's just release notes, but a more visible place in the documentation seems more appropriate.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104670066/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104739587","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2104739587","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2104739587,"node_id":"IC_kwDOACaFSM59c8cD","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T14:45:27Z","updated_at":"2024-05-10T14:45:27Z","author_association":"CONTRIBUTOR","body":"Maybe the refreshAfterWrite could be used?  https://github.com/ben-manes/caffeine/wiki/Refresh","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104739587/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104739869","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2104739869","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2104739869,"node_id":"IC_kwDOACaFSM59c8gd","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T14:45:38Z","updated_at":"2024-05-10T14:45:38Z","author_association":"CONTRIBUTOR","body":"I will look into this to see how the Cache is being used but Caffeine does support a [refresh](https://github.com/ben-manes/caffeine/wiki/Refresh) option which allows an updated value to be loaded in the background and the old value is returned until complete. We probably need to change the configuration here to use the refresh","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104739869/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104741121","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2104741121","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2104741121,"node_id":"IC_kwDOACaFSM59c80B","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T14:46:23Z","updated_at":"2024-05-10T14:46:23Z","author_association":"CONTRIBUTOR","body":"@EdColeman - I see you just beat me to the same comment :) ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104741121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104755998","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2104755998","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2104755998,"node_id":"IC_kwDOACaFSM59dAce","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T14:55:21Z","updated_at":"2024-05-10T14:55:21Z","author_association":"CONTRIBUTOR","body":"I did not know about the refresh capability, that seems like it could really smooth out scan server performance for frequently used tablets. Also, that seems to indicate that the current code is probably blocking on refreshing frequently used tablets.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104755998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104763082","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2104763082","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2104763082,"node_id":"IC_kwDOACaFSM59dCLK","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T14:59:36Z","updated_at":"2024-05-10T14:59:36Z","author_association":"CONTRIBUTOR","body":"It seems like we may be able to target the changes here for 2.1 or at least for 3.1","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104763082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104767560","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2104767560","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2104767560,"node_id":"IC_kwDOACaFSM59dDRI","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T15:02:15Z","updated_at":"2024-05-10T15:02:15Z","author_association":"CONTRIBUTOR","body":"> It seems like we may be able to target the changes here for 2.1 or at least for 3.1\r\n\r\nIt could be a nice change for 2.1, it definitely seems like a performance bug if its periodically blocking.  ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104767560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104797994","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2104797994","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2104797994,"node_id":"IC_kwDOACaFSM59dKsq","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T15:21:51Z","updated_at":"2024-05-10T15:21:51Z","author_association":"CONTRIBUTOR","body":"We may be able to use this refresh capability to further smooth out performance of frequently used tablets.  Looking at the caffeine refresh docs, it seems custom code can be called on refresh.  We could add code there to write out any new scan server refs if needed.  That could be follow on work.  It would further reduce delays around frequently used tablets.   That could look like the following.\r\n\r\n 1. Load tablet metadata for table A\r\n 2. Tablet A uses files F1,F2,F3 so write out scan server refs for those\r\n 3. Later refresh tablet A and find it uses files F1,F2,F3,F4.. as part of refresh write out a new scans server ref for F4\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104797994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104870011","html_url":"https://github.com/apache/accumulo/issues/4538#issuecomment-2104870011","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4538","id":2104870011,"node_id":"IC_kwDOACaFSM59dcR7","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T16:10:44Z","updated_at":"2024-05-10T16:10:44Z","author_association":"CONTRIBUTOR","body":"Chatted w/ @cshannon  about this.  One challenge we identified is large compaction operations.  For example if a large number of external compaction processes are temporarily stood up and then a large compaction operation is initiated, it may start to generate large numbers of files in a short time that should be deleted.  In the worst case if the GC delays deleting files it could result in the compaction operation filling up DFS.  This implies that the delay may need to adjust depending on DFS free space and the amount of files that could be deleted, but are delayed.  Dynamically adjusting the delay makes it harder for the scan servers to reason about it.\r\n\r\nAnother thing discsussed was race conditions.  This change would conceptually create another set of files the GC is tracking.  \r\n\r\n * File references (existing set)\r\n * GC candidates (existing set)\r\n * Delayed delete files (new set)\r\n * Deleting files (existing set)\r\n\r\nWhen the GC moves a file from the new delayed_delete set to the deleting_files set, it must be done in a such a way that considers what the scan servers are using and not have race conditions.  We talked through a few ways to do this, but those possible solutions had race conditions.  So still need to figure out something for that.\r\n\r\nThis offers a potential speed up to scan servers for writing out scan server refs to the metadata table.  The scan server will still have to read tablet files from the metadata table, which is an extra cost over tablet servers.  That leads to another potential solution to lower scan time as some way to pre load tablets on select scan servers, that may be something to explore in tandem.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2104870011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105087612","html_url":"https://github.com/apache/accumulo/pull/4545#issuecomment-2105087612","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4545","id":2105087612,"node_id":"IC_kwDOACaFSM59eRZ8","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T18:33:32Z","updated_at":"2024-05-10T18:33:32Z","author_association":"CONTRIBUTOR","body":"merged this because I saw some existing code that this PR touched that  I wanted to clean up","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105087612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105305779","html_url":"https://github.com/apache/accumulo/pull/4480#issuecomment-2105305779","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4480","id":2105305779,"node_id":"IC_kwDOACaFSM59fGqz","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-10T21:43:18Z","updated_at":"2024-05-10T21:43:18Z","author_association":"CONTRIBUTOR","body":"> I started to work on a follow on to this PR in another branch that is based on the SteadyTime changes from #4494 and is here: [cshannon@1997703](https://github.com/cshannon/accumulo/commit/19977034c3f0fceb1a3cf0972195ad4fb459a484)\r\n> \r\n> It's not tested and just a rough draft of how we could possibly use SteadyTime. I was unsure about a couple of things, first the commit updates CompactionJobGenerator but I'm not sure if we need to also update CompactionCoordinator to use SteadyTime when dealing with selected files. Second, I wasn't sure if the expiration should be an independent check or tied to if compaction jobs have run (ie only expire if compaction jobs run is greater than 0\r\n\r\nI merged in these changes after SteadyTime was merged into elasticity, the same comments/questions apply","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105305779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105525804","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2105525804","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2105525804,"node_id":"IC_kwDOACaFSM59f8Ys","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-11T03:57:49Z","updated_at":"2024-05-11T03:58:25Z","author_association":"CONTRIBUTOR","body":"From afar, it does sound like refreshAfterWrite could work very well for you. It avoids the latency spike when popular items expire by reloading early, while allowing seldomly used ones to fade away by expiring. It is intended to hide latency.\r\n\r\nYou can override `CacheLoader.reload(key, value)` if you can use the value as part of your logic. This is useful when you can cheaply validate if the current value is up to date, e.g. a version / timestamp, or if you can apply a differential update rather than a full reload.\r\n\r\nAs reloads are triggered by individual lookups, it can be beneficial to batch these requests into a single load. A small buffering delay can be used to accumulate reloads over a time/space window, perform the bulk load, and complete the individual operations. This works nicely because that buffering delay is not application-facing, as it continues to receive the current value while the reload is in progress. The example uses Reactor for simplicity as it then only requires about a dozen lines of code.\r\n\r\nHope that helps!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105525804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105741069","html_url":"https://github.com/apache/accumulo/issues/3908#issuecomment-2105741069","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3908","id":2105741069,"node_id":"IC_kwDOACaFSM59gw8N","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-11T13:10:19Z","updated_at":"2024-05-11T13:10:19Z","author_association":"CONTRIBUTOR","body":"Tests were added in #4415, so I am closing this. If more tests are needed it can be a follow on","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105741069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105745795","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2105745795","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2105745795,"node_id":"IC_kwDOACaFSM59gyGD","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-11T13:29:21Z","updated_at":"2024-05-11T13:29:21Z","author_association":"CONTRIBUTOR","body":"@ben-manes - Thanks for the input, that helps. One question I was wondering is that currently this uses a `LoadingCache` vs `AsyncLoadingCache` and I was wondering if there would be any reason to switch and any difference with how the refresh behavior works. The refresh operation looks like it will be done in the background even for a `LoadingCache` and the old value returned, so I think the current `LoadingCache` is ok in this case.\r\n\r\nI think the main benefit of the `AsyncLoadingCache` is when the computation is slow for the load so you reduce contention on the cache when other threads are hitting it since you put the loads onto an executor. So for the sync cache I assume the performance is based on how fine grained the locking is when running computeIfAbsent(). In this case I'm not sure how much of a benefit that would be, I would need to look into it more.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105745795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105956413","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2105956413","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2105956413,"node_id":"IC_kwDOACaFSM59hlg9","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-11T17:05:03Z","updated_at":"2024-05-11T17:05:03Z","author_association":"CONTRIBUTOR","body":"@cshannon, I think you're right on all points. I'll give more depth just for fun.\r\n\r\nIn regards to automatic refresh, the sync/async caches are the same. The vast majority of the code is shared ([BoundedLocalCache.refreshIfNeeded](https://github.com/ben-manes/caffeine/blob/5a172296406a570a08b33c4992d72a6e80ba3d17/caffeine/src/main/java/com/github/benmanes/caffeine/cache/BoundedLocalCache.java#L1298-L1416)) with thin adapters to the corresponding interfaces ([LocalLoadingCache](https://github.com/ben-manes/caffeine/blob/master/caffeine/src/main/java/com/github/benmanes/caffeine/cache/LocalLoadingCache.java), [LocalAsyncLoadingCache](https://github.com/ben-manes/caffeine/blob/master/caffeine/src/main/java/com/github/benmanes/caffeine/cache/LocalAsyncLoadingCache.java)). When a refresh is triggered, it calls [AsyncCacheLoader.asyncReload(k, v, executor)](https://github.com/ben-manes/caffeine/blob/5a172296406a570a08b33c4992d72a6e80ba3d17/caffeine/src/main/java/com/github/benmanes/caffeine/cache/AsyncCacheLoader.java#L93-L117), which [CacheLoader](https://github.com/ben-manes/caffeine/blob/master/caffeine/src/main/java/com/github/benmanes/caffeine/cache/CacheLoader.java) overrides to wrap and call the synchronous [reload(k, v)](https://github.com/ben-manes/caffeine/blob/master/caffeine/src/main/java/com/github/benmanes/caffeine/cache/CacheLoader.java#L152-L207) for convenience. There is a little juggling if the cache is storing a future value, but that's all internal details.\r\n\r\n`AsyncLoadingCache` is definitely useful when avoiding lock contention on `computeIfAbsent`, as it shifts from ConcurrentHashMap's hashbin lock to the entry's future. That reduces the map's own operation time, but sacrifices linearizability which is normally okay. By the cache managing the pending value, another significant benefit is it allows us to offer a [smarter bulk load](https://github.com/ben-manes/caffeine/wiki/Faq#bulk-loads) that protects against cache stampedes like individual loads do. Other benefits are that a future also allows the caller to use a timeout or share the same error if a failure rather than trying the load anew. And of course if the caller or loader is an async/reactive chain then it naturally fits together rather than randomly blocking in an undesirable code point. That's quite nice if all calls can benefit from [coalescing](https://github.com/ben-manes/caffeine/tree/master/examples/coalescing-bulkloader-reactor) and not just a refresh.\r\n\r\nA negative aspect of all async calls is the need for an executor. The cache doesn't manage its own threads so it defaults to the shared JVM-wide `ForkJoinPool.commonPool()` (`CompletableFuture` does similarly in its `defaultExecutor()`). That thread pool is designed for cpu-intensive work and will quickly starve on I/O due to its limited thread count. The new virtual thread executor is optimized for I/O as it elegantly layers itself on top of FJP so the blocking waits are not performed on the native threads. That feature is still too immature for production use on the latest JDKs due to [footguns](https://mail.openjdk.org/pipermail/loom-dev/2024-February/006463.html), but those will be resolved in future releases. When appropriate we'll switch defaults, but you might see a benefit in sharing an application-wide `Executors.newCachedThreadPool()` for all of your async I/O (`ThreadPoolExecutor`) and configuring that in Caffeine when appropriate.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105956413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105959357","html_url":"https://github.com/apache/accumulo/issues/4544#issuecomment-2105959357","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4544","id":2105959357,"node_id":"IC_kwDOACaFSM59hmO9","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-11T17:17:12Z","updated_at":"2024-05-11T17:17:12Z","author_association":"CONTRIBUTOR","body":"@ben-manes - Thanks for the explanation, that helps a lot. Sounds like the Virtual thread support will be quite nice when it's ready in the future.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2105959357/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2106000925","html_url":"https://github.com/apache/accumulo/pull/4552#issuecomment-2106000925","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4552","id":2106000925,"node_id":"IC_kwDOACaFSM59hwYd","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-11T19:34:46Z","updated_at":"2024-05-11T19:38:52Z","author_association":"CONTRIBUTOR","body":"The motivation behind this is that in the past the scan servers tablet metadata cache was instrumented w/ micrometere but not recording stats.  Was attempting to use the cache metrics and they were zero and/or non existent.  Spent a long time tracking down why instrumentation was not working (was looking at micrometer source code first thinking there was a bug there).  Finally realized it was a problem w/ how the cache was built, just happened to remember that recording stats is optional. So this change is an attempt to catch future changes where the cache is changed to no longer record stats.  Tried to think of a more general way to catch this mismatch between cache builder and cahce insturmention that could catch the problem anywhere in the Accumulo code base, but could not think of anything.  So this change adds a check to the place where I saw it and it caused me problems.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2106000925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2106362835","html_url":"https://github.com/apache/accumulo/pull/4551#issuecomment-2106362835","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4551","id":2106362835,"node_id":"IC_kwDOACaFSM59jIvT","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-12T20:14:17Z","updated_at":"2024-05-12T20:14:17Z","author_association":"CONTRIBUTOR","body":"I should point out that this is targeting 2.1 even though there's a new property because the Scan server properties are all marked experimental anyways. We could wait for 3.1 but this seems beneficial enough to put into 2.1 and is low risk.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2106362835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2107624435","html_url":"https://github.com/apache/accumulo/issues/4498#issuecomment-2107624435","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4498","id":2107624435,"node_id":"IC_kwDOACaFSM59n8vz","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T13:46:22Z","updated_at":"2024-05-13T13:46:22Z","author_association":"MEMBER","body":"> So, it appears that the values of 0 are correct, they are just not updated as frequently as they are logged, making it seem like the count of 0 is more frequent than it actually is. Perhaps for this test we could increase the logging time to 5 seconds, or decrease the update time to 1 second so it is more clear in the logs what is actually happening at what time.\r\n\r\nIf the above is fine/not an issue, this issue can be closed as completed as everything else has been addressed","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2107624435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2107699397","html_url":"https://github.com/apache/accumulo/pull/4551#issuecomment-2107699397","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4551","id":2107699397,"node_id":"IC_kwDOACaFSM59oPDF","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T14:16:39Z","updated_at":"2024-05-13T14:16:39Z","author_association":"CONTRIBUTOR","body":"Reminder to wire up to the Caches class in `elasticity`\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2107699397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108127946","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108127946","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108127946,"node_id":"IC_kwDOACaFSM59p3rK","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T16:15:40Z","updated_at":"2024-05-13T16:15:40Z","author_association":"CONTRIBUTOR","body":"K/V read and written will be easier than bytes I think. The FileCompactor already keeps track of entries read and written, they are just not emitted as metrics. Keeping track of bytes read and written at this level will likely not be accurate due to run-length encoding and compression.\r\n\r\nMETRICS_COMPACTOR_MAJC_STUCK is incremented in `CompactionWatcher.run`, which appears to be used in both internal and external compactions.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108127946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108516146","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108516146","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108516146,"node_id":"IC_kwDOACaFSM59rWcy","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T18:19:48Z","updated_at":"2024-05-13T18:19:48Z","author_association":"MEMBER","body":"I can take a look at this unless someone else was planning to.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108516146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108563694","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108563694","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108563694,"node_id":"IC_kwDOACaFSM59riDu","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T18:46:09Z","updated_at":"2024-05-13T18:46:09Z","author_association":"CONTRIBUTOR","body":"> I can take a look at this unless someone else was planning to.\r\n\r\nI think we should solidify whether we are trying to emit bytes or k/v entries before starting on anything. The answer to that question is going to directly impact the amount of work that needs to be done.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108563694/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108604675","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108604675","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108604675,"node_id":"IC_kwDOACaFSM59rsED","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T19:07:30Z","updated_at":"2024-05-13T19:07:30Z","author_association":"CONTRIBUTOR","body":"> > I can take a look at this unless someone else was planning to.\r\n> \r\n> I think we should solidify whether we are trying to emit bytes or k/v entries before starting on anything. The answer to that question is going to directly impact the amount of work that needs to be done.\r\n\r\nThese metrics should help answer if a compaction strategy change and/or iterator change is positive or negative.\r\nIf we can get that information based on K/Vs then I think that's fine. It's at least a step in the right direction. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108604675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108617325","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108617325","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108617325,"node_id":"IC_kwDOACaFSM59rvJt","user":{"login":"alerman","id":119506,"node_id":"MDQ6VXNlcjExOTUwNg==","avatar_url":"https://avatars.githubusercontent.com/u/119506?v=4","gravatar_id":"","url":"https://api.github.com/users/alerman","html_url":"https://github.com/alerman","followers_url":"https://api.github.com/users/alerman/followers","following_url":"https://api.github.com/users/alerman/following{/other_user}","gists_url":"https://api.github.com/users/alerman/gists{/gist_id}","starred_url":"https://api.github.com/users/alerman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alerman/subscriptions","organizations_url":"https://api.github.com/users/alerman/orgs","repos_url":"https://api.github.com/users/alerman/repos","events_url":"https://api.github.com/users/alerman/events{/privacy}","received_events_url":"https://api.github.com/users/alerman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T19:13:06Z","updated_at":"2024-05-13T19:13:06Z","author_association":"CONTRIBUTOR","body":"Do we track total entries in the tablet or the files for compaction? We use the bytes read/written in listcompactions output to get a feel for the percent complete. I can look at the files list and see the aggregate file size in the list and compare that to size read.\r\n\r\nI know the monitor shows a percentage for external compactions, but would be good to be able to know not just how many it's written but also that 1) progress is being made and 2) with what speed\r\n\r\nHow does listcompactions get the data in bytes?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108617325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108631416","html_url":"https://github.com/apache/accumulo/pull/4556#issuecomment-2108631416","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4556","id":2108631416,"node_id":"IC_kwDOACaFSM59ryl4","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T19:20:33Z","updated_at":"2024-05-13T19:20:33Z","author_association":"MEMBER","body":"This issue reminded me of the FateOpsCommandsIT written for elasticity (tests all the admin fate commands). This test was an expansion of FateSummaryIT and removed FateSummaryIT in elasticity. Made me think that it might be good to have the FateOpsCommandsIT written for 2.1/3.1. If desired, I could rewrite the test for 2.1/3.1 in a separate PR.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108631416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108631908","html_url":"https://github.com/apache/accumulo/issues/4462#issuecomment-2108631908","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4462","id":2108631908,"node_id":"IC_kwDOACaFSM59rytk","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T19:20:52Z","updated_at":"2024-05-13T19:20:52Z","author_association":"MEMBER","body":"No, the -s path would not bypass the error as the filtering is done after the transaction info is obtained (or attempted to be obtained).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108631908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108647762","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108647762","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108647762,"node_id":"IC_kwDOACaFSM59r2lS","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T19:30:48Z","updated_at":"2024-05-13T19:30:48Z","author_association":"CONTRIBUTOR","body":"> \r\n> How does listcompactions get the data in bytes?\r\n\r\nFrom what I'm seeing in listcompactions, the READ and WROTE columns are in K/V entries.\r\n\r\nhttps://github.com/apache/accumulo/blob/2.1/shell/src/main/java/org/apache/accumulo/shell/commands/ActiveCompactionHelper.java#L96-L100\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108647762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108657893","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108657893","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108657893,"node_id":"IC_kwDOACaFSM59r5Dl","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T19:37:15Z","updated_at":"2024-05-13T19:37:53Z","author_association":"CONTRIBUTOR","body":"> How does listcompactions get the data in bytes?\r\n\r\nI think I see the point of confusion. The [shortenCount](https://github.com/apache/accumulo/blob/rel/2.1.0/shell/src/main/java/org/apache/accumulo/shell/commands/ActiveCompactionHelper.java#L50) method uses a suffix (`K`, `M`, `B`) that is very similar to bytes (`Kb`, `Mb`, ...). ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108657893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108669486","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108669486","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108669486,"node_id":"IC_kwDOACaFSM59r74u","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T19:45:02Z","updated_at":"2024-05-13T19:45:02Z","author_association":"CONTRIBUTOR","body":"@DomGarguilo - I think `CompactionWatcher.run` is the right place to increment the metrics for K/V read and write. This is called, directly or indirectly, from the TabletServer and Compactor. I haven't looked at how best to wire them up, I'll leave that to you.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108669486/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108798114","html_url":"https://github.com/apache/accumulo/pull/4400#issuecomment-2108798114","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4400","id":2108798114,"node_id":"IC_kwDOACaFSM59sbSi","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T21:04:57Z","updated_at":"2024-05-13T21:04:57Z","author_association":"MEMBER","body":"Made some misc changes to this PR that I realized from working on https://github.com/apache/accumulo/issues/4462 (see https://github.com/apache/accumulo/pull/4400/commits/05fffe2a9bec75c92d3623b59314e15024517520)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108798114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108863668","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108863668","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108863668,"node_id":"IC_kwDOACaFSM59srS0","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T21:51:31Z","updated_at":"2024-05-13T21:51:31Z","author_association":"CONTRIBUTOR","body":"If we have 10 total compactors and only 7 of them are currently working on something, it may be nice if aggregations of the metrics only considered the 7 that were actually doing something.  Not sure how best to do this though.  Some of the micrometer Meters seem to not emit any data when its zero, but I don't have a good understanding of this.  That may be helpful for this case.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108863668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108872613","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2108872613","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2108872613,"node_id":"IC_kwDOACaFSM59stel","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-13T21:58:17Z","updated_at":"2024-05-13T21:58:17Z","author_association":"CONTRIBUTOR","body":"> If we have 10 total compactors and only 7 of them are currently working on something, it may be nice if aggregations of the metrics only considered the 7 that were actually doing something. Not sure how best to do this though. Some of the micrometer Meters seem to not emit any data when its zero, but I don't have a good understanding of this. That may be helpful for this case.\r\n\r\nI think it depends on whether Micrometer is reporting absolutes, or rates. The value that gets output depends on the system the metric is being sent to. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2108872613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2110428036","html_url":"https://github.com/apache/accumulo/issues/4532#issuecomment-2110428036","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4532","id":2110428036,"node_id":"IC_kwDOACaFSM59ypOE","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T14:41:26Z","updated_at":"2024-05-14T14:41:26Z","author_association":"CONTRIBUTOR","body":"I can take a look at this. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2110428036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2110613441","html_url":"https://github.com/apache/accumulo/pull/4488#issuecomment-2110613441","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4488","id":2110613441,"node_id":"IC_kwDOACaFSM59zWfB","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T16:07:59Z","updated_at":"2024-05-14T16:07:59Z","author_association":"CONTRIBUTOR","body":"These changes were merged into #4558 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2110613441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2110972439","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2110972439","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2110972439,"node_id":"IC_kwDOACaFSM590uIX","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T19:14:52Z","updated_at":"2024-05-14T19:14:52Z","author_association":"MEMBER","body":"I have started on some changes for this and wanted to make sure I'm on the right track.\r\n\r\nI have added metrics that track the same read and write values that are logged in `CompactionWatcher.run`:\r\nhttps://github.com/apache/accumulo/blob/220cdc54da5ba779675d635bcbcc02a6514cd5e6/server/compactor/src/main/java/org/apache/accumulo/compactor/Compactor.java#L657-L660\r\n\r\nThese values have always been zero though. Both in the logs and the metrics that use these values.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2110972439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111121680","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2111121680","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2111121680,"node_id":"IC_kwDOACaFSM591SkQ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T20:53:44Z","updated_at":"2024-05-14T20:53:44Z","author_association":"CONTRIBUTOR","body":"> I have started on some changes for this and wanted to make sure I'm on the right track.\r\n> \r\n> I have added metrics that track the same read and write values that are logged in `CompactionWatcher.run`:\r\n> \r\n> https://github.com/apache/accumulo/blob/220cdc54da5ba779675d635bcbcc02a6514cd5e6/server/compactor/src/main/java/org/apache/accumulo/compactor/Compactor.java#L657-L660\r\n> \r\n> These values have always been zero though. Both in the logs and the metrics that use these values.\r\n\r\nHow are you testing this? Are you running a compaction on a table via uno or something? Is the compaction lasting several minutes?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111121680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111165350","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2111165350","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2111165350,"node_id":"IC_kwDOACaFSM591dOm","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T21:24:12Z","updated_at":"2024-05-14T21:24:12Z","author_association":"CONTRIBUTOR","body":"I made the following change, and saw non-zero output.\r\n\r\n```\r\ndiff --git a/test/src/main/java/org/apache/accumulo/test/compaction/ExternalCompactionProgressIT.java b/test/src/main/java/org/apache/accumulo/test/compaction/ExternalCompactionProgressIT.java\r\nindex abdf66b727..59f6e784bd 100644\r\n--- a/test/src/main/java/org/apache/accumulo/test/compaction/ExternalCompactionProgressIT.java\r\n+++ b/test/src/main/java/org/apache/accumulo/test/compaction/ExternalCompactionProgressIT.java\r\n@@ -129,6 +129,7 @@ public class ExternalCompactionProgressIT extends AccumuloClusterHarness {\r\n     var ecMap = ecList.getCompactions();\r\n     if (ecMap != null) {\r\n       ecMap.forEach((ecid, ec) -> {\r\n+        ec.getUpdates().forEach((timestamp, update) -> System.out.println(update.toString()));\r\n         // returns null if it's a new mapping\r\n         RunningCompactionInfo rci = new RunningCompactionInfo(ec);\r\n         RunningCompactionInfo previousRci = runningMap.put(ecid, rci);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111165350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111248830","html_url":"https://github.com/apache/accumulo/issues/4560#issuecomment-2111248830","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4560","id":2111248830,"node_id":"IC_kwDOACaFSM591xm-","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T22:31:11Z","updated_at":"2024-05-14T22:31:11Z","author_association":"CONTRIBUTOR","body":"Found [this code](https://github.com/apache/accumulo/blob/39c92710683bf75c41fd70e1f21b39ad376dd84d/server/manager/src/main/java/org/apache/accumulo/manager/compaction/coordinator/CompactionCoordinator.java#L1021) that cleans up compactors. Have not found anything for scan servers yet.\n\nFor scan servers, looked at what used the constant `Constants.ZSSERVERS` and did not see any cleanup code directly referenced from that.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111248830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111252529","html_url":"https://github.com/apache/accumulo/issues/4559#issuecomment-2111252529","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4559","id":2111252529,"node_id":"IC_kwDOACaFSM591ygx","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T22:34:52Z","updated_at":"2024-05-14T22:34:52Z","author_association":"CONTRIBUTOR","body":"#4560 is a duplicate, so closing it.  It has some code links for the tsever and compactor code.   Could not find anything for scan servers.\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111252529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111257151","html_url":"https://github.com/apache/accumulo/issues/4560#issuecomment-2111257151","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4560","id":2111257151,"node_id":"IC_kwDOACaFSM591zo_","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-14T22:39:53Z","updated_at":"2024-05-14T22:39:53Z","author_association":"CONTRIBUTOR","body":"dupe of #4559","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2111257151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2112487652","html_url":"https://github.com/apache/accumulo/pull/4561#issuecomment-2112487652","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4561","id":2112487652,"node_id":"IC_kwDOACaFSM596gDk","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T13:14:20Z","updated_at":"2024-05-15T13:14:20Z","author_association":"CONTRIBUTOR","body":"I think this change could target the 2.1 branch so that it gets included in the next 2.1 patch release.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2112487652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2112542866","html_url":"https://github.com/apache/accumulo/issues/4553#issuecomment-2112542866","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4553","id":2112542866,"node_id":"IC_kwDOACaFSM596tiS","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T13:31:35Z","updated_at":"2024-05-15T13:31:35Z","author_association":"MEMBER","body":"> > I have started on some changes for this and wanted to make sure I'm on the right track.\r\n> > I have added metrics that track the same read and write values that are logged in `CompactionWatcher.run`:\r\n> > https://github.com/apache/accumulo/blob/220cdc54da5ba779675d635bcbcc02a6514cd5e6/server/compactor/src/main/java/org/apache/accumulo/compactor/Compactor.java#L657-L660\r\n> > \r\n> > These values have always been zero though. Both in the logs and the metrics that use these values.\r\n> \r\n> How are you testing this? Are you running a compaction on a table via uno or something? Is the compaction lasting several minutes?\r\n\r\nYes a several minute compaction via uno.\r\n\r\n> I made the following change, and saw non-zero output.\r\n\r\nI also see the `-1` values printed when I add that line to the test.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2112542866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2112614868","html_url":"https://github.com/apache/accumulo/issues/4559#issuecomment-2112614868","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4559","id":2112614868,"node_id":"IC_kwDOACaFSM596_HU","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T13:55:39Z","updated_at":"2024-05-15T13:55:39Z","author_association":"CONTRIBUTOR","body":"> The .../sservers/host:port path should be removed if a scan server is shutdown\r\n\r\n> there should be a cleaner thread that removes scan servers that do not have a lock if the scan server was not shutdown cleanly.\r\n\r\nAgreed, sounds like these are missing. As an aside, ZooZap can clean them up, and does so on a shutdown when using `accumulo-cluster`, ref [here](https://github.com/apache/accumulo/blob/2.1/assemble/bin/accumulo-cluster#L421). ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2112614868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2112764815","html_url":"https://github.com/apache/accumulo/pull/4552#issuecomment-2112764815","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4552","id":2112764815,"node_id":"IC_kwDOACaFSM597juP","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T14:53:54Z","updated_at":"2024-05-15T14:53:54Z","author_association":"CONTRIBUTOR","body":"> This seems ok to me, is there any risk with having the state check being added in a minor release of causing anything to break on upgrade that we would not want to happen?\r\n\r\nI think the risk of this change is low because its one part of code checking another part of the code that is not configurable.  So the user can not do anything ATM that would trigger this new check.  It should only be triggered by a code change that disables recording stats when the cache is constructed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2112764815/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113117921","html_url":"https://github.com/apache/accumulo/issues/3521#issuecomment-2113117921","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3521","id":2113117921,"node_id":"IC_kwDOACaFSM59857h","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T17:49:54Z","updated_at":"2024-05-15T17:49:54Z","author_association":"CONTRIBUTOR","body":"Closed by #4486 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113117921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113171209","html_url":"https://github.com/apache/accumulo/issues/4559#issuecomment-2113171209","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4559","id":2113171209,"node_id":"IC_kwDOACaFSM599G8J","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T18:23:03Z","updated_at":"2024-05-15T18:23:03Z","author_association":"CONTRIBUTOR","body":"`CompactionCoordinator.cleanUpCompactors` performs clean up of ZooKeeper entries for Compactors that no longer exist. `LiveTServerSet.startListeningForTabletServerChanges` which is called from the Manager and the CompactionCoordinator remove ZooKeeper entries for TabletServers that no longer exist. Currently only the Client code and ZooKeeper have any reference to ScanServers. No other Accumulo process is aware of them. I can add something in the Manager that does the clean up.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113171209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113317028","html_url":"https://github.com/apache/accumulo/issues/4505#issuecomment-2113317028","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4505","id":2113317028,"node_id":"IC_kwDOACaFSM599qik","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T19:33:03Z","updated_at":"2024-05-15T19:33:03Z","author_association":"CONTRIBUTOR","body":"@keith-turner  - you might be thinking of #4239 where I modified the code such that all Tablet Servers, Scan Servers, and Compactors participated in log recovery. I'm not sure if this is something that could be backported to an earlier version as it may depend on other changes in elasticity w/r/t tablet hosting and tablet management.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113317028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113508506","html_url":"https://github.com/apache/accumulo/pull/4562#issuecomment-2113508506","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4562","id":2113508506,"node_id":"IC_kwDOACaFSM59-ZSa","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T21:47:14Z","updated_at":"2024-05-15T21:48:58Z","author_association":"CONTRIBUTOR","body":"I started to comment on the loop where the lock data was read in the loop from `getChildren` with the following:\r\n\r\n> Would it be worth it to wrap this call with another try...catch(Keeper.NO_NODE ex) to allow it to handle the case where the ephemeral lock was removed while in the main `getChildren` loop?  With no lock node, it could either delete the host:port then - or at least continue processing the other nodes.  As is, it will retry, but handling NO_NODE could  make it more responsive by processing the remaining nodes in the list. \r\n\r\nTaking no action and allowing that node to be processed on the next try would be safer.\r\n\r\nBut, could there be a race condition between the server lock code and this cleaner.  If the server lock creates the host:port node and then writes the lock there will a period where the lock does not exist, but host:port is expected to be there.  What would happen if the cleaner deletes the host:port and then the server lock write is attempted?\r\n\r\nIt may be possible to use the creation time of the host:port node (ZK stat ctime) and check that it is older than the loop retry period.  This would delay the removal for at least one cleaner cycle.  Or, the service lock code could try to recreate the host:port node.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113508506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113512857","html_url":"https://github.com/apache/accumulo/pull/4562#issuecomment-2113512857","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4562","id":2113512857,"node_id":"IC_kwDOACaFSM59-aWZ","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T21:50:57Z","updated_at":"2024-05-15T21:50:57Z","author_association":"CONTRIBUTOR","body":"I did test the code using a small, single node instance with multiple scan servers - the scan server entries were removed on a cluster restart and when killing individual scan server processes as expected.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113512857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113621224","html_url":"https://github.com/apache/accumulo/pull/4562#issuecomment-2113621224","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4562","id":2113621224,"node_id":"IC_kwDOACaFSM59-0zo","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-15T23:02:46Z","updated_at":"2024-05-15T23:02:46Z","author_association":"CONTRIBUTOR","body":"Another mitigation may be to delay the first run of the cleaners so that initialization and scan server assignments have a better chance to complete before the cleaner runs - that way seeing a lock as it is being built should not occur.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113621224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113723514","html_url":"https://github.com/apache/accumulo/pull/4563#issuecomment-2113723514","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4563","id":2113723514,"node_id":"IC_kwDOACaFSM59_Nx6","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T01:09:01Z","updated_at":"2024-05-16T01:09:01Z","author_association":"CONTRIBUTOR","body":"Was running the following in bash a bit after starting SplitMillionIT to gather JFR data.\r\n\r\n```bash\r\nfor pid in $(pgrep -f org.apache.accumulo.tserver.TabletServer); do\r\n  jcmd $pid JFR.start duration=540s filename=tserver-$(date +\"%Y%m%d%H%m\")-$pid.jfr\r\ndone  \r\n\r\nfor pid in $(pgrep -f org.apache.accumulo.manager.Manager); do\r\n  jcmd $pid JFR.start duration=540s filename=manager-$(date +\"%Y%m%d%H%m\")-$pid.jfr\r\ndone \r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2113723514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2114036857","html_url":"https://github.com/apache/accumulo/pull/4561#issuecomment-2114036857","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4561","id":2114036857,"node_id":"IC_kwDOACaFSM5-AaR5","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T05:06:53Z","updated_at":"2024-05-16T05:06:53Z","author_association":"MEMBER","body":"> I think this change could target the 2.1 branch so that it gets included in the next 2.1 patch release.\r\n\r\nthanks, will rebase","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2114036857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115089088","html_url":"https://github.com/apache/accumulo/pull/4562#issuecomment-2115089088","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4562","id":2115089088,"node_id":"IC_kwDOACaFSM5-EbLA","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T12:13:25Z","updated_at":"2024-05-16T12:13:25Z","author_association":"CONTRIBUTOR","body":"> Another mitigation may be to delay the first run of the cleaners so that initialization and scan server assignments have a better chance to complete before the cleaner runs - that way seeing a lock as it is being built should not occur.\r\n\r\nThe Manager and CompactionCoordinator don't have an initial delay when calling `LiveTServerSet.startListeningForTabletServerChanges` or `CompactionCoordinator.startCompactionCleaner`. I could make this change, but if we do, then we should do it for all of them for the same reason.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115089088/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115112341","html_url":"https://github.com/apache/accumulo/pull/4562#issuecomment-2115112341","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4562","id":2115112341,"node_id":"IC_kwDOACaFSM5-Eg2V","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T12:25:28Z","updated_at":"2024-05-16T12:25:28Z","author_association":"CONTRIBUTOR","body":"> I started to comment on the loop where the lock data was read in the loop from `getChildren` with the following:\r\n> \r\n> > Would it be worth it to wrap this call with another try...catch(Keeper.NO_NODE ex) to allow it to handle the case where the ephemeral lock was removed while in the main `getChildren` loop?  With no lock node, it could either delete the host:port then - or at least continue processing the other nodes.  As is, it will retry, but handling NO_NODE could  make it more responsive by processing the remaining nodes in the list.\r\n> \r\n> Taking no action and allowing that node to be processed on the next try would be safer.\r\n> \r\n> But, could there be a race condition between the server lock code and this cleaner. If the server lock creates the host:port node and then writes the lock there will a period where the lock does not exist, but host:port is expected to be there. What would happen if the cleaner deletes the host:port and then the server lock write is attempted?\r\n> \r\n> It may be possible to use the creation time of the host:port node (ZK stat ctime) and check that it is older than the loop retry period. This would delay the removal for at least one cleaner cycle. Or, the service lock code could try to recreate the host:port node.\r\n\r\nAre you suggesting wrapping the following line with a try/catch to catch Keeper.NO_NODE? \r\n```\r\n            byte[] lockData = ServiceLock.getLockData(getContext().getZooCache(), zLockPath, stat);\r\n```\r\n\r\nI don't think that method throws that Exception.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115112341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115173252","html_url":"https://github.com/apache/accumulo/pull/4562#issuecomment-2115173252","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4562","id":2115173252,"node_id":"IC_kwDOACaFSM5-EvuE","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T12:53:29Z","updated_at":"2024-05-16T12:53:29Z","author_association":"CONTRIBUTOR","body":"You are correct - it does not throw NO_NODE - I incorrectly assumed that getLockData would echo the ZK exceptions - but it does not,  ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115173252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115887326","html_url":"https://github.com/apache/accumulo/issues/4564#issuecomment-2115887326","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4564","id":2115887326,"node_id":"IC_kwDOACaFSM5-HeDe","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T18:06:01Z","updated_at":"2024-05-16T18:06:01Z","author_association":"CONTRIBUTOR","body":"Added this to elasticity as there are changes there that I suspect may make this much easier to implement, but that could be changed depeding on the direction this takes.  Not sure where this functionality should live in the API, shell, monitor, etc.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115887326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115922135","html_url":"https://github.com/apache/accumulo/issues/4564#issuecomment-2115922135","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4564","id":2115922135,"node_id":"IC_kwDOACaFSM5-HmjX","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T18:20:49Z","updated_at":"2024-05-16T18:20:49Z","author_association":"CONTRIBUTOR","body":"A first step on this could be a draft PR with proposed API changes that does not actually implement this APIs.  Going to try that and see what it looks like.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2115922135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2116102184","html_url":"https://github.com/apache/accumulo/pull/4566#issuecomment-2116102184","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4566","id":2116102184,"node_id":"IC_kwDOACaFSM5-ISgo","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T20:14:58Z","updated_at":"2024-05-16T20:14:58Z","author_association":"CONTRIBUTOR","body":"This is an example of using these draft APIs to print the example table in #4564\r\n\r\n```java\r\n  public void printTableCompactions(AccumuloClient client) {\r\n    client.instanceOperations().getTableCompactions().forEach(tableCompaction -> {\r\n      AtomicLong running = new AtomicLong(0);\r\n      AtomicLong completed = new AtomicLong(0);\r\n      AtomicLong total = new AtomicLong(0);\r\n      tableCompaction.getTablets().forEach(tabletInformation -> {\r\n        if (tabletInformation.getCompletedTableCompactions().contains(tableCompaction.getId())) {\r\n          completed.incrementAndGet();\r\n        }\r\n\r\n        for (var runningCompaction : tabletInformation.getRunningCompactions()) {\r\n          if (runningCompaction.getTableCompactionId()\r\n              .map(tcid -> tcid.equals(tableCompaction.getId())).orElse(false)) {\r\n            running.incrementAndGet();\r\n          }\r\n        }\r\n\r\n        total.incrementAndGet();\r\n      });\r\n\r\n      var id = tableCompaction.getId();\r\n      var table = tableCompaction.getTableName();\r\n      var startRow = tableCompaction.getConfig().getStartRow();\r\n      var endRow = tableCompaction.getConfig().getEndRow();\r\n      var startTime = tableCompaction.getStartTime();\r\n      var config = tableCompaction.getConfig();\r\n\r\n      System.out.printf(\"%s %s %s %s %s %,d %,d %,d %s\\n\", id, table, startRow, endRow, startTime,\r\n          completed.get(), running.get(), total.get(), config);\r\n    });\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2116102184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2116115508","html_url":"https://github.com/apache/accumulo/issues/4495#issuecomment-2116115508","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4495","id":2116115508,"node_id":"IC_kwDOACaFSM5-IVw0","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T20:24:05Z","updated_at":"2024-05-16T20:24:05Z","author_association":"CONTRIBUTOR","body":"Can be closed with https://github.com/apache/accumulo/pull/4567","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2116115508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2116124841","html_url":"https://github.com/apache/accumulo/pull/4566#issuecomment-2116124841","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4566","id":2116124841,"node_id":"IC_kwDOACaFSM5-IYCp","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T20:29:56Z","updated_at":"2024-05-16T20:29:56Z","author_association":"CONTRIBUTOR","body":"The existing `listcompactions` command in the shell could have a new option that takes a table compaction id.  This would allow listing all table compactions and then listing all the running compactions for a specific table compaction.  Added the method `TableCompaction getTableCompaction(TableCompactionId tcid)` to `InstanceOperations` in this draft to support that use case.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2116124841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2116149142","html_url":"https://github.com/apache/accumulo/issues/4505#issuecomment-2116149142","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4505","id":2116149142,"node_id":"IC_kwDOACaFSM5-Id-W","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-16T20:47:23Z","updated_at":"2024-05-16T20:47:23Z","author_association":"CONTRIBUTOR","body":"> @keith-turner - you might be thinking of https://github.com/apache/accumulo/pull/4239 where I modified the code such that all Tablet Servers, Scan Servers, and Compactors participated in log recovery. I'm not sure if this is something that could be backported to an earlier version as it may depend on other changes in elasticity w/r/t tablet hosting and tablet management.\r\n\r\nThat change could speed up log sorting.  The problem in this issue happens after the logs are sorted and when tablets w/ sorted walogs are loaded on a tablet server.  Tablet severs only load one tablet w/ walogs at time which is what makes things slow.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2116149142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117492349","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2117492349","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2117492349,"node_id":"IC_kwDOACaFSM5-Nl59","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T12:29:26Z","updated_at":"2024-05-17T12:29:26Z","author_association":"CONTRIBUTOR","body":"Did you compare the test time before and after the changes? Just curious on the performance difference.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117492349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117516447","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2117516447","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2117516447,"node_id":"IC_kwDOACaFSM5-Nryf","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T12:41:35Z","updated_at":"2024-05-17T12:41:35Z","author_association":"CONTRIBUTOR","body":"> Changed a stream to compute file size sum into a loop.\r\n\r\nThis is the Nth time where we are undo-ing stream operations for performance reasons...","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117516447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117559563","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2117559563","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2117559563,"node_id":"IC_kwDOACaFSM5-N2UL","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T13:03:53Z","updated_at":"2024-05-17T13:03:53Z","author_association":"CONTRIBUTOR","body":"I just noticed #4563 , so really for a valid test for the time different should likely test after merging in both these changes and those changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117559563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117616728","html_url":"https://github.com/apache/accumulo/pull/4513#issuecomment-2117616728","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4513","id":2117616728,"node_id":"IC_kwDOACaFSM5-OERY","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T13:31:30Z","updated_at":"2024-05-17T13:31:30Z","author_association":"MEMBER","body":"A more descriptive name for this IT might be better. `ServerVersionIT` is a bit vague. Maybe something that hints at what is being tested here about the servers not starting due to data version.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117616728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117726269","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2117726269","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2117726269,"node_id":"IC_kwDOACaFSM5-OfA9","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T14:23:28Z","updated_at":"2024-05-17T14:24:56Z","author_association":"CONTRIBUTOR","body":"> Did you compare the test time before and after the changes? Just curious on the performance difference.\r\n\r\nYeah I did see a significant performance increase for scanning 1 million tablets.  Sampling the logs where the manager logs how long a full scan of the metadata table took saw it was about 1.3 to 1.4 times faster.  Suspect the change to wholerow iterator contributes most of that, but not sure.   For each individual change the way I know it has an impact is that the code changed will be much less prominent in the profiling data.  So I don't have timing for each thing, just see it drop off in the profiling data.   Once something drops off in the profiling data, then other things will start to show up as more prominent.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117726269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117846429","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2117846429","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2117846429,"node_id":"IC_kwDOACaFSM5-O8Wd","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T15:27:08Z","updated_at":"2024-05-17T15:27:08Z","author_association":"CONTRIBUTOR","body":"We should probably run a full IT build on this PR before merging.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117846429/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117942635","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2117942635","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2117942635,"node_id":"IC_kwDOACaFSM5-PT1r","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T16:17:58Z","updated_at":"2024-05-17T16:18:50Z","author_association":"CONTRIBUTOR","body":"Without the changes from this PR and #4563 seeing SplitMillionIT take a total of 11 min 8 sec (upped the timeout).  Below are some highlights from the logs.\r\n\r\n```\r\n2024-05-17T11:16:28,184 32 [functional.SplitMillionIT] INFO : Time to compact all tablets : 177606ms\r\n2024-05-17T11:16:28,297 32 [functional.SplitMillionIT] INFO : Time to verify 200 rows was 113ms\r\n2024-05-17T11:17:04,720 32 [functional.SplitMillionIT] INFO : Time to clone table : 36422ms\r\n2024-05-17T11:17:05,433 32 [clientImpl.ClientTabletCacheImpl] DEBUG: Requesting hosting for 100 ondemand tablets for table id 2.\r\n2024-05-17T11:17:27,405 32 [functional.SplitMillionIT] INFO : Time to verify 200 rows was 22685ms\r\n2024-05-17T11:20:35,323 32 [functional.SplitMillionIT] INFO : Time to merge all tablets : 187917ms\r\n2024-05-17T11:20:36,123 745 [clientImpl.ClientTabletCacheImpl] DEBUG: Requesting hosting for 1 ondemand tablets for table id 2.\r\n2024-05-17T11:20:41,610 32 [functional.SplitMillionIT] INFO : Time to verify 200 rows was 6287ms\r\n2024-05-17T11:22:13,490 32 [functional.SplitMillionIT] INFO : Time to delete table : 91880ms\r\n```\r\n\r\n\r\nWith the changes from this PR and #4563 seeing SplitMillionIT take a total of 9 min 44 sec.  Its squeaking by under the 10 min threshold. Still seems like it used to be faster when running it locally.  Below are some highlights.  See noticeable improvements in compact and delete table, but not merge.  I think merge is what I need to look into next.  Also going to open an issue about improving the time to host ondemand tablets based on some thing I have seen.  Below and above where it request hosting of 100 tablets and takes 10s of seconds that should be much much faster.  Part of the reason that was slow was because of how long it takes to scan all of the metadata, which is what lead to opening this PR.  However more could be done to improve on demand hosting. \r\n\r\n```\r\n2024-05-17T11:41:05,680 34 [functional.SplitMillionIT] INFO : Time to compact all tablets : 148425ms\r\n2024-05-17T11:41:05,817 34 [functional.SplitMillionIT] INFO : Time to verify 200 rows was 137ms\r\n2024-05-17T11:41:32,089 34 [functional.SplitMillionIT] INFO : Time to clone table : 26271ms\r\n2024-05-17T11:41:32,813 34 [clientImpl.ClientTabletCacheImpl] DEBUG: Requesting hosting for 100 ondemand tablets for table id 2.\r\n2024-05-17T11:41:45,478 34 [functional.SplitMillionIT] INFO : Time to verify 200 rows was 13389ms\r\n2024-05-17T11:44:49,188 34 [functional.SplitMillionIT] INFO : Time to merge all tablets : 183710ms\r\n2024-05-17T11:44:49,445 747 [clientImpl.ClientTabletCacheImpl] DEBUG: Requesting hosting for 1 ondemand tablets for table id 2.\r\n2024-05-17T11:44:50,221 34 [functional.SplitMillionIT] INFO : Time to verify 200 rows was 1033ms\r\n2024-05-17T11:46:08,001 34 [functional.SplitMillionIT] INFO : Time to delete table : 77780ms\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117942635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117951987","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2117951987","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2117951987,"node_id":"IC_kwDOACaFSM5-PWHz","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T16:24:55Z","updated_at":"2024-05-17T16:24:55Z","author_association":"CONTRIBUTOR","body":"I wonder if there is a way to make Tablet hosting faster\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117951987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117957215","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2117957215","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2117957215,"node_id":"IC_kwDOACaFSM5-PXZf","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T16:28:07Z","updated_at":"2024-05-17T16:28:07Z","author_association":"CONTRIBUTOR","body":"> I wonder if there is a way to make Tablet hosting faster\r\n\r\nHave a possible way, not complete sure about it.  Going to open an issue","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117957215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117957782","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2117957782","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2117957782,"node_id":"IC_kwDOACaFSM5-PXiW","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T16:28:25Z","updated_at":"2024-05-17T16:28:25Z","author_association":"CONTRIBUTOR","body":"MANAGER_TABLET_GROUP_WATCHER_INTERVAL defaults to 5s in MiniAccumuloClusterImpl. Can override in the test.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2117957782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118009607","html_url":"https://github.com/apache/accumulo/pull/4568#issuecomment-2118009607","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4568","id":2118009607,"node_id":"IC_kwDOACaFSM5-PkMH","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T16:55:24Z","updated_at":"2024-05-17T16:56:34Z","author_association":"CONTRIBUTOR","body":"@dlmarion opened #4571. In that issue propose a possible way to speed up tablet hosting by replacing the `requestToHost` column w/ `future` and directly calling balancer and sending tablet server load tablet RPCs.  Also in that issue documented how I was seeing the fallout from cloning 1 million tablets impact the hosting request because it tied up TGW.  So was hoping we could completely decouple the hosting request from TGW inorder to speed it up. Realized setting future still allows the request to be fault tolerant.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118009607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118018099","html_url":"https://github.com/apache/accumulo/issues/4571#issuecomment-2118018099","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4571","id":2118018099,"node_id":"IC_kwDOACaFSM5-PmQz","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T17:00:11Z","updated_at":"2024-05-17T17:00:11Z","author_association":"CONTRIBUTOR","body":"The client side tablet location cache looks at the `requestToHost` column to attempt to be aware of another client process requesting to host the same tablet.   That code could use the `future` column for the same purpose.  If it sees `future` set, then it knows that it does not need to ask the manager to host the tablet.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118018099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118151359","html_url":"https://github.com/apache/accumulo/issues/4569#issuecomment-2118151359","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4569","id":2118151359,"node_id":"IC_kwDOACaFSM5-QGy_","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T18:14:57Z","updated_at":"2024-05-17T18:14:57Z","author_association":"MEMBER","body":"I can take a look at this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118151359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118248637","html_url":"https://github.com/apache/accumulo/pull/4558#issuecomment-2118248637","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4558","id":2118248637,"node_id":"IC_kwDOACaFSM5-Qei9","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T19:29:43Z","updated_at":"2024-05-17T19:29:43Z","author_association":"CONTRIBUTOR","body":"> I left a few comments, primarily around how the cache is implemented and used I think should be changed. But the other big thing is I am thinking this custom logic would be better implemented using the [Filter](https://logging.apache.org/log4j/2.x/manual/extending.html#filters) API that is part of log4j2. I think we could create a custom filter and put the conditional logic in there instead of having to implement a new ConditionalLogger class. The nice thing about a filter too is it is configurable at runtime easily.\r\n\r\nBut we are coding to the slf4j api. A user using log4j2 is a deployment decision, someone could swap it out for logback or something else.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118248637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118296585","html_url":"https://github.com/apache/accumulo/issues/4399#issuecomment-2118296585","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4399","id":2118296585,"node_id":"IC_kwDOACaFSM5-QqQJ","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T19:54:42Z","updated_at":"2024-05-17T19:54:42Z","author_association":"MEMBER","body":"Closed via #4466 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118296585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118313482","html_url":"https://github.com/apache/accumulo/pull/4561#issuecomment-2118313482","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4561","id":2118313482,"node_id":"IC_kwDOACaFSM5-QuYK","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T20:09:09Z","updated_at":"2024-05-17T20:09:09Z","author_association":"CONTRIBUTOR","body":"@findepi  - we have a code formatter that runs as part of our build, and we verify that here, which is currently failing. Running `mvn compile` should fix the source.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118313482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118320226","html_url":"https://github.com/apache/accumulo/pull/4572#issuecomment-2118320226","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4572","id":2118320226,"node_id":"IC_kwDOACaFSM5-QwBi","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T20:14:53Z","updated_at":"2024-05-17T20:14:53Z","author_association":"CONTRIBUTOR","body":"#4553 says to add additional Compactor metrics, but I have to assume that we would want these for internal compactions too, right @ddanielr ?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118320226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118342641","html_url":"https://github.com/apache/accumulo/pull/4558#issuecomment-2118342641","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4558","id":2118342641,"node_id":"IC_kwDOACaFSM5-Q1fx","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T20:28:56Z","updated_at":"2024-05-17T20:28:56Z","author_association":"CONTRIBUTOR","body":"> But we are coding to the slf4j api. A user using log4j2 is a deployment decision, someone could swap it out for logback or something else.\r\n\r\nThat's a fair point, I'm not sure it's very likely someone would replace that too often but it's possible. I guess in that guess it wouldn't break per se, but it would just start logging a lot of extra stuff of course.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118342641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118358155","html_url":"https://github.com/apache/accumulo/pull/4572#issuecomment-2118358155","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4572","id":2118358155,"node_id":"IC_kwDOACaFSM5-Q5SL","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T20:42:43Z","updated_at":"2024-05-17T20:42:43Z","author_association":"CONTRIBUTOR","body":"Yes, adding them for internal compactions would be good","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118358155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118388074","html_url":"https://github.com/apache/accumulo/pull/4561#issuecomment-2118388074","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4561","id":2118388074,"node_id":"IC_kwDOACaFSM5-RAlq","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-05-17T21:10:39Z","updated_at":"2024-05-17T21:10:39Z","author_association":"CONTRIBUTOR","body":"I kicked off a full IT build for this branch.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2118388074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]