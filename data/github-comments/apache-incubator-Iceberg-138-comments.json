[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002157812","html_url":"https://github.com/apache/iceberg/issues/2490#issuecomment-1002157812","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2490","id":1002157812,"node_id":"IC_kwDOCW7NX847u7b0","user":{"login":"shay1bz","id":35406867,"node_id":"MDQ6VXNlcjM1NDA2ODY3","avatar_url":"https://avatars.githubusercontent.com/u/35406867?v=4","gravatar_id":"","url":"https://api.github.com/users/shay1bz","html_url":"https://github.com/shay1bz","followers_url":"https://api.github.com/users/shay1bz/followers","following_url":"https://api.github.com/users/shay1bz/following{/other_user}","gists_url":"https://api.github.com/users/shay1bz/gists{/gist_id}","starred_url":"https://api.github.com/users/shay1bz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shay1bz/subscriptions","organizations_url":"https://api.github.com/users/shay1bz/orgs","repos_url":"https://api.github.com/users/shay1bz/repos","events_url":"https://api.github.com/users/shay1bz/events{/privacy}","received_events_url":"https://api.github.com/users/shay1bz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T15:26:10Z","updated_at":"2021-12-28T15:26:10Z","author_association":"NONE","body":"Thanks @RussellSpitzer . I'm using 0.12.1 so I did not see this addition. Do you have any idea when is the next release? I prefer to use release package rather than custom build. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002157812/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002179576","html_url":"https://github.com/apache/iceberg/pull/3813#issuecomment-1002179576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3813","id":1002179576,"node_id":"IC_kwDOCW7NX847vAv4","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T16:15:16Z","updated_at":"2021-12-28T16:15:16Z","author_association":"CONTRIBUTOR","body":"@jackye1995 mind reviewing this when you get a chance. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002179576/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002225835","html_url":"https://github.com/apache/iceberg/pull/3801#issuecomment-1002225835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3801","id":1002225835,"node_id":"IC_kwDOCW7NX847vMCr","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T18:14:18Z","updated_at":"2021-12-28T18:14:18Z","author_association":"CONTRIBUTOR","body":"> I think this looks good to me for the fix, I think we should aim to try to get a more deterministic test, the faking of the hash value seems pretty doable but if that's not possible I am fine with the current state. Let's try to get that test cleaned up a bit and make sure it doesn't leave to much junk behind when it is done.\r\n\r\nI changed the test a little to remove the random stuff and cleanup the created tables :smile: ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002225835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002319751","html_url":"https://github.com/apache/iceberg/pull/3811#issuecomment-1002319751","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3811","id":1002319751,"node_id":"IC_kwDOCW7NX847vi-H","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T23:22:58Z","updated_at":"2021-12-28T23:22:58Z","author_association":"CONTRIBUTOR","body":"I'm actually for making this change.  I can't really see a downside and most systems default to a single core for driver (k8s and YARN).  I feel like any edge case where this would result in worse performance is better to leave to tuning and make the default result in better performance.\r\n\r\n+1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002319751/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002319936","html_url":"https://github.com/apache/iceberg/pull/3811#issuecomment-1002319936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3811","id":1002319936,"node_id":"IC_kwDOCW7NX847vjBA","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T23:23:35Z","updated_at":"2021-12-28T23:23:35Z","author_association":"CONTRIBUTOR","body":"Thanks @bryanck !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002319936/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002627516","html_url":"https://github.com/apache/iceberg/issues/3062#issuecomment-1002627516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3062","id":1002627516,"node_id":"IC_kwDOCW7NX847wuG8","user":{"login":"fcvr1010","id":17031474,"node_id":"MDQ6VXNlcjE3MDMxNDc0","avatar_url":"https://avatars.githubusercontent.com/u/17031474?v=4","gravatar_id":"","url":"https://api.github.com/users/fcvr1010","html_url":"https://github.com/fcvr1010","followers_url":"https://api.github.com/users/fcvr1010/followers","following_url":"https://api.github.com/users/fcvr1010/following{/other_user}","gists_url":"https://api.github.com/users/fcvr1010/gists{/gist_id}","starred_url":"https://api.github.com/users/fcvr1010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fcvr1010/subscriptions","organizations_url":"https://api.github.com/users/fcvr1010/orgs","repos_url":"https://api.github.com/users/fcvr1010/repos","events_url":"https://api.github.com/users/fcvr1010/events{/privacy}","received_events_url":"https://api.github.com/users/fcvr1010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T14:41:50Z","updated_at":"2021-12-29T14:41:50Z","author_association":"NONE","body":"Thank you @danielcweeks, @prodeezy, @kbendick for the feedback (and sorry for my very late reply but we had to pause our investigation into Iceberg for a bit).\r\n\r\nIf I understand correctly, [SPARK-37578](https://issues.apache.org/jira/browse/SPARK-37578) is about output metrics and should be fixed in Spark 3.3. I noticed that input metrics were missing too, not sure if this would be covered by [SPARK-37585](https://issues.apache.org/jira/browse/SPARK-37585) which seems to be about a corner case. Were you able to obtain input metrics when using S3?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002627516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002637717","html_url":"https://github.com/apache/iceberg/issues/3055#issuecomment-1002637717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3055","id":1002637717,"node_id":"IC_kwDOCW7NX847wwmV","user":{"login":"fcvr1010","id":17031474,"node_id":"MDQ6VXNlcjE3MDMxNDc0","avatar_url":"https://avatars.githubusercontent.com/u/17031474?v=4","gravatar_id":"","url":"https://api.github.com/users/fcvr1010","html_url":"https://github.com/fcvr1010","followers_url":"https://api.github.com/users/fcvr1010/followers","following_url":"https://api.github.com/users/fcvr1010/following{/other_user}","gists_url":"https://api.github.com/users/fcvr1010/gists{/gist_id}","starred_url":"https://api.github.com/users/fcvr1010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fcvr1010/subscriptions","organizations_url":"https://api.github.com/users/fcvr1010/orgs","repos_url":"https://api.github.com/users/fcvr1010/repos","events_url":"https://api.github.com/users/fcvr1010/events{/privacy}","received_events_url":"https://api.github.com/users/fcvr1010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T15:04:05Z","updated_at":"2021-12-29T15:04:05Z","author_association":"NONE","body":"@rdblue thanks for your feedback and really sorry about my super late reply but we had to pause our Iceberg investigations for a bit. As soon as I get the chance to test this again, I'll let you know.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002637717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002646866","html_url":"https://github.com/apache/iceberg/issues/2991#issuecomment-1002646866","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2991","id":1002646866,"node_id":"IC_kwDOCW7NX847wy1S","user":{"login":"fcvr1010","id":17031474,"node_id":"MDQ6VXNlcjE3MDMxNDc0","avatar_url":"https://avatars.githubusercontent.com/u/17031474?v=4","gravatar_id":"","url":"https://api.github.com/users/fcvr1010","html_url":"https://github.com/fcvr1010","followers_url":"https://api.github.com/users/fcvr1010/followers","following_url":"https://api.github.com/users/fcvr1010/following{/other_user}","gists_url":"https://api.github.com/users/fcvr1010/gists{/gist_id}","starred_url":"https://api.github.com/users/fcvr1010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fcvr1010/subscriptions","organizations_url":"https://api.github.com/users/fcvr1010/orgs","repos_url":"https://api.github.com/users/fcvr1010/repos","events_url":"https://api.github.com/users/fcvr1010/events{/privacy}","received_events_url":"https://api.github.com/users/fcvr1010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T15:23:23Z","updated_at":"2021-12-29T15:23:23Z","author_association":"NONE","body":"Thanks a lot @jackye1995, @rajarshisarkar! I look forward to trying this out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002646866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002661397","html_url":"https://github.com/apache/iceberg/issues/2181#issuecomment-1002661397","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2181","id":1002661397,"node_id":"IC_kwDOCW7NX847w2YV","user":{"login":"andrefranciscol","id":78030933,"node_id":"MDQ6VXNlcjc4MDMwOTMz","avatar_url":"https://avatars.githubusercontent.com/u/78030933?v=4","gravatar_id":"","url":"https://api.github.com/users/andrefranciscol","html_url":"https://github.com/andrefranciscol","followers_url":"https://api.github.com/users/andrefranciscol/followers","following_url":"https://api.github.com/users/andrefranciscol/following{/other_user}","gists_url":"https://api.github.com/users/andrefranciscol/gists{/gist_id}","starred_url":"https://api.github.com/users/andrefranciscol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrefranciscol/subscriptions","organizations_url":"https://api.github.com/users/andrefranciscol/orgs","repos_url":"https://api.github.com/users/andrefranciscol/repos","events_url":"https://api.github.com/users/andrefranciscol/events{/privacy}","received_events_url":"https://api.github.com/users/andrefranciscol/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T15:55:31Z","updated_at":"2021-12-29T15:55:31Z","author_association":"NONE","body":"I'm facing the same problem. same error when launching flink job, and when executing in the flink SQL shell. @Simmyo Did you find any clue about this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002661397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002760279","html_url":"https://github.com/apache/iceberg/pull/3812#issuecomment-1002760279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3812","id":1002760279,"node_id":"IC_kwDOCW7NX847xOhX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T20:13:46Z","updated_at":"2021-12-29T20:13:46Z","author_association":"CONTRIBUTOR","body":"Thanks, @bryanck!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002760279/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002762363","html_url":"https://github.com/apache/iceberg/pull/3801#issuecomment-1002762363","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3801","id":1002762363,"node_id":"IC_kwDOCW7NX847xPB7","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T20:19:54Z","updated_at":"2021-12-29T20:19:54Z","author_association":"CONTRIBUTOR","body":"Looks good. Thanks for getting this done, @racevedoo!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002762363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002763536","html_url":"https://github.com/apache/iceberg/pull/3799#issuecomment-1002763536","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3799","id":1002763536,"node_id":"IC_kwDOCW7NX847xPUQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T20:23:02Z","updated_at":"2021-12-29T20:23:02Z","author_association":"CONTRIBUTOR","body":"@izchen, why did you close this? It looks like this test should be running. @wypoon, any idea why this tests was disabled?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002763536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002769850","html_url":"https://github.com/apache/iceberg/pull/3645#issuecomment-1002769850","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3645","id":1002769850,"node_id":"IC_kwDOCW7NX847xQ26","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T20:43:28Z","updated_at":"2021-12-29T20:43:28Z","author_association":"CONTRIBUTOR","body":"Thanks, @hbgstc123! Sorry for the delay. Many of us have been out for holidays.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002769850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002773223","html_url":"https://github.com/apache/iceberg/pull/3799#issuecomment-1002773223","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3799","id":1002773223,"node_id":"IC_kwDOCW7NX847xRrn","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T20:55:38Z","updated_at":"2021-12-29T20:55:38Z","author_association":"CONTRIBUTOR","body":"Hmm, looks like an oversight on my part when porting the change to v3.0. It should have the `@Test` annotation. However, I am on vacation, don't have my work machine at hand, and not able to test it at the moment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002773223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002781570","html_url":"https://github.com/apache/iceberg/pull/3799#issuecomment-1002781570","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3799","id":1002781570,"node_id":"IC_kwDOCW7NX847xTuC","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T21:24:58Z","updated_at":"2021-12-29T21:24:58Z","author_association":"CONTRIBUTOR","body":"Enjoy your vacation! We'll have to track this down, but I don't think there's a rush.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002781570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002787380","html_url":"https://github.com/apache/iceberg/pull/3752#issuecomment-1002787380","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3752","id":1002787380,"node_id":"IC_kwDOCW7NX847xVI0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T21:45:20Z","updated_at":"2021-12-29T21:45:20Z","author_association":"CONTRIBUTOR","body":"Looks good now that this is Hive-only. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002787380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002793960","html_url":"https://github.com/apache/iceberg/pull/3819#issuecomment-1002793960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3819","id":1002793960,"node_id":"IC_kwDOCW7NX847xWvo","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T22:10:00Z","updated_at":"2021-12-29T22:10:00Z","author_association":"CONTRIBUTOR","body":"@hililiwei, there is no need to open an issue when you intend to open a PR soon after. There's no requirement that a PR is associated with an issue and creating an issue with the same summary and description as a PR is just creates unnecessary work. Feel free to just open the PR directly next time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002793960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002799300","html_url":"https://github.com/apache/iceberg/pull/3815#issuecomment-1002799300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3815","id":1002799300,"node_id":"IC_kwDOCW7NX847xYDE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-29T22:31:44Z","updated_at":"2021-12-29T22:31:44Z","author_association":"CONTRIBUTOR","body":"@findepi, can you take a look at this also?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002799300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002835899","html_url":"https://github.com/apache/iceberg/pull/3645#issuecomment-1002835899","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3645","id":1002835899,"node_id":"IC_kwDOCW7NX847xg-7","user":{"login":"hbgstc123","id":8900183,"node_id":"MDQ6VXNlcjg5MDAxODM=","avatar_url":"https://avatars.githubusercontent.com/u/8900183?v=4","gravatar_id":"","url":"https://api.github.com/users/hbgstc123","html_url":"https://github.com/hbgstc123","followers_url":"https://api.github.com/users/hbgstc123/followers","following_url":"https://api.github.com/users/hbgstc123/following{/other_user}","gists_url":"https://api.github.com/users/hbgstc123/gists{/gist_id}","starred_url":"https://api.github.com/users/hbgstc123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbgstc123/subscriptions","organizations_url":"https://api.github.com/users/hbgstc123/orgs","repos_url":"https://api.github.com/users/hbgstc123/repos","events_url":"https://api.github.com/users/hbgstc123/events{/privacy}","received_events_url":"https://api.github.com/users/hbgstc123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T01:31:39Z","updated_at":"2021-12-30T01:31:39Z","author_association":"CONTRIBUTOR","body":"happy holidays","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002835899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002850916","html_url":"https://github.com/apache/iceberg/pull/3728#issuecomment-1002850916","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3728","id":1002850916,"node_id":"IC_kwDOCW7NX847xkpk","user":{"login":"xiaotianzhang01","id":17720945,"node_id":"MDQ6VXNlcjE3NzIwOTQ1","avatar_url":"https://avatars.githubusercontent.com/u/17720945?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaotianzhang01","html_url":"https://github.com/xiaotianzhang01","followers_url":"https://api.github.com/users/xiaotianzhang01/followers","following_url":"https://api.github.com/users/xiaotianzhang01/following{/other_user}","gists_url":"https://api.github.com/users/xiaotianzhang01/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaotianzhang01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaotianzhang01/subscriptions","organizations_url":"https://api.github.com/users/xiaotianzhang01/orgs","repos_url":"https://api.github.com/users/xiaotianzhang01/repos","events_url":"https://api.github.com/users/xiaotianzhang01/events{/privacy}","received_events_url":"https://api.github.com/users/xiaotianzhang01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T02:57:01Z","updated_at":"2021-12-30T02:57:01Z","author_association":"CONTRIBUTOR","body":"@rdblue Thank you very much for your review!  I have addressed your comments","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002850916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002858253","html_url":"https://github.com/apache/iceberg/pull/3806#issuecomment-1002858253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3806","id":1002858253,"node_id":"IC_kwDOCW7NX847xmcN","user":{"login":"lipusheng","id":57984409,"node_id":"MDQ6VXNlcjU3OTg0NDA5","avatar_url":"https://avatars.githubusercontent.com/u/57984409?v=4","gravatar_id":"","url":"https://api.github.com/users/lipusheng","html_url":"https://github.com/lipusheng","followers_url":"https://api.github.com/users/lipusheng/followers","following_url":"https://api.github.com/users/lipusheng/following{/other_user}","gists_url":"https://api.github.com/users/lipusheng/gists{/gist_id}","starred_url":"https://api.github.com/users/lipusheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lipusheng/subscriptions","organizations_url":"https://api.github.com/users/lipusheng/orgs","repos_url":"https://api.github.com/users/lipusheng/repos","events_url":"https://api.github.com/users/lipusheng/events{/privacy}","received_events_url":"https://api.github.com/users/lipusheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T03:33:23Z","updated_at":"2021-12-30T03:33:23Z","author_association":"NONE","body":"@kbendick can you help me merge this pull request, thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002858253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002896840","html_url":"https://github.com/apache/iceberg/pull/3820#issuecomment-1002896840","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3820","id":1002896840,"node_id":"IC_kwDOCW7NX847xv3I","user":{"login":"xiaotianzhang01","id":17720945,"node_id":"MDQ6VXNlcjE3NzIwOTQ1","avatar_url":"https://avatars.githubusercontent.com/u/17720945?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaotianzhang01","html_url":"https://github.com/xiaotianzhang01","followers_url":"https://api.github.com/users/xiaotianzhang01/followers","following_url":"https://api.github.com/users/xiaotianzhang01/following{/other_user}","gists_url":"https://api.github.com/users/xiaotianzhang01/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaotianzhang01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaotianzhang01/subscriptions","organizations_url":"https://api.github.com/users/xiaotianzhang01/orgs","repos_url":"https://api.github.com/users/xiaotianzhang01/repos","events_url":"https://api.github.com/users/xiaotianzhang01/events{/privacy}","received_events_url":"https://api.github.com/users/xiaotianzhang01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T06:54:28Z","updated_at":"2021-12-30T06:54:28Z","author_association":"CONTRIBUTOR","body":"In addition, I would like to know whether the partition field can be set by WRITE DISTRIBUTED BY, how we designed it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002896840/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002927524","html_url":"https://github.com/apache/iceberg/issues/3821#issuecomment-1002927524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3821","id":1002927524,"node_id":"IC_kwDOCW7NX847x3Wk","user":{"login":"SusurHe","id":51081799,"node_id":"MDQ6VXNlcjUxMDgxNzk5","avatar_url":"https://avatars.githubusercontent.com/u/51081799?v=4","gravatar_id":"","url":"https://api.github.com/users/SusurHe","html_url":"https://github.com/SusurHe","followers_url":"https://api.github.com/users/SusurHe/followers","following_url":"https://api.github.com/users/SusurHe/following{/other_user}","gists_url":"https://api.github.com/users/SusurHe/gists{/gist_id}","starred_url":"https://api.github.com/users/SusurHe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SusurHe/subscriptions","organizations_url":"https://api.github.com/users/SusurHe/orgs","repos_url":"https://api.github.com/users/SusurHe/repos","events_url":"https://api.github.com/users/SusurHe/events{/privacy}","received_events_url":"https://api.github.com/users/SusurHe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T08:41:37Z","updated_at":"2021-12-30T08:41:37Z","author_association":"NONE","body":"i find the exception happen in `AlignRowLevelOperations`, but I have a question: How did 'assignments' come from","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002927524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002952920","html_url":"https://github.com/apache/iceberg/issues/3814#issuecomment-1002952920","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3814","id":1002952920,"node_id":"IC_kwDOCW7NX847x9jY","user":{"login":"ChaomingZhangCN","id":72908278,"node_id":"MDQ6VXNlcjcyOTA4Mjc4","avatar_url":"https://avatars.githubusercontent.com/u/72908278?v=4","gravatar_id":"","url":"https://api.github.com/users/ChaomingZhangCN","html_url":"https://github.com/ChaomingZhangCN","followers_url":"https://api.github.com/users/ChaomingZhangCN/followers","following_url":"https://api.github.com/users/ChaomingZhangCN/following{/other_user}","gists_url":"https://api.github.com/users/ChaomingZhangCN/gists{/gist_id}","starred_url":"https://api.github.com/users/ChaomingZhangCN/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChaomingZhangCN/subscriptions","organizations_url":"https://api.github.com/users/ChaomingZhangCN/orgs","repos_url":"https://api.github.com/users/ChaomingZhangCN/repos","events_url":"https://api.github.com/users/ChaomingZhangCN/events{/privacy}","received_events_url":"https://api.github.com/users/ChaomingZhangCN/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T09:52:46Z","updated_at":"2021-12-30T09:52:46Z","author_association":"CONTRIBUTOR","body":"@Initial-neko IMO, set the column value of `data2` to `null` is within expectation. Perhaps you can try like this:\r\n```sql\r\nINSERT INTO t SELECT id, 3, data2 FROM t WHERE id = 1;\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002952920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002999685","html_url":"https://github.com/apache/iceberg/issues/3826#issuecomment-1002999685","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3826","id":1002999685,"node_id":"IC_kwDOCW7NX847yI-F","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T12:03:25Z","updated_at":"2021-12-30T12:03:25Z","author_association":"MEMBER","body":"Please in the future post the versions of the software you are using, this particular error is a Spark 3.0 error that is solved in Spark 3.1. \r\n\r\nSpark 3.0 only supports 2 conditions in a merge statement in the parser and has restrictions on their type while 3.1 supports an unlimited amount.\r\nhttps://issues.apache.org/jira/browse/SPARK-32030\r\n\r\nhttps://github.com/apache/spark/pull/28875/files#diff-26fe6b511f4b8aedf5bdffae0d7c03aba69463c09fa4f881d77520125796e0faL476-L477\r\n\r\nTo fix this issue use Spark 3.1 or greater, ideally you should always use the latest Spark if you want to take advantage of the latest features.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002999685/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003000664","html_url":"https://github.com/apache/iceberg/issues/3825#issuecomment-1003000664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3825","id":1003000664,"node_id":"IC_kwDOCW7NX847yJNY","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T12:05:57Z","updated_at":"2021-12-30T12:05:57Z","author_association":"MEMBER","body":"What would you like an example of the Java API doing? There are a large number of tests in the repository which I usually use as a fallback when I forget how something works. What specifically are you looking for?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003000664/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003110958","html_url":"https://github.com/apache/iceberg/issues/3828#issuecomment-1003110958","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3828","id":1003110958,"node_id":"IC_kwDOCW7NX847ykIu","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T17:04:48Z","updated_at":"2021-12-30T17:04:48Z","author_association":"MEMBER","body":"The error looks like you are missing dependencies of the Hadoop-S3\nFilesystem api. Specifically some dep of Hadoop-aws. There is a bug noted\nhere\nhttps://issues.apache.org/jira/browse/HADOOP-16080 which says that the\nissue is fixed as of 3.2.2 so I would double check that your runtime Hadoop\nversions are correct.\n\nOn Thu, Dec 30, 2021 at 10:32 AM Prithvi D ***@***.***> wrote:\n\n> Unable to create basic iceberg table(stored on S3) with Spark\n>\n> spark.sql(\"CREATE TABLE table32 (id bigint, data string) USING iceberg\")\n>\n> ---------------------------------------------------------------------------\n> Py4JJavaError                             Traceback (most recent call last)\n> /tmp/ipykernel_15/955019638.py in <module>\n> ----> 1 spark.sql(\"CREATE TABLE table32 (id bigint, data string) USING iceberg\")\n>\n> /opt/spark/python/pyspark/sql/session.py in sql(self, sqlQuery)\n>     721         [Row(f1=1, f2='row1'), Row(f1=2, f2='row2'), Row(f1=3, f2='row3')]\n>     722         \"\"\"\n> --> 723         return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)\n>     724\n>     725     def table(self, tableName):\n>\n> /usr/local/lib/python3.9/dist-packages/py4j/java_gateway.py in __call__(self, *args)\n>    1302\n>    1303         answer = self.gateway_client.send_command(command)\n> -> 1304         return_value = get_return_value(\n>    1305             answer, self.gateway_client, self.target_id, self.name)\n>    1306\n>\n> /opt/spark/python/pyspark/sql/utils.py in deco(*a, **kw)\n>     109     def deco(*a, **kw):\n>     110         try:\n> --> 111             return f(*a, **kw)\n>     112         except py4j.protocol.Py4JJavaError as e:\n>     113             converted = convert_exception(e.java_exception)\n>\n> /usr/local/lib/python3.9/dist-packages/py4j/protocol.py in get_return_value(answer, gateway_client, target_id, name)\n>     324             value = OUTPUT_CONVERTER[type](answer[2:], gateway_client)\n>     325             if answer[1] == REFERENCE_TYPE:\n> --> 326                 raise Py4JJavaError(\n>     327                     \"An error occurred while calling {0}{1}{2}.\\n\".\n>     328                     format(target_id, \".\", name), value)\n>\n> Py4JJavaError: An error occurred while calling o224.sql.\n> : java.lang.NoSuchMethodError: org.apache.hadoop.util.SemaphoredDelegatingExecutor.<init>(Ljava/util/concurrent/ExecutorService;IZ)V\n> \tat org.apache.hadoop.fs.s3a.S3AFileSystem.create(S3AFileSystem.java:824)\n> \tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1118)\n> \tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1098)\n> \tat org.apache.hadoop.fs.FileSystem.create(FileSystem.java:987)\n> \tat org.apache.iceberg.hadoop.HadoopOutputFile.createOrOverwrite(HadoopOutputFile.java:85)\n> \tat org.apache.iceberg.TableMetadataParser.internalWrite(TableMetadataParser.java:119)\n> \tat org.apache.iceberg.TableMetadataParser.overwrite(TableMetadataParser.java:109)\n> \tat org.apache.iceberg.BaseMetastoreTableOperations.writeNewMetadata(BaseMetastoreTableOperations.java:154)\n> \tat org.apache.iceberg.hive.HiveTableOperations.doCommit(HiveTableOperations.java:206)\n> \tat org.apache.iceberg.BaseMetastoreTableOperations.commit(BaseMetastoreTableOperations.java:126)\n> \tat org.apache.iceberg.BaseMetastoreCatalog$BaseMetastoreCatalogTableBuilder.create(BaseMetastoreCatalog.java:216)\n> \tat org.apache.iceberg.CachingCatalog$CachingTableBuilder.lambda$create$0(CachingCatalog.java:212)\n> \tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.lambda$doComputeIfAbsent$14(BoundedLocalCache.java:2344)\n> \tat java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1853)\n> \tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.doComputeIfAbsent(BoundedLocalCache.java:2342)\n> \tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.BoundedLocalCache.computeIfAbsent(BoundedLocalCache.java:2325)\n> \tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalCache.computeIfAbsent(LocalCache.java:108)\n> \tat org.apache.iceberg.shaded.com.github.benmanes.caffeine.cache.LocalManualCache.get(LocalManualCache.java:62)\n> \tat org.apache.iceberg.CachingCatalog$CachingTableBuilder.create(CachingCatalog.java:210)\n> \tat org.apache.iceberg.spark.SparkCatalog.createTable(SparkCatalog.java:139)\n> \tat org.apache.iceberg.spark.SparkCatalog.createTable(SparkCatalog.java:81)\n> \tat org.apache.iceberg.spark.SparkSessionCatalog.createTable(SparkSessionCatalog.java:130)\n> \tat org.apache.spark.sql.execution.datasources.v2.CreateTableExec.run(CreateTableExec.scala:41)\n> \tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result$lzycompute(V2CommandExec.scala:40)\n> \tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.result(V2CommandExec.scala:40)\n> \tat org.apache.spark.sql.execution.datasources.v2.V2CommandExec.executeCollect(V2CommandExec.scala:46)\n> \tat org.apache.spark.sql.Dataset.$anonfun$logicalPlan$1(Dataset.scala:228)\n> \tat org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:3687)\n> \tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:103)\n> \tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\n> \tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\n> \tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\n> \tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\n> \tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3685)\n> \tat org.apache.spark.sql.Dataset.<init>(Dataset.scala:228)\n> \tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:99)\n> \tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\n> \tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:96)\n> \tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:618)\n> \tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\n> \tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:613)\n> \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n> \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n> \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n> \tat java.lang.reflect.Method.invoke(Method.java:498)\n> \tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n> \tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n> \tat py4j.Gateway.invoke(Gateway.java:282)\n> \tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n> \tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n> \tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n> \tat java.lang.Thread.run(Thread.java:748)\n>\n> I have no issues creating a simple hive table. Can see student5 folder\n> created in my S3 bucket after this command\n>\n> spark.sql(\"CREATE TABLE student5 (id INT, name STRING, age INT)\")\n>\n> WARN ResolveSessionCatalog: A Hive serde table will be created as there is no table provider specified. You can set spark.sql.legacy.createHiveTableByDefault to false so that native data source table will be created instead.\n> DataFrame[]\n>\n> Setup details\n>\n>    1. Spark on kubernetes\n>    2. Remote hive metastore service (mysql backend)\n>    3. Spark pods connect to metastore service via thrift\n>    4. Versions\n>       - Spark: 3.1.2\n>       - Hadoop: 3.2.2\n>       - Hive Standalone Metastore: 3.0.0\n>       - aws-java-sdk-bundle-1.11.563.jar\n>       - hadoop-aws-3.2.2.jar\n>       - guava jar in hive metastore updated to guava-27.0-jre.jar\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/3828>, or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YIJLBD5FC2N2SCSDF3UTSCQZANCNFSM5K77OCDA>\n> .\n> You are receiving this because you are subscribed to this thread.Message\n> ID: ***@***.***>\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003110958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003113434","html_url":"https://github.com/apache/iceberg/issues/3828#issuecomment-1003113434","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3828","id":1003113434,"node_id":"IC_kwDOCW7NX847ykva","user":{"login":"prithvi514","id":3002385,"node_id":"MDQ6VXNlcjMwMDIzODU=","avatar_url":"https://avatars.githubusercontent.com/u/3002385?v=4","gravatar_id":"","url":"https://api.github.com/users/prithvi514","html_url":"https://github.com/prithvi514","followers_url":"https://api.github.com/users/prithvi514/followers","following_url":"https://api.github.com/users/prithvi514/following{/other_user}","gists_url":"https://api.github.com/users/prithvi514/gists{/gist_id}","starred_url":"https://api.github.com/users/prithvi514/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prithvi514/subscriptions","organizations_url":"https://api.github.com/users/prithvi514/orgs","repos_url":"https://api.github.com/users/prithvi514/repos","events_url":"https://api.github.com/users/prithvi514/events{/privacy}","received_events_url":"https://api.github.com/users/prithvi514/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T17:11:30Z","updated_at":"2021-12-30T17:11:30Z","author_association":"NONE","body":"@RussellSpitzer \r\nThat was my initial thought too. But the Hadoop version I am using is 3.2.2 and `CREATE TABLE` without `iceberg` format and `S3` as storage worked out fine.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003113434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003193394","html_url":"https://github.com/apache/iceberg/pull/3663#issuecomment-1003193394","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3663","id":1003193394,"node_id":"IC_kwDOCW7NX847y4Qy","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T21:56:14Z","updated_at":"2021-12-30T21:56:14Z","author_association":"CONTRIBUTOR","body":"Thanks, @CodingCat! I merged this. It should work as you intend now, although I still recommend using a real lock manager in production!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003193394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003200222","html_url":"https://github.com/apache/iceberg/pull/3824#issuecomment-1003200222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3824","id":1003200222,"node_id":"IC_kwDOCW7NX847y57e","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T22:26:41Z","updated_at":"2021-12-30T22:26:41Z","author_association":"CONTRIBUTOR","body":"Thanks, @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003200222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003200641","html_url":"https://github.com/apache/iceberg/pull/3819#issuecomment-1003200641","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3819","id":1003200641,"node_id":"IC_kwDOCW7NX847y6CB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T22:28:53Z","updated_at":"2021-12-30T22:28:53Z","author_association":"CONTRIBUTOR","body":"I'm going to close this. I think that we already have good coverage of the readers and writers by writing generics and reading Flink rows, or writing Flink rows and reading generics. Those are better tests because they isolate what is being tested.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003200641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003202204","html_url":"https://github.com/apache/iceberg/pull/3817#issuecomment-1003202204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3817","id":1003202204,"node_id":"IC_kwDOCW7NX847y6ac","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T22:37:41Z","updated_at":"2021-12-30T22:37:41Z","author_association":"CONTRIBUTOR","body":"This looks like it is getting close. I'd like @openinx, @stevenzwu, or @kbendick to comment on how this should be configured, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003202204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003202719","html_url":"https://github.com/apache/iceberg/pull/3806#issuecomment-1003202719","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3806","id":1003202719,"node_id":"IC_kwDOCW7NX847y6if","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T22:40:46Z","updated_at":"2021-12-30T22:40:46Z","author_association":"CONTRIBUTOR","body":"The return type is date because the int that is returned is a valid date. Using the return type `date` makes it so that Spark and other engines show the value correctly, rather than just showing an integer date ordinal.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003202719/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003202958","html_url":"https://github.com/apache/iceberg/pull/3797#issuecomment-1003202958","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3797","id":1003202958,"node_id":"IC_kwDOCW7NX847y6mO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T22:42:05Z","updated_at":"2021-12-30T22:42:05Z","author_association":"CONTRIBUTOR","body":"@yittg can you please explain what this is doing and why it is the correct behavior?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003202958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003203746","html_url":"https://github.com/apache/iceberg/pull/3795#issuecomment-1003203746","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3795","id":1003203746,"node_id":"IC_kwDOCW7NX847y6yi","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T22:46:27Z","updated_at":"2021-12-30T22:46:27Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003203746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003203846","html_url":"https://github.com/apache/iceberg/pull/3794#issuecomment-1003203846","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3794","id":1003203846,"node_id":"IC_kwDOCW7NX847y60G","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-30T22:47:00Z","updated_at":"2021-12-30T22:47:00Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003203846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003235156","html_url":"https://github.com/apache/iceberg/issues/3826#issuecomment-1003235156","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3826","id":1003235156,"node_id":"IC_kwDOCW7NX847zCdU","user":{"login":"flyxu1991","id":72590534,"node_id":"MDQ6VXNlcjcyNTkwNTM0","avatar_url":"https://avatars.githubusercontent.com/u/72590534?v=4","gravatar_id":"","url":"https://api.github.com/users/flyxu1991","html_url":"https://github.com/flyxu1991","followers_url":"https://api.github.com/users/flyxu1991/followers","following_url":"https://api.github.com/users/flyxu1991/following{/other_user}","gists_url":"https://api.github.com/users/flyxu1991/gists{/gist_id}","starred_url":"https://api.github.com/users/flyxu1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyxu1991/subscriptions","organizations_url":"https://api.github.com/users/flyxu1991/orgs","repos_url":"https://api.github.com/users/flyxu1991/repos","events_url":"https://api.github.com/users/flyxu1991/events{/privacy}","received_events_url":"https://api.github.com/users/flyxu1991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-31T01:35:11Z","updated_at":"2021-12-31T01:35:11Z","author_association":"NONE","body":"Thanks for your help.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003235156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003241521","html_url":"https://github.com/apache/iceberg/pull/3796#issuecomment-1003241521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3796","id":1003241521,"node_id":"IC_kwDOCW7NX847zEAx","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-31T02:13:18Z","updated_at":"2021-12-31T02:13:18Z","author_association":"MEMBER","body":"cc: @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003241521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003249667","html_url":"https://github.com/apache/iceberg/pull/3797#issuecomment-1003249667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3797","id":1003249667,"node_id":"IC_kwDOCW7NX847zGAD","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-31T03:04:14Z","updated_at":"2021-12-31T03:04:14Z","author_association":"CONTRIBUTOR","body":"@rdblue The context of thread in ThreadPool inherited from the parent thread. For the first task of one thread, the parent thread is current thread that executes the task, so the context is consistent with where the task is executed. As of the second and following tasks, the context of the existing thread running the task is still the one that started the thread, which can be different from the one that executed the task. And this can cause the context class loader issue described in #3776 .\r\n\r\nFor example:\r\n1. Thread[A] with Context[Ca] executes Task[T1];\r\n2. ThreadPool starts new Thread[P1] with Context[Ca], and running Task[T1], (OK);\r\n3. Thread[B] with Context[Cb] executes Task[T2];\r\n4. ThreadPool using Thread[P1] with Context[Ca] to run the Task[T2], (not OK);\r\n    > Context[Ca] can be different from Context[Cb] and maybe already expired now.\r\n\r\nThis change records the context that executes one task in the wrapper Runnable, and sets it to the target thread before actually running the task. This can make sure the consistency of the context.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003249667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003286707","html_url":"https://github.com/apache/iceberg/issues/3558#issuecomment-1003286707","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3558","id":1003286707,"node_id":"IC_kwDOCW7NX847zPCz","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-31T06:42:40Z","updated_at":"2021-12-31T07:36:41Z","author_association":"CONTRIBUTOR","body":"1.Spark Sql Alter Table:\r\n```\r\nALTER TABLE table_identifier ADD [IF NOT EXISTS] \r\n    ( partition_spec [ partition_spec ... ] )\r\nPartition to be added. Note that one can use a typed literal (e.g., date’2019-01-02’) in the partition spec.\r\n\r\nSyntax: PARTITION ( partition_col_name = partition_col_val [ , ... ] )\r\n```\r\n2.Iceberg SparkSqlExtensions Alter Table:\r\n```\r\nALTER TABLE prod.db.sample ADD PARTITION FIELD bucket(16, id)\r\nALTER TABLE prod.db.sample ADD PARTITION FIELD truncate(data, 4)\r\n```\r\n3.Iceberg supports adding new partition fields to a spec, but spark sql don't support adding **new partition field**, so I think iceberg [ALTER TABLE] SQL extensions commands  is better.\r\n\r\n4.about [IF NOT EXISTS] and [IF EXISTS] commands, the method addField of BaseUpdatePartitionSpec has already check,so the [IF NOT EXISTS] and [IF EXISTS] commands are not necessary to add in the IcebergSqlExtensions.g4.\r\n\r\n```\r\nPartitionField existing = transformToField.get(validationKey);\r\n    Preconditions.checkArgument(existing == null,\r\n        \"Cannot add duplicate partition field %s=%s, conflicts with %s\", name, term, existing);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003286707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003290854","html_url":"https://github.com/apache/iceberg/pull/3790#issuecomment-1003290854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3790","id":1003290854,"node_id":"IC_kwDOCW7NX847zQDm","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-31T07:06:18Z","updated_at":"2021-12-31T07:06:18Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks for the review. PR updated accordingly. Please have another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003290854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003312736","html_url":"https://github.com/apache/iceberg/pull/3834#issuecomment-1003312736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3834","id":1003312736,"node_id":"IC_kwDOCW7NX847zVZg","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-31T08:53:48Z","updated_at":"2021-12-31T08:53:48Z","author_association":"CONTRIBUTOR","body":"@openinx @rdblue can you help take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003312736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003322687","html_url":"https://github.com/apache/iceberg/issues/3762#issuecomment-1003322687","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3762","id":1003322687,"node_id":"IC_kwDOCW7NX847zX0_","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-31T09:30:51Z","updated_at":"2021-12-31T09:30:51Z","author_association":"CONTRIBUTOR","body":"hi @nastra ,cloud you please take a look?  `'com.github.alisiikh.scalastyle'`  seems to block './gradlew idea'.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003322687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003414033","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1003414033","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1003414033,"node_id":"IC_kwDOCW7NX847zuIR","user":{"login":"choupijiang","id":6645585,"node_id":"MDQ6VXNlcjY2NDU1ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6645585?v=4","gravatar_id":"","url":"https://api.github.com/users/choupijiang","html_url":"https://github.com/choupijiang","followers_url":"https://api.github.com/users/choupijiang/followers","following_url":"https://api.github.com/users/choupijiang/following{/other_user}","gists_url":"https://api.github.com/users/choupijiang/gists{/gist_id}","starred_url":"https://api.github.com/users/choupijiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/choupijiang/subscriptions","organizations_url":"https://api.github.com/users/choupijiang/orgs","repos_url":"https://api.github.com/users/choupijiang/repos","events_url":"https://api.github.com/users/choupijiang/events{/privacy}","received_events_url":"https://api.github.com/users/choupijiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-31T16:34:04Z","updated_at":"2021-12-31T16:34:04Z","author_association":"NONE","body":"scalaVersion := \"2.12.10\"\r\nsparkVersion := \"3.2.0\"\r\n\"org.apache.iceberg\" % \"iceberg-spark3-runtime_2.12\" % \"0.12.1\"\r\n+1,  the same problem ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003414033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003524891","html_url":"https://github.com/apache/iceberg/issues/3825#issuecomment-1003524891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3825","id":1003524891,"node_id":"IC_kwDOCW7NX8470JMb","user":{"login":"zeromsi","id":23273695,"node_id":"MDQ6VXNlcjIzMjczNjk1","avatar_url":"https://avatars.githubusercontent.com/u/23273695?v=4","gravatar_id":"","url":"https://api.github.com/users/zeromsi","html_url":"https://github.com/zeromsi","followers_url":"https://api.github.com/users/zeromsi/followers","following_url":"https://api.github.com/users/zeromsi/following{/other_user}","gists_url":"https://api.github.com/users/zeromsi/gists{/gist_id}","starred_url":"https://api.github.com/users/zeromsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zeromsi/subscriptions","organizations_url":"https://api.github.com/users/zeromsi/orgs","repos_url":"https://api.github.com/users/zeromsi/repos","events_url":"https://api.github.com/users/zeromsi/events{/privacy}","received_events_url":"https://api.github.com/users/zeromsi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-01T08:16:45Z","updated_at":"2022-01-01T08:16:45Z","author_association":"NONE","body":"@RussellSpitzer  Thanks for your reply. I Need an working maven dependency. Can You help me on that? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003524891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003554051","html_url":"https://github.com/apache/iceberg/issues/3836#issuecomment-1003554051","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3836","id":1003554051,"node_id":"IC_kwDOCW7NX8470QUD","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-01T12:48:14Z","updated_at":"2022-01-01T12:48:14Z","author_association":"MEMBER","body":"@RohitR1 :\r\nIt is not available in the iceberg yet.\r\nIt is in the roadmap.\r\nhttps://docs.google.com/document/d/1UfGxaB7qlrGzzMk9pBm03oKPOkm-jk-NQVQQvHP-0Bc/edit","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003554051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003554291","html_url":"https://github.com/apache/iceberg/issues/3833#issuecomment-1003554291","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3833","id":1003554291,"node_id":"IC_kwDOCW7NX8470QXz","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-01T12:51:17Z","updated_at":"2022-01-01T12:51:17Z","author_association":"MEMBER","body":"looks like something is wrong with your Scala installation. Could you report your Spark environment and Scala version used?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003554291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003554713","html_url":"https://github.com/apache/iceberg/issues/3832#issuecomment-1003554713","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3832","id":1003554713,"node_id":"IC_kwDOCW7NX8470QeZ","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-01T12:55:39Z","updated_at":"2022-01-01T12:55:39Z","author_association":"MEMBER","body":"@samredai : few days ago, I have raised PR for the same. Please have a look.\r\nhttps://github.com/apache/iceberg/pull/3809","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003554713/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003559775","html_url":"https://github.com/apache/iceberg/issues/3762#issuecomment-1003559775","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3762","id":1003559775,"node_id":"IC_kwDOCW7NX8470Rtf","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-01T13:30:32Z","updated_at":"2022-01-01T13:30:32Z","author_association":"CONTRIBUTOR","body":"I'm ooo until Jan 10, but will take a look once I'm back","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003559775/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003561562","html_url":"https://github.com/apache/iceberg/issues/3832#issuecomment-1003561562","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3832","id":1003561562,"node_id":"IC_kwDOCW7NX8470SJa","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-01T13:47:20Z","updated_at":"2022-01-01T13:47:20Z","author_association":"CONTRIBUTOR","body":"Thanks @ajantha-bhat ! I'll close this one then.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003561562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003583744","html_url":"https://github.com/apache/iceberg/issues/3547#issuecomment-1003583744","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3547","id":1003583744,"node_id":"IC_kwDOCW7NX8470XkA","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-01T16:55:06Z","updated_at":"2022-01-01T16:56:08Z","author_association":"MEMBER","body":"@RussellSpitzer . @jackye1995 , @rdblue : Is it better to support sort order in the table properties (reserved property) and deprecate `ALTER TABLE ... WRITE ORDERED BY`?\r\n\r\nSo, that user can have sort order in the create table, can also alter using the `Alter table .. set tblproperties` and one less custom SQL in Iceberg?\r\n\r\nP.s: I am planning to parse the sort order using spark default parser like I did for rewrite_data_files procedure. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003583744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003852016","html_url":"https://github.com/apache/iceberg/issues/3833#issuecomment-1003852016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3833","id":1003852016,"node_id":"IC_kwDOCW7NX8471ZDw","user":{"login":"zeromsi","id":23273695,"node_id":"MDQ6VXNlcjIzMjczNjk1","avatar_url":"https://avatars.githubusercontent.com/u/23273695?v=4","gravatar_id":"","url":"https://api.github.com/users/zeromsi","html_url":"https://github.com/zeromsi","followers_url":"https://api.github.com/users/zeromsi/followers","following_url":"https://api.github.com/users/zeromsi/following{/other_user}","gists_url":"https://api.github.com/users/zeromsi/gists{/gist_id}","starred_url":"https://api.github.com/users/zeromsi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zeromsi/subscriptions","organizations_url":"https://api.github.com/users/zeromsi/orgs","repos_url":"https://api.github.com/users/zeromsi/repos","events_url":"https://api.github.com/users/zeromsi/events{/privacy}","received_events_url":"https://api.github.com/users/zeromsi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T03:31:54Z","updated_at":"2022-01-03T03:31:54Z","author_association":"NONE","body":"Do I need to install Scala. I'm using Java here!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003852016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003882451","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1003882451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1003882451,"node_id":"IC_kwDOCW7NX8471gfT","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T05:46:36Z","updated_at":"2022-01-03T05:46:36Z","author_association":"CONTRIBUTOR","body":"Thanks for your review @jackye1995 \r\n> The big questions I have are:\r\n> \r\n> 1. namespace property, can we just use `PUT namespace` for that\r\n\r\nMy one concern with using an unqualified `PUT namespace` (unqualified meaning nothing in the path) is that backend frameworks would need to be able to handle any shape of body depending on what is being updated. For namespace, that would only be properties as far as I can tell, so this one might not be too bad.\r\n\r\n> 2. `/v1/tables/rename`, can we use `/v1/table-ops/rename` or something else to make the path more self-explanatory\r\n\r\nI'm presently against using anything with `table-ops` in the name for now, only as we have had a decent amount of discussion on topics so far, but `table-ops` is still yet to be fully discused.\r\n\r\nCan we can mentally mark it as potentially re-namable to `table-ops` or something if we go with that after we discuss more of the routes that involve `table-ops`? I feel like that's going to be a bigger discussion (using most of the `table-ops`). \r\n\r\nI also feel that `table-ops` is _maybe_ too resource oriented vs just `tables`, but that's a discussion for `table-ops` in general which I'm sure will be soon.\r\n\r\n> 3. I think we do need 5xx and 400 error definitions in the spec based on RFC 7231, and we can simplify the error response using a universal error schema.\r\n\r\nYes we do. I have seen them with exactly `400` and `5xx` (e.g. in the [Confluent Kafka REST OpenAPI spec](https://github.com/confluentinc/kafka-rest/blob/b0259cfae59f68d93c9c32087e1aa96efeec6a74/api/v3/openapi.yaml#L77-L78) I recently found). I will add those tomorrow (more or less just as is on that doc)!\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003882451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003882891","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1003882891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1003882891,"node_id":"IC_kwDOCW7NX8471gmL","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T05:49:13Z","updated_at":"2022-01-03T05:49:13Z","author_association":"CONTRIBUTOR","body":"> Thanks for your review @jackye1995\r\n> \r\n> > The big questions I have are:\r\n> > \r\n> > 1. namespace property, can we just use `PUT namespace` for that\r\n> \r\n> My one concern with using an unqualified `PUT namespace` (unqualified meaning nothing in the path representing that it's a `properties` request) is that backend frameworks would need to be able to handle any shape of body depending on what is being updated. For namespace, that would only be properties as far as I can tell, so this one might not be too bad. But for `tables` etc, that could get unwieldy and I don't love the idea of using a plain `PUT` for namespace and then not necessarily doing that for tables etc. The `PUT namespaces` would still more or less need to have the same body to differentiate between properties to remove and properties to upsert.\r\n\r\n> \r\n> > 2. `/v1/tables/rename`, can we use `/v1/table-ops/rename` or something else to make the path more self-explanatory\r\n> \r\n> I'm presently against using anything with `table-ops` in the name for now, only as we have had a decent amount of discussion on topics so far, but `table-ops` is still yet to be fully discused.\r\n> \r\n> Can we can mentally mark it as potentially re-namable to `table-ops` or something if we go with that after we discuss more of the routes that involve `table-ops`? I feel like that's going to be a bigger discussion (using most of the `table-ops`).\r\n> \r\n> I also feel that `table-ops` is _maybe_ too resource oriented vs just `tables`, but that's a discussion for `table-ops` in general which I'm sure will be soon.\r\n> \r\n> > 3. I think we do need 5xx and 400 error definitions in the spec based on RFC 7231, and we can simplify the error response using a universal error schema.\r\n> \r\n> Yes we do. I have seen them with exactly `400` and `5xx` (e.g. in the [Confluent Kafka REST OpenAPI spec](https://github.com/confluentinc/kafka-rest/blob/b0259cfae59f68d93c9c32087e1aa96efeec6a74/api/v3/openapi.yaml#L77-L78) I recently found). I will add those tomorrow (more or less just as is on that doc)!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1003882891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004025741","html_url":"https://github.com/apache/iceberg/pull/3810#issuecomment-1004025741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3810","id":1004025741,"node_id":"IC_kwDOCW7NX8472DeN","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T11:19:22Z","updated_at":"2022-01-03T11:19:22Z","author_association":"CONTRIBUTOR","body":"I think if we decide  that we need the default configuration values set for Iceberg reads, then we should do this the same way as it has been done with the other file formats:\r\n- Parquet:\r\nhttps://github.com/apache/iceberg/blob/129cdfafdedb3df157fe925023ce4741dba93986/parquet/src/main/java/org/apache/iceberg/parquet/Parquet.java#L304-L320\r\n- Avro:\r\nhttps://github.com/apache/iceberg/blob/303f92547c344146a3ea500e315c285fa446d7b2/core/src/main/java/org/apache/iceberg/avro/Avro.java#L208-L213\r\n\r\nBasically we should create a Context object for the ORC as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004025741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004201082","html_url":"https://github.com/apache/iceberg/issues/3547#issuecomment-1004201082","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3547","id":1004201082,"node_id":"IC_kwDOCW7NX8472uR6","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T16:18:13Z","updated_at":"2022-01-03T16:18:13Z","author_association":"CONTRIBUTOR","body":"No, I don't think so. These aren't table properties and we don't want to rely on hacks like in `rewrite_data_files`. If we want this in DDL, then Spark should support it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004201082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004221471","html_url":"https://github.com/apache/iceberg/pull/3834#issuecomment-1004221471","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3834","id":1004221471,"node_id":"IC_kwDOCW7NX8472zQf","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T16:52:51Z","updated_at":"2022-01-03T16:52:51Z","author_association":"CONTRIBUTOR","body":"I'm assuming that the equality delete column in your example is the ID. Is that correct?\r\n\r\nIf so, then there is still some value in writing the delete because you get the previous columns written into the file. That allows reconstructing a CDC stream with the delete.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004221471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004230103","html_url":"https://github.com/apache/iceberg/issues/3829#issuecomment-1004230103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3829","id":1004230103,"node_id":"IC_kwDOCW7NX84721XX","user":{"login":"andersonad","id":12083964,"node_id":"MDQ6VXNlcjEyMDgzOTY0","avatar_url":"https://avatars.githubusercontent.com/u/12083964?v=4","gravatar_id":"","url":"https://api.github.com/users/andersonad","html_url":"https://github.com/andersonad","followers_url":"https://api.github.com/users/andersonad/followers","following_url":"https://api.github.com/users/andersonad/following{/other_user}","gists_url":"https://api.github.com/users/andersonad/gists{/gist_id}","starred_url":"https://api.github.com/users/andersonad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andersonad/subscriptions","organizations_url":"https://api.github.com/users/andersonad/orgs","repos_url":"https://api.github.com/users/andersonad/repos","events_url":"https://api.github.com/users/andersonad/events{/privacy}","received_events_url":"https://api.github.com/users/andersonad/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T17:07:21Z","updated_at":"2022-01-03T17:07:21Z","author_association":"NONE","body":"Tested this on master with the 0.13.0 snapshot and it works correctly. Closing this issue, sorry.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004230103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004258662","html_url":"https://github.com/apache/iceberg/pull/3809#issuecomment-1004258662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3809","id":1004258662,"node_id":"IC_kwDOCW7NX84728Vm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T17:59:13Z","updated_at":"2022-01-03T17:59:13Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004258662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004292001","html_url":"https://github.com/apache/iceberg/issues/3547#issuecomment-1004292001","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3547","id":1004292001,"node_id":"IC_kwDOCW7NX8473Eeh","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T19:01:34Z","updated_at":"2022-01-03T19:01:34Z","author_association":"CONTRIBUTOR","body":"> then Spark should support it\r\n\r\n+1\r\n\r\nIt's definitely achieveable in CREATE TABLE DDL, but I don't think using TBLPROPERTIES is a good idea. The table version upgrade makes sense to use a special property because we want all users in all engines to easily upgrade their tables to a newer version, and table properties is the best way as it exists in all versions of the CREATE TABLE DDL.\r\n\r\nFor sort order, different engines have different ways to define that. For example, in Hive DDL, there is a clause `CLUSTERED BY (col_name, col_name, ...) [SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS` , so if we really want to define sort order in create table, we should implement clauses like this on the engine side. (I am not saying to use the Hive DDL syntax in Spark, we should propose a syntax that could fully support Iceberg sort order features when we do it)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004292001/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004301147","html_url":"https://github.com/apache/iceberg/pull/3837#issuecomment-1004301147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3837","id":1004301147,"node_id":"IC_kwDOCW7NX8473Gtb","user":{"login":"smallx","id":16517035,"node_id":"MDQ6VXNlcjE2NTE3MDM1","avatar_url":"https://avatars.githubusercontent.com/u/16517035?v=4","gravatar_id":"","url":"https://api.github.com/users/smallx","html_url":"https://github.com/smallx","followers_url":"https://api.github.com/users/smallx/followers","following_url":"https://api.github.com/users/smallx/following{/other_user}","gists_url":"https://api.github.com/users/smallx/gists{/gist_id}","starred_url":"https://api.github.com/users/smallx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smallx/subscriptions","organizations_url":"https://api.github.com/users/smallx/orgs","repos_url":"https://api.github.com/users/smallx/repos","events_url":"https://api.github.com/users/smallx/events{/privacy}","received_events_url":"https://api.github.com/users/smallx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T19:16:53Z","updated_at":"2022-01-03T19:16:53Z","author_association":"CONTRIBUTOR","body":"Could you help me to review the code, thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004301147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004304394","html_url":"https://github.com/apache/iceberg/issues/3828#issuecomment-1004304394","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3828","id":1004304394,"node_id":"IC_kwDOCW7NX8473HgK","user":{"login":"prithvi514","id":3002385,"node_id":"MDQ6VXNlcjMwMDIzODU=","avatar_url":"https://avatars.githubusercontent.com/u/3002385?v=4","gravatar_id":"","url":"https://api.github.com/users/prithvi514","html_url":"https://github.com/prithvi514","followers_url":"https://api.github.com/users/prithvi514/followers","following_url":"https://api.github.com/users/prithvi514/following{/other_user}","gists_url":"https://api.github.com/users/prithvi514/gists{/gist_id}","starred_url":"https://api.github.com/users/prithvi514/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prithvi514/subscriptions","organizations_url":"https://api.github.com/users/prithvi514/orgs","repos_url":"https://api.github.com/users/prithvi514/repos","events_url":"https://api.github.com/users/prithvi514/events{/privacy}","received_events_url":"https://api.github.com/users/prithvi514/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T19:23:07Z","updated_at":"2022-01-03T19:23:07Z","author_association":"NONE","body":"@RussellSpitzer \r\nWould appreciate any other recommendations. Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004304394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004304930","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1004304930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1004304930,"node_id":"IC_kwDOCW7NX8473Hoi","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T19:24:07Z","updated_at":"2022-01-03T19:24:07Z","author_association":"CONTRIBUTOR","body":"> I'm presently against using anything with table-ops in the name for now, only as we have had a decent amount of discussion on topics so far, but table-ops is still yet to be fully discused.\r\n\r\nSure. In that case the only big thing I see currently missing is the 400 response, I will approve when that is added.\r\n\r\nSome pending discussions in my mind after this PR are:\r\n1. if it's better to have specific operation routes for non-RESTful operations\r\n2. head table/namespace operation with response, if we do that what set of fields should be in the response\r\n3. if pagination of response is needed when there are too many metadata log or snapshots\r\n4. progress tracking for table purge\r\n5. drop namespace cascade","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004304930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004309804","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1004309804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1004309804,"node_id":"IC_kwDOCW7NX8473I0s","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T19:33:34Z","updated_at":"2022-01-04T00:44:44Z","author_association":"CONTRIBUTOR","body":"Thanks for the pending thoughts @jackye1995! I'll respond a bit, and then we'll keep these for later discussion as well (assuming there will be more discussion groups / follow up PRs etc)\r\n\r\n> 1. if it's better to have specific operation routes for non-RESTful operations\r\n\r\nAgreed.\r\n\r\n> 2. head table/namespace operation with response, if we do that what set of fields should be in the response\r\n\r\nSo currently, there's no set of fields in the response for HEAD requests. That's what the response code and just the string `description` represents. Technically, HEAD requests are not supposed to have a response body. However, so many famous APIs do that I think we can add them in a follow up.\r\n\r\n> 3. if pagination of response is needed when there are too many metadata log or snapshots\r\n\r\nI had brought up pagination for one or two routes, but it was deemed as somewhat premature. I think eventually we will definitely need some kind of pagination for sure.\r\n\r\n> 4. progress tracking for table purge\r\n\r\nWill be coming in a follow up.\r\n\r\n> 5. drop namespace cascade\r\n\r\nThat one is not currently implemented, but I agree. Once we finish implementing it, it should be easy to add in. We can start considering where to put it in the API here sooner. Probably as a query parameter I would think.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004309804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004314505","html_url":"https://github.com/apache/iceberg/issues/3466#issuecomment-1004314505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3466","id":1004314505,"node_id":"IC_kwDOCW7NX8473J-J","user":{"login":"GaruGaru","id":6578583,"node_id":"MDQ6VXNlcjY1Nzg1ODM=","avatar_url":"https://avatars.githubusercontent.com/u/6578583?v=4","gravatar_id":"","url":"https://api.github.com/users/GaruGaru","html_url":"https://github.com/GaruGaru","followers_url":"https://api.github.com/users/GaruGaru/followers","following_url":"https://api.github.com/users/GaruGaru/following{/other_user}","gists_url":"https://api.github.com/users/GaruGaru/gists{/gist_id}","starred_url":"https://api.github.com/users/GaruGaru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GaruGaru/subscriptions","organizations_url":"https://api.github.com/users/GaruGaru/orgs","repos_url":"https://api.github.com/users/GaruGaru/repos","events_url":"https://api.github.com/users/GaruGaru/events{/privacy}","received_events_url":"https://api.github.com/users/GaruGaru/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T19:42:55Z","updated_at":"2022-01-03T19:43:02Z","author_association":"NONE","body":"Same issue with iceberg `0.11` and spark `3.1.1` ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004314505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004355932","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1004355932","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1004355932,"node_id":"IC_kwDOCW7NX8473UFc","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T21:02:20Z","updated_at":"2022-01-03T21:02:20Z","author_association":"CONTRIBUTOR","body":"> HEAD requests are not supposed to have a response body\r\n\r\nYes I mean to have another API with a `GET` verb so that it can have a response.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004355932/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004398063","html_url":"https://github.com/apache/iceberg/pull/3715#issuecomment-1004398063","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3715","id":1004398063,"node_id":"IC_kwDOCW7NX8473eXv","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T22:21:45Z","updated_at":"2022-01-03T22:21:45Z","author_association":"CONTRIBUTOR","body":"Opening small incremental PRs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004398063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004398192","html_url":"https://github.com/apache/iceberg/pull/3714#issuecomment-1004398192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3714","id":1004398192,"node_id":"IC_kwDOCW7NX8473eZw","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T22:22:02Z","updated_at":"2022-01-03T22:22:02Z","author_association":"CONTRIBUTOR","body":"Opening small incremental PRs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004398192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004398332","html_url":"https://github.com/apache/iceberg/pull/3601#issuecomment-1004398332","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3601","id":1004398332,"node_id":"IC_kwDOCW7NX8473eb8","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T22:22:18Z","updated_at":"2022-01-03T22:22:18Z","author_association":"CONTRIBUTOR","body":"Opening small incremental PRs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004398332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004408609","html_url":"https://github.com/apache/iceberg/pull/3188#issuecomment-1004408609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3188","id":1004408609,"node_id":"IC_kwDOCW7NX8473g8h","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-03T22:47:52Z","updated_at":"2022-01-11T21:58:25Z","author_association":"MEMBER","body":"Hi @rymurr @jackye1995 @jacques-n @losipiuk @rdblue , the spec has been updated with all review comments addressed. The main addition is the \"representations\" list. There are also a few minor reorgs and cleanups. Please take another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004408609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004450415","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1004450415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1004450415,"node_id":"IC_kwDOCW7NX8473rJv","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T00:41:24Z","updated_at":"2022-01-04T00:41:24Z","author_association":"CONTRIBUTOR","body":"> Overall, this looks good to me. I think that one of the main things to do is add consistency since there are a lot of differences that make it hard to consume as the yaml spec. I think that part of the motivation is to not have a huge number of schemas and response types so this is embedding them in some of the routes. But that ends up being a little confusing overall.\r\n\r\nAnother thing I only recently discovered is that many of these things can be split across several files. A CLI tool is then used to bundle them together if need be, but it might be good to consider that in the future to make consuming an ever-growing document a lot simpler.\r\n\r\nNot going to do that for now as that's probably something to discuss (it does add complexity as well for the reader), but it might be something we can find a trade off for.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004450415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004452252","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1004452252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1004452252,"node_id":"IC_kwDOCW7NX8473rmc","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T00:47:08Z","updated_at":"2022-01-04T00:47:08Z","author_association":"CONTRIBUTOR","body":"> > HEAD requests are not supposed to have a response body\r\n> \r\n> Yes I mean to have another API with a `GET` verb so that it can have a response.\r\n\r\nAhh that makes sense. I'm still not personally opposed to having a response body in a HEAD request, as users can likely ignore it given that it's a HEAD request. And given that there are a number of well used APIs that do have them.\r\n\r\nBut for now I think it's probably best to put that into the backlog as several people have had strong-ish opinions about it. The \"backlog\" meaning the work I'll be returning to more or less right after this PR as well as whatever side work I also have going 😄 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004452252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004455929","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1004455929","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1004455929,"node_id":"IC_kwDOCW7NX8473sf5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T01:00:20Z","updated_at":"2022-01-04T01:00:50Z","author_association":"CONTRIBUTOR","body":"@jackye1995, it looks like we're mostly in agreement now:\r\n> 1. if it's better to have specific operation routes for non-RESTful operations\r\n> 2. head table/namespace operation with response, if we do that what set of fields should be in the response\r\n> 3. if pagination of response is needed when there are too many metadata log or snapshots\r\n> 4. progress tracking for table purge\r\n> 5. drop namespace cascade\r\n\r\nFor 1, I think we're just trying to decide on the path for the `/tables/rename` route, right? I like the simplicity of `tables` and I don't think it will be confusing to have operation routes there. That's where I'd add multi-table transactions as well, which don't cleanly fit into a single REST resource.\r\n\r\nFor 2, I think we should remove the HEAD request for namespaces and leave the tables HEAD request without response bodies. We're probably agreed?\r\n\r\n3, 4, and 5 are not strictly required so I like the idea of adding them in follow-ups in parallel. That way we can start iterating on other areas with this as the basis.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004455929/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004460798","html_url":"https://github.com/apache/iceberg/pull/3535#issuecomment-1004460798","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3535","id":1004460798,"node_id":"IC_kwDOCW7NX8473tr-","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T01:14:39Z","updated_at":"2022-01-04T01:14:39Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue and @jackye1995, Happy new yea! Do you get a chance to take a look this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004460798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004465913","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1004465913","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1004465913,"node_id":"IC_kwDOCW7NX8473u75","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T01:31:39Z","updated_at":"2022-01-04T01:31:39Z","author_association":"CONTRIBUTOR","body":"> @jackye1995, it looks like we're mostly in agreement now:\r\n> \r\n> > 1. if it's better to have specific operation routes for non-RESTful operations\r\n> > 2. head table/namespace operation with response, if we do that what set of fields should be in the response\r\n> > 3. if pagination of response is needed when there are too many metadata log or snapshots\r\n> > 4. progress tracking for table purge\r\n> > 5. drop namespace cascade\r\n> \r\n> For 1, I think we're just trying to decide on the path for the `/tables/rename` route, right? I like the simplicity of `tables` and I don't think it will be confusing to have operation routes there. That's where I'd add multi-table transactions as well, which don't cleanly fit into a single REST resource.\r\n> \r\n> For 2, I think we should remove the HEAD request for namespaces and leave the tables HEAD request without response bodies. We're probably agreed?\r\n> \r\n> 3, 4, and 5 are not strictly required so I like the idea of adding them in follow-ups in parallel. That way we can start iterating on other areas with this as the basis.\r\n\r\nI'm in agreement on 1, that `/tables/rename` makes sense to me. It's just referencing tables in general.\r\n\r\nI've gone ahead and removed the HEAD request for namespaces. We can always add it back in in the future if need be. I agree that returning the whole table object for an existence check might be relatively expensive, and so it makes sense to keep the HEAD check for tables. I'm still not opposed to adding response bodies to the HEAD requests eventually, but that can be a topic for another day if need be.\r\n\r\nAnd then agreed on 3,4,5. The sooner we can get the initial document in, the sooner we can make smaller changes that are more digestible and can also work more in parallel 😄 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004465913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004471026","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1004471026","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1004471026,"node_id":"IC_kwDOCW7NX8473wLy","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T01:50:43Z","updated_at":"2022-01-04T01:50:43Z","author_association":"CONTRIBUTOR","body":"There's a failing Hive test that by definition can't be related to this PR (as this PR only adds an initial YAML document).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004471026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004475852","html_url":"https://github.com/apache/iceberg/pull/3834#issuecomment-1004475852","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3834","id":1004475852,"node_id":"IC_kwDOCW7NX8473xXM","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T02:05:53Z","updated_at":"2022-01-04T02:06:12Z","author_association":"CONTRIBUTOR","body":"> I'm assuming that the equality delete column in your example is the ID. Is that correct?\r\n> \r\n> If so, then there is still some value in writing the delete because you get the previous columns written into the file. That allows reconstructing a CDC stream with the delete.\r\n\r\n@rdblue But when we reconstructing a CDC stream with the delete we can't guarantee the order of delete data and append data. So we just can guarantee eventual Consistency. This PR can also guarantee eventual Consistency.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004475852/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004489465","html_url":"https://github.com/apache/iceberg/pull/3670#issuecomment-1004489465","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3670","id":1004489465,"node_id":"IC_kwDOCW7NX84730r5","user":{"login":"kevinjqliu","id":9057843,"node_id":"MDQ6VXNlcjkwNTc4NDM=","avatar_url":"https://avatars.githubusercontent.com/u/9057843?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinjqliu","html_url":"https://github.com/kevinjqliu","followers_url":"https://api.github.com/users/kevinjqliu/followers","following_url":"https://api.github.com/users/kevinjqliu/following{/other_user}","gists_url":"https://api.github.com/users/kevinjqliu/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinjqliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinjqliu/subscriptions","organizations_url":"https://api.github.com/users/kevinjqliu/orgs","repos_url":"https://api.github.com/users/kevinjqliu/repos","events_url":"https://api.github.com/users/kevinjqliu/events{/privacy}","received_events_url":"https://api.github.com/users/kevinjqliu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T02:49:35Z","updated_at":"2022-01-04T02:49:35Z","author_association":"CONTRIBUTOR","body":"hi @kbendick , @rdblue happy new year! \r\nI want to follow up on this PR. Is it feasible to merge this PR with just the remove parameter change in `HiveTableOperations` and take out the integration test? \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004489465/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004504733","html_url":"https://github.com/apache/iceberg/issues/3547#issuecomment-1004504733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3547","id":1004504733,"node_id":"IC_kwDOCW7NX84734ad","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T03:33:50Z","updated_at":"2022-01-04T03:33:50Z","author_association":"MEMBER","body":"ok. Thanks for the clarifications. I will close this issue. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004504733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004528846","html_url":"https://github.com/apache/iceberg/pull/3796#issuecomment-1004528846","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3796","id":1004528846,"node_id":"IC_kwDOCW7NX8473-TO","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T04:57:12Z","updated_at":"2022-01-04T04:57:12Z","author_association":"MEMBER","body":"@rdblue : Thanks for the review. I have handled the comments. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004528846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004557653","html_url":"https://github.com/apache/iceberg/issues/3814#issuecomment-1004557653","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3814","id":1004557653,"node_id":"IC_kwDOCW7NX8474FVV","user":{"login":"Initial-neko","id":40999666,"node_id":"MDQ6VXNlcjQwOTk5NjY2","avatar_url":"https://avatars.githubusercontent.com/u/40999666?v=4","gravatar_id":"","url":"https://api.github.com/users/Initial-neko","html_url":"https://github.com/Initial-neko","followers_url":"https://api.github.com/users/Initial-neko/followers","following_url":"https://api.github.com/users/Initial-neko/following{/other_user}","gists_url":"https://api.github.com/users/Initial-neko/gists{/gist_id}","starred_url":"https://api.github.com/users/Initial-neko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Initial-neko/subscriptions","organizations_url":"https://api.github.com/users/Initial-neko/orgs","repos_url":"https://api.github.com/users/Initial-neko/repos","events_url":"https://api.github.com/users/Initial-neko/events{/privacy}","received_events_url":"https://api.github.com/users/Initial-neko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T06:26:59Z","updated_at":"2022-01-04T06:26:59Z","author_association":"NONE","body":"> \r\nThanks！It works\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004557653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004576346","html_url":"https://github.com/apache/iceberg/pull/3810#issuecomment-1004576346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3810","id":1004576346,"node_id":"IC_kwDOCW7NX8474J5a","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T07:17:02Z","updated_at":"2022-01-04T07:17:02Z","author_association":"CONTRIBUTOR","body":"> I think if we decide that we need the default configuration values set for Iceberg reads, then we should do this the same way as it has been done with the other file formats:\r\n> …………\r\n> Basically we should create a Context object for the ORC as well.\r\n\r\nadded to the latest commiter.  PTAL, thx.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004576346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004600677","html_url":"https://github.com/apache/iceberg/pull/3799#issuecomment-1004600677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3799","id":1004600677,"node_id":"IC_kwDOCW7NX8474P1l","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T08:08:52Z","updated_at":"2022-01-04T08:08:52Z","author_association":"CONTRIBUTOR","body":"> Why did you close this? It looks like this test should be running.\r\n\r\n@rdblue, this UT failed in spark version 3.0. I think this is because the [[SPARK-33623][SQL] Add canDeleteWhere to SupportsDelete](https://github.com/apache/spark/pull/30562) does not exist in 3.0.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004600677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004633455","html_url":"https://github.com/apache/iceberg/pull/3670#issuecomment-1004633455","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3670","id":1004633455,"node_id":"IC_kwDOCW7NX8474X1v","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T09:03:44Z","updated_at":"2022-01-04T09:03:44Z","author_association":"CONTRIBUTOR","body":"> Also, in case you weren't aware, you [can mark your work GitHub account or any other account you've also used in the repo as a co-author](https://docs.github.com/en/pull-requests/committing-changes-to-your-project/creating-and-editing-commits/creating-a-commit-with-multiple-authors#creating-co-authored-commits-on-the-command-line). Plenty of people do it so their work is reflected across both accounts (if that's important to you- though definitely not a requirement).\r\n\r\n@kevinjqliu: Did you have time to check if the DDL time is changed when we only inserting to a Hive table and do not change the mertadata?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004633455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004647474","html_url":"https://github.com/apache/iceberg/pull/3840#issuecomment-1004647474","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3840","id":1004647474,"node_id":"IC_kwDOCW7NX8474bQy","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T09:25:14Z","updated_at":"2022-01-04T09:25:14Z","author_association":"CONTRIBUTOR","body":"Related PR: https://github.com/apache/iceberg/pull/3799 https://github.com/apache/iceberg/pull/3769","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004647474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004649636","html_url":"https://github.com/apache/iceberg/pull/3799#issuecomment-1004649636","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3799","id":1004649636,"node_id":"IC_kwDOCW7NX8474byk","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T09:28:27Z","updated_at":"2022-01-04T09:28:27Z","author_association":"CONTRIBUTOR","body":"I submitted a PR to fix this: https://github.com/apache/iceberg/pull/3840","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004649636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004686327","html_url":"https://github.com/apache/iceberg/pull/3840#issuecomment-1004686327","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3840","id":1004686327,"node_id":"IC_kwDOCW7NX8474kv3","user":{"login":"izchen","id":67534059,"node_id":"MDQ6VXNlcjY3NTM0MDU5","avatar_url":"https://avatars.githubusercontent.com/u/67534059?v=4","gravatar_id":"","url":"https://api.github.com/users/izchen","html_url":"https://github.com/izchen","followers_url":"https://api.github.com/users/izchen/followers","following_url":"https://api.github.com/users/izchen/following{/other_user}","gists_url":"https://api.github.com/users/izchen/gists{/gist_id}","starred_url":"https://api.github.com/users/izchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/izchen/subscriptions","organizations_url":"https://api.github.com/users/izchen/orgs","repos_url":"https://api.github.com/users/izchen/repos","events_url":"https://api.github.com/users/izchen/events{/privacy}","received_events_url":"https://api.github.com/users/izchen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T10:21:13Z","updated_at":"2022-01-04T10:21:13Z","author_association":"CONTRIBUTOR","body":"cc @rdblue  @wypoon","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004686327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004781800","html_url":"https://github.com/apache/iceberg/issues/3835#issuecomment-1004781800","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3835","id":1004781800,"node_id":"IC_kwDOCW7NX84748Do","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T12:49:47Z","updated_at":"2022-01-04T12:49:47Z","author_association":"CONTRIBUTOR","body":"NoClassDefFoundError usually has a class conflict in the project, you can check whether the relevant dependencies of the project are repeatedly introduced.\r\nif no relevant dependencies are introduced, the error that appears is ClassNotFoundException. @zeromsi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004781800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004788929","html_url":"https://github.com/apache/iceberg/pull/3810#issuecomment-1004788929","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3810","id":1004788929,"node_id":"IC_kwDOCW7NX84749zB","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T12:59:46Z","updated_at":"2022-01-04T12:59:46Z","author_association":"CONTRIBUTOR","body":"@hililiwei: Do we have any tests for this in Parquet/Avro?\r\nI think it would b good to add some tests, so we can be sure that these configurations are working as expected.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004788929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004952398","html_url":"https://github.com/apache/iceberg/pull/3732#issuecomment-1004952398","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3732","id":1004952398,"node_id":"IC_kwDOCW7NX8475ltO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T16:25:03Z","updated_at":"2022-01-04T16:25:03Z","author_association":"CONTRIBUTOR","body":"Thanks, @rajarshisarkar!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004952398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004989462","html_url":"https://github.com/apache/iceberg/issues/3709#issuecomment-1004989462","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3709","id":1004989462,"node_id":"IC_kwDOCW7NX8475uwW","user":{"login":"Kyo91","id":4249289,"node_id":"MDQ6VXNlcjQyNDkyODk=","avatar_url":"https://avatars.githubusercontent.com/u/4249289?v=4","gravatar_id":"","url":"https://api.github.com/users/Kyo91","html_url":"https://github.com/Kyo91","followers_url":"https://api.github.com/users/Kyo91/followers","following_url":"https://api.github.com/users/Kyo91/following{/other_user}","gists_url":"https://api.github.com/users/Kyo91/gists{/gist_id}","starred_url":"https://api.github.com/users/Kyo91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kyo91/subscriptions","organizations_url":"https://api.github.com/users/Kyo91/orgs","repos_url":"https://api.github.com/users/Kyo91/repos","events_url":"https://api.github.com/users/Kyo91/events{/privacy}","received_events_url":"https://api.github.com/users/Kyo91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T16:50:36Z","updated_at":"2022-01-04T16:50:36Z","author_association":"NONE","body":"Anyone have an idea on mitigation strategies or potential codepaths to look into here? This may sound silly but this bug is blocking us from updating off of 0.11.X","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004989462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004994347","html_url":"https://github.com/apache/iceberg/issues/3709#issuecomment-1004994347","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3709","id":1004994347,"node_id":"IC_kwDOCW7NX8475v8r","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T16:54:01Z","updated_at":"2022-01-04T16:54:01Z","author_association":"MEMBER","body":"My guess would be that we are getting the listing of columns in the schema and we see that we have a column named \"partition\" which also has a field \"partition.partition\". We probably are including both in the safety check there so my guess would be we need to ignore the top level \"partition\" when doing the check.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1004994347/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005012173","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1005012173","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1005012173,"node_id":"IC_kwDOCW7NX84750TN","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T17:13:13Z","updated_at":"2022-01-04T17:13:13Z","author_association":"CONTRIBUTOR","body":"Hey all, I just got back today. Will review this asap tomorrow morning. Hope I am not holding anyone up?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005012173/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005040212","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-1005040212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":1005040212,"node_id":"IC_kwDOCW7NX84757JU","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T17:51:06Z","updated_at":"2022-01-04T17:51:06Z","author_association":"CONTRIBUTOR","body":"Should be fine. Thanks for taking a look, @rymurr!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005040212/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005042064","html_url":"https://github.com/apache/iceberg/pull/3796#issuecomment-1005042064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3796","id":1005042064,"node_id":"IC_kwDOCW7NX84757mQ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T17:53:45Z","updated_at":"2022-01-04T17:53:45Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005042064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005054790","html_url":"https://github.com/apache/iceberg/issues/3582#issuecomment-1005054790","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3582","id":1005054790,"node_id":"IC_kwDOCW7NX8475-tG","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T18:11:47Z","updated_at":"2022-01-04T18:11:47Z","author_association":"CONTRIBUTOR","body":"@szehon-ho +1 for the bulk deletion. It can improve the throughput without causing throttling.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005054790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005059114","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1005059114","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1005059114,"node_id":"IC_kwDOCW7NX8475_wq","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T18:18:01Z","updated_at":"2022-01-04T18:19:28Z","author_association":"CONTRIBUTOR","body":"As an example of what an implementation of these base classes would look like, I put together an S3FileIO implementation using smart_open to create seekable file-like objects (`smart_open.s3.Reader` instances) and validated that this can be fed directly into pyarrow. I also validated that `smart_open.s3.MultipartWriter` instances work as the `where` argument to pyarrow's `write_table` methods.\r\n### Implementation, `s3.py`\r\n```py\r\nfrom iceberg.io.base import FileIO, InputFile, OutputFile\r\nfrom smart_open import open, parse_uri\r\nimport boto3\r\n\r\nclass S3InputFile(InputFile):\r\n\r\n    def __len__(self) -> int:\r\n        return 0\r\n    \r\n    @property\r\n    def exists(self) -> bool:\r\n        try:\r\n            with open(self.location, 'rb') as f:\r\n                pass\r\n        except OSError:\r\n            return False\r\n        return True\r\n    \r\n    def __enter__(self):\r\n        self._stream = open(self.location, 'rb', transport_params={\"defer_seek\": True})\r\n        return self._stream\r\n    \r\n    def __exit__(self, exc_type, exc_value, exc_traceback):\r\n        self._stream.close()\r\n        return\r\n\r\n\r\nclass S3OutputFile(OutputFile):\r\n\r\n    def __call__(self, overwrite: bool = False, **kwargs):\r\n        self._overwrite = overwrite\r\n        return self\r\n\r\n    def __len__(self) -> int:\r\n        return 0\r\n    \r\n    @property\r\n    def location(self) -> str:\r\n        \"\"\"The fully-qualified location of the output file\"\"\"\r\n        return self._location\r\n\r\n    @property\r\n    def exists(self) -> bool:\r\n        try:\r\n            with open(self.location, 'rb') as f:\r\n                pass\r\n        except OSError:\r\n            return False\r\n        return True\r\n    \r\n    def to_input_file(self) -> S3InputFile:\r\n        return S3InputFile(self.location)\r\n\r\n    def __enter__(self):\r\n        if not self._overwrite and self.exists:\r\n            raise FileExistsError(\r\n                f\"{self.location} already exists. To overwrite, \"\r\n                \"set overwrite=True when initializing the S3OutputFile.\"\r\n            )\r\n            \r\n        self._stream = open(self.location, 'wb')\r\n        return self._stream\r\n    \r\n    def __exit__(self, exc_type, exc_value, exc_traceback):\r\n        self._stream.close()\r\n        return\r\n\r\nclass S3FileIO(FileIO):\r\n    def new_input(self, location: str):\r\n        return S3InputFile(location=location)\r\n\r\n    def new_output(self, location: str, overwrite: bool = False):\r\n        return S3OutputFile(location=location, overwrite=overwrite)\r\n\r\n    def delete(self, location: str):\r\n        uri = parse_uri(location)\r\n        s3 = boto3.resource('s3')\r\n        s3.Object(uri.bucket_id, uri.key_id).delete()\r\n        return\r\n```\r\n### `example.py`\r\n```py\r\nfrom pyarrow import parquet as pq\r\nfrom s3 import S3FileIO\r\n\r\nf1 = \"s3://samstestbucket3412/userdata1.parquet\"\r\nf2 = \"s3://samstestbucket3412/userdata2.parquet\"\r\nfile_io = S3FileIO()\r\n\r\n# Read f1 (a parquet file)\r\nwith file_io.new_input(f1) as f:\r\n    table = pq.read_table(f)\r\n\r\n# see output below\r\nprint(\"####################\\n\")\r\nprint(type(table), end=\"\\n\\n\")\r\nprint(table, end=\"\\n\\n\")\r\nprint(\"####################\\n\")\r\n\r\n# Delete f2 if it exists\r\nfile_io.delete(f2)\r\n\r\n# Write the pyarrow table to f2\r\nwith file_io.new_output(f2) as f:\r\n    pq.write_table(table, f)\r\n\r\n# Read the newly written table back in\r\nwith file_io.new_input(f2) as f:\r\n    table2 = pq.read_table(f)\r\n\r\n# see output below\r\nprint(\"####################\\n\")\r\nprint(type(table), end=\"\\n\\n\")\r\nprint(table, end=\"\\n\\n\")\r\nprint(\"####################\\n\")\r\n\r\n\r\n# Try to write to f2 again without overwrite=True\r\n# with file_io.new_output(f2) as f:\r\n#     pq.write_table(table, f)  # Raises a FileExistsError\r\n\r\n# Writing f2 again with overwrite=True\r\nwith file_io.new_output(f2, overwrite=True) as f:\r\n    pq.write_table(table2, f)\r\n\r\n# Delete f2\r\nfile_io.delete(f2)\r\n\r\n# Write f2 without setting overwrite since it's been deleted\r\nwith file_io.new_output(f2) as f:\r\n    pq.write_table(table2, f)\r\n```\r\noutput:\r\n```\r\n####################\r\n\r\n<class 'pyarrow.lib.Table'>\r\n\r\npyarrow.Table\r\nregistration_dttm: timestamp[ns]\r\nid: int32\r\nfirst_name: string\r\nlast_name: string\r\nemail: string\r\ngender: string\r\nip_address: string\r\ncc: string\r\ncountry: string\r\nbirthdate: string\r\nsalary: double\r\ntitle: string\r\ncomments: string\r\n\r\n####################\r\n\r\n####################\r\n\r\n<class 'pyarrow.lib.Table'>\r\n\r\npyarrow.Table\r\nregistration_dttm: timestamp[ns]\r\nid: int32\r\nfirst_name: string\r\nlast_name: string\r\nemail: string\r\ngender: string\r\nip_address: string\r\ncc: string\r\ncountry: string\r\nbirthdate: string\r\nsalary: double\r\ntitle: string\r\ncomments: string\r\n\r\n####################\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005059114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005065015","html_url":"https://github.com/apache/iceberg/issues/3582#issuecomment-1005065015","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3582","id":1005065015,"node_id":"IC_kwDOCW7NX8476BM3","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T18:26:44Z","updated_at":"2022-01-04T18:26:44Z","author_association":"COLLABORATOR","body":"Thanks.  @RussellSpitzer is anyone working on the parallelism part?  (i couldnt find the ticket you mentioned).  If not, I was chatting with @dramaticlly about this and he could help submit a PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005065015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005080618","html_url":"https://github.com/apache/iceberg/issues/3582#issuecomment-1005080618","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3582","id":1005080618,"node_id":"IC_kwDOCW7NX8476FAq","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T18:48:50Z","updated_at":"2022-01-04T18:49:16Z","author_association":"MEMBER","body":"@szehon-ho This was added to the ExpireSnapshots procedure here https://github.com/apache/iceberg/blob/master/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/procedures/ExpireSnapshotsProcedure.java#L129-L137\r\n\r\nIn the action it's always been possible by just passing through the Executor Service, for RemoveOrphans it doesn't exist (I don't think there is a api in the action for passing through another executor service see https://github.com/apache/iceberg/blob/master/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/actions/BaseDeleteOrphanFilesSparkAction.java#L168-L172) so I think there is work to do there","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005080618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005095805","html_url":"https://github.com/apache/iceberg/pull/3670#issuecomment-1005095805","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3670","id":1005095805,"node_id":"IC_kwDOCW7NX8476It9","user":{"login":"kevinjqliu","id":9057843,"node_id":"MDQ6VXNlcjkwNTc4NDM=","avatar_url":"https://avatars.githubusercontent.com/u/9057843?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinjqliu","html_url":"https://github.com/kevinjqliu","followers_url":"https://api.github.com/users/kevinjqliu/followers","following_url":"https://api.github.com/users/kevinjqliu/following{/other_user}","gists_url":"https://api.github.com/users/kevinjqliu/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinjqliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinjqliu/subscriptions","organizations_url":"https://api.github.com/users/kevinjqliu/orgs","repos_url":"https://api.github.com/users/kevinjqliu/repos","events_url":"https://api.github.com/users/kevinjqliu/events{/privacy}","received_events_url":"https://api.github.com/users/kevinjqliu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-04T19:10:19Z","updated_at":"2022-01-04T19:10:19Z","author_association":"CONTRIBUTOR","body":">  @kevinjqliu: Did you have time to check if the DDL time is changed when we only inserting to a Hive table and do not change the mertadata?\r\n\r\n@pvary\r\nseems like insert to the table changes the DDL time according to this.\r\nhttps://lists.apache.org/thread/44rr7q3wb2pfp7b5prgnb6vt2of1t41c","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1005095805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]