[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/313945687","html_url":"https://github.com/apache/couchdb/pull/657#issuecomment-313945687","issue_url":"https://api.github.com/repos/apache/couchdb/issues/657","id":313945687,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMzk0NTY4Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-09T19:12:22Z","updated_at":"2017-07-09T19:12:22Z","author_association":"MEMBER","body":"@rnewson My goal was to ensure the feature was not enable-able in 2.1 at all, which this accomplishes. Readying chttpd/replicator for a different solution is beyond my ability without intense study, and unless you're up to the task, wouldn't be done in time for 2.1. What should we do?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/313945687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/313968684","html_url":"https://github.com/apache/couchdb/issues/656#issuecomment-313968684","issue_url":"https://api.github.com/repos/apache/couchdb/issues/656","id":313968684,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMzk2ODY4NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-09T22:06:30Z","updated_at":"2017-07-09T22:06:30Z","author_association":"MEMBER","body":"Done!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/313968684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/313975347","html_url":"https://github.com/apache/couchdb/issues/593#issuecomment-313975347","issue_url":"https://api.github.com/repos/apache/couchdb/issues/593","id":313975347,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMzk3NTM0Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-10T00:21:32Z","updated_at":"2017-07-10T00:26:49Z","author_association":"MEMBER","body":"OK, so I've started implementation, and ran into a concern during the process, contingent upon the fact that the setup app currently determines if a cluster is \"finished\" setup by checking for the presence of `_global_changes`, `_users` and `_replicator` as databases on the clustered endpoint. This may not always be true, especially for `_global_changes`.\r\n\r\nOne scenario that worries me a lot: imagine an automated deployment tool (Chef/Puppet/Ansible/etc.) using `GET /_cluster_setup` to validate that nodes are functional. In a cluster where one of the 3 default databases has been removed (e.g. `_global_changes`) and the tool uses the output of `GET /_cluster_setup` to determine whether to (re-)finish setup, a never-ending create/delete loop might be created. Even if the action was manual, we know there are situations where a create/delete/create cycle can lead to race conditions and other badness.\r\n\r\nI realize this is extending the scope of this a little bit, but I'm having to monkey with the very bit that checks for the presence of those 3 databases anyway, so it's not too much trouble.\r\n\r\nSo, the changes are:\r\n* Update to the `finish_cluster` endpoint to allow an additional parameter, `ensure_dbs_exist=[\"db1\", \"db2\", ...]` where those _clustered_ databases will be checked for and created if they do not exist. Matching the current behaviour, the default list is `[\"_users\", \"_replicator\", \"_global_changes\"]`.\r\n* Update to the `GET /_cluster_setup` method to allow optionally specifying `ensure_dbs_exist` to match the `finish_cluster` endpoint.\r\n* The `\"action\": \"enable_single_node\"` will allow binding to 127.0.0.1. It will also set `[cluster] n=1`. The action will also take the `ensure_dbs_exist` parameter.\r\n* Fauxton will need to be updated for the single-node behaviour. I'm not planning to expose the `ensure_dbs_exist` parameter in that UI; if people want non-standard cluster setup behaviour they can use the endpoint directly.\r\n* (_Optional_) The `ensure_dbs_exist` list from either action `finish_cluster` or `enable_single_node` could be persisted in the ini file. This way it could be used later as the updated default for the `GET /_cluster_setup` db list.\r\n\r\nSomething for the future: people have been asking for the Setup tab in Fauxton to disappear once the cluster is set up. This could be powered by `GET /_cluster_setup`. Just a thought. ðŸ¤” ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/313975347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314121724","html_url":"https://github.com/apache/couchdb/pull/496#issuecomment-314121724","issue_url":"https://api.github.com/repos/apache/couchdb/issues/496","id":314121724,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDEyMTcyNA==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-10T14:25:10Z","updated_at":"2017-07-10T14:25:10Z","author_association":"MEMBER","body":"+1 this is really nice. To test the api I built a [RocksDB adapter](https://github.com/garrensmith/couch_rocks/tree/initial-work). The api is really nice to use, there are two slightly rough edges - include_reductions on `fold_docs` and `monitored_by` functions. Paul already new those two sections are a little rough and said fixing those now will increase the scope of this PR even further. \r\n\r\nI tested CouchDB using `ngen`, `rocks` and `couch_bt_engine`. It all worked smoothly.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314121724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314139670","html_url":"https://github.com/apache/couchdb/pull/496#issuecomment-314139670","issue_url":"https://api.github.com/repos/apache/couchdb/issues/496","id":314139670,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDEzOTY3MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-10T15:21:53Z","updated_at":"2017-07-10T15:21:53Z","author_association":"MEMBER","body":"For more color since I was talking to @garrensmith off list about his work on couch_rocks, those two places are a bit rough because I wanted to match the existing API/behavior exactly.\r\n\r\nThe `include_reductions/fold_docs` issue is for _all_docs when we list a total_rows and offset value. Specifically, the offset is difficult to calculate for anything that's not tree shaped. For engines that aren't tree shaped I recommend just faking a reduce value there and ignoring that the offset would be wrong (since we already recommend against using it for paging and other such things anyway). This edge case would be fixable if we ever drop the offset calculation.\r\n\r\nThe monitoring functions are also a bit funky. I exposed them in the API in case a storage engine wanted to be fancier there. But that's all how it interacts with couch_server so that we can make the guarantees about single writers per shard and so on. Its possible that in the future we remove those if we spend much time on reworking couch_server to change its semantics. For now its easy enough to implement, its just confusing *why* we implement it the way we do unless you're familiar with the whole couch_server notion of idle and how that's implemented with couch_file pids vs couch_db_updater pids.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314139670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314259028","html_url":"https://github.com/apache/couchdb/pull/627#issuecomment-314259028","issue_url":"https://api.github.com/repos/apache/couchdb/issues/627","id":314259028,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDI1OTAyOA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-10T21:46:27Z","updated_at":"2017-07-10T21:46:27Z","author_association":"CONTRIBUTOR","body":"@eiri @nickva : The source looks good to me. The tests also pass for me. If there's a better pythonic way to combine the two new test files(one tests _all_docs, the other tests user created indexes) such that we don't need two separate test files that would good. It's not a big deal though.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314259028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314273326","html_url":"https://github.com/apache/couchdb/pull/627#issuecomment-314273326","issue_url":"https://api.github.com/repos/apache/couchdb/issues/627","id":314273326,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDI3MzMyNg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-10T22:57:44Z","updated_at":"2017-07-10T22:57:44Z","author_association":"CONTRIBUTOR","body":"@tonysun83 good point!\r\n\r\nShould be doable. If we had parameterized tests like py.test framework has, then `index = True | False` could be a parameter. Maybe will just make the tests a mixin and have two test classes that uses the mixin - one with an index one without.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314273326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314287860","html_url":"https://github.com/apache/couchdb/issues/593#issuecomment-314287860","issue_url":"https://api.github.com/repos/apache/couchdb/issues/593","id":314287860,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDI4Nzg2MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T00:28:48Z","updated_at":"2017-07-11T00:28:48Z","author_association":"MEMBER","body":"First PR is up. Once that's confirmed I'll go over to the Fauxton side of things.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314287860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314289552","html_url":"https://github.com/apache/couchdb/issues/658#issuecomment-314289552","issue_url":"https://api.github.com/repos/apache/couchdb/issues/658","id":314289552,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDI4OTU1Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T00:41:03Z","updated_at":"2017-07-11T00:41:03Z","author_association":"MEMBER","body":"This has been fixed on master and will be released with CouchDB 2.1.\r\n\r\n![mwsnap 2017-07-10 20_39_10](https://user-images.githubusercontent.com/112292/28046205-0c748d66-65b0-11e7-8aa7-31f3b3f51d04.png)\r\n\r\n![mwsnap 2017-07-10 20_39_15](https://user-images.githubusercontent.com/112292/28046204-0ab3dedc-65b0-11e7-9dcc-31dfb8e5099b.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314289552/reactions","total_count":2,"+1":1,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314298350","html_url":"https://github.com/apache/couchdb/issues/593#issuecomment-314298350","issue_url":"https://api.github.com/repos/apache/couchdb/issues/593","id":314298350,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDI5ODM1MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T01:42:19Z","updated_at":"2017-07-11T01:42:19Z","author_association":"MEMBER","body":"Also TODO: Docs PR once the other PR lands.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314298350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314306340","html_url":"https://github.com/apache/couchdb/issues/508#issuecomment-314306340","issue_url":"https://api.github.com/repos/apache/couchdb/issues/508","id":314306340,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDMwNjM0MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T02:37:35Z","updated_at":"2017-07-11T02:37:35Z","author_association":"MEMBER","body":"The code signing service is out of commission for a few weeks, so rather than hold up the release, I'm releasing it unsigned.\r\n\r\nDownload it here: \r\n\r\nhttps://apache.bintray.com/couchdb/win/2.0.0.2/couchdb-2.0.0.2.msi","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314306340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314317593","html_url":"https://github.com/apache/couchdb/issues/644#issuecomment-314317593","issue_url":"https://api.github.com/repos/apache/couchdb/issues/644","id":314317593,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDMxNzU5Mw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T04:10:41Z","updated_at":"2017-07-11T04:10:41Z","author_association":"CONTRIBUTOR","body":"Sprinkled some ?debug macros on that test and made Travis run it 10 times in a row.\r\n\r\nhttps://github.com/cloudant/couchdb/commit/fb13cf5d92656f11e2f6cd92b1d2868024ec6225\r\n\r\nOne failure:\r\n\r\n  https://travis-ci.org/cloudant/couchdb/jobs/252251466\r\n\r\n```\r\ntest/couch_replicator_use_checkpoints_tests.erl:77:<0.30989.1>: <-\r\n\r\n        test/couch_replicator_use_checkpoints_tests.erl:80:<0.30989.1>: <-\r\n\r\n[done in 0.659 s]\r\n\r\ntest/couch_replicator_use_checkpoints_tests.erl:87:<0.30989.1>: <-\r\n\r\ntest/couch_replicator_use_checkpoints_tests.erl:80:<0.30989.1>: <-\r\n\r\ntest/couch_replicator_use_checkpoints_tests.erl:89:<0.30989.1>: <-\r\n\r\ntest/couch_replicator_use_checkpoints_tests.erl:91:<0.30989.1>: <-\r\n\r\ntest/couch_replicator_use_checkpoints_tests.erl:93:<0.30989.1>: <-\r\n\r\n    *unexpected termination of test process*\r\n\r\n::killed\r\n\r\ntest/couch_replicator_use_checkpoints_tests.erl:50:<0.916.0>: <-\r\n\r\n  [done in 5.419 s]\r\n\r\n[done in 5.419 s]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314317593/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314458764","html_url":"https://github.com/apache/couchdb/pull/475#issuecomment-314458764","issue_url":"https://api.github.com/repos/apache/couchdb/issues/475","id":314458764,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDQ1ODc2NA==","user":{"login":"fkaempfer","id":2357885,"node_id":"MDQ6VXNlcjIzNTc4ODU=","avatar_url":"https://avatars.githubusercontent.com/u/2357885?v=4","gravatar_id":"","url":"https://api.github.com/users/fkaempfer","html_url":"https://github.com/fkaempfer","followers_url":"https://api.github.com/users/fkaempfer/followers","following_url":"https://api.github.com/users/fkaempfer/following{/other_user}","gists_url":"https://api.github.com/users/fkaempfer/gists{/gist_id}","starred_url":"https://api.github.com/users/fkaempfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkaempfer/subscriptions","organizations_url":"https://api.github.com/users/fkaempfer/orgs","repos_url":"https://api.github.com/users/fkaempfer/repos","events_url":"https://api.github.com/users/fkaempfer/events{/privacy}","received_events_url":"https://api.github.com/users/fkaempfer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T14:18:50Z","updated_at":"2017-07-11T14:21:05Z","author_association":"CONTRIBUTOR","body":"The latest commit adds a require_db_admin method to chttpd_auth_request alongside a few helper methods I adapted from couch_db.erl. Perhaps some refactoring could still be done so there is no code duplication between couch_db and chttpd_auth_request.\r\n\r\nThe two commits before add tests to check if the db compaction is allowed for db admins in addition to which was already tested (only server admin/anonymous).\r\n\r\nI'm in a hurry, so let's hope the last test checks out, I'll have an eye on it again tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314458764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314501017","html_url":"https://github.com/apache/couchdb/pull/475#issuecomment-314501017","issue_url":"https://api.github.com/repos/apache/couchdb/issues/475","id":314501017,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDUwMTAxNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T16:35:16Z","updated_at":"2017-07-11T16:35:16Z","author_association":"MEMBER","body":"@rnewson everything is passing, changes were made per your request, can you approve this PR? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314501017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314502954","html_url":"https://github.com/apache/couchdb/issues/661#issuecomment-314502954","issue_url":"https://api.github.com/repos/apache/couchdb/issues/661","id":314502954,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDUwMjk1NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T16:41:47Z","updated_at":"2017-07-11T16:42:07Z","author_association":"MEMBER","body":"Currently issues on the roadmap for CouchDB are here:\r\n\r\n   https://github.com/janl/couchdb-next/issues\r\n\r\nfrom the last CouchDB summit, before this repository started to allow issues to be filed directly against it. We'll start moving these into the GitHub Issues list here, after 2.1 is released.\r\n\r\nYou can see the very first issue that is open is HTTP/2 support:\r\n\r\nhttps://github.com/janl/couchdb-next/issues/2\r\n\r\nNo implementation work has been done yet.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314502954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314509623","html_url":"https://github.com/apache/couchdb/issues/661#issuecomment-314509623","issue_url":"https://api.github.com/repos/apache/couchdb/issues/661","id":314509623,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDUwOTYyMw==","user":{"login":"luanmm","id":1708808,"node_id":"MDQ6VXNlcjE3MDg4MDg=","avatar_url":"https://avatars.githubusercontent.com/u/1708808?v=4","gravatar_id":"","url":"https://api.github.com/users/luanmm","html_url":"https://github.com/luanmm","followers_url":"https://api.github.com/users/luanmm/followers","following_url":"https://api.github.com/users/luanmm/following{/other_user}","gists_url":"https://api.github.com/users/luanmm/gists{/gist_id}","starred_url":"https://api.github.com/users/luanmm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luanmm/subscriptions","organizations_url":"https://api.github.com/users/luanmm/orgs","repos_url":"https://api.github.com/users/luanmm/repos","events_url":"https://api.github.com/users/luanmm/events{/privacy}","received_events_url":"https://api.github.com/users/luanmm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T17:06:22Z","updated_at":"2017-07-11T17:06:22Z","author_association":"NONE","body":"Sorry for the opened issue, then. I really couldn't find any information before your reply. Thank you very much, @wohali.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314509623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314531990","html_url":"https://github.com/apache/couchdb/pull/662#issuecomment-314531990","issue_url":"https://api.github.com/repos/apache/couchdb/issues/662","id":314531990,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDUzMTk5MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T18:28:39Z","updated_at":"2017-07-11T18:28:39Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314531990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314534457","html_url":"https://github.com/apache/couchdb/issues/644#issuecomment-314534457","issue_url":"https://api.github.com/repos/apache/couchdb/issues/644","id":314534457,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDUzNDQ1Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T18:37:55Z","updated_at":"2017-07-11T18:37:55Z","author_association":"MEMBER","body":"Closing until we see a recurrence of this because of #662.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314534457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314534839","html_url":"https://github.com/apache/couchdb/pull/663#issuecomment-314534839","issue_url":"https://api.github.com/repos/apache/couchdb/issues/663","id":314534839,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDUzNDgzOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T18:39:22Z","updated_at":"2017-07-11T18:39:22Z","author_association":"MEMBER","body":"-0. This will slow down how long Travis takes to build, because only so many concurrent runs are allowed at once. Open source projects get 5 concurrent builds per run by default.\r\n\r\nTravis right now is our \"fast path\" for builds, with Jenkins being the \"slow path\" at around 45-60 mins per run.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314534839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314542457","html_url":"https://github.com/apache/couchdb/issues/661#issuecomment-314542457","issue_url":"https://api.github.com/repos/apache/couchdb/issues/661","id":314542457,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDU0MjQ1Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T19:08:48Z","updated_at":"2017-07-11T19:08:48Z","author_association":"MEMBER","body":"No problem! We're just in the process of moving over from our old JIRA instance to GitHub Issues, and things are a bit scattered at the moment. After 2.1 releases, I'll have a lot more free time to get our roadmap in place here. Thanks for reminding me!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314542457/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314543376","html_url":"https://github.com/apache/couchdb/issues/655#issuecomment-314543376","issue_url":"https://api.github.com/repos/apache/couchdb/issues/655","id":314543376,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDU0MzM3Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T19:12:43Z","updated_at":"2017-07-11T19:12:43Z","author_association":"MEMBER","body":"A new instance of this:\r\n* https://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/76/pipeline/41","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314543376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314548330","html_url":"https://github.com/apache/couchdb/issues/659#issuecomment-314548330","issue_url":"https://api.github.com/repos/apache/couchdb/issues/659","id":314548330,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDU0ODMzMA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T19:33:16Z","updated_at":"2017-07-11T19:33:16Z","author_association":"CONTRIBUTOR","body":"@nickva: There is an implementation in erlang here https://github.com/okeuday/erlang_term/blob/master/src/erlang_term.erl. MIT license.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314548330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314550135","html_url":"https://github.com/apache/couchdb/issues/659#issuecomment-314550135","issue_url":"https://api.github.com/repos/apache/couchdb/issues/659","id":314550135,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDU1MDEzNQ==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T19:40:46Z","updated_at":"2017-07-11T19:40:46Z","author_association":"CONTRIBUTOR","body":"Another implementation could be based on https://gist.github.com/iilyak/a11a481bd3f7311d8499e19f5e4c8f22","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314550135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314553175","html_url":"https://github.com/apache/couchdb/issues/659#issuecomment-314553175","issue_url":"https://api.github.com/repos/apache/couchdb/issues/659","id":314553175,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDU1MzE3NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-11T19:53:44Z","updated_at":"2017-07-11T21:06:17Z","author_association":"CONTRIBUTOR","body":"We don't really need it be that generalized in a way because we know we'd only get what jiffy decoded which is object proplists `{[...]}`, arrays (lists `[...]`) and then integers, floats and binary (but unicode and escape sequences have to be accounted for). Oh maybe atoms but those are just translated to binary and handled that way.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314553175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314754484","html_url":"https://github.com/apache/couchdb/pull/475#issuecomment-314754484","issue_url":"https://api.github.com/repos/apache/couchdb/issues/475","id":314754484,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDc1NDQ4NA==","user":{"login":"fkaempfer","id":2357885,"node_id":"MDQ6VXNlcjIzNTc4ODU=","avatar_url":"https://avatars.githubusercontent.com/u/2357885?v=4","gravatar_id":"","url":"https://api.github.com/users/fkaempfer","html_url":"https://github.com/fkaempfer","followers_url":"https://api.github.com/users/fkaempfer/followers","following_url":"https://api.github.com/users/fkaempfer/following{/other_user}","gists_url":"https://api.github.com/users/fkaempfer/gists{/gist_id}","starred_url":"https://api.github.com/users/fkaempfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkaempfer/subscriptions","organizations_url":"https://api.github.com/users/fkaempfer/orgs","repos_url":"https://api.github.com/users/fkaempfer/repos","events_url":"https://api.github.com/users/fkaempfer/events{/privacy}","received_events_url":"https://api.github.com/users/fkaempfer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T12:30:30Z","updated_at":"2017-07-12T12:30:30Z","author_association":"CONTRIBUTOR","body":"@rnewson @wohali all seems good from my side. Let me know if you still want me to make changes.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314754484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314800972","html_url":"https://github.com/apache/couchdb/pull/475#issuecomment-314800972","issue_url":"https://api.github.com/repos/apache/couchdb/issues/475","id":314800972,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDgwMDk3Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T15:12:33Z","updated_at":"2017-07-12T15:12:33Z","author_association":"MEMBER","body":"Robert is busy so I'm going to +1 this on his behalf. Thank you so much @fkaempfer !","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314800972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314801353","html_url":"https://github.com/apache/couchdb/pull/475#issuecomment-314801353","issue_url":"https://api.github.com/repos/apache/couchdb/issues/475","id":314801353,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDgwMTM1Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T15:13:49Z","updated_at":"2017-07-12T15:13:49Z","author_association":"MEMBER","body":"I should have squashed that, my mistake.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314801353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314845689","html_url":"https://github.com/apache/couchdb/pull/627#issuecomment-314845689","issue_url":"https://api.github.com/repos/apache/couchdb/issues/627","id":314845689,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDg0NTY4OQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T17:49:26Z","updated_at":"2017-07-12T17:49:26Z","author_association":"CONTRIBUTOR","body":"@tonysun83 take another look. \r\n\r\nSince most tests are the same I put the default ones in a base test class. Then the index version overrides those methods and where it creates an index it does that first then call the superclass test method.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314845689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314851277","html_url":"https://github.com/apache/couchdb/issues/631#issuecomment-314851277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/631","id":314851277,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDg1MTI3Nw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T18:08:47Z","updated_at":"2017-07-12T18:08:47Z","author_association":"MEMBER","body":"I'm gonna take a stab at this by replacing os processes with native processes since we don't care about JS calls here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314851277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314861096","html_url":"https://github.com/apache/couchdb/issues/664#issuecomment-314861096","issue_url":"https://api.github.com/repos/apache/couchdb/issues/664","id":314861096,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDg2MTA5Ng==","user":{"login":"gr2m","id":39992,"node_id":"MDQ6VXNlcjM5OTky","avatar_url":"https://avatars.githubusercontent.com/u/39992?v=4","gravatar_id":"","url":"https://api.github.com/users/gr2m","html_url":"https://github.com/gr2m","followers_url":"https://api.github.com/users/gr2m/followers","following_url":"https://api.github.com/users/gr2m/following{/other_user}","gists_url":"https://api.github.com/users/gr2m/gists{/gist_id}","starred_url":"https://api.github.com/users/gr2m/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gr2m/subscriptions","organizations_url":"https://api.github.com/users/gr2m/orgs","repos_url":"https://api.github.com/users/gr2m/repos","events_url":"https://api.github.com/users/gr2m/events{/privacy}","received_events_url":"https://api.github.com/users/gr2m/received_events","type":"User","user_view_type":"public","site_admin":true},"created_at":"2017-07-12T18:45:29Z","updated_at":"2017-07-12T18:45:29Z","author_association":"NONE","body":"I got another issue after installing node LTS and running `make release`\r\n\r\n```\r\nmake[1]: Entering directory '/root/couchdb/src/docs'\r\n*** Make sure that sphinx-build is installed and on your path\r\nMakefile:63: recipe for target 'sphinx-build' failed\r\nmake[1]: *** [sphinx-build] Error 1\r\nmake[1]: Leaving directory '/root/couchdb/src/docs'\r\nMakefile:362: recipe for target 'src/docs/build' failed\r\nmake: *** [src/docs/build] Error 2\r\n```\r\n\r\nI run `sudo apt-get install python-sphinx`. After that `make release` behaved as expected","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314861096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314872583","html_url":"https://github.com/apache/couchdb/pull/665#issuecomment-314872583","issue_url":"https://api.github.com/repos/apache/couchdb/issues/665","id":314872583,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDg3MjU4Mw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T19:30:04Z","updated_at":"2017-07-12T19:30:04Z","author_association":"CONTRIBUTOR","body":"+1 (with the default.ini change Wohali mentioned)\r\n\r\nAlso here is a longer 10-build test run of the same: \r\n\r\nhttps://travis-ci.org/cloudant/couchdb/builds/252941547?utm_source=github_status&utm_medium=notification","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314872583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314873237","html_url":"https://github.com/apache/couchdb/pull/665#issuecomment-314873237","issue_url":"https://api.github.com/repos/apache/couchdb/issues/665","id":314873237,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDg3MzIzNw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T19:32:45Z","updated_at":"2017-07-12T19:32:45Z","author_association":"MEMBER","body":"@nickva What default.ini change?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314873237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314873652","html_url":"https://github.com/apache/couchdb/pull/665#issuecomment-314873652","issue_url":"https://api.github.com/repos/apache/couchdb/issues/665","id":314873652,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDg3MzY1Mg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T19:34:40Z","updated_at":"2017-07-12T19:34:40Z","author_association":"MEMBER","body":"Ah, page wasn't refreshed. Will add the default as a new commit for the history.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314873652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314873976","html_url":"https://github.com/apache/couchdb/pull/665#issuecomment-314873976","issue_url":"https://api.github.com/repos/apache/couchdb/issues/665","id":314873976,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDg3Mzk3Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T19:36:14Z","updated_at":"2017-07-12T19:36:14Z","author_association":"CONTRIBUTOR","body":"@davisp sorry, meant adding os_process_idle_limit to default.ini, but I just checked and it's already there just commented out.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314873976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314897548","html_url":"https://github.com/apache/couchdb/pull/665#issuecomment-314897548","issue_url":"https://api.github.com/repos/apache/couchdb/issues/665","id":314897548,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDg5NzU0OA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T21:07:58Z","updated_at":"2017-07-12T21:07:58Z","author_association":"MEMBER","body":"Calling out my comment that the request change to add os_process_idle_limit is unneeded since its already there. Just typoed a grep so merging this as is.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314897548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314903990","html_url":"https://github.com/apache/couchdb/pull/667#issuecomment-314903990","issue_url":"https://api.github.com/repos/apache/couchdb/issues/667","id":314903990,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDkwMzk5MA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-12T21:34:51Z","updated_at":"2017-07-12T21:34:51Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nNice find - two bugs with one PR! \r\n\r\nTook a while for me to understand what's happening since not familiar with this part of code.\r\n\r\nTests look good. One failure but in a different area.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314903990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314958861","html_url":"https://github.com/apache/couchdb/pull/668#issuecomment-314958861","issue_url":"https://api.github.com/repos/apache/couchdb/issues/668","id":314958861,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDk1ODg2MQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T03:15:52Z","updated_at":"2017-07-13T03:15:52Z","author_association":"CONTRIBUTOR","body":"Confirmed this fixes the issue.\r\n\r\nCouldn't replicate this easily on my artificially slowed down VM even. Got it to where the test itself would timeout but it wouldn't fail like on Travis. I think the idea is to slow down the storage subsystem not the CPU. \r\n\r\nThere is a way to do it, but I am lazy so did resorted to just adding a sleep to the update runner before the:\r\n\r\n`exit({updated, self(), FinalIdxState})` line.\r\n\r\nAnd a few log statements:\r\n\r\n```\r\n(655-fix-couchdb-views-tests)$ git diff\r\ndiff --git a/src/couch_index/src/couch_index_updater.erl b/src/couch_index/src/couch_index_updater.erl\r\nindex ad48f40..aedd2d1 100644\r\n--- a/src/couch_index/src/couch_index_updater.erl\r\n+++ b/src/couch_index/src/couch_index_updater.erl\r\n@@ -69,6 +69,7 @@ handle_call({update, IdxState}, _From, #st{idx=Idx, mod=Mod}=State) ->\r\n     Args = [Mod:get(db_name, IdxState), Mod:get(idx_name, IdxState)],\r\n     couch_log:info(\"Starting index update for db: ~s idx: ~s\", Args),\r\n     Pid = spawn_link(?MODULE, update, [Idx, Mod, IdxState]),\r\n+    io:format(standard_error, \"~n XXXXXX handle_call update spawned ~p~n\", [Pid]),\r\n     {reply, ok, State#st{pid=Pid}};\r\n handle_call({restart, IdxState}, _From, #st{idx=Idx, mod=Mod}=State) ->\r\n     Args = [Mod:get(db_name, IdxState), Mod:get(idx_name, IdxState)],\r\n@@ -100,6 +101,7 @@ handle_info({'EXIT', _, {reset, Pid}}, #st{idx=Idx, pid=Pid}=State) ->\r\n     Pid2 = spawn_link(?MODULE, update, [Idx, State#st.mod, NewIdxState]),\r\n     {noreply, State#st{pid=Pid2}};\r\n handle_info({'EXIT', Pid, normal}, #st{pid=Pid}=State) ->\r\n+    io:format(standard_error, \"~n XXXXXX handle_info Pid normal set to undefined ~p~n\", [Pid]),\r\n     {noreply, State#st{pid=undefined}};\r\n handle_info({'EXIT', Pid, {{nocatch, Error}, _Trace}}, State) ->\r\n     handle_info({'EXIT', Pid, Error}, State);\r\n@@ -193,6 +195,8 @@ update(Idx, Mod, IdxState) ->\r\n         end,\r\n\r\n         {ok, FinalIdxState} = Mod:finish_update(LastIdxSt),\r\n+        timer:sleep(1000),\r\n+        io:format(standard_error, \"~n XXXXXX  update exiting self() = ~p~n\", [self()]),\r\n         exit({updated, self(), FinalIdxState})\r\n     end).\r\n\r\n```\r\n\r\nNow could see the failure:\r\n\r\n```\r\n*failed*\r\nin function couchdb_views_tests:wait_for_process_shutdown/3 (test/couchdb_views_tests.erl, line 413)\r\nin call from couchdb_views_tests:'-couchdb_1283/0-fun-21-'/0 (test/couchdb_views_tests.erl, line 358)\r\n**error:{assertion_failed,[{module,couchdb_views_tests},\r\n                   {line,415},\r\n                   {reason,\"Failure waiting for db shutdown\"}]}\r\n\r\n```\r\n\r\nThen the PR fixes the failure:\r\n\r\n```\r\n==> couch (eunit)\r\n    Running test function(s):\r\n      couchdb_views_tests:view_group_shutdown_test_/0\r\n======================== EUnit ========================\r\nView group shutdown\r\nApplication crypto was left running!\r\n  couchdb_views_tests:315: couchdb_1283...\r\n XXXXXX handle_call update spawned <0.318.0>\r\n\r\n XXXXXX  update exiting self() = <0.318.0>\r\n[1.286 s] ok\r\n```\r\n\r\n+1\r\n\r\nVery nice!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314958861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314973672","html_url":"https://github.com/apache/couchdb/issues/666#issuecomment-314973672","issue_url":"https://api.github.com/repos/apache/couchdb/issues/666","id":314973672,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDk3MzY3Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T05:20:10Z","updated_at":"2017-07-13T05:20:10Z","author_association":"CONTRIBUTOR","body":"Same thing would be good for the _replicator db's  `_design/_replicator` VDU doc. It would be simpler if it was in Erlang","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314973672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314986905","html_url":"https://github.com/apache/couchdb/issues/669#issuecomment-314986905","issue_url":"https://api.github.com/repos/apache/couchdb/issues/669","id":314986905,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDk4NjkwNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T06:43:57Z","updated_at":"2017-07-13T06:43:57Z","author_association":"MEMBER","body":"See #673 - related?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314986905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314987550","html_url":"https://github.com/apache/couchdb/issues/673#issuecomment-314987550","issue_url":"https://api.github.com/repos/apache/couchdb/issues/673","id":314987550,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNDk4NzU1MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T06:47:25Z","updated_at":"2017-07-13T06:47:25Z","author_association":"MEMBER","body":"Also in Travis:\r\n* https://travis-ci.org/apache/couchdb/jobs/253082338#L5761","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/314987550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315009764","html_url":"https://github.com/apache/couchdb/pull/475#issuecomment-315009764","issue_url":"https://api.github.com/repos/apache/couchdb/issues/475","id":315009764,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTAwOTc2NA==","user":{"login":"fkaempfer","id":2357885,"node_id":"MDQ6VXNlcjIzNTc4ODU=","avatar_url":"https://avatars.githubusercontent.com/u/2357885?v=4","gravatar_id":"","url":"https://api.github.com/users/fkaempfer","html_url":"https://github.com/fkaempfer","followers_url":"https://api.github.com/users/fkaempfer/followers","following_url":"https://api.github.com/users/fkaempfer/following{/other_user}","gists_url":"https://api.github.com/users/fkaempfer/gists{/gist_id}","starred_url":"https://api.github.com/users/fkaempfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkaempfer/subscriptions","organizations_url":"https://api.github.com/users/fkaempfer/orgs","repos_url":"https://api.github.com/users/fkaempfer/repos","events_url":"https://api.github.com/users/fkaempfer/events{/privacy}","received_events_url":"https://api.github.com/users/fkaempfer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T08:31:11Z","updated_at":"2017-07-13T08:31:11Z","author_association":"CONTRIBUTOR","body":"Thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315009764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315130740","html_url":"https://github.com/apache/couchdb/pull/627#issuecomment-315130740","issue_url":"https://api.github.com/repos/apache/couchdb/issues/627","id":315130740,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTEzMDc0MA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T16:28:05Z","updated_at":"2017-07-13T16:28:05Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315130740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315132166","html_url":"https://github.com/apache/couchdb/issues/669#issuecomment-315132166","issue_url":"https://api.github.com/repos/apache/couchdb/issues/669","id":315132166,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTEzMjE2Ng==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T16:33:21Z","updated_at":"2017-07-13T16:33:21Z","author_association":"MEMBER","body":"Could be. I can't figure out how we're not getting logs from the tests that are reported as passing in the same run.\r\n\r\n@wohali What do you think about adding a few commands to the script just before starting the javascript test suite to check on host health? I'm thinking of checking things like df, free, netstat, and maybe something like `ps ax | wc -l` or similar to try and get an idea of what we might be hitting. Also might be useful to add collecting whatever logs OOM-killer actions into our couchlog uploads incase we're seeing memory issues that you mentioned the other day.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315132166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315133198","html_url":"https://github.com/apache/couchdb/issues/666#issuecomment-315133198","issue_url":"https://api.github.com/repos/apache/couchdb/issues/666","id":315133198,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTEzMzE5OA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T16:37:10Z","updated_at":"2017-07-13T16:37:10Z","author_association":"MEMBER","body":"+1 with the caveat that we should't do this via enabling the erlang view server since that's leads to other issues (unless until Erlang figures out sandboxing).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315133198/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315134138","html_url":"https://github.com/apache/couchdb/issues/669#issuecomment-315134138","issue_url":"https://api.github.com/repos/apache/couchdb/issues/669","id":315134138,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTEzNDEzOA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T16:40:51Z","updated_at":"2017-07-13T16:40:51Z","author_association":"CONTRIBUTOR","body":"I did some of that in the jenkins-pipeline branch: \r\n\r\nhttps://github.com/apache/couchdb/blob/32eb49a0c2c26315aed8bb47befba915cd071f55/Makefile#L92-L103\r\n\r\nIt's a good idea. Even crazier could have a mini benchmark - try to write to disk, read back, run a few cpu speed tests, memory usage etc. And maybe decide test environment is just crappy and give up. Cause it certainly seems crappy a lot of the times.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315134138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315134975","html_url":"https://github.com/apache/couchdb/issues/552#issuecomment-315134975","issue_url":"https://api.github.com/repos/apache/couchdb/issues/552","id":315134975,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTEzNDk3NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T16:43:54Z","updated_at":"2017-07-13T16:44:14Z","author_association":"MEMBER","body":"Gonna close this as a duplicate of #655. The previous comment from @wohali is referencing an entirely different test so am assuming that was just having too many issue tabs open at once.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315134975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315136085","html_url":"https://github.com/apache/couchdb/pull/672#issuecomment-315136085","issue_url":"https://api.github.com/repos/apache/couchdb/issues/672","id":315136085,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTEzNjA4NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T16:48:04Z","updated_at":"2017-07-13T16:48:04Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315136085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315136301","html_url":"https://github.com/apache/couchdb/pull/671#issuecomment-315136301","issue_url":"https://api.github.com/repos/apache/couchdb/issues/671","id":315136301,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTEzNjMwMQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T16:48:51Z","updated_at":"2017-07-13T16:48:51Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315136301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315141332","html_url":"https://github.com/apache/couchdb/issues/552#issuecomment-315141332","issue_url":"https://api.github.com/repos/apache/couchdb/issues/552","id":315141332,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE0MTMzMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T17:07:03Z","updated_at":"2017-07-13T17:07:03Z","author_association":"MEMBER","body":"The previous comment from me was referencing an entirely different test, but one that I bisected back to @janl 's change.\r\n\r\nWe can close for now but if that assertion comes up again we will have this \"paper trail\" to possibly indicate where it came from.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315141332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315141786","html_url":"https://github.com/apache/couchdb/issues/669#issuecomment-315141786","issue_url":"https://api.github.com/repos/apache/couchdb/issues/669","id":315141786,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE0MTc4Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T17:08:55Z","updated_at":"2017-07-13T17:08:55Z","author_association":"MEMBER","body":"@davisp we lose it because `dev/run` nukes the logfile when restarting the node. I considered changing this code about a week ago, but it would never clean up the logfile in that case, making a local dev instance's logfile grow until someone manually cleaned it out.\r\n\r\nIn short `dev/run` should be enhanced so node restart doesn't wipe a logfile, but node initial-startup does.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315141786/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315141842","html_url":"https://github.com/apache/couchdb/issues/549#issuecomment-315141842","issue_url":"https://api.github.com/repos/apache/couchdb/issues/549","id":315141842,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE0MTg0Mg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T17:09:12Z","updated_at":"2017-07-13T17:09:30Z","author_association":"MEMBER","body":"This is a duplicate of #571.\r\n\r\nThe timeout error is the first error seen when you scroll up in the log. But if you keep going you'll see this bit in the logs:\r\n\r\n```\r\nmodule 'couchdb_os_daemons_tests'\r\n  OS Daemons tests\r\n    couchdb_os_daemons_tests:107: should_check_daemon...ok\r\n    couchdb_os_daemons_tests:113: should_check_daemon_table_form...ok\r\n    couchdb_os_daemons_tests:120: should_clean_tables_on_daemon_remove...[0.544 s] ok\r\n    couchdb_os_daemons_tests:127: should_spawn_multiple_daemons...[0.618 s] ok\r\n    undefined\r\n    *** context cleanup failed ***\r\n**in function test_util:stop_sync_throw/4 (src/test_util.erl, line 160)\r\nin call from couchdb_os_daemons_tests:teardown/2 (test/couchdb_os_daemons_tests.erl, line 58)\r\n**throw:{timeout,os_daemon_stop}\r\n\r\n\r\n  undefined\r\n  *** context setup failed ***\r\n**in function meck_proc:start/2 (src/meck_proc.erl, line 96)\r\n  called as start(couch_stats,[passthrough])\r\nin call from test_util:mock/1 (src/test_util.erl, line 244)\r\nin call from test_util:'-mock/1-lc$^0/1-0-'/1 (src/test_util.erl, line 237)\r\nin call from test_util:start/3 (src/test_util.erl, line 225)\r\nin call from couchdb_os_daemons_tests:setup/1 (test/couchdb_os_daemons_tests.erl, line 47)\r\n**error:{already_started,<0.3624.1>}\r\n```\r\n\r\nWe failed to shutdown couch properly which leaves it in a weird state which causes a lot of other failures as well. Given that this was fixed I'm closing and we can reopen if it happens again.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315141842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315142131","html_url":"https://github.com/apache/couchdb/issues/670#issuecomment-315142131","issue_url":"https://api.github.com/repos/apache/couchdb/issues/670","id":315142131,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE0MjEzMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T17:10:21Z","updated_at":"2017-07-13T17:10:21Z","author_association":"MEMBER","body":"@davisp Be sure to bump rebar.config.script in apache/couchdb !!!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315142131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315144090","html_url":"https://github.com/apache/couchdb/issues/552#issuecomment-315144090","issue_url":"https://api.github.com/repos/apache/couchdb/issues/552","id":315144090,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE0NDA5MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T17:17:43Z","updated_at":"2017-07-13T17:17:43Z","author_association":"MEMBER","body":"Hrm, I'm gonna open a new ticket with your comment then. I don't think these two issues are related but those failures do look to be flaky tests.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315144090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315146182","html_url":"https://github.com/apache/couchdb/issues/638#issuecomment-315146182","issue_url":"https://api.github.com/repos/apache/couchdb/issues/638","id":315146182,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE0NjE4Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T17:26:21Z","updated_at":"2017-07-13T17:26:21Z","author_association":"MEMBER","body":"This is back:\r\n\r\nhttps://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/88/pipeline/49\r\nhttps://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/88/pipeline/48\r\nhttps://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/87/pipeline/41\r\nhttps://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/87/pipeline/42\r\nhttps://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/89/pipeline/41\r\nmodule 'couchdb_compaction_daemon_tests'\r\n  Compaction daemon tests\r\n    couchdb_compaction_daemon_tests:75: should_compact_by_default_rule...*timed out*\r\n    undefined\r\n  couchdb_compaction_daemon_tests:106: should_compact_by_dbname_rule...*timed out*\r\n  undefined\r\n\r\nNeed to analyze the couch logs to see if we're running out of disk space.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315146182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315146423","html_url":"https://github.com/apache/couchdb/issues/633#issuecomment-315146423","issue_url":"https://api.github.com/repos/apache/couchdb/issues/633","id":315146423,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE0NjQyMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T17:27:14Z","updated_at":"2017-07-13T17:27:14Z","author_association":"MEMBER","body":"Another instance of this\r\n\r\n* https://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/87/pipeline/47\r\n  * `couch_replicator_small_max_request_size_target:124: should_replicate...*timed out*`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315146423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315147326","html_url":"https://github.com/apache/couchdb/issues/674#issuecomment-315147326","issue_url":"https://api.github.com/repos/apache/couchdb/issues/674","id":315147326,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE0NzMyNg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T17:30:42Z","updated_at":"2017-07-13T17:30:42Z","author_association":"MEMBER","body":"This is probably related to #638","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315147326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315147913","html_url":"https://github.com/apache/couchdb/issues/670#issuecomment-315147913","issue_url":"https://api.github.com/repos/apache/couchdb/issues/670","id":315147913,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE0NzkxMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T17:32:53Z","updated_at":"2017-07-13T17:32:53Z","author_association":"MEMBER","body":"https://github.com/apache/couchdb/commit/f77a78f4d885aba0bf7bbeb607997b77de196b18","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315147913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315178171","html_url":"https://github.com/apache/couchdb/issues/675#issuecomment-315178171","issue_url":"https://api.github.com/repos/apache/couchdb/issues/675","id":315178171,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE3ODE3MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T19:28:07Z","updated_at":"2017-07-13T19:28:07Z","author_association":"MEMBER","body":"Again @ https://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/92/pipeline/49","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315178171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315178290","html_url":"https://github.com/apache/couchdb/issues/638#issuecomment-315178290","issue_url":"https://api.github.com/repos/apache/couchdb/issues/638","id":315178290,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE3ODI5MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T19:28:36Z","updated_at":"2017-07-13T19:29:56Z","author_association":"MEMBER","body":"Again @ https://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/92/pipeline/41, but:\r\n\r\n```\r\n[warning] 2017-07-13T17:20:13.606448Z nonode@nohost <0.15086.1> -------- Compaction daemon - skipping database `_dbs` compaction: the estimated necessary disk space is about 53890 bytes but the currently available disk space is 0 bytes.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315178290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315184184","html_url":"https://github.com/apache/couchdb/issues/674#issuecomment-315184184","issue_url":"https://api.github.com/repos/apache/couchdb/issues/674","id":315184184,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE4NDE4NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T19:52:41Z","updated_at":"2017-07-13T19:52:41Z","author_association":"MEMBER","body":"#638 is out-of-disk-space on Jenkins. This is unrelated.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315184184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315184379","html_url":"https://github.com/apache/couchdb/issues/638#issuecomment-315184379","issue_url":"https://api.github.com/repos/apache/couchdb/issues/638","id":315184379,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE4NDM3OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T19:53:27Z","updated_at":"2017-07-13T19:53:27Z","author_association":"MEMBER","body":"I talked with INFRA just now and handed them a pointer to https://github.com/apache/couchdb-ci/blob/master/bin/cleanup-docker.sh . They're going to put something similar in a cron job on the Jenkins build agents.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315184379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315185827","html_url":"https://github.com/apache/couchdb/issues/674#issuecomment-315185827","issue_url":"https://api.github.com/repos/apache/couchdb/issues/674","id":315185827,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE4NTgyNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T19:58:52Z","updated_at":"2017-07-13T20:03:11Z","author_association":"MEMBER","body":"OK looked at a couch.log. We have a race where the compaction daemon finishes compacting the test DB, then immediately starts compacting it **again**, so our check for the db to be idle fails.\r\n\r\n```\r\n[info] 2017-06-16T18:49:25.122688Z nonode@nohost <0.13883.1> -------- Starting compaction for db \"eunit-test-db-1497638926674066\"\r\n[notice] 2017-06-16T18:49:25.383106Z nonode@nohost <0.13883.1> -------- Compaction swap for db: /home/travis/build/apache/couchdb/tmp/data/eunit-test-db-1497638926674066.couch 1646789 53445\r\n[info] 2017-06-16T18:49:25.386118Z nonode@nohost <0.13883.1> -------- Compaction for db \"eunit-test-db-1497638926674066\" completed.\r\n[info] 2017-06-16T18:49:25.390952Z nonode@nohost <0.16501.1> -------- Compaction started for db: eunit-test-db-1497638926674066 idx: _design/foo\r\n[notice] 2017-06-16T18:49:25.434478Z nonode@nohost <0.13891.1> -------- Compaction swap for view /home/travis/build/apache/couchdb/tmp/data/.eunit-test-db-1497638926674066_design/mrview/ee2c720a13443ab1d50210242730ca31.view 391267 28800\r\n[notice] 2017-06-16T18:49:25.443473Z nonode@nohost <0.13662.1> -------- config: [compactions] _default deleted for reason nil\r\n[info] 2017-06-16T18:49:25.443559Z nonode@nohost <0.16501.1> -------- Compaction finished for db: eunit-test-db-1497638926674066 idx: _design/foo\r\n[error] 2017-06-16T18:49:25.472035Z nonode@nohost <0.13891.1> -------- gen_server <0.13891.1> terminated with reason: no such process or port in call to gen_server:call(<0.16503.1>, close, infinity)\r\n  last msg: {'$gen_cast',delete}\r\n     state: {st,couch_mrview_index,{mrst,<<238,44,114,10,19,68,58,177,213,2,16,36,39,48,202,49>>,<0.16503.1>,#Ref<0.0.6.37429>,<<\"eunit-test-db-1497638926674066\">>,<<\"_design/foo\">>,<<\"javascript\">>,[],false,false,{[]},[{mrview,0,0,0,[<<\"foo3\">>,<<\"foo2\">>,<<\"foo\">>],[],<<\"function(doc) { emit(doc._id, doc); }\">>,{btree,<0.16503.1>,{26184,{400,[]},18346},undefined,undefined,#Fun<couch_ejson_compare.less_json_ids.2>,#Fun<couch_mrview_util.17.14385612>,snappy},nil,nil,false,false,[]}],{btree,<0.16503.1>,{7946,[],7997},undefined,undefined,undefined,nil,snappy},nil,401,0,undefined,undefined,undefined,undefined,undefined,nil},<0.13894.1>,<0.13895.1>,[],false,false}\r\n[error] 2017-06-16T18:49:25.475163Z nonode@nohost <0.13891.1> -------- CRASH REPORT Process  (<0.13891.1>) with 0 neighbors exited with reason: no such process or port in call to gen_server:call(<0.16503.1>, close, infinity) at gen_server:terminate/6(line:722) <= proc_lib:init_p_do_apply/3(line:239); initial_call: {couch_index,init,['Argument__1']}, ancestors: [<0.13890.1>], messages: [], links: [<0.13894.1>,<0.13895.1>,<0.13861.1>], dictionary: [], trap_exit: false, status: running, heap_size: 2586, stack_size: 27, reductions: 31341\r\n[error] 2017-06-16T18:49:25.476680Z nonode@nohost <0.13895.1> -------- gen_server <0.13895.1> terminated with reason: no such process or port in call to gen_server:call(<0.16503.1>, close, infinity)\r\n  last msg: {'EXIT',<0.13891.1>,{noproc,{gen_server,call,[<0.16503.1>,close,infinity]}}}\r\n     state: {st,<0.13891.1>,couch_mrview_index,undefined}\r\n[error] 2017-06-16T18:49:25.477461Z nonode@nohost <0.13895.1> -------- CRASH REPORT Process  (<0.13895.1>) with 0 neighbors exited with reason: no such process or port in call to gen_server:call(<0.16503.1>, close, infinity) at gen_server:terminate/6(line:744) <= proc_lib:init_p_do_apply/3(line:239); initial_call: {couch_index_compactor,init,['Argument__1']}, ancestors: [<0.13891.1>,<0.13890.1>], messages: [], links: [], dictionary: [], trap_exit: true, status: running, heap_size: 610, stack_size: 27, reductions: 194\r\n[error] 2017-06-16T18:49:25.478441Z nonode@nohost <0.13894.1> -------- gen_server <0.13894.1> terminated with reason: no such process or port in call to gen_server:call(<0.16503.1>, close, infinity)\r\n  last msg: {'EXIT',<0.13891.1>,{noproc,{gen_server,call,[<0.16503.1>,close,infinity]}}}\r\n     state: {st,<0.13891.1>,couch_mrview_index,undefined}\r\n[error] 2017-06-16T18:49:25.479197Z nonode@nohost <0.13894.1> -------- CRASH REPORT Process  (<0.13894.1>) with 0 neighbors exited with reason: no such process or port in call to gen_server:call(<0.16503.1>, close, infinity) at gen_server:terminate/6(line:744) <= proc_lib:init_p_do_apply/3(line:239); initial_call: {couch_index_updater,init,['Argument__1']}, ancestors: [<0.13891.1>,<0.13890.1>], messages: [], links: [], dictionary: [], trap_exit: true, status: running, heap_size: 1598, stack_size: 27, reductions: 596288\r\n[error] 2017-06-16T18:49:25.479677Z nonode@nohost <0.13861.1> -------- gen_server couch_index_server terminated with reason: no such process or port in call to gen_server:call(<0.16503.1>, close, infinity)\r\n  last msg: {'EXIT',<0.13891.1>,{noproc,{gen_server,call,[<0.16503.1>,close,infinity]}}}\r\n     state: {st,\"/home/travis/build/apache/couchdb/tmp/data\"}\r\n[error] 2017-06-16T18:49:25.480143Z nonode@nohost <0.13861.1> -------- CRASH REPORT Process couch_index_server (<0.13861.1>) with 1 neighbors exited with reason: no such process or port in call to gen_server:call(<0.16503.1>, close, infinity) at gen_server:terminate/6(line:744) <= proc_lib:init_p_do_apply/3(line:239); initial_call: {couch_index_server,init,['Argument__1']}, ancestors: [couch_secondary_services,couch_sup,<0.13815.1>], messages: [], links: [<0.13863.1>,<0.13824.1>], dictionary: [], trap_exit: true, status: running, heap_size: 1598, stack_size: 27, reductions: 4707\r\n[error] 2017-06-16T18:49:25.480593Z nonode@nohost <0.13824.1> -------- Supervisor couch_secondary_services had child index_server started with couch_index_server:start_link() at <0.13861.1> exit with reason no such process or port in call to gen_server:call(<0.16503.1>, close, infinity) in context child_terminated\r\n[error] 2017-06-16T18:49:25.502120Z nonode@nohost <0.13865.1> -------- gen_server couch_compaction_daemon terminated with reason: {not_mocked,couch_compaction_daemon} at meck_proc:gen_server/3(line:450) <= meck_code_gen:exec/4(line:147) <= gen_server:handle_msg/5(line:604) <= proc_lib:init_p_do_apply/3(line:239)\r\n  last msg: {'EXIT',<0.13867.1>,killed}\r\n     state: {state,<0.13867.1>,[]}\r\n[error] 2017-06-16T18:49:25.502762Z nonode@nohost <0.13865.1> -------- CRASH REPORT Process couch_compaction_daemon (<0.13865.1>) with 0 neighbors exited with reason: {not_mocked,couch_compaction_daemon} at meck_proc:gen_server/3(line:450) <= meck_code_gen:exec/4(line:147) <= gen_server:handle_msg/5(line:604) <= proc_lib:init_p_do_apply/3(line:239) at gen_server:terminate/6(line:744) <= proc_lib:init_p_do_apply/3(line:239); initial_call: {couch_compaction_daemon,init,['Argument__1']}, ancestors: [couch_secondary_services,couch_sup,<0.13815.1>], messages: [], links: [<0.13824.1>], dictionary: [], trap_exit: true, status: running, heap_size: 1598, stack_size: 27, reductions: 1318\r\n[error] 2017-06-16T18:49:25.503149Z nonode@nohost <0.13824.1> -------- Supervisor couch_secondary_services had child compaction_daemon started with couch_compaction_daemon:start_link() at <0.13865.1> exit with reason {not_mocked,couch_compaction_daemon} at meck_proc:gen_server/3(line:450) <= meck_code_gen:exec/4(line:147) <= gen_server:handle_msg/5(line:604) <= proc_lib:init_p_do_apply/3(line:239) in context child_terminated\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315185827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315186525","html_url":"https://github.com/apache/couchdb/issues/674#issuecomment-315186525","issue_url":"https://api.github.com/repos/apache/couchdb/issues/674","id":315186525,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE4NjUyNQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T20:01:41Z","updated_at":"2017-07-13T20:01:41Z","author_association":"MEMBER","body":"Looks like the right diagnosis to me. My read on the is_idle test is that we're trying to assert that the compaction daemon doesn't hold a monitor on the database after its done compacting. Perhaps it'd be better to grab the monitors while its compacting and then just assert that its not got the same monitors? Though getting the monitor that Pid A has on Pid B from Pid C is racy at best.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315186525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315186953","html_url":"https://github.com/apache/couchdb/issues/674#issuecomment-315186953","issue_url":"https://api.github.com/repos/apache/couchdb/issues/674","id":315186953,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE4Njk1Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T20:03:27Z","updated_at":"2017-07-13T20:03:27Z","author_association":"MEMBER","body":"~~What I don't know is if that's a legitimate attempt to re-compact (because it is still too fragmented) or if the compaction daemon is attempting to re-compact based on old data about the state of the DB in question.~~\r\n\r\nSo it must be acting on outdated data. Our test fails on the last line of this paste:\r\n\r\n```\r\n        {DbFrag2, DbFileSize2} = get_db_frag(DbName),\r\n        {ViewFrag2, ViewFileSize2} = get_view_frag(DbName),\r\n\r\n        ?assert(DbFrag2 < 70),\r\n        ?assert(ViewFrag2 < 70),\r\n\r\n        ?assert(DbFileSize > DbFileSize2),\r\n        ?assert(ViewFileSize > ViewFileSize2),\r\n\r\n        ?assert(is_idle(DbName))\r\n```\r\n\r\nwhich means the compacted DB __must__ be small enough, and the compaction daemon is acting on outdated data.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315186953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315198304","html_url":"https://github.com/apache/couchdb/issues/674#issuecomment-315198304","issue_url":"https://api.github.com/repos/apache/couchdb/issues/674","id":315198304,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTE5ODMwNA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-13T20:50:40Z","updated_at":"2017-07-13T20:50:40Z","author_association":"MEMBER","body":"Oops, I think we both read that wrong with GitHub chopping off and forcing the horizontal scroll. The second database compaction is the view compaction. Which we expect. Though I find it odd that the config deletion happens nearly 10ms after the swap compacted.\r\n\r\nThough we wait for that compactor pid to exit... I *think* that's the key to what's causing us issues","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315198304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315384435","html_url":"https://github.com/apache/couchdb/pull/676#issuecomment-315384435","issue_url":"https://api.github.com/repos/apache/couchdb/issues/676","id":315384435,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTM4NDQzNQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-14T15:09:45Z","updated_at":"2017-07-14T15:09:45Z","author_association":"CONTRIBUTOR","body":"Tested on a CPU and disk resource constrained VM\r\n\r\nCPU resources slowed down to 9% and disk throughput limit set at 100KB/sec\r\n\r\n```VBoxManage bandwidthctl ${VM} set Limit --limit 100KB```\r\n\r\nSeems to pass when before it failed:\r\n\r\n```\r\n test/javascript/run replication.js\r\ntest/javascript/tests/replication.js   pass\r\n=======================================================\r\nJavaScript tests complete.\r\n  Failed: 0.  Skipped or passed: 1.\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315384435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315397858","html_url":"https://github.com/apache/couchdb/pull/676#issuecomment-315397858","issue_url":"https://api.github.com/repos/apache/couchdb/issues/676","id":315397858,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTM5Nzg1OA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-14T16:02:06Z","updated_at":"2017-07-14T16:02:06Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315397858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315398095","html_url":"https://github.com/apache/couchdb/pull/677#issuecomment-315398095","issue_url":"https://api.github.com/repos/apache/couchdb/issues/677","id":315398095,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTM5ODA5NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-14T16:03:10Z","updated_at":"2017-07-14T16:03:10Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315398095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315401626","html_url":"https://github.com/apache/couchdb/issues/674#issuecomment-315401626","issue_url":"https://api.github.com/repos/apache/couchdb/issues/674","id":315401626,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTQwMTYyNg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-14T16:17:45Z","updated_at":"2017-07-14T16:17:45Z","author_association":"MEMBER","body":"I'm gonna add a log message when the assertion fails to try and figure out what it is exactly that's causing this to fail. Hopefully that'll shed some light on who it is causing us issues. PR incoming.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315401626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315406016","html_url":"https://github.com/apache/couchdb/pull/679#issuecomment-315406016","issue_url":"https://api.github.com/repos/apache/couchdb/issues/679","id":315406016,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTQwNjAxNg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-14T16:36:49Z","updated_at":"2017-07-14T16:36:49Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315406016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315442131","html_url":"https://github.com/apache/couchdb/pull/622#issuecomment-315442131","issue_url":"https://api.github.com/repos/apache/couchdb/issues/622","id":315442131,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTQ0MjEzMQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-14T19:05:38Z","updated_at":"2017-07-14T19:05:38Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315442131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315560859","html_url":"https://github.com/apache/couchdb/issues/675#issuecomment-315560859","issue_url":"https://api.github.com/repos/apache/couchdb/issues/675","id":315560859,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTU2MDg1OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-15T20:33:55Z","updated_at":"2017-07-15T20:33:55Z","author_association":"MEMBER","body":"Fixed by #679. Will reopen if we see this recur.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315560859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315560949","html_url":"https://github.com/apache/couchdb/issues/634#issuecomment-315560949","issue_url":"https://api.github.com/repos/apache/couchdb/issues/634","id":315560949,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTU2MDk0OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-15T20:35:30Z","updated_at":"2017-07-15T20:35:30Z","author_association":"MEMBER","body":"Fixed by #676. Going to close for now - reopen if recurs.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315560949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315599733","html_url":"https://github.com/apache/couchdb/issues/584#issuecomment-315599733","issue_url":"https://api.github.com/repos/apache/couchdb/issues/584","id":315599733,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTU5OTczMw==","user":{"login":"ArikShifer","id":13464108,"node_id":"MDQ6VXNlcjEzNDY0MTA4","avatar_url":"https://avatars.githubusercontent.com/u/13464108?v=4","gravatar_id":"","url":"https://api.github.com/users/ArikShifer","html_url":"https://github.com/ArikShifer","followers_url":"https://api.github.com/users/ArikShifer/followers","following_url":"https://api.github.com/users/ArikShifer/following{/other_user}","gists_url":"https://api.github.com/users/ArikShifer/gists{/gist_id}","starred_url":"https://api.github.com/users/ArikShifer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArikShifer/subscriptions","organizations_url":"https://api.github.com/users/ArikShifer/orgs","repos_url":"https://api.github.com/users/ArikShifer/repos","events_url":"https://api.github.com/users/ArikShifer/events{/privacy}","received_events_url":"https://api.github.com/users/ArikShifer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T10:22:04Z","updated_at":"2017-07-16T10:22:04Z","author_association":"NONE","body":"HI @wohali, unfortunately I cannot test against CouchDB master. My project is restricted to couchdb v2.0.0.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315599733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315613763","html_url":"https://github.com/apache/couchdb/issues/621#issuecomment-315613763","issue_url":"https://api.github.com/repos/apache/couchdb/issues/621","id":315613763,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYxMzc2Mw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T14:44:58Z","updated_at":"2017-07-16T14:45:14Z","author_association":"MEMBER","body":"Unless Iâ€˜m missing something obvious, I donâ€™t see a deprecation, but a unilateral removal of stale=ok, which has not been flagged as 2.0 BC break which is terrible to find a year later :/ â€” I propose we re-introduce stale=ok as an alias to the combination of `stable` and `update` it represents, and make that also available on Mango.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315613763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315613805","html_url":"https://github.com/apache/couchdb/pull/628#issuecomment-315613805","issue_url":"https://api.github.com/repos/apache/couchdb/issues/628","id":315613805,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYxMzgwNQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T14:45:30Z","updated_at":"2017-07-16T15:51:05Z","author_association":"MEMBER","body":"Please see https://github.com/apache/couchdb/issues/621#issuecomment-315613763 ff. for comment.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315613805/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315614955","html_url":"https://github.com/apache/couchdb/issues/621#issuecomment-315614955","issue_url":"https://api.github.com/repos/apache/couchdb/issues/621","id":315614955,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYxNDk1NQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T15:00:36Z","updated_at":"2017-07-16T15:00:36Z","author_association":"MEMBER","body":"it was not removed, just embellished.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315614955/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315617959","html_url":"https://github.com/apache/couchdb/issues/621#issuecomment-315617959","issue_url":"https://api.github.com/repos/apache/couchdb/issues/621","id":315617959,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYxNzk1OQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T15:50:43Z","updated_at":"2017-07-16T15:50:43Z","author_association":"MEMBER","body":"@rnewson thanks for the heads up, Iâ€™m seeing https://github.com/apache/couchdb-couch-mrview/commit/459a548f269b00bf2d2ace0#diff-0dce740f95201eba18c70634c3ba6dcbL506 now.\r\n\r\nMy point then remains, `stale` is not deprecated and should be added to Mango the same way.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315617959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315620041","html_url":"https://github.com/apache/couchdb/pull/628#issuecomment-315620041","issue_url":"https://api.github.com/repos/apache/couchdb/issues/628","id":315620041,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYyMDA0MQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T16:23:07Z","updated_at":"2017-07-16T16:23:07Z","author_association":"MEMBER","body":"added stale, rebased with master and squashed my commits.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315620041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315620969","html_url":"https://github.com/apache/couchdb/issues/593#issuecomment-315620969","issue_url":"https://api.github.com/repos/apache/couchdb/issues/593","id":315620969,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYyMDk2OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T16:40:46Z","updated_at":"2017-07-16T16:40:46Z","author_association":"MEMBER","body":"Time for me to work on Fauxton and get this change exposed there. Once that's done, I'll update the documentation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315620969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315626164","html_url":"https://github.com/apache/couchdb/pull/570#issuecomment-315626164","issue_url":"https://api.github.com/repos/apache/couchdb/issues/570","id":315626164,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYyNjE2NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T18:05:51Z","updated_at":"2017-07-16T18:05:51Z","author_association":"MEMBER","body":"Bunch of warnings in the test that should be cleaned up prior to merging:\r\n\r\n```\r\n/home/travis/build/apache/couchdb/src/couch_peruser/test/couch_peruser_test.erl:209: Warning: a term is constructed, but never used\r\n/home/travis/build/apache/couchdb/src/couch_peruser/test/couch_peruser_test.erl:210: Warning: a term is constructed, but never used\r\n/home/travis/build/apache/couchdb/src/couch_peruser/test/couch_peruser_test.erl:226: Warning: a term is constructed, but never used\r\n/home/travis/build/apache/couchdb/src/couch_peruser/test/couch_peruser_test.erl:227: Warning: a term is constructed, but never used\r\n/home/travis/build/apache/couchdb/src/couch_peruser/test/couch_peruser_test.erl:250: Warning: a term is constructed, but never used\r\n/home/travis/build/apache/couchdb/src/couch_peruser/test/couch_peruser_test.erl:251: Warning: a term is constructed, but never used\r\n/home/travis/build/apache/couchdb/src/couch_peruser/test/couch_peruser_test.erl:274: Warning: a term is constructed, but never used\r\n/home/travis/build/apache/couchdb/src/couch_peruser/test/couch_peruser_test.erl:275: Warning: a term is constructed, but never used\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315626164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315626388","html_url":"https://github.com/apache/couchdb/pull/676#issuecomment-315626388","issue_url":"https://api.github.com/repos/apache/couchdb/issues/676","id":315626388,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYyNjM4OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T18:09:45Z","updated_at":"2017-07-16T18:09:45Z","author_association":"MEMBER","body":"Sadly we have a new failure scenario now. I'm going to reopen #634.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315626388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315626438","html_url":"https://github.com/apache/couchdb/issues/634#issuecomment-315626438","issue_url":"https://api.github.com/repos/apache/couchdb/issues/634","id":315626438,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYyNjQzOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T18:10:35Z","updated_at":"2017-07-16T18:11:12Z","author_association":"MEMBER","body":"* https://travis-ci.org/apache/couchdb/jobs/254181139\r\n  * https://couchdb-vm2.apache.org/ci_errorlogs/travis-couchdb-254181139-2017-07-16T16%3A59%3A18.328468/couchlog.tar.gz\r\n\r\nThis is recurring now with a new pattern:\r\n\r\n```\r\ntest/javascript/tests/replication.js                           \r\n    Error: expected 'null', got '{\"node\":\"node1@127.0.0.1\",\"pid\":\"<0.15982.3>\",\"changes_pending\":null,\"checkpoint_interval\":30000,\"checkpointed_source_seq\":\"5-g1AAAAIreJyV0FEOgiAYB3DStuqpI9QJGhACPuVNCj5k5syeeq6b1E3qJnUTQ20z59x0bB8b8P9tfzKE0DzxDVrmZxOTiFCxwW6RzF14CulVURRp4qvJyR3MpBIWrOg-7yX02k29-ymoUgyEICU2aHHJTWyPeWz681GZ37fyinKmYz0sfyjz11YLQeg2tHhEi3zqJrq5zUH3UvIqCTBREsZLj1p6Np14yDhAOKhTbbxq490YwK0IGB1hfGrj72-4CZgMeDeVfgEwG44l\",\"continuous\":true,\"database\":null,\"doc_id\":null,\"doc_write_failures\":0,\"docs_read\":5,\"docs_written\":5,\"missing_revisions_found\":5,\"replication_id\":\"eba478c2726f3ea25666281b778ecb61+continuous+create_target\",\"revisions_checked\":5,\"source\":\"http://127.0.0.1:15984/test_suite_db_wcqbgffz_src/\",\"source_seq\":\"5-g1AAAAIreJyV0FEOgiAYB3DStuqpI9QJGhACPuVNCj5k5syeeq6b1E3qJnUTQ20z59x0bB8b8P9tfzKE0DzxDVrmZxOTiFCxwW6RzF14CulVURRp4qvJyR3MpBIWrOg-7yX02k29-ymoUgyEICU2aHHJTWyPeWz681GZ37fyinKmYz0sfyjz11YLQeg2tHhEi3zqJrq5zUH3UvIqCTBREsZLj1p6Np14yDhAOKhTbbxq490YwK0IGB1hfGrj72-4CZgMeDeVfgEwG44l\",\"started_on\":1500224357,\"target\":\"http://127.0.0.1:15984/test_suite_db_hdnlnlig_tgt/\",\"through_seq\":\"5-g1AAAAIreJyV0FEOgiAYB3DStuqpI9QJGhACPuVNCj5k5syeeq6b1E3qJnUTQ20z59x0bB8b8P9tfzKE0DzxDVrmZxOTiFCxwW6RzF14CulVURRp4qvJyR3MpBIWrOg-7yX02k29-ymoUgyEICU2aHHJTWyPeWz681GZ37fyinKmYz0sfyjz11YLQeg2tHhEi3zqJrq5zUH3UvIqCTBREsZLj1p6Np14yDhAOKhTbbxq490YwK0IGB1hfGrj72-4CZgMeDeVfgEwG44l\",\"type\":\"replication\",\"updated_on\":1500224357,\"user\":null}'\r\nTrace back (most recent call first):\r\n \\\"<0.15982.3>\\\",\\\"changes_pending\\\":null,\\\"checkpoint_interval\\\":30000,\\\"checkpointed_source_seq\\\":\\\"5-g1AAAAIreJyV0FEOgiAYB3DStuqpI9QJGhACPuVNCj5k5syeeq6b1E3qJnUTQ20z59x0bB8b8P9tfzKE0DzxDVrmZxOTiFCxwW6RzF14CulVURRp4qvJyR3MpBIWrOg-7yX02k29-ymoUgyEICU2aHHJTWyPeWz681GZ37fyinKmYz0sfyjz11YLQeg2tHhEi3zqJrq5zUH3UvIqCTBREsZLj1p6Np14yDhAOKhTbbxq490YwK0IGB1hfGrj72-4CZgMeDeVfgEwG44l\\\",\\\"continuous\\\":true,\\\"database\\\":null,\\\"doc_id\\\":null,\\\"doc_write_failures\\\":0,\\\"docs_read\\\":5,\\\"docs_written\\\":5,\\\"missing_revisions_found\\\":5,\\\"replication_id\\\":\\\"eba478c2726f3ea25666281b778ecb61+continuous+create_target\\\",\\\"revisions_checked\\\":5,\\\"source\\\":\\\"http://127.0.0.1:15984/test_suite_db_wcqbgffz_src/\\\",\\\"source_seq\\\":\\\"5-g1AAAAIreJyV0FEOgiAYB3DStuqpI9QJGhACPuVNCj5k5syeeq6b1E3qJnUTQ20z59x0bB8b8P9tfzKE0DzxDVrmZxOTiFCxwW6RzF14CulVURRp4qvJyR3MpBIWrOg-7yX02k29-ymoUgyEICU2aHHJTWyPeWz681GZ37fyinKmYz0sfyjz11YLQeg2tHhEi3zqJrq5zUH3UvIqCTBREsZLj1p6Np14yDhAOKhTbbxq490YwK0IGB1hfGrj72-4CZgMeDeVfgEwG44l\\\",\\\"started_on\\\":1500224357,\\\"target\\\":\\\"http://127.0.0.1:15984/test_suite_db_hdnlnlig_tgt/\\\",\\\"through_seq\\\":\\\"5-g1AAAAIreJyV0FEOgiAYB3DStuqpI9QJGhACPuVNCj5k5syeeq6b1E3qJnUTQ20z59x0bB8b8P9tfzKE0DzxDVrmZxOTiFCxwW6RzF14CulVURRp4qvJyR3MpBIWrOg-7yX02k29-ymoUgyEICU2aHHJTWyPeWz681GZ37fyinKmYz0sfyjz11YLQeg2tHhEi3zqJrq5zUH3UvIqCTBREsZLj1p6Np14yDhAOKhTbbxq490YwK0IGB1hfGrj72-4CZgMeDeVfgEwG44l\\\",\\\"type\\\":\\\"replication\\\",\\\"updated_on\\\":1500224357,\\\"user\\\":null}'\",\"Replication was canceled\")@test/javascript/test_setup.js:52: 127.0.0.1\\\",\\\"pid\\\"\r\n      T(false,\"expected 'null', got '{\\\"node\\\":\\\"node1\r\n 321: test/javascript/couch_test_runner.js\r\n      TEquals(null,[object Object],\"Replication was canceled\")\r\n 1846: test/javascript/tests/replication.js\r\n      ()\r\n  37: test/javascript/cli_runner.js\r\n      runTest()\r\n  48: test/javascript/cli_runner.js\r\nfail\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315626438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315638813","html_url":"https://github.com/apache/couchdb/pull/570#issuecomment-315638813","issue_url":"https://api.github.com/repos/apache/couchdb/issues/570","id":315638813,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTYzODgxMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-16T21:33:46Z","updated_at":"2017-07-16T21:33:46Z","author_association":"MEMBER","body":"Never mind, we have a bunch of these in the test code, mostly on these `?_assert()` lines where I think it's a spurious error. I believe these can be ignored safely.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315638813/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315677278","html_url":"https://github.com/apache/couchdb/issues/593#issuecomment-315677278","issue_url":"https://api.github.com/repos/apache/couchdb/issues/593","id":315677278,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTY3NzI3OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T06:36:13Z","updated_at":"2017-07-17T06:36:36Z","author_association":"MEMBER","body":"PR up. I had missed that the latest version of the couchdb-setup application now requires a `node_count` parameter, so I added that to Fauxton at the same time for the clustered setup option.\r\n\r\nOnce the PR lands, and Fauxton is tagged, _and_ I bump `rebar.config.script`, I'll update the documentation for the updated `/_cluster_setup` endpoint and initial cluster setup in a final PR. Then we can close this out!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315677278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315738675","html_url":"https://github.com/apache/couchdb/pull/389#issuecomment-315738675","issue_url":"https://api.github.com/repos/apache/couchdb/issues/389","id":315738675,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTczODY3NQ==","user":{"login":"jlami","id":8522993,"node_id":"MDQ6VXNlcjg1MjI5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/8522993?v=4","gravatar_id":"","url":"https://api.github.com/users/jlami","html_url":"https://github.com/jlami","followers_url":"https://api.github.com/users/jlami/followers","following_url":"https://api.github.com/users/jlami/following{/other_user}","gists_url":"https://api.github.com/users/jlami/gists{/gist_id}","starred_url":"https://api.github.com/users/jlami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jlami/subscriptions","organizations_url":"https://api.github.com/users/jlami/orgs","repos_url":"https://api.github.com/users/jlami/repos","events_url":"https://api.github.com/users/jlami/events{/privacy}","received_events_url":"https://api.github.com/users/jlami/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T12:13:17Z","updated_at":"2017-07-17T12:13:17Z","author_association":"NONE","body":"Any progress on this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315738675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315784267","html_url":"https://github.com/apache/couchdb/pull/628#issuecomment-315784267","issue_url":"https://api.github.com/repos/apache/couchdb/issues/628","id":315784267,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTc4NDI2Nw==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T15:10:35Z","updated_at":"2017-07-17T15:10:35Z","author_association":"CONTRIBUTOR","body":"@garrensmith @janl I like the addition of stale! We'll need to add in support for text indexes for stale as well. This way we are at least trying to be consistent across index options. We may also some logic if the user specifies stable or update for text indexes (which doesn't support that option, but we may already just ignore invalid options). We could move those changes into another PR if this a pressing option we want. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315784267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315804338","html_url":"https://github.com/apache/couchdb/pull/628#issuecomment-315804338","issue_url":"https://api.github.com/repos/apache/couchdb/issues/628","id":315804338,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTgwNDMzOA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T16:22:56Z","updated_at":"2017-07-17T16:22:56Z","author_association":"MEMBER","body":"+1\r\n\r\n@tonysun83 I'd make any changes to the text indexes as new work. I checked and mango_cursor_text will ignore any unknown options so there's no breakage there.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315804338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315812128","html_url":"https://github.com/apache/couchdb/pull/526#issuecomment-315812128","issue_url":"https://api.github.com/repos/apache/couchdb/issues/526","id":315812128,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTgxMjEyOA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T16:50:31Z","updated_at":"2017-07-17T16:50:31Z","author_association":"MEMBER","body":"+1\r\n\r\nSquerge away!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315812128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315816869","html_url":"https://github.com/apache/couchdb/pull/477#issuecomment-315816869","issue_url":"https://api.github.com/repos/apache/couchdb/issues/477","id":315816869,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTgxNjg2OQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T17:06:07Z","updated_at":"2017-07-17T17:06:07Z","author_association":"MEMBER","body":"Re-reading this I guess I must have written down my concerns somewhere else and never got them on to this PR. My biggest concern with this change is a lack of profiling of what sort of bottleneck the new LRU might be. Given that its modeled off couch_server, and on a number of deployments we have more views than databases it seems like this is a prime candidate for another run away queue process.\r\n\r\nIf we do want to pursue this I'd really want to see some serious benchmarking that shows its not just creating a second couch_server issue for us.\r\n\r\nAlso, the original impetuous for this was to work on closing out views since its possible that large production environments can have some high memory usage requirements for all views to be open at once. An alternative approach that doesn't use an LRU would be to close idle views like we've added for databases and os processes. The recent PR for couch_db_updaters is here:\r\n\r\nhttps://github.com/apache/couchdb/commit/ba0c10bcf49be66b042d8f0deaf14bcfda1a49bf","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315816869/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315817593","html_url":"https://github.com/apache/couchdb/pull/622#issuecomment-315817593","issue_url":"https://api.github.com/repos/apache/couchdb/issues/622","id":315817593,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTgxNzU5Mw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T17:08:38Z","updated_at":"2017-07-17T17:08:38Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315817593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315830350","html_url":"https://github.com/apache/couchdb/pull/628#issuecomment-315830350","issue_url":"https://api.github.com/repos/apache/couchdb/issues/628","id":315830350,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTgzMDM1MA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T17:52:48Z","updated_at":"2017-07-17T17:52:48Z","author_association":"CONTRIBUTOR","body":"Sounds good. +1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315830350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315835053","html_url":"https://github.com/apache/couchdb/pull/628#issuecomment-315835053","issue_url":"https://api.github.com/repos/apache/couchdb/issues/628","id":315835053,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTgzNTA1Mw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T18:08:58Z","updated_at":"2017-07-17T18:08:58Z","author_association":"CONTRIBUTOR","body":"Merging it in on Garren's behalf since he is on vacation at the moment. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315835053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315840232","html_url":"https://github.com/apache/couchdb/pull/526#issuecomment-315840232","issue_url":"https://api.github.com/repos/apache/couchdb/issues/526","id":315840232,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTg0MDIzMg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T18:26:49Z","updated_at":"2017-07-17T18:26:49Z","author_association":"CONTRIBUTOR","body":"Squerged.\r\n\r\nBut also see a badarith exception when testing _local_docs endpoint by hand:\r\n\r\ndid a few:\r\n```\r\nhttp  post 'http://adm:pass@localhost:15984/d' x=1 _id=_local/1\r\n{\r\n    \"id\": \"_local/1\",\r\n    \"ok\": true,\r\n    \"rev\": \"0-1\"\r\n}\r\n```\r\n\r\nThen see the exception with:\r\n\r\n```\r\nhttp get 'http://adm:pass@localhost:15984/d/_local_docs'\r\nHTTP/1.1 500 Internal Server Error\r\n{\r\n    \"error\": \"unknown_error\",\r\n    \"reason\": \"badarith\",\r\n    \"ref\": 2604624769\r\n}\r\n```\r\n\r\nLogs show:\r\n```\r\n2017-07-17T18:25:22.809235Z node1@127.0.0.1 <0.12977.0> e7fdbd92ef req_err(2604624769) unknown_error : badarith\r\n    [<<\"fabric_view_all_docs:handle_message/3 L157\">>,<<\"rexi_utils:process_mailbox/6 L55\">>,<<\"fabric_view_all_docs:go/6 L123\">>,<<\"fabric_view_all_docs:go/5 L32\">>,<<\"chttpd_db:all_docs_view/4 L644\">>,<<\"chttpd:process_request/1 L295\">>,<<\"chttpd:handle_request_int/1 L231\">>,<<\"mochiweb_http:headers/6 L122\">>]\r\n```\r\n\r\nWill have to track this down","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315840232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315841170","html_url":"https://github.com/apache/couchdb/pull/567#issuecomment-315841170","issue_url":"https://api.github.com/repos/apache/couchdb/issues/567","id":315841170,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTg0MTE3MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T18:30:06Z","updated_at":"2017-07-17T18:30:06Z","author_association":"MEMBER","body":"+1\r\n\r\nLook fine to me. Though you'll want to update rebar.config.script after you merge this. As to the conflicts notice it sure would be nice to know what GitHub thinks is in conflict. Assuming it applies cleanly locally I'd just do that and call it good. It could even be that GitHub thinks its a conflict precisely because they have separate roots.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315841170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315842100","html_url":"https://github.com/apache/couchdb/pull/526#issuecomment-315842100","issue_url":"https://api.github.com/repos/apache/couchdb/issues/526","id":315842100,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTg0MjEwMA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T18:33:26Z","updated_at":"2017-07-17T18:33:26Z","author_association":"MEMBER","body":"Huh. guessing that's in the totals or offset handling.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315842100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315847467","html_url":"https://github.com/apache/couchdb/issues/680#issuecomment-315847467","issue_url":"https://api.github.com/repos/apache/couchdb/issues/680","id":315847467,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTg0NzQ2Nw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T18:53:13Z","updated_at":"2017-07-17T18:53:13Z","author_association":"MEMBER","body":"Blargh. I'm pretty sure the flaky here is from trying to get a database to close by filling the LRU. Rather than do that I'm just gonna add a wait for the index update to finish and then kill the database forcefully. PR incoming.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315847467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315848742","html_url":"https://github.com/apache/couchdb/pull/526#issuecomment-315848742","issue_url":"https://api.github.com/repos/apache/couchdb/issues/526","id":315848742,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTg0ODc0Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T18:57:45Z","updated_at":"2017-07-17T18:57:45Z","author_association":"CONTRIBUTOR","body":"It looks like in fabic rpc view_cb/2 meta comes back with `total=null, offset=null` but sometimes as `total=null, offset=0`. Since offset=0 is a number we attempt to add to null in in the handle_message callback when we aggregate numbers: https://github.com/apache/couchdb/pull/526/files#diff-9d6b535641fc74e993a6c0a246313619R157 (there Offset0 is a number).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315848742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315867055","html_url":"https://github.com/apache/couchdb/pull/567#issuecomment-315867055","issue_url":"https://api.github.com/repos/apache/couchdb/issues/567","id":315867055,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTg2NzA1NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T20:05:14Z","updated_at":"2017-07-17T20:05:14Z","author_association":"MEMBER","body":"@janl A reminder this needs to be updated for the latest changes to couchdb-setup that I just pushed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315867055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315869148","html_url":"https://github.com/apache/couchdb/issues/634#issuecomment-315869148","issue_url":"https://api.github.com/repos/apache/couchdb/issues/634","id":315869148,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTg2OTE0OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-07-17T20:13:31Z","updated_at":"2017-07-17T20:13:31Z","author_association":"MEMBER","body":"Happened again on Travis:\r\n\r\n* https://travis-ci.org/apache/couchdb/jobs/254582426\r\n  * https://couchdb-vm2.apache.org/ci_errorlogs/travis-couchdb-254582426-2017-07-17T20%3A01%3A40.764804/couchlog.tar.gz","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/315869148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]