[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/834273003","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-834273003","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":834273003,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDI3MzAwMw==","user":{"login":"Viv1986","id":25159403,"node_id":"MDQ6VXNlcjI1MTU5NDAz","avatar_url":"https://avatars.githubusercontent.com/u/25159403?v=4","gravatar_id":"","url":"https://api.github.com/users/Viv1986","html_url":"https://github.com/Viv1986","followers_url":"https://api.github.com/users/Viv1986/followers","following_url":"https://api.github.com/users/Viv1986/following{/other_user}","gists_url":"https://api.github.com/users/Viv1986/gists{/gist_id}","starred_url":"https://api.github.com/users/Viv1986/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Viv1986/subscriptions","organizations_url":"https://api.github.com/users/Viv1986/orgs","repos_url":"https://api.github.com/users/Viv1986/repos","events_url":"https://api.github.com/users/Viv1986/events{/privacy}","received_events_url":"https://api.github.com/users/Viv1986/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T11:05:45Z","updated_at":"2021-05-07T11:33:12Z","author_association":"NONE","body":"@ctubbsii didn't found any errors in hdfs, everything recover ok, problem that I can't reboot cluster or table, it's all time become unavailable while all tables witll be reassgined\r\nhdfs fsck /\r\nStatus: HEALTHY\r\n Number of data-nodes:  2\r\n Number of racks:               1\r\n Total dirs:                    8560\r\n Total symlinks:                0\r\n\r\nReplicated Blocks:\r\n Total size:    136475049809 B (Total open files size: 372 B)\r\n Total files:   8701 (Files currently being written: 8)\r\n Total blocks (validated):      9240 (avg. block size 14770027 B) (Total open file blocks (not validated): 6)\r\n Minimally replicated blocks:   9240 (100.0 %)\r\n Over-replicated blocks:        0 (0.0 %)\r\n Under-replicated blocks:       9240 (100.0 %)\r\n Mis-replicated blocks:         0 (0.0 %)\r\n Default replication factor:    3\r\n Average block replication:     2.0\r\n Missing blocks:                0\r\n Corrupt blocks:                0\r\n Missing replicas:              9746 (34.52845 %)\r\n\r\nErasure Coded Block Groups:\r\n Total size:    0 B\r\n Total files:   0\r\n Total block groups (validated):        0\r\n Minimally erasure-coded block groups:  0\r\n Over-erasure-coded block groups:       0\r\n Under-erasure-coded block groups:      0\r\n Unsatisfactory placement block groups: 0\r\n Average block group size:      0.0\r\n Missing block groups:          0\r\n Corrupt block groups:          0\r\n Missing internal blocks:       0\r\nFSCK ended at Fri May 07 11:16:08 UTC 2021 in 590 milliseconds\r\n\r\nif I reboot only one table I get\r\nSome tablets were unloaded in an unsafe manner. Write-ahead logs are being recovered.\r\nand procedure of recovering same root table begins, after tables reassign","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/834273003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/834580352","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-834580352","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":834580352,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDU4MDM1Mg==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T16:10:59Z","updated_at":"2021-05-07T16:10:59Z","author_association":"CONTRIBUTOR","body":"Do you have a lot of data in the write-ahead logs?  Is your ingest streaming or do you do mostly bulk ingest?\r\n\r\nIf you do not have a lot of data in the WAL, and IF you can determine that the tables rfiles are intact and accessible, you could try a few things - but these will likely lead to some data loss - especially for anything in the WALS.\r\n\r\nDoes the directory from your error message exist, does it have any files in it?\r\n\r\n`hdfs://xxxxxxxx120.xxxxxxxx-dev.local:8020/apps/accumulo/data/wal/xxxxxxxxxx.xxxxxxxxx-dev.local+9997/e31761f2-e600-49f9-9a5c-8972aa37005b`\r\n\r\nI am assuming that because this is the root table, you cannot scan anything with the accumulo shell to examine the metadata table.\r\n\r\nThere some information in the [user manual](https://accumulo.apache.org/1.10/accumulo_user_manual.html#_troubleshooting) on what needs to be done if the root (or metadata) table(s) have a reference to a corrupt wal - basically, shut down accumulo, move the tables rfiles, reinitialize accumlo and the bulk import the files that you moved. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/834580352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/834673129","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-834673129","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":834673129,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDY3MzEyOQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T18:23:35Z","updated_at":"2021-05-07T18:23:35Z","author_association":"MEMBER","body":"Before you do any recovery, I would examine the logs for any references to the missing file, to see if you can determine what might have happened to it. If HDFS is healthy and has no corrupt or missing data, I'm very curious how the file could have gone missing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/834673129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/836073388","html_url":"https://github.com/apache/accumulo/pull/2073#issuecomment-836073388","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2073","id":836073388,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjA3MzM4OA==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T02:18:00Z","updated_at":"2021-05-10T02:18:00Z","author_association":"CONTRIBUTOR","body":"Replaced with https://github.com/apache/accumulo/pull/2087","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/836073388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/836627390","html_url":"https://github.com/apache/accumulo/issues/2082#issuecomment-836627390","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2082","id":836627390,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjYyNzM5MA==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T12:18:43Z","updated_at":"2021-05-10T12:18:43Z","author_association":"CONTRIBUTOR","body":"was this addressed in b9ddb33c5920663990885bae5a17b90f0976315f?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/836627390/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/836951456","html_url":"https://github.com/apache/accumulo/issues/2091#issuecomment-836951456","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2091","id":836951456,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjk1MTQ1Ng==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T16:47:25Z","updated_at":"2021-05-10T16:47:25Z","author_association":"CONTRIBUTOR","body":"What I have noticed so far is that the history file isn't properly created inside the IT. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/836951456/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/837002418","html_url":"https://github.com/apache/accumulo/issues/2092#issuecomment-837002418","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2092","id":837002418,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzAwMjQxOA==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T17:23:57Z","updated_at":"2021-05-10T17:23:57Z","author_association":"CONTRIBUTOR","body":"The zookeeper status has been removed from the monitor, starting with 2.1 (when that is released)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/837002418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/837289892","html_url":"https://github.com/apache/accumulo/issues/2092#issuecomment-837289892","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2092","id":837289892,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzI4OTg5Mg==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T20:30:05Z","updated_at":"2021-05-10T20:30:05Z","author_association":"MEMBER","body":"@EdColeman It looks like the view was removed from the monitor, but the background thread that does the 4lw operation still tries to run. See the ZooKeeperStatus class and its background thread in the Monitor class. These should probably be removed to complete the work began in #2020 \r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/837289892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838334533","html_url":"https://github.com/apache/accumulo/issues/2091#issuecomment-838334533","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2091","id":838334533,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODMzNDUzMw==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T11:49:12Z","updated_at":"2021-05-11T16:04:23Z","author_association":"CONTRIBUTOR","body":"Correction, the history file isn't properly created for the `history` test. For some reason, tests that use an input, i.e. `ts.input.set(\"name1\")`, will show up in the history file (the string inside the parentheses that is). This does not work for the `history` test though. It appears the input has to be used from a command in order to actually show up in the history file.\r\n\r\nIt does seem that the exec commands do not properly show up in the history file as expected so the IT does not correctly simulate shell functionality that way.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838334533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838399768","html_url":"https://github.com/apache/accumulo/issues/2094#issuecomment-838399768","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2094","id":838399768,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODM5OTc2OA==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T12:37:01Z","updated_at":"2021-05-11T12:43:29Z","author_association":"CONTRIBUTOR","body":"@keith-turner removed priority from TExternalCompactionJob in 837ae7edc885cce0b35d3e2ba8a0c3e246914545. Priority is still being sent from the TServer to the Coordinator in ExternalCompactionExecutor.summarize().","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838399768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838412164","html_url":"https://github.com/apache/accumulo/issues/2094#issuecomment-838412164","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2094","id":838412164,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODQxMjE2NA==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T12:46:35Z","updated_at":"2021-05-11T12:46:35Z","author_association":"CONTRIBUTOR","body":"@keith-turner - I think we can remove this from the External Compactions project.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838412164/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838503828","html_url":"https://github.com/apache/accumulo/issues/2089#issuecomment-838503828","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2089","id":838503828,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODUwMzgyOA==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T13:46:15Z","updated_at":"2021-05-11T13:46:15Z","author_association":"CONTRIBUTOR","body":"I created a new branch with the documentation changes and put up a new PR from that branch - https://github.com/apache/accumulo-website/pull/282. I closed the old PR and I still have the changes locally in case we want to resurrect the design doc.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838503828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838804779","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-838804779","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":838804779,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODgwNDc3OQ==","user":{"login":"Viv1986","id":25159403,"node_id":"MDQ6VXNlcjI1MTU5NDAz","avatar_url":"https://avatars.githubusercontent.com/u/25159403?v=4","gravatar_id":"","url":"https://api.github.com/users/Viv1986","html_url":"https://github.com/Viv1986","followers_url":"https://api.github.com/users/Viv1986/followers","following_url":"https://api.github.com/users/Viv1986/following{/other_user}","gists_url":"https://api.github.com/users/Viv1986/gists{/gist_id}","starred_url":"https://api.github.com/users/Viv1986/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Viv1986/subscriptions","organizations_url":"https://api.github.com/users/Viv1986/orgs","repos_url":"https://api.github.com/users/Viv1986/repos","events_url":"https://api.github.com/users/Viv1986/events{/privacy}","received_events_url":"https://api.github.com/users/Viv1986/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T16:40:46Z","updated_at":"2021-05-11T16:40:46Z","author_association":"NONE","body":"@ctubbsii I examine all logs and found nothing, also by hdfs dfs -ls I able to find that wal file and it have some size, so, any other suggestions except reinitialization? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838804779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838834803","html_url":"https://github.com/apache/accumulo/issues/2076#issuecomment-838834803","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2076","id":838834803,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODgzNDgwMw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T17:02:27Z","updated_at":"2021-05-11T17:02:27Z","author_association":"CONTRIBUTOR","body":"The first hurdle is changing `SortedLogRecovery` to use RFile instead of MapFile. That will probably be one pull request. Once that is done, then we will be able to use them for encryption.\r\n\r\n@ctubbsii my initial work translating the WAL event data to RFiles implements a schema that stores `LogEvents` in the column family. I think this will allow using locality groups based on the different values of the enum. See https://github.com/apache/accumulo/blob/3fd5cad92f9b63ac19e4466f3f2d5237b905262c/server/tserver/src/main/java/org/apache/accumulo/tserver/logger/LogEvents.java","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838834803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838854440","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-838854440","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":838854440,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODg1NDQ0MA==","user":{"login":"Viv1986","id":25159403,"node_id":"MDQ6VXNlcjI1MTU5NDAz","avatar_url":"https://avatars.githubusercontent.com/u/25159403?v=4","gravatar_id":"","url":"https://api.github.com/users/Viv1986","html_url":"https://github.com/Viv1986","followers_url":"https://api.github.com/users/Viv1986/followers","following_url":"https://api.github.com/users/Viv1986/following{/other_user}","gists_url":"https://api.github.com/users/Viv1986/gists{/gist_id}","starred_url":"https://api.github.com/users/Viv1986/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Viv1986/subscriptions","organizations_url":"https://api.github.com/users/Viv1986/orgs","repos_url":"https://api.github.com/users/Viv1986/repos","events_url":"https://api.github.com/users/Viv1986/events{/privacy}","received_events_url":"https://api.github.com/users/Viv1986/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T17:17:07Z","updated_at":"2021-05-11T17:17:07Z","author_association":"NONE","body":"and found that thouse wal files accumulo deleted after tables reassign, but storage have some old files which stores for months and even year","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838854440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838875258","html_url":"https://github.com/apache/accumulo/issues/2094#issuecomment-838875258","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2094","id":838875258,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODg3NTI1OA==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T17:30:21Z","updated_at":"2021-05-11T17:30:21Z","author_association":"CONTRIBUTOR","body":"I moved it out of the the external compaction project to a 2.1.0 blocker because I think it can be done after external compactions are merged, but should be done before a 2.1.0 release as it would change SPIs that are new in 2.1.0","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838875258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838926397","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-838926397","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":838926397,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODkyNjM5Nw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T18:05:43Z","updated_at":"2021-05-11T18:05:43Z","author_association":"MEMBER","body":"Having a WAL file that isn't empty is normal for a running system, so I wouldn't be concerned about that. As for the orphaned files that have been around for months, that can happen if there's a failure after the accumulo-gc removes a deleted file entry from the metadata table, but before it actually deletes it in HDFS. This is a \"fail safe\" order of operations, but can result in orphaned files. It doesn't tell you much other than the fact that there was a failure in the past, though. At this point, I'm not sure if I have any other suggestions. You could try having a discussion on the [user mailing list](https://accumulo.apache.org/contact-us/) to get ideas from the wider Accumulo community than just those developers following the issue tracker.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838926397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838954809","html_url":"https://github.com/apache/accumulo/issues/1955#issuecomment-838954809","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1955","id":838954809,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODk1NDgwOQ==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T18:25:20Z","updated_at":"2021-05-11T18:25:20Z","author_association":"CONTRIBUTOR","body":"Looked some more at this and was not able to reproduce the the watcher invocation issue.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/838954809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839185577","html_url":"https://github.com/apache/accumulo/issues/2092#issuecomment-839185577","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2092","id":839185577,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTE4NTU3Nw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T21:25:40Z","updated_at":"2021-05-11T21:25:40Z","author_association":"MEMBER","body":"This is OBE by #2020 and #2095, which removed the ZK status thread, REST endpoint, and web view.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839185577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839214041","html_url":"https://github.com/apache/accumulo/issues/2076#issuecomment-839214041","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2076","id":839214041,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTIxNDA0MQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T22:02:37Z","updated_at":"2021-05-11T22:02:37Z","author_association":"MEMBER","body":"I was thinking locality groups could be used to efficiently segregate information from different tablets. So, to recover a single tablet, you don't need to scan through any of the other tablets' data. Using locality groups for the log event types is a more traditional way of using locality groups where the locality group is configured in the Accumulo configuration properties. However, we don't really have a use case to only read a single event type at a time... we do have a use case to read all event types for a single tablet at a time. At least, I think that would be useful.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839214041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839628189","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-839628189","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":839628189,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTYyODE4OQ==","user":{"login":"Viv1986","id":25159403,"node_id":"MDQ6VXNlcjI1MTU5NDAz","avatar_url":"https://avatars.githubusercontent.com/u/25159403?v=4","gravatar_id":"","url":"https://api.github.com/users/Viv1986","html_url":"https://github.com/Viv1986","followers_url":"https://api.github.com/users/Viv1986/followers","following_url":"https://api.github.com/users/Viv1986/following{/other_user}","gists_url":"https://api.github.com/users/Viv1986/gists{/gist_id}","starred_url":"https://api.github.com/users/Viv1986/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Viv1986/subscriptions","organizations_url":"https://api.github.com/users/Viv1986/orgs","repos_url":"https://api.github.com/users/Viv1986/repos","events_url":"https://api.github.com/users/Viv1986/events{/privacy}","received_events_url":"https://api.github.com/users/Viv1986/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T09:36:37Z","updated_at":"2021-05-12T09:36:37Z","author_association":"NONE","body":"ok my last tests show me that all clusters have that problem, and it's not related to error which described in my first message, I use ambari and it's restart tables and master with kill -9, and seems it's ok with reassign tables with such restart.\r\nI have another cluster with same config, but with heapsize = 1.5G, and 40.75B records, and reassign there take near 15 minutes, and same cluster with 40G java heapsize and 52.71B records, reassign will take near 4 hours, what related to table reassign speed? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839628189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839669677","html_url":"https://github.com/apache/accumulo/issues/2076#issuecomment-839669677","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2076","id":839669677,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTY2OTY3Nw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T10:42:38Z","updated_at":"2021-05-12T10:42:38Z","author_association":"CONTRIBUTOR","body":"I can see where that would speed up recovery. I haven't done much with locality groups so not sure how that would work with the sorting of the log events. I was going with a schema that preserves the current way the WAL events sort, by Event + tabletId + sequence number:\r\n<pre>\r\n        Row = EventTypeInteger_tabletID_seq\r\n        Family = event\r\n        Qualifier = tserverSession OR filename OR KeyExtent\r\n</pre>\r\nI created the Event type integer based on what is returned by the compareTo() of `LogFileKey`. Then appended the tabletId integer (which is written from `commitSession.getLogId()`) and finally the sequence number. The event type determines what will be stored in the column qualifier.\r\nhttps://github.com/apache/accumulo/blob/583ca55ceb5402d6bbd0fb093feccc897234582f/server/tserver/src/main/java/org/apache/accumulo/tserver/logger/LogFileKey.java#L155-L164\r\n\r\nI was using `scanner.fetchColumnFamily(cf);` where the cf could be 0 or many `Text... colFamToFetch` and passing in the different events to fetch. Maybe I can put up a draft PR of just the LogFileKey.toKey() method so you can provide some feedback. There are already a good number of changes but its mostly changing all the iterators to work with Key/Value.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839669677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839708372","html_url":"https://github.com/apache/accumulo/issues/2076#issuecomment-839708372","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2076","id":839708372,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTcwODM3Mg==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T11:50:44Z","updated_at":"2021-05-12T11:50:44Z","author_association":"CONTRIBUTOR","body":"If I gave each enum in `LogEvents` a unique number for sorting, then I wouldn't have to store the string in the column family. The new numbering could look like this:\r\n<pre>\r\n    // OPEN = 0\r\n    // DEFINE_TABLET = 1\r\n    // COMPACTION_START = 2\r\n    // COMPACTION_FINISH = 3\r\n    // MUTATION = 4\r\n    // MANY_MUTATIONS = 5\r\n</pre>\r\n\r\nIt would be extra convenient if the `ordinal()` of the enum corresponded to these numbers but currently that is not the case. The sorted WALs between previous versions and this one will already be incompatible so it may not be a big deal to change the order of the `LogEvents` enum. But I wonder if it could lead to some crazy bugs if a user were to recover an old WAL.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839708372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839753763","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-839753763","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":839753763,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTc1Mzc2Mw==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T13:01:56Z","updated_at":"2021-05-12T13:01:56Z","author_association":"CONTRIBUTOR","body":"When you do a restart, do you start the tservers and THEN the master(s) - if you start the master first, it will see assign everything to the first tserver(s) that it sees, resulting in an unbalanced cluster that takes a while for everything to be processed and then rebalanced because only one (or a few) tservers are processing everything.  There is a property to have the master wait for a required number of tservers that was  added in 1.10.  It is best if the tservers are all up and then the master starts - taht way all tservers are available for assignments.\r\n\r\nOther factors could be if the tables are performing batch writes (vs bulk import) - that will generate WAL files that need to be processed during recovery.\r\nDo you every compact the tables - that will reduce the number of files as well as process any info in the WAL so that there is less work that needs to be performed during recovery.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839753763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839782784","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-839782784","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":839782784,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTc4Mjc4NA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T13:42:19Z","updated_at":"2021-05-12T13:42:19Z","author_association":"CONTRIBUTOR","body":"FYI I plan on taking a look at these changes some time this week. Instead of just looking at ALL the changes in the diff, my strategy is to checkout the branch, run some stuff using Uno and then take a look at some of the important files.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839782784/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839800544","html_url":"https://github.com/apache/accumulo/issues/2076#issuecomment-839800544","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2076","id":839800544,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTgwMDU0NA==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T14:05:10Z","updated_at":"2021-05-12T14:06:12Z","author_association":"CONTRIBUTOR","body":"> I was thinking locality groups could be used to efficiently segregate information from different tablets. So, to recover a single tablet, you don't need to scan through any of the other tablets' data.\r\n\r\nI think the sorted WALs are structured such that needed information sorts together and can be efficiently found via seek.  I have not looked at the code in a while, but I am not sure sorted WALs are ever scanned entirely.  I think they may only be seeked to specific places.  If this is true then there may not be a benefit to LGs. I think the sort segregates information as needed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839800544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839808426","html_url":"https://github.com/apache/accumulo/issues/2076#issuecomment-839808426","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2076","id":839808426,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTgwODQyNg==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T14:15:27Z","updated_at":"2021-05-12T14:15:27Z","author_association":"CONTRIBUTOR","body":"> But I wonder if it could lead to some crazy bugs if a user were to recover an old WAL.\r\n\r\nWould need to maintain code to recover old WALs, or refuse to upgrade if WALs are present forcing user to run old version and resolve WALs.  Refusing to upgrade could be annoying for the user as its difficult to know if there are WALs. They could end up in a loop trying to run new version and having to fall back to old version.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839808426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839876053","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-839876053","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":839876053,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTg3NjA1Mw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T15:41:05Z","updated_at":"2021-05-12T15:41:05Z","author_association":"CONTRIBUTOR","body":"@dlmarion it would help a lot for developers reviewing to split this PR up into 2 commits: 1 with your changes and the other with the generated thrift files. This is something we have done in the past with big PRs that have thrift changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839876053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839877773","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-839877773","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":839877773,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTg3Nzc3Mw==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T15:43:26Z","updated_at":"2021-05-12T15:43:26Z","author_association":"CONTRIBUTOR","body":"@milleruntime - what's the best way to approach that? Create a branch off of this branch, remove the thrift files from this branch and remove the non-thrift files from the other?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839877773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839883544","html_url":"https://github.com/apache/accumulo/pull/2098#issuecomment-839883544","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2098","id":839883544,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTg4MzU0NA==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T15:51:17Z","updated_at":"2021-05-12T15:51:17Z","author_association":"CONTRIBUTOR","body":"QA build failed due to connection reset pulling down a jar - not related to the code changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839883544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839883746","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-839883746","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":839883746,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTg4Mzc0Ng==","user":{"login":"Viv1986","id":25159403,"node_id":"MDQ6VXNlcjI1MTU5NDAz","avatar_url":"https://avatars.githubusercontent.com/u/25159403?v=4","gravatar_id":"","url":"https://api.github.com/users/Viv1986","html_url":"https://github.com/Viv1986","followers_url":"https://api.github.com/users/Viv1986/followers","following_url":"https://api.github.com/users/Viv1986/following{/other_user}","gists_url":"https://api.github.com/users/Viv1986/gists{/gist_id}","starred_url":"https://api.github.com/users/Viv1986/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Viv1986/subscriptions","organizations_url":"https://api.github.com/users/Viv1986/orgs","repos_url":"https://api.github.com/users/Viv1986/repos","events_url":"https://api.github.com/users/Viv1986/events{/privacy}","received_events_url":"https://api.github.com/users/Viv1986/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T15:51:31Z","updated_at":"2021-05-12T15:51:31Z","author_association":"NONE","body":"@EdColeman it's reassign in any case, if I start first master, the last, or even if I not restart master.\r\nTables run compaction time per time, not manually, but some time ago I added disks and started major compaction and it run ok without any notice.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839883746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839885069","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-839885069","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":839885069,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTg4NTA2OQ==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T15:53:13Z","updated_at":"2021-05-12T15:53:13Z","author_association":"CONTRIBUTOR","body":"Another option would be to click the \"Viewed\" checkbox on all of the thrift files, then they would be removed from your view. Not sure if that persists across browser sessions or not.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839885069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839890642","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-839890642","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":839890642,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTg5MDY0Mg==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T15:59:18Z","updated_at":"2021-05-12T15:59:18Z","author_association":"CONTRIBUTOR","body":"> @milleruntime - what's the best way to approach that? Create a branch off of this branch, remove the thrift files from this branch and remove the non-thrift files from the other?\r\n\r\nI was thinking remove the thrift files, do a typical build, commit your changes and then build again with the `-Pthrift` and then commit the generated files. Hopefully you still have the thrift executable!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839890642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839893042","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-839893042","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":839893042,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTg5MzA0Mg==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T16:02:13Z","updated_at":"2021-05-12T16:02:13Z","author_association":"CONTRIBUTOR","body":"> Another option would be to click the \"Viewed\" checkbox on all of the thrift files, then they would be removed from your view. Not sure if that persists across browser sessions or not.\r\n\r\nI think this will only hide the .thrift files (which I want to see). It won't hide the generated Java files.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839893042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839907985","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-839907985","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":839907985,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTkwNzk4NQ==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T16:11:28Z","updated_at":"2021-05-12T16:11:28Z","author_association":"CONTRIBUTOR","body":"I was referring to [this](https://github.blog/2019-07-01-mark-files-as-viewed/). I think the default in the File Filter dropdown is to remove them from your view.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839907985/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839908766","html_url":"https://github.com/apache/accumulo/issues/947#issuecomment-839908766","issue_url":"https://api.github.com/repos/apache/accumulo/issues/947","id":839908766,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTkwODc2Ng==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T16:12:31Z","updated_at":"2021-05-12T16:12:31Z","author_association":"CONTRIBUTOR","body":"> However, the props maps are only ever generated once, when they are null (see getCustom() and getTableCustom()). Assuming this is correct, this may not be an issue.\r\n\r\nYeah I think the caching solves this issue.  I also like the caching as it provides a consistent snapshot of those props to plugins.  There is a comment that could be removed [here](https://github.com/apache/accumulo/blob/3c039c75ba257c9ff47e0b09be53ef12665ddc74/core/src/main/java/org/apache/accumulo/core/util/ConfigurationImpl.java#L110).\r\n\r\nLooking at the code in ConfigurationImpl, it seems like it may provide a consistent snapshot of the custom props but not other props.  That seems like a wild and wacky user experience (also related to wider discussion I have had w/ @ctubbsii  in the past about making all of Accumulo's config operate on consistent snapshots), but if we wanted to address that it would be another issue.  I think the comment can be removed and this issue could be closed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839908766/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839910056","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-839910056","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":839910056,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTkxMDA1Ng==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T16:14:21Z","updated_at":"2021-05-12T16:14:21Z","author_association":"CONTRIBUTOR","body":"Please move this to discussion to the [user mailing list](https://accumulo.apache.org/contact-us/) .  On the list, please describe what steps you are taking,  and then behavior of the system - other details like # of tservers / tablets per tserver, type of ingest (bulk or batch) would be really helpful.  That will provide you with a wider audience for those that are not seeing this discussion.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839910056/reactions","total_count":1,"+1":0,"-1":1,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839912110","html_url":"https://github.com/apache/accumulo/issues/947#issuecomment-839912110","issue_url":"https://api.github.com/repos/apache/accumulo/issues/947","id":839912110,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTkxMjExMA==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T16:17:08Z","updated_at":"2021-05-12T16:17:08Z","author_association":"MEMBER","body":"Okay sounds good, thanks.\r\n\r\n>  I think the comment can be removed and this issue could be closed.\r\n\r\nI'll go ahead and do that.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839912110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839915681","html_url":"https://github.com/apache/accumulo/pull/2046#issuecomment-839915681","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2046","id":839915681,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTkxNTY4MQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T16:21:59Z","updated_at":"2021-05-12T16:21:59Z","author_association":"MEMBER","body":"Thanks for the PR @jjmar11 . Apologies for the delay in reviewing this. If you wish to be added as a contributor to https://accumulo.apache.org/people/ , please open a pull request to add yourself at https://github.com/apache/accumulo-website/edit/main/pages/people.md and leave a reference to `apache/accumulo#2046` in your commit log.\r\n\r\nIf you intend to be a regular contributor to Accumulo projects, please consider subscribing to our developer mailing list (https://accumulo.apache.org/contact-us/) and introducing yourself. :smiley_cat:","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839915681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839941479","html_url":"https://github.com/apache/accumulo/issues/2076#issuecomment-839941479","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2076","id":839941479,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTk0MTQ3OQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T16:58:55Z","updated_at":"2021-05-12T16:58:55Z","author_association":"MEMBER","body":"I wouldn't use an integer in place of the enum. RFile is already probably fine at compressing, and there's value in being able to actually read the file contents while troubleshooting. I don't think it would save much.\r\n\r\nAs Keith says, the current key scheme may be adequate... it's certainly the simplest migration. In that case, you don't need to use the CF, CQ, or CV at all. Just Row/Value.\r\n\r\nWhere I was going with the LG conversation was that I was just thinking that we could eliminate the tablet ID in the key structure, and make it efficient to recover an individual tablet if each tablet got its own locality group. We might even be able to eliminate the tabletID mapping and just use the extent directly, since it wouldn't be duplicated in the key. I don't see any advantage to using the event type for locality groups, though. We don't need efficient reads of all events of a specific type (I don't think so, anyway).\r\n\r\nThe wrench in my thinking is that I'm not that familiar right now with the recovery process, and I'm not actually sure why event type sorts before tablet ID.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839941479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839942726","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-839942726","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":839942726,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTk0MjcyNg==","user":{"login":"Viv1986","id":25159403,"node_id":"MDQ6VXNlcjI1MTU5NDAz","avatar_url":"https://avatars.githubusercontent.com/u/25159403?v=4","gravatar_id":"","url":"https://api.github.com/users/Viv1986","html_url":"https://github.com/Viv1986","followers_url":"https://api.github.com/users/Viv1986/followers","following_url":"https://api.github.com/users/Viv1986/following{/other_user}","gists_url":"https://api.github.com/users/Viv1986/gists{/gist_id}","starred_url":"https://api.github.com/users/Viv1986/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Viv1986/subscriptions","organizations_url":"https://api.github.com/users/Viv1986/orgs","repos_url":"https://api.github.com/users/Viv1986/repos","events_url":"https://api.github.com/users/Viv1986/events{/privacy}","received_events_url":"https://api.github.com/users/Viv1986/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T17:00:48Z","updated_at":"2021-05-12T17:00:48Z","author_association":"NONE","body":"@EdColeman tried, but all time \r\n\r\nHi. This is the qmail-send program at apache.org.\r\nI'm afraid I wasn't able to deliver your message to the following addresses.\r\nThis is a permanent error; I've given up. Sorry it didn't work out.\r\n\r\n<user@accumulo.apache.org>:\r\nMust be sent from an @apache.org address or a subscriber address or an address in LDAP.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839942726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839946104","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-839946104","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":839946104,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTk0NjEwNA==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T17:06:04Z","updated_at":"2021-05-12T17:06:04Z","author_association":"CONTRIBUTOR","body":"Did you subscribe first? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839946104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839953761","html_url":"https://github.com/apache/accumulo/issues/947#issuecomment-839953761","issue_url":"https://api.github.com/repos/apache/accumulo/issues/947","id":839953761,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTk1Mzc2MQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T17:18:17Z","updated_at":"2021-05-12T17:18:17Z","author_association":"MEMBER","body":"Based on the above conversation, I'll go ahead and close this issue. @DomGarguilo , feel free to make a PR to remove the comment. That PR doesn't have to depend on this issue being open, since this issue describes something else entirely.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839953761/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839984446","html_url":"https://github.com/apache/accumulo/issues/2076#issuecomment-839984446","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2076","id":839984446,"node_id":"MDEyOklzc3VlQ29tbWVudDgzOTk4NDQ0Ng==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T18:02:21Z","updated_at":"2021-05-12T18:02:21Z","author_association":"CONTRIBUTOR","body":"> As Keith says, the current key scheme may be adequate... it's certainly the simplest migration. In that case, you don't need to use the CF, CQ, or CV at all. Just Row/Value.\r\n\r\nThe current scheme in LogFileKey is just an implementation for `WritableComparable` which includes serialization/deserialization and the compareTo method. Part of this task is translating `LogFileKey` into an Accumulo `Key` so we can store it in an RFile. I am also translating `LogFileValue` into an Accumulo `Value` (but this is just the mutations serialized). We need somewhere to put all the information serialized in `LogFileKey` into `Key`, otherwise it will be lost when sorted. \r\n\r\n> We don't need efficient reads of all events of a specific type (I don't think so, anyway).\r\n\r\nThere are a few places during recovery where we iterate over the logs to get different types of information. The first time we only look for `DEFINE_TABLET` events in the log. This is where I got the idea to use event for CF. Check it out here: https://github.com/apache/accumulo/blob/6a74b4667e3bd33e34b5262c5dd8ea64167fb657/server/tserver/src/main/java/org/apache/accumulo/tserver/log/SortedLogRecovery.java#L105\r\n\r\n> The wrench in my thinking is that I'm not that familiar right now with the recovery process, and I'm not actually sure why event type sorts before tablet ID.\r\n\r\nJoin the club! I still don't understand `tabletId` and `seq` in LogFileKey. This comment here makes me think its tracking in each WAL: https://github.com/apache/accumulo/blob/6a74b4667e3bd33e34b5262c5dd8ea64167fb657/server/tserver/src/main/java/org/apache/accumulo/tserver/log/SortedLogRecovery.java#L290-L292","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/839984446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840035951","html_url":"https://github.com/apache/accumulo/issues/2100#issuecomment-840035951","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2100","id":840035951,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDAzNTk1MQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T19:19:36Z","updated_at":"2021-05-12T19:19:36Z","author_association":"MEMBER","body":"Could have a KeywordExecutable, like we have for `rfile-info`. Could be `wal-info`.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840035951/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840148438","html_url":"https://github.com/apache/accumulo/pull/2102#issuecomment-840148438","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2102","id":840148438,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDE0ODQzOA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T23:03:44Z","updated_at":"2021-05-12T23:03:44Z","author_association":"MEMBER","body":"Build failure for Hadoop 3 profile is unrelated. It's just GitHub timing out while downloading dependencies from Maven Central.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840148438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840150024","html_url":"https://github.com/apache/accumulo/pull/2102#issuecomment-840150024","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2102","id":840150024,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDE1MDAyNA==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T23:07:37Z","updated_at":"2021-05-12T23:07:37Z","author_association":"CONTRIBUTOR","body":"The QA failures appear to be related to timeouts fetching guava 20. On first run both builds failed (2/3 jobs failed) I resubmitted an 1 passed, 1 still failed with same error (1/3 jobs failed)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840150024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840154332","html_url":"https://github.com/apache/accumulo/issues/2085#issuecomment-840154332","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2085","id":840154332,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDE1NDMzMg==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-12T23:18:06Z","updated_at":"2021-05-12T23:18:06Z","author_association":"CONTRIBUTOR","body":"Closing this - the discussion has moved to the mailing list and there is not enough actionable information in the issue to take any action.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840154332/reactions","total_count":1,"+1":0,"-1":1,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840648437","html_url":"https://github.com/apache/accumulo/issues/2105#issuecomment-840648437","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2105","id":840648437,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDY0ODQzNw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T15:43:16Z","updated_at":"2021-05-13T15:43:16Z","author_association":"MEMBER","body":"The quoting in the shell may be a little quirky, but I don't think it's so inconvenient as to require writing and maintaining a whole new feature to avoid quoting. Perhaps we could improve the error message from whatever you tried the first time? Or provide a debugging log message, to show what it thinks you entered so you can find the problem with quoting more quickly?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840648437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840650560","html_url":"https://github.com/apache/accumulo/issues/2105#issuecomment-840650560","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2105","id":840650560,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDY1MDU2MA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T15:46:55Z","updated_at":"2021-05-13T15:46:55Z","author_association":"CONTRIBUTOR","body":"One of the issues right now is that the default values get displayed with two kinds of quotes:\r\n<pre>\r\nroot@uno> config -f compaction.major.service\r\n-----------+--------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------\r\nSCOPE      | NAME                                                               | VALUE\r\n-----------+--------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------\r\ndefault    | tserver.compaction.major.service.default.planner ................. | org.apache.accumulo.core.spi.compaction.DefaultCompactionPlanner\r\ndefault    | tserver.compaction.major.service.default.planner.opts.executors .. | [{'name':'small','maxSize':'32M','numThreads':2},{'name':'medium','maxSize':'128M','numThreads':2},{\"name\":\"large\",\"numThreads\":2}]\r\ndefault    | tserver.compaction.major.service.default.planner.opts.maxOpen .... | 10\r\ndefault    | tserver.compaction.major.service.default.rate.limit .............. | 0B\r\ndefault    | tserver.compaction.major.service.meta.planner .................... | org.apache.accumulo.core.spi.compaction.DefaultCompactionPlanner\r\ndefault    | tserver.compaction.major.service.meta.planner.opts.executors ..... | [{'name':'small','maxSize':'32M','numThreads':2},{\"name\":\"huge\",\"numThreads\":2}]\r\ndefault    | tserver.compaction.major.service.meta.planner.opts.maxOpen ....... | 30\r\ndefault    | tserver.compaction.major.service.meta.rate.limit ................. | 0B\r\ndefault    | tserver.compaction.major.service.root.planner .................... | org.apache.accumulo.core.spi.compaction.DefaultCompactionPlanner\r\ndefault    | tserver.compaction.major.service.root.planner.opts.executors ..... | [{'name':'small','maxSize':'32M','numThreads':1},{\"name\":\"huge\",\"numThreads\":1}]\r\n</pre>\r\nIt wouldn't be so bad to copy and paste the JSON blob but right now I have to modify at least half of the quotes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840650560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840654701","html_url":"https://github.com/apache/accumulo/issues/2105#issuecomment-840654701","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2105","id":840654701,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDY1NDcwMQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T15:53:42Z","updated_at":"2021-05-13T15:53:42Z","author_association":"MEMBER","body":"Single quotes are not considered proper JSON. Many JSON parsers are forgiving in this regard, but it's technically not valid to use single quotes in JSON. The values should only use double-quotes in the first place. Then, you can use single-quotes to quote the entire value in the shell. We could also make the output of the shell show copy/paste friendly quoting, so quotes are already escaped and values are already quoted. However, that could get very ugly and confusing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840654701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840657332","html_url":"https://github.com/apache/accumulo/issues/2105#issuecomment-840657332","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2105","id":840657332,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDY1NzMzMg==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T15:58:00Z","updated_at":"2021-05-13T15:58:00Z","author_association":"CONTRIBUTOR","body":"> The quoting in the shell may be a little quirky, but I don't think it's so inconvenient as to require writing and maintaining a whole new feature to avoid quoting. Perhaps we could improve the error message from whatever you tried the first time? Or provide a debugging log message, to show what it thinks you entered so you can find the problem with quoting more quickly?\r\n\r\nI found the issue fairly quickly. I guess my issue is with the JSON in the first place. We are basically asking users to write scripts in order to set these properties and that worries me. Maybe its not that big of deal on a large cluster but I guess it would depend on how a user does configuration management of their cluster in the first place.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840657332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840673982","html_url":"https://github.com/apache/accumulo/issues/2105#issuecomment-840673982","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2105","id":840673982,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDY3Mzk4Mg==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T16:24:47Z","updated_at":"2021-05-13T16:27:55Z","author_association":"CONTRIBUTOR","body":">  I guess my issue is with the JSON in the first place.\r\n\r\nI didn't easily settle on using json.  However I saw it as an option between the following\r\n\r\n```\r\ntserver.compaction.major.service.root.planner.opts.executors ..... | [{'name':'small','maxSize':'32M','numThreads':1},{\"name\":\"huge\",\"numThreads\":1}]\r\n```\r\n\r\nor the following\r\n\r\n```\r\ntserver.compaction.major.service.root.planner.opts.executors.small.maxSize=32M\r\ntserver.compaction.major.service.root.planner.opts.executors.small.numThreads=1\r\ntserver.compaction.major.service.root.planner.opts.executors.huge.numThreads=1\r\n```\r\n\r\nand thought that json would be better than the exploded options.  Also the JSON is not intrinsic to Accumulo, its just something the default planner plugin uses.  One could write another planner that does not use json for its options.\r\n\r\nI would not be opposed to using exploded options, but json was my preference. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840673982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840714235","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-840714235","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":840714235,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDcxNDIzNQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T17:32:39Z","updated_at":"2021-05-13T17:32:39Z","author_association":"CONTRIBUTOR","body":"I was able to successfully run the example @dlmarion gave on the website and it is pretty cool! I was also able to catch an entry in the metadata:\r\n<pre>\r\n4< ecomp:ECID:04d6f4a3-3caa-46e6-9ea5-ce77a0ddc8dc []\t{\"inputs\":[\"hdfs://localhost:8020/accumulo/tables/4/default_tablet/A000005v.rf\"],\"nextFiles\":[],\"tmp\":\"hdfs://localhost:8020/accumulo/tables/4/default_tablet/A000005y.rf_tmp\",\"dest\":\"hdfs://localhost:8020/accumulo/tables/4/default_tablet/A000005y.rf\",\"compactor\":\"ip-10-113-12-25:9101\",\"kind\":\"USER\",\"executorId\":\"DCQ1\",\"priority\":288230376151711745,\"propDels\":false,\"selectedAll\":true,\"compactionId\":2}\r\n</pre>\r\nI love how everything about the compaction is explicit AND in one place. I think this will be invaluable for debugging. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840714235/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840728126","html_url":"https://github.com/apache/accumulo/pull/2106#issuecomment-840728126","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2106","id":840728126,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDcyODEyNg==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T17:56:13Z","updated_at":"2021-05-13T17:56:13Z","author_association":"CONTRIBUTOR","body":"Sounds good, thanks @jmark99 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840728126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840734707","html_url":"https://github.com/apache/accumulo/pull/2108#issuecomment-840734707","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2108","id":840734707,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDczNDcwNw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T18:07:11Z","updated_at":"2021-05-13T18:07:11Z","author_association":"MEMBER","body":"Tests pass, so I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840734707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840752797","html_url":"https://github.com/apache/accumulo/issues/2105#issuecomment-840752797","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2105","id":840752797,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDc1Mjc5Nw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T18:38:21Z","updated_at":"2021-05-13T18:38:21Z","author_association":"CONTRIBUTOR","body":"I opened https://github.com/apache/accumulo/pull/2109 so the JSON is properly displayed. Then users can at least copy and paste the JSON that gets returned when changing the default values.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840752797/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840760658","html_url":"https://github.com/apache/accumulo/pull/2109#issuecomment-840760658","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2109","id":840760658,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDc2MDY1OA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T18:50:46Z","updated_at":"2021-05-13T18:50:46Z","author_association":"MEMBER","body":"For what it's worth, Java 15 (13 preview) adds a TextBlock feature that would make it easier to have double quotes inside a string, without a ton of escaping. It would also make it easier to format our JSON in our String literals in a more readable way.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840760658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840800405","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-840800405","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":840800405,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDgwMDQwNQ==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T20:03:10Z","updated_at":"2021-05-13T20:03:10Z","author_association":"CONTRIBUTOR","body":"> I was able to successfully run the example @dlmarion gave on the website and it is pretty cool! I was also able to catch an entry in the metadata:\r\n\r\n@milleruntime looking at your comment I opened #2110. This PR is so large, I think we can use the external compaction project to open issue and not just rely on the comment in this PR.  That opens the possibility of merging this PR and doing some of those issues as follow on PRs.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840800405/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840808908","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-840808908","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":840808908,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDgwODkwOA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T20:18:55Z","updated_at":"2021-05-13T20:18:55Z","author_association":"CONTRIBUTOR","body":"> @milleruntime looking at your comment I opened #2110. This PR is so large, I think we can use the external compaction project to open issue and not just rely on the comment in this PR. That opens the possibility of merging this PR and doing some of those issues as follow on PRs.\r\n\r\nThat works since I don't anticipate seeing something that would prevent you guys from merging. I will just keep putting comments here against the code in the PR since that is easier for me. They could all be follow on work if that's easier for you guys.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840808908/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840814476","html_url":"https://github.com/apache/accumulo/pull/2109#issuecomment-840814476","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2109","id":840814476,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDgxNDQ3Ng==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T20:28:40Z","updated_at":"2021-05-13T20:28:40Z","author_association":"CONTRIBUTOR","body":"@ctubbsii this bug makes me wonder if there is an issue with the autoformatter. Is it possible that the line was coded like this:\r\n<pre>\r\n\"{'name':'medium','maxSize':'128M','numThreads':2},{'name':'large','numThreads':2}]\".replaceAll(\"'\", \"\\\"\"),\r\n</pre>\r\nBut was automatically split, changing the output:\r\n<pre>\r\n\"{'name':'medium','maxSize':'128M','numThreads':2},\"\r\n          + \"{'name':'large','numThreads':2}]\".replaceAll(\"'\", \"\\\"\"),\r\n</pre>","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840814476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840865048","html_url":"https://github.com/apache/accumulo/pull/2109#issuecomment-840865048","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2109","id":840865048,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDg2NTA0OA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-13T22:11:57Z","updated_at":"2021-05-13T22:11:57Z","author_association":"MEMBER","body":"I don't believe the formatter ever creates a string concatenation in order to break up a long line. This was most likely done manually by somebody trying to make it compliant with a checkstyle rule to check the line length, and they simply overlooked the fact that the method call was only being done on the last component rather than the whole String. As Keith mentioned, you could keep the parentheses in there, in case it does get wrapped or split later.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/840865048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/841152044","html_url":"https://github.com/apache/accumulo/pull/2084#issuecomment-841152044","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2084","id":841152044,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTE1MjA0NA==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T10:14:33Z","updated_at":"2021-05-14T10:14:33Z","author_association":"CONTRIBUTOR","body":"> Have you been able to test this change?\r\n\r\nI have tested this on a small cluster. It did allow the other tablets to be loaded while rescheduling the recovering of the tablet with the misconfigured iterator. My main concern was handling any possible edge case or any scenario that could disrupt normal recovery on a larger cluster. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/841152044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/841406884","html_url":"https://github.com/apache/accumulo/pull/2109#issuecomment-841406884","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2109","id":841406884,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MTQwNjg4NA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-14T17:54:20Z","updated_at":"2021-05-14T17:57:05Z","author_association":"CONTRIBUTOR","body":"I did some experimenting and the formatter does not break up the string.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/841406884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842357738","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842357738","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842357738,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjM1NzczOA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T14:11:03Z","updated_at":"2021-05-17T14:11:03Z","author_association":"MEMBER","body":"Based on the documentation in apache/accumulo-website#282 , it seems that the way the external compactions are exposed through to the user in the compaction configuration is through the specially named `externalQueue`, which seems to be a special feature of the default compaction service. Is that correct?\r\n\r\nFrom the perspective of the user configuring things, it seems difficult to reason about how this configuration maps to pluggable services that they are deploying and administering, because the external compaction services aren't configured explicitly, but are an internal feature of a monolithic compaction service implementation. It seems like it will try to \"automagically\" use external services because of a specially named queue, and not because some plugin like `my.external.compaction.CompactionExecutorService` is configured explicitly as an executor (unless I'm mistaken here; I'm still going through the code).\r\n\r\nI'm wondering if there are ways this could be made a bit more modular and the configuration a bit more explicit, so that the default compaction service isn't so monolithic, and users can very explicitly swap out the external executor implementation for another one. This specific implementation could be maintained in a side repository, deployed as a separate optional jar, and configured by users by some class name at an appropriate place in the configuration that specifies a plugin implementation. However, it should also be capable of being easily swapped out for a different external compaction implementation, and I'm not sure that's the case right now.\r\n\r\nMy main concern is that if the implementation is too monolithic, it creates a maintenance burden to continue to add marginal improvements to the monolithic implementation to satisfy every divergent use case, rather than encourage users to take advantage of the modular nature of our plugins to develop implementations to satisfy specific use cases. Ideally, we'd really want to make things pluggable/modular and the plugin interfaces relatively lightweight.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842357738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842381842","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842381842","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842381842,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjM4MTg0Mg==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T14:41:41Z","updated_at":"2021-05-17T14:41:41Z","author_association":"CONTRIBUTOR","body":"> it seems that the way the external compactions are exposed through to the user in the compaction configuration is through the specially named externalQueue, which seems to be a special feature of the default compaction service. Is that correct?\r\n\r\nCurrently, yes. I believe the intention was to allow for users to configure compactions on their table(s) such that some could run internally (say, smaller ones) and other (larger) externally.\r\n\r\n> I'm wondering if there are ways this could be made a bit more modular and the configuration a bit more explicit, so that the default compaction service isn't so monolithic, and users can very explicitly swap out the external executor implementation for another one.\r\n\r\nI don't think that one of our goals was to create a pluggable external implementation. It's possible it was, I just don't remember that. Is that something we want?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842381842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842394039","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842394039","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842394039,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjM5NDAzOQ==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T14:57:30Z","updated_at":"2021-05-17T15:01:31Z","author_association":"CONTRIBUTOR","body":">  it seems that the way the external compactions are exposed through to the user in the compaction configuration is through the specially named externalQueue, which seems to be a special feature of the default compaction service. Is that correct?\r\n\r\nIts a feature of the default compaction planner, not the default compaction service.  Each compaction service has a configured planner that decides what to compact where.  The [default compaction planner](https://github.com/apache/accumulo/blob/3983cd23629789c1ed0020d01fdd968eabfe590f/core/src/main/java/org/apache/accumulo/core/spi/compaction/DefaultCompactionPlanner.java#L73) accepts the config externalQueue.  It then takes this information and calls the SPI method [getExternalExecutor](https://github.com/apache/accumulo/blob/3983cd23629789c1ed0020d01fdd968eabfe590f/core/src/main/java/org/apache/accumulo/core/spi/compaction/ExecutorManager.java#L38).  Anyone could write a compaction planner that uses external queues by calling this same SPI method.  The planners configuration could work any way the author likes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842394039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842406924","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842406924","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842406924,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjQwNjkyNA==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T15:13:42Z","updated_at":"2021-05-17T15:21:19Z","author_association":"CONTRIBUTOR","body":"> I'm wondering if there are ways this could be made a bit more modular and the configuration a bit more explicit, so that the default compaction service isn't so monolithic, and users can very explicitly swap out the external executor implementation for another one. \r\n\r\nIn the current design tablets and tservers are authorities, within a distributed system, on what external compactions are running and queued.  There are RPCs to reserve, fail, and commit external compactions within the tserver AND there is an RPC to get summary information about external queues in the tserver.  These RPCs are structured specifically for the way the rest of the distributed system (coordinator and compactors) works.  Should these tserver RPCs be generalized?  If so, how?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842406924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842443067","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842443067","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842443067,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjQ0MzA2Nw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T16:00:24Z","updated_at":"2021-05-17T16:00:24Z","author_association":"MEMBER","body":"@dlmarion wrote:\r\n> I don't think that one of our goals was to create a pluggable external implementation. It's possible it was, I just don't remember that. Is that something we want?\r\n\r\nMy understanding of the original idea to create an \"external\" compactions, was to create them \"external\" to Accumulo... something Accumulo could \"submit\" work to do and not care about the implementation, and get back a new compacted file. The current implementation only makes them \"external\" to the tserver, not to Accumulo, and does so by growing Accumulo by 30,000 lines of code. This isn't necessarily bad, but it seems much more complex and tightly coupled to Accumulo's core than I think is maintainable long-term. My understanding of the original idea was to be able to submit compactions to some external service that the user could designate.... it could be a separate process, a bare metal server farm, EC2 nodes that scale on demand, or something else, depending on user needs. My understanding was that there would also be some flexibility in externalizing this functionality, and that implies making it pluggable in some way. Perhaps my understanding was incorrect, but that's what I had thought.\r\n\r\nThe bare minimum implementation that I was expecting to review at this point would be a pluggable service API for external compactions, and possibly a rudimentary in-process implementation. I wasn't quite expecting new worker processes, and a new coordination service, as well as new ZooKeeper nodes and RPCs. All of that seems to add a lot of complexity, and while that complexity seems necessary for a robust implementation as seems to be provided here (which is great, overall), I worry about maintainability in the future if it isn't modularized and pluggable, or flexibility based on divergent use cases.\r\n\r\nDon't get me wrong... I have no issue with the basic design of this PR, as far as I can tell. I'm just wondering how we can improve upon the API/configuration to make it more modular so it's more maintainable in the future, and more flexible for users if they need to swap in alternate implementations of externalized workers to do the actual compacting. Right now, I don't know enough about the implementation to propose suggestions for how to do that... I'm only raising the issue to those who might know. As I try to dive in and learn the implementation, I may have more concrete suggestions. But, this is a lot of code, so it may take time to get that point.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842443067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842460992","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842460992","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842460992,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjQ2MDk5Mg==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T16:24:54Z","updated_at":"2021-05-17T16:29:49Z","author_association":"CONTRIBUTOR","body":"> My understanding of the original idea to create an \"external\" compactions, was to create them \"external\" to Accumulo... something Accumulo could \"submit\" work to do and not care about the implementation, and get back a new compacted file.\r\n\r\nThat was never an explicit goal I had. To achieve this goal, thinking about the following.  Currently the implementation of the coordinator and compactors components use a lot of internal Accumulo code.  To move these to external repo would require refactoring them to use only API and SPI calls into Accumulo. To do this would require exposing a lot internal low level API/SPI calls related to compactions(not sure what these would be, that would need exploration).   For this exercise to be useful these newly exposed API/SPI calls would have to be generally useful and not overfit (meaning the new API/SPI calls can only be used to implement the current design).  To avoid overfitting, it seems we would need to have multiple other designs in mind that we could test against these new API/SPI calls to verify that we have not overfit.  Is there another path other than what I have described?  Does this path actually lower the complexity? I am not sure it would, I think the answer to that depends on what these new API/SPI calls are.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842460992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842469896","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842469896","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842469896,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjQ2OTg5Ng==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T16:37:57Z","updated_at":"2021-05-17T16:37:57Z","author_association":"CONTRIBUTOR","body":"In the current website PR I removed our original design document because @keith-turner and I had made several changes over the course of development. However, I still have the original documentation in another branch. I revisited our [original](https://github.com/dlmarion/accumulo-website/blob/external-compaction-design-capture-all-information/design/external-compaction.md) design and I think what we have today is closely aligned with what we envisioned at the beginning of this process. Having the benefit of already writing the external compaction code, I'm not sure that a separate and independent service  could be achieved without a significant set of new APIs being written for Accumulo.\r\n\r\nI think @keith-turner pointed to the planner being the place where someone can write their own compaction implementation. But, I do agree that this initial implementation is tightly coupled to Accumulo internals. Maybe this is a stepping stone to a fully pluggable implementation. Looking at the coordinator should tell us what it needs in a public API to make it fully external.\r\n\r\nFinally, my personal goal here was to move compactions out of the TServer for several reasons (below). The Compactor component can be run on different hardware than the TabletServers, and even run in Kubernetes using their dynamic pod scheduling feature to scale up/down the number of Compactors based on load.\r\n \r\n  * Allow compactions to outlive a TabletServer\r\n  * Allow compactions to occur concurrent to a Tablet being re-hosted\r\n  * Reduce the load on the TabletServer, giving it more cycles to insert mutations and respond to scans\r\n  * Allow compactions to be scaled differently than the number of TabletServers","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842469896/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842543283","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842543283","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842543283,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjU0MzI4Mw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T18:35:26Z","updated_at":"2021-05-17T18:35:26Z","author_association":"MEMBER","body":"@keith-turner wrote:\r\n> These RPCs are structured specifically for the way the rest of the distributed system (coordinator and compactors) works. Should these tserver RPCs be generalized? If so, how?\r\n\r\nSorry, I don't know enough about the current implementation to understand the question yet, in order to answer it. The generalized interface I was thinking about was something like `BiFunction<Set<File>, CompactionConfig, Future<File>>`. I was thinking any necessary RPCs would be implementation-specific, and independent of Accumulo's RPCs. My preconceptions of what this would look like have been broken, so I would need to do some catch up understanding before I could have specific thoughts on how they could be improved.\r\n\r\n> > My understanding of the original idea to create an \"external\" compactions, was to create them \"external\" to Accumulo... something Accumulo could \"submit\" work to do and not care about the implementation, and get back a new compacted file.\r\n> \r\n> That was never an explicit goal I had.\r\n\r\nOkay, I guess I just had a different idea in mind of what \"external\" meant.\r\n\r\n> Is there another path other than what I have described? Does this path actually lower the complexity? I am not sure it would, I think the answer to that depends on what these new API/SPI calls are.\r\n\r\nIf we went with the `BiFunction<Set<File>, CompactionConfig, Future<File>>` concept, or similar, then nothing internal need be exposed to it. The RFile config settings (locality groups, etc.) and iterators are already \"public API\". A lot of the compaction complexity, with the services, planners, executors, queues, workers, etc. could sit inside an implementation. Or, all that could be left as-is, and just expect the pluggable part to be the \"last stage\" after going through that management pipeline, which I think is basically how it is now... but not expressed as simply as I have with the \"BiFunction\" expression.\r\n\r\nI'm curious, do the external compactors support RFile encryption and other RFile-specific configs (like block sizes, locality groups, etc.) today? My guess is that they do, because it's still all the same Accumulo code, just running in a different process, but just curious how much you've exercised those while testing this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842543283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842584575","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842584575","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842584575,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjU4NDU3NQ==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T19:45:32Z","updated_at":"2021-05-17T19:48:31Z","author_association":"CONTRIBUTOR","body":"Omitting a lot of detail, the following are the basics of what the current system does.  The first step uses a pluggable planner.\r\n\r\n1. Plan compaction :  Take current tablets files, current running compactions for the tablet, and emit set of compactions jobs.  A compaction job is set of files to compact, a  priority, and a destination queue.\r\n 2. Queue Jobs : An attempt to queue the jobs emitted from the planner is made by doing the following.\r\n    1. Cancel anything that was previously queued by the planner for the tablet.  If this fails, go back to planning step and try again because things probably changed during planning.  If the planner emits jobs that exactly match what was queued before, then skip the next step.\r\n    2. Queue the new job from the planner on the desired priority queues\r\n 3. When an internal or external compactor thread finishes a task, it takes the next highest priority job from the queue and actually runs a compaction.\r\n\r\nI don' think interface `BiFunction<Set<File>, CompactionConfig, Future<File>>` would be sufficient to achieve this functionality.  It would not support the current functionality of priority queues and canceling queued work when things change (new files arrive, job start/finish during planning). In the current impl the priority queue for local compactions is very precise.  For external compaction there is essentially a global priority queue that is approximate (eventually consistent) that may not always start the highest priority job next, but usually will.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842584575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842595041","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-842595041","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":842595041,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjU5NTA0MQ==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T20:04:33Z","updated_at":"2021-05-17T20:04:33Z","author_association":"CONTRIBUTOR","body":"> I'm curious, do the external compactors support RFile encryption and other RFile-specific configs (like block sizes, locality groups, etc.) today? My guess is that they do, because it's still all the same Accumulo code, just running in a different process, but just curious how much you've exercised those while testing this.\r\n\r\nThe intent is that they should, but not everything has been tested.  The [code that actually runs compactions of files](https://github.com/apache/accumulo/blob/90e76cd59e5ed6e08a75020f0d50fe69c4bebee3/server/base/src/main/java/org/apache/accumulo/server/compaction/FileCompactor.java#L73) was refactored and moved so that it could be used by tservers and external compactors.  So the same code is used, the question is do we always give it the same inputs.  Also if compactions were to be highly generalized, some analogue of this code would probably need to be exposed via SPI or API.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842595041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842625498","html_url":"https://github.com/apache/accumulo/issues/2041#issuecomment-842625498","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2041","id":842625498,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjYyNTQ5OA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T20:43:41Z","updated_at":"2021-05-17T20:43:41Z","author_association":"MEMBER","body":"@lawynnj Are you still interested in working on this?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842625498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842627946","html_url":"https://github.com/apache/accumulo/issues/1916#issuecomment-842627946","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1916","id":842627946,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjYyNzk0Ng==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T20:47:57Z","updated_at":"2021-05-17T20:47:57Z","author_association":"MEMBER","body":"I think this might be a duplicate of #608","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842627946/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842665558","html_url":"https://github.com/apache/accumulo/issues/2041#issuecomment-842665558","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2041","id":842665558,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MjY2NTU1OA==","user":{"login":"lawynnj","id":9859770,"node_id":"MDQ6VXNlcjk4NTk3NzA=","avatar_url":"https://avatars.githubusercontent.com/u/9859770?v=4","gravatar_id":"","url":"https://api.github.com/users/lawynnj","html_url":"https://github.com/lawynnj","followers_url":"https://api.github.com/users/lawynnj/followers","following_url":"https://api.github.com/users/lawynnj/following{/other_user}","gists_url":"https://api.github.com/users/lawynnj/gists{/gist_id}","starred_url":"https://api.github.com/users/lawynnj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lawynnj/subscriptions","organizations_url":"https://api.github.com/users/lawynnj/orgs","repos_url":"https://api.github.com/users/lawynnj/repos","events_url":"https://api.github.com/users/lawynnj/events{/privacy}","received_events_url":"https://api.github.com/users/lawynnj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-17T21:50:24Z","updated_at":"2021-05-17T21:50:24Z","author_association":"CONTRIBUTOR","body":"@ctubbsii unfortunately I am not. Sorry!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/842665558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843035667","html_url":"https://github.com/apache/accumulo/issues/2041#issuecomment-843035667","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2041","id":843035667,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzAzNTY2Nw==","user":{"login":"slackwinner","id":50567198,"node_id":"MDQ6VXNlcjUwNTY3MTk4","avatar_url":"https://avatars.githubusercontent.com/u/50567198?v=4","gravatar_id":"","url":"https://api.github.com/users/slackwinner","html_url":"https://github.com/slackwinner","followers_url":"https://api.github.com/users/slackwinner/followers","following_url":"https://api.github.com/users/slackwinner/following{/other_user}","gists_url":"https://api.github.com/users/slackwinner/gists{/gist_id}","starred_url":"https://api.github.com/users/slackwinner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slackwinner/subscriptions","organizations_url":"https://api.github.com/users/slackwinner/orgs","repos_url":"https://api.github.com/users/slackwinner/repos","events_url":"https://api.github.com/users/slackwinner/events{/privacy}","received_events_url":"https://api.github.com/users/slackwinner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T10:03:53Z","updated_at":"2021-05-18T10:03:53Z","author_association":"CONTRIBUTOR","body":"If this task still needs to be done, I can complete it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843035667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843101429","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-843101429","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":843101429,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzEwMTQyOQ==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T11:48:05Z","updated_at":"2021-05-18T11:48:05Z","author_association":"CONTRIBUTOR","body":"@milleruntime @ctubbsii - I'm looking for an existing IT that tests encryption so I can write something for the external compactions. I have found CryptoTest, which is a unit test, and WriteAheadLogEncryptedIT which doesn't have anything that might be relevant for me. Do you know of an existing test that I can look to for an example?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843101429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843206765","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-843206765","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":843206765,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzIwNjc2NQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T14:11:57Z","updated_at":"2021-05-18T14:11:57Z","author_association":"CONTRIBUTOR","body":"> @milleruntime @ctubbsii - I'm looking for an existing IT that tests encryption so I can write something for the external compactions. I have found CryptoTest, which is a unit test, and WriteAheadLogEncryptedIT which doesn't have anything that might be relevant for me. Do you know of an existing test that I can look to for an example?\r\n\r\nThat is currently all we have for automated tests. The other testing we did was manual using Uno, which has a configurable plugin for crypto. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843206765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843220807","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-843220807","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":843220807,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzIyMDgwNw==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T14:28:05Z","updated_at":"2021-05-18T14:28:05Z","author_association":"CONTRIBUTOR","body":"@ctubbsii wrote:\r\n> it seems that the way the external compactions are exposed through to the user in the compaction configuration is through the specially named externalQueue\r\n\r\nThe DefaultCompactionPlanner javadoc is out of date, it's doesn't describe `externalQueue`. Looking at `DefaultCompactionPlanner.ExecutorConfig` and `DefaultCompactionPlanner.init()` it seems it would be trivial to change the configuration so that it was more explicit. We could add a `type` field, for example:\r\n\r\n```\r\n[\r\n {\r\n   \"name\": \"small\",\r\n   \"type\": \"internal\",\r\n   \"maxSize\": \"16M\",\r\n   \"numThreads\": 4\r\n },\r\n {\r\n   \"name\": \"large\",\r\n   \"type\": \"external\",\r\n   \"queue\": \"LargeQ\"\r\n }\r\n]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843220807/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843227326","html_url":"https://github.com/apache/accumulo/issues/2041#issuecomment-843227326","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2041","id":843227326,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzIyNzMyNg==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T14:36:21Z","updated_at":"2021-05-18T14:36:21Z","author_association":"MEMBER","body":"@slackwinner , @jjmar11 had expressed to me that they were interested.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843227326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843230932","html_url":"https://github.com/apache/accumulo/issues/2041#issuecomment-843230932","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2041","id":843230932,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzIzMDkzMg==","user":{"login":"slackwinner","id":50567198,"node_id":"MDQ6VXNlcjUwNTY3MTk4","avatar_url":"https://avatars.githubusercontent.com/u/50567198?v=4","gravatar_id":"","url":"https://api.github.com/users/slackwinner","html_url":"https://github.com/slackwinner","followers_url":"https://api.github.com/users/slackwinner/followers","following_url":"https://api.github.com/users/slackwinner/following{/other_user}","gists_url":"https://api.github.com/users/slackwinner/gists{/gist_id}","starred_url":"https://api.github.com/users/slackwinner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slackwinner/subscriptions","organizations_url":"https://api.github.com/users/slackwinner/orgs","repos_url":"https://api.github.com/users/slackwinner/repos","events_url":"https://api.github.com/users/slackwinner/events{/privacy}","received_events_url":"https://api.github.com/users/slackwinner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T14:40:51Z","updated_at":"2021-05-18T14:40:51Z","author_association":"CONTRIBUTOR","body":"@ctubbsii I was about to send a PR to fix this issue but will stand down to allow @jjmar11 to work on this. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843230932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843236371","html_url":"https://github.com/apache/accumulo/issues/2041#issuecomment-843236371","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2041","id":843236371,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzIzNjM3MQ==","user":{"login":"slackwinner","id":50567198,"node_id":"MDQ6VXNlcjUwNTY3MTk4","avatar_url":"https://avatars.githubusercontent.com/u/50567198?v=4","gravatar_id":"","url":"https://api.github.com/users/slackwinner","html_url":"https://github.com/slackwinner","followers_url":"https://api.github.com/users/slackwinner/followers","following_url":"https://api.github.com/users/slackwinner/following{/other_user}","gists_url":"https://api.github.com/users/slackwinner/gists{/gist_id}","starred_url":"https://api.github.com/users/slackwinner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slackwinner/subscriptions","organizations_url":"https://api.github.com/users/slackwinner/orgs","repos_url":"https://api.github.com/users/slackwinner/repos","events_url":"https://api.github.com/users/slackwinner/events{/privacy}","received_events_url":"https://api.github.com/users/slackwinner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T14:47:56Z","updated_at":"2021-05-18T14:47:56Z","author_association":"CONTRIBUTOR","body":"My mistake. I accidentally hit the draft PR button. I'll close out the PR I made.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843236371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843239509","html_url":"https://github.com/apache/accumulo/issues/2041#issuecomment-843239509","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2041","id":843239509,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzIzOTUwOQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T14:51:46Z","updated_at":"2021-05-18T14:51:46Z","author_association":"MEMBER","body":"@slackwinner I think it's fine. Go ahead and re-open your PR. It's a small task, and you've already started on it. It doesn't matter that much.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843239509/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843314472","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-843314472","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":843314472,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzMxNDQ3Mg==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T16:13:37Z","updated_at":"2021-05-18T16:13:37Z","author_association":"CONTRIBUTOR","body":"Thinking through plugin interfaces and alternative designs, I thought of a very different way compactions could work in Accumulo.  We could have a process (like the manager or compaction coordinator) that continually scans the files in the metadata table looking for compaction work that needs to be done per tablet and gives that to external compaction processes.  Under this model tablet server would have no compaction code at all and there would only be external compactions. The tserver would only need a mechanism to replace a set of files in a tablet to support this model.  I think this is an interesting model to think about, but I am not advocating for it.  It has pluses and minuses over the current model.  The reason I am sharing it is that I think it informs the general discussion about API and SPI interfaces around compaction and supporting alternative designs.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843314472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843404555","html_url":"https://github.com/apache/accumulo/issues/1916#issuecomment-843404555","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1916","id":843404555,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzQwNDU1NQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T17:56:29Z","updated_at":"2021-05-18T17:56:29Z","author_association":"CONTRIBUTOR","body":"> I think this might be a duplicate of #608\r\n\r\nIt is possible but one big difference I noticed is that `SuspendedTabletsIT` does not use Bulk Import. If there is a race condition between the Garbage Collector and Metadata tablet mutations, then it might not make a difference.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843404555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843405758","html_url":"https://github.com/apache/accumulo/pull/2112#issuecomment-843405758","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2112","id":843405758,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzQwNTc1OA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T17:58:28Z","updated_at":"2021-05-18T17:58:28Z","author_association":"MEMBER","body":"GitHub Actions seems to be having issues right now. I checked the build manually and it was fine.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843405758/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843408096","html_url":"https://github.com/apache/accumulo/issues/1916#issuecomment-843408096","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1916","id":843408096,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzQwODA5Ng==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T18:02:16Z","updated_at":"2021-05-18T18:02:16Z","author_association":"MEMBER","body":"> > I think this might be a duplicate of #608\r\n> \r\n> It is possible but one big difference I noticed is that `SuspendedTabletsIT` does not use Bulk Import. If there is a race condition between the Garbage Collector and Metadata tablet mutations, then it might not make a difference.\r\n\r\nI'm not sure it's a race condition with metadata writes. I'm thinking this has something to do with a logic error involving WALs and the garbage collector. In both SuspendedTabletsIT and in #608, there was a tserver failure and WAL recovery.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843408096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843413614","html_url":"https://github.com/apache/accumulo/issues/1916#issuecomment-843413614","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1916","id":843413614,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzQxMzYxNA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T18:11:10Z","updated_at":"2021-05-18T18:11:10Z","author_association":"CONTRIBUTOR","body":"> I'm not sure it's a race condition with metadata writes. I'm thinking this has something to do with a logic error involving WALs and the garbage collector. In both SuspendedTabletsIT and in #608, there was a tserver failure and WAL recovery.\r\n\r\nSo you think its more likely to be another recovery bug? Specifically, a recovery bug when recovering the metadata table? I know this IT used to have issue when crashing a tserver hosting Metadata tablets. If this was fixed in #1888 or if it shows up too infrequently in SuspendedTabletsIT, then perhaps we need another test, specifically for this bug.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843413614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843496960","html_url":"https://github.com/apache/accumulo/issues/1916#issuecomment-843496960","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1916","id":843496960,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MzQ5Njk2MA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-18T19:42:27Z","updated_at":"2021-05-18T19:42:27Z","author_association":"MEMBER","body":"> So you think its more likely to be another recovery bug?\r\n\r\nThat's my suspicion, but I don't have strong evidence for this.\r\n\r\n> Specifically, a recovery bug when recovering the metadata table?\r\n\r\nI don't know about that. It could be a generic recovery bug, and we just tend to notice when it affects the metadata table, because it affects Accumulo behavior, rather than user data.\r\n\r\n> ... perhaps we need another test, specifically for this bug.\r\n\r\nI've only seen this specific issue once. If it is the same as #608, then it's only ever occurred a handful of times to my knowledge. Either way, it seems very hard to reproduce. If we can come up with a test case that reproduces this specific bug, that would excellent progress towards solving it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/843496960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844189220","html_url":"https://github.com/apache/accumulo/pull/2113#issuecomment-844189220","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2113","id":844189220,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDE4OTIyMA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T14:59:41Z","updated_at":"2021-05-19T14:59:41Z","author_association":"CONTRIBUTOR","body":"Errors are showing up in the output of the test but being swallowed by the error handling code in `LogSorter`. The test is currently passing even though errors are being thrown. This change will expose any errors being thrown, most likely causing a test failure.\r\n\r\nI am letting it run once to see the errors. I can then address the errors thrown by tests, either here or in a separate change.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844189220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844219494","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-844219494","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":844219494,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDIxOTQ5NA==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T15:33:09Z","updated_at":"2021-05-19T15:38:54Z","author_association":"CONTRIBUTOR","body":"During one of my basic runs testing this code (two servers, no agitation) I ran into an error in the logs. I did not notice any other issue though and I am not sure if this even interrupted anything. Screen shot below:\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/29436247/118840731-aa326780-b895-11eb-8f4c-20b6ceeab69f.png)\r\n\r\n\r\n<details>\r\n\r\n```\r\njava.lang.IllegalStateException\r\n\tat com.google.common.base.Preconditions.checkState(Preconditions.java:494)\r\n\tat org.apache.accumulo.tserver.tablet.CompactableImpl.commitExternalCompaction(CompactableImpl.java:1055)\r\n\tat org.apache.accumulo.tserver.compactions.CompactionManager.commitExternalCompaction(CompactionManager.java:474)\r\n\tat org.apache.accumulo.tserver.ThriftClientHandler.compactionJobFinished(ThriftClientHandler.java:1705)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.apache.accumulo.core.trace.TraceUtil.lambda$wrapService$6(TraceUtil.java:235)\r\n\tat com.sun.proxy.$Proxy40.compactionJobFinished(Unknown Source)\r\n\tat org.apache.accumulo.core.tabletserver.thrift.TabletClientService$Processor$compactionJobFinished.getResult(TabletClientService.java:4001)\r\n\tat org.apache.accumulo.core.tabletserver.thrift.TabletClientService$Processor$compactionJobFinished.getResult(TabletClientService.java:3982)\r\n\tat org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)\r\n\tat org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)\r\n\tat org.apache.accumulo.server.rpc.TimedProcessor.process(TimedProcessor.java:63)\r\n\tat org.apache.thrift.server.AbstractNonblockingServer$FrameBuffer.invoke(AbstractNonblockingServer.java:518)\r\n\tat org.apache.accumulo.server.rpc.CustomNonBlockingServer$CustomFrameBuffer.invoke(CustomNonBlockingServer.java:114)\r\n\tat org.apache.thrift.server.Invocation.run(Invocation.java:18)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\n\r\n```\r\n</details>\r\n\r\n\r\nOne other feedback I have is the compactor logs can get rather spammy when there are no compactions going on. This fills up the log file and it will eventually get pretty large with it mostly repeating the same information. Screenshot of the particular logs that I am talking about. I am not necessarily sure if this is an issue or not but is something I noticed. \r\n\r\n![image](https://user-images.githubusercontent.com/29436247/118841712-8885b000-b896-11eb-9a66-565ffacb3ed0.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844219494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844224537","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-844224537","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":844224537,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDIyNDUzNw==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T15:39:16Z","updated_at":"2021-05-19T15:39:16Z","author_association":"CONTRIBUTOR","body":"That's in a finally block, line 1055 is:\r\n```\r\nPreconditions.checkState(externalCompactionsCommitting.remove(extCompactionId));\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844224537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844225267","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-844225267","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":844225267,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDIyNTI2Nw==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T15:40:09Z","updated_at":"2021-05-19T15:40:09Z","author_association":"CONTRIBUTOR","body":"@Manno15  wrote:\r\n> This fills up the log file and it will eventually get pretty large with it mostly repeating the same information. Screenshot of the particular logs that I am talking about. I am not necessarily sure if this is an issue or not but is something I noticed.\r\n\r\nYeah, we could probably turn that to debug. No issue there, just chatty","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844225267/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844253910","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-844253910","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":844253910,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDI1MzkxMA==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T16:12:28Z","updated_at":"2021-05-19T16:12:47Z","author_association":"CONTRIBUTOR","body":"One other very minor thing (and I do mean very minor; feel free to ignore this). I noticed with the `CompactionCoordinator` and `CompactionFinalizer` both have filesize and entries parameters but they are in the opposite order as each other. When reading the logs, it would be more consistent if they matched (since they come one after another in the logs). The screenshot below shows the log messages I am referring to.\r\n\r\n![image](https://user-images.githubusercontent.com/29436247/118846534-ce447780-b89a-11eb-81c3-8075ff14c20d.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844253910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844348737","html_url":"https://github.com/apache/accumulo/issues/680#issuecomment-844348737","issue_url":"https://api.github.com/repos/apache/accumulo/issues/680","id":844348737,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDM0ODczNw==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T18:12:23Z","updated_at":"2021-05-19T18:12:23Z","author_association":"MEMBER","body":"Are you suggesting having a method that accepts a table name as its sole parameter?\r\n\r\n> Doing this would probably require also adding client properties for the conditional writer.\r\n\r\nWhat do you think would need to be added?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844348737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844350488","html_url":"https://github.com/apache/accumulo/issues/695#issuecomment-844350488","issue_url":"https://api.github.com/repos/apache/accumulo/issues/695","id":844350488,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDM1MDQ4OA==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T18:14:51Z","updated_at":"2021-05-19T18:14:51Z","author_association":"MEMBER","body":"This may be able to me included as part of #2017 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844350488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844372234","html_url":"https://github.com/apache/accumulo/pull/2096#issuecomment-844372234","issue_url":"https://api.github.com/repos/apache/accumulo/issues/2096","id":844372234,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDM3MjIzNA==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T18:43:30Z","updated_at":"2021-05-19T18:43:30Z","author_association":"CONTRIBUTOR","body":"@Manno15 re the exception you saw.  I am seeing slightly different code that @dlmarion  saw at line 1055.  What commit were you testing with?  Or can you look in the source you built from and see what is at CompactableImpl.java line 1055? I am seeing the following line in the latest commit.\r\n\r\n```java\r\nPreconditions.checkState(!closed);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844372234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844374114","html_url":"https://github.com/apache/accumulo/issues/1091#issuecomment-844374114","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1091","id":844374114,"node_id":"MDEyOklzc3VlQ29tbWVudDg0NDM3NDExNA==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-19T18:45:58Z","updated_at":"2021-05-19T18:45:58Z","author_association":"MEMBER","body":"It also looks like `BatchWriter mbw` could be created within a try-with-resources block seeing how it is autoclosable. Additionally it does seem like the two mentioned if statements could be combined. I see this is an old ticket but you are assigned, @keith-turner. Are you working on this one?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/844374114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]