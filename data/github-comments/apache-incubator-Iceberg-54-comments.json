[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706656018","html_url":"https://github.com/apache/iceberg/pull/1582#issuecomment-706656018","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1582","id":706656018,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY1NjAxOA==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T06:11:49Z","updated_at":"2020-10-11T06:11:49Z","author_association":"CONTRIBUTOR","body":"cc: @guilload","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706656018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706656617","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-706656617","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":706656617,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY1NjYxNw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T06:19:27Z","updated_at":"2020-10-11T06:19:27Z","author_association":"CONTRIBUTOR","body":"cc @shardulm94 for your thoughts on this and whether or not you experience this problem on your local machine.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706656617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706669364","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-706669364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":706669364,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY2OTM2NA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T08:23:51Z","updated_at":"2020-10-11T08:25:48Z","author_association":"CONTRIBUTOR","body":"I spoke to Shardul offline and got confirmation that this test is failing on their local machine as well.\r\n\r\nAdmittedly it's not failing on CI, but it's not the best developer experience in my opinion for anybody who runs `./gradlew clean build` to get a build failure if their local machine isn't configured the same as Travis (which is probably in UTC already).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706669364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706674290","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-706674290","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":706674290,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjY3NDI5MA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T09:08:51Z","updated_at":"2020-10-11T09:08:51Z","author_association":"CONTRIBUTOR","body":"hi,@rdblue:\r\nI don't know much about the original design idea of flink, I just talk about my views.\r\n\r\nIn order to use Hadoop features (such as deploying flink to yarn cluster), flink needs to load the classpath of hadoop, but hive is not necessary for flink to deploy, so there is no need to load hive when loading the Hadoop Configuration.\r\n\r\nIn addition, flink provides a unified catalog api to access external systems. Hivecatlog, jdbccatalog, etc. are all sub class used to access different external systems, so hive is not a plugin or extension of flink. Therefore, we cannot load hive into the startup script of flink when flink is started.\r\n\r\nI don't know if my understanding is correct. @JingsongLi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706674290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706755185","html_url":"https://github.com/apache/iceberg/pull/1473#issuecomment-706755185","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1473","id":706755185,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjc1NTE4NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T19:21:26Z","updated_at":"2020-10-11T19:21:26Z","author_association":"CONTRIBUTOR","body":"Alright, this PR passes all tests (caching is solved) and is ready to be split into smaller PRs. Let's do this after 0.10.0 is out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706755185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706771662","html_url":"https://github.com/apache/iceberg/issues/1383#issuecomment-706771662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1383","id":706771662,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjc3MTY2Mg==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-11T21:36:09Z","updated_at":"2020-10-11T21:36:09Z","author_association":"CONTRIBUTOR","body":"regarding `TableScan.appendsBetween`, we might need more flexibility of fine-grained control. E.g. if Flink job is lagging behind or bootstrap from an old snapshot, we probably don't want to eagerly plan all the unconsumed `FileScanTask`. That might blow up Flink checkpoint state if the enumerated list of `FileScanTask` is too big.\r\n\r\nI am thinking about two level of enumerations to keep the enumerator memory footprint in check.\r\n* first, enumerate the list of unconsumed `DataOperations.APPEND` snapshots. It is cheap to track and checkpoint this list\r\n* second, enumerate `FileScanTask` up to a configurable number of oldest snapshots (e.g. 6)  from the first step\r\n\r\nif job is keeping up with the ingestion, we should only have one unconsumed snapshots.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706771662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706843073","html_url":"https://github.com/apache/iceberg/issues/1584#issuecomment-706843073","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1584","id":706843073,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjg0MzA3Mw==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T03:55:36Z","updated_at":"2020-10-12T03:55:36Z","author_association":"CONTRIBUTOR","body":"Could you please post the error message? Looks like Orc 1.6.5 is released and available in maven central.\r\nhttps://search.maven.org/artifact/org.apache.orc/orc/1.6.5/pom\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706843073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706843663","html_url":"https://github.com/apache/iceberg/issues/1584#issuecomment-706843663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1584","id":706843663,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjg0MzY2Mw==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T03:58:02Z","updated_at":"2020-10-12T03:58:02Z","author_association":"NONE","body":"cc @HeartSaVioR ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706843663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706845534","html_url":"https://github.com/apache/iceberg/issues/1584#issuecomment-706845534","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1584","id":706845534,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjg0NTUzNA==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T04:05:39Z","updated_at":"2020-10-12T04:05:39Z","author_association":"NONE","body":"The issue is about my firewall and will be closed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706845534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706845748","html_url":"https://github.com/apache/iceberg/issues/1567#issuecomment-706845748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1567","id":706845748,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjg0NTc0OA==","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T04:06:33Z","updated_at":"2020-10-12T04:06:33Z","author_association":"CONTRIBUTOR","body":"@rdblue Hi Ryan, thanks for pointing out to use GuavaClasses, I've misunderstood what bundled-guava does. I will close the related pr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706845748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706897305","html_url":"https://github.com/apache/iceberg/pull/1515#issuecomment-706897305","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1515","id":706897305,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjg5NzMwNQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T06:26:21Z","updated_at":"2020-10-12T06:26:21Z","author_association":"MEMBER","body":"@simonsssu  would you think it's worth to get this in iceberg release 0.10.0 ?  If sure, then we may need to get this merged as soon as possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706897305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706903222","html_url":"https://github.com/apache/iceberg/pull/1515#issuecomment-706903222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1515","id":706903222,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjkwMzIyMg==","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T06:37:04Z","updated_at":"2020-10-12T06:37:04Z","author_association":"CONTRIBUTOR","body":"I think it's not high priority because in most cases we need Exactly-once semantics,  but I will still update the modification asap. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706903222/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706948642","html_url":"https://github.com/apache/iceberg/pull/1477#issuecomment-706948642","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1477","id":706948642,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjk0ODY0Mg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T07:57:46Z","updated_at":"2020-10-12T07:57:46Z","author_association":"MEMBER","body":"Full unit tests are provided,  so it's OK to mark this PR to be reviewing now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706948642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706978779","html_url":"https://github.com/apache/iceberg/issues/1383#issuecomment-706978779","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1383","id":706978779,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjk3ODc3OQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T08:49:56Z","updated_at":"2020-10-12T08:49:56Z","author_association":"MEMBER","body":"> That might blow up Flink checkpoint state if the enumerated list of FileScanTask is too big.\r\n\r\n@stevenzwu ,  what is the maximum size of a table in your production environment ?  I'm thinking whether it's worth to implement the two-phase enumerators in the first version. \r\n\r\nIf we have 1PB data and each file have the size 128MB, then it will have 8388608 files.  If every `FileScanTask` consume 1KB , then its state is ~ 8GB.  That should be acceptable for the flink state backend.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706978779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706990024","html_url":"https://github.com/apache/iceberg/pull/1559#issuecomment-706990024","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1559","id":706990024,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjk5MDAyNA==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T09:09:26Z","updated_at":"2020-10-12T09:09:26Z","author_association":"CONTRIBUTOR","body":"@rdblue When you have some time, could you please review my change? Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706990024/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706998170","html_url":"https://github.com/apache/iceberg/issues/1383#issuecomment-706998170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1383","id":706998170,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjk5ODE3MA==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T09:22:54Z","updated_at":"2020-10-12T09:22:54Z","author_association":"CONTRIBUTOR","body":"Hi @stevenzwu , about `TableScan.appendsBetween`, we can limit the snapshot number of scan, even scan only one at a time. Because `TableScan.appendsBetween` seems to be just a combination of single incremental snapshots, we can handle only one snapshot at a time.\r\n\r\n- For FLIP-27 Source, it is easy to do, because tasks came to ask for splits, the only problem is that within the coordinator, the coordinator can completely control how the splits are generated.\r\n- For the old API, the downstream reading operator should has a max split queue size to back pressure the Enumerator. And do above thing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/706998170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707074548","html_url":"https://github.com/apache/iceberg/pull/1564#issuecomment-707074548","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1564","id":707074548,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzA3NDU0OA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T11:55:28Z","updated_at":"2020-10-12T11:55:28Z","author_association":"CONTRIBUTOR","body":"@HotSushi: Quick question: How do we populate the data in the configuration?\r\nWe found the same issue with @rdblue during the reviews of #1495, and the solution there was to use the serDeProperties to carry over the data to the Mappers. With Hive HiveIcebergStorageHandler.configureInputJobProperties() will allow us to automatically add the schema to the properties. I am not sure how we can do this if we want this info travel in the configuration object.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707074548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707097927","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-707097927","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":707097927,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzA5NzkyNw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T12:45:24Z","updated_at":"2020-10-12T12:45:24Z","author_association":"MEMBER","body":"> Can you help me understand Flink's behavior a bit more?\r\n\r\n@rdblue , you may want to read this flink [document](https://ci.apache.org/projects/flink/flink-docs-release-1.11/ops/deployment/#application-mode).   There's a `application mode` in flink,  means  users could just upload the `iceberg-flink-runtime.jar` to HDFS, and then start the command like the following: \r\n\r\n```\r\nbin/flink run-application -p 5 \\\r\n-d \\\r\n-t yarn-application \\\r\n-yD yarn.provided.lib.dirs=\"hdfs://hadoopcluster/data/flink/libs/\" \\\r\nhdfs://hadoopcluster/data/flink/user-lib/flink-kafka-iceberg.jar\r\n```\r\n\r\nit will bootstrap a separate flink cluster on yarn for the current submission, and the started flink jobmanager will execute the `main()` entry from the user-provided jar.  In that case,  the classpath or environment  inside yarn container should not be  modifiable by the user-provided jar. \r\n\r\nProviding a flink  config key to indicate the hive-site URI  sounds good to me.  then we could submit the flink job in application mode like following: \r\n\r\n```\r\nbin/flink run-application -p 5 \\\r\n-d \\\r\n-t yarn-application \\\r\n-D iceberg.hive-site.path=hdfs://config/hive-site.xml \\\r\n-yD yarn.provided.lib.dirs=\"hdfs://hadoopcluster/data/flink/libs/\" \\\r\nhdfs://hadoopcluster/data/flink/user-lib/flink-kafka-iceberg.jar\r\n```\r\n\r\nAbove we are talking about a Flink Datastream job. For Flink SQL job,  we could do the similar thing like `HiveCatalog` in flink: \r\n\r\n```sql\r\nCREATE CATALOG hive_catalog WITH (\r\n  'type'='iceberg',\r\n  'catalog-type'='hive',\r\n  'uri'='thrift://localhost:9083',\r\n  'clients'='5',\r\n  'property-version'='1',\r\n  'hive-conf-dir'='hdfs://config/hive-site.xml '\r\n);\r\n```\r\n\r\nFor most cases,  we could just set the `warehouse` instead of specifying a hive-conf-dir as Ryan suggest: \r\n\r\n```sql\r\nCREATE CATALOG hive_catalog WITH (\r\n  'type'='iceberg',\r\n  'catalog-type'='hive',\r\n  'uri'='thrift://localhost:9083',\r\n  'clients'='5',\r\n  'property-version'='1',\r\n  'warehouse'='hdfs://data-dir '\r\n);\r\n```\r\n\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707097927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707112103","html_url":"https://github.com/apache/iceberg/issues/1437#issuecomment-707112103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1437","id":707112103,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzExMjEwMw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T13:13:08Z","updated_at":"2020-10-12T14:09:33Z","author_association":"MEMBER","body":"I think this [comment](https://github.com/apache/iceberg/pull/1558#issuecomment-707097927) is the right direction to resolve this issue, will create a pull request for it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707112103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707115848","html_url":"https://github.com/apache/iceberg/pull/1573#issuecomment-707115848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1573","id":707115848,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzExNTg0OA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T13:19:59Z","updated_at":"2020-10-12T13:19:59Z","author_association":"CONTRIBUTOR","body":"I haven't look into details (and I'm novice for AWS env.) but just wanted to check: does this address #1398? I see @rdblue said \"our S3 file system ... avoided this\" and I'm curious whether this is the S3 file system implementation mentioned before, or another one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707115848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707131212","html_url":"https://github.com/apache/iceberg/pull/1570#issuecomment-707131212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1570","id":707131212,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzEzMTIxMg==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T13:48:15Z","updated_at":"2020-10-12T13:48:15Z","author_association":"COLLABORATOR","body":"@rdblue makes sense to add Avro tests as well, I guess I was just focusing too much on ORC this time around :) https://github.com/apache/iceberg/pull/1585 \r\nthanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707131212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707164336","html_url":"https://github.com/apache/iceberg/pull/1522#issuecomment-707164336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1522","id":707164336,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzE2NDMzNg==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T14:44:44Z","updated_at":"2020-10-12T15:47:56Z","author_association":"COLLABORATOR","body":"I executed some spark jmh cases with `NUM_RECORDS = 5000000` (I didn't use `10000000` in current code, because that causes OOM on my machine with jmh jvmArgs=-Xmx4096m, not sure how we passed before.), the results are shown as following:\r\n\r\nwhen not reuse the container\r\n```\r\nBenchmark                                                                          Mode  Cnt  Score   Error  Units\r\nSparkParquetReadersNestedDataBenchmark.readUsingIcebergReader                        ss    5  2.801 ?0.089   s/op\r\nSparkParquetReadersNestedDataBenchmark.readUsingIcebergReaderUnsafe                  ss    5  3.383 ?0.090   s/op\r\nSparkParquetReadersNestedDataBenchmark.readUsingSparkReader                          ss    5  4.353 ?0.162   s/op\r\nSparkParquetReadersNestedDataBenchmark.readWithProjectionUsingIcebergReader          ss    5  1.488 ?0.051   s/op\r\nSparkParquetReadersNestedDataBenchmark.readWithProjectionUsingIcebergReaderUnsafe    ss    5  1.886 ?0.250   s/op\r\nSparkParquetReadersNestedDataBenchmark.readWithProjectionUsingSparkReader            ss    5  2.078 ?0.227   s/op\r\n```\r\n\r\nWhen reusing the container\r\n```\r\nBenchmark                                                                          Mode  Cnt  Score   Error  Units\r\nSparkParquetReadersNestedDataBenchmark.readUsingIcebergReader                        ss    5  2.707 ?0.053   s/op\r\nSparkParquetReadersNestedDataBenchmark.readUsingIcebergReaderUnsafe                  ss    5  3.149 ?0.144   s/op\r\nSparkParquetReadersNestedDataBenchmark.readUsingSparkReader                          ss    5  4.344 ?0.168   s/op\r\nSparkParquetReadersNestedDataBenchmark.readWithProjectionUsingIcebergReader          ss    5  1.360 ?0.155   s/op\r\nSparkParquetReadersNestedDataBenchmark.readWithProjectionUsingIcebergReaderUnsafe    ss    5  1.863 ?0.180   s/op\r\nSparkParquetReadersNestedDataBenchmark.readWithProjectionUsingSparkReader            ss    5  2.072 ?0.147   s/op\r\n```\r\n\r\nIt shows slight benefit when reusing the container. @rdblue, Does that make sense for spark side change? I will try to write some jmh benchmark for Flink input format and try it again.\r\n\r\nPlus I found two issues:\r\n1. The jmh benchmarks were moved to spark2 module while the comments haven't updated. \r\n2. The jmh benchmarks cases throw an exception like below:\r\n```\r\norg.apache.iceberg.exceptions.AlreadyExistsException: File already exists: /tmp/parquet-nested-data-benchmark3999980592702894424.parquet\r\n        at org.apache.iceberg.Files$LocalOutputFile.create(Files.java:58)\r\n        at org.apache.iceberg.parquet.ParquetIO$ParquetOutputFile.create(ParquetIO.java:148)\r\n        at org.apache.parquet.hadoop.ParquetFileWriter.<init>(ParquetFileWriter.java:295)\r\n        at org.apache.parquet.hadoop.ParquetWriter.<init>(ParquetWriter.java:283)\r\n        at org.apache.parquet.hadoop.ParquetWriter$Builder.build(ParquetWriter.java:564)\r\n        at org.apache.iceberg.parquet.Parquet$WriteBuilder.build(Parquet.java:265)\r\n        at org.apache.iceberg.spark.data.parquet.SparkParquetReadersNestedDataBenchmark.setupBenchmark(SparkParquetReadersNestedDataBenchmark.java:102)\r\n        at org.apache.iceberg.spark.data.parquet.generated.SparkParquetReadersNestedDataBenchmark_readUsingSparkReader_jmhTest._jmh_tryInit_f_sparkparquetreadersnesteddatabenchmark0_G(SparkParquetReadersNestedDataBenchmark_readUsingSparkReader_jmhTest.java:438)\r\n        at org.apache.iceberg.spark.data.parquet.generated.SparkParquetReadersNestedDataBenchmark_readUsingSparkReader_jmhTest.readUsingSparkReader_SingleShotTime(SparkParquetReadersNestedDataBenchmark_readUsingSparkReader_jmhTest.java:363)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.openjdk.jmh.runner.BenchmarkHandler$BenchmarkTask.call(BenchmarkHandler.java:453)\r\n        at org.openjdk.jmh.runner.BenchmarkHandler$BenchmarkTask.call(BenchmarkHandler.java:437)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\nWe need to delete the created temp file at first. \r\n\r\nI will fix found issues tmr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707164336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707196165","html_url":"https://github.com/apache/iceberg/pull/1356#issuecomment-707196165","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1356","id":707196165,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzE5NjE2NQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T15:41:02Z","updated_at":"2020-10-12T15:41:02Z","author_association":"COLLABORATOR","body":"@rdblue , Do we want to include this to 0.10.0? This includes an optimization that avoids reading extra footer in case of no position column. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707196165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707213626","html_url":"https://github.com/apache/iceberg/pull/1573#issuecomment-707213626","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1573","id":707213626,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzIxMzYyNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T16:13:14Z","updated_at":"2020-10-12T16:13:14Z","author_association":"CONTRIBUTOR","body":"@HeartSaVioR, this would fix that problem because overwrite will simply put the file, rather than checking to see what the path is first. That is the same approach that we use in our S3 file system, but we primarily use HadoopFileIO with a custom S3 file system, rather than a FileIO built for S3 because we've been using the FS for a long time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707213626/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707222919","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707222919","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707222919,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzIyMjkxOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T16:30:57Z","updated_at":"2020-10-12T16:33:12Z","author_association":"CONTRIBUTOR","body":"The problem here is that `HiveIcebergFilterFactory.daysFromDate` calls `date.toLocalDate`, which is zone-dependent. So although we set the underlying date value correctly, it is corrupted by calling `toLocalDate`. We need to fix that method to translate correctly.\r\n\r\nThis fixes it for me:\r\n```java\r\n  private static int daysFromDate(Date date) {\r\n    return DateTimeUtil.daysFromInstant(Instant.ofEpochMilli(date.getTime()));\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707222919/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707225772","html_url":"https://github.com/apache/iceberg/issues/1383#issuecomment-707225772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1383","id":707225772,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzIyNTc3Mg==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T16:36:46Z","updated_at":"2020-10-13T01:23:16Z","author_association":"CONTRIBUTOR","body":"I was mainly discussing in the context of FLIP-27 source. Regardless how we implement the enumeration, there are two pieces of info that enumerator needs to track and checkpoint.\r\n\r\n1. last snapshot where enumeration/planning is done\r\n2. pending/unprocessed splits from previous discoveries/plannings\r\n\r\nI was mainly concerned about the state size for the latter. That is where I was referring to throttle the eagerness of planned splits. I was thinking about using `TableScan.useSnapshot(long snapshotId)` so that we can control how many snapshots we plan the splits into state. \r\n\r\nHere are some additional benefits of enumerating splits snapshot by snapshot.\r\n* We can track and assign splits snapshot by snapshot in the same order as they were committed\r\n* We can publish metrics like the number of pending snapshots, lag (current time - oldest timestamp from uncompleted snapshot), etc.\r\n\r\n@openinx note that this is not keyed state where state is distributed among parallel tasks. Here, 8 GB operator state can be problematic enumerator state. I vaguely remember RocksDB can't handle a list larger than 1 GB. the bigger the list, the slower it gets. also if we do `planTasks` (vs `planFiles`), the number of splits can be a few times bigger. I can definitely buy the point of starting with sth simple, and optimize it later. It will be an internal change to the enumerator. So it has no user impact. \r\n\r\n@JingsongLi  Yeah, the key thing is how coordinator/enumerator controls how the splits are generated. I was saying that we may need some control/throttling there to avoid eagerly enumerate all pending snapshots so that the checkpointed split list is manageable/capped. I thought the idea `TableScan.appendsBetween` was to run `planFiles` or `planTasks` between last planned snapshot and the latest table snapshot. that is what I was referring earlier as eager discovery/planning of all unconsumed splits. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707225772/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707244037","html_url":"https://github.com/apache/iceberg/pull/1522#issuecomment-707244037","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1522","id":707244037,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzI0NDAzNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T17:14:32Z","updated_at":"2020-10-12T17:14:32Z","author_association":"CONTRIBUTOR","body":"Thanks for running the benchmarks, @chenjunjiedada! I think it looks like we should commit this. @aokolnychyi, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707244037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707247165","html_url":"https://github.com/apache/iceberg/pull/1565#issuecomment-707247165","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1565","id":707247165,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzI0NzE2NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T17:21:15Z","updated_at":"2020-10-12T17:21:15Z","author_association":"CONTRIBUTOR","body":"I think this is ready, but @openinx will probably want to have a look at the answer to his question about a test for `HiveTableLoader` so I'll wait for him to merge. Thanks, @JingsongLi!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707247165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707247914","html_url":"https://github.com/apache/iceberg/pull/1580#issuecomment-707247914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1580","id":707247914,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzI0NzkxNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T17:22:59Z","updated_at":"2020-10-12T17:22:59Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707247914/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707248445","html_url":"https://github.com/apache/iceberg/pull/1576#issuecomment-707248445","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1576","id":707248445,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzI0ODQ0NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T17:24:12Z","updated_at":"2020-10-12T17:24:12Z","author_association":"CONTRIBUTOR","body":"I think I like the idea to add a CATALOG tag and apply it to all of our catalog implementation modules. Since one for Nessie has been added, that probably makes more sense than a METASTORE tag that applies mainly to Hive.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707248445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707248979","html_url":"https://github.com/apache/iceberg/pull/1585#issuecomment-707248979","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1585","id":707248979,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzI0ODk3OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T17:25:24Z","updated_at":"2020-10-12T17:25:24Z","author_association":"CONTRIBUTOR","body":"Thanks, @marton-bod!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707248979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707252782","html_url":"https://github.com/apache/iceberg/pull/1569#issuecomment-707252782","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1569","id":707252782,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzI1Mjc4Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T17:33:27Z","updated_at":"2020-10-12T17:33:27Z","author_association":"CONTRIBUTOR","body":"Looks great, thank you for fixing this, @zhangdove!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707252782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707255168","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-707255168","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":707255168,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzI1NTE2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T17:36:19Z","updated_at":"2020-10-12T17:36:19Z","author_association":"CONTRIBUTOR","body":"Thanks for opening this PR, @shangxinli! I'll take a look at this soon. It's great to see you have it working.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707255168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707255509","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-707255509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":707255509,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzI1NTUwOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T17:37:06Z","updated_at":"2020-10-12T17:37:06Z","author_association":"CONTRIBUTOR","body":"FYI @aokolnychyi, @prodeezy: this PR adds support for page-level skipping in Parquet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707255509/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707296047","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707296047","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707296047,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzI5NjA0Nw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T19:07:36Z","updated_at":"2020-10-12T19:07:36Z","author_association":"CONTRIBUTOR","body":"Cool. I can push a fix using your change after work today 👍 . @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707296047/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707336690","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707336690","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707336690,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzMzNjY5MA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T20:44:18Z","updated_at":"2020-10-12T20:44:18Z","author_association":"CONTRIBUTOR","body":"Ok. I reverted the unit test changes and updated the code. So it seems to be passing for me now too.\r\n\r\nHowever, when I run this, the value of `gmtDate` is still `2015-11-11` if I print it right after it's created.\r\n\r\nThe values now for expected and actual are both 16751. I also printed out the Date value generated in `leafToLiteral` and it is also `2015-11-11`.\r\n\r\n Is this expected due to the use of exclusive bounds or something?\r\n\r\n```\r\ngmtDate:2015-11-11\r\nThe constant date is 2015-11-11\r\nThe date in leafToLiteral using daysFromDate is 16751\r\nexpected:ref(name=\"date\") == 16751\r\nactual:ref(name=\"date\") == 16751\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707336690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707347685","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707347685","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707347685,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM0NzY4NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T21:11:00Z","updated_at":"2020-10-12T21:11:00Z","author_association":"CONTRIBUTOR","body":"The toString representation from Date is in the local zone. I don't think that it matters what the toString shows, as long as the actual value it gets converted to for Iceberg is correct. That's because Hive is responsible for translating \"2020-11-12\" into a Date however it chooses, but Iceberg should always use the date of the instant in UTC.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707347685/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707370706","html_url":"https://github.com/apache/iceberg/pull/1573#issuecomment-707370706","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1573","id":707370706,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM3MDcwNg==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T22:10:39Z","updated_at":"2020-10-12T22:10:39Z","author_association":"CONTRIBUTOR","body":"Ah OK, you're having custom \"file system\" implementation for S3. Thanks for explanation and happy to see this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707370706/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707375751","html_url":"https://github.com/apache/iceberg/pull/1515#issuecomment-707375751","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1515","id":707375751,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM3NTc1MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T22:25:44Z","updated_at":"2020-10-12T22:25:44Z","author_association":"CONTRIBUTOR","body":"I think it would make sense to get a configuration check into 0.10.0 to ensure that users don't configure the sink without checkpointing. That could cause users to lose data.\r\n\r\nBefore we commit this feature, though, I think we need to think through it a bit more. Is at-most-once a normal guarantee for Flink? Other systems I've seen typically guarantee at-least-once.\r\n\r\nAlso, is there a way to recover the state of the incoming stream from Iceberg commit metadata? For example, what if data files are sent to the committer with the partition offsets that have been processed by the writer for the given task? Then a streaming job could recover by finding the last streaming commit and reconstructing the offsets for all partitions from metadata.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707375751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707382892","html_url":"https://github.com/apache/iceberg/issues/1578#issuecomment-707382892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1578","id":707382892,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM4Mjg5Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T22:47:51Z","updated_at":"2020-10-12T22:47:51Z","author_association":"CONTRIBUTOR","body":"If you needed to register a logical type, then you must be using Avro's `DatumReader` instead of an Iceberg `DatumReader`. Iceberg has a set of readers for objection construction that produce Avro generics that are used by internals, in `GenericAvroReader`.\r\n\r\nI think this is also used by default for `IcebergDecoder` and `IcebergEncoder`, which use Iceberg schemas and write Avro's single-message encoding.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707382892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707383279","html_url":"https://github.com/apache/iceberg/issues/1589#issuecomment-707383279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1589","id":707383279,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM4MzI3OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T22:49:16Z","updated_at":"2020-10-12T22:49:16Z","author_association":"CONTRIBUTOR","body":"This one is on me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707383279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707386346","html_url":"https://github.com/apache/iceberg/issues/1590#issuecomment-707386346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1590","id":707386346,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM4NjM0Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T22:58:59Z","updated_at":"2020-10-12T22:58:59Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer is working on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707386346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707388311","html_url":"https://github.com/apache/iceberg/issues/1591#issuecomment-707388311","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1591","id":707388311,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM4ODMxMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:05:31Z","updated_at":"2020-10-12T23:05:31Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer is looking into that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707388311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707389421","html_url":"https://github.com/apache/iceberg/issues/1592#issuecomment-707389421","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1592","id":707389421,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM4OTQyMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:09:15Z","updated_at":"2020-10-12T23:09:15Z","author_association":"CONTRIBUTOR","body":"This one is on me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707389421/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707389780","html_url":"https://github.com/apache/iceberg/issues/1593#issuecomment-707389780","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1593","id":707389780,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM4OTc4MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:10:29Z","updated_at":"2020-10-12T23:10:29Z","author_association":"CONTRIBUTOR","body":"This one is on me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707389780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707391474","html_url":"https://github.com/apache/iceberg/issues/1596#issuecomment-707391474","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1596","id":707391474,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5MTQ3NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:15:55Z","updated_at":"2020-10-12T23:15:55Z","author_association":"CONTRIBUTOR","body":"This one is on me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707391474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707391593","html_url":"https://github.com/apache/iceberg/issues/1595#issuecomment-707391593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1595","id":707391593,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5MTU5Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:16:19Z","updated_at":"2020-10-12T23:16:19Z","author_association":"CONTRIBUTOR","body":"This one is on me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707391593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707391630","html_url":"https://github.com/apache/iceberg/issues/1594#issuecomment-707391630","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1594","id":707391630,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5MTYzMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:16:26Z","updated_at":"2020-10-12T23:16:26Z","author_association":"CONTRIBUTOR","body":"This one is on me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707391630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707392683","html_url":"https://github.com/apache/iceberg/issues/1597#issuecomment-707392683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1597","id":707392683,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5MjY4Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:19:51Z","updated_at":"2020-10-12T23:19:51Z","author_association":"CONTRIBUTOR","body":"@liukun4515 has expressed interest in working on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707392683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707398116","html_url":"https://github.com/apache/iceberg/issues/1598#issuecomment-707398116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1598","id":707398116,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5ODExNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:39:04Z","updated_at":"2020-10-12T23:39:04Z","author_association":"CONTRIBUTOR","body":"I have a prototype for this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707398116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707399280","html_url":"https://github.com/apache/iceberg/issues/1599#issuecomment-707399280","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1599","id":707399280,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzM5OTI4MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-12T23:43:43Z","updated_at":"2020-10-12T23:43:43Z","author_association":"CONTRIBUTOR","body":"Let me know if anybody is interested in working on this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707399280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707409069","html_url":"https://github.com/apache/iceberg/issues/1599#issuecomment-707409069","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1599","id":707409069,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQwOTA2OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T00:13:18Z","updated_at":"2020-10-13T00:13:18Z","author_association":"MEMBER","body":"@jbirtman You may want to check this out, once the Procedure API is finalized this should be a pretty straightforward task","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707409069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707430532","html_url":"https://github.com/apache/iceberg/issues/1589#issuecomment-707430532","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1589","id":707430532,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQzMDUzMg==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T01:34:50Z","updated_at":"2020-10-13T01:34:50Z","author_association":"CONTRIBUTOR","body":"I think we should extract some common functions when designing the code, because we should also do flink sql extension in the future","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707430532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707435392","html_url":"https://github.com/apache/iceberg/issues/1488#issuecomment-707435392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1488","id":707435392,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQzNTM5Mg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T01:53:46Z","updated_at":"2020-10-13T01:53:46Z","author_association":"CONTRIBUTOR","body":"I got another one of those Broken Pipe ones in CI.\r\n\r\nHere are the CI logs: https://travis-ci.org/github/apache/iceberg/builds/735138861","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707435392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707436205","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707436205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707436205,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQzNjIwNQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T01:56:41Z","updated_at":"2020-10-13T02:32:46Z","author_association":"CONTRIBUTOR","body":"The CI failed for Java 8 a transient HMS connection issue similar to this one. I've gotten these intermittently on my local for a while now, but have never had them on CI until now. Now I can't seem to get them to be stable and pass, though they pass locally.\r\n\r\n```\r\norg.apache.iceberg.mr.hive.TestHiveIcebergStorageHandlerWithHiveCatalog > testJoinTablesParquet FAILED\r\n    java.lang.IllegalArgumentException: Failed to executeQuery Hive query SHOW TABLES: Error while compiling statement: FAILED: SemanticException org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n        Caused by:\r\n        org.apache.hive.service.cli.HiveSQLException: Error while compiling statement: FAILED: SemanticException org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n            Caused by:\r\n            org.apache.hadoop.hive.ql.parse.SemanticException: org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n                Caused by:\r\n                org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n                    Caused by:\r\n                    org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n                        Caused by:\r\n                        java.net.SocketException: Broken pipe (Write failed)\r\n    org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n        Caused by:\r\n        org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n            Caused by:\r\n            java.net.SocketException: Broken pipe (Write failed)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707436205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707436520","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-707436520","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":707436520,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQzNjUyMA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T01:57:40Z","updated_at":"2020-10-13T01:57:40Z","author_association":"CONTRIBUTOR","body":"hi,@rdblue,@openinx:\r\nI add a warehouse for hivecatalog (flink,spark),If the user provides a warehouse, it will overwrite the value in hive-site.xml，\r\ncould you help review it again ? thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707436520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707440720","html_url":"https://github.com/apache/iceberg/issues/1383#issuecomment-707440720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1383","id":707440720,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ0MDcyMA==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T02:12:14Z","updated_at":"2020-10-13T02:12:14Z","author_association":"CONTRIBUTOR","body":"NIT: I think we still need use `appendsBetween(snapshot-1, snapshot)` since we want to get incremental data.\r\nTrue, I think this is easy to do.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707440720/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707441290","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707441290","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707441290,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ0MTI5MA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T02:14:17Z","updated_at":"2020-10-13T02:14:17Z","author_association":"CONTRIBUTOR","body":"> The toString representation from Date is in the local zone. I don't think that it matters what the toString shows, as long as the actual value it gets converted to for Iceberg is correct. That's because Hive is responsible for translating \"2020-11-12\" into a Date however it chooses, but Iceberg should always use the date of the instant in UTC.\r\n\r\nGood point. Been a while since I've debug printed a Date manually like that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707441290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707444552","html_url":"https://github.com/apache/iceberg/pull/1558#issuecomment-707444552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1558","id":707444552,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ0NDU1Mg==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T02:26:05Z","updated_at":"2020-10-13T02:26:05Z","author_association":"CONTRIBUTOR","body":"> > From hiveConfDir, it should be URI which contains scheme and full path. This means it can be loaded by Hadoop Filesystem.\r\n> \r\n> Can you help me understand Flink's behavior a bit more?\r\n> \r\n> * If `hiveConfDir` is a Flink option, then why doesn't Flink automatically load the `hive-site.xml` file when it creates a `Configuration`? It doesn't seem like this should be delegated to libraries that run inside Flink. I would expect Flink to create the `Configuration` based on application options and pass that to libraries.\r\n> * If Flink allows the user to set a separate `hiveConfDir`, why is that not just add that directory to the classpath so that `hive-site.xml` can be loaded like normal? That's what happens in most Hadoop setup scripts: extra config folders are added to the classpath so that the regular method of loading config files works.\r\n\r\nWhy not automatically load the `hive-site.xml` file when it creates a `Configuration`?\r\nFlink just want to get Hadoop Configuration for connecting Yarn and reading HDFS.\r\nThe hive connector is only an optional connector of Flink, it is not built-in, so the read of built-in Hadoop config will not process hive configuration (hive-site.xml). And the `hiveConfDir` is in Hive connector, it should be called explicitly.\r\n\r\nWhy is that not just add that directory to the classpath so that `hive-site.xml` can be loaded like normal?\r\nNow, the only way is system env, just like:\r\n```\r\nString hadoopHome = System.getenv(\"HADOOP_HOME\");\r\nif (hadoopHome != null) {\r\n  loadConfs(hadoopHome + \"/conf\");\r\n  loadConfs(hadoopHome + \"/etc/hadoop\");\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707444552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707445254","html_url":"https://github.com/apache/iceberg/pull/1515#issuecomment-707445254","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1515","id":707445254,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ0NTI1NA==","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T02:28:31Z","updated_at":"2020-10-13T06:32:11Z","author_association":"CONTRIBUTOR","body":"@rdblue Hi Ryan, It's a good suggestion, maybe we need another PR to add the configuration check for Iceberg Sink without checkpoint. \r\nI think for most Flink cases, if we don't enable checkpoint, it was at-most-once guarantee because it will lost the state generated during job failover, unless we manually read data from beginning. So when using Flink Iceberg Sink in most production cases I think it's better to enable checkpoint.  \r\nCurrently we recover the state with a list of DataFiles, which are persisted by Committer.  Your ideas is to  make IcebergWriter to recover the state by finding the last successful commit , am I right ?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707445254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707455716","html_url":"https://github.com/apache/iceberg/issues/1597#issuecomment-707455716","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1597","id":707455716,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ1NTcxNg==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T03:08:42Z","updated_at":"2020-10-13T03:15:39Z","author_association":"NONE","body":"@aokolnychyi \r\n```\r\nCALL catalog.schema.expire_snapshots(\r\n  namespace => 'namespace_name',\r\n  table => 'table_name',\r\n  retain_last => 100\r\n)\r\n```\r\nIn the `expire snapshot` API, if we only give the `retain last num` for a table, the commit action is invalid.\r\n\r\nthe apply code is:\r\n```\r\n  private TableMetadata internalApply() {\r\n    this.base = ops.refresh();\r\n\r\n    TableMetadata updateMeta = base.removeSnapshotsIf(snapshot ->\r\n        idsToRemove.contains(snapshot.snapshotId()) ||\r\n        (expireOlderThan != null && snapshot.timestampMillis() < expireOlderThan &&\r\n            !idsToRetain.contains(snapshot.snapshotId())));\r\n    List<Snapshot> updateSnapshots = updateMeta.snapshots();\r\n    List<Snapshot> baseSnapshots = base.snapshots();\r\n    return updateSnapshots.size() != baseSnapshots.size() ? updateMeta : base;\r\n  }\r\n```\r\nif the `expireOlderThan` is not set(`expireOlderThan` is null), the `retain last num` or `idsToRetain` is invalid.\r\n\r\nSo I think the  `expireOlderThan` or `older_than ` is required, or default value for the `older_than` parameter.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707455716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707456979","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707456979","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707456979,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ1Njk3OQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T03:12:57Z","updated_at":"2020-10-13T03:16:48Z","author_association":"CONTRIBUTOR","body":"I added a bunch of temporary commits and finally got CI to work, but then reset hard back to the old spot and now it shows as failing again.\r\n\r\nHere's the CI run when it did pass: https://travis-ci.org/github/apache/iceberg/builds/735230278\r\n\r\nI think upping the ulimit when running the tests might possibly help? Hard for me to say without being able to access the travis configuration (I'm not even sure my adding `ulimit -n 3000` in a `before_script` block had any effect because I can't quite see it).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707456979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707458773","html_url":"https://github.com/apache/iceberg/issues/1599#issuecomment-707458773","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1599","id":707458773,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ1ODc3Mw==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T03:18:45Z","updated_at":"2020-10-13T03:19:18Z","author_association":"NONE","body":"> Let me know if anybody is interested in working on this.\r\n\r\nCan I take this task? \r\n@aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707458773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707460126","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707460126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707460126,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ2MDEyNg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T03:23:06Z","updated_at":"2020-10-13T03:23:06Z","author_association":"CONTRIBUTOR","body":"I think this might be why it's failing: https://github.com/apache/iceberg/pull/1585 \r\n\r\nThe update to the test memory in that PR is possibly not in my branch.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707460126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707465328","html_url":"https://github.com/apache/iceberg/issues/1578#issuecomment-707465328","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1578","id":707465328,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ2NTMyOA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T03:41:34Z","updated_at":"2020-10-13T03:41:34Z","author_association":"MEMBER","body":"> If you needed to register a logical type, then you must be using Avro's DatumReader instead of an Iceberg DatumReader.\r\n\r\nYes, you're right.  Here is the code: https://github.com/apache/iceberg/pull/1477/files#diff-863fca4ad067cd7dd66730275ed9dcb29fa4468b5b474461934bda9372f73280R72. It just use the GenericAvroReader to decode the datum.   I see the `IcebergDecoder` & `IcebergEncoder` could only encode/decode the iceberg `Record`,  while `ManifestFile` is a `IndexedRecord`,  in theory we should define the `AvroDecoder` and `AvroEncoder`, and providing those tests to address the schema evolution issues.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707465328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707466544","html_url":"https://github.com/apache/iceberg/issues/1544#issuecomment-707466544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1544","id":707466544,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ2NjU0NA==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T03:46:22Z","updated_at":"2020-10-13T03:47:05Z","author_association":"CONTRIBUTOR","body":"ok I also tried `tbl.toString` and `tbl().toString`.\r\n\r\nFinally I said screw it and also tried `t.toString` and `t().toString`. It was a decent amount to read, but I cant think of any other names that people might have named a Table variable. Can anybody think of any other names of variables people might have assigned tables to? I'm tempted just to look at the hundreds of usages of Table and then that way be able to say that I fully believe all instances have been found. How repeatable is that? Not very, but I can't figure out how to exhaustively check otherwise.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707466544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707468679","html_url":"https://github.com/apache/iceberg/issues/1544#issuecomment-707468679","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1544","id":707468679,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ2ODY3OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T03:54:14Z","updated_at":"2020-10-13T03:54:14Z","author_association":"MEMBER","body":"You should in intellij be able to search for method usages I think\n\nOn Mon, Oct 12, 2020, 10:46 PM Kyle Bendickson <notifications@github.com>\nwrote:\n\n> ok I also tried tbl.toString and tbl().toString.\n>\n> finally I said screw it and also tried t.toString and t().toString. It\n> was a decent amount to read, but I cant think of any other names that\n> people might have named a Table variable. Can anybody think of any other\n> names of variables people might have assigned tables to? I'm tempted just\n> to look at the hundreds of usages of Table and then that way be able to say\n> that I fully believe all instances have been found. How repeatable is that?\n> Not very, but I can't figure out how to exhaustively check otherwise.\n>\n> —\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/1544#issuecomment-707466544>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YPH6MOWLVHSUK7TKZTSKPERZANCNFSM4SBB35SA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707468679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707468803","html_url":"https://github.com/apache/iceberg/pull/1600#issuecomment-707468803","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1600","id":707468803,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ2ODgwMw==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T03:54:43Z","updated_at":"2020-10-13T03:54:43Z","author_association":"CONTRIBUTOR","body":"Looks like a good change, and we have more usages on test parameters which we want do deal with it at once.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707468803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707473010","html_url":"https://github.com/apache/iceberg/pull/1600#issuecomment-707473010","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1600","id":707473010,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ3MzAxMA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T04:09:28Z","updated_at":"2020-10-13T04:09:28Z","author_association":"CONTRIBUTOR","body":"There's just another one missing: TestLocationProvider.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707473010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707496193","html_url":"https://github.com/apache/iceberg/issues/1589#issuecomment-707496193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1589","id":707496193,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ5NjE5Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T05:23:48Z","updated_at":"2020-10-13T05:23:48Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01 Does Flink support stored procedures or being able to plugin extensions like Spark?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707496193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707497461","html_url":"https://github.com/apache/iceberg/issues/1597#issuecomment-707497461","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1597","id":707497461,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzQ5NzQ2MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T05:27:40Z","updated_at":"2020-10-13T05:27:40Z","author_association":"CONTRIBUTOR","body":"I'd make both `older_than` and `retain_last` optional and require at least one to be present. If only `retain_last` is present, I'd default `timestamp` to the current timestamp. \r\n\r\nThe following would keep only 100 last snapshots, for example.\r\n\r\n```\r\nCALL catalog.schema.expire_snapshots(\r\n  namespace => 'namespace_name',\r\n  table => 'table_name',\r\n  retain_last => 100\r\n)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707497461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707500038","html_url":"https://github.com/apache/iceberg/issues/1544#issuecomment-707500038","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1544","id":707500038,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzUwMDAzOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T05:35:14Z","updated_at":"2020-10-13T05:35:23Z","author_association":"CONTRIBUTOR","body":"I am going to resolve this as it is done. Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707500038/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707507924","html_url":"https://github.com/apache/iceberg/issues/1597#issuecomment-707507924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1597","id":707507924,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzUwNzkyNA==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T05:58:09Z","updated_at":"2020-10-13T06:24:03Z","author_association":"NONE","body":"> I'd make both `older_than` and `retain_last` optional and require at least one to be present. If only `retain_last` is present, I'd default `timestamp` to the current timestamp.\r\n\r\nI agree with the default timestamp (current time) for `older_than`, but what's the default time zone?\r\nJust the default local system time zone or a specific default time zone？\r\n\r\n@aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707507924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707512267","html_url":"https://github.com/apache/iceberg/pull/1565#issuecomment-707512267","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1565","id":707512267,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzUxMjI2Nw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T06:09:27Z","updated_at":"2020-10-13T06:09:27Z","author_association":"MEMBER","body":"LGTM now, will merge this if all unit tests pass.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707512267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707518866","html_url":"https://github.com/apache/iceberg/pull/1565#issuecomment-707518866","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1565","id":707518866,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzUxODg2Ng==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T06:25:23Z","updated_at":"2020-10-13T06:25:23Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue and @openinx for review, merging...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707518866/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707521807","html_url":"https://github.com/apache/iceberg/pull/1515#issuecomment-707521807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1515","id":707521807,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzUyMTgwNw==","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T06:31:55Z","updated_at":"2020-10-13T06:32:51Z","author_association":"CONTRIBUTOR","body":"@rdblue  I think it's a little complex to do this check because we have two running modes, batch and stream. The checkpoint is disabled when running in batch mode, which is a normal case. while in stream mode, we should enable checkpoint, So how to distinguish batch and stream, @openinx Do you have any suggestions ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707521807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707528788","html_url":"https://github.com/apache/iceberg/pull/1515#issuecomment-707528788","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1515","id":707528788,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzUyODc4OA==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T06:46:05Z","updated_at":"2020-10-13T06:46:16Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue and @simonsssu \r\nI think the normal guarantee for Flink is exactly-once. Sometimes, for better performance, it will be at-least-once guarantee.\r\nI've rarely seen checkpoints turned off, maybe in risk control scenarios (Timely alarm is needed).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707528788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707533790","html_url":"https://github.com/apache/iceberg/issues/1597#issuecomment-707533790","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1597","id":707533790,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzUzMzc5MA==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T06:57:06Z","updated_at":"2020-10-13T07:16:15Z","author_association":"NONE","body":"please assign this issue to me!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707533790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707581847","html_url":"https://github.com/apache/iceberg/pull/1477#issuecomment-707581847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1477","id":707581847,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzU4MTg0Nw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T08:28:58Z","updated_at":"2020-10-13T08:28:58Z","author_association":"MEMBER","body":"Ping @rdblue @JingsongLi @stevenzwu for reviewing. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707581847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707584762","html_url":"https://github.com/apache/iceberg/issues/1597#issuecomment-707584762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1597","id":707584762,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzU4NDc2Mg==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T08:33:54Z","updated_at":"2020-10-13T08:34:47Z","author_association":"NONE","body":"> I'd make both `older_than` and `retain_last` optional and require at least one to be present. If only `retain_last` is present, I'd default `timestamp` to the current timestamp.\r\n\r\nIn the procedure SQL：\r\n```\r\nCALL catalog.schema.expire_snapshot(\r\n    namespace => 'namespace_name',\r\n    table => 'table_name'\r\n)\r\n```\r\nif the `expire snapshot sql` lacks the two parameters `retain_last` and `older_than`, how to tell the user where the error occurred?\r\nJust throw a RE exception or error?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707584762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707622294","html_url":"https://github.com/apache/iceberg/issues/1605#issuecomment-707622294","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1605","id":707622294,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzYyMjI5NA==","user":{"login":"wg1026688210","id":14267759,"node_id":"MDQ6VXNlcjE0MjY3NzU5","avatar_url":"https://avatars.githubusercontent.com/u/14267759?v=4","gravatar_id":"","url":"https://api.github.com/users/wg1026688210","html_url":"https://github.com/wg1026688210","followers_url":"https://api.github.com/users/wg1026688210/followers","following_url":"https://api.github.com/users/wg1026688210/following{/other_user}","gists_url":"https://api.github.com/users/wg1026688210/gists{/gist_id}","starred_url":"https://api.github.com/users/wg1026688210/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wg1026688210/subscriptions","organizations_url":"https://api.github.com/users/wg1026688210/orgs","repos_url":"https://api.github.com/users/wg1026688210/repos","events_url":"https://api.github.com/users/wg1026688210/events{/privacy}","received_events_url":"https://api.github.com/users/wg1026688210/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T09:39:19Z","updated_at":"2020-10-13T09:39:19Z","author_association":"CONTRIBUTOR","body":"HiveCatalog will find the option  'hive.metastore.warehouse.dir'  which  should exist  in hive-site.xml config","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707622294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707631179","html_url":"https://github.com/apache/iceberg/pull/1391#issuecomment-707631179","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1391","id":707631179,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzYzMTE3OQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T09:56:00Z","updated_at":"2020-10-13T09:56:00Z","author_association":"COLLABORATOR","body":"@JingsongLi , This is similar to the visitor you wrote before, would you mind to take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707631179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707641720","html_url":"https://github.com/apache/iceberg/pull/1391#issuecomment-707641720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1391","id":707641720,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzY0MTcyMA==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T10:16:43Z","updated_at":"2020-10-13T10:16:43Z","author_association":"CONTRIBUTOR","body":"Thanks @chenjunjiedada for the contribution, I'll take a look these two days.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707641720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707654634","html_url":"https://github.com/apache/iceberg/issues/1602#issuecomment-707654634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1602","id":707654634,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzY1NDYzNA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T10:42:19Z","updated_at":"2020-10-13T10:42:19Z","author_association":"CONTRIBUTOR","body":"Local unit test needs to remove HADOOP_HOME","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707654634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707681304","html_url":"https://github.com/apache/iceberg/issues/1603#issuecomment-707681304","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1603","id":707681304,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzY4MTMwNA==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T11:38:46Z","updated_at":"2020-10-13T11:38:46Z","author_association":"CONTRIBUTOR","body":"Opened by mistake. Close it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707681304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707690135","html_url":"https://github.com/apache/iceberg/issues/1488#issuecomment-707690135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1488","id":707690135,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzY5MDEzNQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T11:58:31Z","updated_at":"2020-10-13T11:58:31Z","author_association":"COLLABORATOR","body":"Another one: https://travis-ci.org/github/apache/iceberg/jobs/735326468.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707690135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707715436","html_url":"https://github.com/apache/iceberg/issues/1604#issuecomment-707715436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1604","id":707715436,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzcxNTQzNg==","user":{"login":"waterlx","id":13976495,"node_id":"MDQ6VXNlcjEzOTc2NDk1","avatar_url":"https://avatars.githubusercontent.com/u/13976495?v=4","gravatar_id":"","url":"https://api.github.com/users/waterlx","html_url":"https://github.com/waterlx","followers_url":"https://api.github.com/users/waterlx/followers","following_url":"https://api.github.com/users/waterlx/following{/other_user}","gists_url":"https://api.github.com/users/waterlx/gists{/gist_id}","starred_url":"https://api.github.com/users/waterlx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waterlx/subscriptions","organizations_url":"https://api.github.com/users/waterlx/orgs","repos_url":"https://api.github.com/users/waterlx/repos","events_url":"https://api.github.com/users/waterlx/events{/privacy}","received_events_url":"https://api.github.com/users/waterlx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T12:48:48Z","updated_at":"2020-10-13T12:48:48Z","author_association":"CONTRIBUTOR","body":"Ready to close this issue as it is fixed by PR #1399 , I am not using the latest code so #1399 is not picked up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707715436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707742040","html_url":"https://github.com/apache/iceberg/issues/1488#issuecomment-707742040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1488","id":707742040,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzc0MjA0MA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T13:34:26Z","updated_at":"2020-10-13T13:37:55Z","author_association":"CONTRIBUTOR","body":"Are these failures after @marton-bod's last PR? #1585. That contained a change to add more memory for the tests","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707742040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707758262","html_url":"https://github.com/apache/iceberg/pull/1586#issuecomment-707758262","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1586","id":707758262,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzc1ODI2Mg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T13:59:14Z","updated_at":"2020-10-13T13:59:14Z","author_association":"MEMBER","body":"Ping @rdblue , Mind to take a look for this when you have time ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707758262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707834359","html_url":"https://github.com/apache/iceberg/issues/1605#issuecomment-707834359","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1605","id":707834359,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzgzNDM1OQ==","user":{"login":"wg1026688210","id":14267759,"node_id":"MDQ6VXNlcjE0MjY3NzU5","avatar_url":"https://avatars.githubusercontent.com/u/14267759?v=4","gravatar_id":"","url":"https://api.github.com/users/wg1026688210","html_url":"https://github.com/wg1026688210","followers_url":"https://api.github.com/users/wg1026688210/followers","following_url":"https://api.github.com/users/wg1026688210/following{/other_user}","gists_url":"https://api.github.com/users/wg1026688210/gists{/gist_id}","starred_url":"https://api.github.com/users/wg1026688210/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wg1026688210/subscriptions","organizations_url":"https://api.github.com/users/wg1026688210/orgs","repos_url":"https://api.github.com/users/wg1026688210/repos","events_url":"https://api.github.com/users/wg1026688210/events{/privacy}","received_events_url":"https://api.github.com/users/wg1026688210/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T15:48:18Z","updated_at":"2020-10-13T15:48:18Z","author_association":"CONTRIBUTOR","body":"environment:\r\ncentos 7\r\njdk8\r\nhadoop2.7\r\n\r\n\r\n\r\ncode \r\n```\r\ntableEnvironment.executeSql(\"create catalog iceberg_catalog with ('type'='iceberg', 'catalog-type'='hive', 'uri'='xxx' ,'property-version'='1' ,'clients'='5')\");\r\n        tableEnvironment.executeSql(\"use catalog iceberg_catalog\");\r\n        tableEnvironment.executeSql(\r\n                \"CREATE TABLE iceberg_catalog.flink_origin_db.hive_1result_table (\\n\" +\r\n                        \"    id STRING COMMENT 'unique id',\\n\" +\r\n                        \"    data STRING\\n\" +\r\n                        \")\\n\"\r\n        );\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707834359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707839400","html_url":"https://github.com/apache/iceberg/issues/1597#issuecomment-707839400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1597","id":707839400,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzgzOTQwMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T15:56:11Z","updated_at":"2020-10-13T15:56:11Z","author_association":"CONTRIBUTOR","body":"Can we just use `System.currentTimeMillis`? Spark returns us `java.sql.Timestamp` that is time zone agnostic, I guess. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707839400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707847896","html_url":"https://github.com/apache/iceberg/pull/1495#issuecomment-707847896","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1495","id":707847896,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzg0Nzg5Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T16:08:43Z","updated_at":"2020-10-13T16:08:43Z","author_association":"CONTRIBUTOR","body":"Merged! Thanks @pvary for all your work on this one!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707847896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707848977","html_url":"https://github.com/apache/iceberg/pull/1600#issuecomment-707848977","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1600","id":707848977,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzg0ODk3Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T16:10:18Z","updated_at":"2020-10-13T16:10:18Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707848977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707849808","html_url":"https://github.com/apache/iceberg/pull/1582#issuecomment-707849808","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1582","id":707849808,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzg0OTgwOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T16:11:32Z","updated_at":"2020-10-13T16:11:32Z","author_association":"CONTRIBUTOR","body":"Merging since @rdsr's comment was addressed. Thanks, @shardulm94!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707849808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707852558","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707852558","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707852558,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzg1MjU1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T16:15:34Z","updated_at":"2020-10-13T16:15:34Z","author_association":"CONTRIBUTOR","body":"@pvary and @marton-bod, looks like we have some flaky behavior with Hive tests. Here's the failure from @kbendick's comment above:\r\n\r\n> ```\r\n> org.apache.iceberg.mr.hive.TestHiveIcebergStorageHandlerWithHiveCatalog > testJoinTablesParquet FAILED\r\n>     java.lang.IllegalArgumentException: Failed to executeQuery Hive query SHOW TABLES: Error while compiling statement: FAILED: SemanticException org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n>         Caused by:\r\n>         org.apache.hive.service.cli.HiveSQLException: Error while compiling statement: FAILED: SemanticException org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n>             Caused by:\r\n>             org.apache.hadoop.hive.ql.parse.SemanticException: org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n>                 Caused by:\r\n>                 org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n>                     Caused by:\r\n>                     org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n>                         Caused by:\r\n>                         java.net.SocketException: Broken pipe (Write failed)\r\n>     org.apache.hadoop.hive.ql.metadata.HiveException: org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n>         Caused by:\r\n>         org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n>             Caused by:\r\n>             java.net.SocketException: Broken pipe (Write failed)\r\n> ```\r\n\r\nThis is probably caused by too many open connections at once. Can you help us double-check the use of client pools in Hive? Are client pools reused across tests with HiveRunner?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707852558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707852952","html_url":"https://github.com/apache/iceberg/pull/1579#issuecomment-707852952","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1579","id":707852952,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzg1Mjk1Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T16:16:12Z","updated_at":"2020-10-13T16:16:12Z","author_association":"CONTRIBUTOR","body":"Since the test failures are unrelated, I'm going to merge this fix. Thanks @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707852952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707862285","html_url":"https://github.com/apache/iceberg/pull/1517#issuecomment-707862285","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1517","id":707862285,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzg2MjI4NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T16:31:20Z","updated_at":"2020-10-13T16:31:30Z","author_association":"CONTRIBUTOR","body":"Looks like tests are failing with this:\r\n\r\n```\r\norg.apache.iceberg.flink.source.TestFlinkInputFormat > testPartitionTypes[format=orc] FAILED\r\n    java.lang.NullPointerException\r\n        at org.apache.flink.api.common.typeutils.base.array.BytePrimitiveArraySerializer.copy(BytePrimitiveArraySerializer.java:54)\r\n        at org.apache.flink.api.common.typeutils.base.array.BytePrimitiveArraySerializer.copy(BytePrimitiveArraySerializer.java:33)\r\n        at org.apache.iceberg.flink.TestHelpers.copyRowData(TestHelpers.java:75)\r\n        at org.apache.iceberg.flink.TestHelpers.readRowData(TestHelpers.java:89)\r\n        at org.apache.iceberg.flink.TestHelpers.readRows(TestHelpers.java:101)\r\n        at org.apache.iceberg.flink.source.TestFlinkInputFormat.runFormat(TestFlinkInputFormat.java:105)\r\n        at org.apache.iceberg.flink.source.TestFlinkInputFormat.run(TestFlinkInputFormat.java:66)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707862285/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707863090","html_url":"https://github.com/apache/iceberg/pull/1561#issuecomment-707863090","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1561","id":707863090,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzg2MzA5MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T16:32:40Z","updated_at":"2020-10-13T16:32:40Z","author_association":"CONTRIBUTOR","body":"Sorry I didn't come back to this issue before now. The re-test passed, so I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707863090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707864969","html_url":"https://github.com/apache/iceberg/pull/1522#issuecomment-707864969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1522","id":707864969,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzg2NDk2OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T16:35:52Z","updated_at":"2020-10-13T16:35:52Z","author_association":"CONTRIBUTOR","body":"I'm restarting the failed JDK 8 tests because the failure was flaky Hive tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707864969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707870292","html_url":"https://github.com/apache/iceberg/pull/1515#issuecomment-707870292","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1515","id":707870292,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNzg3MDI5Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-13T16:44:02Z","updated_at":"2020-10-13T16:44:02Z","author_association":"CONTRIBUTOR","body":"Thanks for the context, everyone. It sounds like we have two main issues to address. First, how do we ensure people are using checkpoints reliably given that batch doesn't need them (check `!batch && !checkpointing`?). And second, what guarantees do we want to make for a sink like this? From @JingsongLi's comment, I think we should target at-least-once but we should all agree on whether that is the goal.\r\n\r\n> I think for most Flink cases, if we don't enable checkpoint, it was at-most-once guarantee because it will lost the state generated during job failover, unless we manually read data from beginning.\r\n\r\nWhen we have situations like this, we read all of the available data in the topic to get at-least-once behavior, assuming that the job hasn't been paused for so long that the data has been removed. It sounds like this is what other people do as well?\r\n\r\n> Your ideas is to make IcebergWriter to recover the state by finding the last successful commit , am I right ?\r\n\r\nYes. The purpose is to get less duplication for at-least-once by recovering the offsets if we can. I'm not sure whether Flink allows you to construct custom offsets like this, though. I'll defer to the expertise of @openinx and @JingsongLi.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/707870292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]