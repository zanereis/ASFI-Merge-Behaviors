[{"url":"https://api.github.com/repos/apache/druid/issues/comments/325298755","html_url":"https://github.com/apache/druid/issues/4712#issuecomment-325298755","issue_url":"https://api.github.com/repos/apache/druid/issues/4712","id":325298755,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTI5ODc1NQ==","user":{"login":"blugowski","id":22055014,"node_id":"MDQ6VXNlcjIyMDU1MDE0","avatar_url":"https://avatars.githubusercontent.com/u/22055014?v=4","gravatar_id":"","url":"https://api.github.com/users/blugowski","html_url":"https://github.com/blugowski","followers_url":"https://api.github.com/users/blugowski/followers","following_url":"https://api.github.com/users/blugowski/following{/other_user}","gists_url":"https://api.github.com/users/blugowski/gists{/gist_id}","starred_url":"https://api.github.com/users/blugowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blugowski/subscriptions","organizations_url":"https://api.github.com/users/blugowski/orgs","repos_url":"https://api.github.com/users/blugowski/repos","events_url":"https://api.github.com/users/blugowski/events{/privacy}","received_events_url":"https://api.github.com/users/blugowski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T08:54:15Z","updated_at":"2017-08-28T08:54:15Z","author_association":"CONTRIBUTOR","body":"Hello,\r\n\r\nAlready done, check this PR: https://github.com/druid-io/druid/pull/4265 :)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325298755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325300165","html_url":"https://github.com/apache/druid/issues/4712#issuecomment-325300165","issue_url":"https://api.github.com/repos/apache/druid/issues/4712","id":325300165,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTMwMDE2NQ==","user":{"login":"LoicGombeaud","id":1173317,"node_id":"MDQ6VXNlcjExNzMzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/1173317?v=4","gravatar_id":"","url":"https://api.github.com/users/LoicGombeaud","html_url":"https://github.com/LoicGombeaud","followers_url":"https://api.github.com/users/LoicGombeaud/followers","following_url":"https://api.github.com/users/LoicGombeaud/following{/other_user}","gists_url":"https://api.github.com/users/LoicGombeaud/gists{/gist_id}","starred_url":"https://api.github.com/users/LoicGombeaud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LoicGombeaud/subscriptions","organizations_url":"https://api.github.com/users/LoicGombeaud/orgs","repos_url":"https://api.github.com/users/LoicGombeaud/repos","events_url":"https://api.github.com/users/LoicGombeaud/events{/privacy}","received_events_url":"https://api.github.com/users/LoicGombeaud/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T09:00:33Z","updated_at":"2017-08-28T09:00:33Z","author_association":"NONE","body":"Amazing, thanks :)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325300165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325300966","html_url":"https://github.com/apache/druid/pull/4265#issuecomment-325300966","issue_url":"https://api.github.com/repos/apache/druid/issues/4265","id":325300966,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTMwMDk2Ng==","user":{"login":"LoicGombeaud","id":1173317,"node_id":"MDQ6VXNlcjExNzMzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/1173317?v=4","gravatar_id":"","url":"https://api.github.com/users/LoicGombeaud","html_url":"https://github.com/LoicGombeaud","followers_url":"https://api.github.com/users/LoicGombeaud/followers","following_url":"https://api.github.com/users/LoicGombeaud/following{/other_user}","gists_url":"https://api.github.com/users/LoicGombeaud/gists{/gist_id}","starred_url":"https://api.github.com/users/LoicGombeaud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LoicGombeaud/subscriptions","organizations_url":"https://api.github.com/users/LoicGombeaud/orgs","repos_url":"https://api.github.com/users/LoicGombeaud/repos","events_url":"https://api.github.com/users/LoicGombeaud/events{/privacy}","received_events_url":"https://api.github.com/users/LoicGombeaud/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T09:04:07Z","updated_at":"2017-08-28T09:04:07Z","author_association":"NONE","body":"Thank you for this PR, both of these features would be very useful for our use case; in which release will it be included?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325300966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325353510","html_url":"https://github.com/apache/druid/pull/4265#issuecomment-325353510","issue_url":"https://api.github.com/repos/apache/druid/issues/4265","id":325353510,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTM1MzUxMA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T13:29:44Z","updated_at":"2017-08-28T13:29:44Z","author_association":"CONTRIBUTOR","body":"will run test one more time and merge it afterwords, expect this to be in the next release.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325353510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325392119","html_url":"https://github.com/apache/druid/pull/4265#issuecomment-325392119","issue_url":"https://api.github.com/repos/apache/druid/issues/4265","id":325392119,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTM5MjExOQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T15:47:18Z","updated_at":"2017-08-28T15:47:18Z","author_association":"CONTRIBUTOR","body":"@blugowski can you please fix the style issues ? ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325392119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325392423","html_url":"https://github.com/apache/druid/pull/4265#issuecomment-325392423","issue_url":"https://api.github.com/repos/apache/druid/issues/4265","id":325392423,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTM5MjQyMw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T15:48:23Z","updated_at":"2017-08-28T15:48:23Z","author_association":"CONTRIBUTOR","body":"```\r\n[ERROR] /home/travis/build/druid-io/druid/extensions-contrib/graphite-emitter/src/main/java/io/druid/emitter/graphite/GraphiteEmitter.java:143:31: '{' at column 31 should be on a new line. [LeftCurly]\r\n````","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325392423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325430168","html_url":"https://github.com/apache/druid/pull/4688#issuecomment-325430168","issue_url":"https://api.github.com/repos/apache/druid/issues/4688","id":325430168,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTQzMDE2OA==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T18:04:46Z","updated_at":"2017-08-28T18:05:24Z","author_association":"MEMBER","body":"rebased with master. @jon-wei can you please try it now","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325430168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325477922","html_url":"https://github.com/apache/druid/pull/4688#issuecomment-325477922","issue_url":"https://api.github.com/repos/apache/druid/issues/4688","id":325477922,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTQ3NzkyMg==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T20:52:35Z","updated_at":"2017-08-28T20:52:35Z","author_association":"CONTRIBUTOR","body":"@jon-wei  @pjain1 still LGTM for me","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325477922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325485798","html_url":"https://github.com/apache/druid/pull/4688#issuecomment-325485798","issue_url":"https://api.github.com/repos/apache/druid/issues/4688","id":325485798,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTQ4NTc5OA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T21:21:37Z","updated_at":"2017-08-28T21:21:37Z","author_association":"CONTRIBUTOR","body":"@pjain1 checking the patch now","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325485798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325493905","html_url":"https://github.com/apache/druid/pull/4720#issuecomment-325493905","issue_url":"https://api.github.com/repos/apache/druid/issues/4720","id":325493905,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTQ5MzkwNQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T21:52:10Z","updated_at":"2017-08-28T21:52:10Z","author_association":"CONTRIBUTOR","body":"@leventov thanks for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325493905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325496218","html_url":"https://github.com/apache/druid/pull/4688#issuecomment-325496218","issue_url":"https://api.github.com/repos/apache/druid/issues/4688","id":325496218,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTQ5NjIxOA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T22:02:12Z","updated_at":"2017-08-28T22:02:18Z","author_association":"CONTRIBUTOR","body":"Just verified that a router query works with this patch, LGTM","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325496218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325506969","html_url":"https://github.com/apache/druid/pull/4725#issuecomment-325506969","issue_url":"https://api.github.com/repos/apache/druid/issues/4725","id":325506969,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTUwNjk2OQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-28T23:01:32Z","updated_at":"2017-08-28T23:01:32Z","author_association":"CONTRIBUTOR","body":"The logic looks like it would lead to false alarms sometimes given S3's data consistency model. Objects are not always guaranteed to be listable or gettable immediately after a PUT returns, see \"Amazon S3 Data Consistency Model\" on http://docs.aws.amazon.com/AmazonS3/latest/dev/Introduction.html#Regions.\r\n\r\nIs the idea that retrying will address this and make false alarms less of an issue?\r\n\r\nAlso, out of curiosity, how much time had passed between the successful copy, and when you gave up looking for the target object? I've seen S3 take as much as a few hours in some cases to reach consistency, but haven't notice anything longer than that.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325506969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325515765","html_url":"https://github.com/apache/druid/pull/4532#issuecomment-325515765","issue_url":"https://api.github.com/repos/apache/druid/issues/4532","id":325515765,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTUxNTc2NQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T00:00:40Z","updated_at":"2017-08-29T00:00:40Z","author_association":"CONTRIBUTOR","body":"@chunghochen, hmm i'm not sure why the job was canceled. Maybe there was a problem in travis. I restarted the job.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325515765/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325523477","html_url":"https://github.com/apache/druid/pull/4710#issuecomment-325523477","issue_url":"https://api.github.com/repos/apache/druid/issues/4710","id":325523477,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTUyMzQ3Nw==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T00:56:56Z","updated_at":"2017-08-29T00:56:56Z","author_association":"MEMBER","body":"@drcrallen do you have extra comments?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325523477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325535656","html_url":"https://github.com/apache/druid/pull/4725#issuecomment-325535656","issue_url":"https://api.github.com/repos/apache/druid/issues/4725","id":325535656,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTUzNTY1Ng==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T02:21:45Z","updated_at":"2017-08-29T02:21:45Z","author_association":"MEMBER","body":"@gianm it doesn't seem that in the statement \"Objects are not always guaranteed to be listable **or gettable** immediately after a PUT returns\" the highlighted part is true.\r\n\r\nThe doc that you linked to says\r\n\r\n> Amazon S3 provides read-after-write consistency for PUTS of new objects in your S3 bucket in all regions with one caveat. The caveat is that if you make a HEAD or GET request to the key name (to find if the object exists) before creating the object, Amazon S3 provides eventual consistency for read-after-write.\r\n\r\nIt doesn't give definition of \"read-after-write consistency\", but this blog post: https://shlomoswidler.com/2009/12/read-after-write-consistency-in-amazon.html suggests\r\n\r\n> Read-after-write consistency tightens things up a bit, guaranteeing immediate visibility of new data to all clients. With read-after-write consistency, a newly created object or file or table row will immediately be visible, without any delays.\r\n\r\nAlso later on the official doc page, situation of direct checking for key existence after PUT, *unlike listing the parent bucket,* is not mentioned in the list after the statement \"However, information about the changes must replicate across Amazon S3, which can take some time, and so you might observe the following behaviors\".\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325535656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325554325","html_url":"https://github.com/apache/druid/issues/4167#issuecomment-325554325","issue_url":"https://api.github.com/repos/apache/druid/issues/4167","id":325554325,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTU1NDMyNQ==","user":{"login":"arpankhagram","id":20059251,"node_id":"MDQ6VXNlcjIwMDU5MjUx","avatar_url":"https://avatars.githubusercontent.com/u/20059251?v=4","gravatar_id":"","url":"https://api.github.com/users/arpankhagram","html_url":"https://github.com/arpankhagram","followers_url":"https://api.github.com/users/arpankhagram/followers","following_url":"https://api.github.com/users/arpankhagram/following{/other_user}","gists_url":"https://api.github.com/users/arpankhagram/gists{/gist_id}","starred_url":"https://api.github.com/users/arpankhagram/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arpankhagram/subscriptions","organizations_url":"https://api.github.com/users/arpankhagram/orgs","repos_url":"https://api.github.com/users/arpankhagram/repos","events_url":"https://api.github.com/users/arpankhagram/events{/privacy}","received_events_url":"https://api.github.com/users/arpankhagram/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T04:49:08Z","updated_at":"2017-08-29T04:49:08Z","author_association":"NONE","body":"@pjain1  Although it's not causing any issues but im still unable to figure out what exactly is wrong with my specifications.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325554325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325561586","html_url":"https://github.com/apache/druid/pull/4726#issuecomment-325561586","issue_url":"https://api.github.com/repos/apache/druid/issues/4726","id":325561586,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTU2MTU4Ng==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T05:47:06Z","updated_at":"2017-08-29T05:47:06Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325561586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325561870","html_url":"https://github.com/apache/druid/pull/4716#issuecomment-325561870","issue_url":"https://api.github.com/repos/apache/druid/issues/4716","id":325561870,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTU2MTg3MA==","user":{"login":"niketh","id":626548,"node_id":"MDQ6VXNlcjYyNjU0OA==","avatar_url":"https://avatars.githubusercontent.com/u/626548?v=4","gravatar_id":"","url":"https://api.github.com/users/niketh","html_url":"https://github.com/niketh","followers_url":"https://api.github.com/users/niketh/followers","following_url":"https://api.github.com/users/niketh/following{/other_user}","gists_url":"https://api.github.com/users/niketh/gists{/gist_id}","starred_url":"https://api.github.com/users/niketh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niketh/subscriptions","organizations_url":"https://api.github.com/users/niketh/orgs","repos_url":"https://api.github.com/users/niketh/repos","events_url":"https://api.github.com/users/niketh/events{/privacy}","received_events_url":"https://api.github.com/users/niketh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T05:49:10Z","updated_at":"2017-08-29T05:49:10Z","author_association":"CONTRIBUTOR","body":"@jihoonson Incorporated your comments","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325561870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325561914","html_url":"https://github.com/apache/druid/pull/4725#issuecomment-325561914","issue_url":"https://api.github.com/repos/apache/druid/issues/4725","id":325561914,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTU2MTkxNA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T05:49:29Z","updated_at":"2017-08-29T05:49:29Z","author_association":"CONTRIBUTOR","body":"There's still the caveat \"if you make a HEAD or GET request to the key name (to find if the object exists) before creating the object\". I assume it's because the key-not-found state might get cached by S3. Although if you're certain nothing is going to do that, then I agree Amazon's doc says that the GET should work immediately.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325561914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325569610","html_url":"https://github.com/apache/druid/pull/4725#issuecomment-325569610","issue_url":"https://api.github.com/repos/apache/druid/issues/4725","id":325569610,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTU2OTYxMA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T06:39:47Z","updated_at":"2017-08-29T06:39:47Z","author_association":"CONTRIBUTOR","body":"I also didn't know that. Thank you for sharing. \r\nI'm fine with your patch except one comment on the test.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325569610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325589510","html_url":"https://github.com/apache/druid/issues/4724#issuecomment-325589510","issue_url":"https://api.github.com/repos/apache/druid/issues/4724","id":325589510,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTU4OTUxMA==","user":{"login":"niketh","id":626548,"node_id":"MDQ6VXNlcjYyNjU0OA==","avatar_url":"https://avatars.githubusercontent.com/u/626548?v=4","gravatar_id":"","url":"https://api.github.com/users/niketh","html_url":"https://github.com/niketh","followers_url":"https://api.github.com/users/niketh/followers","following_url":"https://api.github.com/users/niketh/following{/other_user}","gists_url":"https://api.github.com/users/niketh/gists{/gist_id}","starred_url":"https://api.github.com/users/niketh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niketh/subscriptions","organizations_url":"https://api.github.com/users/niketh/orgs","repos_url":"https://api.github.com/users/niketh/repos","events_url":"https://api.github.com/users/niketh/events{/privacy}","received_events_url":"https://api.github.com/users/niketh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T08:16:36Z","updated_at":"2017-08-29T08:16:36Z","author_association":"CONTRIBUTOR","body":"@htch optional milliseconds is already supported by using format \"auto\". However, time zone wasn't supported. I added a fix https://github.com/druid-io/druid/pull/4727, after which strings like \"2009-02-13 23:31:30 PST\" will also be supported.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325589510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325589981","html_url":"https://github.com/apache/druid/issues/4724#issuecomment-325589981","issue_url":"https://api.github.com/repos/apache/druid/issues/4724","id":325589981,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTU4OTk4MQ==","user":{"login":"htch","id":6015672,"node_id":"MDQ6VXNlcjYwMTU2NzI=","avatar_url":"https://avatars.githubusercontent.com/u/6015672?v=4","gravatar_id":"","url":"https://api.github.com/users/htch","html_url":"https://github.com/htch","followers_url":"https://api.github.com/users/htch/followers","following_url":"https://api.github.com/users/htch/following{/other_user}","gists_url":"https://api.github.com/users/htch/gists{/gist_id}","starred_url":"https://api.github.com/users/htch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/htch/subscriptions","organizations_url":"https://api.github.com/users/htch/orgs","repos_url":"https://api.github.com/users/htch/repos","events_url":"https://api.github.com/users/htch/events{/privacy}","received_events_url":"https://api.github.com/users/htch/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T08:18:45Z","updated_at":"2017-08-29T08:18:45Z","author_association":"NONE","body":"@niketh That's great news, thanks for your fix!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325589981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325600645","html_url":"https://github.com/apache/druid/pull/4265#issuecomment-325600645","issue_url":"https://api.github.com/repos/apache/druid/issues/4265","id":325600645,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTYwMDY0NQ==","user":{"login":"blugowski","id":22055014,"node_id":"MDQ6VXNlcjIyMDU1MDE0","avatar_url":"https://avatars.githubusercontent.com/u/22055014?v=4","gravatar_id":"","url":"https://api.github.com/users/blugowski","html_url":"https://github.com/blugowski","followers_url":"https://api.github.com/users/blugowski/followers","following_url":"https://api.github.com/users/blugowski/following{/other_user}","gists_url":"https://api.github.com/users/blugowski/gists{/gist_id}","starred_url":"https://api.github.com/users/blugowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blugowski/subscriptions","organizations_url":"https://api.github.com/users/blugowski/orgs","repos_url":"https://api.github.com/users/blugowski/repos","events_url":"https://api.github.com/users/blugowski/events{/privacy}","received_events_url":"https://api.github.com/users/blugowski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T08:58:15Z","updated_at":"2017-08-29T08:58:15Z","author_association":"CONTRIBUTOR","body":"@b-slim fixed.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325600645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325628677","html_url":"https://github.com/apache/druid/issues/4728#issuecomment-325628677","issue_url":"https://api.github.com/repos/apache/druid/issues/4728","id":325628677,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTYyODY3Nw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T10:56:08Z","updated_at":"2017-08-29T10:56:08Z","author_association":"CONTRIBUTOR","body":"@zhangxinyu1, what are you wanting to use the system time for?\r\n\r\nThe current design is attempting to ensure that the behavior of the kafka index task is completely deterministic based on the combination of task config (hashed as part of the sequenceName) + messages in kafka. We purposely avoided using system time for anything since it would lead to non-determinism.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325628677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325641612","html_url":"https://github.com/apache/druid/issues/4728#issuecomment-325641612","issue_url":"https://api.github.com/repos/apache/druid/issues/4728","id":325641612,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTY0MTYxMg==","user":{"login":"zhangxinyu1","id":12528894,"node_id":"MDQ6VXNlcjEyNTI4ODk0","avatar_url":"https://avatars.githubusercontent.com/u/12528894?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangxinyu1","html_url":"https://github.com/zhangxinyu1","followers_url":"https://api.github.com/users/zhangxinyu1/followers","following_url":"https://api.github.com/users/zhangxinyu1/following{/other_user}","gists_url":"https://api.github.com/users/zhangxinyu1/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangxinyu1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangxinyu1/subscriptions","organizations_url":"https://api.github.com/users/zhangxinyu1/orgs","repos_url":"https://api.github.com/users/zhangxinyu1/repos","events_url":"https://api.github.com/users/zhangxinyu1/events{/privacy}","received_events_url":"https://api.github.com/users/zhangxinyu1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T11:59:09Z","updated_at":"2017-08-29T12:03:42Z","author_association":"CONTRIBUTOR","body":"@gianm \r\nOur users use druid to do some real-time statistics, and output results each 5 minutes (by using group by  all dimensions, and the interval is latest 5 minutes). In this way, they can get results without coding.   If they don't use system time, some late messages are lost. \r\nBut you are right. kafka index task should be completely deterministic. Druid may be not suitable for this requirement. We should change our usage of druid.\r\nThanks very much!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325641612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325727425","html_url":"https://github.com/apache/druid/pull/4729#issuecomment-325727425","issue_url":"https://api.github.com/repos/apache/druid/issues/4729","id":325727425,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTcyNzQyNQ==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T16:57:21Z","updated_at":"2017-08-29T16:57:21Z","author_association":"CONTRIBUTOR","body":"Thanks for the contribution @SpotXPeterCunningham ! Can you please use the `master` branch instead of `0.10.1`? You should be able to click the \"edit\" button at the top of this page and choose `master` for the target branch.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325727425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325737545","html_url":"https://github.com/apache/druid/issues/4728#issuecomment-325737545","issue_url":"https://api.github.com/repos/apache/druid/issues/4728","id":325737545,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTczNzU0NQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T17:33:31Z","updated_at":"2017-08-29T17:33:31Z","author_association":"CONTRIBUTOR","body":"@zhangxinyu1 ah I see. In this case, why not just write the system time into the message itself? The Druid Kafka indexing service is capable of loading late messages.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325737545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325770387","html_url":"https://github.com/apache/druid/pull/4727#issuecomment-325770387","issue_url":"https://api.github.com/repos/apache/druid/issues/4727","id":325770387,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTc3MDM4Nw==","user":{"login":"niketh","id":626548,"node_id":"MDQ6VXNlcjYyNjU0OA==","avatar_url":"https://avatars.githubusercontent.com/u/626548?v=4","gravatar_id":"","url":"https://api.github.com/users/niketh","html_url":"https://github.com/niketh","followers_url":"https://api.github.com/users/niketh/followers","following_url":"https://api.github.com/users/niketh/following{/other_user}","gists_url":"https://api.github.com/users/niketh/gists{/gist_id}","starred_url":"https://api.github.com/users/niketh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niketh/subscriptions","organizations_url":"https://api.github.com/users/niketh/orgs","repos_url":"https://api.github.com/users/niketh/repos","events_url":"https://api.github.com/users/niketh/events{/privacy}","received_events_url":"https://api.github.com/users/niketh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T19:24:12Z","updated_at":"2017-08-29T19:24:12Z","author_association":"CONTRIBUTOR","body":"@leventov @gianm Addressed comments","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325770387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325821836","html_url":"https://github.com/apache/druid/pull/4699#issuecomment-325821836","issue_url":"https://api.github.com/repos/apache/druid/issues/4699","id":325821836,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTgyMTgzNg==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T22:23:10Z","updated_at":"2017-08-29T22:23:10Z","author_association":"CONTRIBUTOR","body":"@gianm / @himanshug what does the upgrade path look like for Tranquility? How does this upgrade roll out without breaking it?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325821836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325825774","html_url":"https://github.com/apache/druid/issues/3972#issuecomment-325825774","issue_url":"https://api.github.com/repos/apache/druid/issues/3972","id":325825774,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTgyNTc3NA==","user":{"login":"ginoledesma","id":879991,"node_id":"MDQ6VXNlcjg3OTk5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/879991?v=4","gravatar_id":"","url":"https://api.github.com/users/ginoledesma","html_url":"https://github.com/ginoledesma","followers_url":"https://api.github.com/users/ginoledesma/followers","following_url":"https://api.github.com/users/ginoledesma/following{/other_user}","gists_url":"https://api.github.com/users/ginoledesma/gists{/gist_id}","starred_url":"https://api.github.com/users/ginoledesma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ginoledesma/subscriptions","organizations_url":"https://api.github.com/users/ginoledesma/orgs","repos_url":"https://api.github.com/users/ginoledesma/repos","events_url":"https://api.github.com/users/ginoledesma/events{/privacy}","received_events_url":"https://api.github.com/users/ginoledesma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-29T22:44:38Z","updated_at":"2017-08-29T22:44:38Z","author_association":"CONTRIBUTOR","body":"I see this behavior as well in both druid 0.10.0 and 0.10.1. In my dataset, I get 0.95/0.98 quantile values exceeding that of max (whether from doubleMax or max on the approxHistogramField).\r\n\r\nIn my particular case, the mem fields were returning odd quantile values (but cpu and disk were fine).\r\n\r\n[sample-dataset.csv.txt](https://github.com/druid-io/druid/files/1261947/sample-dataset.csv.txt)\r\n[sample-index.json.txt](https://github.com/druid-io/druid/files/1261948/sample-index.json.txt)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325825774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325862484","html_url":"https://github.com/apache/druid/issues/4058#issuecomment-325862484","issue_url":"https://api.github.com/repos/apache/druid/issues/4058","id":325862484,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTg2MjQ4NA==","user":{"login":"zhxiaom5","id":10976459,"node_id":"MDQ6VXNlcjEwOTc2NDU5","avatar_url":"https://avatars.githubusercontent.com/u/10976459?v=4","gravatar_id":"","url":"https://api.github.com/users/zhxiaom5","html_url":"https://github.com/zhxiaom5","followers_url":"https://api.github.com/users/zhxiaom5/followers","following_url":"https://api.github.com/users/zhxiaom5/following{/other_user}","gists_url":"https://api.github.com/users/zhxiaom5/gists{/gist_id}","starred_url":"https://api.github.com/users/zhxiaom5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhxiaom5/subscriptions","organizations_url":"https://api.github.com/users/zhxiaom5/orgs","repos_url":"https://api.github.com/users/zhxiaom5/repos","events_url":"https://api.github.com/users/zhxiaom5/events{/privacy}","received_events_url":"https://api.github.com/users/zhxiaom5/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-30T02:41:24Z","updated_at":"2017-08-30T02:41:24Z","author_association":"NONE","body":" in the end,i found i have to use hadoop as my cold storage,local storage always have kind of problems","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325862484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325866777","html_url":"https://github.com/apache/druid/issues/4728#issuecomment-325866777","issue_url":"https://api.github.com/repos/apache/druid/issues/4728","id":325866777,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTg2Njc3Nw==","user":{"login":"zhangxinyu1","id":12528894,"node_id":"MDQ6VXNlcjEyNTI4ODk0","avatar_url":"https://avatars.githubusercontent.com/u/12528894?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangxinyu1","html_url":"https://github.com/zhangxinyu1","followers_url":"https://api.github.com/users/zhangxinyu1/followers","following_url":"https://api.github.com/users/zhangxinyu1/following{/other_user}","gists_url":"https://api.github.com/users/zhangxinyu1/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangxinyu1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangxinyu1/subscriptions","organizations_url":"https://api.github.com/users/zhangxinyu1/orgs","repos_url":"https://api.github.com/users/zhangxinyu1/repos","events_url":"https://api.github.com/users/zhangxinyu1/events{/privacy}","received_events_url":"https://api.github.com/users/zhangxinyu1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-30T03:09:15Z","updated_at":"2017-08-30T03:09:15Z","author_association":"CONTRIBUTOR","body":"Yeah, we are planning to do it. In this way, we can ensure one message only has one timestamp. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325866777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325934248","html_url":"https://github.com/apache/druid/pull/2660#issuecomment-325934248","issue_url":"https://api.github.com/repos/apache/druid/issues/2660","id":325934248,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTkzNDI0OA==","user":{"login":"hamlet-lee","id":12079531,"node_id":"MDQ6VXNlcjEyMDc5NTMx","avatar_url":"https://avatars.githubusercontent.com/u/12079531?v=4","gravatar_id":"","url":"https://api.github.com/users/hamlet-lee","html_url":"https://github.com/hamlet-lee","followers_url":"https://api.github.com/users/hamlet-lee/followers","following_url":"https://api.github.com/users/hamlet-lee/following{/other_user}","gists_url":"https://api.github.com/users/hamlet-lee/gists{/gist_id}","starred_url":"https://api.github.com/users/hamlet-lee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hamlet-lee/subscriptions","organizations_url":"https://api.github.com/users/hamlet-lee/orgs","repos_url":"https://api.github.com/users/hamlet-lee/repos","events_url":"https://api.github.com/users/hamlet-lee/events{/privacy}","received_events_url":"https://api.github.com/users/hamlet-lee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-30T09:21:15Z","updated_at":"2017-08-30T09:21:15Z","author_association":"CONTRIBUTOR","body":"I have rebase this PR on 0.10.0-rc2, and run it for 5 months in our cluster.\r\nIt works fine.  No obvious problem found.\r\n\r\nmy branch: https://github.com/hamlet-lee/druid/tree/mod_0.10.0-rc2","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325934248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/325947460","html_url":"https://github.com/apache/druid/issues/4058#issuecomment-325947460","issue_url":"https://api.github.com/repos/apache/druid/issues/4058","id":325947460,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTk0NzQ2MA==","user":{"login":"srvinbox","id":15378032,"node_id":"MDQ6VXNlcjE1Mzc4MDMy","avatar_url":"https://avatars.githubusercontent.com/u/15378032?v=4","gravatar_id":"","url":"https://api.github.com/users/srvinbox","html_url":"https://github.com/srvinbox","followers_url":"https://api.github.com/users/srvinbox/followers","following_url":"https://api.github.com/users/srvinbox/following{/other_user}","gists_url":"https://api.github.com/users/srvinbox/gists{/gist_id}","starred_url":"https://api.github.com/users/srvinbox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/srvinbox/subscriptions","organizations_url":"https://api.github.com/users/srvinbox/orgs","repos_url":"https://api.github.com/users/srvinbox/repos","events_url":"https://api.github.com/users/srvinbox/events{/privacy}","received_events_url":"https://api.github.com/users/srvinbox/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-30T10:14:23Z","updated_at":"2017-08-30T10:14:23Z","author_association":"NONE","body":"Regarding this ,.my timezone config not right，some service use UTC and some use UTC+0800\r\nCan you please let me know where you need to change the timexzone in druid?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/325947460/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326098348","html_url":"https://github.com/apache/druid/pull/4699#issuecomment-326098348","issue_url":"https://api.github.com/repos/apache/druid/issues/4699","id":326098348,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjA5ODM0OA==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-30T19:45:19Z","updated_at":"2017-08-30T19:45:19Z","author_association":"CONTRIBUTOR","body":"@drcrallen @gianm does tranquility have enough retries to handle the scenario where all overlord nodes were briefly down?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326098348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326136338","html_url":"https://github.com/apache/druid/pull/3482#issuecomment-326136338","issue_url":"https://api.github.com/repos/apache/druid/issues/3482","id":326136338,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjEzNjMzOA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-30T22:24:33Z","updated_at":"2017-08-30T22:24:33Z","author_association":"CONTRIBUTOR","body":"hey @himanshug, just wondering again if you are still interested in pursuing this, as a use case recently came up on my radar where writing to multiple tasks from one datasource would be useful.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326136338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326156644","html_url":"https://github.com/apache/druid/pull/4530#issuecomment-326156644","issue_url":"https://api.github.com/repos/apache/druid/issues/4530","id":326156644,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjE1NjY0NA==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T00:38:12Z","updated_at":"2017-08-31T00:38:12Z","author_association":"MEMBER","body":"@jihoonson I see a problem with the current way of managing metadata about publishing segments. Lets say a task calls AppenderatorDriver to publish segments for a sequence, then the driver will remove the sequence information from activeSegments and publishPendingSegments map. Now, if the task is restarted at a point after in memory data is persisted and metadata is committed but before any mergeAndPush or publish happens, then on restart if the task again tells driver to publish the same sequence, there is no way for the driver to know what segments to publish. Am I correct here or am I missing anything ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326156644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326156801","html_url":"https://github.com/apache/druid/pull/4530#issuecomment-326156801","issue_url":"https://api.github.com/repos/apache/druid/issues/4530","id":326156801,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjE1NjgwMQ==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T00:39:23Z","updated_at":"2017-08-31T00:39:23Z","author_association":"MEMBER","body":"also there is no milestone on this PR, in which version is this supposed to land ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326156801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326158515","html_url":"https://github.com/apache/druid/pull/4530#issuecomment-326158515","issue_url":"https://api.github.com/repos/apache/druid/issues/4530","id":326158515,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjE1ODUxNQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T00:52:13Z","updated_at":"2017-08-31T00:52:13Z","author_association":"CONTRIBUTOR","body":"@pjain1 I didn't totally follow the scenario you brought up, but it _sounds_ like something that could be a problem. The driver shouldn't \"forget\" about a segment until it is totally and safely published -- including both uploaded to deep storage, and inserted into the metadata store. If that seems to not be the case, could you please file an issue and mark it for 0.11.0? Maybe also explain the problem in more detail to help people like me understand it.\r\n\r\n> also there is no milestone on this PR, in which version is this supposed to land ?\r\n\r\n0.11.0, I think, since it doesn't appear in the commit history for 0.10.1 but it is in master.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326158515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326164847","html_url":"https://github.com/apache/druid/pull/4530#issuecomment-326164847","issue_url":"https://api.github.com/repos/apache/druid/issues/4530","id":326164847,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjE2NDg0Nw==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T01:38:54Z","updated_at":"2017-08-31T01:38:54Z","author_association":"MEMBER","body":"@gianm If you look at the code for `publish` or `publishAll` method of `AppenderatorDriver` the first thing that is done is to remove the sequence information from activeSegments and publishPendingSegments map. After that `push` is called on `Appenderator` with wrapped committer which will contain driver metadata (with the sequence information removed). In the `push` implementation in memory data is persisted using `persist` method which also commits the metadata to disk. So, what I was saying is that if task is restarted at this point, the restored metadata might be incomplete as this sequence information will not be restored. Any further calls to publish this sequence wouldn't do anything. \r\n\r\nOne way to resolve this would be to maintain an additional in-memory structure that contains sequences which are being published. On call to publish, sequence information is removed from activeSegments map but not from publishPendingSegments and added to the new in-memory structure. On successful publish sequence information is removed from the publishPendingSegments and in-memory structure. Any call to publish should try to publish sequence if it is not in the in-memory structure (it may not be in the activeSegment map when task is restarted at the point of time above described).\r\n\r\nI am not sure if its clear now, if not I can try to explain more :)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326164847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326171547","html_url":"https://github.com/apache/druid/pull/3482#issuecomment-326171547","issue_url":"https://api.github.com/repos/apache/druid/issues/3482","id":326171547,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjE3MTU0Nw==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T02:27:59Z","updated_at":"2017-08-31T02:28:12Z","author_association":"CONTRIBUTOR","body":"@gianm sorry, forgot about it again. given that I couldn't get back to it so far, Please go ahead with your plans about multi-datasource tasks and locks, feel free to copy the code if you need. thanks.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326171547/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326224128","html_url":"https://github.com/apache/druid/issues/4575#issuecomment-326224128","issue_url":"https://api.github.com/repos/apache/druid/issues/4575","id":326224128,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjIyNDEyOA==","user":{"login":"zhxiaom5","id":10976459,"node_id":"MDQ6VXNlcjEwOTc2NDU5","avatar_url":"https://avatars.githubusercontent.com/u/10976459?v=4","gravatar_id":"","url":"https://api.github.com/users/zhxiaom5","html_url":"https://github.com/zhxiaom5","followers_url":"https://api.github.com/users/zhxiaom5/followers","following_url":"https://api.github.com/users/zhxiaom5/following{/other_user}","gists_url":"https://api.github.com/users/zhxiaom5/gists{/gist_id}","starred_url":"https://api.github.com/users/zhxiaom5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhxiaom5/subscriptions","organizations_url":"https://api.github.com/users/zhxiaom5/orgs","repos_url":"https://api.github.com/users/zhxiaom5/repos","events_url":"https://api.github.com/users/zhxiaom5/events{/privacy}","received_events_url":"https://api.github.com/users/zhxiaom5/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T08:15:13Z","updated_at":"2017-08-31T08:15:13Z","author_association":"NONE","body":"i cant find any help ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326224128/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326236589","html_url":"https://github.com/apache/druid/issues/4575#issuecomment-326236589","issue_url":"https://api.github.com/repos/apache/druid/issues/4575","id":326236589,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjIzNjU4OQ==","user":{"login":"KeymanHuang","id":6082373,"node_id":"MDQ6VXNlcjYwODIzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/6082373?v=4","gravatar_id":"","url":"https://api.github.com/users/KeymanHuang","html_url":"https://github.com/KeymanHuang","followers_url":"https://api.github.com/users/KeymanHuang/followers","following_url":"https://api.github.com/users/KeymanHuang/following{/other_user}","gists_url":"https://api.github.com/users/KeymanHuang/gists{/gist_id}","starred_url":"https://api.github.com/users/KeymanHuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KeymanHuang/subscriptions","organizations_url":"https://api.github.com/users/KeymanHuang/orgs","repos_url":"https://api.github.com/users/KeymanHuang/repos","events_url":"https://api.github.com/users/KeymanHuang/events{/privacy}","received_events_url":"https://api.github.com/users/KeymanHuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T09:06:14Z","updated_at":"2017-08-31T09:06:14Z","author_association":"NONE","body":"pls see http://druid.io/docs/0.10.1/querying/groupbyquery.html. if u feel confused, u can try using [sql](http://druid.io/docs/latest/querying/sql.html).","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326236589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326240208","html_url":"https://github.com/apache/druid/issues/4723#issuecomment-326240208","issue_url":"https://api.github.com/repos/apache/druid/issues/4723","id":326240208,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjI0MDIwOA==","user":{"login":"KeymanHuang","id":6082373,"node_id":"MDQ6VXNlcjYwODIzNzM=","avatar_url":"https://avatars.githubusercontent.com/u/6082373?v=4","gravatar_id":"","url":"https://api.github.com/users/KeymanHuang","html_url":"https://github.com/KeymanHuang","followers_url":"https://api.github.com/users/KeymanHuang/followers","following_url":"https://api.github.com/users/KeymanHuang/following{/other_user}","gists_url":"https://api.github.com/users/KeymanHuang/gists{/gist_id}","starred_url":"https://api.github.com/users/KeymanHuang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KeymanHuang/subscriptions","organizations_url":"https://api.github.com/users/KeymanHuang/orgs","repos_url":"https://api.github.com/users/KeymanHuang/repos","events_url":"https://api.github.com/users/KeymanHuang/events{/privacy}","received_events_url":"https://api.github.com/users/KeymanHuang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T09:21:31Z","updated_at":"2017-08-31T09:21:31Z","author_association":"NONE","body":"Try using load rule and drop rule,  and maybe u should have a look at historical node tire, it's useful for  separating hot and cold data.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326240208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326256936","html_url":"https://github.com/apache/druid/issues/4734#issuecomment-326256936","issue_url":"https://api.github.com/repos/apache/druid/issues/4734","id":326256936,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjI1NjkzNg==","user":{"login":"wysstartgo","id":10540192,"node_id":"MDQ6VXNlcjEwNTQwMTky","avatar_url":"https://avatars.githubusercontent.com/u/10540192?v=4","gravatar_id":"","url":"https://api.github.com/users/wysstartgo","html_url":"https://github.com/wysstartgo","followers_url":"https://api.github.com/users/wysstartgo/followers","following_url":"https://api.github.com/users/wysstartgo/following{/other_user}","gists_url":"https://api.github.com/users/wysstartgo/gists{/gist_id}","starred_url":"https://api.github.com/users/wysstartgo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wysstartgo/subscriptions","organizations_url":"https://api.github.com/users/wysstartgo/orgs","repos_url":"https://api.github.com/users/wysstartgo/repos","events_url":"https://api.github.com/users/wysstartgo/events{/privacy}","received_events_url":"https://api.github.com/users/wysstartgo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T10:34:23Z","updated_at":"2017-08-31T10:34:23Z","author_association":"NONE","body":"when delete the DoubleFirstAggregatorFactory  from aggregators，the exception disappeared。","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326256936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326368495","html_url":"https://github.com/apache/druid/pull/4699#issuecomment-326368495","issue_url":"https://api.github.com/repos/apache/druid/issues/4699","id":326368495,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjM2ODQ5NQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T17:36:21Z","updated_at":"2017-08-31T17:36:21Z","author_association":"CONTRIBUTOR","body":"> @drcrallen @gianm does tranquility have enough retries to handle the scenario where all overlord nodes were briefly down?\r\n\r\n@himanshug by default it retries basically any failure of any kind (overlord or task) for 1 minute and then gives up on that batch of events, and reports it as dropped, and will then move on to the next batch of events. So that is the behavior you would expect to see if all overlords are down for >1 minute.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326368495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326373012","html_url":"https://github.com/apache/druid/pull/4699#issuecomment-326373012","issue_url":"https://api.github.com/repos/apache/druid/issues/4699","id":326373012,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjM3MzAxMg==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T17:52:05Z","updated_at":"2017-08-31T17:52:05Z","author_association":"CONTRIBUTOR","body":"The issue here also is consistency of discovery, for Tranqulity using the HTTP connection to overlord, will it be able to discover the overlord properly without a config change","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326373012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326375960","html_url":"https://github.com/apache/druid/pull/4699#issuecomment-326375960","issue_url":"https://api.github.com/repos/apache/druid/issues/4699","id":326375960,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjM3NTk2MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T18:03:03Z","updated_at":"2017-08-31T18:03:49Z","author_association":"CONTRIBUTOR","body":"> The issue here also is consistency of discovery, for Tranqulity using the HTTP connection to overlord, will it be able to discover the overlord properly without a config change\r\n\r\nI haven't looked at the code in this PR, but assuming that the overlord and also the running tasks still announce in Curator service discovery when you choose Curator-based leader election, it should all be the same to Tranquility, right @himanshug ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326375960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326376366","html_url":"https://github.com/apache/druid/pull/4699#issuecomment-326376366","issue_url":"https://api.github.com/repos/apache/druid/issues/4699","id":326376366,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjM3NjM2Ng==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T18:04:30Z","updated_at":"2017-08-31T18:04:30Z","author_association":"CONTRIBUTOR","body":"In general I thought one of the goals of this PR was to make it so there is no change in Curator service-discovery behavior if you stick with the Curator impl.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326376366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326379783","html_url":"https://github.com/apache/druid/pull/4534#issuecomment-326379783","issue_url":"https://api.github.com/repos/apache/druid/issues/4534","id":326379783,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjM3OTc4Mw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T18:17:35Z","updated_at":"2017-08-31T18:17:35Z","author_association":"CONTRIBUTOR","body":"@egor-ryashin thanks for your review; I pushed some new code.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326379783/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326400774","html_url":"https://github.com/apache/druid/pull/4699#issuecomment-326400774","issue_url":"https://api.github.com/repos/apache/druid/issues/4699","id":326400774,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjQwMDc3NA==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T19:43:16Z","updated_at":"2017-08-31T19:43:16Z","author_association":"CONTRIBUTOR","body":"It is entirely possible my brain crossed some wires when looking through the PR. Trying to keep the different ways announcements are used straight in my head was challenging","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326400774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326427801","html_url":"https://github.com/apache/druid/issues/3816#issuecomment-326427801","issue_url":"https://api.github.com/repos/apache/druid/issues/3816","id":326427801,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjQyNzgwMQ==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T21:39:45Z","updated_at":"2017-08-31T21:39:45Z","author_association":"MEMBER","body":"Seems that is it is already done, see `CacheStrategy.computeCacheKey()` and https://github.com/druid-io/druid/blob/master/server/src/main/java/io/druid/client/CachingClusteredClient.java#L256-L287","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326427801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326430088","html_url":"https://github.com/apache/druid/pull/4736#issuecomment-326430088","issue_url":"https://api.github.com/repos/apache/druid/issues/4736","id":326430088,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjQzMDA4OA==","user":{"login":"niketh","id":626548,"node_id":"MDQ6VXNlcjYyNjU0OA==","avatar_url":"https://avatars.githubusercontent.com/u/626548?v=4","gravatar_id":"","url":"https://api.github.com/users/niketh","html_url":"https://github.com/niketh","followers_url":"https://api.github.com/users/niketh/followers","following_url":"https://api.github.com/users/niketh/following{/other_user}","gists_url":"https://api.github.com/users/niketh/gists{/gist_id}","starred_url":"https://api.github.com/users/niketh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niketh/subscriptions","organizations_url":"https://api.github.com/users/niketh/orgs","repos_url":"https://api.github.com/users/niketh/repos","events_url":"https://api.github.com/users/niketh/events{/privacy}","received_events_url":"https://api.github.com/users/niketh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T21:50:57Z","updated_at":"2017-08-31T21:50:57Z","author_association":"CONTRIBUTOR","body":"👍 ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326430088/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326433161","html_url":"https://github.com/apache/druid/issues/4739#issuecomment-326433161","issue_url":"https://api.github.com/repos/apache/druid/issues/4739","id":326433161,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjQzMzE2MQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T22:06:03Z","updated_at":"2017-08-31T22:06:03Z","author_association":"CONTRIBUTOR","body":"As a workaround, the user can disable limit push down in the query context, e.g.:\r\n\r\n`\"context\": {\"applyLimitPushDown\": false }`","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326433161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326443355","html_url":"https://github.com/apache/druid/pull/4271#issuecomment-326443355","issue_url":"https://api.github.com/repos/apache/druid/issues/4271","id":326443355,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjQ0MzM1NQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-31T23:04:06Z","updated_at":"2017-08-31T23:04:06Z","author_association":"CONTRIBUTOR","body":"Looking into integration test failure.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326443355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326510712","html_url":"https://github.com/apache/druid/issues/4723#issuecomment-326510712","issue_url":"https://api.github.com/repos/apache/druid/issues/4723","id":326510712,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjUxMDcxMg==","user":{"login":"Ken-LiuL","id":7971987,"node_id":"MDQ6VXNlcjc5NzE5ODc=","avatar_url":"https://avatars.githubusercontent.com/u/7971987?v=4","gravatar_id":"","url":"https://api.github.com/users/Ken-LiuL","html_url":"https://github.com/Ken-LiuL","followers_url":"https://api.github.com/users/Ken-LiuL/followers","following_url":"https://api.github.com/users/Ken-LiuL/following{/other_user}","gists_url":"https://api.github.com/users/Ken-LiuL/gists{/gist_id}","starred_url":"https://api.github.com/users/Ken-LiuL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ken-LiuL/subscriptions","organizations_url":"https://api.github.com/users/Ken-LiuL/orgs","repos_url":"https://api.github.com/users/Ken-LiuL/repos","events_url":"https://api.github.com/users/Ken-LiuL/events{/privacy}","received_events_url":"https://api.github.com/users/Ken-LiuL/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-01T07:29:31Z","updated_at":"2017-09-01T07:29:31Z","author_association":"NONE","body":"The drop and load rule will not be applicable in this case , in which you will not be able to get result from those segments configured as dropped","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326510712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326622875","html_url":"https://github.com/apache/druid/pull/4699#issuecomment-326622875","issue_url":"https://api.github.com/repos/apache/druid/issues/4699","id":326622875,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjYyMjg3NQ==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-01T16:18:50Z","updated_at":"2017-09-01T16:21:54Z","author_association":"CONTRIBUTOR","body":"@gianm @drcrallen yes, this PR does not remove the announcement of overlord/coordinator leader inside \"external service discovery\" . that announcement is currently used by tranquility/. And, also internally by peons and coordinator to discover overlord leader, router to discovery coordinator leader. #4735 sets the stage for removing use of \"external service discovery\" from internal components.\r\n\r\nwrt to tranquility or other things interacting with overlord leader, they might get temporary errors when all overlords are brought down and till at least one of them comes back up. I have updated this information in release notes section of PR description.\r\n\r\nalso, I think all the comments have been addressed at this point and PR should be merge ready.\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326622875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326630084","html_url":"https://github.com/apache/druid/pull/4699#issuecomment-326630084","issue_url":"https://api.github.com/repos/apache/druid/issues/4699","id":326630084,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjYzMDA4NA==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-01T16:48:59Z","updated_at":"2017-09-01T16:48:59Z","author_association":"CONTRIBUTOR","body":"I see 3 👍 's","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326630084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326630321","html_url":"https://github.com/apache/druid/issues/3428#issuecomment-326630321","issue_url":"https://api.github.com/repos/apache/druid/issues/3428","id":326630321,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjYzMDMyMQ==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-01T16:49:56Z","updated_at":"2017-09-01T16:49:56Z","author_association":"CONTRIBUTOR","body":"Resolved by https://github.com/druid-io/druid/pull/4699","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326630321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326687831","html_url":"https://github.com/apache/druid/issues/4743#issuecomment-326687831","issue_url":"https://api.github.com/repos/apache/druid/issues/4743","id":326687831,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjY4NzgzMQ==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-01T21:29:16Z","updated_at":"2017-09-01T21:29:16Z","author_association":"MEMBER","body":"@jihoonson can you confirm this ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326687831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326689372","html_url":"https://github.com/apache/druid/pull/4171#issuecomment-326689372","issue_url":"https://api.github.com/repos/apache/druid/issues/4171","id":326689372,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjY4OTM3Mg==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-01T21:38:50Z","updated_at":"2017-09-01T21:38:50Z","author_association":"CONTRIBUTOR","body":"@knoguchi sounds like useful feature however use of https://github.com/eiiches/jackson-jq is questionable, I'm not really sure about all the legalities but mentioned repository doesn't have a LICENSE file or any apache etc headers on any of the source code.\r\nalso, it copies some things from https://github.com/stedolan/jq/blob/master/COPYING which is not apache licensed either.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326689372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326698550","html_url":"https://github.com/apache/druid/pull/4171#issuecomment-326698550","issue_url":"https://api.github.com/repos/apache/druid/issues/4171","id":326698550,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjY5ODU1MA==","user":{"login":"knoguchi","id":127546,"node_id":"MDQ6VXNlcjEyNzU0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/127546?v=4","gravatar_id":"","url":"https://api.github.com/users/knoguchi","html_url":"https://github.com/knoguchi","followers_url":"https://api.github.com/users/knoguchi/followers","following_url":"https://api.github.com/users/knoguchi/following{/other_user}","gists_url":"https://api.github.com/users/knoguchi/gists{/gist_id}","starred_url":"https://api.github.com/users/knoguchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/knoguchi/subscriptions","organizations_url":"https://api.github.com/users/knoguchi/orgs","repos_url":"https://api.github.com/users/knoguchi/repos","events_url":"https://api.github.com/users/knoguchi/events{/privacy}","received_events_url":"https://api.github.com/users/knoguchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-01T22:41:26Z","updated_at":"2017-09-01T22:41:44Z","author_association":"CONTRIBUTOR","body":"@himanshug Thanks for the comment.  jackson-jq itself is Apache2.0 per https://github.com/eiiches/jackson-jq/blob/develop/COPYING#L10.  jq is MIT per manual.   jq uses a library copyrighted by Lucent Technology -- the wording appears to be FOSS compatible but I'm not a lawyer to say for sure. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326698550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326708620","html_url":"https://github.com/apache/druid/issues/4021#issuecomment-326708620","issue_url":"https://api.github.com/repos/apache/druid/issues/4021","id":326708620,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjcwODYyMA==","user":{"login":"knepperjm","id":16123793,"node_id":"MDQ6VXNlcjE2MTIzNzkz","avatar_url":"https://avatars.githubusercontent.com/u/16123793?v=4","gravatar_id":"","url":"https://api.github.com/users/knepperjm","html_url":"https://github.com/knepperjm","followers_url":"https://api.github.com/users/knepperjm/followers","following_url":"https://api.github.com/users/knepperjm/following{/other_user}","gists_url":"https://api.github.com/users/knepperjm/gists{/gist_id}","starred_url":"https://api.github.com/users/knepperjm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/knepperjm/subscriptions","organizations_url":"https://api.github.com/users/knepperjm/orgs","repos_url":"https://api.github.com/users/knepperjm/repos","events_url":"https://api.github.com/users/knepperjm/events{/privacy}","received_events_url":"https://api.github.com/users/knepperjm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-02T00:16:37Z","updated_at":"2017-09-02T00:16:37Z","author_association":"NONE","body":"Guys, I'm having this issue too:\r\n\r\n`9/1/2017 5:16:03 PM2017-09-02T00:16:03,634 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:03 PM2017-09-02T00:16:03,684 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:03 PM2017-09-02T00:16:03,734 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:03 PM2017-09-02T00:16:03,784 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:03 PM2017-09-02T00:16:03,834 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:03 PM2017-09-02T00:16:03,885 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:03 PM2017-09-02T00:16:03,935 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:03 PM2017-09-02T00:16:03,985 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:04 PM2017-09-02T00:16:04,035 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:04 PM2017-09-02T00:16:04,085 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:04 PM2017-09-02T00:16:04,136 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:04 PM2017-09-02T00:16:04,186 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/1/2017 5:16:04 PM2017-09-02T00:16:04,236 INFO [Master-PeonExec--0] io.druid.server.coordinator.LoadQueuePeon - Server[/druid/loadQueue/10.42.246.38:8083] skipping doNext() because something is currently loading[ip_queries_daily_v4_2017-08-30T00:00:00.000Z_2017-08-31T00:00:00.000Z_2017-08-31T21:02:34.723Z_20].\r\n9/`\r\n\r\nI am on v0.10.1-rc3.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326708620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326717236","html_url":"https://github.com/apache/druid/issues/4743#issuecomment-326717236","issue_url":"https://api.github.com/repos/apache/druid/issues/4743","id":326717236,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjcxNzIzNg==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-02T02:44:57Z","updated_at":"2017-09-02T02:44:57Z","author_association":"CONTRIBUTOR","body":"@pjain1 thanks for pointing out this problem. Your suggestion looks reasonable. I have one comment below.\r\n\r\n> One way to resolve this would be to maintain an additional in-memory structure that contains sequences which are being published.\r\n\r\nIt seems that now the segments in AppenderatorDriver have 4 states, i.e., active, inactive, publishing, and published. Since the ```published``` state can be represented by removing the segments from a sort of in-memory structure (like activeSegments, publishPendingSegments or something else), we need to maintain the remaining 3 states of the segments. I think the state machine can be useful for this case. With the state machine, we need to keep only one in-memory structure containing the segments associated with their states. I guess it's simpler than the current implementation. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326717236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326717244","html_url":"https://github.com/apache/druid/pull/4530#issuecomment-326717244","issue_url":"https://api.github.com/repos/apache/druid/issues/4530","id":326717244,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjcxNzI0NA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-02T02:45:02Z","updated_at":"2017-09-02T02:45:02Z","author_association":"CONTRIBUTOR","body":"@pjain1 sorry for the late response. I was out of office for the last few days. Left a comment on https://github.com/druid-io/druid/issues/4743. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326717244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326739044","html_url":"https://github.com/apache/druid/pull/4704#issuecomment-326739044","issue_url":"https://api.github.com/repos/apache/druid/issues/4704","id":326739044,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjczOTA0NA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-02T11:38:52Z","updated_at":"2017-09-02T11:38:52Z","author_association":"CONTRIBUTOR","body":"> Also a question about ConcurrentGrouper: couldn't it complex parallel hierarical logic more elegantly expressed with ForkJoinPool?\r\n\r\nThere are two reasons I didn't use F/J. First, the executor used in ConcurrentGrouper (and now in ParallelCombiner as well) is a sort of fixed-size thread pool executor and the pool size is configured by users (DruidProcessingConfig). To use F/J, we need another configuration which should be avoided if possible. \r\nAnother reason is that there are some debates on how good F/J is (http://www.coopsoft.com/ar/CalamityArticle.html). I was not sure F/J is good for this kind of work.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326739044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326759007","html_url":"https://github.com/apache/druid/issues/4746#issuecomment-326759007","issue_url":"https://api.github.com/repos/apache/druid/issues/4746","id":326759007,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjc1OTAwNw==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-02T17:36:34Z","updated_at":"2017-09-02T17:37:00Z","author_association":"CONTRIBUTOR","body":"This topic is one I've been curious about for a while.\r\n\r\n> This can significantly slow down Druid in case rebalancing happens often as data that might not be queried often is suddenly in the page cache.\r\n\r\nDo you have any measurable evidence of this?\r\n\r\nWe see a lot of segment load slow down on new nodes depending on  the free memory or dirty ratio, but haven't made a reliable way to measure query performance impact of an ongoing node.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326759007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326761588","html_url":"https://github.com/apache/druid/issues/4746#issuecomment-326761588","issue_url":"https://api.github.com/repos/apache/druid/issues/4746","id":326761588,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjc2MTU4OA==","user":{"login":"bolkedebruin","id":4282712,"node_id":"MDQ6VXNlcjQyODI3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/4282712?v=4","gravatar_id":"","url":"https://api.github.com/users/bolkedebruin","html_url":"https://github.com/bolkedebruin","followers_url":"https://api.github.com/users/bolkedebruin/followers","following_url":"https://api.github.com/users/bolkedebruin/following{/other_user}","gists_url":"https://api.github.com/users/bolkedebruin/gists{/gist_id}","starred_url":"https://api.github.com/users/bolkedebruin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bolkedebruin/subscriptions","organizations_url":"https://api.github.com/users/bolkedebruin/orgs","repos_url":"https://api.github.com/users/bolkedebruin/repos","events_url":"https://api.github.com/users/bolkedebruin/events{/privacy}","received_events_url":"https://api.github.com/users/bolkedebruin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-02T18:23:19Z","updated_at":"2017-09-02T20:27:37Z","author_association":"CONTRIBUTOR","body":"On a pre-production cluster  7x 32GB, ~15GB available for page cache, HDD (SAN)) we were having  450GB of data, segments of ~500MB. \"Active\" segments (85GB) fitted in page cache memory (105GB). We did not have any queries spanning beyond the active segments, nevertheless the queries can be quite unique (same dataset but different subset)\r\n\r\nWe noticed the following:\r\n\r\n1. Constant rebalancing - multiple GBs of data were reschuffled every now and then\r\n2. Slow query performance -even requerying resulted high loads and IO on the historical nodes. (This was partially solved with increasing the query cache on the broker)\r\n3. When no rebalance happened, queries started to speed up, but when a rebalance happened again everything started to slow down to a crawl.\r\n\r\nWhat 3 tells us is that we are starting to hit disk IO while all the data should already have been in memory/page cache.\r\n\r\nWe removed all historical data that wasn't needed yet and only allowed one segment to be rebalanced at a time. This solved the speed of the queries. Rebalancing still happens, but as this will always be data that is required for queries this is not such a big issue anymore.\r\n\r\nPlease note that _writes to disk_ also end up in the page cache. So a rebalance of data can potentially poison the page cache of the sender _and_ of the receiver, e.g. in case of data outside of the regularly queried range.\r\n\r\nSo ideally Druid should hint the kernel whether it thinks this data belongs in the page cache or not. This can be done by setting at least FADV_DONTNEED (at receiver) for segments that are rebalanced and maybe at the sender (that's harder as you don't know what is in the page cache).\r\n\r\nWe have grafana logs to look at (afaik). \r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326761588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326766873","html_url":"https://github.com/apache/druid/issues/4746#issuecomment-326766873","issue_url":"https://api.github.com/repos/apache/druid/issues/4746","id":326766873,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjc2Njg3Mw==","user":{"login":"bolkedebruin","id":4282712,"node_id":"MDQ6VXNlcjQyODI3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/4282712?v=4","gravatar_id":"","url":"https://api.github.com/users/bolkedebruin","html_url":"https://github.com/bolkedebruin","followers_url":"https://api.github.com/users/bolkedebruin/followers","following_url":"https://api.github.com/users/bolkedebruin/following{/other_user}","gists_url":"https://api.github.com/users/bolkedebruin/gists{/gist_id}","starred_url":"https://api.github.com/users/bolkedebruin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bolkedebruin/subscriptions","organizations_url":"https://api.github.com/users/bolkedebruin/orgs","repos_url":"https://api.github.com/users/bolkedebruin/repos","events_url":"https://api.github.com/users/bolkedebruin/events{/privacy}","received_events_url":"https://api.github.com/users/bolkedebruin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-02T20:10:15Z","updated_at":"2017-09-02T20:10:15Z","author_association":"CONTRIBUTOR","body":"@drcrallen If you have some hints where the actual files are read and written (rebalance, load from deep storage) I can try a patch myself.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326766873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326779278","html_url":"https://github.com/apache/druid/pull/4747#issuecomment-326779278","issue_url":"https://api.github.com/repos/apache/druid/issues/4747","id":326779278,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjc3OTI3OA==","user":{"login":"kevinconaway","id":6921953,"node_id":"MDQ6VXNlcjY5MjE5NTM=","avatar_url":"https://avatars.githubusercontent.com/u/6921953?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinconaway","html_url":"https://github.com/kevinconaway","followers_url":"https://api.github.com/users/kevinconaway/followers","following_url":"https://api.github.com/users/kevinconaway/following{/other_user}","gists_url":"https://api.github.com/users/kevinconaway/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinconaway/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinconaway/subscriptions","organizations_url":"https://api.github.com/users/kevinconaway/orgs","repos_url":"https://api.github.com/users/kevinconaway/repos","events_url":"https://api.github.com/users/kevinconaway/events{/privacy}","received_events_url":"https://api.github.com/users/kevinconaway/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T01:51:36Z","updated_at":"2017-09-03T02:29:31Z","author_association":"CONTRIBUTOR","body":"The `CuratorDruidLeaderSelectorTest` from #4699 test seems fail intermittently.  I see it failing on another PR as well: https://travis-ci.org/druid-io/druid/jobs/271134762","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326779278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326780157","html_url":"https://github.com/apache/druid/pull/4747#issuecomment-326780157","issue_url":"https://api.github.com/repos/apache/druid/issues/4747","id":326780157,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjc4MDE1Nw==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T02:21:39Z","updated_at":"2017-09-03T02:21:39Z","author_association":"CONTRIBUTOR","body":"I restarted the failed job.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326780157/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326785299","html_url":"https://github.com/apache/druid/issues/4743#issuecomment-326785299","issue_url":"https://api.github.com/repos/apache/druid/issues/4743","id":326785299,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjc4NTI5OQ==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T05:27:05Z","updated_at":"2017-09-03T05:27:05Z","author_association":"MEMBER","body":"True that `published` state need not be maintained. However, I don't understand what you mean by `inactive` state. Using state machine to keep track of segment state is a good idea, the state can be persisted to disk as part of wrapped commit metadata. However, there may still be a need for an in-memory structure (not persisted to disk anytime) to keep track of currently publishing segments for a sequence. As the `publish` call is an external trigger by a task, so multiple calls to publish same sequence should be de-duplicated based on this structure and on restart of task, a call to publish same sequence should actually trigger a publish as the sequence/segments would not be present in the in-memory structure.\r\n\r\nThe main thing is to prevent multiple publish of same sequence on duplicate publish requests and more importantly to actually redo publish of segments for a sequence after the task is restarted if previous publish request did not complete fully. So, if this can be achieved by using only state machine then I am good with that.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326785299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326794055","html_url":"https://github.com/apache/druid/issues/4743#issuecomment-326794055","issue_url":"https://api.github.com/repos/apache/druid/issues/4743","id":326794055,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjc5NDA1NQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T09:27:25Z","updated_at":"2017-09-03T09:27:25Z","author_association":"CONTRIBUTOR","body":"> I don't understand what you mean by inactive state.\r\n\r\nSorry for insufficient description. ```inactive``` state means that a segment is not published yet but data is not added anymore. It can be thought as the segments which are in publishPendingSegments but not in activeSegments in the current implementation. Maybe there is a better name for this state.\r\n\r\n> The main thing is to prevent multiple publish of same sequence on duplicate publish requests and more importantly to actually redo publish of segments for a sequence after the task is restarted if previous publish request did not complete fully. \r\n\r\nI thought that this could be achieved by maintaining the segments' state machines in an in-memory structure like ```Map<sequenceName, NavigableMap<Interval, SegmentState>>```. A ```SegmentState``` contains at least a segment identifier and a state of the segment. Once ```publish()``` is called, the states of the segments to be published are changed to ```publishing```. If the ```publish()``` is called for the same sequence (and same segments), AppenderatorDriver first checks the states of the segments and won't publish them because they are already in the ```publishing``` state. \r\n\r\nI think this can solve the problem because all segments are kept in memory until they are published. Please correct me if I missed something.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326794055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326810425","html_url":"https://github.com/apache/druid/issues/4743#issuecomment-326810425","issue_url":"https://api.github.com/repos/apache/druid/issues/4743","id":326810425,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjgxMDQyNQ==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T15:05:54Z","updated_at":"2017-09-03T15:05:54Z","author_association":"MEMBER","body":"So can the segments move directly from `active` to `publishing` state ? I don't see what are we gaining from putting them in `inactive` state.\r\n\r\nThe map for maintaining the state of segments can look like `Map<SequenceName, List<SegmentState>>`, I am not sure why interval is needed here. As you explained, `publishing` state can be used from preventing publishing same sequence twice but you didn't explained what will happen when the task restarts, will this map (with segment states) be persisted to disk or it will be rebuilt again on restart ? What state the segments will be when restart happens ? How will the driver know if a sequence was in `publishing` state when task restarted so that when a call is made to publish same sequence again, it should actually start publishing it again ?\r\n\r\nSorry these points are not clear to me, can you please clarify. Thanks","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326810425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326812537","html_url":"https://github.com/apache/druid/issues/4746#issuecomment-326812537","issue_url":"https://api.github.com/repos/apache/druid/issues/4746","id":326812537,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjgxMjUzNw==","user":{"login":"drcrallen","id":8213081,"node_id":"MDQ6VXNlcjgyMTMwODE=","avatar_url":"https://avatars.githubusercontent.com/u/8213081?v=4","gravatar_id":"","url":"https://api.github.com/users/drcrallen","html_url":"https://github.com/drcrallen","followers_url":"https://api.github.com/users/drcrallen/followers","following_url":"https://api.github.com/users/drcrallen/following{/other_user}","gists_url":"https://api.github.com/users/drcrallen/gists{/gist_id}","starred_url":"https://api.github.com/users/drcrallen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drcrallen/subscriptions","organizations_url":"https://api.github.com/users/drcrallen/orgs","repos_url":"https://api.github.com/users/drcrallen/repos","events_url":"https://api.github.com/users/drcrallen/events{/privacy}","received_events_url":"https://api.github.com/users/drcrallen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T15:42:17Z","updated_at":"2017-09-03T15:42:36Z","author_association":"CONTRIBUTOR","body":"The segment loading is done in `io.druid.segment.loading.DataSegmentPuller` implementations.\r\n\r\nAs an alternative, something I've suggested internally is to look at changing the file format so that the data that is pulled down is queried against as-is, without needing to decompress (write twice) that should, in theory, reduce the page cache thrashing from segment loading.\r\n\r\nAs far as \"getting faster\" the only way to really measure if page cache is affecting queries is to disable druid-level caching, which can be done at query time or as part of a node's configuration.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326812537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326815113","html_url":"https://github.com/apache/druid/issues/4746#issuecomment-326815113","issue_url":"https://api.github.com/repos/apache/druid/issues/4746","id":326815113,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjgxNTExMw==","user":{"login":"bolkedebruin","id":4282712,"node_id":"MDQ6VXNlcjQyODI3MTI=","avatar_url":"https://avatars.githubusercontent.com/u/4282712?v=4","gravatar_id":"","url":"https://api.github.com/users/bolkedebruin","html_url":"https://github.com/bolkedebruin","followers_url":"https://api.github.com/users/bolkedebruin/followers","following_url":"https://api.github.com/users/bolkedebruin/following{/other_user}","gists_url":"https://api.github.com/users/bolkedebruin/gists{/gist_id}","starred_url":"https://api.github.com/users/bolkedebruin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bolkedebruin/subscriptions","organizations_url":"https://api.github.com/users/bolkedebruin/orgs","repos_url":"https://api.github.com/users/bolkedebruin/repos","events_url":"https://api.github.com/users/bolkedebruin/events{/privacy}","received_events_url":"https://api.github.com/users/bolkedebruin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T16:28:21Z","updated_at":"2017-09-03T16:50:37Z","author_association":"CONTRIBUTOR","body":"Thanks. I'll have a look. \r\n\r\nBasically what you are saying is that the issue might be bigger than expected. I don't know enough about the code but I suspect the following happens:\r\n\r\n1. Download segment and write to temporary file\r\n2. Read temp and write to file\r\n\r\nIf this is the case it potentially poisons the cache twice, unfortunately. First with writing the temporary file (whole file in cache) and then the uncompressed file. \r\n\r\nIdeally, you would read from the download stream and, currently, decompress on the fly and then write in 8mb chunks while setting FADV_DONTNEED on every chunk. 8mb is the recommended size for sequential files by Linus Torvalds (I need to lookup the reference couldn't find it right away). This could be an alternative to changing your file format I guess, but you could do that nevertheless. \r\n\r\nI'll make some time to test properly, but that will probably after 2 weeks as we need the performance for user testing at the moment.\r\n\r\nUpdate: I saw that uncompressing happens on the fly. So only if you need to convert to another format you poison the cache twice, which seems to be the case as you mentioned. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326815113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326829567","html_url":"https://github.com/apache/druid/pull/4171#issuecomment-326829567","issue_url":"https://api.github.com/repos/apache/druid/issues/4171","id":326829567,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjgyOTU2Nw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T20:34:58Z","updated_at":"2017-09-03T20:34:58Z","author_association":"CONTRIBUTOR","body":"Based on the following evidence the licensing seems ok to me.\r\n\r\n- The [Maven artifact](http://search.maven.org/#artifactdetails%7Cnet.thisptr%7Cjackson-jq-parent%7C0.0.7%7Cpom) lists an Apache license.\r\n- The [COPYING](https://github.com/eiiches/jackson-jq/blob/2c8baea46d43c43e67cb422631dc0fb077c5cbcb/COPYING) file in the source repo spells out the licensing info in more detail. It says portions are copyright Eiichi Sato and are Apache licensed, and portions are copyright Stephen Dolan and are MIT licensed.\r\n- https://www.apache.org/legal/resolved.html says the ASF considers MIT licensed dependencies valid for use in Apache licensed projects. So the mix of Apache and MIT licensed code should be fine by that logic.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326829567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326832908","html_url":"https://github.com/apache/druid/issues/4021#issuecomment-326832908","issue_url":"https://api.github.com/repos/apache/druid/issues/4021","id":326832908,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjgzMjkwOA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T21:39:11Z","updated_at":"2017-09-03T21:39:11Z","author_association":"CONTRIBUTOR","body":"@knepperjm, are you just seeing the excessive logging of \"skipping doNext\" messages or are you seeing some other issue? The excessive logging is \"harmless\" (other than being annoying) and is fixed for the next release by #4680.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326832908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326832966","html_url":"https://github.com/apache/druid/issues/4740#issuecomment-326832966","issue_url":"https://api.github.com/repos/apache/druid/issues/4740","id":326832966,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjgzMjk2Ng==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T21:40:31Z","updated_at":"2017-09-03T21:40:31Z","author_association":"CONTRIBUTOR","body":"@zhangxinyu1 I think the simple answer is that it's because gzip is supported by jetty. You could try setting `druid.broker.http.compressionCodec=identity` and see if that helps your performance. Or, a patch to add lz4 support would be welcome (although I'm not sure what the best way is to do that)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326832966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326833009","html_url":"https://github.com/apache/druid/pull/4648#issuecomment-326833009","issue_url":"https://api.github.com/repos/apache/druid/issues/4648","id":326833009,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjgzMzAwOQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-03T21:41:24Z","updated_at":"2017-09-03T21:41:24Z","author_association":"CONTRIBUTOR","body":"@lizhanhui, the error seems to be an unused import.\r\n\r\n```\r\n[ERROR] /home/travis/build/druid-io/druid/extensions-contrib/druid-rocketmq/src/main/java/io/druid/firehose/rocketmq/RocketMQFirehoseFactory.java:38:8: Unused import - java.util.Iterator. [UnusedImports]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326833009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326850933","html_url":"https://github.com/apache/druid/issues/4748#issuecomment-326850933","issue_url":"https://api.github.com/repos/apache/druid/issues/4748","id":326850933,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjg1MDkzMw==","user":{"login":"PamodLen","id":7941513,"node_id":"MDQ6VXNlcjc5NDE1MTM=","avatar_url":"https://avatars.githubusercontent.com/u/7941513?v=4","gravatar_id":"","url":"https://api.github.com/users/PamodLen","html_url":"https://github.com/PamodLen","followers_url":"https://api.github.com/users/PamodLen/followers","following_url":"https://api.github.com/users/PamodLen/following{/other_user}","gists_url":"https://api.github.com/users/PamodLen/gists{/gist_id}","starred_url":"https://api.github.com/users/PamodLen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PamodLen/subscriptions","organizations_url":"https://api.github.com/users/PamodLen/orgs","repos_url":"https://api.github.com/users/PamodLen/repos","events_url":"https://api.github.com/users/PamodLen/events{/privacy}","received_events_url":"https://api.github.com/users/PamodLen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-04T02:12:52Z","updated_at":"2017-09-04T02:12:52Z","author_association":"NONE","body":"change eclipse generate success.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326850933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326863161","html_url":"https://github.com/apache/druid/issues/4740#issuecomment-326863161","issue_url":"https://api.github.com/repos/apache/druid/issues/4740","id":326863161,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjg2MzE2MQ==","user":{"login":"zhangxinyu1","id":12528894,"node_id":"MDQ6VXNlcjEyNTI4ODk0","avatar_url":"https://avatars.githubusercontent.com/u/12528894?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangxinyu1","html_url":"https://github.com/zhangxinyu1","followers_url":"https://api.github.com/users/zhangxinyu1/followers","following_url":"https://api.github.com/users/zhangxinyu1/following{/other_user}","gists_url":"https://api.github.com/users/zhangxinyu1/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangxinyu1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangxinyu1/subscriptions","organizations_url":"https://api.github.com/users/zhangxinyu1/orgs","repos_url":"https://api.github.com/users/zhangxinyu1/repos","events_url":"https://api.github.com/users/zhangxinyu1/events{/privacy}","received_events_url":"https://api.github.com/users/zhangxinyu1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-04T04:24:12Z","updated_at":"2017-09-04T04:24:12Z","author_association":"CONTRIBUTOR","body":"@gianm Yes, jetty only support gzip and identity. If we set druid.broker.http.compressionCodec=identity, the groupBy query will much faster, but the bandwidth will become the bottleneck.  I have an idea as follows:\r\n1. Set druid.broker.http.compressionCodec=identity as default\r\n2. Compress result data with lz4 or other compressionCodec before historical return it.\r\n3. Decompress result data after broker receive it.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326863161/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326863789","html_url":"https://github.com/apache/druid/issues/4740#issuecomment-326863789","issue_url":"https://api.github.com/repos/apache/druid/issues/4740","id":326863789,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjg2Mzc4OQ==","user":{"login":"zhangxinyu1","id":12528894,"node_id":"MDQ6VXNlcjEyNTI4ODk0","avatar_url":"https://avatars.githubusercontent.com/u/12528894?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangxinyu1","html_url":"https://github.com/zhangxinyu1","followers_url":"https://api.github.com/users/zhangxinyu1/followers","following_url":"https://api.github.com/users/zhangxinyu1/following{/other_user}","gists_url":"https://api.github.com/users/zhangxinyu1/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangxinyu1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangxinyu1/subscriptions","organizations_url":"https://api.github.com/users/zhangxinyu1/orgs","repos_url":"https://api.github.com/users/zhangxinyu1/repos","events_url":"https://api.github.com/users/zhangxinyu1/events{/privacy}","received_events_url":"https://api.github.com/users/zhangxinyu1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-04T04:31:50Z","updated_at":"2017-09-04T04:34:13Z","author_association":"CONTRIBUTOR","body":"@gianm In DruidDefaultSerializersModule.java, JsonSerializer do sorting, serializing and compressing in one thread. That causes what I see (In historical node, only one cpu is used for a long time when I send a groupby query.)\r\nIs it possible to parallelize these three operations?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326863789/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326867070","html_url":"https://github.com/apache/druid/issues/4743#issuecomment-326867070","issue_url":"https://api.github.com/repos/apache/druid/issues/4743","id":326867070,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjg2NzA3MA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-04T05:07:26Z","updated_at":"2017-09-04T05:07:26Z","author_association":"CONTRIBUTOR","body":"Sure. Here are more details.\r\n\r\n> The map for maintaining the state of segments can look like Map<SequenceName, List<SegmentState>>, I am not sure why interval is needed here.\r\n\r\nIf this is ```Map<sequenceName, NavigableMap<Interval, SegmentState>>```, this map is the only one we should maintain. All segments should be in this map until they are published. The lifecycle of the segments in AppenderatorDriver will be \r\n\r\n- When AppenderatorDriver.add() is called, it first finds there is an active segment for the input row. This includes finding a segment from the inner NavigableMap using the input row's timestamp as a key. The interval is required here. If there isn't any segment of any state, AppenderatorDriver creates a new segment. If there is a segment of ```active``` state, it reuses that segment. Otherwise, it throws an exception.\r\n- If the number of rows exceeds a threshold (e.g.,  ```maxRowsPerSegment``` in KafkaIndexTask) after ```AppenderatorDriver.add()```, ```AppenderatorDriver.moveSegmentOut()``` can be called. This changes the segments' states from ```active``` to ```inactive```.\r\n- When ```AppenderatorDriver.publish()``` is called, it first changes the states of the segments from ```active``` or ```inactive``` to ```publishing```, and calls ```Appenderator.push()```. Once push() is finished, it publishes the pushed segments.\r\n- Once segments are published, those segments are removed from the map.\r\n\r\nThe state transition can be summarized as active -> (inactive) -> publishing. Transition to inactive state is optional.\r\n\r\n> will this map (with segment states) be persisted to disk or it will be rebuilt again on restart ? What state the segments will be when restart happens ? \r\n\r\nYes, this map should be persisted when committer runs. On a task restart, the map is read from the commit metadata. \r\n\r\nThe segment states on task restart can be different depending on the implementation. Here are some solutions I can think of now.\r\n\r\n- Since the kafka consumer can be rewound on task restart, the same records should be able to be added to the driver. So, the segment states in the map should not be ```publishing``` on task restart. This can be achieved by calling ```wrapCommitter()``` before changing segment states in ```AppenderatorDriver.publish()```.\r\n- I think it's better if AppenderatorDriver can publish the segments in ```publishing``` state by itself on task restart. It means, the segment states should be changed to ```publishing``` before ```wrapCommitter()```. On a task restart, the task don't have to rewind the kafka consumer for the segments which are already in ```publishing``` state because AppenderatorDriver will retry publishing those segments by itself. This will remove the duplicated data processing on task restart in the first solution. I guess this solution may involve some changes in the current implementation of KafkaIndexTask.\r\n\r\n> How will the driver know if a sequence was in publishing state when task restarted so that when a call is made to publish same sequence again, it should actually start publishing it again ?\r\n\r\nThe driver is able to know that each segment is in which state. When a task restarts, the driver should be able to find the segments to be published in the map because every segment are in there until they are published. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326867070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/326963470","html_url":"https://github.com/apache/druid/issues/4743#issuecomment-326963470","issue_url":"https://api.github.com/repos/apache/druid/issues/4743","id":326963470,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjk2MzQ3MA==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-04T13:28:03Z","updated_at":"2017-09-04T13:28:14Z","author_association":"MEMBER","body":"Thanks for the detailed explanation. The state transitions look good to me, you have already pointed out but mentioning it again that state transition to inactive should not be mandatory as some task may not call `moveSegmentOut` method but may directly call `publish` once segment row threshold is reached.\r\n\r\nFor the restart logic, I think rewinding Kafka consumer may not be a good idea, its just extra work and can be problematic if retention on Kafka side is low. I like the idea of driver start publishing the segment by itself, however the only problem I can see there is how the task will get the future for publishing segments, as the task cannot start new publish until the previous one is done and also the task does few things when a publish future is resolved like registering for handoff, adjusting its metadata etc. May be the `startJob` method can return futures for publishes restarted by the driver after task is restarted in addition to other metadata. Is that what you have in mind ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/326963470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327047843","html_url":"https://github.com/apache/druid/pull/4751#issuecomment-327047843","issue_url":"https://api.github.com/repos/apache/druid/issues/4751","id":327047843,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzA0Nzg0Mw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T01:24:33Z","updated_at":"2017-09-05T01:24:33Z","author_association":"CONTRIBUTOR","body":"@kaijianding, as the original author of #3307 would you like to review this?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327047843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327066996","html_url":"https://github.com/apache/druid/pull/4752#issuecomment-327066996","issue_url":"https://api.github.com/repos/apache/druid/issues/4752","id":327066996,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzA2Njk5Ng==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T04:15:25Z","updated_at":"2017-09-05T04:15:25Z","author_association":"MEMBER","body":"There are two `apache.curator.version` lines now","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327066996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327067611","html_url":"https://github.com/apache/druid/pull/4752#issuecomment-327067611","issue_url":"https://api.github.com/repos/apache/druid/issues/4752","id":327067611,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzA2NzYxMQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T04:21:51Z","updated_at":"2017-09-05T04:21:51Z","author_association":"CONTRIBUTOR","body":"Ah, that was a conflict resolution mishap… fixed it.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327067611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327089905","html_url":"https://github.com/apache/druid/issues/4734#issuecomment-327089905","issue_url":"https://api.github.com/repos/apache/druid/issues/4734","id":327089905,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzA4OTkwNQ==","user":{"login":"wysstartgo","id":10540192,"node_id":"MDQ6VXNlcjEwNTQwMTky","avatar_url":"https://avatars.githubusercontent.com/u/10540192?v=4","gravatar_id":"","url":"https://api.github.com/users/wysstartgo","html_url":"https://github.com/wysstartgo","followers_url":"https://api.github.com/users/wysstartgo/followers","following_url":"https://api.github.com/users/wysstartgo/following{/other_user}","gists_url":"https://api.github.com/users/wysstartgo/gists{/gist_id}","starred_url":"https://api.github.com/users/wysstartgo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wysstartgo/subscriptions","organizations_url":"https://api.github.com/users/wysstartgo/orgs","repos_url":"https://api.github.com/users/wysstartgo/repos","events_url":"https://api.github.com/users/wysstartgo/events{/privacy}","received_events_url":"https://api.github.com/users/wysstartgo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T07:06:38Z","updated_at":"2017-09-05T07:06:38Z","author_association":"NONE","body":"I test druid 0.10.0 and 0.10.1  ,the DoubleFirstAggregatorFactory and DoubleLastAggregatorFactory can't work and occur  java.lang.ClassCastException: java.lang.Double cannot be cast to java.util.Map\r\nat io.druid.query.aggregation.first.DoubleFirstAggregatorFactory.deserialize(DoubleFirstAggregatorFactory.java:175) .But it can works well in linux console as command like:\r\n curl -L -H'Content-Type: application/json' -XPOST --data-binary @quickstart/market-top.json http://localhost:8082/druid/v2/?pretty\r\n\r\n\r\nmarket-top.json is:\r\n{\r\n  \"queryType\" : \"topN\",\r\n  \"dataSource\" : \"market-wys-test\",\r\n  \"intervals\" : [\"2017-09-04/2017-09-05\"],\r\n  \"granularity\" : \"all\",\r\n  \"dimension\" : \"prodCode\",\r\n  \"metric\" : \"highPx\",\r\n  \"threshold\" : 25,\r\n  \"aggregations\" : [\r\n    {\r\n      \"type\" : \"doubleMax\",\r\n      \"name\" : \"highPx\",\r\n      \"fieldName\" : \"mostHighPx\"\r\n    },\r\n    {\r\n      \"type\" : \"doubleFirst\",\r\n      \"name\" : \"lowPx\",\r\n      \"fieldName\" : \"worstLowPx\"\r\n    }\r\n  ]\r\n}\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327089905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327139073","html_url":"https://github.com/apache/druid/issues/4743#issuecomment-327139073","issue_url":"https://api.github.com/repos/apache/druid/issues/4743","id":327139073,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzEzOTA3Mw==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T10:41:38Z","updated_at":"2017-09-05T10:41:38Z","author_association":"CONTRIBUTOR","body":"Yeah, it sounds needed. Or it's also possible that ```startJob()``` simply returns metadata including the segments in ```publishing``` state, and a task calls ```publish()``` and ```registerHandoff()``` for those segments. This is different from what I mentioned above because the one which is responsible for restarting publishing segments is the task not the AppenderatorDriver, but this is also able to avoid duplicated data processing. Please choose the one you think is better.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327139073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327177268","html_url":"https://github.com/apache/druid/issues/4743#issuecomment-327177268","issue_url":"https://api.github.com/repos/apache/druid/issues/4743","id":327177268,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzE3NzI2OA==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T13:36:22Z","updated_at":"2017-09-05T13:36:46Z","author_association":"MEMBER","body":"@jihoonson second approach sounds easier to plug with the current code I have. So, lets go with that if you think it is good. Also, it would be better if the driver can return sequence names instead of segment information.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327177268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327248208","html_url":"https://github.com/apache/druid/issues/4683#issuecomment-327248208","issue_url":"https://api.github.com/repos/apache/druid/issues/4683","id":327248208,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzI0ODIwOA==","user":{"login":"randerzander","id":1692914,"node_id":"MDQ6VXNlcjE2OTI5MTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1692914?v=4","gravatar_id":"","url":"https://api.github.com/users/randerzander","html_url":"https://github.com/randerzander","followers_url":"https://api.github.com/users/randerzander/followers","following_url":"https://api.github.com/users/randerzander/following{/other_user}","gists_url":"https://api.github.com/users/randerzander/gists{/gist_id}","starred_url":"https://api.github.com/users/randerzander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/randerzander/subscriptions","organizations_url":"https://api.github.com/users/randerzander/orgs","repos_url":"https://api.github.com/users/randerzander/repos","events_url":"https://api.github.com/users/randerzander/events{/privacy}","received_events_url":"https://api.github.com/users/randerzander/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T17:31:04Z","updated_at":"2017-09-05T17:31:04Z","author_association":"NONE","body":"The calcite-druid JDBC driver hasn't worked for me, so I'm hoping Druid's native SQL HTTP API gives my app a path forward.\r\n\r\nIs there a workaround for this, perhaps a temporary patch to the query router? If you can point to a starting point, I could try to contribute a fix.\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327248208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327249460","html_url":"https://github.com/apache/druid/pull/4171#issuecomment-327249460","issue_url":"https://api.github.com/repos/apache/druid/issues/4171","id":327249460,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzI0OTQ2MA==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T17:35:50Z","updated_at":"2017-09-05T17:35:50Z","author_association":"CONTRIBUTOR","body":"@b-slim can you please check ` jackson-jq` is alright to be added in apache license project.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327249460/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327255136","html_url":"https://github.com/apache/druid/pull/4751#issuecomment-327255136","issue_url":"https://api.github.com/repos/apache/druid/issues/4751","id":327255136,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzI1NTEzNg==","user":{"login":"kaijianding","id":8663725,"node_id":"MDQ6VXNlcjg2NjM3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8663725?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijianding","html_url":"https://github.com/kaijianding","followers_url":"https://api.github.com/users/kaijianding/followers","following_url":"https://api.github.com/users/kaijianding/following{/other_user}","gists_url":"https://api.github.com/users/kaijianding/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijianding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijianding/subscriptions","organizations_url":"https://api.github.com/users/kaijianding/orgs","repos_url":"https://api.github.com/users/kaijianding/repos","events_url":"https://api.github.com/users/kaijianding/events{/privacy}","received_events_url":"https://api.github.com/users/kaijianding/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T17:56:17Z","updated_at":"2017-09-05T17:56:17Z","author_association":"CONTRIBUTOR","body":"will review tommorrow","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327255136/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327255435","html_url":"https://github.com/apache/druid/pull/4752#issuecomment-327255435","issue_url":"https://api.github.com/repos/apache/druid/issues/4752","id":327255435,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzI1NTQzNQ==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T17:57:34Z","updated_at":"2017-09-05T17:57:34Z","author_association":"MEMBER","body":"A lot of tests in druid-server has failed, doesn't look like transient","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327255435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327272409","html_url":"https://github.com/apache/druid/pull/4744#issuecomment-327272409","issue_url":"https://api.github.com/repos/apache/druid/issues/4744","id":327272409,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzI3MjQwOQ==","user":{"login":"ginoledesma","id":879991,"node_id":"MDQ6VXNlcjg3OTk5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/879991?v=4","gravatar_id":"","url":"https://api.github.com/users/ginoledesma","html_url":"https://github.com/ginoledesma","followers_url":"https://api.github.com/users/ginoledesma/followers","following_url":"https://api.github.com/users/ginoledesma/following{/other_user}","gists_url":"https://api.github.com/users/ginoledesma/gists{/gist_id}","starred_url":"https://api.github.com/users/ginoledesma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ginoledesma/subscriptions","organizations_url":"https://api.github.com/users/ginoledesma/orgs","repos_url":"https://api.github.com/users/ginoledesma/repos","events_url":"https://api.github.com/users/ginoledesma/events{/privacy}","received_events_url":"https://api.github.com/users/ginoledesma/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T19:04:36Z","updated_at":"2017-09-05T19:05:08Z","author_association":"CONTRIBUTOR","body":"Updated PR to include a proposed fix. May need discussion to ensure this is the right way to do things.\r\n\r\nI fed getQuantiles() with more synthetic data sets to see that the numbers generated are sane. Since the algorithm is based off the BH/TT uniform() procedure, we know that `uj` should not exceed `s` given that `uj` should fall in the set of real numbers `{u1 < . . . < u~B}`, where `s = u~B`.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327272409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327301524","html_url":"https://github.com/apache/druid/issues/4753#issuecomment-327301524","issue_url":"https://api.github.com/repos/apache/druid/issues/4753","id":327301524,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzMwMTUyNA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T20:59:10Z","updated_at":"2017-09-05T20:59:10Z","author_association":"CONTRIBUTOR","body":"@jason166, you're right, hadoop tasks don't clean up.\r\n\r\nIf you wanted to take a stab at this, maybe you could do it by adding a `stop()` method to the Task interface, and having the ThreadPoolTaskRunner call that method if it's _not_ in restore mode (in which case it would call stopGracefully instead). I guess in that case, when `stop()` exits, then the ThreadPoolTaskRunner would still go ahead and interrupt the main thread.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327301524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327305762","html_url":"https://github.com/apache/druid/issues/4740#issuecomment-327305762","issue_url":"https://api.github.com/repos/apache/druid/issues/4740","id":327305762,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzMwNTc2Mg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T21:15:29Z","updated_at":"2017-09-05T21:15:29Z","author_association":"CONTRIBUTOR","body":"@zhangxinyu1 it's possible, although I haven't done much thinking about how to do it. https://github.com/druid-io/druid/pull/4704 may be related. I haven't reviewed that patch yet to see how related it is, but I plan to review it soon.\r\n\r\nOne thing that comes to mind is it will be important to make sure that backpressure exists. We don't want a laggy top layer to lead to excessive memory use from queued up objects from deeper layers. This happens \"automatically\" when using a single thread but would need to be explicitly assured if we do multithreading.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327305762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327306514","html_url":"https://github.com/apache/druid/issues/4683#issuecomment-327306514","issue_url":"https://api.github.com/repos/apache/druid/issues/4683","id":327306514,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzMwNjUxNA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T21:18:39Z","updated_at":"2017-09-05T21:18:39Z","author_association":"CONTRIBUTOR","body":"@randerzander, I take it you're using the Druid Router? (Druid SQL does work fine against the Broker)\r\n\r\nThe changes would need to start in AsyncQueryForwardingServlet. There's a part that assumes any request like `POST /druid/v2*` is a Druid native query. It's not a good assumption though, since `/druid/v2/sql/` would be a Druid SQL query, not a Druid native query.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327306514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/327308194","html_url":"https://github.com/apache/druid/issues/4746#issuecomment-327308194","issue_url":"https://api.github.com/repos/apache/druid/issues/4746","id":327308194,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzMwODE5NA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-09-05T21:26:06Z","updated_at":"2017-09-05T21:26:06Z","author_association":"CONTRIBUTOR","body":"@bolkedebruin, thanks for looking into this. Some tidbits that may(?) be useful.\r\n\r\n- #4364 changed the DataSegmentPuller behavior for a few implementations recently and seems related.\r\n- You mentioned \"the query cache on the broker\". Just wanted to warn you about something there: activating broker query cache forces historical nodes to disable their merge step and send un-merged per-segment results to the broker. This is because the query cache is a per-query-per-segment cache, so the broker needs per-segment results to be able to use it. For this reason it usually scales better to disable query cache on the broker, and instead enable it on historicals.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/327308194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]