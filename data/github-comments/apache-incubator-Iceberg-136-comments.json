[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/994988779","html_url":"https://github.com/apache/iceberg/pull/3734#issuecomment-994988779","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3734","id":994988779,"node_id":"IC_kwDOCW7NX847TlLr","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-15T17:06:49Z","updated_at":"2021-12-15T17:06:49Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/994988779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995026023","html_url":"https://github.com/apache/iceberg/pull/3754#issuecomment-995026023","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3754","id":995026023,"node_id":"IC_kwDOCW7NX847TuRn","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-15T17:52:12Z","updated_at":"2021-12-15T17:52:12Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdblue @RussellSpitzer @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995026023/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995030453","html_url":"https://github.com/apache/iceberg/pull/3755#issuecomment-995030453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3755","id":995030453,"node_id":"IC_kwDOCW7NX847TvW1","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-15T17:57:56Z","updated_at":"2021-12-15T17:57:56Z","author_association":"CONTRIBUTOR","body":"Thanks, @rdblue @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995030453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995039246","html_url":"https://github.com/apache/iceberg/pull/3757#issuecomment-995039246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3757","id":995039246,"node_id":"IC_kwDOCW7NX847TxgO","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-15T18:08:59Z","updated_at":"2021-12-15T18:08:59Z","author_association":"MEMBER","body":"cc: @RussellSpitzer , @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995039246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995065225","html_url":"https://github.com/apache/iceberg/pull/3753#issuecomment-995065225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3753","id":995065225,"node_id":"IC_kwDOCW7NX847T32J","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-15T18:36:55Z","updated_at":"2021-12-15T18:36:55Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995065225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995283213","html_url":"https://github.com/apache/iceberg/pull/3668#issuecomment-995283213","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3668","id":995283213,"node_id":"IC_kwDOCW7NX847UtEN","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-15T23:05:31Z","updated_at":"2021-12-15T23:05:31Z","author_association":"CONTRIBUTOR","body":"I am a bit hesitated with this change. It changes exception type from `IllegalArgumentException` to `ValidationException`, which will break any system that catches the specific exception type.\r\n\r\nI also talked in #3698 , which I will quote here:\r\n\r\n> I think that is already tested in `testCreateNamespaceBadName` and `testToDatabaseNameFailure`...But I agree the current `TestGlueCatalog` lacks a lot of features. I am thinking about implementing a proper local Glue client to test the code in unit test properly, let me know if you would like to pick up the task.\r\n\r\nI think that is the right way to go about this whole situation, comparing to checking the exact error message.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995283213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995328170","html_url":"https://github.com/apache/iceberg/pull/3757#issuecomment-995328170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3757","id":995328170,"node_id":"IC_kwDOCW7NX847U4Cq","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T00:34:17Z","updated_at":"2021-12-16T00:34:17Z","author_association":"CONTRIBUTOR","body":"Thanks. I think this is short enough to fix, could you directly do it across all versions affected?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995328170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995342861","html_url":"https://github.com/apache/iceberg/pull/3722#issuecomment-995342861","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3722","id":995342861,"node_id":"IC_kwDOCW7NX847U7oN","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T00:59:47Z","updated_at":"2021-12-16T00:59:47Z","author_association":"CONTRIBUTOR","body":"Thanks, @wypoon! This looks great I think we can get it in with a couple minor changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995342861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995363975","html_url":"https://github.com/apache/iceberg/pull/3645#issuecomment-995363975","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3645","id":995363975,"node_id":"IC_kwDOCW7NX847VAyH","user":{"login":"hbgstc123","id":8900183,"node_id":"MDQ6VXNlcjg5MDAxODM=","avatar_url":"https://avatars.githubusercontent.com/u/8900183?v=4","gravatar_id":"","url":"https://api.github.com/users/hbgstc123","html_url":"https://github.com/hbgstc123","followers_url":"https://api.github.com/users/hbgstc123/followers","following_url":"https://api.github.com/users/hbgstc123/following{/other_user}","gists_url":"https://api.github.com/users/hbgstc123/gists{/gist_id}","starred_url":"https://api.github.com/users/hbgstc123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbgstc123/subscriptions","organizations_url":"https://api.github.com/users/hbgstc123/orgs","repos_url":"https://api.github.com/users/hbgstc123/repos","events_url":"https://api.github.com/users/hbgstc123/events{/privacy}","received_events_url":"https://api.github.com/users/hbgstc123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T01:44:53Z","updated_at":"2021-12-16T01:44:53Z","author_association":"CONTRIBUTOR","body":"Hi@kbendick. Do you have time to take an another look and see if i'm fixing the right place. thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995363975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995364718","html_url":"https://github.com/apache/iceberg/pull/3645#issuecomment-995364718","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3645","id":995364718,"node_id":"IC_kwDOCW7NX847VA9u","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T01:46:45Z","updated_at":"2021-12-16T01:46:45Z","author_association":"CONTRIBUTOR","body":"> Hi@kbendick. Do you have time to take an another look and see if i'm fixing the right place. thanks\r\n\r\nYes. I should hopefully this weekend as I’m currently working in the same area of the codebase m. Thanks for the ping. 👍","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995364718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995401168","html_url":"https://github.com/apache/iceberg/pull/3722#issuecomment-995401168","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3722","id":995401168,"node_id":"IC_kwDOCW7NX847VJ3Q","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T03:15:36Z","updated_at":"2021-12-16T03:15:36Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks for all the reviews. I adopted your suggestion around `SparkTable#newScanBuilder` and `SparkTable.addSnapshotId`, and made the other tweaks you suggested.\r\n@jackye1995 thanks for your reviews and suggestions too.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995401168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995413583","html_url":"https://github.com/apache/iceberg/pull/3757#issuecomment-995413583","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3757","id":995413583,"node_id":"IC_kwDOCW7NX847VM5P","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T03:47:24Z","updated_at":"2021-12-16T03:47:24Z","author_association":"MEMBER","body":"> Thanks. I think this is short enough to fix, could you directly do it across all versions affected?\r\n\r\n@jackye1995 : I will do that once PR is approved. Else I might have to rework on multiple files if I get comments. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995413583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995520817","html_url":"https://github.com/apache/iceberg/pull/3730#issuecomment-995520817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3730","id":995520817,"node_id":"IC_kwDOCW7NX847VnEx","user":{"login":"alexkingli","id":20436684,"node_id":"MDQ6VXNlcjIwNDM2Njg0","avatar_url":"https://avatars.githubusercontent.com/u/20436684?v=4","gravatar_id":"","url":"https://api.github.com/users/alexkingli","html_url":"https://github.com/alexkingli","followers_url":"https://api.github.com/users/alexkingli/followers","following_url":"https://api.github.com/users/alexkingli/following{/other_user}","gists_url":"https://api.github.com/users/alexkingli/gists{/gist_id}","starred_url":"https://api.github.com/users/alexkingli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexkingli/subscriptions","organizations_url":"https://api.github.com/users/alexkingli/orgs","repos_url":"https://api.github.com/users/alexkingli/repos","events_url":"https://api.github.com/users/alexkingli/events{/privacy}","received_events_url":"https://api.github.com/users/alexkingli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T07:46:45Z","updated_at":"2021-12-16T07:46:45Z","author_association":"NONE","body":"> The `FileIO` API is quite narrow by design. I would not think that the community would agree to add new method to it.\r\n> \r\n> I think the easiest way forward would be to convince Hive to drop the table data. It should be possible to do it based on the value of `ifPurge` https://github.com/apache/hive/blob/rel/release-3.1.2/standalone-metastore/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java#L2548\r\n\r\nI think we can slove this problem  by merging pr1839., but it was made long time ago and wasn't merged into the release.  Maybe you are right,it is not a big problem for the moment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995520817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995691825","html_url":"https://github.com/apache/iceberg/issues/3741#issuecomment-995691825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3741","id":995691825,"node_id":"IC_kwDOCW7NX847WQ0x","user":{"login":"yohengyang","id":39874737,"node_id":"MDQ6VXNlcjM5ODc0NzM3","avatar_url":"https://avatars.githubusercontent.com/u/39874737?v=4","gravatar_id":"","url":"https://api.github.com/users/yohengyang","html_url":"https://github.com/yohengyang","followers_url":"https://api.github.com/users/yohengyang/followers","following_url":"https://api.github.com/users/yohengyang/following{/other_user}","gists_url":"https://api.github.com/users/yohengyang/gists{/gist_id}","starred_url":"https://api.github.com/users/yohengyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yohengyang/subscriptions","organizations_url":"https://api.github.com/users/yohengyang/orgs","repos_url":"https://api.github.com/users/yohengyang/repos","events_url":"https://api.github.com/users/yohengyang/events{/privacy}","received_events_url":"https://api.github.com/users/yohengyang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T11:10:16Z","updated_at":"2021-12-22T03:00:06Z","author_association":"NONE","body":"> I'm confused about the task.next(), issue. From what I can see task.next should be checking the parallel iterable queue which starts by calling hasNext which repopulates the queue if it has any empty slots. It populates these slots with a runnable of the entry in the iterable.\r\n> \r\n> https://github.com/apache/iceberg/blob/f71091539e1fa9e4064cfbc5141fe3e890e1a5f0/core/src/main/java/org/apache/iceberg/util/ParallelIterable.java#L63-L73\r\n> \r\n> Also has anyone checked to see whether just increasing the parallelism of the work pool would work?\r\n\r\n@RussellSpitzer  What you said is okay, There is no problem with the logic of ParallelIterable itself. The problem is that iterables is actually a TransformedIterator, which is wrapped by the ManifestGroup#entries method, and when call iterables.next, it will first call the following transform logic. The following code will go to hdfs to read the arvo file, sometimes it is very slow, thus blocking the submission\r\n\r\nhttps://github.com/apache/iceberg/blob/f71091539e1fa9e4064cfbc5141fe3e890e1a5f0/core/src/main/java/org/apache/iceberg/ManifestGroup.java#L239-L264","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995691825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995717883","html_url":"https://github.com/apache/iceberg/issues/3127#issuecomment-995717883","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3127","id":995717883,"node_id":"IC_kwDOCW7NX847WXL7","user":{"login":"ywww","id":10680248,"node_id":"MDQ6VXNlcjEwNjgwMjQ4","avatar_url":"https://avatars.githubusercontent.com/u/10680248?v=4","gravatar_id":"","url":"https://api.github.com/users/ywww","html_url":"https://github.com/ywww","followers_url":"https://api.github.com/users/ywww/followers","following_url":"https://api.github.com/users/ywww/following{/other_user}","gists_url":"https://api.github.com/users/ywww/gists{/gist_id}","starred_url":"https://api.github.com/users/ywww/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywww/subscriptions","organizations_url":"https://api.github.com/users/ywww/orgs","repos_url":"https://api.github.com/users/ywww/repos","events_url":"https://api.github.com/users/ywww/events{/privacy}","received_events_url":"https://api.github.com/users/ywww/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T11:45:54Z","updated_at":"2021-12-16T11:45:54Z","author_association":"NONE","body":"hive3.1.2  the same proplem\r\n\r\n-----------------------------------------\r\n\r\nhive> drop table test.hive_iceberg_test1;\r\nOK\r\nTime taken: 2.002 seconds\r\nhive> CREATE TABLE test.hive_iceberg_test1 (\r\n    >   id bigint, \r\n    >   name string\r\n    > ) PARTITIONED BY (\r\n    >   ds string\r\n    > ) \r\n    > STORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler';\r\nOK\r\nTime taken: 1.229 seconds\r\nhive> insert into table test.hive_iceberg_test1 select 1,'1',1;;\r\nQuery ID = root_20211216194143_6388a8d2-9b42-47a5-8685-587d43d0eaaf\r\nTotal jobs = 1\r\nLaunching Job 1 out of 1\r\nNumber of reduce tasks is set to 0 since there's no reduce operator\r\nStarting Job = job_1639039128241_0038, Tracking URL = http://emr-header-1.cluster-267641:20888/proxy/application_1639039128241_0038/\r\nKill Command = /usr/local/complat/adp/hadoop/bin/mapred job  -kill job_1639039128241_0038\r\nHadoop job information for Stage-2: number of mappers: 1; number of reducers: 0\r\n2021-12-16 19:41:56,284 Stage-2 map = 0%,  reduce = 0%\r\n2021-12-16 19:42:03,664 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 2.62 sec\r\nMapReduce Total cumulative CPU time: 2 seconds 620 msec\r\nEnded Job = job_1639039128241_0038 with errors\r\nError during job, obtaining debugging information...\r\nJob Tracking URL: http://emr-header-1.cluster-267641:20888/proxy/application_1639039128241_0038/\r\nExamining task ID: task_1639039128241_0038_m_000000 (and more) from job job_1639039128241_0038\r\nFAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask\r\nMapReduce Jobs Launched: \r\nStage-Stage-2: Map: 1   Cumulative CPU: 2.62 sec   HDFS Read: 178200 HDFS Write: 3484 FAIL\r\nTotal MapReduce CPU Time Spent: 2 seconds 620 msec\r\n-------------------------------------------\r\n\r\n\r\n2021-12-16 19:42:03,687 INFO [CommitterEvent Processor #1] org.apache.hadoop.hive.metastore.HiveMetaStoreClient: HMSC::open(): Could not find delegation token. Creating KERBEROS-based thrift connection.\r\n2021-12-16 19:42:03,718 ERROR [CommitterEvent Processor #1] org.apache.thrift.transport.TSaslTransport: SASL negotiation failure\r\njavax.security.sasl.SaslException: GSS initiate failed [Caused by GSSException: No valid credentials provided (Mechanism level: Failed to find any Kerberos tgt)]\r\n        at com.sun.security.sasl.gsskerb.GssKrb5Client.evaluateChallenge(GssKrb5Client.java:211)\r\n        at org.apache.thrift.transport.TSaslClientTransport.handleSaslStartMessage(TSaslClientTransport.java:94)\r\n        at org.apache.thrift.transport.TSaslTransport.open(TSaslTransport.java:271)\r\n        at org.apache.thrift.transport.TSaslClientTransport.open(TSaslClientTransport.java:37)\r\n        at org.apache.hadoop.hive.metastore.security.TUGIAssumingTransport$1.run(TUGIAssumingTransport.java:51)\r\n        at org.apache.hadoop.hive.metastore.security.TUGIAssumingTransport$1.run(TUGIAssumingTransport.java:48)\r\n        at java.security.AccessController.doPrivileged(Native Method)\r\n        at javax.security.auth.Subject.doAs(Subject.java:422)\r\n        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1732)\r\n        at org.apache.hadoop.hive.metastore.security.TUGIAssumingTransport.open(TUGIAssumingTransport.java:48)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.open(HiveMetaStoreClient.java:516)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:224)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:137)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.iceberg.common.DynConstructors$Ctor.newInstanceChecked(DynConstructors.java:60)\r\n        at org.apache.iceberg.common.DynConstructors$Ctor.newInstance(DynConstructors.java:73)\r\n        at org.apache.iceberg.hive.HiveClientPool.newClient(HiveClientPool.java:53)\r\n        at org.apache.iceberg.hive.HiveClientPool.newClient(HiveClientPool.java:32)\r\n        at org.apache.iceberg.ClientPoolImpl.get(ClientPoolImpl.java:118)\r\n        at org.apache.iceberg.ClientPoolImpl.run(ClientPoolImpl.java:49)\r\n        at org.apache.iceberg.hive.CachedClientPool.run(CachedClientPool.java:76)\r\n        at org.apache.iceberg.hive.HiveTableOperations.doRefresh(HiveTableOperations.java:181)\r\n        at org.apache.iceberg.BaseMetastoreTableOperations.refresh(BaseMetastoreTableOperations.java:94)\r\n        at org.apache.iceberg.BaseMetastoreTableOperations.current(BaseMetastoreTableOperations.java:77)\r\n        at org.apache.iceberg.BaseMetastoreCatalog.loadTable(BaseMetastoreCatalog.java:93)\r\n        at org.apache.iceberg.mr.Catalogs.loadTable(Catalogs.java:115)\r\n        at org.apache.iceberg.mr.Catalogs.loadTable(Catalogs.java:105)\r\n        at org.apache.iceberg.mr.hive.HiveIcebergOutputCommitter.commitTable(HiveIcebergOutputCommitter.java:280)\r\n        at org.apache.iceberg.mr.hive.HiveIcebergOutputCommitter.lambda$commitJob$2(HiveIcebergOutputCommitter.java:193)\r\n        at org.apache.iceberg.util.Tasks$Builder.runTaskWithRetry(Tasks.java:405)\r\n        at org.apache.iceberg.util.Tasks$Builder.runSingleThreaded(Tasks.java:214)\r\n        at org.apache.iceberg.util.Tasks$Builder.run(Tasks.java:198)\r\n        at org.apache.iceberg.util.Tasks$Builder.run(Tasks.java:190)\r\n        at org.apache.iceberg.mr.hive.HiveIcebergOutputCommitter.commitJob(HiveIcebergOutputCommitter.java:188)\r\n        at org.apache.hadoop.mapred.OutputCommitter.commitJob(OutputCommitter.java:291)\r\n        at org.apache.hadoop.mapreduce.v2.app.commit.CommitterEventHandler$EventProcessor.handleJobCommit(CommitterEventHandler.java:286)\r\n        at org.apache.hadoop.mapreduce.v2.app.commit.CommitterEventHandler$EventProcessor.run(CommitterEventHandler.java:238)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n        at java.lang.Thread.run(Thread.java:748)\r\nCaused by: GSSException: No valid credentials provided (Mechanism level: Failed to find any Kerberos tgt)\r\n        at sun.security.jgss.krb5.Krb5InitCredential.getInstance(Krb5InitCredential.java:162)\r\n        at sun.security.jgss.krb5.Krb5MechFactory.getCredentialElement(Krb5MechFactory.java:122)\r\n        at sun.security.jgss.krb5.Krb5MechFactory.getMechanismContext(Krb5MechFactory.java:189)\r\n        at sun.security.jgss.GSSManagerImpl.getMechanismContext(GSSManagerImpl.java:224)\r\n        at sun.security.jgss.GSSContextImpl.initSecContext(GSSContextImpl.java:212)\r\n        at sun.security.jgss.GSSContextImpl.initSecContext(GSSContextImpl.java:179)\r\n        at com.sun.security.sasl.gsskerb.GssKrb5Client.evaluateChallenge(GssKrb5Client.java:192)\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995717883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995754059","html_url":"https://github.com/apache/iceberg/pull/3730#issuecomment-995754059","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3730","id":995754059,"node_id":"IC_kwDOCW7NX847WgBL","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T12:06:23Z","updated_at":"2021-12-16T12:06:23Z","author_association":"CONTRIBUTOR","body":"So basically this is the same discussion as in #1839.\r\nWere you successful finding out why the HiveMetaStore does not delete the table directory in Hive 3.1.2?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995754059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995802734","html_url":"https://github.com/apache/iceberg/pull/3748#issuecomment-995802734","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3748","id":995802734,"node_id":"IC_kwDOCW7NX847Wr5u","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T13:11:16Z","updated_at":"2021-12-16T13:11:16Z","author_association":"CONTRIBUTOR","body":"Merged the PR.\r\nThanks @szlta for the contribution!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995802734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995829922","html_url":"https://github.com/apache/iceberg/issues/3750#issuecomment-995829922","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3750","id":995829922,"node_id":"IC_kwDOCW7NX847Wyii","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T13:42:31Z","updated_at":"2021-12-16T13:42:31Z","author_association":"CONTRIBUTOR","body":"I tried deleting these folders with commons-io `FileUtils`, but then tests start to fail with metastore internal errors. I think it's because we didn't clean up some static fields in metastore between different tests.\r\n\r\nSuch as the thread local TxnStore in HMSHandler: https://github.com/apache/hive/blob/rel/release-2.3.8/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java#L249\r\n\r\nand the connection pool in `TxnHandler`: https://github.com/apache/hive/blob/rel/release-2.3.8/metastore/src/java/org/apache/hadoop/hive/metastore/txn/TxnHandler.java#L149","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995829922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995885394","html_url":"https://github.com/apache/iceberg/issues/3750#issuecomment-995885394","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3750","id":995885394,"node_id":"IC_kwDOCW7NX847XAFS","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T14:47:28Z","updated_at":"2021-12-16T14:47:28Z","author_association":"CONTRIBUTOR","body":"@lirui-apache: If I recall correctly we usually start the HMS instance `BeforeClass` and close it in `AfterClass`. So deleting warehouse directories between tests would be counterproductive 😄 \r\n`TestHiveMetastore.reset()` tries to drop the extra databases, tables and folders. Is it called between tests?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/995885394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996064884","html_url":"https://github.com/apache/iceberg/pull/3723#issuecomment-996064884","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3723","id":996064884,"node_id":"IC_kwDOCW7NX847Xr50","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T18:19:37Z","updated_at":"2021-12-16T18:19:37Z","author_association":"CONTRIBUTOR","body":"> \"bag\" is added by hive's parquet serde, ql/src/java/org/apache/hadoop/hive/ql/io/parquet/serde/ParquetHiveSerDe.java\r\n\r\nSo sounds like the issue will only come when users load table through Hive and import to Iceberg through add-files procedure. Technically users could have a way out by using migrate-table procedure to rewrite the entire table using the Iceberg writer instead.\r\n\r\nBut this seems to impact quite a lot of users for fast Hive to Iceberg migration, so I will add this in 0.13 milestone for now, please let me know if anyone objects.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996064884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996082780","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-996082780","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":996082780,"node_id":"IC_kwDOCW7NX847XwRc","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T18:45:14Z","updated_at":"2021-12-16T18:45:14Z","author_association":"MEMBER","body":"I'm interested in getting this in soon, @rdblue did you have any remaining issues with the PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996082780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996089510","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-996089510","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":996089510,"node_id":"IC_kwDOCW7NX847Xx6m","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T18:54:01Z","updated_at":"2021-12-16T18:54:01Z","author_association":"CONTRIBUTOR","body":"> I'm interested in getting this in soon, @rdblue did you have any remaining issues with the PR?\r\n\r\nI think @rdblue mentioned he was going to try to find time to review this again (so it’s on his radar). If you can review and approve it or provide any remaining feedback, that would help move things along a good amount @RussellSpitzer 🙂","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996089510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996200065","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-996200065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":996200065,"node_id":"IC_kwDOCW7NX847YM6B","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T21:16:37Z","updated_at":"2021-12-16T21:16:37Z","author_association":"CONTRIBUTOR","body":"I'd like to do another pass at this, since this is a pretty delicate area of the code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996200065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996214087","html_url":"https://github.com/apache/iceberg/pull/3760#issuecomment-996214087","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3760","id":996214087,"node_id":"IC_kwDOCW7NX847YQVH","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-16T21:39:03Z","updated_at":"2021-12-16T21:41:34Z","author_association":"COLLABORATOR","body":"@rdblue @aokolnychyi @RussellSpitzer @jackye1995  fyi for comments on whether this is the right fix for the issue, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996214087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996355892","html_url":"https://github.com/apache/iceberg/pull/3535#issuecomment-996355892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3535","id":996355892,"node_id":"IC_kwDOCW7NX847Yy80","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T01:32:29Z","updated_at":"2021-12-17T01:32:29Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue for the review. Sorry for the delayed update. I agree we need more justification to remove streaming version. I will try to create another one with perf test for that. I'll update this PR to replace set with bitmap, and the refactor you mentioned for the class `PositionDeleteIndex`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996355892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996373614","html_url":"https://github.com/apache/iceberg/pull/3689#issuecomment-996373614","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3689","id":996373614,"node_id":"IC_kwDOCW7NX847Y3Ru","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T02:01:45Z","updated_at":"2021-12-17T02:01:45Z","author_association":"CONTRIBUTOR","body":"@rdblue Could you please have a look? thx.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996373614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996382892","html_url":"https://github.com/apache/iceberg/pull/3723#issuecomment-996382892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3723","id":996382892,"node_id":"IC_kwDOCW7NX847Y5is","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T02:23:44Z","updated_at":"2021-12-17T02:23:44Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer mind giving it another pass, thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996382892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996418064","html_url":"https://github.com/apache/iceberg/issues/3750#issuecomment-996418064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3750","id":996418064,"node_id":"IC_kwDOCW7NX847ZCIQ","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T04:01:11Z","updated_at":"2021-12-17T04:01:11Z","author_association":"CONTRIBUTOR","body":"Hi @pvary , I'm not trying to delete warehouse folders between test methods. I just want to make sure the clean up logic in `AfterClass` really does its job to delete these folders. Or do you mean even `AfterClass` shouldn't do this? Then I wonder where this can be done, because otherwise it slowly eats up the disk space in our CI runners.\r\n\r\nI checked `TestHiveMetastore.reset()`, seems it's only called in the `After` method of some tests in `iceberg-mr`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996418064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996430893","html_url":"https://github.com/apache/iceberg/pull/3732#issuecomment-996430893","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3732","id":996430893,"node_id":"IC_kwDOCW7NX847ZFQt","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T04:34:50Z","updated_at":"2021-12-17T04:34:50Z","author_association":"CONTRIBUTOR","body":"@kbendick Can you please review once you get time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996430893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996537302","html_url":"https://github.com/apache/iceberg/issues/3750#issuecomment-996537302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3750","id":996537302,"node_id":"IC_kwDOCW7NX847ZfPW","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T08:43:08Z","updated_at":"2021-12-17T08:43:08Z","author_association":"CONTRIBUTOR","body":"@lirui-apache: You are absolutely right that we should delete the warehouse folders in the `AfterClass`. I am surprised that the directory is not removed as we create it with `java.nio.file.Files.createTempDirectory(\"hive\", asFileAttribute(fromString(\"rwxrwxrwx\"))).toFile()`. From the doc:\r\n\r\n> As with the createTempFile methods, this method is only part of a temporary-file facility. A shutdown-hook, or the File.deleteOnExit mechanism may be used to delete the directory automatically.\r\n\r\n\r\nMaybe we just have to call after creation?\r\n```\r\n      this.hiveLocalDir.deleteOnExit();\r\n```\r\n\r\nAs for the `TestHiveMetastore .reset()`, I think it would be useful to call it in the `After` methods to separate the test cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996537302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996692420","html_url":"https://github.com/apache/iceberg/pull/3752#issuecomment-996692420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3752","id":996692420,"node_id":"IC_kwDOCW7NX847aFHE","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T12:40:33Z","updated_at":"2021-12-17T12:40:33Z","author_association":"CONTRIBUTOR","body":"Looks good to me now. @rdblue, @jackye1995, I would like to ask your opinion around this before committing.\r\nThanks,\r\nPeter\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996692420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996906901","html_url":"https://github.com/apache/iceberg/pull/3728#issuecomment-996906901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3728","id":996906901,"node_id":"IC_kwDOCW7NX847a5eV","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T17:47:23Z","updated_at":"2021-12-17T17:47:23Z","author_association":"CONTRIBUTOR","body":"@xiaotianzhang01 can you fix the description and summary for this? This is not adding any parsing to Iceberg, so the title is misleading. Instead, it producing Spark's SQL literal format for binary and updating the toString representation of binary/fixed literals.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996906901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996907561","html_url":"https://github.com/apache/iceberg/pull/3722#issuecomment-996907561","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3722","id":996907561,"node_id":"IC_kwDOCW7NX847a5op","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T17:48:25Z","updated_at":"2021-12-17T17:48:44Z","author_association":"CONTRIBUTOR","body":"@rdblue @jackye1995 if this can be merged, I'll prepare PRs for Spark 3.1 and 3.0 for porting it. I'll be on vacation for the next two weeks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996907561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996909687","html_url":"https://github.com/apache/iceberg/pull/3722#issuecomment-996909687","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3722","id":996909687,"node_id":"IC_kwDOCW7NX847a6J3","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T17:52:12Z","updated_at":"2021-12-17T17:52:12Z","author_association":"CONTRIBUTOR","body":"Thanks, @wypoon! Nice work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996909687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996910734","html_url":"https://github.com/apache/iceberg/pull/3535#issuecomment-996910734","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3535","id":996910734,"node_id":"IC_kwDOCW7NX847a6aO","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T17:53:59Z","updated_at":"2021-12-17T17:54:24Z","author_association":"CONTRIBUTOR","body":"It'd be nice to get into 0.13 release since it has the change of API `PositionDeleteIndex`. Otherwise, we need to go though the deprecated process for the API changes. @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996910734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996993351","html_url":"https://github.com/apache/iceberg/pull/3723#issuecomment-996993351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3723","id":996993351,"node_id":"IC_kwDOCW7NX847bOlH","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T19:50:16Z","updated_at":"2021-12-17T19:50:16Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @jackye1995 thanks for your reviews, the diff is updated to address your suggestions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/996993351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997030992","html_url":"https://github.com/apache/iceberg/pull/3752#issuecomment-997030992","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3752","id":997030992,"node_id":"IC_kwDOCW7NX847bXxQ","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T21:05:32Z","updated_at":"2021-12-17T21:05:32Z","author_association":"CONTRIBUTOR","body":"Sounds like what is needed here is not the ability to skip serialization of the config, but to add the ability to set the entire `FileIO` for a `SerializableTable` at worker node, because Hadoop configuration might not be the only thing that could take a lot of serialization space, and it seems like we are adding a special handling just for that.\r\n\r\nThere is also some security concerns in this approach when you say\r\n> also because executors might not be authorized to communicate with the metastore to load the table\r\n\r\nIn Trino we have a singleton `FileIOProvider`, which is responsible for creating `FileIO`s used for worker nodes to avoid these issues. I don't know if similar concern is valid for Hive.\r\n\r\nI think it is better if we can allow skipping serialization of the entire FileIO object, add some hooks like `SerializableTable.initializeFileIO(fileIO)`, and let the engine create `FileIO` based on their specific requirements outside the serialization logic.\r\n\r\nAny thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997030992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997056355","html_url":"https://github.com/apache/iceberg/pull/3723#issuecomment-997056355","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3723","id":997056355,"node_id":"IC_kwDOCW7NX847bd9j","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T22:01:15Z","updated_at":"2021-12-17T22:01:15Z","author_association":"MEMBER","body":"Thanks so much to @SinghAsDev for the PR and  @jackye1995 and @kbendick for the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997056355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997057690","html_url":"https://github.com/apache/iceberg/pull/3723#issuecomment-997057690","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3723","id":997057690,"node_id":"IC_kwDOCW7NX847beSa","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T22:04:13Z","updated_at":"2021-12-17T22:04:13Z","author_association":"CONTRIBUTOR","body":"Thanks for reviews @RussellSpitzer @jackye1995 @kbendick !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997057690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997070351","html_url":"https://github.com/apache/iceberg/pull/3766#issuecomment-997070351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3766","id":997070351,"node_id":"IC_kwDOCW7NX847bhYP","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T22:34:26Z","updated_at":"2021-12-17T22:35:39Z","author_association":"CONTRIBUTOR","body":"@jackye1995 @RussellSpitzer this is the follow up PR to address the notes format concern raised earlier. I have verified with `mkdocs serve` that changes are reflected correctly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997070351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997073423","html_url":"https://github.com/apache/iceberg/pull/3535#issuecomment-997073423","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3535","id":997073423,"node_id":"IC_kwDOCW7NX847biIP","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T22:43:07Z","updated_at":"2021-12-17T22:43:56Z","author_association":"CONTRIBUTOR","body":"Thanks @jackye1995 for the review. Made the change per your suggestion. To be clear, there is no need of perf test in this PR. I will open another PR for replacing the streaming part, which needs the perf test. I agreed with you about the interface. To add to it, the interface `PositionDeleteIndex` is introduced recently, and not in any existing release. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997073423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997074067","html_url":"https://github.com/apache/iceberg/pull/3766#issuecomment-997074067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3766","id":997074067,"node_id":"IC_kwDOCW7NX847biST","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-17T22:45:05Z","updated_at":"2021-12-17T22:45:05Z","author_association":"MEMBER","body":"Thanks @SinghAsDev !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997074067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997100301","html_url":"https://github.com/apache/iceberg/pull/3768#issuecomment-997100301","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3768","id":997100301,"node_id":"IC_kwDOCW7NX847bosN","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T00:05:42Z","updated_at":"2021-12-18T00:05:42Z","author_association":"CONTRIBUTOR","body":"Thanks, @wypoon! Ready to merge when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997100301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997100531","html_url":"https://github.com/apache/iceberg/pull/3769#issuecomment-997100531","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3769","id":997100531,"node_id":"IC_kwDOCW7NX847bovz","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T00:06:22Z","updated_at":"2021-12-18T00:06:22Z","author_association":"CONTRIBUTOR","body":"Will merge when tests are passing. Thanks, @wypoon!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997100531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997100614","html_url":"https://github.com/apache/iceberg/pull/3767#issuecomment-997100614","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3767","id":997100614,"node_id":"IC_kwDOCW7NX847boxG","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T00:06:39Z","updated_at":"2021-12-18T00:06:39Z","author_association":"MEMBER","body":"I will merge when tests pass","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997100614/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997100872","html_url":"https://github.com/apache/iceberg/pull/3765#issuecomment-997100872","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3765","id":997100872,"node_id":"IC_kwDOCW7NX847bo1I","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T00:07:33Z","updated_at":"2021-12-18T00:07:33Z","author_association":"CONTRIBUTOR","body":"Good catch! Merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997100872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997101102","html_url":"https://github.com/apache/iceberg/pull/3708#issuecomment-997101102","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3708","id":997101102,"node_id":"IC_kwDOCW7NX847bo4u","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T00:08:16Z","updated_at":"2021-12-18T00:08:16Z","author_association":"CONTRIBUTOR","body":"@xiaotianzhang01 do you want to take a look at test failures and update this? It would be good to get it into the next release!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997101102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997101447","html_url":"https://github.com/apache/iceberg/pull/3718#issuecomment-997101447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3718","id":997101447,"node_id":"IC_kwDOCW7NX847bo-H","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T00:09:27Z","updated_at":"2021-12-18T00:09:27Z","author_association":"CONTRIBUTOR","body":"I realize that this is already exposed through the API. But is there a need for SQL users to call this? Do you have people that need to do this or are you adding it because it is something exposed in Actions that is not present in the stored procedure?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997101447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997101953","html_url":"https://github.com/apache/iceberg/pull/3751#issuecomment-997101953","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3751","id":997101953,"node_id":"IC_kwDOCW7NX847bpGB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T00:11:04Z","updated_at":"2021-12-18T00:11:04Z","author_association":"CONTRIBUTOR","body":"Thanks, @racevedoo!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997101953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997110458","html_url":"https://github.com/apache/iceberg/pull/3561#issuecomment-997110458","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3561","id":997110458,"node_id":"IC_kwDOCW7NX847brK6","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T00:47:42Z","updated_at":"2021-12-18T00:47:42Z","author_association":"CONTRIBUTOR","body":"Closed in favor of https://github.com/apache/iceberg/pull/3770/files","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997110458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997127642","html_url":"https://github.com/apache/iceberg/pull/3757#issuecomment-997127642","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3757","id":997127642,"node_id":"IC_kwDOCW7NX847bvXa","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T02:26:51Z","updated_at":"2021-12-18T02:26:51Z","author_association":"MEMBER","body":"@jackye1995 , @RussellSpitzer @huaxingao : I have addressed the comments. Please have a look at it again","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997127642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997128972","html_url":"https://github.com/apache/iceberg/pull/3718#issuecomment-997128972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3718","id":997128972,"node_id":"IC_kwDOCW7NX847bvsM","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T02:38:09Z","updated_at":"2021-12-18T02:38:09Z","author_association":"MEMBER","body":"@rdblue : Nessie is planning to use expireSnapshots action with specific expire snapshot id as if we don't set list of expire snapshot id, action will expire table's snapshots that are referred in other branches also.\r\n\r\nWe don't have any plans for using SQL yet, but it is just my own initiative to make SQL procedure same as Actions. So, that user can use it with all functionalities. I think these changes will help users.\r\n@rymurr , @RussellSpitzer , @jackye1995 : What is your opinion on this PR changes ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997128972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997141092","html_url":"https://github.com/apache/iceberg/issues/3657#issuecomment-997141092","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3657","id":997141092,"node_id":"IC_kwDOCW7NX847bypk","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T04:24:28Z","updated_at":"2021-12-18T04:24:28Z","author_association":"CONTRIBUTOR","body":"merged master: 2531545e3cd3b97494c9e3c137cfe04f4459a9fb","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997141092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997145715","html_url":"https://github.com/apache/iceberg/pull/3718#issuecomment-997145715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3718","id":997145715,"node_id":"IC_kwDOCW7NX847bzxz","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T05:08:05Z","updated_at":"2021-12-18T05:08:05Z","author_association":"MEMBER","body":"I think i'm the side of less options exposed the better. Since SQL is the \"easy\" first use api I would try to hide features which may cause undesired effects. I'm not sure it really hinders anyone who specifically ones to expire certain snapshots since they already would need to be very careful. \r\n\r\nFor example I assume Nessie would use the underlying api with a separate interface for Nessie users since actually determining the list of Snapshots that can be removed will be non-trivial. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997145715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997259312","html_url":"https://github.com/apache/iceberg/issues/3704#issuecomment-997259312","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3704","id":997259312,"node_id":"IC_kwDOCW7NX847cPgw","user":{"login":"adiroy05","id":96076675,"node_id":"U_kgDOBboDgw","avatar_url":"https://avatars.githubusercontent.com/u/96076675?v=4","gravatar_id":"","url":"https://api.github.com/users/adiroy05","html_url":"https://github.com/adiroy05","followers_url":"https://api.github.com/users/adiroy05/followers","following_url":"https://api.github.com/users/adiroy05/following{/other_user}","gists_url":"https://api.github.com/users/adiroy05/gists{/gist_id}","starred_url":"https://api.github.com/users/adiroy05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adiroy05/subscriptions","organizations_url":"https://api.github.com/users/adiroy05/orgs","repos_url":"https://api.github.com/users/adiroy05/repos","events_url":"https://api.github.com/users/adiroy05/events{/privacy}","received_events_url":"https://api.github.com/users/adiroy05/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T18:30:16Z","updated_at":"2021-12-18T18:30:16Z","author_association":"NONE","body":"i want to do it\r\npls assign to me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997259312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997274045","html_url":"https://github.com/apache/iceberg/pull/3771#issuecomment-997274045","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3771","id":997274045,"node_id":"IC_kwDOCW7NX847cTG9","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T19:31:01Z","updated_at":"2021-12-18T19:31:01Z","author_association":"MEMBER","body":"Does this upgrade the SBT component in the Scala plugin?\n\nRe: #3710 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997274045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997274398","html_url":"https://github.com/apache/iceberg/pull/3771#issuecomment-997274398","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3771","id":997274398,"node_id":"IC_kwDOCW7NX847cTMe","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-18T19:34:05Z","updated_at":"2021-12-18T19:34:05Z","author_association":"MEMBER","body":"I checked myself it has https://github.com/gradle/gradle/commit/d71b1f3e0801890132d879967a7234519797d478 which bumps the Zinc Dep","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997274398/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997361482","html_url":"https://github.com/apache/iceberg/pull/3752#issuecomment-997361482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3752","id":997361482,"node_id":"IC_kwDOCW7NX847codK","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T09:59:27Z","updated_at":"2021-12-21T07:31:12Z","author_association":"CONTRIBUTOR","body":"@jackye1995: By my understanding the `FileIO` could be defined on `Catalog` level:\r\nhttps://github.com/apache/iceberg/blob/f68d8d426661efc0d7e5686fe833b573b74eadab/hive-metastore/src/main/java/org/apache/iceberg/hive/HiveCatalog.java#L87-L88\r\n\r\nSo it could be perfectly valid to have different `FileIO` for every `Catalog`, so I think we should not override this on the engine side.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997361482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997394797","html_url":"https://github.com/apache/iceberg/issues/3678#issuecomment-997394797","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3678","id":997394797,"node_id":"IC_kwDOCW7NX847cwlt","user":{"login":"sanyud24","id":57134307,"node_id":"MDQ6VXNlcjU3MTM0MzA3","avatar_url":"https://avatars.githubusercontent.com/u/57134307?v=4","gravatar_id":"","url":"https://api.github.com/users/sanyud24","html_url":"https://github.com/sanyud24","followers_url":"https://api.github.com/users/sanyud24/followers","following_url":"https://api.github.com/users/sanyud24/following{/other_user}","gists_url":"https://api.github.com/users/sanyud24/gists{/gist_id}","starred_url":"https://api.github.com/users/sanyud24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanyud24/subscriptions","organizations_url":"https://api.github.com/users/sanyud24/orgs","repos_url":"https://api.github.com/users/sanyud24/repos","events_url":"https://api.github.com/users/sanyud24/events{/privacy}","received_events_url":"https://api.github.com/users/sanyud24/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T13:45:04Z","updated_at":"2021-12-19T13:45:04Z","author_association":"CONTRIBUTOR","body":"Hi , I would like to work on this issue !! can I get it assigned","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997394797/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997439670","html_url":"https://github.com/apache/iceberg/pull/3773#issuecomment-997439670","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3773","id":997439670,"node_id":"IC_kwDOCW7NX847c7i2","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T18:32:59Z","updated_at":"2021-12-19T18:32:59Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer can you take a look at this follow-up to #3723?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997439670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997439714","html_url":"https://github.com/apache/iceberg/pull/3773#issuecomment-997439714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3773","id":997439714,"node_id":"IC_kwDOCW7NX847c7ji","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T18:33:18Z","updated_at":"2021-12-19T18:33:18Z","author_association":"CONTRIBUTOR","body":"@SinghAsDev FYI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997439714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997440123","html_url":"https://github.com/apache/iceberg/pull/3772#issuecomment-997440123","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3772","id":997440123,"node_id":"IC_kwDOCW7NX847c7p7","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T18:36:28Z","updated_at":"2021-12-19T18:36:28Z","author_association":"CONTRIBUTOR","body":"I agree with @ajantha-bhat that there's already a way to do this. I don't think we should expose this to users, who probably would not understand the situations in which you'd want to not clean up data files.\r\n\r\nThe situation you described seems to be a different bug to me. I don't think that deleting data files should ever cause the job to fail. We should catch errors and log them, but continue trying to clean up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997440123/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997440548","html_url":"https://github.com/apache/iceberg/pull/3772#issuecomment-997440548","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3772","id":997440548,"node_id":"IC_kwDOCW7NX847c7wk","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T18:39:35Z","updated_at":"2021-12-19T18:39:35Z","author_association":"CONTRIBUTOR","body":"@zhongyujiang can you give more detail on what failed? Looking at the code that deletes files, I think that it should already log a warning and skip the file delete, rather than fail. https://github.com/apache/iceberg/blob/master/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/actions/BaseExpireSnapshotsSparkAction.java#L245-L271\r\n\r\nWhat failure did you see?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997440548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997444310","html_url":"https://github.com/apache/iceberg/pull/3773#issuecomment-997444310","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3773","id":997444310,"node_id":"IC_kwDOCW7NX847c8rW","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T19:06:25Z","updated_at":"2021-12-19T19:06:25Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue , this makes sense. I like that we don't have to modify/ construct parquet types with this change.\n\nI have a couple more changes along this, and would like to get your reviews on them. Will likely post them today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997444310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997466182","html_url":"https://github.com/apache/iceberg/pull/3774#issuecomment-997466182","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3774","id":997466182,"node_id":"IC_kwDOCW7NX847dCBG","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T21:42:15Z","updated_at":"2021-12-19T21:42:15Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer can you help review this? Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997466182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997485868","html_url":"https://github.com/apache/iceberg/pull/3718#issuecomment-997485868","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3718","id":997485868,"node_id":"IC_kwDOCW7NX847dG0s","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T23:49:07Z","updated_at":"2021-12-19T23:49:07Z","author_association":"CONTRIBUTOR","body":"> Since SQL is the \"easy\" first use api I would try to hide features which may cause undesired effects.\r\n\r\nWell said. That captures my reservations about this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997485868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997485900","html_url":"https://github.com/apache/iceberg/pull/3718#issuecomment-997485900","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3718","id":997485900,"node_id":"IC_kwDOCW7NX847dG1M","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T23:49:27Z","updated_at":"2021-12-19T23:49:27Z","author_association":"CONTRIBUTOR","body":"Oops, I didn't intend to close this. I clicked the wrong button.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997485900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997486697","html_url":"https://github.com/apache/iceberg/pull/3740#issuecomment-997486697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3740","id":997486697,"node_id":"IC_kwDOCW7NX847dHBp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T23:54:51Z","updated_at":"2021-12-19T23:54:51Z","author_association":"CONTRIBUTOR","body":"I'm marking this for inclusion in 0.13.0. We should wait for tests, but I want to make sure we include this in the release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997486697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997486823","html_url":"https://github.com/apache/iceberg/pull/3758#issuecomment-997486823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3758","id":997486823,"node_id":"IC_kwDOCW7NX847dHDn","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-19T23:55:45Z","updated_at":"2021-12-19T23:55:45Z","author_association":"CONTRIBUTOR","body":"Thanks, @jasonhughes248!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997486823/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997487942","html_url":"https://github.com/apache/iceberg/pull/3740#issuecomment-997487942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3740","id":997487942,"node_id":"IC_kwDOCW7NX847dHVG","user":{"login":"chenzihao5","id":38340392,"node_id":"MDQ6VXNlcjM4MzQwMzky","avatar_url":"https://avatars.githubusercontent.com/u/38340392?v=4","gravatar_id":"","url":"https://api.github.com/users/chenzihao5","html_url":"https://github.com/chenzihao5","followers_url":"https://api.github.com/users/chenzihao5/followers","following_url":"https://api.github.com/users/chenzihao5/following{/other_user}","gists_url":"https://api.github.com/users/chenzihao5/gists{/gist_id}","starred_url":"https://api.github.com/users/chenzihao5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenzihao5/subscriptions","organizations_url":"https://api.github.com/users/chenzihao5/orgs","repos_url":"https://api.github.com/users/chenzihao5/repos","events_url":"https://api.github.com/users/chenzihao5/events{/privacy}","received_events_url":"https://api.github.com/users/chenzihao5/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T00:02:33Z","updated_at":"2021-12-20T00:02:33Z","author_association":"CONTRIBUTOR","body":"> I'm marking this for inclusion in 0.13.0. We should wait for tests, but I want to make sure we include this in the release.\r\n\r\nThanks for reminding, I will complete the unit test today. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997487942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997677874","html_url":"https://github.com/apache/iceberg/pull/3605#issuecomment-997677874","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3605","id":997677874,"node_id":"IC_kwDOCW7NX847d1sy","user":{"login":"uncleGen","id":7402327,"node_id":"MDQ6VXNlcjc0MDIzMjc=","avatar_url":"https://avatars.githubusercontent.com/u/7402327?v=4","gravatar_id":"","url":"https://api.github.com/users/uncleGen","html_url":"https://github.com/uncleGen","followers_url":"https://api.github.com/users/uncleGen/followers","following_url":"https://api.github.com/users/uncleGen/following{/other_user}","gists_url":"https://api.github.com/users/uncleGen/gists{/gist_id}","starred_url":"https://api.github.com/users/uncleGen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uncleGen/subscriptions","organizations_url":"https://api.github.com/users/uncleGen/orgs","repos_url":"https://api.github.com/users/uncleGen/repos","events_url":"https://api.github.com/users/uncleGen/events{/privacy}","received_events_url":"https://api.github.com/users/uncleGen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T07:51:47Z","updated_at":"2021-12-20T07:56:48Z","author_association":"CONTRIBUTOR","body":"In general, this pr makes sense to me, and is there same issue in ORC ff?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997677874/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997710093","html_url":"https://github.com/apache/iceberg/pull/3605#issuecomment-997710093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3605","id":997710093,"node_id":"IC_kwDOCW7NX847d9kN","user":{"login":"uncleGen","id":7402327,"node_id":"MDQ6VXNlcjc0MDIzMjc=","avatar_url":"https://avatars.githubusercontent.com/u/7402327?v=4","gravatar_id":"","url":"https://api.github.com/users/uncleGen","html_url":"https://github.com/uncleGen","followers_url":"https://api.github.com/users/uncleGen/followers","following_url":"https://api.github.com/users/uncleGen/following{/other_user}","gists_url":"https://api.github.com/users/uncleGen/gists{/gist_id}","starred_url":"https://api.github.com/users/uncleGen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uncleGen/subscriptions","organizations_url":"https://api.github.com/users/uncleGen/orgs","repos_url":"https://api.github.com/users/uncleGen/repos","events_url":"https://api.github.com/users/uncleGen/events{/privacy}","received_events_url":"https://api.github.com/users/uncleGen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T08:37:28Z","updated_at":"2021-12-20T08:37:28Z","author_association":"CONTRIBUTOR","body":"Besides, could you please add an end-to-end unit test?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997710093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997856672","html_url":"https://github.com/apache/iceberg/pull/3772#issuecomment-997856672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3772","id":997856672,"node_id":"IC_kwDOCW7NX847ehWg","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T11:53:35Z","updated_at":"2021-12-20T11:53:35Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat @rdblue Thanks for your review! Maybe I didn't make it clear, the failure of _expire_snapshots_ I met is not caused by deleting files instead of building expired files dataset, cause some files needed to build expiredFiles are deleted by _remove_orphan_files_ which happens to be started right after _expire_snapshots_' commit. So plugin dummy consumer method to avoid deleting the files has no effect on this situation.\r\nThis situation is quite rare, but truely it happens. I think a simple way to avoid this is execute  _remove_orphan_files_ after _expire_snapshots_ job is done, but our _remove_orphan_files_ procedure is automatically scheduled by program. So it's a bit difficult to control timing.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997856672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997862697","html_url":"https://github.com/apache/iceberg/issues/3750#issuecomment-997862697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3750","id":997862697,"node_id":"IC_kwDOCW7NX847ei0p","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T12:03:32Z","updated_at":"2021-12-20T12:03:32Z","author_association":"CONTRIBUTOR","body":"Thanks @pvary for confirming. Yeah a shutdown hook will do the trick, although we might still want to figure out why follow-up tests are relying on the previous temp folders not being deleted. I guess it indicates some more static fields we need to clear out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997862697/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997899516","html_url":"https://github.com/apache/iceberg/pull/3605#issuecomment-997899516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3605","id":997899516,"node_id":"IC_kwDOCW7NX847erz8","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T12:55:54Z","updated_at":"2021-12-20T12:55:54Z","author_association":"CONTRIBUTOR","body":"> In general, this pr makes sense to me, and is there same issue in ORC ff?\r\n\r\nSorry, I don't know much of ORC, and I think this issue is already solved by this [pr](https://github.com/apache/iceberg/pull/3723), it's already merged. I'll close this one.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997899516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997931229","html_url":"https://github.com/apache/iceberg/pull/3740#issuecomment-997931229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3740","id":997931229,"node_id":"IC_kwDOCW7NX847ezjd","user":{"login":"chenzihao5","id":38340392,"node_id":"MDQ6VXNlcjM4MzQwMzky","avatar_url":"https://avatars.githubusercontent.com/u/38340392?v=4","gravatar_id":"","url":"https://api.github.com/users/chenzihao5","html_url":"https://github.com/chenzihao5","followers_url":"https://api.github.com/users/chenzihao5/followers","following_url":"https://api.github.com/users/chenzihao5/following{/other_user}","gists_url":"https://api.github.com/users/chenzihao5/gists{/gist_id}","starred_url":"https://api.github.com/users/chenzihao5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenzihao5/subscriptions","organizations_url":"https://api.github.com/users/chenzihao5/orgs","repos_url":"https://api.github.com/users/chenzihao5/repos","events_url":"https://api.github.com/users/chenzihao5/events{/privacy}","received_events_url":"https://api.github.com/users/chenzihao5/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T13:36:28Z","updated_at":"2021-12-20T13:36:28Z","author_association":"CONTRIBUTOR","body":"@rdblue @kbendick @openinx Hi, All. I have added unit tests in version 1.14, please help to review it, Thanks.\r\n\r\nAbout these unit tests:\r\n    1. test for numeric type, such as: int, float, double, date, time, timestamp, long, decimal.\r\n    2. test MAX_VALUE and MIN_VALUE of all types.\r\n    3. If this version is completed, I will add unit tests in version 1.12 and 1.13 too.\r\n\r\nThanks for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997931229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997938486","html_url":"https://github.com/apache/iceberg/pull/3772#issuecomment-997938486","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3772","id":997938486,"node_id":"IC_kwDOCW7NX847e1U2","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T13:46:44Z","updated_at":"2021-12-20T13:46:44Z","author_association":"MEMBER","body":"> @ajantha-bhat @rdblue Thanks for your review! Maybe I didn't make it clear, the failure of _expire_snapshots_ I met is not caused by deleting files instead of building expired files dataset, cause some files needed to build expiredFiles are deleted by _remove_orphan_files_ which happens to be started right after _expire_snapshots_' commit. So plugin dummy consumer method to avoid deleting the files has no effect on this situation. This situation is quite rare, but truely it happens. I think a simple way to avoid this is execute _remove_orphan_files_ after _expire_snapshots_ job is done, but our _remove_orphan_files_ procedure is automatically scheduled by program. So it's a bit difficult to control timing.\r\n\r\nI agree with Ryan, the thing to do here is to make it so that \"expire snapshots\" won't fail in this sort of situation. Basically just place in a bunch of try's to make it that if we can't determine the correct set of files to remove, we just log warnings for those files and continue as normal. This would result in not cleaning the total set of unused files since we wouldn't be able to determine the full set of unused files but since RemoveOrphans is running concurrently in this example, that really doesn't matter.\r\n\r\nThat said the ExpireSnapshots method is far more efficient than RemoveOrphans and we should always be encouraging users towards using Expire to delete rather than Remove.For this particular use case I would probably just have the same program that runs expire snapshots also run remove orphans so that they never run concurrently. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997938486/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997975644","html_url":"https://github.com/apache/iceberg/issues/3131#issuecomment-997975644","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3131","id":997975644,"node_id":"IC_kwDOCW7NX847e-Zc","user":{"login":"qq240035000","id":32573841,"node_id":"MDQ6VXNlcjMyNTczODQx","avatar_url":"https://avatars.githubusercontent.com/u/32573841?v=4","gravatar_id":"","url":"https://api.github.com/users/qq240035000","html_url":"https://github.com/qq240035000","followers_url":"https://api.github.com/users/qq240035000/followers","following_url":"https://api.github.com/users/qq240035000/following{/other_user}","gists_url":"https://api.github.com/users/qq240035000/gists{/gist_id}","starred_url":"https://api.github.com/users/qq240035000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qq240035000/subscriptions","organizations_url":"https://api.github.com/users/qq240035000/orgs","repos_url":"https://api.github.com/users/qq240035000/repos","events_url":"https://api.github.com/users/qq240035000/events{/privacy}","received_events_url":"https://api.github.com/users/qq240035000/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T14:30:46Z","updated_at":"2021-12-20T14:30:46Z","author_association":"NONE","body":"I do the same steps, but my error is \"software.amazon.awssdk.services.dynamodb.model.DynamoDbException: The security token included in the request is invalid\", can you help  @jackye1995 \r\n\r\nsoftware.amazon.awssdk.services.dynamodb.model.DynamoDbException: The security token included in the request is invalid. (Service: DynamoDb, Status Code: 400, Request ID: OGG5KGTLEDSJVMMC3JUVV5514VVV4KQNSO5AEMVJF66Q9ASUAAJG, Extended Request ID: null)\r\n        at software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handleErrorResponse(CombinedResponseHandler.java:123)\r\n        at software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handleResponse(CombinedResponseHandler.java:79)\r\n        at software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handle(CombinedResponseHandler.java:59)\r\n        at software.amazon.awssdk.core.internal.http.CombinedResponseHandler.handle(CombinedResponseHandler.java:40)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.HandleResponseStage.execute(HandleResponseStage.java:40)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.HandleResponseStage.execute(HandleResponseStage.java:30)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:73)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptTimeoutTrackingStage.execute(ApiCallAttemptTimeoutTrackingStage.java:42)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:77)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.TimeoutExceptionHandlingStage.execute(TimeoutExceptionHandlingStage.java:39)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:50)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallAttemptMetricCollectionStage.execute(ApiCallAttemptMetricCollectionStage.java:36)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:64)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.RetryableStage.execute(RetryableStage.java:34)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n        at software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:56)\r\n        at software.amazon.awssdk.core.internal.http.StreamManagingStage.execute(StreamManagingStage.java:36)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.executeWithTimer(ApiCallTimeoutTrackingStage.java:80)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:60)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallTimeoutTrackingStage.execute(ApiCallTimeoutTrackingStage.java:42)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:48)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ApiCallMetricCollectionStage.execute(ApiCallMetricCollectionStage.java:31)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.RequestPipelineBuilder$ComposingRequestPipelineStage.execute(RequestPipelineBuilder.java:206)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:37)\r\n        at software.amazon.awssdk.core.internal.http.pipeline.stages.ExecutionFailureExceptionReportingStage.execute(ExecutionFailureExceptionReportingStage.java:26)\r\n        at software.amazon.awssdk.core.internal.http.AmazonSyncHttpClient$RequestExecutionBuilderImpl.execute(AmazonSyncHttpClient.java:193)\r\n        at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.invoke(BaseSyncClientHandler.java:133)\r\n        at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.doExecute(BaseSyncClientHandler.java:159)\r\n        at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.lambda$execute$1(BaseSyncClientHandler.java:112)\r\n        at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.measureApiCallSuccess(BaseSyncClientHandler.java:167)\r\n        at software.amazon.awssdk.core.internal.handler.BaseSyncClientHandler.execute(BaseSyncClientHandler.java:94)\r\n        at software.amazon.awssdk.core.client.handler.SdkSyncClientHandler.execute(SdkSyncClientHandler.java:45)\r\n        at software.amazon.awssdk.awscore.client.handler.AwsSyncClientHandler.execute(AwsSyncClientHandler.java:55)\r\n        at software.amazon.awssdk.services.dynamodb.DefaultDynamoDbClient.describeTable(DefaultDynamoDbClient.java:2164)\r\n        at org.apache.iceberg.aws.glue.DynamoLockManager.tableExists(DynamoLockManager.java:145)\r\n        at org.apache.iceberg.aws.glue.DynamoLockManager.ensureLockTableExistsOrCreate(DynamoLockManager.java:123)\r\n        at org.apache.iceberg.aws.glue.DynamoLockManager.initialize(DynamoLockManager.java:175)\r\n        at org.apache.iceberg.aws.glue.LockManagers.loadLockManager(LockManagers.java:75)\r\n        at org.apache.iceberg.aws.glue.LockManagers.from(LockManagers.java:52)\r\n        at org.apache.iceberg.aws.glue.GlueCatalog.initialize(GlueCatalog.java:99)\r\n        at org.apache.iceberg.CatalogUtil.loadCatalog(CatalogUtil.java:193)\r\n        at org.apache.iceberg.CatalogUtil.buildIcebergCatalog(CatalogUtil.java:225)\r\n        at org.apache.iceberg.spark.SparkCatalog.buildIcebergCatalog(SparkCatalog.java:105)\r\n        at org.apache.iceberg.spark.SparkCatalog.initialize(SparkCatalog.java:388)\r\n        at org.apache.spark.sql.connector.catalog.Catalogs$.load(Catalogs.scala:61)\r\n        at org.apache.spark.sql.connector.catalog.CatalogManager.$anonfun$catalog$1(CatalogManager.scala:52)\r\n        at scala.collection.mutable.HashMap.getOrElseUpdate(HashMap.scala:86)\r\n        at org.apache.spark.sql.connector.catalog.CatalogManager.catalog(CatalogManager.scala:52)\r\n        at org.apache.spark.sql.connector.catalog.LookupCatalog$CatalogAndNamespace$.unapply(LookupCatalog.scala:92)\r\n        at org.apache.spark.sql.catalyst.analysis.ResolveCatalogs$$anonfun$apply$1.applyOrElse(ResolveCatalogs.scala:201)\r\n        at org.apache.spark.sql.catalyst.analysis.ResolveCatalogs$$anonfun$apply$1.applyOrElse(ResolveCatalogs.scala:34)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsDown$2(AnalysisHelper.scala:108)\r\n        at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:74)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsDown$1(AnalysisHelper.scala:108)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:221)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsDown(AnalysisHelper.scala:106)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsDown$(AnalysisHelper.scala:104)\r\n        at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsDown(LogicalPlan.scala:29)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperators(AnalysisHelper.scala:73)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperators$(AnalysisHelper.scala:72)\r\n        at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperators(LogicalPlan.scala:29)\r\n        at org.apache.spark.sql.catalyst.analysis.ResolveCatalogs.apply(ResolveCatalogs.scala:34)\r\n        at org.apache.spark.sql.catalyst.analysis.ResolveCatalogs.apply(ResolveCatalogs.scala:29)\r\n        at org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$2(RuleExecutor.scala:216)\r\n        at scala.collection.LinearSeqOptimized.foldLeft(LinearSeqOptimized.scala:126)\r\n        at scala.collection.LinearSeqOptimized.foldLeft$(LinearSeqOptimized.scala:122)\r\n        at scala.collection.immutable.List.foldLeft(List.scala:89)\r\n        at org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$1(RuleExecutor.scala:213)\r\n        at org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$1$adapted(RuleExecutor.scala:205)\r\n        at scala.collection.immutable.List.foreach(List.scala:392)\r\n        at org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:205)\r\n        at org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:196)\r\n        at org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:190)\r\n        at org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:155)\r\n        at org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$executeAndTrack$1(RuleExecutor.scala:183)\r\n        at org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:88)\r\n        at org.apache.spark.sql.catalyst.rules.RuleExecutor.executeAndTrack(RuleExecutor.scala:183)\r\n        at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:174)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:228)\r\n        at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:173)\r\n        at org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:73)\r\n        at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\r\n        at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:143)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n        at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:143)\r\n        at org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:73)\r\n        at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:71)\r\n        at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:63)\r\n        at org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:98)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n        at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:96)\r\n        at org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:618)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n        at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:613)\r\n        at org.apache.spark.sql.SQLContext.sql(SQLContext.scala:650)\r\n        at org.apache.spark.sql.hive.thriftserver.SparkSQLDriver.run(SparkSQLDriver.scala:67)\r\n        at org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processCmd(SparkSQLCLIDriver.scala:381)\r\n        at org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1(SparkSQLCLIDriver.scala:500)\r\n        at org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1$adapted(SparkSQLCLIDriver.scala:494)\r\n        at scala.collection.Iterator.foreach(Iterator.scala:941)\r\n        at scala.collection.Iterator.foreach$(Iterator.scala:941)\r\n        at scala.collection.AbstractIterator.foreach(Iterator.scala:1429)\r\n        at scala.collection.IterableLike.foreach(IterableLike.scala:74)\r\n        at scala.collection.IterableLike.foreach$(IterableLike.scala:73)\r\n        at scala.collection.AbstractIterable.foreach(Iterable.scala:56)\r\n        at org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processLine(SparkSQLCLIDriver.scala:494)\r\n        at org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver$.main(SparkSQLCLIDriver.scala:284)\r\n        at org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.main(SparkSQLCLIDriver.scala)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\r\n        at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:951)\r\n        at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)\r\n        at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)\r\n        at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)\r\n        at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1039)\r\n        at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1048)\r\n        at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997975644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997996662","html_url":"https://github.com/apache/iceberg/pull/3772#issuecomment-997996662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3772","id":997996662,"node_id":"IC_kwDOCW7NX847fDh2","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T14:56:39Z","updated_at":"2021-12-20T15:52:34Z","author_association":"CONTRIBUTOR","body":"> That said the ExpireSnapshots method is far more efficient than RemoveOrphans and we should always be encouraging users towards using Expire to delete rather than Remove.\r\n\r\nThis makes sense, I think we can trigger calculation for **Dataset<Row> originalFiles** before commit and cache it to reduce the probability of such failure. @RussellSpitzer What do you think? cc @ajantha-bhat ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/997996662/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998077492","html_url":"https://github.com/apache/iceberg/pull/3757#issuecomment-998077492","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3757","id":998077492,"node_id":"IC_kwDOCW7NX847fXQ0","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T16:23:08Z","updated_at":"2021-12-20T16:23:08Z","author_association":"MEMBER","body":"@RussellSpitzer , @jackye1995 , @huaxingao : PR is ready. Please take a look at it again.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998077492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998141914","html_url":"https://github.com/apache/iceberg/pull/3764#issuecomment-998141914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3764","id":998141914,"node_id":"IC_kwDOCW7NX847fm_a","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T17:46:28Z","updated_at":"2021-12-20T17:46:28Z","author_association":"CONTRIBUTOR","body":"@rdblue, it is ready for another round. I'll create a table of proposed distributions and orderings and will think about the default one. That's still an open item.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998141914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998142964","html_url":"https://github.com/apache/iceberg/pull/3777#issuecomment-998142964","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3777","id":998142964,"node_id":"IC_kwDOCW7NX847fnP0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T17:48:10Z","updated_at":"2021-12-20T17:48:10Z","author_association":"CONTRIBUTOR","body":"@zhongyujiang, what is the problem caused by this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998142964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998154259","html_url":"https://github.com/apache/iceberg/pull/3764#issuecomment-998154259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3764","id":998154259,"node_id":"IC_kwDOCW7NX847fqAT","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T18:05:37Z","updated_at":"2021-12-20T18:05:37Z","author_association":"CONTRIBUTOR","body":"Oops, looks like I broke something. Let me see.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998154259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998160769","html_url":"https://github.com/apache/iceberg/issues/3105#issuecomment-998160769","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3105","id":998160769,"node_id":"IC_kwDOCW7NX847frmB","user":{"login":"adiroy05","id":96076675,"node_id":"U_kgDOBboDgw","avatar_url":"https://avatars.githubusercontent.com/u/96076675?v=4","gravatar_id":"","url":"https://api.github.com/users/adiroy05","html_url":"https://github.com/adiroy05","followers_url":"https://api.github.com/users/adiroy05/followers","following_url":"https://api.github.com/users/adiroy05/following{/other_user}","gists_url":"https://api.github.com/users/adiroy05/gists{/gist_id}","starred_url":"https://api.github.com/users/adiroy05/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adiroy05/subscriptions","organizations_url":"https://api.github.com/users/adiroy05/orgs","repos_url":"https://api.github.com/users/adiroy05/repos","events_url":"https://api.github.com/users/adiroy05/events{/privacy}","received_events_url":"https://api.github.com/users/adiroy05/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T18:14:38Z","updated_at":"2021-12-20T18:14:38Z","author_association":"NONE","body":"hey i would like to work on this issue...assign to me\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998160769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998170327","html_url":"https://github.com/apache/iceberg/pull/3772#issuecomment-998170327","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3772","id":998170327,"node_id":"IC_kwDOCW7NX847ft7X","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T18:28:09Z","updated_at":"2021-12-20T18:28:09Z","author_association":"CONTRIBUTOR","body":"@zhongyujiang, caching is an optimization and we should not rely on it for correctness. There is no guarantee that cached data will still be available. Plus, it is expensive and causes scaling issues in Spark clusters.\r\n\r\nInstead, I think that if a metadata file is missing, we should ignore it and move on. This should warn in that case but otherwise be a best effort delete.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998170327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998222081","html_url":"https://github.com/apache/iceberg/pull/3764#issuecomment-998222081","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3764","id":998222081,"node_id":"IC_kwDOCW7NX847f6kB","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T19:49:43Z","updated_at":"2021-12-20T19:49:43Z","author_association":"CONTRIBUTOR","body":"@rdblue, had to slightly modify `AssignmentUtils`. It turns out our alignment check was too aggressive. We did not catch this before as we did not invoke that code in `RewriteUpdateTable`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998222081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998289633","html_url":"https://github.com/apache/iceberg/pull/3645#issuecomment-998289633","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3645","id":998289633,"node_id":"IC_kwDOCW7NX847gLDh","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T21:38:46Z","updated_at":"2021-12-20T21:38:46Z","author_association":"CONTRIBUTOR","body":"+1 when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998289633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998326715","html_url":"https://github.com/apache/iceberg/pull/3645#issuecomment-998326715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3645","id":998326715,"node_id":"IC_kwDOCW7NX847gUG7","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T22:47:37Z","updated_at":"2021-12-20T22:47:37Z","author_association":"CONTRIBUTOR","body":"For the Flink test that is failing, I think you need to rebase off of master @hbgstc123. Feel free to reach out on Slack if you need any help!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998326715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998332867","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-998332867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":998332867,"node_id":"IC_kwDOCW7NX847gVnD","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T23:02:41Z","updated_at":"2021-12-20T23:02:41Z","author_association":"CONTRIBUTOR","body":"Note: We'll want to add a test in here if the other PR gets approved: https://github.com/apache/iceberg/pull/3757/files","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998332867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998335347","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-998335347","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":998335347,"node_id":"IC_kwDOCW7NX847gWNz","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T23:07:29Z","updated_at":"2021-12-20T23:07:29Z","author_association":"CONTRIBUTOR","body":"Overall, the tests and implementation all look correct to me. I think there are a few minor things we could do, but I'm ready to commit this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998335347/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998349282","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-998349282","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":998349282,"node_id":"IC_kwDOCW7NX847gZni","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T23:37:12Z","updated_at":"2021-12-20T23:37:12Z","author_association":"CONTRIBUTOR","body":"> Overall, the tests and implementation all look correct to me. I think there are a few minor things we could do, but I'm ready to commit this.\r\n\r\nI'll backport this to Spark 3.1 and 3.0 after we've merged then.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998349282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998350293","html_url":"https://github.com/apache/iceberg/pull/3777#issuecomment-998350293","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3777","id":998350293,"node_id":"IC_kwDOCW7NX847gZ3V","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T23:40:04Z","updated_at":"2021-12-20T23:40:04Z","author_association":"CONTRIBUTOR","body":"@zhongyujiang could you update the PR description to further clarify what problem this is solving? It's hard to to tell when it's linked via a comment if we weren't involved in the initial comment discussion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998350293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998352585","html_url":"https://github.com/apache/iceberg/pull/3778#issuecomment-998352585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3778","id":998352585,"node_id":"IC_kwDOCW7NX847gabJ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-20T23:46:50Z","updated_at":"2021-12-20T23:46:50Z","author_association":"CONTRIBUTOR","body":"As this is a very simple fix, I'm adding it to the 0.13.0 release milestone.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998352585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998359986","html_url":"https://github.com/apache/iceberg/pull/3732#issuecomment-998359986","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3732","id":998359986,"node_id":"IC_kwDOCW7NX847gcOy","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T00:05:48Z","updated_at":"2021-12-21T00:05:48Z","author_association":"CONTRIBUTOR","body":"This PR is likely going to be affected by changes made in this PR: https://github.com/apache/iceberg/pull/3775\r\n\r\nRemoved my approval until that settles.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998359986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998364711","html_url":"https://github.com/apache/iceberg/pull/3777#issuecomment-998364711","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3777","id":998364711,"node_id":"IC_kwDOCW7NX847gdYn","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T00:16:30Z","updated_at":"2021-12-21T00:16:30Z","author_association":"CONTRIBUTOR","body":"This is only called from test code, so I think the motivation was to speculative since other classes had similar updates. I don't think that we should move forward with this since it isn't actually used.\r\n\r\nWhat you could do instead is move this into src/test/java.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998364711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998365540","html_url":"https://github.com/apache/iceberg/pull/3269#issuecomment-998365540","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3269","id":998365540,"node_id":"IC_kwDOCW7NX847gdlk","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T00:18:33Z","updated_at":"2021-12-21T00:18:33Z","author_association":"CONTRIBUTOR","body":"This was replaced by #3722 so I'll close this.\r\n\r\nThanks for the great discussion and for all the work on this problem, everyone!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998365540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998376239","html_url":"https://github.com/apache/iceberg/pull/3764#issuecomment-998376239","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3764","id":998376239,"node_id":"IC_kwDOCW7NX847ggMv","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T00:43:59Z","updated_at":"2021-12-21T00:43:59Z","author_association":"CONTRIBUTOR","body":"Thanks, @aokolnychyi! I've merged this to unblock MERGE INTO and we can follow up on the requested sort orders.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998376239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998376616","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-998376616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":998376616,"node_id":"IC_kwDOCW7NX847ggSo","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T00:44:51Z","updated_at":"2021-12-21T00:44:51Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick! Great to have this in before 0.13.0.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998376616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998377008","html_url":"https://github.com/apache/iceberg/pull/3775#issuecomment-998377008","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3775","id":998377008,"node_id":"IC_kwDOCW7NX847ggYw","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T00:45:47Z","updated_at":"2021-12-21T00:45:47Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer! It's looking a lot better now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998377008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998377355","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-998377355","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":998377355,"node_id":"IC_kwDOCW7NX847ggeL","user":{"login":"cccs-eric","id":56447460,"node_id":"MDQ6VXNlcjU2NDQ3NDYw","avatar_url":"https://avatars.githubusercontent.com/u/56447460?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-eric","html_url":"https://github.com/cccs-eric","followers_url":"https://api.github.com/users/cccs-eric/followers","following_url":"https://api.github.com/users/cccs-eric/following{/other_user}","gists_url":"https://api.github.com/users/cccs-eric/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-eric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-eric/subscriptions","organizations_url":"https://api.github.com/users/cccs-eric/orgs","repos_url":"https://api.github.com/users/cccs-eric/repos","events_url":"https://api.github.com/users/cccs-eric/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-eric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T00:46:40Z","updated_at":"2021-12-21T00:46:40Z","author_association":"CONTRIBUTOR","body":"Thanks for the work @kbendick, will test it out once it is released!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998377355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]