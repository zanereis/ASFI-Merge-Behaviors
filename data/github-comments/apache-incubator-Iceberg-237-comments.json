[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460877870","html_url":"https://github.com/apache/iceberg/pull/6965#issuecomment-1460877870","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6965","id":1460877870,"node_id":"IC_kwDOCW7NX85XEzou","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T21:08:27Z","updated_at":"2023-03-08T21:08:27Z","author_association":"CONTRIBUTOR","body":"Looks like rebasing broke a few tests, looking into them","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460877870/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460878226","html_url":"https://github.com/apache/iceberg/pull/6913#issuecomment-1460878226","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6913","id":1460878226,"node_id":"IC_kwDOCW7NX85XEzuS","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T21:08:48Z","updated_at":"2023-03-08T21:08:48Z","author_association":"MEMBER","body":"Thanks @anuragmantri !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460878226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460884642","html_url":"https://github.com/apache/iceberg/issues/7034#issuecomment-1460884642","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7034","id":1460884642,"node_id":"IC_kwDOCW7NX85XE1Si","user":{"login":"NeQuissimus","id":628342,"node_id":"MDQ6VXNlcjYyODM0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/628342?v=4","gravatar_id":"","url":"https://api.github.com/users/NeQuissimus","html_url":"https://github.com/NeQuissimus","followers_url":"https://api.github.com/users/NeQuissimus/followers","following_url":"https://api.github.com/users/NeQuissimus/following{/other_user}","gists_url":"https://api.github.com/users/NeQuissimus/gists{/gist_id}","starred_url":"https://api.github.com/users/NeQuissimus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NeQuissimus/subscriptions","organizations_url":"https://api.github.com/users/NeQuissimus/orgs","repos_url":"https://api.github.com/users/NeQuissimus/repos","events_url":"https://api.github.com/users/NeQuissimus/events{/privacy}","received_events_url":"https://api.github.com/users/NeQuissimus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T21:14:31Z","updated_at":"2023-03-08T21:14:31Z","author_association":"CONTRIBUTOR","body":"I am going to see if caching `Table` objects makes a significant difference here. I wonder if creating and stopping these thread pools/threads is too expensive considering how often we create `Table` objects currently.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460884642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460897515","html_url":"https://github.com/apache/iceberg/issues/7034#issuecomment-1460897515","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7034","id":1460897515,"node_id":"IC_kwDOCW7NX85XE4br","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T21:25:46Z","updated_at":"2023-03-08T21:25:46Z","author_association":"MEMBER","body":"I'm pretty sure that would fix it as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460897515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460941320","html_url":"https://github.com/apache/iceberg/pull/7044#issuecomment-1460941320","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7044","id":1460941320,"node_id":"IC_kwDOCW7NX85XFDII","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T22:07:38Z","updated_at":"2023-03-08T22:07:38Z","author_association":"CONTRIBUTOR","body":"Thanks @stevenzwu, @nastra, and @rdblue for the prompt review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1460941320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461044224","html_url":"https://github.com/apache/iceberg/pull/7044#issuecomment-1461044224","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7044","id":1461044224,"node_id":"IC_kwDOCW7NX85XFcQA","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-08T23:47:06Z","updated_at":"2023-03-08T23:47:06Z","author_association":"CONTRIBUTOR","body":"@Fokko when you got time, can you also backport it to 1.14 and 1.15?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461044224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461065644","html_url":"https://github.com/apache/iceberg/issues/5369#issuecomment-1461065644","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5369","id":1461065644,"node_id":"IC_kwDOCW7NX85XFhes","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T00:12:30Z","updated_at":"2023-03-09T00:12:30Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461065644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461093196","html_url":"https://github.com/apache/iceberg/pull/7004#issuecomment-1461093196","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7004","id":1461093196,"node_id":"IC_kwDOCW7NX85XFoNM","user":{"login":"manisin","id":21346391,"node_id":"MDQ6VXNlcjIxMzQ2Mzkx","avatar_url":"https://avatars.githubusercontent.com/u/21346391?v=4","gravatar_id":"","url":"https://api.github.com/users/manisin","html_url":"https://github.com/manisin","followers_url":"https://api.github.com/users/manisin/followers","following_url":"https://api.github.com/users/manisin/following{/other_user}","gists_url":"https://api.github.com/users/manisin/gists{/gist_id}","starred_url":"https://api.github.com/users/manisin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manisin/subscriptions","organizations_url":"https://api.github.com/users/manisin/orgs","repos_url":"https://api.github.com/users/manisin/repos","events_url":"https://api.github.com/users/manisin/events{/privacy}","received_events_url":"https://api.github.com/users/manisin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T00:47:09Z","updated_at":"2023-03-09T00:47:09Z","author_association":"CONTRIBUTOR","body":"> @manisin just a general question, but is there some sort of Docker image(s) that could be used for integration testing this with [testcontainers](https://www.testcontainers.org/)? I'm curious what the general approach for integration testing is for this. The PR as it stands right now doesn't run as part of normal CI (as I commented above) and there's also no separate yml file that would set this up for its own CI runs (with the env vars that are mentioned in the README).\r\n\r\n\r\n\r\n@nastra  there are no images/test containers to deploy and test snowflake. The approach we are considering it to add a separate yml file ( like this https://github.com/Snowflake-Labs/iceberg/blob/1f0dec004f83e1000f65cb552c360dc28eaf7559/.github/workflows/snowflake-ci.yml) and provision a snowflake deployment (with secrets onboarded to github) for integration testing with iceberg. Let me know your thoughts and suggestions.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461093196/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461101722","html_url":"https://github.com/apache/iceberg/issues/6979#issuecomment-1461101722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6979","id":1461101722,"node_id":"IC_kwDOCW7NX85XFqSa","user":{"login":"pkhetrapal","id":12616990,"node_id":"MDQ6VXNlcjEyNjE2OTkw","avatar_url":"https://avatars.githubusercontent.com/u/12616990?v=4","gravatar_id":"","url":"https://api.github.com/users/pkhetrapal","html_url":"https://github.com/pkhetrapal","followers_url":"https://api.github.com/users/pkhetrapal/followers","following_url":"https://api.github.com/users/pkhetrapal/following{/other_user}","gists_url":"https://api.github.com/users/pkhetrapal/gists{/gist_id}","starred_url":"https://api.github.com/users/pkhetrapal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pkhetrapal/subscriptions","organizations_url":"https://api.github.com/users/pkhetrapal/orgs","repos_url":"https://api.github.com/users/pkhetrapal/repos","events_url":"https://api.github.com/users/pkhetrapal/events{/privacy}","received_events_url":"https://api.github.com/users/pkhetrapal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T00:58:06Z","updated_at":"2023-03-09T01:08:35Z","author_association":"NONE","body":"Hi @Fokko, thanks for the response.\r\n\r\nMy use case is to handle streaming data with variable fields in the struct column. \r\nI was able to find the missing fields from the struct column on the fly and was able to update the table using the `ADD COLUMN`, but now, even if the fields are nullable, I can't add the data with missing fields.\r\n\r\nFor eg:\r\nI have the below struct col in the table\r\n```\r\nmy_col: struct (nullable = true)\r\n |    |-- key1: string (nullable = true)\r\n |    |-- key2: string (nullable = true)\r\n |    |-- key3: string (nullable = true)\r\n```\r\nbut when I try to add a row where `key3` is missing in the `my_col` column, I get:\r\n```\r\npyspark.sql.utils.AnalysisException: Cannot write incompatible data:\r\n- Struct 'my_col' missing fields: 'key3'\r\n```\r\n\r\nSo I wanted to confirm if there is a way where I can define the struct column but not restrict it based on fields. Can I define a struct column which can accept any number of fields in any order?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461101722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461120549","html_url":"https://github.com/apache/iceberg/pull/7029#issuecomment-1461120549","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7029","id":1461120549,"node_id":"IC_kwDOCW7NX85XFu4l","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T01:22:13Z","updated_at":"2023-03-09T01:22:13Z","author_association":"COLLABORATOR","body":"Rebase on updated version of #6924 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461120549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461216644","html_url":"https://github.com/apache/iceberg/pull/7038#issuecomment-1461216644","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7038","id":1461216644,"node_id":"IC_kwDOCW7NX85XGGWE","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T03:32:40Z","updated_at":"2023-03-09T03:32:40Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar @flyrain, could you take another look? I updated the PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461216644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461250350","html_url":"https://github.com/apache/iceberg/pull/6614#issuecomment-1461250350","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6614","id":1461250350,"node_id":"IC_kwDOCW7NX85XGOku","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T04:12:16Z","updated_at":"2023-03-09T04:12:16Z","author_association":"CONTRIBUTOR","body":"@xuzhiwen1255 can you rebase this PR? we will need to update the REST catalog from PR #7044 \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461250350/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461398723","html_url":"https://github.com/apache/iceberg/pull/6965#issuecomment-1461398723","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6965","id":1461398723,"node_id":"IC_kwDOCW7NX85XGyzD","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T06:43:45Z","updated_at":"2023-03-09T06:43:45Z","author_association":"CONTRIBUTOR","body":"This looks like a solid approach. I had two questions.\r\n  - Passing branch all the way to readers [here](https://github.com/apache/iceberg/pull/6965#discussion_r1130526782).\r\n  - Supporting read option [here](https://github.com/apache/iceberg/pull/6965#discussion_r1129853690)\r\n\r\nThanks a lot for pushing this everyone involved!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461398723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461507778","html_url":"https://github.com/apache/iceberg/pull/7054#issuecomment-1461507778","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7054","id":1461507778,"node_id":"IC_kwDOCW7NX85XHNbC","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T07:56:02Z","updated_at":"2023-03-09T07:56:02Z","author_association":"CONTRIBUTOR","body":"/cc @snazy @ajantha-bhat @dimas-b ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461507778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461531445","html_url":"https://github.com/apache/iceberg/pull/7049#issuecomment-1461531445","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7049","id":1461531445,"node_id":"IC_kwDOCW7NX85XHTM1","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T08:13:15Z","updated_at":"2023-03-09T08:13:15Z","author_association":"MEMBER","body":"I'm +1 on removing the hadoop deps as well. Feels unnecessary to have those just for configuration, and it's a PITA downstream for us as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461531445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461541796","html_url":"https://github.com/apache/iceberg/pull/7047#issuecomment-1461541796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7047","id":1461541796,"node_id":"IC_kwDOCW7NX85XHVuk","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T08:20:32Z","updated_at":"2023-03-09T08:20:32Z","author_association":"CONTRIBUTOR","body":"I think it's fine reducing those scale factors, but it's quite interesting that this takes so long for you. I've ran `HadoopFileIOTest` a few times locally and it takes about **18 secs** in total:\r\n\r\n![image](https://user-images.githubusercontent.com/271029/223961916-50452cf9-a255-4764-977a-d65e1fc83e0d.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461541796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461561082","html_url":"https://github.com/apache/iceberg/pull/6614#issuecomment-1461561082","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6614","id":1461561082,"node_id":"IC_kwDOCW7NX85XHab6","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T08:33:13Z","updated_at":"2023-03-09T08:33:13Z","author_association":"CONTRIBUTOR","body":"@stevenzwu No problem, the modification has been completed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461561082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461575601","html_url":"https://github.com/apache/iceberg/pull/7004#issuecomment-1461575601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7004","id":1461575601,"node_id":"IC_kwDOCW7NX85XHd-x","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T08:42:47Z","updated_at":"2023-03-09T08:42:47Z","author_association":"CONTRIBUTOR","body":"> > @manisin just a general question, but is there some sort of Docker image(s) that could be used for integration testing this with [testcontainers](https://www.testcontainers.org/)? I'm curious what the general approach for integration testing is for this. The PR as it stands right now doesn't run as part of normal CI (as I commented above) and there's also no separate yml file that would set this up for its own CI runs (with the env vars that are mentioned in the README).\r\n> \r\n> @nastra there are no images/test containers to deploy and test snowflake. The approach we are considering it to add a separate yml file ( like this https://github.com/Snowflake-Labs/iceberg/blob/1f0dec004f83e1000f65cb552c360dc28eaf7559/.github/workflows/snowflake-ci.yml) and provision a snowflake deployment (with secrets onboarded to github) for integration testing with iceberg. Let me know your thoughts and suggestions.\r\n\r\n@manisin having a separate yml file for Snowflake integration tests should be fine, although I would probably include it in this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461575601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461818803","html_url":"https://github.com/apache/iceberg/pull/7059#issuecomment-1461818803","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7059","id":1461818803,"node_id":"IC_kwDOCW7NX85XIZWz","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T11:07:34Z","updated_at":"2023-03-09T15:21:50Z","author_association":"CONTRIBUTOR","body":"Auch!\r\n\r\n```\r\n/home/runner/work/iceberg/iceberg/flink/v1.15/flink/src/main/java/org/apache/iceberg/flink/IcebergTableSink.java:73: error: incompatible types: org.apache.flink.table.connector.sink.DataStreamSinkProvider is not a functional interface\r\n\r\n        (providerContext, dataStream) ->\r\n        ^\r\n    no abstract method found in interface org.apache.flink.table.connector.sink.DataStreamSinkProvider\r\n```\r\n\r\nChanged in https://github.com/apache/iceberg/pull/7059","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1461818803/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462225288","html_url":"https://github.com/apache/iceberg/issues/7026#issuecomment-1462225288","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7026","id":1462225288,"node_id":"IC_kwDOCW7NX85XJ8mI","user":{"login":"doki23","id":11144133,"node_id":"MDQ6VXNlcjExMTQ0MTMz","avatar_url":"https://avatars.githubusercontent.com/u/11144133?v=4","gravatar_id":"","url":"https://api.github.com/users/doki23","html_url":"https://github.com/doki23","followers_url":"https://api.github.com/users/doki23/followers","following_url":"https://api.github.com/users/doki23/following{/other_user}","gists_url":"https://api.github.com/users/doki23/gists{/gist_id}","starred_url":"https://api.github.com/users/doki23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/doki23/subscriptions","organizations_url":"https://api.github.com/users/doki23/orgs","repos_url":"https://api.github.com/users/doki23/repos","events_url":"https://api.github.com/users/doki23/events{/privacy}","received_events_url":"https://api.github.com/users/doki23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T15:12:41Z","updated_at":"2023-03-09T15:12:41Z","author_association":"CONTRIBUTOR","body":"Seems already done by #7044 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462225288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462311843","html_url":"https://github.com/apache/iceberg/issues/7022#issuecomment-1462311843","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7022","id":1462311843,"node_id":"IC_kwDOCW7NX85XKRuj","user":{"login":"doki23","id":11144133,"node_id":"MDQ6VXNlcjExMTQ0MTMz","avatar_url":"https://avatars.githubusercontent.com/u/11144133?v=4","gravatar_id":"","url":"https://api.github.com/users/doki23","html_url":"https://github.com/doki23","followers_url":"https://api.github.com/users/doki23/followers","following_url":"https://api.github.com/users/doki23/following{/other_user}","gists_url":"https://api.github.com/users/doki23/gists{/gist_id}","starred_url":"https://api.github.com/users/doki23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/doki23/subscriptions","organizations_url":"https://api.github.com/users/doki23/orgs","repos_url":"https://api.github.com/users/doki23/repos","events_url":"https://api.github.com/users/doki23/events{/privacy}","received_events_url":"https://api.github.com/users/doki23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T15:58:00Z","updated_at":"2023-03-09T17:28:45Z","author_association":"CONTRIBUTOR","body":"Parquet doesn't support precise filter, so we'd better add a flink filter operator after source scan even though it has been pushed down.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462311843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462430256","html_url":"https://github.com/apache/iceberg/issues/7026#issuecomment-1462430256","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7026","id":1462430256,"node_id":"IC_kwDOCW7NX85XKuow","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T17:05:40Z","updated_at":"2023-03-09T17:05:40Z","author_association":"CONTRIBUTOR","body":"@doki23 Thanks, that PR should have been linked with this issue. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462430256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462478553","html_url":"https://github.com/apache/iceberg/issues/6995#issuecomment-1462478553","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6995","id":1462478553,"node_id":"IC_kwDOCW7NX85XK6bZ","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T17:36:40Z","updated_at":"2023-03-09T17:36:40Z","author_association":"CONTRIBUTOR","body":"This works on Iceberg 1.1.0:\r\n![image](https://user-images.githubusercontent.com/1134248/224109581-22939bac-36e3-4199-97fd-517b4cc63f56.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462478553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462547145","html_url":"https://github.com/apache/iceberg/pull/6091#issuecomment-1462547145","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6091","id":1462547145,"node_id":"IC_kwDOCW7NX85XLLLJ","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T18:14:25Z","updated_at":"2023-03-09T18:14:25Z","author_association":"MEMBER","body":"finally figured out the testcase failure 😄 . It was not failing locally as I didn't rebase it. After rebase it failed locally and the reason is newly merged #6682 was missing a case for stats files. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462547145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462574668","html_url":"https://github.com/apache/iceberg/pull/6965#issuecomment-1462574668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6965","id":1462574668,"node_id":"IC_kwDOCW7NX85XLR5M","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T18:34:20Z","updated_at":"2023-03-09T18:34:20Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi thanks for the quick and detailed review! I replied the 2 questions you have, let me know what you think!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462574668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462592832","html_url":"https://github.com/apache/iceberg/pull/7057#issuecomment-1462592832","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7057","id":1462592832,"node_id":"IC_kwDOCW7NX85XLWVA","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T18:49:34Z","updated_at":"2023-03-09T18:49:34Z","author_association":"CONTRIBUTOR","body":"@Fokko we typically don't need to bump flink version, because they are compile only. The flink-dist is provided by the runtime env (e.g. flink base image). even the `icegerg-flink-runtime` uber doesn't pull in any flink core runtime jars.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462592832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462617655","html_url":"https://github.com/apache/iceberg/pull/6870#issuecomment-1462617655","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6870","id":1462617655,"node_id":"IC_kwDOCW7NX85XLcY3","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T19:05:12Z","updated_at":"2023-03-09T19:05:12Z","author_association":"MEMBER","body":"Merged, Thanks @singhpk234 and @nastra for review and @Fokko for the PR!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462617655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462635906","html_url":"https://github.com/apache/iceberg/pull/6091#issuecomment-1462635906","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6091","id":1462635906,"node_id":"IC_kwDOCW7NX85XLg2C","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T19:16:37Z","updated_at":"2023-03-09T19:16:37Z","author_association":"MEMBER","body":"@rdblue, @jackye1995 : PR is ready ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462635906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462658504","html_url":"https://github.com/apache/iceberg/pull/7057#issuecomment-1462658504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7057","id":1462658504,"node_id":"IC_kwDOCW7NX85XLmXI","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T19:32:20Z","updated_at":"2023-03-09T19:32:20Z","author_association":"CONTRIBUTOR","body":"@stevenzwu I agree that it isn't super important, however, it is good to check for any breaking changes. For example, 1.15.3 has a change in the public API that will cause issues in production: https://github.com/apache/iceberg/pull/7059","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462658504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462741406","html_url":"https://github.com/apache/iceberg/pull/7057#issuecomment-1462741406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7057","id":1462741406,"node_id":"IC_kwDOCW7NX85XL6me","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T20:31:51Z","updated_at":"2023-03-09T20:33:51Z","author_association":"CONTRIBUTOR","body":">  it is good to check for any breaking changes.\r\n\r\nThis doesn't solve the problem. We are only saying that `iceberg-flink-1.16` can work with Flink 1.16 regardless of the patch version. But if Flink introduces a breaking change btw 1.16.0 and 1.16.1. it doesn't matter if we upgrade iceberg build to 1.16.1 or not. one way or another, it will break one patch version. If Flink introduces breaking change in patch release, there is nothing Iceberg can do to keep all patch versions happy.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462741406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462892042","html_url":"https://github.com/apache/iceberg/pull/7057#issuecomment-1462892042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7057","id":1462892042,"node_id":"IC_kwDOCW7NX85XMfYK","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T22:07:30Z","updated_at":"2023-03-09T22:07:30Z","author_association":"CONTRIBUTOR","body":"> This doesn't solve the problem.\r\n\r\nI agree\r\n\r\n> there is nothing Iceberg can do to keep all patch versions happy.\r\n\r\nWouldn't it be better to keep the latest patch version happy?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462892042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462918941","html_url":"https://github.com/apache/iceberg/pull/5525#issuecomment-1462918941","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5525","id":1462918941,"node_id":"IC_kwDOCW7NX85XMl8d","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T22:32:13Z","updated_at":"2023-03-09T22:32:13Z","author_association":"CONTRIBUTOR","body":"@hililiwei is this still needed? Trying to close some old PRs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462918941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462929129","html_url":"https://github.com/apache/iceberg/pull/4422#issuecomment-1462929129","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4422","id":1462929129,"node_id":"IC_kwDOCW7NX85XMobp","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T22:44:32Z","updated_at":"2023-03-09T22:44:32Z","author_association":"CONTRIBUTOR","body":"Closing old PR as this is not active","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462929129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462954705","html_url":"https://github.com/apache/iceberg/pull/5331#issuecomment-1462954705","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5331","id":1462954705,"node_id":"IC_kwDOCW7NX85XMurR","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T23:14:22Z","updated_at":"2023-03-09T23:14:22Z","author_association":"CONTRIBUTOR","body":"Close since the PR is merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462954705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462962502","html_url":"https://github.com/apache/iceberg/pull/6924#issuecomment-1462962502","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6924","id":1462962502,"node_id":"IC_kwDOCW7NX85XMwlG","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T23:20:28Z","updated_at":"2023-03-09T23:31:13Z","author_association":"COLLABORATOR","body":"@aokolnychyi thanks for the review.  Addressed the comments.  Also migrated one test of old SparkFilesScan to use SparkStagedScan, to check the API that way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462962502/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462998042","html_url":"https://github.com/apache/iceberg/issues/7034#issuecomment-1462998042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7034","id":1462998042,"node_id":"IC_kwDOCW7NX85XM5Qa","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T23:39:56Z","updated_at":"2023-03-09T23:40:08Z","author_association":"COLLABORATOR","body":"This might be fixed with : #6648 by @pvary .  I see in [newest code](https://github.com/apache/iceberg/blob/master/hive-metastore/src/main/java/org/apache/iceberg/hive/MetastoreLock.java#L174) the code calls shutdown on exitingScheduledExecutorService.  But in [earlier code](https://github.com/apache/iceberg/blob/apache-iceberg-1.1.0/hive-metastore/src/main/java/org/apache/iceberg/hive/HiveTableOperations.java#L383), it does not.  Although I havent walked through it to be 100% sure.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462998042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462998709","html_url":"https://github.com/apache/iceberg/pull/7053#issuecomment-1462998709","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7053","id":1462998709,"node_id":"IC_kwDOCW7NX85XM5a1","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T23:40:44Z","updated_at":"2023-03-09T23:40:44Z","author_association":"CONTRIBUTOR","body":"@Fokko I assume you checked the diff that there is nothing related to this change, right?\r\n```\r\n git diff --no-index  flink/v1.15/flink/src/ flink/v1.16/flink/src\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1462998709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463001414","html_url":"https://github.com/apache/iceberg/pull/7064#issuecomment-1463001414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7064","id":1463001414,"node_id":"IC_kwDOCW7NX85XM6FG","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-09T23:44:58Z","updated_at":"2023-03-09T23:44:58Z","author_association":"CONTRIBUTOR","body":"@electrum can you take a look and see if this would meet your needs?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463001414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463011302","html_url":"https://github.com/apache/iceberg/pull/7057#issuecomment-1463011302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7057","id":1463011302,"node_id":"IC_kwDOCW7NX85XM8fm","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T00:00:21Z","updated_at":"2023-03-10T05:03:40Z","author_association":"CONTRIBUTOR","body":"> Wouldn't it be better to keep the latest patch version happy?\r\n\r\nI would agree that this is probably the lesser of the evil. But then we need to document the breaking change in the corresponding Iceberg release notes. \r\n\r\nRegarding the functional interface change in 1.15.2, I added a comment in the other PR: https://github.com/apache/iceberg/pull/7059/files#r1131945408. \r\n\r\nWith that, I am personally leaning toward not chasing the Flink patch release due to the unnecessary overhead.\r\n\r\nI would like to get a few other folks' input on this topic of whether we want to keep updating the Flink patch version to make sure Iceberg can work with latest patch version release if there is any breaking change.\r\n\r\ncc @rdblue @hililiwei @pvary \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463011302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463014914","html_url":"https://github.com/apache/iceberg/pull/7008#issuecomment-1463014914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7008","id":1463014914,"node_id":"IC_kwDOCW7NX85XM9YC","user":{"login":"slfan1989","id":55643692,"node_id":"MDQ6VXNlcjU1NjQzNjky","avatar_url":"https://avatars.githubusercontent.com/u/55643692?v=4","gravatar_id":"","url":"https://api.github.com/users/slfan1989","html_url":"https://github.com/slfan1989","followers_url":"https://api.github.com/users/slfan1989/followers","following_url":"https://api.github.com/users/slfan1989/following{/other_user}","gists_url":"https://api.github.com/users/slfan1989/gists{/gist_id}","starred_url":"https://api.github.com/users/slfan1989/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slfan1989/subscriptions","organizations_url":"https://api.github.com/users/slfan1989/orgs","repos_url":"https://api.github.com/users/slfan1989/repos","events_url":"https://api.github.com/users/slfan1989/events{/privacy}","received_events_url":"https://api.github.com/users/slfan1989/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T00:04:26Z","updated_at":"2023-03-10T03:55:02Z","author_association":"CONTRIBUTOR","body":"> in the past we haven't added these changes because it is unclear whether Iceberg should produce a resolved schema or an unresolved schema. Can you explain the purpose of both classes, what you plan to use in this PR, and why you've made that choice?\r\n\r\n@rdblue Thank you very much for your question!\r\n\r\nWe can refer to this document:\r\nhttps://cwiki.apache.org/confluence/display/FLINK/FLIP-164%3A+Improve+Schema+Handling+in+Catalogs\r\n\r\n`FLIP-164` explains that `Schema` should distinguish between `unresolved` and `resolved` variant, while `TableSchema` is a hybrid between `resolved` and `unresolved` schema.\r\n\r\n`TableSchema` is split into 2 parts, `Schema` and `ResolvedSchema`.\r\n\r\n1. Schema\r\n```\r\nOffers convenient methods to adopt columns etc.  Contains Unresolved fields, These fields may not be validated, for example, \r\nthere may be duplicate primary keys.\r\n\r\nSchema {\r\n    static Schema.Builder newBuilder();\r\n    List<UnresolvedColumn> getColumns();\r\n    List<UnresolvedWatermarkSpec> getWatermarkSpecs();\r\n    Optional<UnresolvedPrimaryKey> getPrimaryKey();\r\n    ResolvedSchema resolve(SchemaResolver);\r\n}\r\n```\r\n\r\n2. ResolvedSchema\r\n```\r\nClass that is exposed by the framework at different locations for validated and complete schema.\r\nIt replaces TableSchema\r\n\r\nResolvedSchema {\r\n    int getColumnCount();\r\n    List<Column> getColumns();\r\n    Optional<Column> getColumn(int);\r\n    Optional<Column> getColumn(String);\r\n    List<WatermarkSpec> getWatermarkSpecs();\r\n    Optional<UniqueConstraint> getPrimaryKey();\r\n    DataType toRowDataType();\r\n    DataType toPhysicalRowDataType();\r\n    DataType toPersistedRowDataType();\r\n.....\r\n}\r\n```\r\n\r\nI think we can use `ResolvedSchema` instead of `TableSchema`. \r\n\r\nIn this pr, I didn't modify the core code, just use the property of ResolvedSchema instead of the property of TableSchema, and can pass all the unit tests.\r\n\r\nThe main changes involved are as follows:\r\n1. Use `ResolvedSchema.toPhysicalRowDataType()` instead of `TableSchema.toRowDataType()`.\r\n2. `ResolvedSchema.of()`  instead of `TableSchema.builder()`.\r\n3. `ResolvedCatalogTable`  instead of  `CatalogTable`.\r\n4.  Use `org.apache.flink.table.catalog.Column` better specification of field names and field types.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463014914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463018330","html_url":"https://github.com/apache/iceberg/pull/6907#issuecomment-1463018330","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6907","id":1463018330,"node_id":"IC_kwDOCW7NX85XM-Na","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T00:08:31Z","updated_at":"2023-03-10T00:15:58Z","author_association":"MEMBER","body":"It seems now `testPartialProgressEnabled` is flaky. failed only for spark3.1 java 8.\r\nBecause of 5 concurrent commits, One of the file groups has failed to commit? I think it is better to set the concurrency to 1 for this particular test case.  \r\n\r\n```\r\norg.apache.iceberg.spark.actions.TestRewriteDataFilesAction > testPartialProgressEnabled FAILED\r\n    java.lang.AssertionError: Should have 10 fileGroups expected:<9> but was:<10>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:647)\r\n        at \r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463018330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463021159","html_url":"https://github.com/apache/iceberg/issues/5356#issuecomment-1463021159","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5356","id":1463021159,"node_id":"IC_kwDOCW7NX85XM-5n","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T00:12:31Z","updated_at":"2023-03-10T00:12:31Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463021159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463030881","html_url":"https://github.com/apache/iceberg/pull/7008#issuecomment-1463030881","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7008","id":1463030881,"node_id":"IC_kwDOCW7NX85XNBRh","user":{"login":"slfan1989","id":55643692,"node_id":"MDQ6VXNlcjU1NjQzNjky","avatar_url":"https://avatars.githubusercontent.com/u/55643692?v=4","gravatar_id":"","url":"https://api.github.com/users/slfan1989","html_url":"https://github.com/slfan1989","followers_url":"https://api.github.com/users/slfan1989/followers","following_url":"https://api.github.com/users/slfan1989/following{/other_user}","gists_url":"https://api.github.com/users/slfan1989/gists{/gist_id}","starred_url":"https://api.github.com/users/slfan1989/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slfan1989/subscriptions","organizations_url":"https://api.github.com/users/slfan1989/orgs","repos_url":"https://api.github.com/users/slfan1989/repos","events_url":"https://api.github.com/users/slfan1989/events{/privacy}","received_events_url":"https://api.github.com/users/slfan1989/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T00:27:17Z","updated_at":"2023-03-10T00:27:17Z","author_association":"CONTRIBUTOR","body":"> some of previous attempts: PR #4246 and PR #5938\r\n\r\n@stevenzwu  Thank you for the information!\r\n\r\nI think my PR has the following advantages:\r\n\r\n1. Completely replace `TableSchema` with `ResolvedSchema` based on the latest code.\r\n2. Pass all unit tests.\r\n3. The code changes are small and do not affect other codes.\r\n\r\nCan I continue this work based on this PR?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463030881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463047042","html_url":"https://github.com/apache/iceberg/pull/6924#issuecomment-1463047042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6924","id":1463047042,"node_id":"IC_kwDOCW7NX85XNFOC","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T00:54:27Z","updated_at":"2023-03-10T00:54:27Z","author_association":"COLLABORATOR","body":"I updated the pr title to more reflect the current state of it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463047042/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463065147","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1463065147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1463065147,"node_id":"IC_kwDOCW7NX85XNJo7","user":{"login":"leichangqing","id":36058877,"node_id":"MDQ6VXNlcjM2MDU4ODc3","avatar_url":"https://avatars.githubusercontent.com/u/36058877?v=4","gravatar_id":"","url":"https://api.github.com/users/leichangqing","html_url":"https://github.com/leichangqing","followers_url":"https://api.github.com/users/leichangqing/followers","following_url":"https://api.github.com/users/leichangqing/following{/other_user}","gists_url":"https://api.github.com/users/leichangqing/gists{/gist_id}","starred_url":"https://api.github.com/users/leichangqing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leichangqing/subscriptions","organizations_url":"https://api.github.com/users/leichangqing/orgs","repos_url":"https://api.github.com/users/leichangqing/repos","events_url":"https://api.github.com/users/leichangqing/events{/privacy}","received_events_url":"https://api.github.com/users/leichangqing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T01:17:07Z","updated_at":"2023-03-10T01:17:07Z","author_association":"NONE","body":"> We also met this problem in our scenarios. We modify schema of the sink iceberg table frequently. Now I try to get the table schema through iceberg table refresh api to dynamically construct a DataStream to add new columns. It is possible to add new columns, but writing new columns to iceberg sink does not take effect, because sink does not support dynamic update of schema.If iceberg flink sink writer can add iceberg table refresh function support, it will be more convenient to use. After all, it takes a minute or two to restart flink now. @stevenzwu\r\n\r\nI have interesting on this, how to contact with u about dynamical schema","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463065147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463100452","html_url":"https://github.com/apache/iceberg/pull/7048#issuecomment-1463100452","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7048","id":1463100452,"node_id":"IC_kwDOCW7NX85XNSQk","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T02:04:02Z","updated_at":"2023-03-10T02:04:02Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463100452/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463178350","html_url":"https://github.com/apache/iceberg/pull/6965#issuecomment-1463178350","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6965","id":1463178350,"node_id":"IC_kwDOCW7NX85XNlRu","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T02:57:43Z","updated_at":"2023-03-10T02:57:43Z","author_association":"CONTRIBUTOR","body":"@rdblue, do you want to take another look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463178350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463192830","html_url":"https://github.com/apache/iceberg/pull/7064#issuecomment-1463192830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7064","id":1463192830,"node_id":"IC_kwDOCW7NX85XNoz-","user":{"login":"electrum","id":9230,"node_id":"MDQ6VXNlcjkyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9230?v=4","gravatar_id":"","url":"https://api.github.com/users/electrum","html_url":"https://github.com/electrum","followers_url":"https://api.github.com/users/electrum/followers","following_url":"https://api.github.com/users/electrum/following{/other_user}","gists_url":"https://api.github.com/users/electrum/gists{/gist_id}","starred_url":"https://api.github.com/users/electrum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrum/subscriptions","organizations_url":"https://api.github.com/users/electrum/orgs","repos_url":"https://api.github.com/users/electrum/repos","events_url":"https://api.github.com/users/electrum/events{/privacy}","received_events_url":"https://api.github.com/users/electrum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T03:14:51Z","updated_at":"2023-03-10T03:14:51Z","author_association":"CONTRIBUTOR","body":"I tested this out and it works for us. The simple integration where we ignore config is good enough to have everything go through `TrinoFileSystem` and avoid the need for `HadoopFileIO`:\r\n```java\r\nicebergCatalogInstance.setFileIOBuilder(config -> new ForwardingFileIo(fileSystemFactory.create(identity)));\r\n```\r\nWe can extend this to capture the config for overriding S3 credentials, signer, etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463192830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463193052","html_url":"https://github.com/apache/iceberg/pull/7064#issuecomment-1463193052","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7064","id":1463193052,"node_id":"IC_kwDOCW7NX85XNo3c","user":{"login":"electrum","id":9230,"node_id":"MDQ6VXNlcjkyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9230?v=4","gravatar_id":"","url":"https://api.github.com/users/electrum","html_url":"https://github.com/electrum","followers_url":"https://api.github.com/users/electrum/followers","following_url":"https://api.github.com/users/electrum/following{/other_user}","gists_url":"https://api.github.com/users/electrum/gists{/gist_id}","starred_url":"https://api.github.com/users/electrum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrum/subscriptions","organizations_url":"https://api.github.com/users/electrum/orgs","repos_url":"https://api.github.com/users/electrum/repos","events_url":"https://api.github.com/users/electrum/events{/privacy}","received_events_url":"https://api.github.com/users/electrum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T03:15:13Z","updated_at":"2023-03-10T03:15:13Z","author_association":"CONTRIBUTOR","body":"We'll need the same thing for `JdbcCatalog`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463193052/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463200734","html_url":"https://github.com/apache/iceberg/pull/7038#issuecomment-1463200734","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7038","id":1463200734,"node_id":"IC_kwDOCW7NX85XNqve","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T03:28:49Z","updated_at":"2023-03-10T03:28:49Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @amogh-jahagirdar @flyrain @singhpk234!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463200734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463221550","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1463221550","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1463221550,"node_id":"IC_kwDOCW7NX85XNv0u","user":{"login":"lintingbin","id":5699014,"node_id":"MDQ6VXNlcjU2OTkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5699014?v=4","gravatar_id":"","url":"https://api.github.com/users/lintingbin","html_url":"https://github.com/lintingbin","followers_url":"https://api.github.com/users/lintingbin/followers","following_url":"https://api.github.com/users/lintingbin/following{/other_user}","gists_url":"https://api.github.com/users/lintingbin/gists{/gist_id}","starred_url":"https://api.github.com/users/lintingbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lintingbin/subscriptions","organizations_url":"https://api.github.com/users/lintingbin/orgs","repos_url":"https://api.github.com/users/lintingbin/repos","events_url":"https://api.github.com/users/lintingbin/events{/privacy}","received_events_url":"https://api.github.com/users/lintingbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T04:03:19Z","updated_at":"2023-03-10T04:03:19Z","author_association":"CONTRIBUTOR","body":"@leichangqing You can refer to the last two commits of my branch https://github.com/lintingbin2009/iceberg/tree/flink-sink-dynamically-change. We have put this part of the code in our own production environment and executed it for half a year, and it seems that there is no problem so far.\r\n<img width=\"1125\" alt=\"image\" src=\"https://user-images.githubusercontent.com/5699014/224219390-eac0d0e2-1578-44d8-a6d5-6ba97362e02e.png\">\r\nCorresponding to 1, 2, 3 in the above picture, you need to prepare:\r\n1. There needs to be a broadcast node that can subscribe to your schema changes.\r\n2. The data processing node can generate RowData according to the latest schema processing data.\r\n3. This is based on the above code modification so that the iceberg writer node can receive the latest schema and apply it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463221550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463237071","html_url":"https://github.com/apache/iceberg/issues/4190#issuecomment-1463237071","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4190","id":1463237071,"node_id":"IC_kwDOCW7NX85XNznP","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T04:30:01Z","updated_at":"2023-03-10T04:30:01Z","author_association":"CONTRIBUTOR","body":"It will be a good starting point if someone likes to create a design doc on how to solve this problem in a general and scalable way","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463237071/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463680052","html_url":"https://github.com/apache/iceberg/issues/3665#issuecomment-1463680052","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3665","id":1463680052,"node_id":"IC_kwDOCW7NX85XPfw0","user":{"login":"adarsh112","id":19358560,"node_id":"MDQ6VXNlcjE5MzU4NTYw","avatar_url":"https://avatars.githubusercontent.com/u/19358560?v=4","gravatar_id":"","url":"https://api.github.com/users/adarsh112","html_url":"https://github.com/adarsh112","followers_url":"https://api.github.com/users/adarsh112/followers","following_url":"https://api.github.com/users/adarsh112/following{/other_user}","gists_url":"https://api.github.com/users/adarsh112/gists{/gist_id}","starred_url":"https://api.github.com/users/adarsh112/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adarsh112/subscriptions","organizations_url":"https://api.github.com/users/adarsh112/orgs","repos_url":"https://api.github.com/users/adarsh112/repos","events_url":"https://api.github.com/users/adarsh112/events{/privacy}","received_events_url":"https://api.github.com/users/adarsh112/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T11:38:37Z","updated_at":"2023-03-10T11:38:37Z","author_association":"NONE","body":"Waiting for Dataframe api for merge into. This is pretty basic not sure why is it not yet available.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463680052/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463739013","html_url":"https://github.com/apache/iceberg/pull/6975#issuecomment-1463739013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6975","id":1463739013,"node_id":"IC_kwDOCW7NX85XPuKF","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T12:31:07Z","updated_at":"2023-03-10T12:31:07Z","author_association":"MEMBER","body":"Hi, Can this PR be merged if no more comments or no new reviewers? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463739013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463761535","html_url":"https://github.com/apache/iceberg/pull/6624#issuecomment-1463761535","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6624","id":1463761535,"node_id":"IC_kwDOCW7NX85XPzp_","user":{"login":"sweetpythoncode","id":29664369,"node_id":"MDQ6VXNlcjI5NjY0MzY5","avatar_url":"https://avatars.githubusercontent.com/u/29664369?v=4","gravatar_id":"","url":"https://api.github.com/users/sweetpythoncode","html_url":"https://github.com/sweetpythoncode","followers_url":"https://api.github.com/users/sweetpythoncode/followers","following_url":"https://api.github.com/users/sweetpythoncode/following{/other_user}","gists_url":"https://api.github.com/users/sweetpythoncode/gists{/gist_id}","starred_url":"https://api.github.com/users/sweetpythoncode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sweetpythoncode/subscriptions","organizations_url":"https://api.github.com/users/sweetpythoncode/orgs","repos_url":"https://api.github.com/users/sweetpythoncode/repos","events_url":"https://api.github.com/users/sweetpythoncode/events{/privacy}","received_events_url":"https://api.github.com/users/sweetpythoncode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T12:52:17Z","updated_at":"2023-03-10T13:35:09Z","author_association":"NONE","body":"@RussellSpitzer Can you take a look at it when u have time, the current add_files method is super slow on a big number of partitions, please","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463761535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463789508","html_url":"https://github.com/apache/iceberg/issues/7022#issuecomment-1463789508","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7022","id":1463789508,"node_id":"IC_kwDOCW7NX85XP6fE","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T13:14:56Z","updated_at":"2023-03-10T13:15:24Z","author_association":"CONTRIBUTOR","body":"I don't know why this gets the correct result when stored as ORC, but I think Iceberg always leave the row level filtering to the post scan. And the java doc for `FlinkSource#forRowData` said that it's equivalent to `TableScan`, it is not for row level filtering, so I think this is an expected result.\r\n\r\n> Initialize a FlinkSource.Builder to read the data from iceberg table. Equivalent to TableScan. See more options in ScanContext.\r\n> The Source can be read static data in bounded mode. It can also continuously check the arrival of new data and read records incrementally.\r\n> Without startSnapshotId: Bounded\r\n> With startSnapshotId and with endSnapshotId: Bounded\r\n> With startSnapshotId (-1 means unbounded preceding) and Without endSnapshotId: Unbounded\r\n> \r\n> Returns:\r\n> FlinkSource.Builder to connect the iceberg table","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463789508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463799983","html_url":"https://github.com/apache/iceberg/pull/7045#issuecomment-1463799983","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7045","id":1463799983,"node_id":"IC_kwDOCW7NX85XP9Cv","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T13:24:09Z","updated_at":"2023-03-10T13:24:09Z","author_association":"MEMBER","body":"cc: @nastra, @jackye1995, @XN137, @Fokko    ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463799983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463800655","html_url":"https://github.com/apache/iceberg/pull/7060#issuecomment-1463800655","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7060","id":1463800655,"node_id":"IC_kwDOCW7NX85XP9NP","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T13:24:43Z","updated_at":"2023-03-10T13:24:43Z","author_association":"MEMBER","body":"cc: @snazy, @nastra, @Fokko   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463800655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463875585","html_url":"https://github.com/apache/iceberg/pull/7066#issuecomment-1463875585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7066","id":1463875585,"node_id":"IC_kwDOCW7NX85XQPgB","user":{"login":"dpaani","id":5696806,"node_id":"MDQ6VXNlcjU2OTY4MDY=","avatar_url":"https://avatars.githubusercontent.com/u/5696806?v=4","gravatar_id":"","url":"https://api.github.com/users/dpaani","html_url":"https://github.com/dpaani","followers_url":"https://api.github.com/users/dpaani/followers","following_url":"https://api.github.com/users/dpaani/following{/other_user}","gists_url":"https://api.github.com/users/dpaani/gists{/gist_id}","starred_url":"https://api.github.com/users/dpaani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dpaani/subscriptions","organizations_url":"https://api.github.com/users/dpaani/orgs","repos_url":"https://api.github.com/users/dpaani/repos","events_url":"https://api.github.com/users/dpaani/events{/privacy}","received_events_url":"https://api.github.com/users/dpaani/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T14:23:03Z","updated_at":"2023-03-10T14:23:03Z","author_association":"CONTRIBUTOR","body":"@jackye1995 @RussellSpitzer Could you please review this PR. TIA","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463875585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463895365","html_url":"https://github.com/apache/iceberg/issues/6564#issuecomment-1463895365","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6564","id":1463895365,"node_id":"IC_kwDOCW7NX85XQUVF","user":{"login":"asheeshgarg","id":4348671,"node_id":"MDQ6VXNlcjQzNDg2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/4348671?v=4","gravatar_id":"","url":"https://api.github.com/users/asheeshgarg","html_url":"https://github.com/asheeshgarg","followers_url":"https://api.github.com/users/asheeshgarg/followers","following_url":"https://api.github.com/users/asheeshgarg/following{/other_user}","gists_url":"https://api.github.com/users/asheeshgarg/gists{/gist_id}","starred_url":"https://api.github.com/users/asheeshgarg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asheeshgarg/subscriptions","organizations_url":"https://api.github.com/users/asheeshgarg/orgs","repos_url":"https://api.github.com/users/asheeshgarg/repos","events_url":"https://api.github.com/users/asheeshgarg/events{/privacy}","received_events_url":"https://api.github.com/users/asheeshgarg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T14:37:33Z","updated_at":"2023-03-10T14:37:33Z","author_association":"NONE","body":"One thing we can use is directly leverage Java APIs using PY4J or JYPE to call the underlying API. This will reduce the maintenance at two places.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1463895365/reactions","total_count":5,"+1":0,"-1":5,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464044392","html_url":"https://github.com/apache/iceberg/issues/7067#issuecomment-1464044392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7067","id":1464044392,"node_id":"IC_kwDOCW7NX85XQ4to","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T16:17:46Z","updated_at":"2023-03-10T16:17:46Z","author_association":"CONTRIBUTOR","body":"Hey @asheeshgarg Thanks for raising this!\r\n\r\nIntegrating with Polars would be awesome. \r\n\r\nCurrently, we can load data into an Arrow table and convert that in every Arrow based backed (including Polars). As a short-term fix, we can add next to `to_arrow()` and `to_pandas` a method called [`to_polars()`](https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.from_arrow.html). \r\n\r\nAnd on a longer term. Unfortunately, we don't yet support pushing down the predicate from a PyArrow dataset directly all the way down to Iceberg. Once that is done, we can also easily add this to Polars. (Disclaimer: I'm more familiar with PyArrow at the moment, therefore the PyArrow concepts). I do think Polars and Iceberg would be an awesome combination as Polars is also lazy by design, and you would only open the Parquet files that you actually need for your query.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464044392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464150763","html_url":"https://github.com/apache/iceberg/issues/7067#issuecomment-1464150763","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7067","id":1464150763,"node_id":"IC_kwDOCW7NX85XRSrr","user":{"login":"asheeshgarg","id":4348671,"node_id":"MDQ6VXNlcjQzNDg2NzE=","avatar_url":"https://avatars.githubusercontent.com/u/4348671?v=4","gravatar_id":"","url":"https://api.github.com/users/asheeshgarg","html_url":"https://github.com/asheeshgarg","followers_url":"https://api.github.com/users/asheeshgarg/followers","following_url":"https://api.github.com/users/asheeshgarg/following{/other_user}","gists_url":"https://api.github.com/users/asheeshgarg/gists{/gist_id}","starred_url":"https://api.github.com/users/asheeshgarg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asheeshgarg/subscriptions","organizations_url":"https://api.github.com/users/asheeshgarg/orgs","repos_url":"https://api.github.com/users/asheeshgarg/repos","events_url":"https://api.github.com/users/asheeshgarg/events{/privacy}","received_events_url":"https://api.github.com/users/asheeshgarg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T17:43:41Z","updated_at":"2023-03-10T17:45:17Z","author_association":"NONE","body":"@Fokko thanks for the inputs for now what I am doing is using Pyiceberg API to to create scan and pass possible level of expression to reduce the datasets files and create a lazy dataframe using Polars and run filters again lazily on dataframe expressions for the query.\r\n ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464150763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464221989","html_url":"https://github.com/apache/iceberg/pull/6924#issuecomment-1464221989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6924","id":1464221989,"node_id":"IC_kwDOCW7NX85XRkEl","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T18:32:17Z","updated_at":"2023-03-10T18:32:17Z","author_association":"COLLABORATOR","body":"@aokolnychyi thanks, sounds good, will rebase and merge once that is in, then","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464221989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464229388","html_url":"https://github.com/apache/iceberg/issues/7067#issuecomment-1464229388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7067","id":1464229388,"node_id":"IC_kwDOCW7NX85XRl4M","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T18:37:46Z","updated_at":"2023-03-10T18:37:46Z","author_association":"CONTRIBUTOR","body":"@asheeshgarg Ah nice, that works, but has some caveats that you need to be aware of. Iceberg tracks the columns by ID's instead of names. For example, if you rename a column, we do this on the table schema. When we read in the files, and we encounter a file that has the old column name, we update the name based on the ID of the column. Also, things likes deletes. This makes it quite an effort to implement Iceberg to engines like Polars as well (mostly because there is no rust implementation yet).\r\n\r\nWith the upcoming 0.4.0 version we'll get even more performance because now we also have metrics evaluation (skipping Parquet files based on the upper- and lower bounds) and also positional deletes. I suggested creating a Polars dataframe from an Arrow table because then you'll get things like the projection and deletes for free :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464229388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464263948","html_url":"https://github.com/apache/iceberg/pull/6091#issuecomment-1464263948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6091","id":1464263948,"node_id":"IC_kwDOCW7NX85XRuUM","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T19:04:53Z","updated_at":"2023-03-10T19:04:53Z","author_association":"CONTRIBUTOR","body":"Thanks, @ajantha-bhat! Thanks for reviewing, @findepi @rdblue @jackye1995 @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464263948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464270398","html_url":"https://github.com/apache/iceberg/pull/6804#issuecomment-1464270398","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6804","id":1464270398,"node_id":"IC_kwDOCW7NX85XRv4-","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T19:10:09Z","updated_at":"2023-03-10T19:10:09Z","author_association":"CONTRIBUTOR","body":"@jrcamp could you apply spotless as Fokko suggested? Everything else also looks good to me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464270398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464279981","html_url":"https://github.com/apache/iceberg/pull/7068#issuecomment-1464279981","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7068","id":1464279981,"node_id":"IC_kwDOCW7NX85XRyOt","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T19:16:42Z","updated_at":"2023-03-10T19:16:42Z","author_association":"CONTRIBUTOR","body":"cc @szehon-ho @amogh-jahagirdar @flyrain @singhpk234 @ajantha-bhat ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464279981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464282141","html_url":"https://github.com/apache/iceberg/pull/7069#issuecomment-1464282141","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7069","id":1464282141,"node_id":"IC_kwDOCW7NX85XRywd","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T19:18:38Z","updated_at":"2023-03-10T19:18:38Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer @szehon-ho @amogh-jahagirdar @flyrain @singhpk234 @ajantha-bhat","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464282141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464284121","html_url":"https://github.com/apache/iceberg/pull/5046#issuecomment-1464284121","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5046","id":1464284121,"node_id":"IC_kwDOCW7NX85XRzPZ","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T19:20:13Z","updated_at":"2023-03-10T19:20:13Z","author_association":"CONTRIBUTOR","body":"Hi sorry I overlooked this PR for a long time, do you still plan to finish this feature?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464284121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464288225","html_url":"https://github.com/apache/iceberg/pull/4239#issuecomment-1464288225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4239","id":1464288225,"node_id":"IC_kwDOCW7NX85XR0Ph","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T19:22:11Z","updated_at":"2023-03-10T19:22:11Z","author_association":"CONTRIBUTOR","body":"I think this is duplicate for #4371, we can close it now","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464288225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464294529","html_url":"https://github.com/apache/iceberg/pull/5373#issuecomment-1464294529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5373","id":1464294529,"node_id":"IC_kwDOCW7NX85XR1yB","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T19:24:30Z","updated_at":"2023-03-10T19:24:30Z","author_association":"CONTRIBUTOR","body":"Close as duplicate for #6682 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464294529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464372309","html_url":"https://github.com/apache/iceberg/pull/7004#issuecomment-1464372309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7004","id":1464372309,"node_id":"IC_kwDOCW7NX85XSIxV","user":{"login":"manisin","id":21346391,"node_id":"MDQ6VXNlcjIxMzQ2Mzkx","avatar_url":"https://avatars.githubusercontent.com/u/21346391?v=4","gravatar_id":"","url":"https://api.github.com/users/manisin","html_url":"https://github.com/manisin","followers_url":"https://api.github.com/users/manisin/followers","following_url":"https://api.github.com/users/manisin/following{/other_user}","gists_url":"https://api.github.com/users/manisin/gists{/gist_id}","starred_url":"https://api.github.com/users/manisin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manisin/subscriptions","organizations_url":"https://api.github.com/users/manisin/orgs","repos_url":"https://api.github.com/users/manisin/repos","events_url":"https://api.github.com/users/manisin/events{/privacy}","received_events_url":"https://api.github.com/users/manisin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T20:20:37Z","updated_at":"2023-03-10T20:20:59Z","author_association":"CONTRIBUTOR","body":"> > > @manisin just a general question, but is there some sort of Docker image(s) that could be used for integration testing this with [testcontainers](https://www.testcontainers.org/)? I'm curious what the general approach for integration testing is for this. The PR as it stands right now doesn't run as part of normal CI (as I commented above) and there's also no separate yml file that would set this up for its own CI runs (with the env vars that are mentioned in the README).\r\n> > \r\n> > \r\n> > @nastra there are no images/test containers to deploy and test snowflake. The approach we are considering it to add a separate yml file ( like this https://github.com/Snowflake-Labs/iceberg/blob/1f0dec004f83e1000f65cb552c360dc28eaf7559/.github/workflows/snowflake-ci.yml) and provision a snowflake deployment (with secrets onboarded to github) for integration testing with iceberg. Let me know your thoughts and suggestions.\r\n> \r\n> @manisin having a separate yml file for Snowflake integration tests should be fine, although I would probably include it in this PR.\r\n\r\n\r\n\r\n@nastra if I include the yml file in this PR then the workflow will fail as we need to onboard the secrets to github for the deployment provisioned on snowflake side. I can include the yml, if it's ok to start with a failing workflow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464372309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464446889","html_url":"https://github.com/apache/iceberg/pull/7069#issuecomment-1464446889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7069","id":1464446889,"node_id":"IC_kwDOCW7NX85XSa-p","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T20:44:19Z","updated_at":"2023-03-10T20:44:19Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464446889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464466559","html_url":"https://github.com/apache/iceberg/pull/7053#issuecomment-1464466559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7053","id":1464466559,"node_id":"IC_kwDOCW7NX85XSfx_","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T21:01:12Z","updated_at":"2023-03-10T21:01:12Z","author_association":"CONTRIBUTOR","body":"@stevenzwu I just did and found 1 whitespace change. Thanks for the suggestion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464466559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464486193","html_url":"https://github.com/apache/iceberg/issues/7071#issuecomment-1464486193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7071","id":1464486193,"node_id":"IC_kwDOCW7NX85XSkkx","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T21:17:03Z","updated_at":"2023-03-10T21:17:03Z","author_association":"CONTRIBUTOR","body":"thanks for bringing this up! Yes I remember we briefly discussed this in a past community sync. cc @danielcweeks @rdblue \r\n\r\nI am sure this is going to help with the case where people do not set default at all, and we can dynamically reduce target file size to increase utilization of worker nodes. \r\n\r\nBut people can technically do that by setting `read.split.target-size` to customize for each table, and I think they should do that. But that goes to the realm of auto-optimization.\r\n\r\nI am interested to know what other people think.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464486193/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464515984","html_url":"https://github.com/apache/iceberg/pull/7053#issuecomment-1464515984","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7053","id":1464515984,"node_id":"IC_kwDOCW7NX85XSr2Q","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T21:50:28Z","updated_at":"2023-03-10T21:50:28Z","author_association":"CONTRIBUTOR","body":"thanks @Fokko for the backport","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464515984/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464516439","html_url":"https://github.com/apache/iceberg/pull/7056#issuecomment-1464516439","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7056","id":1464516439,"node_id":"IC_kwDOCW7NX85XSr9X","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T21:50:53Z","updated_at":"2023-03-10T21:50:53Z","author_association":"CONTRIBUTOR","body":"thanks @Fokko for the backport","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464516439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464516628","html_url":"https://github.com/apache/iceberg/issues/647#issuecomment-1464516628","issue_url":"https://api.github.com/repos/apache/iceberg/issues/647","id":1464516628,"node_id":"IC_kwDOCW7NX85XSsAU","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T21:51:03Z","updated_at":"2023-03-10T21:51:03Z","author_association":"CONTRIBUTOR","body":"Assigning to me, I will start to implement a PR for this based on the prototype","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464516628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464544455","html_url":"https://github.com/apache/iceberg/pull/7068#issuecomment-1464544455","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7068","id":1464544455,"node_id":"IC_kwDOCW7NX85XSyzH","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T22:15:34Z","updated_at":"2023-03-10T22:15:34Z","author_association":"CONTRIBUTOR","body":">  Do we need the ProcedureInput change in Spark 3.2?\r\n\r\n@flyrain, I was debating that. Probably we could do that for consistency? What are your thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464544455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464552650","html_url":"https://github.com/apache/iceberg/pull/7068#issuecomment-1464552650","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7068","id":1464552650,"node_id":"IC_kwDOCW7NX85XS0zK","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T22:21:18Z","updated_at":"2023-03-10T22:21:18Z","author_association":"CONTRIBUTOR","body":"Yeah, my only concern is that, any new change to procedure will be hard to apply to 3.2 if we don't do that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464552650/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464555102","html_url":"https://github.com/apache/iceberg/pull/7068#issuecomment-1464555102","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7068","id":1464555102,"node_id":"IC_kwDOCW7NX85XS1Ze","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T22:23:41Z","updated_at":"2023-03-10T22:23:41Z","author_association":"CONTRIBUTOR","body":"Agreed, will cherry-pick in a bit.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464555102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464562239","html_url":"https://github.com/apache/iceberg/pull/7068#issuecomment-1464562239","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7068","id":1464562239,"node_id":"IC_kwDOCW7NX85XS3I_","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T22:29:15Z","updated_at":"2023-03-10T22:29:15Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @singhpk234 and @flyrain!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464562239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464651793","html_url":"https://github.com/apache/iceberg/pull/7072#issuecomment-1464651793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7072","id":1464651793,"node_id":"IC_kwDOCW7NX85XTNAR","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-10T23:42:04Z","updated_at":"2023-03-10T23:42:04Z","author_association":"CONTRIBUTOR","body":"Thanks @aokolnychyi !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464651793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464700369","html_url":"https://github.com/apache/iceberg/issues/5101#issuecomment-1464700369","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5101","id":1464700369,"node_id":"IC_kwDOCW7NX85XTY3R","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T00:11:21Z","updated_at":"2023-03-11T00:11:21Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464700369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464716656","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-1464716656","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":1464716656,"node_id":"IC_kwDOCW7NX85XTc1w","user":{"login":"AraiYuno","id":28745975,"node_id":"MDQ6VXNlcjI4NzQ1OTc1","avatar_url":"https://avatars.githubusercontent.com/u/28745975?v=4","gravatar_id":"","url":"https://api.github.com/users/AraiYuno","html_url":"https://github.com/AraiYuno","followers_url":"https://api.github.com/users/AraiYuno/followers","following_url":"https://api.github.com/users/AraiYuno/following{/other_user}","gists_url":"https://api.github.com/users/AraiYuno/gists{/gist_id}","starred_url":"https://api.github.com/users/AraiYuno/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AraiYuno/subscriptions","organizations_url":"https://api.github.com/users/AraiYuno/orgs","repos_url":"https://api.github.com/users/AraiYuno/repos","events_url":"https://api.github.com/users/AraiYuno/events{/privacy}","received_events_url":"https://api.github.com/users/AraiYuno/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T00:21:08Z","updated_at":"2023-03-11T00:21:08Z","author_association":"NONE","body":"Is there any update on this feature?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464716656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464724949","html_url":"https://github.com/apache/iceberg/pull/6965#issuecomment-1464724949","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6965","id":1464724949,"node_id":"IC_kwDOCW7NX85XTe3V","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T00:38:24Z","updated_at":"2023-03-11T00:38:24Z","author_association":"CONTRIBUTOR","body":"@jackye1995, this looks great. It's a huge PR so there were quite a few minor things, but overall I don't see any blockers for getting this in. If you want to merge now and follow up with changes, go for it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464724949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464734878","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1464734878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1464734878,"node_id":"IC_kwDOCW7NX85XThSe","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T01:03:36Z","updated_at":"2023-03-11T01:08:39Z","author_association":"COLLABORATOR","body":"I walked through the code and see the problem.  \r\n\r\nI still think, let's change the original method: collectResolvedSparkExpression to not throw AnalysisException in this case.  I feel its not so useful to make an additional method that does the same thing , and have the code have to call both.\r\n\r\n```\r\n  def collectResolvedSparkExpression(session: SparkSession, tableName: String, where: String): Option[Expression] = {\r\n    val tableAttrs = session.table(tableName).queryExecution.analyzed.output\r\n    val unresolvedExpression = session.sessionState.sqlParser.parseExpression(where)\r\n    val filter = Filter(unresolvedExpression, DummyRelation(tableAttrs))\r\n    val optimizedLogicalPlan = session.sessionState.executePlan(filter).optimizedPlan\r\n    optimizedLogicalPlan.collectFirst {\r\n      case filter: Filter => Some(filter.condition)\r\n    }.getOrElse(Option.empty())\r\n  }\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464734878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464806360","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1464806360","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1464806360,"node_id":"IC_kwDOCW7NX85XTyvY","user":{"login":"ludlows","id":6441333,"node_id":"MDQ6VXNlcjY0NDEzMzM=","avatar_url":"https://avatars.githubusercontent.com/u/6441333?v=4","gravatar_id":"","url":"https://api.github.com/users/ludlows","html_url":"https://github.com/ludlows","followers_url":"https://api.github.com/users/ludlows/followers","following_url":"https://api.github.com/users/ludlows/following{/other_user}","gists_url":"https://api.github.com/users/ludlows/gists{/gist_id}","starred_url":"https://api.github.com/users/ludlows/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ludlows/subscriptions","organizations_url":"https://api.github.com/users/ludlows/orgs","repos_url":"https://api.github.com/users/ludlows/repos","events_url":"https://api.github.com/users/ludlows/events{/privacy}","received_events_url":"https://api.github.com/users/ludlows/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T03:05:25Z","updated_at":"2023-03-11T03:05:25Z","author_association":"CONTRIBUTOR","body":"Hi @szehon-ho , \r\nthank you so much for the code review!\r\nindeed, the approach following your suggesstion modifies less code. \r\nnow, I have implemented this approach in [the latest commit ](https://github.com/apache/iceberg/pull/6760/commits/f67abe2242b0e2399402dd94fe5242cba5d6f952). \r\ncould you take a look and give more suggestions?\r\nthanks and have a nice weekend!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464806360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464829337","html_url":"https://github.com/apache/iceberg/pull/6091#issuecomment-1464829337","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6091","id":1464829337,"node_id":"IC_kwDOCW7NX85XT4WZ","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T05:14:56Z","updated_at":"2023-03-11T05:14:56Z","author_association":"MEMBER","body":"Thanks @aokolnychyi for merging this. \r\n\r\n- I have backported it to spark:3.2: https://github.com/apache/iceberg/pull/7074 and build passes for it. \r\n- Spark3.1 backport needs some effort as spark 3.1 doesn't have https://github.com/apache/iceberg/pull/3457 and #6682 (not sure why it was not backported) \r\n- same problems for spark2.4 too. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464829337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464830302","html_url":"https://github.com/apache/iceberg/pull/6965#issuecomment-1464830302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6965","id":1464830302,"node_id":"IC_kwDOCW7NX85XT4le","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T05:20:57Z","updated_at":"2023-03-11T05:20:57Z","author_association":"CONTRIBUTOR","body":"I will go ahead to merge this PR since it touches many files and is very easy to conflict with other PRs. We can address remaining comments in #7050. Thanks everyone for the review! @rdblue @aokolnychyi @amogh-jahagirdar @namrathamyske ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464830302/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464831349","html_url":"https://github.com/apache/iceberg/pull/6924#issuecomment-1464831349","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6924","id":1464831349,"node_id":"IC_kwDOCW7NX85XT411","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T05:26:44Z","updated_at":"2023-03-11T05:26:44Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464831349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464832543","html_url":"https://github.com/apache/iceberg/pull/6091#issuecomment-1464832543","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6091","id":1464832543,"node_id":"IC_kwDOCW7NX85XT5If","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T05:34:28Z","updated_at":"2023-03-11T05:34:28Z","author_association":"CONTRIBUTOR","body":"I merged the Spark 3.2 PR, thanks. We stopped active development on 2.4 and 3.1. We also consider dropping 3.1 soon. In my view, it is OK not to cherrypick this change there. Up to you, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464832543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464895527","html_url":"https://github.com/apache/iceberg/issues/7022#issuecomment-1464895527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7022","id":1464895527,"node_id":"IC_kwDOCW7NX85XUIgn","user":{"login":"doki23","id":11144133,"node_id":"MDQ6VXNlcjExMTQ0MTMz","avatar_url":"https://avatars.githubusercontent.com/u/11144133?v=4","gravatar_id":"","url":"https://api.github.com/users/doki23","html_url":"https://github.com/doki23","followers_url":"https://api.github.com/users/doki23/followers","following_url":"https://api.github.com/users/doki23/following{/other_user}","gists_url":"https://api.github.com/users/doki23/gists{/gist_id}","starred_url":"https://api.github.com/users/doki23/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/doki23/subscriptions","organizations_url":"https://api.github.com/users/doki23/orgs","repos_url":"https://api.github.com/users/doki23/repos","events_url":"https://api.github.com/users/doki23/events{/privacy}","received_events_url":"https://api.github.com/users/doki23/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T11:57:39Z","updated_at":"2023-03-11T11:59:22Z","author_association":"CONTRIBUTOR","body":"> so I think this is an expected result.\n\nIf it's an expected result, we'd better rename 'filter' to 'unpreciseFilter'(maybe) to avoid making developers confused. If not, just make filter intuitive.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464895527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464902336","html_url":"https://github.com/apache/iceberg/pull/4479#issuecomment-1464902336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4479","id":1464902336,"node_id":"IC_kwDOCW7NX85XUKLA","user":{"login":"cccs-jc","id":56140112,"node_id":"MDQ6VXNlcjU2MTQwMTEy","avatar_url":"https://avatars.githubusercontent.com/u/56140112?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-jc","html_url":"https://github.com/cccs-jc","followers_url":"https://api.github.com/users/cccs-jc/followers","following_url":"https://api.github.com/users/cccs-jc/following{/other_user}","gists_url":"https://api.github.com/users/cccs-jc/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-jc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-jc/subscriptions","organizations_url":"https://api.github.com/users/cccs-jc/orgs","repos_url":"https://api.github.com/users/cccs-jc/repos","events_url":"https://api.github.com/users/cccs-jc/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-jc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T12:32:41Z","updated_at":"2023-03-11T12:32:41Z","author_association":"CONTRIBUTOR","body":"@singhpk234 it's looking good. Just a few more small changes are suggested. Do you think you'll have time to address them next week. Cheers","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464902336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464952124","html_url":"https://github.com/apache/iceberg/issues/7022#issuecomment-1464952124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7022","id":1464952124,"node_id":"IC_kwDOCW7NX85XUWU8","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T16:55:29Z","updated_at":"2023-03-11T16:59:28Z","author_association":"CONTRIBUTOR","body":"Just looked at the `TestFlinkScan` class. it only has coverage for filtering on partition column. I don't have the full history on the the residual filter behavior. I do agree the current behavior is a bit confusing to the users.\r\n\r\nWondering what's the behavior in the Spark side?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464952124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464953716","html_url":"https://github.com/apache/iceberg/issues/7022#issuecomment-1464953716","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7022","id":1464953716,"node_id":"IC_kwDOCW7NX85XUWt0","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T17:03:20Z","updated_at":"2023-03-11T17:03:53Z","author_association":"CONTRIBUTOR","body":"> so we'd better add a flink filter operator after source scan \r\n\r\n@doki23 that would requires users to add it explicitly, which is also unintuitive for users that filters have to be provided in two different places. E.g. for FLIP-27 source.\r\n\r\n```\r\n    IcebergSource.Builder<RowData> sourceBuilder =\r\n        IcebergSource.forRowData()\r\n            .tableLoader(tableLoader())\r\n            .table(table)\r\n            .assignerFactory(new SimpleSplitAssignerFactory())\r\n            .flinkConfig(config);\r\n    sourceBuilder.filters(filters);  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<\r\n    sourceBuilder.properties(options);\r\n\r\n    DataStream<Row> stream =\r\n        env.fromSource(\r\n                sourceBuilder.build(),\r\n                WatermarkStrategy.noWatermarks(),\r\n                \"testBasicRead\",\r\n                TypeInformation.of(RowData.class))\r\n            .filter(<some Flink filter function>); <<<<<<<<<<<<<<<<<<<<<<<<<<\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464953716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464994270","html_url":"https://github.com/apache/iceberg/issues/7075#issuecomment-1464994270","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7075","id":1464994270,"node_id":"IC_kwDOCW7NX85XUgne","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T19:35:14Z","updated_at":"2023-03-11T19:35:14Z","author_association":"CONTRIBUTOR","body":"I don't think we need to create a new snapshot for every metadata operation, but I think it would be reasonable to create empty snapshots when we need to create a branch and there is no current snapshot. And I also think it would be reasonable to create a snapshot when the schema changes to signal when in history that happened.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464994270/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464996309","html_url":"https://github.com/apache/iceberg/pull/7050#issuecomment-1464996309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7050","id":1464996309,"node_id":"IC_kwDOCW7NX85XUhHV","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T19:42:39Z","updated_at":"2023-03-11T19:42:39Z","author_association":"CONTRIBUTOR","body":"I'll take a look on Monday.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464996309/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464999508","html_url":"https://github.com/apache/iceberg/issues/7022#issuecomment-1464999508","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7022","id":1464999508,"node_id":"IC_kwDOCW7NX85XUh5U","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T19:54:58Z","updated_at":"2023-03-11T19:54:58Z","author_association":"CONTRIBUTOR","body":"For other engines, the source also filters down to a row level, instead of a row group level as it is now.\r\n\r\nI think we need to do a few things:\r\n\r\n- When projecting the schema that's being passed down to the parquet reader, make sure that the fields that that's being filtered on, are being read.\r\n- Read as we do now, which will do the partition pruning, metrics evaluation, and row group filtering.\r\n- Filter using Flink since it is probably heavily optimized (and we don't want to reinvite the wheel here).\r\n- Do a final projection to the requested schema that will exclude the fields that are part of the filter, but not part of the selected columns.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1464999508/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465015904","html_url":"https://github.com/apache/iceberg/pull/2639#issuecomment-1465015904","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2639","id":1465015904,"node_id":"IC_kwDOCW7NX85XUl5g","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-03-11T20:55:44Z","updated_at":"2023-03-11T20:55:44Z","author_association":"CONTRIBUTOR","body":"@ggershinsky, this is looking good, but there are a few minor updates needed and it requires more testing to exercise more of the Iceberg specific code. You can check out code coverage to see when you're hitting all the areas you've changed.\r\n\r\nAlso, for the change to remove reflection, here's a diff since I explored that locally:\r\n\r\n```diff\r\n[blue@work iceberg]$ git diff\r\ndiff --git a/parquet/src/main/java/org/apache/iceberg/parquet/ParquetWriter.java b/parquet/src/main/java/org/apache/iceberg/parquet/ParquetWriter.java\r\nindex af2fb0e80a..ee3a8f50be 100644\r\n--- a/parquet/src/main/java/org/apache/iceberg/parquet/ParquetWriter.java\r\n+++ b/parquet/src/main/java/org/apache/iceberg/parquet/ParquetWriter.java\r\n@@ -28,20 +28,16 @@ import org.apache.hadoop.conf.Configuration;\r\n import org.apache.iceberg.Metrics;\r\n import org.apache.iceberg.MetricsConfig;\r\n import org.apache.iceberg.Schema;\r\n-import org.apache.iceberg.common.DynConstructors;\r\n-import org.apache.iceberg.common.DynMethods;\r\n import org.apache.iceberg.io.FileAppender;\r\n import org.apache.iceberg.io.OutputFile;\r\n import org.apache.iceberg.relocated.com.google.common.base.Preconditions;\r\n import org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap;\r\n-import org.apache.parquet.bytes.ByteBufferAllocator;\r\n import org.apache.parquet.column.ColumnWriteStore;\r\n import org.apache.parquet.column.ParquetProperties;\r\n-import org.apache.parquet.column.page.PageWriteStore;\r\n-import org.apache.parquet.column.values.bloomfilter.BloomFilterWriteStore;\r\n import org.apache.parquet.crypto.FileEncryptionProperties;\r\n import org.apache.parquet.crypto.InternalFileEncryptor;\r\n import org.apache.parquet.hadoop.CodecFactory;\r\n+import org.apache.parquet.hadoop.ColumnChunkPageWriteStore;\r\n import org.apache.parquet.hadoop.ParquetFileWriter;\r\n import org.apache.parquet.hadoop.metadata.CompressionCodecName;\r\n import org.apache.parquet.schema.MessageType;\r\n@@ -50,25 +46,6 @@ class ParquetWriter<T> implements FileAppender<T>, Closeable {\r\n \r\n   private static final Metrics EMPTY_METRICS = new Metrics(0L, null, null, null, null);\r\n \r\n-  private static final DynConstructors.Ctor<PageWriteStore> pageStoreCtorParquet =\r\n-      DynConstructors.builder(PageWriteStore.class)\r\n-          .hiddenImpl(\r\n-              \"org.apache.parquet.hadoop.ColumnChunkPageWriteStore\",\r\n-              CodecFactory.BytesCompressor.class,\r\n-              MessageType.class,\r\n-              ByteBufferAllocator.class,\r\n-              int.class,\r\n-              boolean.class,\r\n-              InternalFileEncryptor.class,\r\n-              int.class)\r\n-          .build();\r\n-\r\n-  private static final DynMethods.UnboundMethod flushToWriter =\r\n-      DynMethods.builder(\"flushToFileWriter\")\r\n-          .hiddenImpl(\r\n-              \"org.apache.parquet.hadoop.ColumnChunkPageWriteStore\", ParquetFileWriter.class)\r\n-          .build();\r\n-\r\n   private final long targetRowGroupSize;\r\n   private final Map<String, String> metadata;\r\n   private final ParquetProperties props;\r\n@@ -81,7 +58,7 @@ class ParquetWriter<T> implements FileAppender<T>, Closeable {\r\n   private final OutputFile output;\r\n   private final Configuration conf;\r\n \r\n-  private DynMethods.BoundMethod flushPageStoreToWriter;\r\n+  private ColumnChunkPageWriteStore pageStore = null;\r\n   private ColumnWriteStore writeStore;\r\n   private long recordCount = 0;\r\n   private long nextCheckRecordCount = 10;\r\n@@ -232,7 +209,7 @@ class ParquetWriter<T> implements FileAppender<T>, Closeable {\r\n         ensureWriterInitialized();\r\n         writer.startBlock(recordCount);\r\n         writeStore.flush();\r\n-        flushPageStoreToWriter.invoke(writer);\r\n+        pageStore.flushToFileWriter(writer);\r\n         writer.endBlock();\r\n         if (!finished) {\r\n           writeStore.close();\r\n@@ -253,8 +230,8 @@ class ParquetWriter<T> implements FileAppender<T>, Closeable {\r\n             props.getMaxRowCountForPageSizeCheck());\r\n     this.recordCount = 0;\r\n \r\n-    PageWriteStore pageStore =\r\n-        pageStoreCtorParquet.newInstance(\r\n+    this.pageStore =\r\n+        new ColumnChunkPageWriteStore(\r\n             compressor,\r\n             parquetSchema,\r\n             props.getAllocator(),\r\n@@ -264,9 +241,7 @@ class ParquetWriter<T> implements FileAppender<T>, Closeable {\r\n             rowGroupOrdinal);\r\n     this.rowGroupOrdinal++;\r\n \r\n-    this.flushPageStoreToWriter = flushToWriter.bind(pageStore);\r\n-    this.writeStore =\r\n-        props.newColumnWriteStore(parquetSchema, pageStore, (BloomFilterWriteStore) pageStore);\r\n+    this.writeStore = props.newColumnWriteStore(parquetSchema, pageStore, pageStore);\r\n \r\n     model.setColumnStore(writeStore);\r\n   }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1465015904/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]