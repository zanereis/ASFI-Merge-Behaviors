[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370759594","html_url":"https://github.com/apache/couchdb/pull/1193#issuecomment-370759594","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1193","id":370759594,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDc1OTU5NA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T12:01:32Z","updated_at":"2018-03-06T12:01:32Z","author_association":"MEMBER","body":"*bump*","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370759594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370772551","html_url":"https://github.com/apache/couchdb/pull/1165#issuecomment-370772551","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1165","id":370772551,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDc3MjU1MQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T12:55:42Z","updated_at":"2018-03-06T12:55:42Z","author_association":"MEMBER","body":"Thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370772551/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370775511","html_url":"https://github.com/apache/couchdb/pull/1164#issuecomment-370775511","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1164","id":370775511,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDc3NTUxMQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T13:07:43Z","updated_at":"2018-03-06T13:07:43Z","author_association":"MEMBER","body":"-1.\r\n\r\nWe assert that we get the `ok` we expect. If we don't, we want the process to crash, which it does.\r\n\r\nAdding error handling code for errors we don't intend to handle (in the sync case, you immediately throw it anyway) is an anti-pattern in erlang, though common (or mandatory) in other languages.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370775511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370775651","html_url":"https://github.com/apache/couchdb/pull/1164#issuecomment-370775651","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1164","id":370775651,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDc3NTY1MQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T13:08:17Z","updated_at":"2018-03-06T13:08:17Z","author_association":"MEMBER","body":"@davisp if you would like to comment on the init portions.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370775651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370789361","html_url":"https://github.com/apache/couchdb/pull/1200#issuecomment-370789361","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1200","id":370789361,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDc4OTM2MQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T13:58:36Z","updated_at":"2018-03-06T13:58:36Z","author_association":"MEMBER","body":"@elistevens thanks, this convinces me that `max_attachments_per_doc` is not a good idea and the proposed alternative is the way to go.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370789361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370790664","html_url":"https://github.com/apache/couchdb/pull/1186#issuecomment-370790664","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1186","id":370790664,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDc5MDY2NA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T14:02:49Z","updated_at":"2018-03-06T14:02:49Z","author_association":"CONTRIBUTOR","body":"Thanks Paul @davisp for your reply. I understand. For completeness, we need to consider downgrade when there is purge request between pre-CP and CP. However, only with CP build, the clustered purge API is available. Before that, there is less possibility to have purge request. So downgrade may not be effort we should focus on.\r\n\r\nRegarding the second point \"unused/idle indexes after upgrade\", as you know, we have two methods to trigger init/update of secondary index, search index and geo index.\r\n- issue search request and trigger update of index\r\n- use `ken` or similar approach to automatically trigger init/update of index\r\n\r\nIf there is unused/idle index, what about leveraging `ken` or similar approach to trigger index o run an initial step? Thus, if there is update on database document, ken will trigger init/update of index, thus the local purge document will be created so that purge requests will not be compacted before a index see them.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370790664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370807541","html_url":"https://github.com/apache/couchdb/pull/1164#issuecomment-370807541","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1164","id":370807541,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDgwNzU0MQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T14:55:35Z","updated_at":"2018-03-06T14:55:35Z","author_association":"MEMBER","body":"@rnewson yes and no. The issue is where we want that badmatch to happen and with what as the badmatch. For the init section this is a good change as it matches the initial open. What's being added is the handling when the second of two fails to behave the same as the first. This is fine as we already handle the error. And it cleans up logs a bit in that the emfile error happens in the process doing the open rather than a EXIT/DOWN message when the couch_file pid dies on a badmatch.\r\n\r\nAs for the init process this just reuses the existing logic which seems cleaner than going back and rewriting it to use proc_lib properly.\r\n\r\n+1 after style issues are addressed","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370807541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370813319","html_url":"https://github.com/apache/couchdb/pull/1164#issuecomment-370813319","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1164","id":370813319,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDgxMzMxOQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T15:12:55Z","updated_at":"2018-03-06T15:12:55Z","author_association":"MEMBER","body":"if @davisp is happy, I'm happy.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370813319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370846612","html_url":"https://github.com/apache/couchdb/issues/1204#issuecomment-370846612","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1204","id":370846612,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDg0NjYxMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T16:46:11Z","updated_at":"2018-03-06T16:46:11Z","author_association":"MEMBER","body":"This is a backwards-compatibility breaking change and can not be introduced easily. The earliest such a change can be considered is 3.0.0.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370846612/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370848322","html_url":"https://github.com/apache/couchdb/issues/1204#issuecomment-370848322","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1204","id":370848322,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDg0ODMyMg==","user":{"login":"alxndrsn","id":191496,"node_id":"MDQ6VXNlcjE5MTQ5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/191496?v=4","gravatar_id":"","url":"https://api.github.com/users/alxndrsn","html_url":"https://github.com/alxndrsn","followers_url":"https://api.github.com/users/alxndrsn/followers","following_url":"https://api.github.com/users/alxndrsn/following{/other_user}","gists_url":"https://api.github.com/users/alxndrsn/gists{/gist_id}","starred_url":"https://api.github.com/users/alxndrsn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alxndrsn/subscriptions","organizations_url":"https://api.github.com/users/alxndrsn/orgs","repos_url":"https://api.github.com/users/alxndrsn/repos","events_url":"https://api.github.com/users/alxndrsn/events{/privacy}","received_events_url":"https://api.github.com/users/alxndrsn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T16:50:56Z","updated_at":"2018-03-06T16:50:56Z","author_association":"CONTRIBUTOR","body":"@wohali Any opinion on the documentation update suggestions?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370848322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370851376","html_url":"https://github.com/apache/couchdb/issues/1097#issuecomment-370851376","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1097","id":370851376,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDg1MTM3Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T16:59:39Z","updated_at":"2018-03-06T16:59:39Z","author_association":"MEMBER","body":"OK. Adding to the 2.2.0 milestone as well.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370851376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370855065","html_url":"https://github.com/apache/couchdb/issues/1204#issuecomment-370855065","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1204","id":370855065,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDg1NTA2NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T17:10:35Z","updated_at":"2018-03-06T17:10:35Z","author_association":"MEMBER","body":"I would say it's better to mention this in the gentle intro to views [here](http://docs.couchdb.org/en/latest/ddocs/views/intro.html). If I had to guess at a reason, it might be because views are CouchDB's implementation of MapReduce, which suggests if both are defined, you want both.\r\n\r\nI don't think it warrants a call-out box in the API reference section, we already say:\r\n\r\n> reduce (boolean) – Use the reduction function. Default is true when a reduce function is defined.\r\n\r\nWith the increasing focus on Mango (and reduce coming soon to Mango) it might be best to ensure the user interface for Mango does something friendly and compatible here. /cc @tonysun83 @nickva ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370855065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370856675","html_url":"https://github.com/apache/couchdb/issues/1204#issuecomment-370856675","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1204","id":370856675,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDg1NjY3NQ==","user":{"login":"alxndrsn","id":191496,"node_id":"MDQ6VXNlcjE5MTQ5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/191496?v=4","gravatar_id":"","url":"https://api.github.com/users/alxndrsn","html_url":"https://github.com/alxndrsn","followers_url":"https://api.github.com/users/alxndrsn/followers","following_url":"https://api.github.com/users/alxndrsn/following{/other_user}","gists_url":"https://api.github.com/users/alxndrsn/gists{/gist_id}","starred_url":"https://api.github.com/users/alxndrsn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alxndrsn/subscriptions","organizations_url":"https://api.github.com/users/alxndrsn/orgs","repos_url":"https://api.github.com/users/alxndrsn/repos","events_url":"https://api.github.com/users/alxndrsn/events{/privacy}","received_events_url":"https://api.github.com/users/alxndrsn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T17:15:14Z","updated_at":"2018-03-06T17:15:14Z","author_association":"CONTRIBUTOR","body":"> reduce (boolean) – Use the reduction function. Default is true when a reduce function is defined.\r\n\r\nThis isn't quite what I see at http://docs.couchdb.org/en/2.1.1/api/ddoc/views.html - definitely an improvement.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370856675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370904610","html_url":"https://github.com/apache/couchdb/issues/1204#issuecomment-370904610","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1204","id":370904610,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDkwNDYxMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T19:46:48Z","updated_at":"2018-03-06T19:46:48Z","author_association":"MEMBER","body":"Compare with http://docs.couchdb.org/en/latest/api/ddoc/views.html\r\n\r\nLooks like @flimzy is ahead of you: https://github.com/apache/couchdb-documentation/commit/bdfa864b3a6d449f0f7e382628c2ab8350679d13\r\n\r\nI'll leave this open as an enhancement request, and edit the title to match.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370904610/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370928857","html_url":"https://github.com/apache/couchdb/pull/1139#issuecomment-370928857","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1139","id":370928857,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDkyODg1Nw==","user":{"login":"jjrodrig","id":1001724,"node_id":"MDQ6VXNlcjEwMDE3MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1001724?v=4","gravatar_id":"","url":"https://api.github.com/users/jjrodrig","html_url":"https://github.com/jjrodrig","followers_url":"https://api.github.com/users/jjrodrig/followers","following_url":"https://api.github.com/users/jjrodrig/following{/other_user}","gists_url":"https://api.github.com/users/jjrodrig/gists{/gist_id}","starred_url":"https://api.github.com/users/jjrodrig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jjrodrig/subscriptions","organizations_url":"https://api.github.com/users/jjrodrig/orgs","repos_url":"https://api.github.com/users/jjrodrig/repos","events_url":"https://api.github.com/users/jjrodrig/events{/privacy}","received_events_url":"https://api.github.com/users/jjrodrig/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T21:08:47Z","updated_at":"2018-03-06T21:08:47Z","author_association":"CONTRIBUTOR","body":"Thanks @kocolosk  for your comments.\r\n\r\nI see that the orphaned files question is a different issue. We are facing it as part of a cleanup process that we have implemented in our system. Databases are periodically transferred to a temporary database and then moved back to the work database. It is like a purging procedure that allows us to keep the databases small. During this process we are removing and creating databases and orphaned files are produced. **+1 for the orphaned files cleanup process enhancement.**\r\n\r\nRespect to the main issue of this PR, I think that the main problem is to respond with a `500 Error` when the operation has been accepted and the database is deleted on the nodes that have received the request. It is responding with an error but the database is deleted in the active nodes, and later on propagated to the rest of nodes once they are accessible. It seem to me that this behaviour is more akin to a `202 Accepted` result.\r\n\r\nThe idea of responding `200 Ok` in the case that the quorum is met is mainly to keep the API consistent with other operations where the quorum is considered but I see that this can have some drawbacks.\r\n\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370928857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370957348","html_url":"https://github.com/apache/couchdb/pull/1193#issuecomment-370957348","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1193","id":370957348,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDk1NzM0OA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-06T22:49:00Z","updated_at":"2018-03-06T22:49:00Z","author_association":"CONTRIBUTOR","body":"> Using chttpd:send_error/4 seems to be closer to the original intent? It's public func as well.\r\n\r\n`chttpd:send_error/4` doesn't support passing of stack trace. The stack trace is converted [here](https://github.com/apache/couchdb/blob/master/src/chttpd/src/chttpd.erl#L1003). There are no calls to `json_stack/1` from  `chttpd:send_error/4`. `chttpd:send_error/4` calls `chttpd:send_error/5` with `Stack = []`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/370957348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371124016","html_url":"https://github.com/apache/couchdb/issues/1207#issuecomment-371124016","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1207","id":371124016,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTEyNDAxNg==","user":{"login":"zinnen","id":9108609,"node_id":"MDQ6VXNlcjkxMDg2MDk=","avatar_url":"https://avatars.githubusercontent.com/u/9108609?v=4","gravatar_id":"","url":"https://api.github.com/users/zinnen","html_url":"https://github.com/zinnen","followers_url":"https://api.github.com/users/zinnen/followers","following_url":"https://api.github.com/users/zinnen/following{/other_user}","gists_url":"https://api.github.com/users/zinnen/gists{/gist_id}","starred_url":"https://api.github.com/users/zinnen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zinnen/subscriptions","organizations_url":"https://api.github.com/users/zinnen/orgs","repos_url":"https://api.github.com/users/zinnen/repos","events_url":"https://api.github.com/users/zinnen/events{/privacy}","received_events_url":"https://api.github.com/users/zinnen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T12:31:39Z","updated_at":"2018-03-07T12:31:39Z","author_association":"NONE","body":"Hm, with a new instance on Amazon the installation works fine. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371124016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371152193","html_url":"https://github.com/apache/couchdb/issues/1204#issuecomment-371152193","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1204","id":371152193,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE1MjE5Mw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T14:18:51Z","updated_at":"2018-03-07T14:18:51Z","author_association":"MEMBER","body":"I understand why this is confusing, but I don’t see this changing going forward. We are happy to break BC for good reason, but this doesn’t warrant one IMHO.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371152193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371164510","html_url":"https://github.com/apache/couchdb/pull/1206#issuecomment-371164510","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1206","id":371164510,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE2NDUxMA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T14:56:31Z","updated_at":"2018-03-07T14:56:31Z","author_association":"CONTRIBUTOR","body":"Good find, @jaydoane!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371164510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371168926","html_url":"https://github.com/apache/couchdb/issues/1204#issuecomment-371168926","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1204","id":371168926,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE2ODkyNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:09:38Z","updated_at":"2018-03-07T15:09:38Z","author_association":"MEMBER","body":"Personally, I agree, and I expect most of the rest of the core developers would agree as well.\r\n\r\nWe can always re-open this; going to close for now as wontfix.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371168926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371176976","html_url":"https://github.com/apache/couchdb/issues/1097#issuecomment-371176976","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1097","id":371176976,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE3Njk3Ng==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:33:20Z","updated_at":"2018-03-07T15:33:20Z","author_association":"MEMBER","body":"The problem here is that Erlang’s disksup module doesn’t nicely play with all the special file systems that Linux seems to keep gaining (I lost track a while ago).\r\n\r\nThis time it is `/run/user/0` that fails to have an `{fs,ls}tat()` run on it and that bubbles up to the compaction daemon that has to loop through all mount points to match the one where `[couchdb] database_dir` is located, to check for available space to decide whether it is safe to compact.\r\n\r\nWe could try and start adding an exclusion list, but that will require maintenance. We could start and try be more clever handling `file:get_link_info()` errors, but that too seems error prone. This is a harmless warning too, maybe we can demote this to `debug` level?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371176976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371178322","html_url":"https://github.com/apache/couchdb/issues/1097#issuecomment-371178322","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1097","id":371178322,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE3ODMyMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:37:11Z","updated_at":"2018-03-07T15:37:11Z","author_association":"MEMBER","body":"If it doesn't block the compaction daemon from doing its thing, then absolutely, demotion makes the most sense.\r\n\r\nI'll take this one, look for a PR shortly.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371178322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371180210","html_url":"https://github.com/apache/couchdb/issues/1191#issuecomment-371180210","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1191","id":371180210,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE4MDIxMA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:42:48Z","updated_at":"2018-03-07T15:42:48Z","author_association":"MEMBER","body":"Heya @vielhuber, this is best added here: https://github.com/janl/couchdb-mac-app — a PR there is very welcome, too.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371180210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371181135","html_url":"https://github.com/apache/couchdb/issues/1202#issuecomment-371181135","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1202","id":371181135,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE4MTEzNQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:45:25Z","updated_at":"2018-03-07T15:45:25Z","author_association":"MEMBER","body":"In a case of “this isn’t really what you’re asking for”, I’d recommend to re-think the need for this.\r\n\r\n1. if you want to clean up a database that has lots of docs you want to get rid of, but do it only once, I’d recommend doing a filtered replication of the docs that you want to keep and then delete the old database.\r\n2. if you want to keep a “current” set of documents in the db, say delete everything older than 30/60/90 days, I’d recommend using a database per $interval.\r\n3. if you do need to do this regularly, preparing for CouchDB performance getting asymptotically worse. In this scenario, deleting in batches is the way to go.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371181135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371181159","html_url":"https://github.com/apache/couchdb/issues/1191#issuecomment-371181159","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1191","id":371181159,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE4MTE1OQ==","user":{"login":"vielhuber","id":3183737,"node_id":"MDQ6VXNlcjMxODM3Mzc=","avatar_url":"https://avatars.githubusercontent.com/u/3183737?v=4","gravatar_id":"","url":"https://api.github.com/users/vielhuber","html_url":"https://github.com/vielhuber","followers_url":"https://api.github.com/users/vielhuber/followers","following_url":"https://api.github.com/users/vielhuber/following{/other_user}","gists_url":"https://api.github.com/users/vielhuber/gists{/gist_id}","starred_url":"https://api.github.com/users/vielhuber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vielhuber/subscriptions","organizations_url":"https://api.github.com/users/vielhuber/orgs","repos_url":"https://api.github.com/users/vielhuber/repos","events_url":"https://api.github.com/users/vielhuber/events{/privacy}","received_events_url":"https://api.github.com/users/vielhuber/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:45:31Z","updated_at":"2018-03-07T15:45:31Z","author_association":"NONE","body":"Should I reopen this issue on the other repo?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371181159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371182672","html_url":"https://github.com/apache/couchdb/issues/1097#issuecomment-371182672","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1097","id":371182672,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE4MjY3Mg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:49:52Z","updated_at":"2018-03-07T15:49:52Z","author_association":"MEMBER","body":"sorry, misread the code a bit, we could change it so that the error isn’t fatally stopping the compaction daemon.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371182672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371183150","html_url":"https://github.com/apache/couchdb/pull/1208#issuecomment-371183150","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1208","id":371183150,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE4MzE1MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:51:10Z","updated_at":"2018-03-07T15:51:10Z","author_association":"MEMBER","body":"sorry I got this one wrong, this will fatally fail the compaction attempt: https://github.com/apache/couchdb/blob/master/src/couch/src/couch_compaction_daemon.erl#L523-L536","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371183150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371184222","html_url":"https://github.com/apache/couchdb/issues/1209#issuecomment-371184222","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1209","id":371184222,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE4NDIyMg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:54:22Z","updated_at":"2018-03-07T15:54:22Z","author_association":"MEMBER","body":"Are you setting your `revs_limit` to 10k as well? otherwise, creating 1000 revisions will suffice.\r\n\r\nAnd just to clarify, you’re talking about many updates to a doc, but not that many conflicts on the doc?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371184222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371185499","html_url":"https://github.com/apache/couchdb/pull/1208#issuecomment-371185499","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1208","id":371185499,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTE4NTQ5OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T15:58:05Z","updated_at":"2018-03-07T15:58:05Z","author_association":"MEMBER","body":"Abandoning this PR","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371185499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371250770","html_url":"https://github.com/apache/couchdb/issues/1097#issuecomment-371250770","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1097","id":371250770,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTI1MDc3MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-07T19:12:57Z","updated_at":"2018-03-07T19:12:57Z","author_association":"MEMBER","body":"It'd be much better if we could simply check the free space for the volume on which the shard resides, rather than scanning all volumes for free space first. I did a bunch of research when it became clear to me this isn't an easy problem to solve.\r\n\r\nReminder: [we've been here before](https://github.com/apache/couchdb/issues/732), which is when we [introduced this warning](https://github.com/apache/couchdb/pull/803).\r\n\r\nFirst stop: python, since I feel they have excellent cross-platform support for this kind of thing. A simplified [code excerpt of finding the mount point for a given file's path](https://stackoverflow.com/questions/4453602/how-to-find-the-mountpoint-a-file-resides-on):\r\n\r\n```\r\ndef find_mount_point(path):\r\n    path = os.path.abspath(path) # or os.path.realpath()\r\n    while not os.path.ismount(path):\r\n        path = os.path.dirname(path)\r\n    return path\r\n```\r\n\r\nErlang has `filename:absname/1` and `filename:dirname/1`, but it doesn't have an `os.path.ismount` equivalent, so I dug into how Python implements this. Of course, there are different implementations for [POSIX](https://github.com/python/cpython/blob/3460198f6ba40a839f105c381f07179aba1e8c61/Lib/posixpath.py#L187-L220), [Mac](https://github.com/python/cpython/blob/3460198f6ba40a839f105c381f07179aba1e8c61/Lib/macpath.py#L118-L122) and [Windows](https://github.com/python/cpython/blob/3460198f6ba40a839f105c381f07179aba1e8c61/Lib/ntpath.py#L246-L275), with the Windows implementation requiring [a call out to a Win32 function](https://github.com/python/cpython/blob/6921e73e33edc3c61bc2d78ed558eaa22a89a564/Modules/posixmodule.c#L3830-L3877) because Windows treats local drives, UNC paths, network-mounted drives and junction points (symlinks) all differently.\r\n\r\nWe also need to be mindful of the difference between `abspath` and `realpath`, i.e. when a relative path symlink is a parent directory; ascending up the tree can lead to misleading results if a true absolute path isn't determined in the process. `filename;absname/1` doesn't attempt to deal with this problem. Amusingly, [mochiweb has solved this particular problem](https://github.com/mochi/mochiweb/blob/b7f3693a9008de6d31a67174f7184fe24093a1b4/src/mochiweb_util.erl#L72).\r\n\r\nFor comparison, I checked JS/node/npm, and found [diskusage](https://www.npmjs.com/package/diskusage) which appears to be the most popular solution to this problem. It, too, calls out to a Win32 API endpoint on Windows and relies on `statvfs` for POSIX.  (It's not clear that this module's Win32 implementation actually handles all the different possibilities that the Python implementation does, incidentally.)\r\n\r\n**Option 1**: implement all of the above. The Windows NIF is ugly, but there are other reasons we might want to go down the path of a Windows-only util NIF anyway. I can help here if this is desired.\r\n\r\nNext stop, rabbitmq, as a fairly mature Erlang server-thing that definitely does disk space checking. They use a much lower tech alternative, namely, [shelling out and running cli commands to check free space for a given path](https://github.com/rabbitmq/rabbitmq-server/blob/master/src/rabbit_disk_monitor.erl#L211-L237). Unfortunately, this is problematic, too: there have been [a](https://stackoverflow.com/questions/17148510/rabbitmq-strange-disk-free#17944684) [few](https://groups.google.com/forum/#!topic/rabbitmq-users/LLnyb_MXa6Q) bugs and [multiple](https://github.com/rabbitmq/rabbitmq-server/commit/43fe62ef15465ad01c73dd7f591c7659b5d2d307) [fixes](https://github.com/rabbitmq/rabbitmq-server/commit/4eaa46ef0ea1e1777c86a5ddc93e0cf447a3f448) [required](https://github.com/rabbitmq/rabbitmq-server/commit/186c32700b52de68cb3ba71e445844d236519603). A comment is made in the that StackOverflow link that this parsing is fragile, and could easily be broken by locale-specific changes, too; `df -kP` guarantees POSIX-compatible output, but there's no guarantee we'll get any sort of consistent report out of Windows without switching to [a PowerShell implementation](https://stackoverflow.com/questions/12159341/how-to-get-disk-capacity-and-free-space-of-remote-computer#12159479) or the aforementioned Win32 API call.\r\n\r\n**Option 2**: Use the rabbitmq approach and shell out to the system rather than parsing paths and calling `disksup:get_disk_data/0` once we find a mount point we can use to match against Erlang's gathered stats. This feels easier (no NIF!), but the devil's in the details, and technically speaking, rabbitmq's implementation is [MPL](https://github.com/rabbitmq/rabbitmq-server/blob/master/LICENSE), which is a [\"Category B\" weak-copyleft license](https://www.apache.org/legal/resolved.html#category-b). We could probably write to the rabbitmq people and get them to waive the MPL on this particular part of code, or we could white-box our own implementation.\r\n\r\n**Option 3**: Blacklist a bunch of paths that we know are bad: `/proc`, `/run`, `/dev`. I hesitate to say all `tmpfs` volume types on Linux, because running Couch out of a `tmpfs` volume as an all-in-memory CouchDB (prior to PSE landing) isn't unreasonable. That said, if the `*stat*` calls fail on a `tmpfs` volume, we still need to recover gracefully. @janl and I don't like this because it's yet another weird thing to maintain with magic values.\r\n\r\n**Option 4**: Do the least possible. Stay with the current approach and just don't crash out when we can't stat a particular volume. If we can't actually get the free space for the guessed mount point for the current volume, punt per #803 and try our best anyway, free space or no. We'll probably end up with more bugs like this in the future if we do this, but it'll let us close out this bug quickly ;)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371250770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371367728","html_url":"https://github.com/apache/couchdb/pull/1210#issuecomment-371367728","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1210","id":371367728,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTM2NzcyOA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-08T03:33:27Z","updated_at":"2018-03-08T03:33:27Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371367728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371523726","html_url":"https://github.com/apache/couchdb/pull/1160#issuecomment-371523726","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1160","id":371523726,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTUyMzcyNg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-08T15:35:40Z","updated_at":"2018-03-08T15:35:40Z","author_association":"MEMBER","body":"I screwed up the branch here trying to resolve rebase conflicts, apologies. I’ll open a new one with a squashed commit.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371523726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371548431","html_url":"https://github.com/apache/couchdb/issues/1097#issuecomment-371548431","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1097","id":371548431,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTU0ODQzMQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-08T16:50:54Z","updated_at":"2018-03-08T16:50:54Z","author_association":"MEMBER","body":"I’d say we go for 4 now with the variant that we still fail if we can’t get the free space for the `database_dir` volume. And keep Options 1/2 for later.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371548431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371548462","html_url":"https://github.com/apache/couchdb/issues/1097#issuecomment-371548462","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1097","id":371548462,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTU0ODQ2Mg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-08T16:51:01Z","updated_at":"2018-03-08T16:51:01Z","author_association":"MEMBER","body":"forgot to say: outstanding analysis\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371548462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371719159","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-371719159","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":371719159,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTcxOTE1OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T05:41:11Z","updated_at":"2018-03-09T05:41:11Z","author_association":"MEMBER","body":"Hm, I can't confirm this - I just installed on a fresh Debian 8 install from the 2.1.1 packages and everything was fine.\r\n\r\nHave you done anything unusual to your Debian 8 (jessie) installation?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371719159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371746112","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-371746112","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":371746112,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTc0NjExMg==","user":{"login":"Crispy1975","id":12525875,"node_id":"MDQ6VXNlcjEyNTI1ODc1","avatar_url":"https://avatars.githubusercontent.com/u/12525875?v=4","gravatar_id":"","url":"https://api.github.com/users/Crispy1975","html_url":"https://github.com/Crispy1975","followers_url":"https://api.github.com/users/Crispy1975/followers","following_url":"https://api.github.com/users/Crispy1975/following{/other_user}","gists_url":"https://api.github.com/users/Crispy1975/gists{/gist_id}","starred_url":"https://api.github.com/users/Crispy1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Crispy1975/subscriptions","organizations_url":"https://api.github.com/users/Crispy1975/orgs","repos_url":"https://api.github.com/users/Crispy1975/repos","events_url":"https://api.github.com/users/Crispy1975/events{/privacy}","received_events_url":"https://api.github.com/users/Crispy1975/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T08:27:13Z","updated_at":"2018-03-09T08:27:13Z","author_association":"NONE","body":"Nothing, it's a relatively fresh install. I will try it in a clean VM and see if I get the same issue and report back.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371746112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371778960","html_url":"https://github.com/apache/couchdb/pull/1215#issuecomment-371778960","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1215","id":371778960,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTc3ODk2MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T10:46:25Z","updated_at":"2018-03-09T10:46:25Z","author_association":"MEMBER","body":"nice one.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371778960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371779119","html_url":"https://github.com/apache/couchdb/pull/1213#issuecomment-371779119","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1213","id":371779119,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTc3OTExOQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T10:47:10Z","updated_at":"2018-03-09T10:47:10Z","author_association":"MEMBER","body":"not sure I follow what this does","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371779119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371840633","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-371840633","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":371840633,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTg0MDYzMw==","user":{"login":"Crispy1975","id":12525875,"node_id":"MDQ6VXNlcjEyNTI1ODc1","avatar_url":"https://avatars.githubusercontent.com/u/12525875?v=4","gravatar_id":"","url":"https://api.github.com/users/Crispy1975","html_url":"https://github.com/Crispy1975","followers_url":"https://api.github.com/users/Crispy1975/followers","following_url":"https://api.github.com/users/Crispy1975/following{/other_user}","gists_url":"https://api.github.com/users/Crispy1975/gists{/gist_id}","starred_url":"https://api.github.com/users/Crispy1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Crispy1975/subscriptions","organizations_url":"https://api.github.com/users/Crispy1975/orgs","repos_url":"https://api.github.com/users/Crispy1975/repos","events_url":"https://api.github.com/users/Crispy1975/events{/privacy}","received_events_url":"https://api.github.com/users/Crispy1975/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T15:14:06Z","updated_at":"2018-03-09T15:14:25Z","author_association":"NONE","body":"@wohali a fresh VM and a fresh install worked fine. So the next step I can see is to compare the libraries in use between the two systems with `ldd`, and if there are differences adjust the failing system to match the fresh VM, I will post my findings back here as perhaps it will help others.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371840633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371860852","html_url":"https://github.com/apache/couchdb/pull/1213#issuecomment-371860852","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1213","id":371860852,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTg2MDg1Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T16:20:12Z","updated_at":"2018-03-09T16:20:12Z","author_association":"CONTRIBUTOR","body":"@janl it's for @davisp's tracing branch, not ready for merge yet. \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371860852/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371862065","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-371862065","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":371862065,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTg2MjA2NQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T16:24:15Z","updated_at":"2018-03-09T16:24:15Z","author_association":"MEMBER","body":"Hi @AlexanderKaraberov,\r\n\r\nthis is pretty cool. Before I do a more thorough review, I’m wondering why you didn’t opt to re-use `couch_doc:doc_to_multi_part_stream()` / `couch_httpd_db:encode_multipart_stream()` for the multipart streaming?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371862065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371862519","html_url":"https://github.com/apache/couchdb/issues/1163#issuecomment-371862519","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1163","id":371862519,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTg2MjUxOQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T16:25:47Z","updated_at":"2018-03-09T16:25:47Z","author_association":"MEMBER","body":"hi @cwmichi can you give us a bit more info about your setup, data architecture, usage patterns etc. and under which conditions these error messages occur?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371862519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371872009","html_url":"https://github.com/apache/couchdb/pull/1213#issuecomment-371872009","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1213","id":371872009,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTg3MjAwOQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T16:54:58Z","updated_at":"2018-03-09T16:54:58Z","author_association":"MEMBER","body":"Or mebbe merge ever. I mostly just posted the code as a reference for devs wanting to play around with tracing a bit.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371872009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371879574","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-371879574","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":371879574,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTg3OTU3NA==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T17:17:10Z","updated_at":"2018-03-12T09:49:40Z","author_association":"CONTRIBUTOR","body":"Hi @janl , thanks for a good question. \r\nLong story short: I tried to re-use `couch_doc:doc_to_multi_part_stream()` but it didn’t work out for me, because content headers wasn’t encoded properly. Hence I decided to write a custom function instead of modifying/breaking existing functionality. Now I understand that this happened for the reason  that I didn’t use (didn’t know about) `couch_httpd_db:encode_multipart_stream()` existence. Function name looks like exactly what I needed at that point of time. If you don’t mind I can try to reimplement this functionality using suggested function and test whether this will work with Sync Gateway. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371879574/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371882815","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-371882815","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":371882815,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTg4MjgxNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T17:28:34Z","updated_at":"2018-03-09T17:28:34Z","author_association":"MEMBER","body":"I'll be happy to help you review this ticket further, but since it's not a CouchDB bug, I'm closing it out now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371882815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371891262","html_url":"https://github.com/apache/couchdb/issues/1008#issuecomment-371891262","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1008","id":371891262,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTg5MTI2Mg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T17:52:48Z","updated_at":"2018-03-09T17:52:48Z","author_association":"MEMBER","body":"Anyone have a way to duplicate this? The view engine changed between 1.6 and 2.x but the way Erlang functions are invoked shouldn't be any different so that's a bit odd. I'd also be interested in which version of Erlang is used as well.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371891262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371894957","html_url":"https://github.com/apache/couchdb/issues/1008#issuecomment-371894957","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1008","id":371894957,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTg5NDk1Nw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T18:03:33Z","updated_at":"2018-03-09T18:03:33Z","author_association":"MEMBER","body":"@davisp see https://github.com/apache/couchdb/issues/1142 for more context\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371894957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371904385","html_url":"https://github.com/apache/couchdb/issues/1142#issuecomment-371904385","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1142","id":371904385,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTkwNDM4NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T18:30:34Z","updated_at":"2018-03-09T18:30:34Z","author_association":"MEMBER","body":"First guess is that you're mixing up the rexi message handling. The rexi_util:recv function isn't written to handle multiple nested calls and will end up chewing through and mixing up messages from RPC workers. A quick test is to use something of this nature to replace you fabric:query_view call:\r\n\r\n```erlang\r\ndo_query(DbName, VName, QArgs) ->\r\n    {_, Ref} = spawn_monitor(fun() ->\r\n        try\r\n            Resp = fabric:query_view(<<\"db1\">>, DName, VName, QArgs)\r\n            exit({xkcd_ok, Resp})\r\n        catch T:R ->\r\n            S = erlang:get_stacktrace(),\r\n            exit({xkcd_error, T, R, S})\r\n    end),\r\n    receive\r\n        {'DOWN', Ref, _, _, {xkcd_ok, Resp}} ->\r\n            Resp\r\n        {'DOWN', Ref, _, _, {xkcd_error, T, R, S}} ->\r\n            erlang:raise(T, R, S)\r\n    end.\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371904385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371904676","html_url":"https://github.com/apache/couchdb/issues/1008#issuecomment-371904676","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1008","id":371904676,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTkwNDY3Ng==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T18:31:25Z","updated_at":"2018-03-09T18:31:25Z","author_association":"MEMBER","body":"Aha, updated their but also this seems like two different errors to me.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371904676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371904860","html_url":"https://github.com/apache/couchdb/pull/1217#issuecomment-371904860","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1217","id":371904860,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTkwNDg2MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T18:32:03Z","updated_at":"2018-03-09T18:32:03Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371904860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371908513","html_url":"https://github.com/apache/couchdb/issues/820#issuecomment-371908513","issue_url":"https://api.github.com/repos/apache/couchdb/issues/820","id":371908513,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTkwODUxMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T18:44:14Z","updated_at":"2018-03-09T18:44:14Z","author_association":"MEMBER","body":"@jiangphcn @ricellis @rnewson @iilyak Can we get this re-merged in please?\r\n\r\nI have a +1 for using a `/_queries` endpoint but am fine with the previous proposal if that's where we're going.\r\n\r\n2.2.0 approaches and I'd like this set of features to be in there. And +1 for @rnewson 's comment about adding this for `_view` and leaving the old endpoint for backward compatibility.\r\n\r\n@jiangphcn also can you please revisit your open PRs on apache/couchdb-documentation, and update as necessary? Thank you!\r\n\r\n/cc @janl asking before I add this to the 2.2.0 milestone. We have the code, we just need to agree on the endpoints involved.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371908513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371955218","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-371955218","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":371955218,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTk1NTIxOA==","user":{"login":"Crispy1975","id":12525875,"node_id":"MDQ6VXNlcjEyNTI1ODc1","avatar_url":"https://avatars.githubusercontent.com/u/12525875?v=4","gravatar_id":"","url":"https://api.github.com/users/Crispy1975","html_url":"https://github.com/Crispy1975","followers_url":"https://api.github.com/users/Crispy1975/followers","following_url":"https://api.github.com/users/Crispy1975/following{/other_user}","gists_url":"https://api.github.com/users/Crispy1975/gists{/gist_id}","starred_url":"https://api.github.com/users/Crispy1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Crispy1975/subscriptions","organizations_url":"https://api.github.com/users/Crispy1975/orgs","repos_url":"https://api.github.com/users/Crispy1975/repos","events_url":"https://api.github.com/users/Crispy1975/events{/privacy}","received_events_url":"https://api.github.com/users/Crispy1975/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-09T21:50:32Z","updated_at":"2018-03-09T21:50:32Z","author_association":"NONE","body":"Well `ldd` reports identical libraries - versions and all - in the VM for the `couchjs` binary. So that does not seem to be the issue... running out of ideas as to what the issue might actually be.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/371955218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372002552","html_url":"https://github.com/apache/couchdb/issues/820#issuecomment-372002552","issue_url":"https://api.github.com/repos/apache/couchdb/issues/820","id":372002552,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjAwMjU1Mg==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-10T04:46:56Z","updated_at":"2018-03-10T04:46:56Z","author_association":"CONTRIBUTOR","body":"@wohali Hey Joan,  I am fine to re-merge the codes in PR https://github.com/apache/couchdb/pull/1032. Let us wait for next Monday to let everybody to check and raise concern if have. Otherwise, I can merge it next Tuesday (GMT+8). \r\n\r\nAlso, thanks for your reminder. Furthermore, I will re-visit my documentation PRs for endpoint related code changes. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372002552/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372015750","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-372015750","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":372015750,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjAxNTc1MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-10T09:14:16Z","updated_at":"2018-03-10T09:14:16Z","author_association":"MEMBER","body":"Yeah, I really don't feel comfortable having two multipart implementations in CouchDB. We already don't like the one we have. ;)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372015750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372024493","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-372024493","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":372024493,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjAyNDQ5Mw==","user":{"login":"Crispy1975","id":12525875,"node_id":"MDQ6VXNlcjEyNTI1ODc1","avatar_url":"https://avatars.githubusercontent.com/u/12525875?v=4","gravatar_id":"","url":"https://api.github.com/users/Crispy1975","html_url":"https://github.com/Crispy1975","followers_url":"https://api.github.com/users/Crispy1975/followers","following_url":"https://api.github.com/users/Crispy1975/following{/other_user}","gists_url":"https://api.github.com/users/Crispy1975/gists{/gist_id}","starred_url":"https://api.github.com/users/Crispy1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Crispy1975/subscriptions","organizations_url":"https://api.github.com/users/Crispy1975/orgs","repos_url":"https://api.github.com/users/Crispy1975/repos","events_url":"https://api.github.com/users/Crispy1975/events{/privacy}","received_events_url":"https://api.github.com/users/Crispy1975/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-10T11:59:05Z","updated_at":"2018-03-10T11:59:05Z","author_association":"NONE","body":"@wohali Ok, have done some more testing, this time I decided to skip the `apt` repos and go for the Docker image from `apache/couchdb:latest` (2.1.1 and using the latest docker-ce install). This all installed exactly as expected and I was able to set-up as a single node. However when running the verify install step it fails in exactly the same place (view creation), also the same happens if I create a database manually and then create a simple view, here are the relevant logs from the container:\r\n\r\n```shell\r\n[notice] 2018-03-10T11:55:06.656272Z nonode@nohost <0.7573.0> 79b51a6dca 127.0.0.1:59840 172.17.42.1 undefined GET /verifytestdb 404 ok 0\r\n[notice] 2018-03-10T11:55:06.758187Z nonode@nohost <0.7573.0> d6580e8993 127.0.0.1:59840 172.17.42.1 undefined GET /verifytestdb_replicate 404 ok 0\r\n[info] 2018-03-10T11:55:07.161223Z nonode@nohost <0.10705.0> -------- Opening index for db: shards/80000000-9fffffff/_replicator.1520682842 idx: _design/_replicator sig: \"3e823c2a4383ac0c18d4e574135a5b08\"\r\n[notice] 2018-03-10T11:55:07.305601Z nonode@nohost <0.7573.0> 1f7839d7b2 127.0.0.1:59840 172.17.42.1 admin PUT /verifytestdb 201 ok 496\r\n[info] 2018-03-10T11:55:07.353690Z nonode@nohost <0.10731.0> -------- Opening index for db: shards/40000000-5fffffff/_users.1520682842 idx: _design/_auth sig: \"3e823c2a4383ac0c18d4e574135a5b08\"\r\n[notice] 2018-03-10T11:55:07.514649Z nonode@nohost <0.9273.0> fa9aea8734 127.0.0.1:59840 172.17.42.1 admin PUT /verifytestdb/test_doc_1 201 ok 173\r\n[info] 2018-03-10T11:55:07.515650Z nonode@nohost <0.10758.0> -------- Opening index for db: _users idx: _design/_auth sig: \"3e823c2a4383ac0c18d4e574135a5b08\"\r\n[info] 2018-03-10T11:55:07.516344Z nonode@nohost <0.10763.0> -------- Opening index for db: _replicator idx: _design/_replicator sig: \"3e823c2a4383ac0c18d4e574135a5b08\"\r\n[notice] 2018-03-10T11:55:07.636805Z nonode@nohost <0.9273.0> 343b70342a 127.0.0.1:59840 172.17.42.1 admin PUT /verifytestdb/test_doc_1 201 ok 65\r\n[notice] 2018-03-10T11:55:07.809337Z nonode@nohost <0.9273.0> 4d7ff8829e 127.0.0.1:59840 172.17.42.1 admin DELETE /verifytestdb/test_doc_1?rev=2-d588d3e93ee155c5afffdf0247a2c5ef 200 ok 139\r\n[notice] 2018-03-10T11:55:07.989632Z nonode@nohost <0.9273.0> f2ed059174 127.0.0.1:59840 172.17.42.1 admin PUT /verifytestdb/test_doc_10 201 ok 108\r\n[notice] 2018-03-10T11:55:08.012906Z nonode@nohost <0.10041.0> 7b588e5c33 127.0.0.1:59840 172.17.42.1 admin PUT /verifytestdb/test_doc_20 201 ok 127\r\n[notice] 2018-03-10T11:55:08.088114Z nonode@nohost <0.10547.0> 45dfce317d 127.0.0.1:59840 172.17.42.1 admin PUT /verifytestdb/test_doc_30 201 ok 172\r\n[info] 2018-03-10T11:55:13.187114Z nonode@nohost <0.206.0> -------- couch_proc_manager <0.10833.0> died normal\r\n[error] 2018-03-10T11:55:13.187124Z nonode@nohost <0.10831.0> -------- OS Process Error <0.10833.0> :: {os_process_error,\"OS process timed out.\"}\r\n[info] 2018-03-10T11:55:18.284132Z nonode@nohost <0.206.0> -------- couch_proc_manager <0.10943.0> died normal\r\n[error] 2018-03-10T11:55:18.284197Z nonode@nohost <0.10831.0> -------- OS Process Error <0.10943.0> :: {os_process_error,\"OS process timed out.\"}\r\n[info] 2018-03-10T11:55:23.394099Z nonode@nohost <0.206.0> -------- couch_proc_manager <0.11025.0> died normal\r\n[error] 2018-03-10T11:55:23.394162Z nonode@nohost <0.10831.0> -------- OS Process Error <0.11025.0> :: {os_process_error,\"OS process timed out.\"}\r\n[info] 2018-03-10T11:55:28.495147Z nonode@nohost <0.206.0> -------- couch_proc_manager <0.11109.0> died normal\r\n[error] 2018-03-10T11:55:28.495233Z nonode@nohost <0.10831.0> -------- OS Process Error <0.11109.0> :: {os_process_error,\"OS process timed out.\"}\r\n[info] 2018-03-10T11:55:33.610131Z nonode@nohost <0.206.0> -------- couch_proc_manager <0.11191.0> died normal\r\n[error] 2018-03-10T11:55:33.610208Z nonode@nohost <0.10831.0> -------- OS Process Error <0.11191.0> :: {os_process_error,\"OS process timed out.\"}\r\n[info] 2018-03-10T11:55:38.749125Z nonode@nohost <0.206.0> -------- couch_proc_manager <0.11275.0> died normal\r\n[error] 2018-03-10T11:55:38.749207Z nonode@nohost <0.10831.0> -------- OS Process Error <0.11275.0> :: {os_process_error,\"OS process timed out.\"}\r\n[info] 2018-03-10T11:55:43.867119Z nonode@nohost <0.206.0> -------- couch_proc_manager <0.11357.0> died normal\r\n[error] 2018-03-10T11:55:43.867202Z nonode@nohost <0.10831.0> -------- OS Process Error <0.11357.0> :: {os_process_error,\"OS process timed out.\"}\r\n[info] 2018-03-10T11:55:49.006130Z nonode@nohost <0.206.0> -------- couch_proc_manager <0.11441.0> died normal\r\n[error] 2018-03-10T11:55:49.006209Z nonode@nohost <0.10831.0> -------- OS Process Error <0.11441.0> :: {os_process_error,\"OS process timed out.\"}\r\n```\r\nAs before the `couchjs` process just keeps spawning until the host machine crashes. This feels like it is a CouchDB issue, but perhaps relating to something specific in the underlying server... processor perhaps? The machine has 8 cores, but I am only listing the output of `cat /proc/cpuinfo` for one of them to save space:\r\n```shell\r\nprocessor\t: 0\r\nvendor_id\t: GenuineIntel\r\ncpu family\t: 6\r\nmodel\t\t: 60\r\nmodel name\t: Intel(R) Xeon(R) CPU E3-1231 v3 @ 3.40GHz\r\nstepping\t: 3\r\nmicrocode\t: 0x1d\r\ncpu MHz\t\t: 3399.070\r\ncache size\t: 8192 KB\r\nphysical id\t: 0\r\nsiblings\t: 8\r\ncore id\t\t: 0\r\ncpu cores\t: 4\r\napicid\t\t: 0\r\ninitial apicid\t: 0\r\nfpu\t\t: yes\r\nfpu_exception\t: yes\r\ncpuid level\t: 13\r\nwp\t\t: yes\r\nflags\t\t: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 fma cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm ida arat epb xsaveopt pln pts dtherm tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid\r\nbogomips\t: 6784.53\r\nclflush size\t: 64\r\ncache_alignment\t: 64\r\naddress sizes\t: 39 bits physical, 48 bits virtual\r\npower management:\r\n```\r\nThere is plenty of memory (32GB) and disk space there is about 1.8TB free.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372024493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372039586","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-372039586","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":372039586,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjAzOTU4Ng==","user":{"login":"Crispy1975","id":12525875,"node_id":"MDQ6VXNlcjEyNTI1ODc1","avatar_url":"https://avatars.githubusercontent.com/u/12525875?v=4","gravatar_id":"","url":"https://api.github.com/users/Crispy1975","html_url":"https://github.com/Crispy1975","followers_url":"https://api.github.com/users/Crispy1975/followers","following_url":"https://api.github.com/users/Crispy1975/following{/other_user}","gists_url":"https://api.github.com/users/Crispy1975/gists{/gist_id}","starred_url":"https://api.github.com/users/Crispy1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Crispy1975/subscriptions","organizations_url":"https://api.github.com/users/Crispy1975/orgs","repos_url":"https://api.github.com/users/Crispy1975/repos","events_url":"https://api.github.com/users/Crispy1975/events{/privacy}","received_events_url":"https://api.github.com/users/Crispy1975/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-10T15:46:39Z","updated_at":"2018-03-10T15:48:43Z","author_association":"NONE","body":"Further tests. i have tried switching to using `nodejs` as the `query_server` albeit with little success. The verify install process still fails as the Node.js `couchjs` module is exiting with an exit code of 1. So I thought I would focus on the `couchjs` process that is bundled with the install which I believe is SpiderMonkey. I created the following file on my working VM, and also on the failing server:\r\n\r\n```javascript\r\nprint(\"Test\");\r\n```\r\nOn the VM it worked, on the server the `couchjs` process just goes into using 100% CPU and does not return at all. So the issue on the server is 100% the `couchjs` query server. Will see if I can investigate this further...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372039586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372044121","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-372044121","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":372044121,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjA0NDEyMQ==","user":{"login":"Crispy1975","id":12525875,"node_id":"MDQ6VXNlcjEyNTI1ODc1","avatar_url":"https://avatars.githubusercontent.com/u/12525875?v=4","gravatar_id":"","url":"https://api.github.com/users/Crispy1975","html_url":"https://github.com/Crispy1975","followers_url":"https://api.github.com/users/Crispy1975/followers","following_url":"https://api.github.com/users/Crispy1975/following{/other_user}","gists_url":"https://api.github.com/users/Crispy1975/gists{/gist_id}","starred_url":"https://api.github.com/users/Crispy1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Crispy1975/subscriptions","organizations_url":"https://api.github.com/users/Crispy1975/orgs","repos_url":"https://api.github.com/users/Crispy1975/repos","events_url":"https://api.github.com/users/Crispy1975/events{/privacy}","received_events_url":"https://api.github.com/users/Crispy1975/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-10T16:48:58Z","updated_at":"2018-03-10T16:48:58Z","author_association":"NONE","body":"And the final option was to compile and install from source. Did this, CouchDB started up, but exactly the same issue with `couchjs`. I am out of ideas on this now, any help or pointers would be most appreciated.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372044121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372050823","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-372050823","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":372050823,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjA1MDgyMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-10T18:07:00Z","updated_at":"2018-03-10T18:07:00Z","author_association":"MEMBER","body":"Try purging and reinstalling `libmozjs185-dev` with `apt-get purge` and `apt-get install`? Maybe you have a bad install.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372050823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372053389","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-372053389","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":372053389,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjA1MzM4OQ==","user":{"login":"Crispy1975","id":12525875,"node_id":"MDQ6VXNlcjEyNTI1ODc1","avatar_url":"https://avatars.githubusercontent.com/u/12525875?v=4","gravatar_id":"","url":"https://api.github.com/users/Crispy1975","html_url":"https://github.com/Crispy1975","followers_url":"https://api.github.com/users/Crispy1975/followers","following_url":"https://api.github.com/users/Crispy1975/following{/other_user}","gists_url":"https://api.github.com/users/Crispy1975/gists{/gist_id}","starred_url":"https://api.github.com/users/Crispy1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Crispy1975/subscriptions","organizations_url":"https://api.github.com/users/Crispy1975/orgs","repos_url":"https://api.github.com/users/Crispy1975/repos","events_url":"https://api.github.com/users/Crispy1975/events{/privacy}","received_events_url":"https://api.github.com/users/Crispy1975/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-10T18:34:37Z","updated_at":"2018-03-10T18:34:37Z","author_association":"NONE","body":"@wohali managed to resolve this. In the end I resorted to checking the running kernel version against what was available for Jessie (and in the VM test). The server in question was on `3.14.x` whereas the latest for Jessie at the moment if `3.16.x` so updated that and had a few tense moments on reboot. On coming backup `couchjs` is behaving exactly as expected and the verify DB tests from Fauxton work perfectly.\r\n\r\nMany thanks for the responses. Perhaps the docs could mention supported kernel versions or something?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372053389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372087072","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-372087072","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":372087072,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjA4NzA3Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-11T03:44:55Z","updated_at":"2018-03-11T03:44:55Z","author_association":"MEMBER","body":"I'm able to run against 4.x kernels no problem, so it's perhaps something very specific to the kernel version you pulled down.\r\n\r\nIf anyone else is able to confirm a problem with a 3.16 series kernel, please post here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372087072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372103652","html_url":"https://github.com/apache/couchdb/issues/1214#issuecomment-372103652","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1214","id":372103652,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjEwMzY1Mg==","user":{"login":"Crispy1975","id":12525875,"node_id":"MDQ6VXNlcjEyNTI1ODc1","avatar_url":"https://avatars.githubusercontent.com/u/12525875?v=4","gravatar_id":"","url":"https://api.github.com/users/Crispy1975","html_url":"https://github.com/Crispy1975","followers_url":"https://api.github.com/users/Crispy1975/followers","following_url":"https://api.github.com/users/Crispy1975/following{/other_user}","gists_url":"https://api.github.com/users/Crispy1975/gists{/gist_id}","starred_url":"https://api.github.com/users/Crispy1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Crispy1975/subscriptions","organizations_url":"https://api.github.com/users/Crispy1975/orgs","repos_url":"https://api.github.com/users/Crispy1975/repos","events_url":"https://api.github.com/users/Crispy1975/events{/privacy}","received_events_url":"https://api.github.com/users/Crispy1975/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-11T10:08:40Z","updated_at":"2018-03-11T10:08:40Z","author_association":"NONE","body":"The 3.16 was good, it was the previous 3.14 where it was failing. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372103652/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372201494","html_url":"https://github.com/apache/couchdb/issues/1209#issuecomment-372201494","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1209","id":372201494,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjIwMTQ5NA==","user":{"login":"mmarinchenko","id":21952330,"node_id":"MDQ6VXNlcjIxOTUyMzMw","avatar_url":"https://avatars.githubusercontent.com/u/21952330?v=4","gravatar_id":"","url":"https://api.github.com/users/mmarinchenko","html_url":"https://github.com/mmarinchenko","followers_url":"https://api.github.com/users/mmarinchenko/followers","following_url":"https://api.github.com/users/mmarinchenko/following{/other_user}","gists_url":"https://api.github.com/users/mmarinchenko/gists{/gist_id}","starred_url":"https://api.github.com/users/mmarinchenko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmarinchenko/subscriptions","organizations_url":"https://api.github.com/users/mmarinchenko/orgs","repos_url":"https://api.github.com/users/mmarinchenko/repos","events_url":"https://api.github.com/users/mmarinchenko/events{/privacy}","received_events_url":"https://api.github.com/users/mmarinchenko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-12T05:59:01Z","updated_at":"2018-03-12T06:19:58Z","author_association":"NONE","body":"Thank you for the response, Janl!\r\n\r\nBut why are you asking this? I've pointed out to the source code :)\r\n\r\nI'm talking about any revision, regular, conflicted, or deleted. It doesn't matter in this particular context. Of course, with many conflicts the situation will be even worse. If the `style=all_docs` parameter is specified in request along with native filter then CouchDB calls `to_binary()` for each document with all its revisions. All at once!\r\n\r\nI'm not claiming that a document with such amount of revisions (especially conflicts) is a good state. No. This happened to us by accident, I guess. I'm not responsible for the application side of things, so I don't know why this happened.\r\n\r\nI'm just trying to say that loading a document with all of its associated revisions into memory at once and then convert all this data into plain list using `to_binary()` without checking the size of loaded data, any buffering, etc. is a very bad idea for a database management system.\r\n\r\nIf we look at changes enumerator we'll see that situation even worse. Imagine that we need to filter several sequential changes with such a big bad document through native query server. CouchDB will be loading all the revisions and calling `to_binary()` for all the revisions at once on each single change. For what matter?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372201494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372252106","html_url":"https://github.com/apache/couchdb/issues/1218#issuecomment-372252106","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1218","id":372252106,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjI1MjEwNg==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-12T09:54:14Z","updated_at":"2018-03-12T09:54:14Z","author_association":"MEMBER","body":"Great bug report thanks @tiangolo I will take a look at this in the next week or so.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372252106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372342804","html_url":"https://github.com/apache/couchdb/issues/1088#issuecomment-372342804","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1088","id":372342804,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjM0MjgwNA==","user":{"login":"dninet","id":26964297,"node_id":"MDQ6VXNlcjI2OTY0Mjk3","avatar_url":"https://avatars.githubusercontent.com/u/26964297?v=4","gravatar_id":"","url":"https://api.github.com/users/dninet","html_url":"https://github.com/dninet","followers_url":"https://api.github.com/users/dninet/followers","following_url":"https://api.github.com/users/dninet/following{/other_user}","gists_url":"https://api.github.com/users/dninet/gists{/gist_id}","starred_url":"https://api.github.com/users/dninet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dninet/subscriptions","organizations_url":"https://api.github.com/users/dninet/orgs","repos_url":"https://api.github.com/users/dninet/repos","events_url":"https://api.github.com/users/dninet/events{/privacy}","received_events_url":"https://api.github.com/users/dninet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-12T15:07:51Z","updated_at":"2018-03-12T15:07:51Z","author_association":"NONE","body":"I've had the same problem. A Monero miner was installed through a curl request to 192.99.142.232:8220/logo3.jpg which is in turn a bash script. When it starts with 192., doesn't it refer to a local network?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372342804/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372359720","html_url":"https://github.com/apache/couchdb/issues/1088#issuecomment-372359720","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1088","id":372359720,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjM1OTcyMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-12T15:53:04Z","updated_at":"2018-03-12T15:53:04Z","author_association":"MEMBER","body":"@AlbertDavid94 No, the private IP space is only `192.168.0.0 - 192.168.255.255`. Addresses outside this range are publicly routeable, including `192.99.142.232`.\r\n\r\nThe full set of private IP space blocks is documented in [RFC 1918](http://www.faqs.org/rfcs/rfc1918.html).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372359720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372433778","html_url":"https://github.com/apache/couchdb/pull/1187#issuecomment-372433778","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1187","id":372433778,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjQzMzc3OA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-12T19:26:38Z","updated_at":"2018-03-12T19:26:38Z","author_association":"MEMBER","body":"I don't think I was clear on my first point. The reason that I'd like to go with a more specific plugin name rather than the more general \"compact_start\" is that the intent for this is very specific for upgrades to existing indices across the clustered purge deployment. If its more general then a) our single load of ddocs isn't usable and historically speaking it'll get a bit odd on the intended use for it when there's not a whole lot else that can be done.\r\n\r\nHowever, as a separate unrelated PR I'd be perfectly happy to see the start/finish compaction hooks that could be used by the compaction daemon or some other tooling that someone wanted. Although that has the caveat that not all storage engines require compaction so :shrug: on whether it'd be worthwhile.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372433778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372515908","html_url":"https://github.com/apache/couchdb/issues/1080#issuecomment-372515908","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1080","id":372515908,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjUxNTkwOA==","user":{"login":"jkroon-immt","id":34634511,"node_id":"MDQ6VXNlcjM0NjM0NTEx","avatar_url":"https://avatars.githubusercontent.com/u/34634511?v=4","gravatar_id":"","url":"https://api.github.com/users/jkroon-immt","html_url":"https://github.com/jkroon-immt","followers_url":"https://api.github.com/users/jkroon-immt/followers","following_url":"https://api.github.com/users/jkroon-immt/following{/other_user}","gists_url":"https://api.github.com/users/jkroon-immt/gists{/gist_id}","starred_url":"https://api.github.com/users/jkroon-immt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkroon-immt/subscriptions","organizations_url":"https://api.github.com/users/jkroon-immt/orgs","repos_url":"https://api.github.com/users/jkroon-immt/repos","events_url":"https://api.github.com/users/jkroon-immt/events{/privacy}","received_events_url":"https://api.github.com/users/jkroon-immt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-13T01:30:09Z","updated_at":"2018-03-13T01:30:09Z","author_association":"NONE","body":"Hi,\r\n\r\nI noticed it's been four months since this issue was raised and I was wondering if there has been any progress? Any information is most appreciated.\r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372515908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372517972","html_url":"https://github.com/apache/couchdb/pull/1187#issuecomment-372517972","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1187","id":372517972,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjUxNzk3Mg==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-13T01:42:00Z","updated_at":"2018-03-13T01:42:00Z","author_association":"CONTRIBUTOR","body":"Thanks @davisp @eiri @nickva. \r\n\r\n>Lastly, the plugin references in couch_index should go away and that should be written in couch_mrview as that's the indexer with the logic. Passing through a couch_index module is superfluous. Also I'd pull that logic out into its own couch_mrview_plugin module or similar rather than overloading the maybe_create_local_purge_doc (yes its named similar but the logic for its use is completely different). Although we should very much keep the logic as written so that we're not required to open the underlyinng index which could very well overload deployments that have huge numbers of indexes.\r\n\r\nRegarding above comments, I understand that it would be better to put it to couch_mrview. However, it looks that couch_mrview is one *plugin* to couch_index. The control logic is at couch_index. I can pull logic from couch_index to couch_mrview and implement couch_mrview_plugin and couch_mrview_epi.\r\n\r\nBut we still need to register couch_mrview_epi in some place, like https://github.com/apache/couchdb/blob/master/src/couch_index/src/couch_index_sup.erl#L24\r\n\r\nThis looks that it can't be done without bothering couch_index.\r\nso this is why I put new epi function to couch_index and add call to couch_mrview to write local purge doc.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372517972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372520696","html_url":"https://github.com/apache/couchdb/issues/820#issuecomment-372520696","issue_url":"https://api.github.com/repos/apache/couchdb/issues/820","id":372520696,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjUyMDY5Ng==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-13T01:58:12Z","updated_at":"2018-03-13T02:07:15Z","author_association":"CONTRIBUTOR","body":"@iilyak @davisp @janl I just had some discussion with @wohali about next step to address this issue. \r\n\r\nBased on previous discussion, the proposed approach is to implement new endpoints to support queries, and this includes\r\n - /{db}/_all_docs/_queries\r\n\r\nHowever, it is not necessary to implement below endpoints based on @iilyak's reasonable comments. \r\n- /{db}/_all_design/_queries\r\n- /{db}/_local_docs/_queries\r\n\r\nIn addition, for view, we implement new endpoint to support queries, and also keep original implementation for backward compatibility.\r\n- _view/{viewname}/_queries\r\n\r\nPlease let us know in case you have any concern on this approach. \r\n\r\ncc @wohali @rnewson @ricellis @chewbranca \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372520696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372706665","html_url":"https://github.com/apache/couchdb/issues/820#issuecomment-372706665","issue_url":"https://api.github.com/repos/apache/couchdb/issues/820","id":372706665,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjcwNjY2NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-13T15:29:57Z","updated_at":"2018-03-13T15:29:57Z","author_association":"MEMBER","body":"Isn't it `_design_docs` instead of `_all_design`? Otherwise that seems fine. queries seems a bit of an odd name but I haven't got anything immediately better. I would remove the `_` prefix from the queries path part though. The `_` prefix on the prior path part already suggests this is a system path so it seems odd to repeat it.\r\n\r\nOtherwise that seems fine to me.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372706665/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372724966","html_url":"https://github.com/apache/couchdb/issues/820#issuecomment-372724966","issue_url":"https://api.github.com/repos/apache/couchdb/issues/820","id":372724966,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjcyNDk2Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-13T16:18:21Z","updated_at":"2018-03-13T16:18:21Z","author_association":"MEMBER","body":"Agree with @davisp, so that'd make the full paths to the endpoints:\r\n\r\n```\r\n/{db}/_all_docs/queries\r\n/{db}/_design_docs/queries\r\n/{db}/_local_docs/queries\r\n/{db}/_design/{ddoc}/_view/{viewname}/queries\r\n```\r\n\r\nWe'll need to be careful with the documentation on the first and last ones.\r\n\r\nWe want to encourage use of this and mark the old endpoints as deprecated with appropriate pointers to the new endpoints. Since the endpoint isn't being removed *yet* we don't need the post to the mailing list:\r\n\r\n> Whenever a change is proposed to a release branch or master that removes or changes an existing HTTP API endpoint in a way that breaks backwards compatibility with a released version of CouchDB, the proposed change must be announced on the developer mailing list, and a minimum of a lazy consensus decision is required.\r\n\r\nThe vote will come whenever we move towards a 3.0 release, and actually remove the old endpoints.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372724966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372728458","html_url":"https://github.com/apache/couchdb/issues/820#issuecomment-372728458","issue_url":"https://api.github.com/repos/apache/couchdb/issues/820","id":372728458,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjcyODQ1OA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-13T16:27:40Z","updated_at":"2018-03-13T16:27:40Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372728458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372874974","html_url":"https://github.com/apache/couchdb/issues/820#issuecomment-372874974","issue_url":"https://api.github.com/repos/apache/couchdb/issues/820","id":372874974,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjg3NDk3NA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-14T01:34:14Z","updated_at":"2018-03-14T01:34:14Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372874974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372912891","html_url":"https://github.com/apache/couchdb/pull/1219#issuecomment-372912891","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1219","id":372912891,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjkxMjg5MQ==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-14T05:54:36Z","updated_at":"2018-03-14T05:54:36Z","author_association":"CONTRIBUTOR","body":"LGTM\r\n```\r\n======================== EUnit ========================\r\ncouch_replicator_worker: replication_worker_format_status_test (module 'couch_replicator_worker')...[0.020 s] ok\r\n=======================================================\r\n  Test passed.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/372912891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373039453","html_url":"https://github.com/apache/couchdb/issues/1220#issuecomment-373039453","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1220","id":373039453,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzAzOTQ1Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-14T14:25:35Z","updated_at":"2018-03-14T14:25:35Z","author_association":"MEMBER","body":"`couchjs` processes are launched as needed by CouchDB for processing JavaScript.\r\n\r\nYou can adjust parameters of how these processes are launched via settings in your `local.ini` file. You want the settings under the `[query_server_config]` section. [Here's our documentation](http://docs.couchdb.org/en/2.1.1/config/query-servers.html#query-servers-configuration) on those settings.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373039453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373081785","html_url":"https://github.com/apache/couchdb/pull/1223#issuecomment-373081785","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1223","id":373081785,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzA4MTc4NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-14T16:17:15Z","updated_at":"2018-03-14T16:17:15Z","author_association":"MEMBER","body":"+1 and thank you for tagging couchdb-config :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373081785/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373302168","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-373302168","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":373302168,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzMwMjE2OA==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-15T08:46:01Z","updated_at":"2018-03-15T08:46:30Z","author_association":"CONTRIBUTOR","body":"Hi @janl , thank you for your advice to stick to the `couch_doc:doc_to_multi_part_stream()` and `couch_httpd_db:encode_multipart_stream()` functions. I realised that I wrote a lot of duplicated code :)\r\nI pushed a revised implementation.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373302168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373405190","html_url":"https://github.com/apache/couchdb/issues/1224#issuecomment-373405190","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1224","id":373405190,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzQwNTE5MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-15T14:57:34Z","updated_at":"2018-03-15T14:57:34Z","author_association":"MEMBER","body":"You are asking for help with a Couchbase extension, which is a commercial offering from the Couchbase company.\r\n\r\nThis is the Apache CouchDB project. We can't help you.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373405190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373445157","html_url":"https://github.com/apache/couchdb/issues/1224#issuecomment-373445157","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1224","id":373445157,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzQ0NTE1Nw==","user":{"login":"garbinmarcelo","id":9335588,"node_id":"MDQ6VXNlcjkzMzU1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/9335588?v=4","gravatar_id":"","url":"https://api.github.com/users/garbinmarcelo","html_url":"https://github.com/garbinmarcelo","followers_url":"https://api.github.com/users/garbinmarcelo/followers","following_url":"https://api.github.com/users/garbinmarcelo/following{/other_user}","gists_url":"https://api.github.com/users/garbinmarcelo/gists{/gist_id}","starred_url":"https://api.github.com/users/garbinmarcelo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garbinmarcelo/subscriptions","organizations_url":"https://api.github.com/users/garbinmarcelo/orgs","repos_url":"https://api.github.com/users/garbinmarcelo/repos","events_url":"https://api.github.com/users/garbinmarcelo/events{/privacy}","received_events_url":"https://api.github.com/users/garbinmarcelo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-15T16:48:31Z","updated_at":"2018-03-15T16:48:31Z","author_association":"NONE","body":"My mistake. I'm new to the subject and honestly had not noticed the difference! Sorry for the inconvenience. I will try to find another CouchDB package that works with Laravel, if you have any indication I would appreciate it. Sorry for the inconvenience. :disappointed:","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373445157/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373447288","html_url":"https://github.com/apache/couchdb/issues/1224#issuecomment-373447288","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1224","id":373447288,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzQ0NzI4OA==","user":{"login":"popojargo","id":9197078,"node_id":"MDQ6VXNlcjkxOTcwNzg=","avatar_url":"https://avatars.githubusercontent.com/u/9197078?v=4","gravatar_id":"","url":"https://api.github.com/users/popojargo","html_url":"https://github.com/popojargo","followers_url":"https://api.github.com/users/popojargo/followers","following_url":"https://api.github.com/users/popojargo/following{/other_user}","gists_url":"https://api.github.com/users/popojargo/gists{/gist_id}","starred_url":"https://api.github.com/users/popojargo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/popojargo/subscriptions","organizations_url":"https://api.github.com/users/popojargo/orgs","repos_url":"https://api.github.com/users/popojargo/repos","events_url":"https://api.github.com/users/popojargo/events{/privacy}","received_events_url":"https://api.github.com/users/popojargo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-15T16:54:17Z","updated_at":"2018-03-15T16:54:17Z","author_association":"MEMBER","body":"https://github.com/robsonvn/laravel-couchdb","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373447288/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373624458","html_url":"https://github.com/apache/couchdb/issues/820#issuecomment-373624458","issue_url":"https://api.github.com/repos/apache/couchdb/issues/820","id":373624458,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzYyNDQ1OA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-16T07:16:57Z","updated_at":"2018-03-16T07:16:57Z","author_association":"CONTRIBUTOR","body":"Based on current agreement, I drafted codes PR https://github.com/apache/couchdb/pull/1222 and documentation PR https://github.com/apache/couchdb-documentation/pull/241. Could somebody from you please review them? Thanks","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373624458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373765415","html_url":"https://github.com/apache/couchdb/issues/1221#issuecomment-373765415","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1221","id":373765415,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mzc2NTQxNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-16T16:17:19Z","updated_at":"2018-03-16T16:17:19Z","author_association":"MEMBER","body":"@kdoran Could this be a duplicate of #748?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373765415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373766162","html_url":"https://github.com/apache/couchdb/issues/1221#issuecomment-373766162","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1221","id":373766162,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mzc2NjE2Mg==","user":{"login":"kdoran","id":721262,"node_id":"MDQ6VXNlcjcyMTI2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/721262?v=4","gravatar_id":"","url":"https://api.github.com/users/kdoran","html_url":"https://github.com/kdoran","followers_url":"https://api.github.com/users/kdoran/followers","following_url":"https://api.github.com/users/kdoran/following{/other_user}","gists_url":"https://api.github.com/users/kdoran/gists{/gist_id}","starred_url":"https://api.github.com/users/kdoran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kdoran/subscriptions","organizations_url":"https://api.github.com/users/kdoran/orgs","repos_url":"https://api.github.com/users/kdoran/repos","events_url":"https://api.github.com/users/kdoran/events{/privacy}","received_events_url":"https://api.github.com/users/kdoran/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-16T16:19:55Z","updated_at":"2018-03-16T16:19:55Z","author_association":"NONE","body":"@wohali it seemed like it could be, but then I saw the same behavior happening on a 1.7x... so would that mean it's a separate issue?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373766162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373766289","html_url":"https://github.com/apache/couchdb/issues/1221#issuecomment-373766289","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1221","id":373766289,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mzc2NjI4OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-16T16:20:24Z","updated_at":"2018-03-16T16:20:24Z","author_association":"MEMBER","body":"@kdoran Definitely worth investigating, I missed that it was also an issue in 1.x.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373766289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373796349","html_url":"https://github.com/apache/couchdb/issues/1221#issuecomment-373796349","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1221","id":373796349,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mzc5NjM0OQ==","user":{"login":"kdoran","id":721262,"node_id":"MDQ6VXNlcjcyMTI2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/721262?v=4","gravatar_id":"","url":"https://api.github.com/users/kdoran","html_url":"https://github.com/kdoran","followers_url":"https://api.github.com/users/kdoran/followers","following_url":"https://api.github.com/users/kdoran/following{/other_user}","gists_url":"https://api.github.com/users/kdoran/gists{/gist_id}","starred_url":"https://api.github.com/users/kdoran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kdoran/subscriptions","organizations_url":"https://api.github.com/users/kdoran/orgs","repos_url":"https://api.github.com/users/kdoran/repos","events_url":"https://api.github.com/users/kdoran/events{/privacy}","received_events_url":"https://api.github.com/users/kdoran/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-16T18:00:04Z","updated_at":"2018-03-16T18:00:04Z","author_association":"NONE","body":"👍  for our case it ended up being just fine to use the last `seq` in the change results list instead of `last_seq` in case others stumble across this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373796349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373798306","html_url":"https://github.com/apache/couchdb/issues/1221#issuecomment-373798306","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1221","id":373798306,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mzc5ODMwNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-16T18:06:50Z","updated_at":"2018-03-16T18:08:50Z","author_association":"MEMBER","body":"@kdoran We need a `last_seq` and the final row's `seq` value to investigate further, of a response that has caused the issue. Can you provide? We're having trouble reproducing. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373798306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373959277","html_url":"https://github.com/apache/couchdb/issues/1096#issuecomment-373959277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1096","id":373959277,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mzk1OTI3Nw==","user":{"login":"jvegaseg","id":12508470,"node_id":"MDQ6VXNlcjEyNTA4NDcw","avatar_url":"https://avatars.githubusercontent.com/u/12508470?v=4","gravatar_id":"","url":"https://api.github.com/users/jvegaseg","html_url":"https://github.com/jvegaseg","followers_url":"https://api.github.com/users/jvegaseg/followers","following_url":"https://api.github.com/users/jvegaseg/following{/other_user}","gists_url":"https://api.github.com/users/jvegaseg/gists{/gist_id}","starred_url":"https://api.github.com/users/jvegaseg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jvegaseg/subscriptions","organizations_url":"https://api.github.com/users/jvegaseg/orgs","repos_url":"https://api.github.com/users/jvegaseg/repos","events_url":"https://api.github.com/users/jvegaseg/events{/privacy}","received_events_url":"https://api.github.com/users/jvegaseg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-17T23:02:23Z","updated_at":"2018-03-17T23:02:23Z","author_association":"NONE","body":"@wohali I confirm you that the `?w=3` workaround does not solve the problem.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/373959277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374010917","html_url":"https://github.com/apache/couchdb/issues/1183#issuecomment-374010917","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1183","id":374010917,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDAxMDkxNw==","user":{"login":"abhishiv","id":37350,"node_id":"MDQ6VXNlcjM3MzUw","avatar_url":"https://avatars.githubusercontent.com/u/37350?v=4","gravatar_id":"","url":"https://api.github.com/users/abhishiv","html_url":"https://github.com/abhishiv","followers_url":"https://api.github.com/users/abhishiv/followers","following_url":"https://api.github.com/users/abhishiv/following{/other_user}","gists_url":"https://api.github.com/users/abhishiv/gists{/gist_id}","starred_url":"https://api.github.com/users/abhishiv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abhishiv/subscriptions","organizations_url":"https://api.github.com/users/abhishiv/orgs","repos_url":"https://api.github.com/users/abhishiv/repos","events_url":"https://api.github.com/users/abhishiv/events{/privacy}","received_events_url":"https://api.github.com/users/abhishiv/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-18T16:04:20Z","updated_at":"2018-03-18T16:04:30Z","author_association":"NONE","body":"Just got bitten by this. \r\n\r\nFor a workaround, as @wohali suggested I'm running a small `express-http-proxy` on the same instance as couchdb which rejects request if they don't have the proper secret.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374010917/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374096252","html_url":"https://github.com/apache/couchdb/issues/1225#issuecomment-374096252","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1225","id":374096252,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDA5NjI1Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-19T04:09:52Z","updated_at":"2018-03-19T04:09:52Z","author_association":"CONTRIBUTOR","body":"@wohali good call, we don't support it and we should.\r\n\r\nWe'd have to make sure that all pervious versions can effectively ignore the `seq_interval` parameter.  First I mistakenly responded to https://github.com/apache/couchdb-documentation/issues/230 and based on discussion it seems 1.x will ignore it. Might have to make sure 2.0 and 2.1.x ignores as well. We started to add parameter validation to some requests in 2.x (but I think that's mostly view args parsing...).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374096252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374117973","html_url":"https://github.com/apache/couchdb/pull/1222#issuecomment-374117973","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1222","id":374117973,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDExNzk3Mw==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-19T06:59:52Z","updated_at":"2018-03-19T06:59:52Z","author_association":"CONTRIBUTOR","body":"Could somebody please help review this PR? Thanks","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374117973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374365839","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-374365839","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":374365839,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDM2NTgzOQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-19T20:37:12Z","updated_at":"2018-03-19T20:37:12Z","author_association":"MEMBER","body":"A side note: I don't think chttpd family of etag functions is actually working. Make ETag generates binary [make_etag](https://github.com/apache/couchdb/blob/master/src/chttpd/src/chttpd.erl#L667), but validator \r\n [`etag_match/2`](https://github.com/apache/couchdb/blob/master/src/chttpd/src/chttpd.erl#L674) checks it versus tokenized header value, which gives a list of strings.\r\n\r\nIt's an easy fix, but I'm hesitant to introduce it as part of this work, it seems that `etag_respond/3` used in quite a few places in chttpd, so complete fix would make this PR rather messy.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374365839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374489730","html_url":"https://github.com/apache/couchdb/pull/1222#issuecomment-374489730","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1222","id":374489730,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDQ4OTczMA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-20T06:26:37Z","updated_at":"2018-03-20T06:26:37Z","author_association":"CONTRIBUTOR","body":"Thanks @eiri for your review. I already addressed your comments in \r\nfe6c197. Could you please check and approve if applicable? And then I can squash and merge them.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374489730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374611080","html_url":"https://github.com/apache/couchdb/issues/1183#issuecomment-374611080","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1183","id":374611080,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDYxMTA4MA==","user":{"login":"fkaempfer","id":2357885,"node_id":"MDQ6VXNlcjIzNTc4ODU=","avatar_url":"https://avatars.githubusercontent.com/u/2357885?v=4","gravatar_id":"","url":"https://api.github.com/users/fkaempfer","html_url":"https://github.com/fkaempfer","followers_url":"https://api.github.com/users/fkaempfer/followers","following_url":"https://api.github.com/users/fkaempfer/following{/other_user}","gists_url":"https://api.github.com/users/fkaempfer/gists{/gist_id}","starred_url":"https://api.github.com/users/fkaempfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkaempfer/subscriptions","organizations_url":"https://api.github.com/users/fkaempfer/orgs","repos_url":"https://api.github.com/users/fkaempfer/repos","events_url":"https://api.github.com/users/fkaempfer/events{/privacy}","received_events_url":"https://api.github.com/users/fkaempfer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-20T14:09:23Z","updated_at":"2018-03-20T14:09:23Z","author_association":"CONTRIBUTOR","body":"Isn't this working as expected? The only thing that's confusing is that you have to send the SHA-1 sum of the username using the secret instead of the secret directly:\r\n\r\nIn NodeJS this should give you the token:\r\n\r\n>  crypto.createHmac('sha1', 'mysecret').update('username').digest('hex')\r\n\r\n\r\nThen with curl you should get:\r\n\r\n```\r\ncurl -X GET http://127.0.0.1:5984/_session -H \"Content-Type: application/json\" -H \"X-Auth-CouchDB-UserName: username\" -H \"X-Auth-CouchDB-Roles: myadmin\" -H \"X-Auth-CouchDB-Token: \"7bdfca0f0926fe4255440da35417cd2dc79507e0\"\r\n{\"ok\":true,\"userCtx\":{\"name\":\"username\",\"roles\":[\"myadmin\"]},\"info\":{\"authentication_db\":\"_users\",\"authentication_handlers\":[\"cookie\",\"proxy\",\"default\"],\"authenticated\":\"proxy\"}}\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374611080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374710759","html_url":"https://github.com/apache/couchdb/issues/1183#issuecomment-374710759","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1183","id":374710759,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDcxMDc1OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-20T18:37:53Z","updated_at":"2018-03-20T18:37:53Z","author_association":"MEMBER","body":"@fkaempfer Oh! My mistake. Is this in our test suite anywhere that you can find?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374710759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374771979","html_url":"https://github.com/apache/couchdb/pull/1200#issuecomment-374771979","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1200","id":374771979,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDc3MTk3OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-20T22:00:41Z","updated_at":"2018-03-20T22:00:41Z","author_association":"MEMBER","body":"@janl What are we planning to do here for 2.2.0? This is a hot topic that needs resolution before we call an RC.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374771979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374856324","html_url":"https://github.com/apache/couchdb/issues/1183#issuecomment-374856324","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1183","id":374856324,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDg1NjMyNA==","user":{"login":"fkaempfer","id":2357885,"node_id":"MDQ6VXNlcjIzNTc4ODU=","avatar_url":"https://avatars.githubusercontent.com/u/2357885?v=4","gravatar_id":"","url":"https://api.github.com/users/fkaempfer","html_url":"https://github.com/fkaempfer","followers_url":"https://api.github.com/users/fkaempfer/followers","following_url":"https://api.github.com/users/fkaempfer/following{/other_user}","gists_url":"https://api.github.com/users/fkaempfer/gists{/gist_id}","starred_url":"https://api.github.com/users/fkaempfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkaempfer/subscriptions","organizations_url":"https://api.github.com/users/fkaempfer/orgs","repos_url":"https://api.github.com/users/fkaempfer/repos","events_url":"https://api.github.com/users/fkaempfer/events{/privacy}","received_events_url":"https://api.github.com/users/fkaempfer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-21T07:49:45Z","updated_at":"2018-03-21T07:49:45Z","author_association":"CONTRIBUTOR","body":"On first glance, no, I think there are no proxy tests.\r\n\r\nThis is not well documented, I found out about it by looking at the source here:\r\n\r\nhttps://github.com/apache/couchdb/blob/master/src/couch/src/couch_httpd_auth.erl#L173\r\n\r\nI think the hmac encoding of the username provides only slightly better security, but it is confusing to users. Perhaps the http auth should allow both options at the same time, either the secret directly (#1174), or the encoded username. If an attacker already knows about the secret, it is trivial to generate the tokens, so there is no harm in allowing the secret as a token, if users desire it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/374856324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/375040896","html_url":"https://github.com/apache/couchdb/issues/1227#issuecomment-375040896","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1227","id":375040896,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTA0MDg5Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-21T18:03:01Z","updated_at":"2018-03-21T18:03:01Z","author_association":"MEMBER","body":"This could be opt-in through a `vm.args` thing, perhaps, to prevent being disabled at run-time.\r\n\r\nAnd it could possibly log to a different file.\r\n\r\nUpdating the description to be clearer about the intent.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/375040896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/375044603","html_url":"https://github.com/apache/couchdb/pull/1228#issuecomment-375044603","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1228","id":375044603,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTA0NDYwMw==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-21T18:14:03Z","updated_at":"2018-03-21T18:14:03Z","author_association":"MEMBER","body":"this only addresses the dependency, I'd like to review it context of (presumably) the code that returns a clean error message when configuring a user or admin with a bcrypt hashed password.\r\n\r\nI also don't think this needs to be a generic mechanism, a \"--disable-bcrypt\" option at build time, say. If we add further such tweaks, we could invent a more general thing.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/375044603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/375069043","html_url":"https://github.com/apache/couchdb/pull/1228#issuecomment-375069043","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1228","id":375069043,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTA2OTA0Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-21T19:34:26Z","updated_at":"2018-03-21T19:34:26Z","author_association":"MEMBER","body":"The \"more general thing\" would be useful for things like optionally including geo/search at runtime. That could easily be extended to replace a `--disable-bcrypt` option. But for now a `./configure` flag would be sufficient, I think.\r\n\r\nAnd I agree that knowing what to do if only bcrypt-ed passwords are in `.ini` files and bcrypt is disabled would be important. :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/375069043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/375075943","html_url":"https://github.com/apache/couchdb/pull/1228#issuecomment-375075943","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1228","id":375075943,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTA3NTk0Mw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-03-21T19:58:31Z","updated_at":"2018-03-21T19:58:31Z","author_association":"CONTRIBUTOR","body":"70% done\r\n ```\r\ngit diff --stat\r\n configure                            |  8 ++++++++\r\n rebar.config.script                  | 18 +++++++++++++-----\r\n src/chttpd/src/chttpd_auth_cache.erl | 19 +++++++++++++++++--\r\n src/couch/rebar.config.script        |  3 +++\r\n src/couch/src/couch.app.src.script   |  4 +++-\r\n src/couch/src/couch_users_db.erl     |  5 ++++-\r\n 6 files changed, 48 insertions(+), 9 deletions(-)\r\n```\r\n\r\nToo complex and would require tests. Dropping it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/375075943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]