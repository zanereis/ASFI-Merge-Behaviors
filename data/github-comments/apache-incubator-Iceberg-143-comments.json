[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019718133","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1019718133","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1019718133,"node_id":"IC_kwDOCW7NX848x6n1","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T04:52:45Z","updated_at":"2022-01-24T04:52:45Z","author_association":"CONTRIBUTOR","body":"> > > > Looks weird, All these failed cases\r\n> > \r\n> > \r\n> > > >\r\n> > \r\n> > \r\n> > > > ```\r\n> > > > Caused by: org.apache.avro.InvalidAvroMagicException: Not an Avro data file\r\n> > > > ```\r\n> > \r\n> > \r\n> > > > ```\r\n> > > > \tat org.apache.avro.file.DataFileReader.openReader(DataFileReader.java:70)\r\n> > > > ```\r\n> > \r\n> > \r\n> > > > ```\r\n> > > > \tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:100)\r\n> > > > ```\r\n> > \r\n> > \r\n> > > >\r\n> > \r\n> > \r\n> > > \r\n> > \r\n> > \r\n> > > Yeah something wrong with the format matching? Odd, for example the one I looked at is failing because an ORC file is being read as an AVRO one.\r\n> > \r\n> > \r\n> > ```shell\r\n> > Error: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:91: Trailing whitespace is not allowed. [RegexpSinglelineJava]\r\n> > \r\n> > Error: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:91: Whitespace at end-of-line [RegexpSingleline]\r\n> > \r\n> > Error: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:105: Trailing whitespace is not allowed. [RegexpSinglelineJava]\r\n> > \r\n> > > Task :iceberg-data:checkstyleMain FAILED\r\n> > \r\n> > Error: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/data/src/main/java/org/apache/iceberg/data/TableMigrationUtil.java:105: Whitespace at end-of-line [RegexpSingleline]\r\n> > ```\r\n> > \r\n> > \r\n> >     \r\n> >       \r\n> >     \r\n> > \r\n> >       \r\n> >     \r\n> > \r\n> >     \r\n> >   \r\n> > can i just remove these two empty line?\r\n> \r\n> The empty line isn't the issue, the error would be white space before an end of line character\r\n\r\nA\r\n\r\n> > Looks weird, All these failed cases\r\n> > ```shell\r\n> >     Caused by: org.apache.avro.InvalidAvroMagicException: Not an Avro data file\r\n> >     \tat org.apache.avro.file.DataFileReader.openReader(DataFileReader.java:70)\r\n> >     \tat org.apache.iceberg.avro.AvroIterable.newFileReader(AvroIterable.java:100)\r\n> > ```\r\n> \r\n> Yeah something wrong with the format matching? Odd, for example the one I looked at is failing because an ORC file is being read as an AVRO one.\r\n\r\nthe  bug has fixed, and all tests has passed in my local enviroment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019718133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019864347","html_url":"https://github.com/apache/iceberg/pull/3947#issuecomment-1019864347","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3947","id":1019864347,"node_id":"IC_kwDOCW7NX848yeUb","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T09:00:40Z","updated_at":"2022-01-24T09:00:40Z","author_association":"CONTRIBUTOR","body":"> @pvary, it sounds like what you're saying is that you're generating a schema, then a name mapping, and then creating a table and want the table schema to match the name mapping. I think it makes the most sense to create the table, then base the name mapping on the schema, and then add it to the table. That way you don't rely on the IDs that you pass into create table -- the IDs passed in are reassigned and we make no guarantees about them.\r\n\r\nWouldn't this create a transiently invalid table? Also this would create an extra write to the S3 as we need to create a second metadata file.\r\n\r\nMaybe some other way to provide the mapping would be better.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019864347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019872087","html_url":"https://github.com/apache/iceberg/pull/3947#issuecomment-1019872087","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3947","id":1019872087,"node_id":"IC_kwDOCW7NX848ygNX","user":{"login":"boroknagyz","id":12861880,"node_id":"MDQ6VXNlcjEyODYxODgw","avatar_url":"https://avatars.githubusercontent.com/u/12861880?v=4","gravatar_id":"","url":"https://api.github.com/users/boroknagyz","html_url":"https://github.com/boroknagyz","followers_url":"https://api.github.com/users/boroknagyz/followers","following_url":"https://api.github.com/users/boroknagyz/following{/other_user}","gists_url":"https://api.github.com/users/boroknagyz/gists{/gist_id}","starred_url":"https://api.github.com/users/boroknagyz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boroknagyz/subscriptions","organizations_url":"https://api.github.com/users/boroknagyz/orgs","repos_url":"https://api.github.com/users/boroknagyz/repos","events_url":"https://api.github.com/users/boroknagyz/events{/privacy}","received_events_url":"https://api.github.com/users/boroknagyz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T09:08:52Z","updated_at":"2022-01-24T09:10:42Z","author_association":"CONTRIBUTOR","body":"Another thing is that you can create a partitioned Iceberg table in Hive by setting the table property 'iceberg.mr.table.partition.spec':\r\nhttps://github.com/apache/hive/blob/392c4f259ad57d746280790a21e560319ace4c8d/iceberg/iceberg-handler/src/test/queries/positive/describe_iceberg_table.q#L11\r\n\r\nTo define this property, the user has to be aware of details of the Iceberg specification, i.e. field ids, source ids, and so on. Without this change the user would need to use different ids than the ids assigned by Iceberg later, which I think can be very confusing.\r\n\r\nWe don't have the corresponding tests here I think, but in the Hive repo some tests would fail if Iceberg starts to use different field id assignment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019872087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019964736","html_url":"https://github.com/apache/iceberg/issues/3957#issuecomment-1019964736","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3957","id":1019964736,"node_id":"IC_kwDOCW7NX848y21A","user":{"login":"ubyyj","id":12639959,"node_id":"MDQ6VXNlcjEyNjM5OTU5","avatar_url":"https://avatars.githubusercontent.com/u/12639959?v=4","gravatar_id":"","url":"https://api.github.com/users/ubyyj","html_url":"https://github.com/ubyyj","followers_url":"https://api.github.com/users/ubyyj/followers","following_url":"https://api.github.com/users/ubyyj/following{/other_user}","gists_url":"https://api.github.com/users/ubyyj/gists{/gist_id}","starred_url":"https://api.github.com/users/ubyyj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ubyyj/subscriptions","organizations_url":"https://api.github.com/users/ubyyj/orgs","repos_url":"https://api.github.com/users/ubyyj/repos","events_url":"https://api.github.com/users/ubyyj/events{/privacy}","received_events_url":"https://api.github.com/users/ubyyj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T10:50:37Z","updated_at":"2022-01-24T10:50:37Z","author_association":"NONE","body":"filed to presto [here](https://github.com/trinodb/trino/issues/10758) close this one","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1019964736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020113510","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1020113510","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1020113510,"node_id":"IC_kwDOCW7NX848zbJm","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T13:41:42Z","updated_at":"2022-01-24T13:41:42Z","author_association":"MEMBER","body":"@kingeasternsun Thanks for the pr! Let me know if you add followups to specify the new parameter in \"addFiles\" or \"migrateTable\" code paths.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020113510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020123274","html_url":"https://github.com/apache/iceberg/pull/3933#issuecomment-1020123274","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3933","id":1020123274,"node_id":"IC_kwDOCW7NX848zdiK","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T13:52:45Z","updated_at":"2022-01-24T13:52:45Z","author_association":"MEMBER","body":"> @RussellSpitzer Sorry for the late reply. Yes, the fix is mostly for MigrationTableUtils. It is for this path `DataFiles.withPartitionPath` -> `DataFiles.fillFromPath` -> `Conversions.fromPartitionString`.\r\n> \r\n> After I took a look at `PartitionSpec`, I feel that timestamp is intentionally blocked in `Conversions.fromPartitionString`, because in `PartitionSpec Builder`, it has year, month, day, time, but no timestamp. I guess timestamp as a partition column is not supported because it doesn't have any real usages. However, creating table using timestamp as a partition column `CREATE TABLE test (id Integer, name String, dept String, ts Timestamp) USING iceberg PARTITIONED BY (ts)` can create the table successfully, but users don't know that the partition column `ts` is not working, so I feel that we probably should support partitioned by timestamp. If not, we probably should block creating table partitioned by timestamp.\r\n\r\nYep makes sense to me! Yufei and I were just discussing another bug which we thought might be related (it was not). I think this is fine to fix. I just want to make sure our string parsing is correct, from what I could tell the string that is generated for \"timestamp\" should be environment dependent since in the Hive code it just uses \"value.toString\". If we are confident that this covers most use cases I'm ok with merging.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020123274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020285847","html_url":"https://github.com/apache/iceberg/pull/3940#issuecomment-1020285847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3940","id":1020285847,"node_id":"IC_kwDOCW7NX8480FOX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T16:27:31Z","updated_at":"2022-01-24T16:27:31Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for the fix, @cccs-eric!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020285847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020351124","html_url":"https://github.com/apache/iceberg/pull/3887#issuecomment-1020351124","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3887","id":1020351124,"node_id":"IC_kwDOCW7NX8480VKU","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T17:24:45Z","updated_at":"2022-01-24T17:24:45Z","author_association":"CONTRIBUTOR","body":"Discussed with Kanou offline, it seems like the current way of exposing schema is too complex, and we will start simple and remove the partition spec part of it, and also remove some unnecessary annotations. Kanou will provide the update soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020351124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020393993","html_url":"https://github.com/apache/iceberg/pull/3760#issuecomment-1020393993","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3760","id":1020393993,"node_id":"IC_kwDOCW7NX8480foJ","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T18:11:13Z","updated_at":"2022-01-24T18:11:13Z","author_association":"COLLABORATOR","body":"Renamed issue to reflect other use cases that will hit this, following deeper look during our conversation","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020393993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020419778","html_url":"https://github.com/apache/iceberg/pull/3760#issuecomment-1020419778","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3760","id":1020419778,"node_id":"IC_kwDOCW7NX8480l7C","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T18:38:55Z","updated_at":"2022-01-24T18:38:55Z","author_association":"MEMBER","body":"Thanks @szehon-ho for the pr!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020419778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020422832","html_url":"https://github.com/apache/iceberg/pull/3760#issuecomment-1020422832","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3760","id":1020422832,"node_id":"IC_kwDOCW7NX8480mqw","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T18:42:31Z","updated_at":"2022-01-24T18:42:31Z","author_association":"COLLABORATOR","body":"Thanks for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020422832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020425579","html_url":"https://github.com/apache/iceberg/issues/2161#issuecomment-1020425579","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2161","id":1020425579,"node_id":"IC_kwDOCW7NX8480nVr","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T18:46:06Z","updated_at":"2022-01-24T18:46:06Z","author_association":"COLLABORATOR","body":"This issue fixed by linked PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020425579/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020439186","html_url":"https://github.com/apache/iceberg/pull/3908#issuecomment-1020439186","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3908","id":1020439186,"node_id":"IC_kwDOCW7NX8480qqS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:01:43Z","updated_at":"2022-01-24T19:01:43Z","author_association":"CONTRIBUTOR","body":"Thanks, @vanliu-tx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020439186/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020443337","html_url":"https://github.com/apache/iceberg/pull/3954#issuecomment-1020443337","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3954","id":1020443337,"node_id":"IC_kwDOCW7NX8480rrJ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:05:58Z","updated_at":"2022-01-24T19:05:58Z","author_association":"CONTRIBUTOR","body":"Nice work, thanks for fixing this, @CodingCat!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020443337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020445734","html_url":"https://github.com/apache/iceberg/pull/3943#issuecomment-1020445734","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3943","id":1020445734,"node_id":"IC_kwDOCW7NX8480sQm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:08:19Z","updated_at":"2022-01-24T19:08:19Z","author_association":"CONTRIBUTOR","body":"Thanks, @coolderli! Great to have this fixed.\r\n\r\nFYI @jackye1995, this is a bug to highlight in 0.13.0 release notes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020445734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020452529","html_url":"https://github.com/apache/iceberg/pull/3887#issuecomment-1020452529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3887","id":1020452529,"node_id":"IC_kwDOCW7NX8480t6x","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:15:31Z","updated_at":"2022-01-24T19:15:31Z","author_association":"CONTRIBUTOR","body":"thanks, mostly look good to me, I will verify the aws integration test while CI is running.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020452529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020465126","html_url":"https://github.com/apache/iceberg/pull/3933#issuecomment-1020465126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3933","id":1020465126,"node_id":"IC_kwDOCW7NX8480w_m","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:29:52Z","updated_at":"2022-01-24T19:29:52Z","author_association":"MEMBER","body":"https://github.com/apache/iceberg/blob/12bf61dace38d7468d80a6d8e71a3cc42ffdd363/api/src/main/java/org/apache/iceberg/PartitionSpec.java#L173-L186 // Iceberg Code (which escapes string value)\r\n\r\nhttps://github.com/apache/hive/blob/master/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/Warehouse.java#L[…]6 // Hive Code","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020465126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020467836","html_url":"https://github.com/apache/iceberg/pull/3914#issuecomment-1020467836","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3914","id":1020467836,"node_id":"IC_kwDOCW7NX8480xp8","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:33:11Z","updated_at":"2022-01-24T19:33:11Z","author_association":"MEMBER","body":"> Ok this all looks good to me. Going to merge unless I hear any other comments in the next hour or so.\r\n\r\n@pvary or @rdblue ? You commented on the issue earlier?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020467836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020471059","html_url":"https://github.com/apache/iceberg/issues/2796#issuecomment-1020471059","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2796","id":1020471059,"node_id":"IC_kwDOCW7NX8480ycT","user":{"login":"igorcalabria","id":2111602,"node_id":"MDQ6VXNlcjIxMTE2MDI=","avatar_url":"https://avatars.githubusercontent.com/u/2111602?v=4","gravatar_id":"","url":"https://api.github.com/users/igorcalabria","html_url":"https://github.com/igorcalabria","followers_url":"https://api.github.com/users/igorcalabria/followers","following_url":"https://api.github.com/users/igorcalabria/following{/other_user}","gists_url":"https://api.github.com/users/igorcalabria/gists{/gist_id}","starred_url":"https://api.github.com/users/igorcalabria/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/igorcalabria/subscriptions","organizations_url":"https://api.github.com/users/igorcalabria/orgs","repos_url":"https://api.github.com/users/igorcalabria/repos","events_url":"https://api.github.com/users/igorcalabria/events{/privacy}","received_events_url":"https://api.github.com/users/igorcalabria/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:37:07Z","updated_at":"2022-01-24T19:37:07Z","author_association":"NONE","body":"I can confirm that this happens pretty consistently when running `rewrite_manifests` action on a streaming table. Subsequent retries always seems to work","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020471059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020473915","html_url":"https://github.com/apache/iceberg/pull/3914#issuecomment-1020473915","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3914","id":1020473915,"node_id":"IC_kwDOCW7NX8480zI7","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:40:41Z","updated_at":"2022-01-24T19:40:41Z","author_association":"CONTRIBUTOR","body":"This looks good to me. Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020473915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020473982","html_url":"https://github.com/apache/iceberg/pull/3914#issuecomment-1020473982","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3914","id":1020473982,"node_id":"IC_kwDOCW7NX8480zJ-","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:40:46Z","updated_at":"2022-01-24T19:40:46Z","author_association":"CONTRIBUTOR","body":"My main requirement is that this is a one-way transfer only. UUID should not show up in Iceberg table properties. As long as that's the case, I'm fine with this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020473982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020482948","html_url":"https://github.com/apache/iceberg/pull/3887#issuecomment-1020482948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3887","id":1020482948,"node_id":"IC_kwDOCW7NX84801WE","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T19:51:20Z","updated_at":"2022-01-24T19:51:20Z","author_association":"CONTRIBUTOR","body":"confirmed AWS integ test successful. Waiting for CI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020482948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020490206","html_url":"https://github.com/apache/iceberg/pull/3914#issuecomment-1020490206","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3914","id":1020490206,"node_id":"IC_kwDOCW7NX84803He","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T20:00:05Z","updated_at":"2022-01-24T20:00:05Z","author_association":"CONTRIBUTOR","body":"> My main requirement is that this is a one-way transfer only. UUID should not show up in Iceberg table properties. As long as that's the case, I'm fine with this.\r\n\r\nYes. One-way. And it won't show up as an Iceberg table property.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020490206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020513093","html_url":"https://github.com/apache/iceberg/pull/3888#issuecomment-1020513093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3888","id":1020513093,"node_id":"IC_kwDOCW7NX84808tF","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T20:23:00Z","updated_at":"2022-01-24T20:23:00Z","author_association":"CONTRIBUTOR","body":"@natsukawa-kanou unit test failed, I think you need to fix old tests for this change","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020513093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020516390","html_url":"https://github.com/apache/iceberg/pull/3888#issuecomment-1020516390","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3888","id":1020516390,"node_id":"IC_kwDOCW7NX84809gm","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T20:26:26Z","updated_at":"2022-01-24T20:26:26Z","author_association":"CONTRIBUTOR","body":"thanks for the quick fix! overall looks good to me, running AWS integ test now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020516390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020516528","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1020516528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1020516528,"node_id":"IC_kwDOCW7NX84809iw","user":{"login":"nreich","id":960205,"node_id":"MDQ6VXNlcjk2MDIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/960205?v=4","gravatar_id":"","url":"https://api.github.com/users/nreich","html_url":"https://github.com/nreich","followers_url":"https://api.github.com/users/nreich/followers","following_url":"https://api.github.com/users/nreich/following{/other_user}","gists_url":"https://api.github.com/users/nreich/gists{/gist_id}","starred_url":"https://api.github.com/users/nreich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nreich/subscriptions","organizations_url":"https://api.github.com/users/nreich/orgs","repos_url":"https://api.github.com/users/nreich/repos","events_url":"https://api.github.com/users/nreich/events{/privacy}","received_events_url":"https://api.github.com/users/nreich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T20:26:35Z","updated_at":"2022-01-24T20:26:35Z","author_association":"NONE","body":"Using spark 3.2.0 and iceberg-spark-runtime-3.2_2.12 (0.13.0-SNAPSHOT, built locally from master today), I still see this issue (did try adding .config(\"spark.sql.sources.partitionOverwriteMode\", \"dynamic\") with no luck). Is this issue still present in current master or is there more configuration required to resolve the issue or possibly an issue with my local build?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020516528/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020522451","html_url":"https://github.com/apache/iceberg/pull/3914#issuecomment-1020522451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3914","id":1020522451,"node_id":"IC_kwDOCW7NX8480-_T","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T20:33:54Z","updated_at":"2022-01-24T20:33:54Z","author_association":"MEMBER","body":"> > My main requirement is that this is a one-way transfer only. UUID should not show up in Iceberg table properties. As long as that's the case, I'm fine with this.\r\n> \r\n> Yes. One-way. And it won't show up as an Iceberg table property.\r\n\r\nThis would require any future implementations that automatically try sync Hive properties back into Iceberg properties to ignore reserved properties, which is the behavior I think we are looking for here. Basically, any reserved properties can not be modified through normal property operations.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020522451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020528697","html_url":"https://github.com/apache/iceberg/pull/3914#issuecomment-1020528697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3914","id":1020528697,"node_id":"IC_kwDOCW7NX8481Ag5","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T20:42:02Z","updated_at":"2022-01-24T20:42:02Z","author_association":"MEMBER","body":"Thanks @flyrain and @karuppayya ! Note that this will introduce a slight backwards incompatibility as a user who has previously set UUID as a table property may run into some issues","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020528697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020553822","html_url":"https://github.com/apache/iceberg/pull/3450#issuecomment-1020553822","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3450","id":1020553822,"node_id":"IC_kwDOCW7NX8481Gpe","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T21:15:19Z","updated_at":"2022-01-24T21:15:19Z","author_association":"COLLABORATOR","body":"@rdblue @samredai  I updated the PR according to the comments. Can you take another look? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020553822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020566477","html_url":"https://github.com/apache/iceberg/pull/3888#issuecomment-1020566477","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3888","id":1020566477,"node_id":"IC_kwDOCW7NX8481JvN","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T21:28:48Z","updated_at":"2022-01-24T21:28:48Z","author_association":"CONTRIBUTOR","body":"AWS integ test passes and CI passes, approving","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020566477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020585247","html_url":"https://github.com/apache/iceberg/pull/3945#issuecomment-1020585247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3945","id":1020585247,"node_id":"IC_kwDOCW7NX8481OUf","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T21:53:25Z","updated_at":"2022-01-24T21:53:25Z","author_association":"CONTRIBUTOR","body":"Let me take a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020585247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020594076","html_url":"https://github.com/apache/iceberg/pull/3964#issuecomment-1020594076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3964","id":1020594076,"node_id":"IC_kwDOCW7NX8481Qec","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T22:05:26Z","updated_at":"2022-01-24T22:05:26Z","author_association":"CONTRIBUTOR","body":"All of the cases in the comment look correct to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020594076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020611756","html_url":"https://github.com/apache/iceberg/pull/3407#issuecomment-1020611756","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3407","id":1020611756,"node_id":"IC_kwDOCW7NX8481Uys","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T22:25:44Z","updated_at":"2022-01-24T22:25:44Z","author_association":"COLLABORATOR","body":"@nssalian BTW, you may also check if the unit test coverage is good enough to pass the threshold.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020611756/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020636435","html_url":"https://github.com/apache/iceberg/pull/3967#issuecomment-1020636435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3967","id":1020636435,"node_id":"IC_kwDOCW7NX8481a0T","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T23:02:58Z","updated_at":"2022-01-24T23:02:58Z","author_association":"CONTRIBUTOR","body":"thanks, this overall looks good to me, checking AWS integ test ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020636435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020656072","html_url":"https://github.com/apache/iceberg/pull/3967#issuecomment-1020656072","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3967","id":1020656072,"node_id":"IC_kwDOCW7NX8481fnI","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T23:29:48Z","updated_at":"2022-01-24T23:29:48Z","author_association":"CONTRIBUTOR","body":"TestGlueCatalogLock fails. I think the issue is that we are not explicitly catching CommitFailedException and it is now falling to the RuntimeException category and identified as unknown status.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020656072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020659446","html_url":"https://github.com/apache/iceberg/pull/3967#issuecomment-1020659446","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3967","id":1020659446,"node_id":"IC_kwDOCW7NX8481gb2","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T23:36:14Z","updated_at":"2022-01-24T23:36:14Z","author_association":"CONTRIBUTOR","body":"Please keep the original `testFailedCommit` to check the CommitFailedException case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020659446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020667500","html_url":"https://github.com/apache/iceberg/pull/3967#issuecomment-1020667500","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3967","id":1020667500,"node_id":"IC_kwDOCW7NX8481iZs","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T23:53:37Z","updated_at":"2022-01-24T23:53:37Z","author_association":"CONTRIBUTOR","body":"thanks, running integ test now","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020667500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020667658","html_url":"https://github.com/apache/iceberg/pull/3967#issuecomment-1020667658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3967","id":1020667658,"node_id":"IC_kwDOCW7NX8481icK","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-24T23:53:55Z","updated_at":"2022-01-24T23:53:55Z","author_association":"CONTRIBUTOR","body":"Also updating the title to fit the content better","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020667658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020710238","html_url":"https://github.com/apache/iceberg/pull/3967#issuecomment-1020710238","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3967","id":1020710238,"node_id":"IC_kwDOCW7NX8481s1e","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T01:14:51Z","updated_at":"2022-01-25T01:14:51Z","author_association":"CONTRIBUTOR","body":"Thanks, merged!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020710238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020717082","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1020717082","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1020717082,"node_id":"IC_kwDOCW7NX8481uga","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T01:28:18Z","updated_at":"2022-01-25T01:28:18Z","author_association":"CONTRIBUTOR","body":"> @kingeasternsun Thanks for the pr! Let me know if you add followups to specify the new parameter in \"addFiles\" or \"migrateTable\" code paths.\r\n\r\n ✨  Yes, I'm Doing ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020717082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020721982","html_url":"https://github.com/apache/iceberg/issues/3907#issuecomment-1020721982","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3907","id":1020721982,"node_id":"IC_kwDOCW7NX8481vs-","user":{"login":"vanliu-tx","id":64360028,"node_id":"MDQ6VXNlcjY0MzYwMDI4","avatar_url":"https://avatars.githubusercontent.com/u/64360028?v=4","gravatar_id":"","url":"https://api.github.com/users/vanliu-tx","html_url":"https://github.com/vanliu-tx","followers_url":"https://api.github.com/users/vanliu-tx/followers","following_url":"https://api.github.com/users/vanliu-tx/following{/other_user}","gists_url":"https://api.github.com/users/vanliu-tx/gists{/gist_id}","starred_url":"https://api.github.com/users/vanliu-tx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanliu-tx/subscriptions","organizations_url":"https://api.github.com/users/vanliu-tx/orgs","repos_url":"https://api.github.com/users/vanliu-tx/repos","events_url":"https://api.github.com/users/vanliu-tx/events{/privacy}","received_events_url":"https://api.github.com/users/vanliu-tx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T01:39:27Z","updated_at":"2022-01-25T01:39:27Z","author_association":"CONTRIBUTOR","body":"done","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020721982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020755816","html_url":"https://github.com/apache/iceberg/pull/3691#issuecomment-1020755816","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3691","id":1020755816,"node_id":"IC_kwDOCW7NX848139o","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T02:48:01Z","updated_at":"2022-01-25T02:48:01Z","author_association":"CONTRIBUTOR","body":"> This seems to require https://pypi.org/project/typing-extensions/ for python <= 3.7\r\n\r\nIn some of the original design discussions, the idea was that we would stick with the [NEP 29 deprecation policy](https://numpy.org/neps/nep-0029-deprecation_policy.html) so we wouldn't be supporting python versions <= 3.7, @jun-he does that sound right?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020755816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020773464","html_url":"https://github.com/apache/iceberg/pull/3970#issuecomment-1020773464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3970","id":1020773464,"node_id":"IC_kwDOCW7NX84818RY","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T03:24:16Z","updated_at":"2022-01-25T03:24:16Z","author_association":"CONTRIBUTOR","body":"Looks good now. +1 when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020773464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020781584","html_url":"https://github.com/apache/iceberg/pull/3365#issuecomment-1020781584","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3365","id":1020781584,"node_id":"IC_kwDOCW7NX8481-QQ","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T03:45:25Z","updated_at":"2022-01-25T06:23:13Z","author_association":"CONTRIBUTOR","body":"Hi @openinx, I am still seeing this error in CI sometimes, I think this is maybe caused by the way `notifyCheckpointComplete` works in IcebergFilesCommitter:\r\n```\r\npublic void notifyCheckpointComplete(long checkpointId) throws Exception {\r\n    super.notifyCheckpointComplete(checkpointId);\r\n    // It's possible that we have the following events:\r\n    //   1. snapshotState(ckpId);\r\n    //   2. snapshotState(ckpId+1);\r\n    //   3. notifyCheckpointComplete(ckpId+1);\r\n    //   4. notifyCheckpointComplete(ckpId);\r\n    // For step#4, we don't need to commit iceberg table again because in step#3 we've committed all the files,\r\n    // Besides, we need to maintain the max-committed-checkpoint-id to be increasing.\r\n    if (checkpointId > maxCommittedCheckpointId) {\r\n      commitUpToCheckpoint(dataFilesPerCheckpoint, flinkJobId, checkpointId);\r\n      this.maxCommittedCheckpointId = checkpointId;\r\n    }\r\n  }\r\n``` \r\nMy understanding is that not every ckpt of Flink corresponds to a commit in Iceberg, sometimes a snapshot may contains data files of several ckpts. And the checkpoint interval (400 ms) here is rather small, which makes this situation very likely. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020781584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020782807","html_url":"https://github.com/apache/iceberg/issues/3909#issuecomment-1020782807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3909","id":1020782807,"node_id":"IC_kwDOCW7NX8481-jX","user":{"login":"fengsen-neu","id":58256617,"node_id":"MDQ6VXNlcjU4MjU2NjE3","avatar_url":"https://avatars.githubusercontent.com/u/58256617?v=4","gravatar_id":"","url":"https://api.github.com/users/fengsen-neu","html_url":"https://github.com/fengsen-neu","followers_url":"https://api.github.com/users/fengsen-neu/followers","following_url":"https://api.github.com/users/fengsen-neu/following{/other_user}","gists_url":"https://api.github.com/users/fengsen-neu/gists{/gist_id}","starred_url":"https://api.github.com/users/fengsen-neu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengsen-neu/subscriptions","organizations_url":"https://api.github.com/users/fengsen-neu/orgs","repos_url":"https://api.github.com/users/fengsen-neu/repos","events_url":"https://api.github.com/users/fengsen-neu/events{/privacy}","received_events_url":"https://api.github.com/users/fengsen-neu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T03:48:24Z","updated_at":"2022-01-25T03:48:24Z","author_association":"NONE","body":"> A large amount of memory is used because each datafile will read all the data of the deletefile which seqNum is bigger than datafile in a hashSet for filtering, But only those keys that are also in the datafile are necessary to read , In the optimized version of my company , I use a bloom filter of datafile's keys to filter out unnecessary eq-deletefile keys (hashset of datafile's keys also works, but using hashset usually consumes more memory) , if the datafile support storage Bloom filter Such as using parquet format based on #2642 ，It's easier to read bloom filters directly from a datafile. maybe I can pull a request if need.\r\n\r\nIt's easier to read bloom filters directly from a datafile. maybe I can pull a request if need. --- Could you please provide the PR for my reference?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020782807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020815246","html_url":"https://github.com/apache/iceberg/pull/3517#issuecomment-1020815246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3517","id":1020815246,"node_id":"IC_kwDOCW7NX8482GeO","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T05:04:58Z","updated_at":"2022-01-25T05:04:58Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue @kbendick @RussellSpitzer Request you to please review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020815246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020830310","html_url":"https://github.com/apache/iceberg/pull/3365#issuecomment-1020830310","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3365","id":1020830310,"node_id":"IC_kwDOCW7NX8482KJm","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T05:37:54Z","updated_at":"2022-01-25T05:50:13Z","author_association":"CONTRIBUTOR","body":"https://github.com/apache/iceberg/blob/ca46fc93ae9a349e3920d0519ccf0f41e7210d44/flink/v1.14/flink/src/main/java/org/apache/iceberg/flink/sink/IcebergFilesCommitter.java#L261-L277\r\nResults of ckpts without delete file will be merged into one transaction.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020830310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020896240","html_url":"https://github.com/apache/iceberg/pull/2660#issuecomment-1020896240","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2660","id":1020896240,"node_id":"IC_kwDOCW7NX8482aPw","user":{"login":"davseitsev","id":1793410,"node_id":"MDQ6VXNlcjE3OTM0MTA=","avatar_url":"https://avatars.githubusercontent.com/u/1793410?v=4","gravatar_id":"","url":"https://api.github.com/users/davseitsev","html_url":"https://github.com/davseitsev","followers_url":"https://api.github.com/users/davseitsev/followers","following_url":"https://api.github.com/users/davseitsev/following{/other_user}","gists_url":"https://api.github.com/users/davseitsev/gists{/gist_id}","starred_url":"https://api.github.com/users/davseitsev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davseitsev/subscriptions","organizations_url":"https://api.github.com/users/davseitsev/orgs","repos_url":"https://api.github.com/users/davseitsev/repos","events_url":"https://api.github.com/users/davseitsev/events{/privacy}","received_events_url":"https://api.github.com/users/davseitsev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T07:45:57Z","updated_at":"2022-01-25T07:45:57Z","author_association":"NONE","body":"@SreeramGarlapati  thank you very much for your work. I have a few questions.\r\n\r\nWe have Spark streaming job which reads data from Kafka, process it and store to iceberg table partitioned by day.\r\nThere is a background compaction process and scheduled cleanup task that expires old snapshots to remove old small files.\r\nI want to build another streaming job that reads a few tables produced by first job, unions them, filters necessary rows and stores data to iceberg table.\r\nThus I'd like to understand better how expired snapshots are handled.\r\n\r\nIn our case source table contains `append` and `replace` snapshots.\r\n`MicroBatchStream.initialOffset()` always returns `StreamingOffset` with `scanAllFiles=true` to process historical data. As old snapshots are expired by cleanup process we can get into the case when first snapshot is of type `replace`.  Due to #2752 we ignore `replace` snapshots. Will it lead to the situation when we skip initial snapshot with `scanAllFiles=true` and loose all data appended in old (expired) snapshots?\r\n\r\nAnd one more question.\r\nLet's say have data in source table for 1 year, expire snapshots older than 7 days and cleanup job runs every 1 hour.\r\nIf a job starts reading this table from initial offset it has at most 1 hour to process first snapshot, doesn't it? As initial snapshot is processed with `scanAllFiles=true`, it's the biggest one because it contains data for 1 year minus 7 days. If I'm correct, there is a big chance that streaming job will fail in the middle when cleanup job runs. Because it will expire the snapshot which is processed by streaming job.\r\nWould it work if `initialOffset()` returns latest snapshot with flag `scanAllFiles` instead of first snapshot?:\r\n- `latestOffset()` -> [LatestSnapshot, LatestFile, false]\r\n- `initialOffset()` -> [LatestSnapshot, 0, true]\r\nProbably in this case we should have 7 days to process initial snapshot.\r\n\r\nAre there any other corner cases with snapshots expiration?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020896240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020904201","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1020904201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1020904201,"node_id":"IC_kwDOCW7NX8482cMJ","user":{"login":"humengyu2012","id":45056332,"node_id":"MDQ6VXNlcjQ1MDU2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/45056332?v=4","gravatar_id":"","url":"https://api.github.com/users/humengyu2012","html_url":"https://github.com/humengyu2012","followers_url":"https://api.github.com/users/humengyu2012/followers","following_url":"https://api.github.com/users/humengyu2012/following{/other_user}","gists_url":"https://api.github.com/users/humengyu2012/gists{/gist_id}","starred_url":"https://api.github.com/users/humengyu2012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humengyu2012/subscriptions","organizations_url":"https://api.github.com/users/humengyu2012/orgs","repos_url":"https://api.github.com/users/humengyu2012/repos","events_url":"https://api.github.com/users/humengyu2012/events{/privacy}","received_events_url":"https://api.github.com/users/humengyu2012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T07:58:36Z","updated_at":"2022-01-25T07:58:36Z","author_association":"NONE","body":"\r\n> Could TestTables.createHiveTableSQL help here?\r\n\r\n![image](https://user-images.githubusercontent.com/45056332/150929210-e73844bc-d955-4cf6-abab-978f8d43328d.png)\r\n@pvary TestTables.createHiveTableSQL can not set columns, but I need some hive columns to test. Could I continue to use sql?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020904201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020940450","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1020940450","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1020940450,"node_id":"IC_kwDOCW7NX8482lCi","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T08:46:49Z","updated_at":"2022-01-25T08:46:49Z","author_association":"CONTRIBUTOR","body":"\r\n\r\n\r\n\r\n> > Could TestTables.createHiveTableSQL help here?\r\n> \r\n> ![image](https://user-images.githubusercontent.com/45056332/150929210-e73844bc-d955-4cf6-abab-978f8d43328d.png) @pvary TestTables.createHiveTableSQL can not set columns, but I need some hive columns to test. Could I continue to use sql?\r\n\r\nGood point. We might want to add a new method to the TestTables then, but if handling column types is too complicated, then at least create a local test method, so we do not duplicate the code.\r\nWe might also want to test having column names matching nested field names too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1020940450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021223012","html_url":"https://github.com/apache/iceberg/pull/3952#issuecomment-1021223012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3952","id":1021223012,"node_id":"IC_kwDOCW7NX8483qBk","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T14:13:22Z","updated_at":"2022-01-25T14:13:22Z","author_association":"CONTRIBUTOR","body":"@rdblue I definitely agree with your comments. Overall, I feel like the state from the previous types PR into this one of having `Integer()` as the method to get a type is pretty ugly and unnecessary. This PR was meant as a stepping stone to something more akin to true generics. I'm thinking that a lot of the hangup for the true sort of generics was me having tried to mix literals in with types to consolidate them, so I've taken a big step backwards and removed all literal functionality while also slimming down the generics implementation. Please have a look at https://github.com/apache/iceberg/pull/3981 to compare","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021223012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021319323","html_url":"https://github.com/apache/iceberg/pull/3275#issuecomment-1021319323","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3275","id":1021319323,"node_id":"IC_kwDOCW7NX8484Bib","user":{"login":"nssalian","id":8526007,"node_id":"MDQ6VXNlcjg1MjYwMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8526007?v=4","gravatar_id":"","url":"https://api.github.com/users/nssalian","html_url":"https://github.com/nssalian","followers_url":"https://api.github.com/users/nssalian/followers","following_url":"https://api.github.com/users/nssalian/following{/other_user}","gists_url":"https://api.github.com/users/nssalian/gists{/gist_id}","starred_url":"https://api.github.com/users/nssalian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nssalian/subscriptions","organizations_url":"https://api.github.com/users/nssalian/orgs","repos_url":"https://api.github.com/users/nssalian/repos","events_url":"https://api.github.com/users/nssalian/events{/privacy}","received_events_url":"https://api.github.com/users/nssalian/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T15:40:30Z","updated_at":"2022-01-25T15:40:30Z","author_association":"CONTRIBUTOR","body":"@kbendick @rdblue , checking if you have a chance to review this to get this across and merged. I can rebase after you've had a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021319323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021372289","html_url":"https://github.com/apache/iceberg/pull/3188#issuecomment-1021372289","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3188","id":1021372289,"node_id":"IC_kwDOCW7NX8484OeB","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T16:27:37Z","updated_at":"2022-01-25T16:27:37Z","author_association":"MEMBER","body":"@rdblue @anjalinorwood @jacques-n @jackye1995 Are we ready to merge this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021372289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021438948","html_url":"https://github.com/apache/iceberg/pull/3813#issuecomment-1021438948","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3813","id":1021438948,"node_id":"IC_kwDOCW7NX8484evk","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T17:33:51Z","updated_at":"2022-01-25T17:33:51Z","author_association":"CONTRIBUTOR","body":"LGTM, just waiting on checks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021438948/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021469134","html_url":"https://github.com/apache/iceberg/issues/3941#issuecomment-1021469134","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3941","id":1021469134,"node_id":"IC_kwDOCW7NX8484mHO","user":{"login":"SreeramGarlapati","id":11813428,"node_id":"MDQ6VXNlcjExODEzNDI4","avatar_url":"https://avatars.githubusercontent.com/u/11813428?v=4","gravatar_id":"","url":"https://api.github.com/users/SreeramGarlapati","html_url":"https://github.com/SreeramGarlapati","followers_url":"https://api.github.com/users/SreeramGarlapati/followers","following_url":"https://api.github.com/users/SreeramGarlapati/following{/other_user}","gists_url":"https://api.github.com/users/SreeramGarlapati/gists{/gist_id}","starred_url":"https://api.github.com/users/SreeramGarlapati/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SreeramGarlapati/subscriptions","organizations_url":"https://api.github.com/users/SreeramGarlapati/orgs","repos_url":"https://api.github.com/users/SreeramGarlapati/repos","events_url":"https://api.github.com/users/SreeramGarlapati/events{/privacy}","received_events_url":"https://api.github.com/users/SreeramGarlapati/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T18:09:56Z","updated_at":"2022-01-25T18:09:56Z","author_association":"COLLABORATOR","body":"@flyrain - we [started this design doc, which scopes the problem down to the tables that are written with MoR](https://docs.google.com/document/d/1A2oXgzMOhldSdpxhVnuRNYKozAaTAn3zWfE1LIeFLVs/edit?usp=sharing), a while back - after a community sync up. pl. see if you wanna adapt it or even change the same doc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021469134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021490735","html_url":"https://github.com/apache/iceberg/pull/3959#issuecomment-1021490735","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3959","id":1021490735,"node_id":"IC_kwDOCW7NX8484rYv","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T18:35:41Z","updated_at":"2022-01-25T18:35:41Z","author_association":"MEMBER","body":"@danielcweeks When we discussed this were you thinking about no metrics for tables with more than 100 columns? or no metrics for anything other than the first 100 columns.\r\n\r\nObviously in both cases we keep sort column metrics by default","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021490735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021596588","html_url":"https://github.com/apache/iceberg/pull/3813#issuecomment-1021596588","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3813","id":1021596588,"node_id":"IC_kwDOCW7NX8485FOs","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T20:50:49Z","updated_at":"2022-01-25T20:50:49Z","author_association":"CONTRIBUTOR","body":"Thanks @SinghAsDev !!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021596588/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021621574","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021621574","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021621574,"node_id":"IC_kwDOCW7NX8485LVG","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T21:23:27Z","updated_at":"2022-01-25T21:24:01Z","author_association":"CONTRIBUTOR","body":"@nreich, could you, please, provide the full stack trace on 3.2.0 and master? Like others said, Iceberg 0.12 extensions are not compatible with Spark 3.2 but the master and upcoming 0.13 should be.\r\n\r\nAre you using PySpark?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021621574/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021656224","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021656224","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021656224,"node_id":"IC_kwDOCW7NX8485Tyg","user":{"login":"nreich","id":960205,"node_id":"MDQ6VXNlcjk2MDIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/960205?v=4","gravatar_id":"","url":"https://api.github.com/users/nreich","html_url":"https://github.com/nreich","followers_url":"https://api.github.com/users/nreich/followers","following_url":"https://api.github.com/users/nreich/following{/other_user}","gists_url":"https://api.github.com/users/nreich/gists{/gist_id}","starred_url":"https://api.github.com/users/nreich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nreich/subscriptions","organizations_url":"https://api.github.com/users/nreich/orgs","repos_url":"https://api.github.com/users/nreich/repos","events_url":"https://api.github.com/users/nreich/events{/privacy}","received_events_url":"https://api.github.com/users/nreich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T22:09:43Z","updated_at":"2022-01-25T22:09:43Z","author_association":"NONE","body":"@aokolnychyi I tested again today with spark 3.2.0 and iceberg 0.13.0 release candidate (downloaded jars from repository.apache.org/content/repositories/orgapacheiceberg-1079/org/apache/iceberg/iceberg-spark3-runtime/0.13.0/). Tried to run through the \"getting started\" guide for spark-sql.\r\nMy spark-sql startup command (also tried with `spark.sql.sources.partitionOverwriteMode=dynamic`):\r\n```\r\nbin/spark-sql --packages org.apache.iceberg:iceberg-spark3-runtime:0.13.0  \\\r\n    --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions \\\r\n    --conf spark.sql.catalog.spark_catalog=org.apache.iceberg.spark.SparkSessionCatalog  \\\r\n    --conf spark.sql.catalog.spark_catalog.type=hive  \\\r\n    --conf spark.sql.catalog.local=org.apache.iceberg.spark.SparkCatalog \\\r\n    --conf spark.sql.catalog.local.type=hadoop  \\\r\n    --conf spark.sql.catalog.local.warehouse=/tmp/iceberg/warehouse\r\n```\r\nRunning any query (but for example, `CREATE TABLE local.db.table (id bigint, data string) USING iceberg`). Resulted in this stack trace:\r\n```\r\nERROR SparkSQLDriver: Failed in [CREATE TABLE local.db.table (id bigint, data string) USING iceberg\r\n]\r\njava.lang.IncompatibleClassChangeError: class org.apache.spark.sql.catalyst.plans.logical.DynamicFileFilterWithCardinalityCheck has interface org.apache.spark.sql.catalyst.plans.logical.BinaryNode as super class\r\n\tat java.base/java.lang.ClassLoader.defineClass1(Native Method)\r\n\tat java.base/java.lang.ClassLoader.defineClass(ClassLoader.java:1017)\r\n\tat java.base/java.security.SecureClassLoader.defineClass(SecureClassLoader.java:174)\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.defineClass(BuiltinClassLoader.java:800)\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.findClassOnClassPathOrNull(BuiltinClassLoader.java:698)\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.loadClassOrNull(BuiltinClassLoader.java:621)\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:579)\r\n\tat java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178)\r\n\tat java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:522)\r\n\tat org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions.$anonfun$apply$8(IcebergSparkSessionExtensions.scala:50)\r\n\tat org.apache.spark.sql.SparkSessionExtensions.$anonfun$buildOptimizerRules$1(SparkSessionExtensions.scala:201)\r\n\tat scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:286)\r\n\tat scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)\r\n\tat scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)\r\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)\r\n\tat scala.collection.TraversableLike.map(TraversableLike.scala:286)\r\n\tat scala.collection.TraversableLike.map$(TraversableLike.scala:279)\r\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:108)\r\n\tat org.apache.spark.sql.SparkSessionExtensions.buildOptimizerRules(SparkSessionExtensions.scala:201)\r\n\tat org.apache.spark.sql.internal.BaseSessionStateBuilder.customOperatorOptimizationRules(BaseSessionStateBuilder.scala:259)\r\n\tat org.apache.spark.sql.internal.BaseSessionStateBuilder$$anon$2.extendedOperatorOptimizationRules(BaseSessionStateBuilder.scala:248)\r\n\tat org.apache.spark.sql.catalyst.optimizer.Optimizer.defaultBatches(Optimizer.scala:130)\r\n\tat org.apache.spark.sql.execution.SparkOptimizer.defaultBatches(SparkOptimizer.scala:42)\r\n\tat org.apache.spark.sql.catalyst.optimizer.Optimizer.batches(Optimizer.scala:382)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:200)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$executeAndTrack$1(RuleExecutor.scala:179)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:88)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.executeAndTrack(RuleExecutor.scala:179)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$optimizedPlan$1(QueryExecution.scala:138)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:196)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:196)\r\n\tat org.apache.spark.sql.execution.QueryExecution.optimizedPlan$lzycompute(QueryExecution.scala:134)\r\n\tat org.apache.spark.sql.execution.QueryExecution.optimizedPlan(QueryExecution.scala:130)\r\n\tat org.apache.spark.sql.execution.QueryExecution.assertOptimized(QueryExecution.scala:148)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executedPlan$1(QueryExecution.scala:166)\r\n\tat org.apache.spark.sql.execution.QueryExecution.withCteMap(QueryExecution.scala:73)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executedPlan$lzycompute(QueryExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executedPlan(QueryExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.QueryExecution.simpleString(QueryExecution.scala:214)\r\n\tat org.apache.spark.sql.execution.QueryExecution.org$apache$spark$sql$execution$QueryExecution$$explainString(QueryExecution.scala:259)\r\n\tat org.apache.spark.sql.execution.QueryExecution.explainString(QueryExecution.scala:228)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:98)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:106)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:481)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:82)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:481)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:457)\r\n\tat org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:106)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:93)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:91)\r\n\tat org.apache.spark.sql.Dataset.<init>(Dataset.scala:219)\r\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:99)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:96)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:618)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:613)\r\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:651)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLDriver.run(SparkSQLDriver.scala:67)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processCmd(SparkSQLCLIDriver.scala:384)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1(SparkSQLCLIDriver.scala:504)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1$adapted(SparkSQLCLIDriver.scala:498)\r\n\tat scala.collection.Iterator.foreach(Iterator.scala:943)\r\n\tat scala.collection.Iterator.foreach$(Iterator.scala:943)\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\r\n\tat scala.collection.IterableLike.foreach(IterableLike.scala:74)\r\n\tat scala.collection.IterableLike.foreach$(IterableLike.scala:73)\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:56)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processLine(SparkSQLCLIDriver.scala:498)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver$.main(SparkSQLCLIDriver.scala:287)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.main(SparkSQLCLIDriver.scala)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\r\n\tat org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:955)\r\n\tat org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)\r\n\tat org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)\r\n\tat org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)\r\n\tat org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1043)\r\n\tat org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1052)\r\n\tat org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\r\njava.lang.IncompatibleClassChangeError: class org.apache.spark.sql.catalyst.plans.logical.DynamicFileFilterWithCardinalityCheck has interface org.apache.spark.sql.catalyst.plans.logical.BinaryNode as super class\r\n\tat java.base/java.lang.ClassLoader.defineClass1(Native Method)\r\n\tat java.base/java.lang.ClassLoader.defineClass(ClassLoader.java:1017)\r\n\tat java.base/java.security.SecureClassLoader.defineClass(SecureClassLoader.java:174)\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.defineClass(BuiltinClassLoader.java:800)\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.findClassOnClassPathOrNull(BuiltinClassLoader.java:698)\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.loadClassOrNull(BuiltinClassLoader.java:621)\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:579)\r\n\tat java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178)\r\n\tat java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:522)\r\n\tat org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions.$anonfun$apply$8(IcebergSparkSessionExtensions.scala:50)\r\n\tat org.apache.spark.sql.SparkSessionExtensions.$anonfun$buildOptimizerRules$1(SparkSessionExtensions.scala:201)\r\n\tat scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:286)\r\n\tat scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)\r\n\tat scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)\r\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)\r\n\tat scala.collection.TraversableLike.map(TraversableLike.scala:286)\r\n\tat scala.collection.TraversableLike.map$(TraversableLike.scala:279)\r\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:108)\r\n\tat org.apache.spark.sql.SparkSessionExtensions.buildOptimizerRules(SparkSessionExtensions.scala:201)\r\n\tat org.apache.spark.sql.internal.BaseSessionStateBuilder.customOperatorOptimizationRules(BaseSessionStateBuilder.scala:259)\r\n\tat org.apache.spark.sql.internal.BaseSessionStateBuilder$$anon$2.extendedOperatorOptimizationRules(BaseSessionStateBuilder.scala:248)\r\n\tat org.apache.spark.sql.catalyst.optimizer.Optimizer.defaultBatches(Optimizer.scala:130)\r\n\tat org.apache.spark.sql.execution.SparkOptimizer.defaultBatches(SparkOptimizer.scala:42)\r\n\tat org.apache.spark.sql.catalyst.optimizer.Optimizer.batches(Optimizer.scala:382)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:200)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$executeAndTrack$1(RuleExecutor.scala:179)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:88)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.executeAndTrack(RuleExecutor.scala:179)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$optimizedPlan$1(QueryExecution.scala:138)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:196)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:196)\r\n\tat org.apache.spark.sql.execution.QueryExecution.optimizedPlan$lzycompute(QueryExecution.scala:134)\r\n\tat org.apache.spark.sql.execution.QueryExecution.optimizedPlan(QueryExecution.scala:130)\r\n\tat org.apache.spark.sql.execution.QueryExecution.assertOptimized(QueryExecution.scala:148)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executedPlan$1(QueryExecution.scala:166)\r\n\tat org.apache.spark.sql.execution.QueryExecution.withCteMap(QueryExecution.scala:73)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executedPlan$lzycompute(QueryExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executedPlan(QueryExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.QueryExecution.simpleString(QueryExecution.scala:214)\r\n\tat org.apache.spark.sql.execution.QueryExecution.org$apache$spark$sql$execution$QueryExecution$$explainString(QueryExecution.scala:259)\r\n\tat org.apache.spark.sql.execution.QueryExecution.explainString(QueryExecution.scala:228)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$5(SQLExecution.scala:98)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:163)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:90)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:64)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:110)\r\n\tat org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:106)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:481)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:82)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:481)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:30)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:457)\r\n\tat org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:106)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:93)\r\n\tat org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:91)\r\n\tat org.apache.spark.sql.Dataset.<init>(Dataset.scala:219)\r\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:99)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:96)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:618)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:613)\r\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:651)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLDriver.run(SparkSQLDriver.scala:67)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processCmd(SparkSQLCLIDriver.scala:384)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1(SparkSQLCLIDriver.scala:504)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1$adapted(SparkSQLCLIDriver.scala:498)\r\n\tat scala.collection.Iterator.foreach(Iterator.scala:943)\r\n\tat scala.collection.Iterator.foreach$(Iterator.scala:943)\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\r\n\tat scala.collection.IterableLike.foreach(IterableLike.scala:74)\r\n\tat scala.collection.IterableLike.foreach$(IterableLike.scala:73)\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:56)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processLine(SparkSQLCLIDriver.scala:498)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver$.main(SparkSQLCLIDriver.scala:287)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.main(SparkSQLCLIDriver.scala)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\r\n\tat org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:955)\r\n\tat org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)\r\n\tat org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)\r\n\tat org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)\r\n\tat org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1043)\r\n\tat org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1052)\r\n\tat org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021656224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021702516","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021702516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021702516,"node_id":"IC_kwDOCW7NX8485fF0","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T23:23:01Z","updated_at":"2022-01-25T23:23:01Z","author_association":"CONTRIBUTOR","body":"@nreich, can you check the Jar you used? For Spark 3.2, you should be using the [`iceberg-spark-runtime-3.2_2.12` Jar](https://repository.apache.org/content/repositories/orgapacheiceberg-1079/org/apache/iceberg/iceberg-spark-runtime-3.2_2.12/) but the link you posted was to the `iceberg-spark3-runtime` Jar. That's one works with 3.0 and 3.1, but we're moving to separate Jars for each Iceberg version.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021702516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021715031","html_url":"https://github.com/apache/iceberg/pull/3952#issuecomment-1021715031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3952","id":1021715031,"node_id":"IC_kwDOCW7NX8485iJX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T23:45:48Z","updated_at":"2022-01-25T23:45:48Z","author_association":"CONTRIBUTOR","body":"Thanks @CircArgs! I'm excited to take a look at the next steps in #3981. I'll hopefully get a chance soon!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021715031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021720639","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021720639","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021720639,"node_id":"IC_kwDOCW7NX8485jg_","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-25T23:58:13Z","updated_at":"2022-01-25T23:58:13Z","author_association":"CONTRIBUTOR","body":"**_As of Iceberg 0.13.0, the `iceberg-spark-runtime` jars have changed to reflect the Spark (and Scala) versions_**:\r\n\r\nYou can test the 0.13.0-rc1, fetching it from the staging maven repository, with the following command line flags for Spark 3.2: `--packages 'org.apache.iceberg:iceberg-spark-runtime-3.2_2.12:0.13.0' --repositories https://repository.apache.org/content/repositories/orgapacheiceberg-1079/`\r\n\r\nFor other Spark versions than 3.2, use the artifactIds below (in place of `iceberg-spark-runtime-3.2_2.12` above).\r\n\r\n**Iceberg 0.13.0 spark-runtime jar names**\r\nSpark 3.0: `iceberg-spark3-runtime:0.13.0`\r\nSpark 3.1: `iceberg-spark-runtime-3.1_2.12`\r\nSpark 3.2: `iceberg-spark-runtime-3.2_2.12`\r\n\r\nThe complete package name for any depends on your spark version now. `iceberg-spark3-runtime` should only be used for Spark 3.0.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021720639/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021722055","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021722055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021722055,"node_id":"IC_kwDOCW7NX8485j3H","user":{"login":"nreich","id":960205,"node_id":"MDQ6VXNlcjk2MDIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/960205?v=4","gravatar_id":"","url":"https://api.github.com/users/nreich","html_url":"https://github.com/nreich","followers_url":"https://api.github.com/users/nreich/followers","following_url":"https://api.github.com/users/nreich/following{/other_user}","gists_url":"https://api.github.com/users/nreich/gists{/gist_id}","starred_url":"https://api.github.com/users/nreich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nreich/subscriptions","organizations_url":"https://api.github.com/users/nreich/orgs","repos_url":"https://api.github.com/users/nreich/repos","events_url":"https://api.github.com/users/nreich/events{/privacy}","received_events_url":"https://api.github.com/users/nreich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T00:01:06Z","updated_at":"2022-01-26T00:01:06Z","author_association":"NONE","body":"@rdblue @kbendick  I had tried that jar first, actually: had the same exact result, so I looked to the docs in master for getting started and found they still referred to the old jar (I must have missed the correct location to look for the changed getting started instructions?).\r\n\r\nI cleared dependency caches (just in case), and ran again with:\r\n```\r\nbin/spark-sql --packages org.apache.iceberg:iceberg-spark-runtime-3.2_2.12:0.13.0 \\\r\n    --repositories https://repository.apache.org/content/repositories/orgapacheiceberg-1079/ \\\r\n    ...\r\n```\r\nbut still got the exact same stacktrace as before. Just as a sanity check, I switched over to spark 3.1.2 and the org.apache.iceberg:iceberg-spark-runtime-3.1_2.12:0.13.0 jar and that was able to create the table successfully.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021722055/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021737161","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021737161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021737161,"node_id":"IC_kwDOCW7NX8485njJ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T00:29:16Z","updated_at":"2022-01-26T00:29:16Z","author_association":"CONTRIBUTOR","body":"Thank you for testing this @nreich 🙏 .\r\n\r\nI have tested with Spark 3.1.2 and Spark 3.2.0, both built for Hadoop 3.2., and I don't seem to get this problem. At least on the `CREATE TABLE` statement.\r\n\r\n```bash\r\ncd spark-3.2.0-bin-hadoop3.2 && rm-rf /tmp/iceberg && mkdir -p /tmp/iceberg/warehouse && ./bin/spark-shell --packages 'org.apache.iceberg:iceberg-spark-runtime-3.2_2.12:0.13.0' --repositories https://repository.apache.org/content/repositories/orgapacheiceberg-1079/ --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions --conf spark.sql.catalog.local=org.apache.iceberg.spark.SparkCatalog  --conf spark.sql.catalog.local.type=hadoop --conf spark.sql.catalog.local.warehouse=/tmp/iceberg/warehouse\r\n\r\nscala> spark.sql(\"use local\")\r\n\r\nscala> spark.sql(\"CREATE TABLE local.db.table (id bigint, data string) USING iceberg\")\r\nres2: org.apache.spark.sql.DataFrame = []\r\n\r\nscala> spark.sql(\"show tables in local.db\").show\r\n+---------+---------+-----------+\r\n|namespace|tableName|isTemporary|\r\n+---------+---------+-----------+\r\n|       db|    table|      false|\r\n+---------+---------+-----------+\r\n```\r\n\r\nI also tried with Spark 3.1.2, as well as with a partitioned table and I did not encounter any exceptions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021737161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021743093","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021743093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021743093,"node_id":"IC_kwDOCW7NX8485o_1","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T00:40:15Z","updated_at":"2022-01-26T00:41:30Z","author_association":"CONTRIBUTOR","body":"From Spark 3.2, I also used a partitioned table to test dynamic partition overwrite in Spark 3.2\r\n\r\nBash start up script from spark-3.2.0-bin-hadoop3.2:\r\n```bash\r\nmkdir -p /tmp/iceberg/warehouse && ./bin/spark-shell \\\r\n--packages 'org.apache.iceberg:iceberg-spark-runtime-3.2_2.12:0.13.0' \\\r\n--repositories https://repository.apache.org/content/repositories/orgapacheiceberg-1079/  \\\r\n--conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions \\\r\n--conf spark.sql.catalog.local=org.apache.iceberg.spark.SparkCatalog  \\\r\n--conf spark.sql.catalog.local.type=hadoop \\\r\n--conf spark.sql.catalog.local.warehouse=/tmp/iceberg/warehouse \\\r\n--conf spark.sql.sources.partitionOverwriteMode=dynamic\r\n```\r\n\r\nSpark Shell:\r\n```scala\r\nscala> spark.sql(\"CREATE TABLE local.db.table_partitioned (id bigint, data string) USING iceberg partitioned by (id)\")\r\nres6: org.apache.spark.sql.DataFrame = []\r\n\r\nscala> spark.sql(\"show tables in local.db\").show\r\n+---------+-----------------+-----------+\r\n|namespace|        tableName|isTemporary|\r\n+---------+-----------------+-----------+\r\n|       db|table_partitioned|      false|\r\n|       db|            table|      false|\r\n+---------+-----------------+-----------+\r\n\r\nscala> spark.sql(\"INSERT INTO local.db.table_partitioned(id, data) VALUES (1, 'Hank'), (2, 'Kyle'), (3, 'Jethro'), (4, 'Russell'), (5, 'Maggie')\")\r\n\r\nscala> spark.sql(\"select * from local.db.table_partitioned\").show\r\n+---+-------+\r\n| id|   data|\r\n+---+-------+\r\n|  1|   Hank|\r\n|  2|   Kyle|\r\n|  3| Jethro|\r\n|  4|Russell|\r\n|  5| Maggie|\r\n+---+-------+\r\n\r\nscala> spark.createDataFrame(Seq((3, \"Burt\"))).toDF(\"id\", \"data\").write.mode(\"overwrite\").insertInto(\"local.db.table_partitioned\")\r\n\r\nscala> spark.sql(\"select * from local.db.table_partitioned order by id\").show\r\n+---+-------+\r\n| id|   data|\r\n+---+-------+\r\n|  1|   Hank|\r\n|  2|   Kyle|\r\n|  3|   Burt|\r\n|  4|Russell|\r\n|  5| Maggie|\r\n+---+-------+\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021743093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021743957","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021743957","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021743957,"node_id":"IC_kwDOCW7NX8485pNV","user":{"login":"nreich","id":960205,"node_id":"MDQ6VXNlcjk2MDIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/960205?v=4","gravatar_id":"","url":"https://api.github.com/users/nreich","html_url":"https://github.com/nreich","followers_url":"https://api.github.com/users/nreich/followers","following_url":"https://api.github.com/users/nreich/following{/other_user}","gists_url":"https://api.github.com/users/nreich/gists{/gist_id}","starred_url":"https://api.github.com/users/nreich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nreich/subscriptions","organizations_url":"https://api.github.com/users/nreich/orgs","repos_url":"https://api.github.com/users/nreich/repos","events_url":"https://api.github.com/users/nreich/events{/privacy}","received_events_url":"https://api.github.com/users/nreich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T00:41:54Z","updated_at":"2022-01-26T00:41:54Z","author_association":"NONE","body":"Tried the spark-shell just in case (following exactly what you did) and get the same error. Looks like I have a different hadoop version:\r\nfrom the spark shell I ran `println(\"Hadoop version: \" + org.apache.hadoop.util.VersionInfo.getVersion())`\r\nwith response of `Hadoop version: 3.3.1`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021743957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021744587","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021744587","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021744587,"node_id":"IC_kwDOCW7NX8485pXL","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T00:43:03Z","updated_at":"2022-01-26T00:46:20Z","author_association":"CONTRIBUTOR","body":"That's a bit of a red herring. I have the same output. That's what's used for hadoop3.2 surprisingly enough and is expected.\r\n```\r\nscala>  println(\"Hadoop version: \" + org.apache.hadoop.util.VersionInfo.getVersion())\r\nHadoop version: 3.3.1\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021744587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021745352","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021745352","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021745352,"node_id":"IC_kwDOCW7NX8485pjI","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T00:44:21Z","updated_at":"2022-01-26T00:44:21Z","author_association":"CONTRIBUTOR","body":"Just as a sanity check, does your `spark-shell` ASCII art print version 3.2.0?\r\n```\r\n      ____              __\r\n     / __/__  ___ _____/ /__\r\n    _\\ \\/ _ \\/ _ `/ __/  '_/\r\n   /___/ .__/\\_,_/_/ /_/\\_\\   version 3.2.0\r\n      /_/\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021745352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021747723","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021747723","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021747723,"node_id":"IC_kwDOCW7NX8485qIL","user":{"login":"nreich","id":960205,"node_id":"MDQ6VXNlcjk2MDIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/960205?v=4","gravatar_id":"","url":"https://api.github.com/users/nreich","html_url":"https://github.com/nreich","followers_url":"https://api.github.com/users/nreich/followers","following_url":"https://api.github.com/users/nreich/following{/other_user}","gists_url":"https://api.github.com/users/nreich/gists{/gist_id}","starred_url":"https://api.github.com/users/nreich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nreich/subscriptions","organizations_url":"https://api.github.com/users/nreich/orgs","repos_url":"https://api.github.com/users/nreich/repos","events_url":"https://api.github.com/users/nreich/events{/privacy}","received_events_url":"https://api.github.com/users/nreich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T00:48:37Z","updated_at":"2022-01-26T00:48:37Z","author_association":"NONE","body":"```\r\nWelcome to\r\n      ____              __\r\n     / __/__  ___ _____/ /__\r\n    _\\ \\/ _ \\/ _ `/ __/  '_/\r\n   /___/ .__/\\_,_/_/ /_/\\_\\   version 3.2.0\r\n      /_/\r\n\r\nUsing Scala version 2.12.15 (OpenJDK 64-Bit Server VM, Java 11.0.12)\r\n```\r\n\r\nOther possibly relevant info:\r\nrunning on MacOS Catalina (10.15.7)\r\nspark 3.2.0 was installed through brew","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021747723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021748968","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021748968","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021748968,"node_id":"IC_kwDOCW7NX8485qbo","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T00:50:46Z","updated_at":"2022-01-26T00:50:46Z","author_association":"CONTRIBUTOR","body":"@nreich, maybe additional Jars are sneaking into your classpath. Can you dump the classpath in the Spark UI and share it? Or check for more than one Iceberg Jar?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021748968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021752945","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021752945","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021752945,"node_id":"IC_kwDOCW7NX8485rZx","user":{"login":"nreich","id":960205,"node_id":"MDQ6VXNlcjk2MDIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/960205?v=4","gravatar_id":"","url":"https://api.github.com/users/nreich","html_url":"https://github.com/nreich","followers_url":"https://api.github.com/users/nreich/followers","following_url":"https://api.github.com/users/nreich/following{/other_user}","gists_url":"https://api.github.com/users/nreich/gists{/gist_id}","starred_url":"https://api.github.com/users/nreich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nreich/subscriptions","organizations_url":"https://api.github.com/users/nreich/orgs","repos_url":"https://api.github.com/users/nreich/repos","events_url":"https://api.github.com/users/nreich/events{/privacy}","received_events_url":"https://api.github.com/users/nreich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T00:57:40Z","updated_at":"2022-01-26T00:57:40Z","author_association":"NONE","body":"Downloaded a fresh copy of spark 3.2.0 (https://www.apache.org/dyn/closer.lua/spark/spark-3.2.0/spark-3.2.0-bin-hadoop3.2.tgz): everything now works as expected","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021752945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021757820","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021757820","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021757820,"node_id":"IC_kwDOCW7NX8485sl8","user":{"login":"nreich","id":960205,"node_id":"MDQ6VXNlcjk2MDIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/960205?v=4","gravatar_id":"","url":"https://api.github.com/users/nreich","html_url":"https://github.com/nreich","followers_url":"https://api.github.com/users/nreich/followers","following_url":"https://api.github.com/users/nreich/following{/other_user}","gists_url":"https://api.github.com/users/nreich/gists{/gist_id}","starred_url":"https://api.github.com/users/nreich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nreich/subscriptions","organizations_url":"https://api.github.com/users/nreich/orgs","repos_url":"https://api.github.com/users/nreich/repos","events_url":"https://api.github.com/users/nreich/events{/privacy}","received_events_url":"https://api.github.com/users/nreich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T01:06:43Z","updated_at":"2022-01-26T01:06:43Z","author_association":"NONE","body":"That was the issue @rdblue: I had an errant copy of the old `iceberg-spark3-runtime-0.12.1.jar` on the classpath. After removing it, my original installation of spark 3.2.0 now functions as expected with iceberg 0.13.0.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021757820/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021758407","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021758407","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021758407,"node_id":"IC_kwDOCW7NX8485svH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T01:07:52Z","updated_at":"2022-01-26T01:07:52Z","author_association":"CONTRIBUTOR","body":"Glad to hear it's working! Thanks for working with us to debug!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021758407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021762497","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021762497","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021762497,"node_id":"IC_kwDOCW7NX8485tvB","user":{"login":"nreich","id":960205,"node_id":"MDQ6VXNlcjk2MDIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/960205?v=4","gravatar_id":"","url":"https://api.github.com/users/nreich","html_url":"https://github.com/nreich","followers_url":"https://api.github.com/users/nreich/followers","following_url":"https://api.github.com/users/nreich/following{/other_user}","gists_url":"https://api.github.com/users/nreich/gists{/gist_id}","starred_url":"https://api.github.com/users/nreich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nreich/subscriptions","organizations_url":"https://api.github.com/users/nreich/orgs","repos_url":"https://api.github.com/users/nreich/repos","events_url":"https://api.github.com/users/nreich/events{/privacy}","received_events_url":"https://api.github.com/users/nreich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T01:15:35Z","updated_at":"2022-01-26T01:15:35Z","author_association":"NONE","body":"Thanks for all your help!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021762497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021763066","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021763066","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021763066,"node_id":"IC_kwDOCW7NX8485t36","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T01:16:45Z","updated_at":"2022-01-26T01:19:15Z","author_association":"CONTRIBUTOR","body":"Thank you so much @nreich for working with us to debug this. This is a very important part of the release process and it really helps to have community members testing things out.\r\n\r\nI'm going to close this issue in a bit if there are no more comments. Anybody please feel free to open a new issue referencing this one if need be!\r\n\r\n**TLDR** - Be sure to have the correct Iceberg artifact based on the Spark version, as well as ensuring there aren't extra `iceberg` jars in your Spark `/jars` folder (I've definitely done that more than once).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021763066/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021773631","html_url":"https://github.com/apache/iceberg/issues/3941#issuecomment-1021773631","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3941","id":1021773631,"node_id":"IC_kwDOCW7NX8485wc_","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T01:38:45Z","updated_at":"2022-01-26T01:38:45Z","author_association":"CONTRIBUTOR","body":"Thanks for sharing, @SreeramGarlapati! That is a good start and I'm glad you guys have started working on it. Can we have a discuss when my design doc is ready?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021773631/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021778016","html_url":"https://github.com/apache/iceberg/pull/3876#issuecomment-1021778016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3876","id":1021778016,"node_id":"IC_kwDOCW7NX8485xhg","user":{"login":"kingeasternsun","id":5291739,"node_id":"MDQ6VXNlcjUyOTE3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/5291739?v=4","gravatar_id":"","url":"https://api.github.com/users/kingeasternsun","html_url":"https://github.com/kingeasternsun","followers_url":"https://api.github.com/users/kingeasternsun/followers","following_url":"https://api.github.com/users/kingeasternsun/following{/other_user}","gists_url":"https://api.github.com/users/kingeasternsun/gists{/gist_id}","starred_url":"https://api.github.com/users/kingeasternsun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kingeasternsun/subscriptions","organizations_url":"https://api.github.com/users/kingeasternsun/orgs","repos_url":"https://api.github.com/users/kingeasternsun/repos","events_url":"https://api.github.com/users/kingeasternsun/events{/privacy}","received_events_url":"https://api.github.com/users/kingeasternsun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T01:48:54Z","updated_at":"2022-01-26T01:48:54Z","author_association":"CONTRIBUTOR","body":"> @kingeasternsun Thanks for the pr! Let me know if you add followups to specify the new parameter in \"addFiles\" or \"migrateTable\" code paths.\r\n\r\nthanks for you  advice , the new parameter has added in these pr \r\nhttps://github.com/apache/iceberg/pull/3973 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021778016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021785368","html_url":"https://github.com/apache/iceberg/issues/3909#issuecomment-1021785368","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3909","id":1021785368,"node_id":"IC_kwDOCW7NX8485zUY","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T01:58:35Z","updated_at":"2022-01-26T01:58:35Z","author_association":"CONTRIBUTOR","body":"> \r\n\r\nThis is also a headache for us. We use RocksDBSet (reference #2680) but it is hard to tune the rocksdb, @moon-fall Could you please provide your PR? It matters to us.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021785368/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021799565","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1021799565","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1021799565,"node_id":"IC_kwDOCW7NX84852yN","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T02:21:11Z","updated_at":"2022-01-26T02:21:11Z","author_association":"CONTRIBUTOR","body":"If you're encountering this issue, please be sure that you're using the correct artifact for your Spark version, and that you don't have any additional `iceberg` jars on the classpath (likely in spark's `/jars` directory).\r\n\r\nIf you still have an issue, please open another issue (feel free to reference this one). Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021799565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021895143","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1021895143","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1021895143,"node_id":"IC_kwDOCW7NX8486OHn","user":{"login":"humengyu2012","id":45056332,"node_id":"MDQ6VXNlcjQ1MDU2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/45056332?v=4","gravatar_id":"","url":"https://api.github.com/users/humengyu2012","html_url":"https://github.com/humengyu2012","followers_url":"https://api.github.com/users/humengyu2012/followers","following_url":"https://api.github.com/users/humengyu2012/following{/other_user}","gists_url":"https://api.github.com/users/humengyu2012/gists{/gist_id}","starred_url":"https://api.github.com/users/humengyu2012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humengyu2012/subscriptions","organizations_url":"https://api.github.com/users/humengyu2012/orgs","repos_url":"https://api.github.com/users/humengyu2012/repos","events_url":"https://api.github.com/users/humengyu2012/events{/privacy}","received_events_url":"https://api.github.com/users/humengyu2012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T06:08:29Z","updated_at":"2022-01-26T06:08:29Z","author_association":"NONE","body":"@pvary I added a new test method to fix duplicated sql, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021895143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021928190","html_url":"https://github.com/apache/iceberg/pull/3986#issuecomment-1021928190","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3986","id":1021928190,"node_id":"IC_kwDOCW7NX8486WL-","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T07:15:01Z","updated_at":"2022-01-26T07:15:01Z","author_association":"CONTRIBUTOR","body":"I found the ci failed: https://github.com/apache/iceberg/runs/4947986168?check_suite_focus=true#step:6:203\r\nBut I don't think it was caused by my changes. I can try to fix it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021928190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021965329","html_url":"https://github.com/apache/iceberg/pull/3944#issuecomment-1021965329","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3944","id":1021965329,"node_id":"IC_kwDOCW7NX8486fQR","user":{"login":"0xffmeta","id":98149057,"node_id":"U_kgDOBdmiwQ","avatar_url":"https://avatars.githubusercontent.com/u/98149057?v=4","gravatar_id":"","url":"https://api.github.com/users/0xffmeta","html_url":"https://github.com/0xffmeta","followers_url":"https://api.github.com/users/0xffmeta/followers","following_url":"https://api.github.com/users/0xffmeta/following{/other_user}","gists_url":"https://api.github.com/users/0xffmeta/gists{/gist_id}","starred_url":"https://api.github.com/users/0xffmeta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/0xffmeta/subscriptions","organizations_url":"https://api.github.com/users/0xffmeta/orgs","repos_url":"https://api.github.com/users/0xffmeta/repos","events_url":"https://api.github.com/users/0xffmeta/events{/privacy}","received_events_url":"https://api.github.com/users/0xffmeta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T08:19:21Z","updated_at":"2022-01-26T08:19:21Z","author_association":"CONTRIBUTOR","body":"Just wondering when this change will be reflected into the website [documentation](https://iceberg.apache.org/#hive/). :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021965329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021968690","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1021968690","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1021968690,"node_id":"IC_kwDOCW7NX8486gEy","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T08:24:21Z","updated_at":"2022-01-26T08:24:21Z","author_association":"CONTRIBUTOR","body":"Only formatting changes left from my side.\r\nLet's see how the tests are going.\r\n\r\nThanks for the cahnges @humengyu2012. Well done! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021968690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021979116","html_url":"https://github.com/apache/iceberg/pull/3944#issuecomment-1021979116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3944","id":1021979116,"node_id":"IC_kwDOCW7NX8486ins","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T08:38:23Z","updated_at":"2022-01-26T08:38:23Z","author_association":"CONTRIBUTOR","body":"I am not sure TBH.\r\n\r\nThe last discussion on the dev list about the docs site was this: https://lists.apache.org/thread/wq0qzbcwkjc13zp3j8mtkf8op1n5fn62\r\n\r\nI am not sure what is the status, but if you have some time, it would be good to check out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1021979116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022002048","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1022002048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1022002048,"node_id":"IC_kwDOCW7NX8486oOA","user":{"login":"humengyu2012","id":45056332,"node_id":"MDQ6VXNlcjQ1MDU2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/45056332?v=4","gravatar_id":"","url":"https://api.github.com/users/humengyu2012","html_url":"https://github.com/humengyu2012","followers_url":"https://api.github.com/users/humengyu2012/followers","following_url":"https://api.github.com/users/humengyu2012/following{/other_user}","gists_url":"https://api.github.com/users/humengyu2012/gists{/gist_id}","starred_url":"https://api.github.com/users/humengyu2012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humengyu2012/subscriptions","organizations_url":"https://api.github.com/users/humengyu2012/orgs","repos_url":"https://api.github.com/users/humengyu2012/repos","events_url":"https://api.github.com/users/humengyu2012/events{/privacy}","received_events_url":"https://api.github.com/users/humengyu2012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T09:09:31Z","updated_at":"2022-01-26T09:25:06Z","author_association":"NONE","body":"@pvary Is the format OK? My code is always formatted automatically because I have imported the format profile [intellij-java-palantir-style.xml](https://github.com/apache/iceberg/blob/master/.baseline/idea/intellij-java-palantir-style.xml).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022002048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022008157","html_url":"https://github.com/apache/iceberg/issues/3885#issuecomment-1022008157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3885","id":1022008157,"node_id":"IC_kwDOCW7NX8486ptd","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T09:16:46Z","updated_at":"2022-01-26T09:16:46Z","author_association":"CONTRIBUTOR","body":"thanks @RussellSpitzer @kbendick , I will test this case in higher version.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022008157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022027147","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1022027147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1022027147,"node_id":"IC_kwDOCW7NX8486uWL","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T09:40:46Z","updated_at":"2022-01-26T09:40:46Z","author_association":"CONTRIBUTOR","body":"> @pvary Is the format OK? My code is always formatted automatically because I have imported the format profile [intellij-java-palantir-style.xml](https://github.com/apache/iceberg/blob/master/.baseline/idea/intellij-java-palantir-style.xml).\r\n\r\nMy main problem was that the `HiveIcebergMetaHook.PARAMETERS_TO_REMOVE`, and `HiveIcebergMetaHook.PROPERTIES_TO_REMOVE` was formatted differently (maybe even before your patch)\r\n\r\nOtherwise it is fine with me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022027147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022071253","html_url":"https://github.com/apache/iceberg/pull/3944#issuecomment-1022071253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3944","id":1022071253,"node_id":"IC_kwDOCW7NX84865HV","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T10:34:53Z","updated_at":"2022-01-26T10:34:53Z","author_association":"CONTRIBUTOR","body":"Sorry, I only had a chance to look at it today but I see it's already been approved. LGTM too!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022071253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022079289","html_url":"https://github.com/apache/iceberg/pull/3944#issuecomment-1022079289","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3944","id":1022079289,"node_id":"IC_kwDOCW7NX84867E5","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T10:45:44Z","updated_at":"2022-01-26T10:45:44Z","author_association":"CONTRIBUTOR","body":"Thanks for your time @0xffmeta, @massdosage and @marton-bod!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022079289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022141532","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1022141532","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1022141532,"node_id":"IC_kwDOCW7NX8487KRc","user":{"login":"humengyu2012","id":45056332,"node_id":"MDQ6VXNlcjQ1MDU2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/45056332?v=4","gravatar_id":"","url":"https://api.github.com/users/humengyu2012","html_url":"https://github.com/humengyu2012","followers_url":"https://api.github.com/users/humengyu2012/followers","following_url":"https://api.github.com/users/humengyu2012/following{/other_user}","gists_url":"https://api.github.com/users/humengyu2012/gists{/gist_id}","starred_url":"https://api.github.com/users/humengyu2012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humengyu2012/subscriptions","organizations_url":"https://api.github.com/users/humengyu2012/orgs","repos_url":"https://api.github.com/users/humengyu2012/repos","events_url":"https://api.github.com/users/humengyu2012/events{/privacy}","received_events_url":"https://api.github.com/users/humengyu2012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T12:11:42Z","updated_at":"2022-01-26T12:11:42Z","author_association":"NONE","body":"I reformatted `HiveIcebergMetaHook.PARAMETERS_TO_REMOVE` and `HiveIcebergMetaHook.PROPERTIES_TO_REMOVE` with the following reference code\r\n`org.apache.iceberg.MetadataColumns#META_IDS`\r\n![image](https://user-images.githubusercontent.com/45056332/151159926-309dccc3-456b-4b0b-b8d1-795f7358cf7a.png)\r\n\r\nI'm not sure if this is a good idea and would like to ask for your advice.\r\n@pvary ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022141532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022142871","html_url":"https://github.com/apache/iceberg/pull/3912#issuecomment-1022142871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3912","id":1022142871,"node_id":"IC_kwDOCW7NX8487KmX","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T12:13:39Z","updated_at":"2022-01-26T12:13:39Z","author_association":"CONTRIBUTOR","body":"> I'm not sure if this is a good idea and would like to ask for your advice. @pvary\r\n\r\nWe are adding multiple values to the sets, so we have to change them anyway. It is good if we have the same formatting minimally in file level. So this is fine by me. Thanks\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022142871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022165445","html_url":"https://github.com/apache/iceberg/pull/3980#issuecomment-1022165445","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3980","id":1022165445,"node_id":"IC_kwDOCW7NX8487QHF","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T12:46:10Z","updated_at":"2022-01-26T12:46:10Z","author_association":"CONTRIBUTOR","body":"Let's see if anyone wants to comment. If not, then I can merge tomorrow","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022165445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022595801","html_url":"https://github.com/apache/iceberg/pull/3988#issuecomment-1022595801","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3988","id":1022595801,"node_id":"IC_kwDOCW7NX84885LZ","user":{"login":"cccs-eric","id":56447460,"node_id":"MDQ6VXNlcjU2NDQ3NDYw","avatar_url":"https://avatars.githubusercontent.com/u/56447460?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-eric","html_url":"https://github.com/cccs-eric","followers_url":"https://api.github.com/users/cccs-eric/followers","following_url":"https://api.github.com/users/cccs-eric/following{/other_user}","gists_url":"https://api.github.com/users/cccs-eric/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-eric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-eric/subscriptions","organizations_url":"https://api.github.com/users/cccs-eric/orgs","repos_url":"https://api.github.com/users/cccs-eric/repos","events_url":"https://api.github.com/users/cccs-eric/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-eric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-26T20:57:50Z","updated_at":"2022-01-26T20:57:50Z","author_association":"CONTRIBUTOR","body":"@samredai Can you take a look at this?  I've made it a draft to see what you think.  If you are ok with it, I'll convert it to an official PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022595801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022818167","html_url":"https://github.com/apache/iceberg/issues/2277#issuecomment-1022818167","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2277","id":1022818167,"node_id":"IC_kwDOCW7NX8489vd3","user":{"login":"ubyyj","id":12639959,"node_id":"MDQ6VXNlcjEyNjM5OTU5","avatar_url":"https://avatars.githubusercontent.com/u/12639959?v=4","gravatar_id":"","url":"https://api.github.com/users/ubyyj","html_url":"https://github.com/ubyyj","followers_url":"https://api.github.com/users/ubyyj/followers","following_url":"https://api.github.com/users/ubyyj/following{/other_user}","gists_url":"https://api.github.com/users/ubyyj/gists{/gist_id}","starred_url":"https://api.github.com/users/ubyyj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ubyyj/subscriptions","organizations_url":"https://api.github.com/users/ubyyj/orgs","repos_url":"https://api.github.com/users/ubyyj/repos","events_url":"https://api.github.com/users/ubyyj/events{/privacy}","received_events_url":"https://api.github.com/users/ubyyj/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-27T03:40:51Z","updated_at":"2022-01-27T03:40:51Z","author_association":"NONE","body":"same here. I already have an iceberg table store in s3, registered in a hive metastore. Now I want to access the table from another hive, so I wanted to create table on top of existing data.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022818167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022833104","html_url":"https://github.com/apache/iceberg/pull/3986#issuecomment-1022833104","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3986","id":1022833104,"node_id":"IC_kwDOCW7NX8489zHQ","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-27T04:16:32Z","updated_at":"2022-01-27T04:16:32Z","author_association":"CONTRIBUTOR","body":"@coolderli can you create this PR for 1.14 only? we typically create a PR for the latest version. then we can create backport PR separately. In the backport PR, we show the diffs for the relevant sub folders. e.g. https://github.com/apache/iceberg/pull/3870#issuecomment-1009259729","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022833104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022844940","html_url":"https://github.com/apache/iceberg/issues/3941#issuecomment-1022844940","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3941","id":1022844940,"node_id":"IC_kwDOCW7NX84892AM","user":{"login":"mohitgargk","id":1259955,"node_id":"MDQ6VXNlcjEyNTk5NTU=","avatar_url":"https://avatars.githubusercontent.com/u/1259955?v=4","gravatar_id":"","url":"https://api.github.com/users/mohitgargk","html_url":"https://github.com/mohitgargk","followers_url":"https://api.github.com/users/mohitgargk/followers","following_url":"https://api.github.com/users/mohitgargk/following{/other_user}","gists_url":"https://api.github.com/users/mohitgargk/gists{/gist_id}","starred_url":"https://api.github.com/users/mohitgargk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mohitgargk/subscriptions","organizations_url":"https://api.github.com/users/mohitgargk/orgs","repos_url":"https://api.github.com/users/mohitgargk/repos","events_url":"https://api.github.com/users/mohitgargk/events{/privacy}","received_events_url":"https://api.github.com/users/mohitgargk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-27T04:47:35Z","updated_at":"2022-01-27T04:47:35Z","author_association":"NONE","body":"+1\r\n\r\n@flyrain We are looking into two possible approaches here.\r\n1.  Materialised where, like DeltaLake Change Data Feed that is generated in the write path.\r\n2. Change Data Feed is evaluated at the read path by consumers.\r\n\r\nAt this point of time, we are grokking and spiking on approach #2. Would love to know your early thoughts on this. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022844940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022880605","html_url":"https://github.com/apache/iceberg/pull/3986#issuecomment-1022880605","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3986","id":1022880605,"node_id":"IC_kwDOCW7NX8489-td","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-27T06:10:49Z","updated_at":"2022-01-27T06:10:49Z","author_association":"CONTRIBUTOR","body":"> @coolderli can you create this PR for 1.14 only? we typically create a PR for the latest version. then we can create backport PR separately. In the backport PR, we show the diffs for the relevant sub folders. e.g. [#3870 (comment)](https://github.com/apache/iceberg/pull/3870#issuecomment-1009259729)\r\n\r\n@stevenzwu Thanks for reminding me about that. I have removed the modify on 1.12 and 1.13. Could you please take a look again?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022880605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022891138","html_url":"https://github.com/apache/iceberg/issues/2277#issuecomment-1022891138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2277","id":1022891138,"node_id":"IC_kwDOCW7NX848-BSC","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-27T06:32:10Z","updated_at":"2022-01-27T06:32:10Z","author_association":"CONTRIBUTOR","body":"@ubyyj: A few questions for future development:\r\n- Is the 2nd HiveServer2/TezAM able to access the 1st HMS?\r\n- Do you plan to change the tables from both Hive installations?\r\n\r\nThanks, Peter ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022891138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022891787","html_url":"https://github.com/apache/iceberg/pull/3784#issuecomment-1022891787","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3784","id":1022891787,"node_id":"IC_kwDOCW7NX848-BcL","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-27T06:33:30Z","updated_at":"2022-01-27T06:34:10Z","author_association":"CONTRIBUTOR","body":"> @hililiwei, can you describe how you're estimating the size of data that is buffered in memory for ORC? I think a description to explain to reviewers would help.\r\n\r\nIf a file is being written, to estimate its size,  in three steps:\r\n1. Size of data that has been written to `stripe`.The value is obtained by summing the `offset` and `length `of the last stripe of the `writer`.\r\n2. Size of data that has been submitted to the `writer `but has not been written to the stripe. When creating OrcFileAppender, `treeWriter` is obtained through reflection,  and use its `estimateMemory` to estimate how much memory is being used.\r\n3. Data that has not been submitted to the `writer`, that is, the size of the buffer. The maximum default value of the buffer is used here.\r\n\r\nAdd these three values to estimate the data size.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022891787/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022895317","html_url":"https://github.com/apache/iceberg/pull/3817#issuecomment-1022895317","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3817","id":1022895317,"node_id":"IC_kwDOCW7NX848-CTV","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-01-27T06:41:13Z","updated_at":"2022-01-27T06:41:13Z","author_association":"CONTRIBUTOR","body":"@rdblue @kbendick Please take a look, do I need any further changes?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1022895317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]