[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774654657","html_url":"https://github.com/apache/iceberg/issues/2219#issuecomment-774654657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2219","id":774654657,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDY1NDY1Nw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-07T11:03:28Z","updated_at":"2021-02-07T11:03:28Z","author_association":"CONTRIBUTOR","body":"I think it may be a flink serialization problem. Variables in flink operators (such as map and flatmap etc) need to be serializabled, and some variables do not meet the serialization requirements of flink. \r\n\r\nhttps://ci.apache.org/projects/flink/flink-docs-stable/dev/types_serialization.html","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774654657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774716451","html_url":"https://github.com/apache/iceberg/pull/882#issuecomment-774716451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/882","id":774716451,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDcxNjQ1MQ==","user":{"login":"pPanda-beta","id":20648934,"node_id":"MDQ6VXNlcjIwNjQ4OTM0","avatar_url":"https://avatars.githubusercontent.com/u/20648934?v=4","gravatar_id":"","url":"https://api.github.com/users/pPanda-beta","html_url":"https://github.com/pPanda-beta","followers_url":"https://api.github.com/users/pPanda-beta/followers","following_url":"https://api.github.com/users/pPanda-beta/following{/other_user}","gists_url":"https://api.github.com/users/pPanda-beta/gists{/gist_id}","starred_url":"https://api.github.com/users/pPanda-beta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pPanda-beta/subscriptions","organizations_url":"https://api.github.com/users/pPanda-beta/orgs","repos_url":"https://api.github.com/users/pPanda-beta/repos","events_url":"https://api.github.com/users/pPanda-beta/events{/privacy}","received_events_url":"https://api.github.com/users/pPanda-beta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-07T17:41:38Z","updated_at":"2021-02-07T17:41:38Z","author_association":"NONE","body":"@sudssf \r\nHave you tested it with gcs?\r\n\r\nWe have some corrupted tables on gcs where some parquet file size in bytes saved in manifest were more than the actual parquet file size on gcs. \r\nAs a result when we try to load the data on presto (or any other system), it fails with the following error : \r\n\r\n```\r\nCaused by: java.io.EOFException: Invalid seek offset: position value (259484) must be between 0 and 235520 for 'gs://<our table location>/data/yyyymmdd=20201031/quarter_hour=2145/00025-206-d545bce0-0445-4146-a149-d2148259c9e1-00005.parquet'\r\n\tat com.google.cloud.hadoop.gcsio.GoogleCloudStorageReadChannel.validatePosition(GoogleCloudStorageReadChannel.java:713)\r\n\tat com.google.cloud.hadoop.gcsio.GoogleCloudStorageReadChannel.position(GoogleCloudStorageReadChannel.java:600)\r\n\tat com.google.cloud.hadoop.fs.gcs.GoogleHadoopFSInputStream.seek(GoogleHadoopFSInputStream.java:199)\r\n\tat org.apache.hadoop.fs.FSDataInputStream.seek(FSDataInputStream.java:65)\r\n\tat org.apache.hadoop.fs.FSDataInputStream.seek(FSDataInputStream.java:65)\r\n\tat io.prestosql.plugin.hive.util.FSDataInputStreamTail.readTail(FSDataInputStreamTail.java:57)\r\n\tat io.prestosql.plugin.hive.parquet.HdfsParquetDataSource.readTail(HdfsParquetDataSource.java:108)\r\n```\r\n\r\nWe had downloaded the files and found that\r\n\r\n- The original file size is 235520 bytes only\r\n- The manifest avro files has the value of fileSizeInBytes as 259484 (corrupted)\r\n- We checked couple of other corrupted files as well. For all the corrupted files, the **avro manifest had more than the expected size.** \r\n \r\n### Unfortunately they consider the manifest avro file as the source of truth, because that is much cheaper than the actual fs stat operation on object store file systems (gcs, s3, ...)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774716451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774773226","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-774773226","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":774773226,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDc3MzIyNg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-07T21:42:49Z","updated_at":"2021-02-07T21:42:49Z","author_association":"CONTRIBUTOR","body":"Works fine for me so far, tested a few operations among a few clusters of different versions. \r\n\r\nOne behavior I see is that, if an old v1 writer is somehow still used to create a new table version after v2 writer is used, all schema history will be dropped, so new schema written by v2 writer will have schema id starting from 0 again, which can break time travel query. \r\n\r\nIn theory, once a table is written by a v2 writer, it should never be touched by a v1 writer, but we cannot prevent people from doing that in real life, especially when the organization is large and people use different versions of the same software all the time. So I feel we still need something like a `last-assigned-schema-id`, so that the schemas don't accidentally share the same id and we can backfill the earlier schema and their IDs if necessary. But `last-assigned-schema-id` field should not as a part of the table metadata field because it will be dropped by an old writer. One way to go is to maybe put it in table properties, but there might be better ways. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774773226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774808959","html_url":"https://github.com/apache/iceberg/pull/882#issuecomment-774808959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/882","id":774808959,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDgwODk1OQ==","user":{"login":"sudssf","id":10800873,"node_id":"MDQ6VXNlcjEwODAwODcz","avatar_url":"https://avatars.githubusercontent.com/u/10800873?v=4","gravatar_id":"","url":"https://api.github.com/users/sudssf","html_url":"https://github.com/sudssf","followers_url":"https://api.github.com/users/sudssf/followers","following_url":"https://api.github.com/users/sudssf/following{/other_user}","gists_url":"https://api.github.com/users/sudssf/gists{/gist_id}","starred_url":"https://api.github.com/users/sudssf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sudssf/subscriptions","organizations_url":"https://api.github.com/users/sudssf/orgs","repos_url":"https://api.github.com/users/sudssf/repos","events_url":"https://api.github.com/users/sudssf/events{/privacy}","received_events_url":"https://api.github.com/users/sudssf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T01:17:50Z","updated_at":"2021-02-08T01:17:50Z","author_association":"CONTRIBUTOR","body":"@pPanda-beta no I did not test this with gcs , definitely tested with s3a. are you using client side encryption?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774808959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774916800","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-774916800","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":774916800,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDkxNjgwMA==","user":{"login":"capkurmagati","id":11385129,"node_id":"MDQ6VXNlcjExMzg1MTI5","avatar_url":"https://avatars.githubusercontent.com/u/11385129?v=4","gravatar_id":"","url":"https://api.github.com/users/capkurmagati","html_url":"https://github.com/capkurmagati","followers_url":"https://api.github.com/users/capkurmagati/followers","following_url":"https://api.github.com/users/capkurmagati/following{/other_user}","gists_url":"https://api.github.com/users/capkurmagati/gists{/gist_id}","starred_url":"https://api.github.com/users/capkurmagati/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/capkurmagati/subscriptions","organizations_url":"https://api.github.com/users/capkurmagati/orgs","repos_url":"https://api.github.com/users/capkurmagati/repos","events_url":"https://api.github.com/users/capkurmagati/events{/privacy}","received_events_url":"https://api.github.com/users/capkurmagati/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T06:52:37Z","updated_at":"2021-02-08T06:52:37Z","author_association":"NONE","body":"I did something like the below to expire selected snapshots via Java API\r\n```scala\r\nval snapshots = sql(\"select * from iceberg.db.tbl.snapshots\")\r\nval snapshotsToDel = snapshots.select(\"snapshot_id\").filter($\"committed_at\" < \"2020-10-06 12:59:00\" ).filter($\"committed_at\" > \"2020-10-06 12:01:00\" ).collectAsList\r\nsnapshotsToDel.forEach( id => table.expireSnapshots.expireSnapshotId(id.getLong(0)).commit()  )\r\n```\r\nI don't if it's a common use case but our use case is:\r\n1. We have a CDC pipeline for an online RDBMS table. The writer consumes the CDC log and writes to Iceberg every 15min.\r\n2. The users can query/time travel hot data via 15-min snapshots.\r\n3. Once the data became cold. (usually after 2 weeks in our environment). We want to downsample the snapshots to reduce the data size. To keep the `hourly` snapshots only and remove those in between.\r\n4. (Haven't done it yet). Maybe we want to downsample to daily after a longer period. (Our previous batch ingestion pipeline is based on daily Sqoop jobs)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/774916800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775027713","html_url":"https://github.com/apache/iceberg/pull/1978#issuecomment-775027713","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1978","id":775027713,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTAyNzcxMw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T10:05:49Z","updated_at":"2021-02-08T10:05:49Z","author_association":"CONTRIBUTOR","body":"Now,`IcebergTableSink` only implements `AppendStreamTableSink`, not implements the `UpsertStreamTableSink`, but in flink 1.12, the two interface have deprecated, if we want to use  flink sql write the CDC data to iceberg, I think we need to refactor the `IcebergTableSink` with new interface `DynamicTableSink` first,I have did part of this refactor work, and after it  is completed, I will open a pr","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775027713/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775347569","html_url":"https://github.com/apache/iceberg/pull/2204#issuecomment-775347569","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2204","id":775347569,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTM0NzU2OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T18:23:47Z","updated_at":"2021-02-08T18:23:47Z","author_association":"CONTRIBUTOR","body":"Thanks, @thomaschow! The implementation looks good, but there are a few minor things to fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775347569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775367324","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-775367324","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":775367324,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTM2NzMyNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T18:57:14Z","updated_at":"2021-02-08T18:58:56Z","author_association":"CONTRIBUTOR","body":"> @RussellSpitzer @rdblue, isn't it a use case we allow in the Table and Actions APIs?\r\n\r\nYes, but this is in the API from back when we didn't keep parent information for snapshots. I'm not sure how good of an idea it was for me to add it back then.\r\n\r\n> I think expiring B in A, B, C should be fine as we will have a union of all files referenced by A and C as our reachability set.\r\n\r\nYes, it is safe for the current operation. But what about when we age off A or C? If we don't use the reachability set to clean up files do we hit issues because B is gone?\r\n\r\nMaybe not, but I think we need to think through it carefully.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775367324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775372450","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-775372450","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":775372450,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTM3MjQ1MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T19:05:05Z","updated_at":"2021-02-08T19:05:05Z","author_association":"MEMBER","body":"I was mentioning the sequence thing because our current plans for doing the Streaming source basically rely on our ability to successfully crawl from the \"begin snapshot\" to the \"end snapshot\". If a user removed internal snapshot \"b\", is it still possible to do an incremental scan? What does it mean in that case?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775372450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775375411","html_url":"https://github.com/apache/iceberg/issues/2226#issuecomment-775375411","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2226","id":775375411,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTM3NTQxMQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T19:10:03Z","updated_at":"2021-02-08T19:14:17Z","author_association":"COLLABORATOR","body":"I am happy to add to the doc, or are there concerns at its stability before we publish it?\r\n\r\ncc @rdblue @rymurr ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775375411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775378705","html_url":"https://github.com/apache/iceberg/issues/2227#issuecomment-775378705","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2227","id":775378705,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTM3ODcwNQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T19:15:54Z","updated_at":"2021-02-08T19:15:54Z","author_association":"COLLABORATOR","body":"I would be happy to give this a stab,  but wanted to check if anyone is working on it?  @rdblue @rymurr  thanks ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775378705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775408970","html_url":"https://github.com/apache/iceberg/pull/2167#issuecomment-775408970","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2167","id":775408970,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTQwODk3MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T20:03:50Z","updated_at":"2021-02-08T20:03:50Z","author_association":"MEMBER","body":"Formatting fixes in, @rdblue Thanks for looking over this, I really appreciate it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775408970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775416399","html_url":"https://github.com/apache/iceberg/issues/2209#issuecomment-775416399","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2209","id":775416399,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTQxNjM5OQ==","user":{"login":"ashajyothi828","id":40180859,"node_id":"MDQ6VXNlcjQwMTgwODU5","avatar_url":"https://avatars.githubusercontent.com/u/40180859?v=4","gravatar_id":"","url":"https://api.github.com/users/ashajyothi828","html_url":"https://github.com/ashajyothi828","followers_url":"https://api.github.com/users/ashajyothi828/followers","following_url":"https://api.github.com/users/ashajyothi828/following{/other_user}","gists_url":"https://api.github.com/users/ashajyothi828/gists{/gist_id}","starred_url":"https://api.github.com/users/ashajyothi828/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashajyothi828/subscriptions","organizations_url":"https://api.github.com/users/ashajyothi828/orgs","repos_url":"https://api.github.com/users/ashajyothi828/repos","events_url":"https://api.github.com/users/ashajyothi828/events{/privacy}","received_events_url":"https://api.github.com/users/ashajyothi828/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T20:15:42Z","updated_at":"2021-02-08T20:15:42Z","author_association":"NONE","body":"Any help here?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775416399/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775451501","html_url":"https://github.com/apache/iceberg/pull/2167#issuecomment-775451501","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2167","id":775451501,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTQ1MTUwMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T20:50:29Z","updated_at":"2021-02-08T20:50:29Z","author_association":"CONTRIBUTOR","body":"I've been thinking about this more and I'm leaning toward trying to work around it. I think the problem is that the Parquet/Avro writer uses the old list format by default to avoid breaking existing pipelines. But there should be an easy way to update the behavior to produce records that Iceberg accepts by setting `parquet.avro.write-old-list-structure=false`. That's true by default.\r\n\r\nIf we can fix it that way, then I think we should go with that. Otherwise, we're implementing only part of the [backward-compatibility rules from Parquet](https://github.com/apache/parquet-format/blob/master/LogicalTypes.md#lists). I'm not sure what the impact would be on compatibility if we only partially implement the rules, so I think the safer thing is to just implement all of the backward-compatibility rules. But that's a bigger change and more to maintain (which is why we don't support the 2-level lists in the first place). So I think the preferred solution is to avoid this instead.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775451501/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775490924","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-775490924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":775490924,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTQ5MDkyNA==","user":{"login":"caseylucas","id":517834,"node_id":"MDQ6VXNlcjUxNzgzNA==","avatar_url":"https://avatars.githubusercontent.com/u/517834?v=4","gravatar_id":"","url":"https://api.github.com/users/caseylucas","html_url":"https://github.com/caseylucas","followers_url":"https://api.github.com/users/caseylucas/followers","following_url":"https://api.github.com/users/caseylucas/following{/other_user}","gists_url":"https://api.github.com/users/caseylucas/gists{/gist_id}","starred_url":"https://api.github.com/users/caseylucas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/caseylucas/subscriptions","organizations_url":"https://api.github.com/users/caseylucas/orgs","repos_url":"https://api.github.com/users/caseylucas/repos","events_url":"https://api.github.com/users/caseylucas/events{/privacy}","received_events_url":"https://api.github.com/users/caseylucas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-08T21:58:37Z","updated_at":"2021-02-08T21:58:37Z","author_association":"NONE","body":"@stevenzwu Thanks for the advice. We're now looking at using the approach (as you mentioned) of doing the demux before the sink. Based on my understanding, we may need to implement our own sink similar to the existing IcebergTableSink but instead of knowing the table name at construction time, we'll lazily determine the table. We'll use the KeyBy transformation in flink so that we end up with one sink per key (which corresponds to an iceberg table in our case.)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775490924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775547271","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-775547271","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":775547271,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTU0NzI3MQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T00:01:32Z","updated_at":"2021-02-09T00:01:32Z","author_association":"CONTRIBUTOR","body":"@caseylucas keyBy can help address some of the problems. not sure about your datasets. just watch out the traffic imbalance for the keyBy shuffle.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775547271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775597041","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-775597041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":775597041,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTU5NzA0MQ==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T01:58:19Z","updated_at":"2021-02-09T01:58:19Z","author_association":"CONTRIBUTOR","body":"> Works fine for me so far, tested a few operations among a few clusters of different versions.\r\n> \r\n> One behavior I see is that, if an old v1 writer is somehow still used to create a new table version after v2 writer is used, all schema history will be dropped, so new schema written by v2 writer will have schema id starting from 0 again, which can break time travel query.\r\n> \r\n> In theory, once a table is written by a v2 writer, it should never be touched by a v1 writer, but we cannot prevent people from doing that in real life, especially when the organization is large and people use different versions of the same software all the time. So I feel we still need something like a `last-assigned-schema-id`, so that the schemas don't accidentally share the same id and we can backfill the earlier schema and their IDs if necessary. But `last-assigned-schema-id` field should not as a part of the table metadata field because it will be dropped by an old writer. One way to go is to maybe put it in table properties, but there might be better ways. What do you think?\r\n\r\nThanks for putting efforts into testing this! \r\n\r\nI think the problem you described seem to be similar to what I had in my question 1, and I think we might be fine with that since the IDs within the metadata file should always be consistent, and we don't expose them in metadata table as Ryan mentioned above. I think it wouldn't break time travel query, as after the old writer writes the data, the schema ID with the snapshot got dropped, in which case we will likely need to rely on #1508 for time travel? \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775597041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775639083","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-775639083","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":775639083,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTYzOTA4Mw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T03:45:04Z","updated_at":"2021-02-09T03:45:04Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775639083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775665530","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-775665530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":775665530,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTY2NTUzMA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T05:04:00Z","updated_at":"2021-02-09T05:04:00Z","author_association":"CONTRIBUTOR","body":"> I think the problem you described seem to be similar to what I had in my question 1, and I think we might be fine with that since the IDs within the metadata file should always be consistent, and we don't expose them in metadata table as Ryan mentioned above. I think it wouldn't break time travel query, as after the old writer writes the data, the schema ID with the snapshot got dropped, in which case we will likely need to rely on #1508 for time travel?\r\n\r\nI see, that makes sense.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775665530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775719820","html_url":"https://github.com/apache/iceberg/pull/2229#issuecomment-775719820","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2229","id":775719820,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTcxOTgyMA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T07:01:37Z","updated_at":"2021-02-09T07:01:37Z","author_association":"CONTRIBUTOR","body":"@stevenzwu @openinx could you help me review it ? thanks ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775719820/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775755929","html_url":"https://github.com/apache/iceberg/pull/2119#issuecomment-775755929","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2119","id":775755929,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTc1NTkyOQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T08:18:03Z","updated_at":"2021-02-09T08:18:03Z","author_association":"CONTRIBUTOR","body":"Thanks for a job well done @Jecarm, and @rdblue, @marton-bod for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775755929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775775674","html_url":"https://github.com/apache/iceberg/issues/2227#issuecomment-775775674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2227","id":775775674,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTc3NTY3NA==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T08:54:01Z","updated_at":"2021-02-09T08:54:01Z","author_association":"CONTRIBUTOR","body":"Hey @szehon-ho no one that I am aware of is working on it and your contributions would be very welcome! Shout if you have any questions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775775674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775776279","html_url":"https://github.com/apache/iceberg/issues/2226#issuecomment-775776279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2226","id":775776279,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTc3NjI3OQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T08:55:04Z","updated_at":"2021-02-09T08:55:04Z","author_association":"CONTRIBUTOR","body":"this has been on my list for some time. We should definitely update and publish the docs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775776279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775921861","html_url":"https://github.com/apache/iceberg/issues/2219#issuecomment-775921861","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2219","id":775921861,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTkyMTg2MQ==","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T13:06:31Z","updated_at":"2021-02-09T13:07:58Z","author_association":"NONE","body":"> I think it may be a flink serialization problem. Variables in flink operators (such as map and flatmap etc) need to be serializabled, and some variables do not meet the serialization requirements of flink.\r\n> \r\n> https://ci.apache.org/projects/flink/flink-docs-stable/dev/types_serialization.html\r\n\r\nthanks zhangjun0x01\r\n\r\nyes, it seems that there are something wrong with kryo serialization, it use flink default serialization(kryo), I think https://github.com/EsotericSoftware/kryo/issues/693 is useful but not sure\r\n\r\nfor test, if i declare the var with transient, it is ok, but I am not sure if var is required for the next operation in flink DAG\r\n\r\n**transient var like**\r\n\r\n  private transient Map<Integer, Long> columnSizes = null;\r\n  private transient Map<Integer, Long> valueCounts = null;\r\n  private transient Map<Integer, Long> nullValueCounts = null;\r\n  private transient Map<Integer, Long> nanValueCounts = null;\r\n  private transient Map<Integer, ByteBuffer> lowerBounds = null;\r\n  private transient Map<Integer, ByteBuffer> upperBounds = null;\r\n\r\nin https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/BaseFile.java\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775921861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775924996","html_url":"https://github.com/apache/iceberg/issues/2028#issuecomment-775924996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2028","id":775924996,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTkyNDk5Ng==","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T13:12:04Z","updated_at":"2021-02-09T13:12:04Z","author_association":"NONE","body":"> Also, can you please verify what version of Iceberg you are using?\r\n\r\nI also meet this problem, we can discuss it here https://github.com/apache/iceberg/issues/2219","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/775924996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776093057","html_url":"https://github.com/apache/iceberg/pull/2204#issuecomment-776093057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2204","id":776093057,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjA5MzA1Nw==","user":{"login":"thomaschow","id":2002564,"node_id":"MDQ6VXNlcjIwMDI1NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/2002564?v=4","gravatar_id":"","url":"https://api.github.com/users/thomaschow","html_url":"https://github.com/thomaschow","followers_url":"https://api.github.com/users/thomaschow/followers","following_url":"https://api.github.com/users/thomaschow/following{/other_user}","gists_url":"https://api.github.com/users/thomaschow/gists{/gist_id}","starred_url":"https://api.github.com/users/thomaschow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomaschow/subscriptions","organizations_url":"https://api.github.com/users/thomaschow/orgs","repos_url":"https://api.github.com/users/thomaschow/repos","events_url":"https://api.github.com/users/thomaschow/events{/privacy}","received_events_url":"https://api.github.com/users/thomaschow/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T17:08:16Z","updated_at":"2021-02-09T17:08:16Z","author_association":"CONTRIBUTOR","body":"@rdblue  ptal - let me know if this can be merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776093057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776110864","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-776110864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":776110864,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjExMDg2NA==","user":{"login":"ashajyothi828","id":40180859,"node_id":"MDQ6VXNlcjQwMTgwODU5","avatar_url":"https://avatars.githubusercontent.com/u/40180859?v=4","gravatar_id":"","url":"https://api.github.com/users/ashajyothi828","html_url":"https://github.com/ashajyothi828","followers_url":"https://api.github.com/users/ashajyothi828/followers","following_url":"https://api.github.com/users/ashajyothi828/following{/other_user}","gists_url":"https://api.github.com/users/ashajyothi828/gists{/gist_id}","starred_url":"https://api.github.com/users/ashajyothi828/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashajyothi828/subscriptions","organizations_url":"https://api.github.com/users/ashajyothi828/orgs","repos_url":"https://api.github.com/users/ashajyothi828/repos","events_url":"https://api.github.com/users/ashajyothi828/events{/privacy}","received_events_url":"https://api.github.com/users/ashajyothi828/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T17:34:39Z","updated_at":"2021-02-09T17:34:39Z","author_association":"NONE","body":"@stevenzwu Thanks for your response. We actually tried implementing a custom sink that can determine the table name at runtime, but I faced trouble when trying to generate the table name based on the key. I was not able to get the key in the sink based on which I want to name my table. I see that there's a `getCurrentKey()` function in the KeyedProcessFunction, but that was not available in the sink. Couldn't find anything that can help (with passing the data from the source to sink) in the Sink.Context available. Can you think of anything that can help me with this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776110864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776115096","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-776115096","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":776115096,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjExNTA5Ng==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T17:41:13Z","updated_at":"2021-02-09T17:41:13Z","author_association":"CONTRIBUTOR","body":"I probably missed sth here. can't you get the key from payload/record?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776115096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776120425","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-776120425","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":776120425,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjEyMDQyNQ==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T17:49:27Z","updated_at":"2021-02-09T17:49:27Z","author_association":"MEMBER","body":"> I don't if it's a common use case but our use case is:\r\n> \r\n> 1. We have a CDC pipeline for an online RDBMS table. The writer consumes the CDC log and writes to Iceberg every 15min.\r\n> 2. The users can query/time travel hot data via 15-min snapshots.\r\n> 3. Once the data became cold. (usually after 2 weeks in our environment). We want to downsample the snapshots to reduce the data size. To keep the `hourly` snapshots only and remove those in between.\r\n> 4. (Haven't done it yet). Maybe we want to downsample to daily after a longer period. (Our previous batch ingestion pipeline is based on daily Sqoop jobs)\r\n\r\nIt coincides with my idea, I am also planing to manage snapshots in such way:\r\n1. keep hourly snapshot in current day;\r\n2. keep daily snapshots in current week;\r\n3. keep weekly snapshots in current month;\r\n4. etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776120425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776134887","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-776134887","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":776134887,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjEzNDg4Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T18:11:23Z","updated_at":"2021-02-09T18:11:23Z","author_association":"CONTRIBUTOR","body":"@pan3793 and @capkurmagati, thanks for your comments. I think there is definitely a use case here to keep fewer snapshots in table metadata. The only problem is that we need to understand what it will do to snapshot expiration for users that don't run the version that uses reachability sets.\r\n\r\nMaybe what we could do is add a property to disable incremental expiration before some snapshot when there was a break in history.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776134887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776149792","html_url":"https://github.com/apache/iceberg/issues/2208#issuecomment-776149792","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2208","id":776149792,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjE0OTc5Mg==","user":{"login":"ashajyothi828","id":40180859,"node_id":"MDQ6VXNlcjQwMTgwODU5","avatar_url":"https://avatars.githubusercontent.com/u/40180859?v=4","gravatar_id":"","url":"https://api.github.com/users/ashajyothi828","html_url":"https://github.com/ashajyothi828","followers_url":"https://api.github.com/users/ashajyothi828/followers","following_url":"https://api.github.com/users/ashajyothi828/following{/other_user}","gists_url":"https://api.github.com/users/ashajyothi828/gists{/gist_id}","starred_url":"https://api.github.com/users/ashajyothi828/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashajyothi828/subscriptions","organizations_url":"https://api.github.com/users/ashajyothi828/orgs","repos_url":"https://api.github.com/users/ashajyothi828/repos","events_url":"https://api.github.com/users/ashajyothi828/events{/privacy}","received_events_url":"https://api.github.com/users/ashajyothi828/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T18:33:59Z","updated_at":"2021-02-09T19:31:28Z","author_association":"NONE","body":"@stevenzwu Cant get the key from a record in the stream, the sink takes the stream as input and couldnt figure out how to get the key that applies to that stream. Basically tried to implement the below method in the sink and was not able to get the key value present in  RowData.\r\n\r\npublic DataStreamSink<?> consumeDataStream(DataStream<RowData> dataStream) {}","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776149792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776275696","html_url":"https://github.com/apache/iceberg/pull/2204#issuecomment-776275696","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2204","id":776275696,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjI3NTY5Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-09T22:05:39Z","updated_at":"2021-02-09T22:05:39Z","author_association":"CONTRIBUTOR","body":"Looks good now. Thanks @thomaschow!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776275696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776349503","html_url":"https://github.com/apache/iceberg/pull/2216#issuecomment-776349503","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2216","id":776349503,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjM0OTUwMw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T00:47:39Z","updated_at":"2021-02-10T00:47:39Z","author_association":"COLLABORATOR","body":"Hi @rdblue @aokolnychyi @openinx, This is a draft for replacing deletes. Could you please help to take a look and check whether this is the right direction? I'd like to add another API in action to compact multiple position deletes to one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776349503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776377189","html_url":"https://github.com/apache/iceberg/pull/2216#issuecomment-776377189","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2216","id":776377189,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjM3NzE4OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T02:00:41Z","updated_at":"2021-02-10T02:00:41Z","author_association":"CONTRIBUTOR","body":"I'll try to make time this week. Thanks for working on this, @chenjunjiedada!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776377189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776658400","html_url":"https://github.com/apache/iceberg/pull/2228#issuecomment-776658400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2228","id":776658400,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjY1ODQwMA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T11:58:22Z","updated_at":"2021-02-10T11:58:22Z","author_association":"CONTRIBUTOR","body":"@rdblue: Could you please review this if you have time?\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776658400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776729791","html_url":"https://github.com/apache/iceberg/issues/370#issuecomment-776729791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/370","id":776729791,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjcyOTc5MQ==","user":{"login":"pPanda-beta","id":20648934,"node_id":"MDQ6VXNlcjIwNjQ4OTM0","avatar_url":"https://avatars.githubusercontent.com/u/20648934?v=4","gravatar_id":"","url":"https://api.github.com/users/pPanda-beta","html_url":"https://github.com/pPanda-beta","followers_url":"https://api.github.com/users/pPanda-beta/followers","following_url":"https://api.github.com/users/pPanda-beta/following{/other_user}","gists_url":"https://api.github.com/users/pPanda-beta/gists{/gist_id}","starred_url":"https://api.github.com/users/pPanda-beta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pPanda-beta/subscriptions","organizations_url":"https://api.github.com/users/pPanda-beta/orgs","repos_url":"https://api.github.com/users/pPanda-beta/repos","events_url":"https://api.github.com/users/pPanda-beta/events{/privacy}","received_events_url":"https://api.github.com/users/pPanda-beta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T14:08:56Z","updated_at":"2021-02-10T14:08:56Z","author_association":"NONE","body":"I would recommend to use schematool or any other in-memory db than derby. \r\n\r\nMore at: \r\nhttps://issues.apache.org/jira/browse/HIVE-21302","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776729791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776871936","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-776871936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":776871936,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Njg3MTkzNg==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T17:15:33Z","updated_at":"2021-02-10T17:15:33Z","author_association":"CONTRIBUTOR","body":"So when we resolve we'd transform the table properties to point to column references. This would mean the table properties would sort of change underneath folks which might not be desirable, but it would simplify the logic for handling updates.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776871936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776935238","html_url":"https://github.com/apache/iceberg/pull/2220#issuecomment-776935238","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2220","id":776935238,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjkzNTIzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T18:56:45Z","updated_at":"2021-02-10T18:56:45Z","author_association":"CONTRIBUTOR","body":"I think this is a reasonable change. I'll commit it. We should note this in 0.12.0 release notes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776935238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776935583","html_url":"https://github.com/apache/iceberg/pull/2220#issuecomment-776935583","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2220","id":776935583,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjkzNTU4Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-10T18:57:17Z","updated_at":"2021-02-10T18:57:17Z","author_association":"CONTRIBUTOR","body":"Thanks for updating this, @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/776935583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/778506243","html_url":"https://github.com/apache/iceberg/pull/2234#issuecomment-778506243","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2234","id":778506243,"node_id":"MDEyOklzc3VlQ29tbWVudDc3ODUwNjI0Mw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-12T23:12:51Z","updated_at":"2021-02-12T23:13:33Z","author_association":"MEMBER","body":"@aokolnychyi What we were working on,\r\n\r\n@rdblue This isn't a big deal for the project at the moment, but when we move to 0.1.12 of parquet this test will break.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/778506243/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/778562142","html_url":"https://github.com/apache/iceberg/pull/2234#issuecomment-778562142","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2234","id":778562142,"node_id":"MDEyOklzc3VlQ29tbWVudDc3ODU2MjE0Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-13T04:37:34Z","updated_at":"2021-02-13T04:37:34Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/778562142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/778562259","html_url":"https://github.com/apache/iceberg/pull/2232#issuecomment-778562259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2232","id":778562259,"node_id":"MDEyOklzc3VlQ29tbWVudDc3ODU2MjI1OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-13T04:39:29Z","updated_at":"2021-02-13T04:39:29Z","author_association":"CONTRIBUTOR","body":"This looked correct to me so I merged it. @danielcweeks, let us know if you have any comments.\r\n\r\nThanks, @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/778562259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/778682629","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-778682629","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":778682629,"node_id":"MDEyOklzc3VlQ29tbWVudDc3ODY4MjYyOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-13T21:47:24Z","updated_at":"2021-02-13T21:47:24Z","author_association":"CONTRIBUTOR","body":"Thanks @yyanyy! I think this is getting close. The main thing is not exposing extra id-aware methods in the parser and also reading/writing manifests with IDs. Adding schema ID to snapshots will be a follow-up, right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/778682629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779213255","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-779213255","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":779213255,"node_id":"MDEyOklzc3VlQ29tbWVudDc3OTIxMzI1NQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-15T13:08:56Z","updated_at":"2021-02-15T13:08:56Z","author_association":"CONTRIBUTOR","body":"I have just found this PR when I was wondering how to migrate existing Hive tables to Iceberg tables.\r\nMy use-case is that I have an existing Hive table, and I would like to convert it to a Hive table backed by an Iceberg table in-place, and without moving the actual data. I would like to create the corresponding manifest files and the first snapshot using the existing files.\r\n\r\nWhen I sketched the code I found that I was listing the partitions / creating `DataFile` objects / creating a new Iceberg table and adding the data files to it. And then I have found that you have already did the same in the `Actions.migrateHive2Iceberg`. At first glance there is not too much Flink specific code in this change. Would it be hard to create a general tool for the migration instead of a Flink specific action?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779213255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779398025","html_url":"https://github.com/apache/iceberg/pull/2232#issuecomment-779398025","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2232","id":779398025,"node_id":"MDEyOklzc3VlQ29tbWVudDc3OTM5ODAyNQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-15T18:52:09Z","updated_at":"2021-02-15T18:52:09Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779398025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779506177","html_url":"https://github.com/apache/iceberg/pull/2238#issuecomment-779506177","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2238","id":779506177,"node_id":"MDEyOklzc3VlQ29tbWVudDc3OTUwNjE3Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T00:20:30Z","updated_at":"2021-02-16T00:20:30Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @holdenk @RussellSpitzer @viirya @dilipbiswal ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779506177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779567233","html_url":"https://github.com/apache/iceberg/pull/2238#issuecomment-779567233","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2238","id":779567233,"node_id":"MDEyOklzc3VlQ29tbWVudDc3OTU2NzIzMw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T04:07:01Z","updated_at":"2021-02-16T04:07:01Z","author_association":"MEMBER","body":"Looks good to me","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779567233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779675432","html_url":"https://github.com/apache/iceberg/pull/2237#issuecomment-779675432","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2237","id":779675432,"node_id":"MDEyOklzc3VlQ29tbWVudDc3OTY3NTQzMg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T08:35:12Z","updated_at":"2021-02-16T08:35:12Z","author_association":"CONTRIBUTOR","body":"btw, there is a spelling mistake at https://github.com/apache/iceberg/blob/master/aws/src/main/java/org/apache/iceberg/aws/s3/S3OutputFile.java#L60, could you also fix that when merging this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779675432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779714521","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-779714521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":779714521,"node_id":"MDEyOklzc3VlQ29tbWVudDc3OTcxNDUyMQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T09:44:57Z","updated_at":"2021-02-16T14:46:54Z","author_association":"COLLABORATOR","body":"Change Background:\r\n\r\nA suggestion from @aokolnychyi , we find that users do not tend to fine-tune column metrics.  The default truncate(16) does not do much for certain sortable types, and reduces benefits of predicate pruning.  Cost of storing full metrics should be small as number of sorted columns will be generally small.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779714521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779894886","html_url":"https://github.com/apache/iceberg/pull/2228#issuecomment-779894886","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2228","id":779894886,"node_id":"MDEyOklzc3VlQ29tbWVudDc3OTg5NDg4Ng==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T15:02:57Z","updated_at":"2021-02-16T15:02:57Z","author_association":"CONTRIBUTOR","body":"@rdblue: Are you still available? If so could you please review?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779894886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779994102","html_url":"https://github.com/apache/iceberg/pull/2241#issuecomment-779994102","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2241","id":779994102,"node_id":"MDEyOklzc3VlQ29tbWVudDc3OTk5NDEwMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T17:26:06Z","updated_at":"2021-02-16T17:26:18Z","author_association":"CONTRIBUTOR","body":"@shardulm94 @rdblue @chenjunjiedada @RussellSpitzer @dilipbiswal, could you please review this one?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/779994102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780000345","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780000345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780000345,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDAwMDM0NQ==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T17:36:02Z","updated_at":"2021-02-16T17:36:02Z","author_association":"CONTRIBUTOR","body":"So @aokolnychyi WDYT?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780000345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780003677","html_url":"https://github.com/apache/iceberg/pull/2242#issuecomment-780003677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2242","id":780003677,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDAwMzY3Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T17:41:15Z","updated_at":"2021-02-16T17:41:15Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @dilipbiswal @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780003677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780009232","html_url":"https://github.com/apache/iceberg/pull/2243#issuecomment-780009232","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2243","id":780009232,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDAwOTIzMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T17:50:27Z","updated_at":"2021-02-16T17:50:27Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @dilipbiswal @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780009232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780020719","html_url":"https://github.com/apache/iceberg/pull/2243#issuecomment-780020719","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2243","id":780020719,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDAyMDcxOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T18:08:40Z","updated_at":"2021-02-16T18:08:40Z","author_association":"CONTRIBUTOR","body":"Yep, @RussellSpitzer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780020719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780039025","html_url":"https://github.com/apache/iceberg/pull/2241#issuecomment-780039025","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2241","id":780039025,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDAzOTAyNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-16T18:39:36Z","updated_at":"2021-02-16T18:39:36Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780039025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780382563","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-780382563","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":780382563,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDM4MjU2Mw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T08:11:02Z","updated_at":"2021-02-17T08:11:02Z","author_association":"CONTRIBUTOR","body":"> I have just found this PR when I was wondering how to migrate existing Hive tables to Iceberg tables.\r\n> My use-case is that I have an existing Hive table, and I would like to convert it to a Hive table backed by an Iceberg table in-place, and without moving the actual data. I would like to create the corresponding manifest files and the first snapshot using the existing files.\r\n> \r\n> When I sketched the code I found that I was listing the partitions / creating `DataFile` objects / creating a new Iceberg table and adding the data files to it. And then I have found that you have already did the same in the `Actions.migrateHive2Iceberg`. At first glance there is not too much Flink specific code in this change. Would it be hard to create a general tool for the migration instead of a Flink specific action?\r\n> \r\n> Thanks,\r\n> Peter\r\n\r\nWe can make a tool to do this migration work, just like the snapshot expired, iceberg provides Java api and a spark action, but for some large hive tables, if it is only done through the Java api, it may be very slow, using  the engine (spark or flink) can increase the speed of migration. If we only migrate a small hive table, we can run the flink program on our own machine, just like a test case.  What do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780382563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780386224","html_url":"https://github.com/apache/iceberg/pull/2149#issuecomment-780386224","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2149","id":780386224,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDM4NjIyNA==","user":{"login":"saurabhagas","id":5038921,"node_id":"MDQ6VXNlcjUwMzg5MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5038921?v=4","gravatar_id":"","url":"https://api.github.com/users/saurabhagas","html_url":"https://github.com/saurabhagas","followers_url":"https://api.github.com/users/saurabhagas/followers","following_url":"https://api.github.com/users/saurabhagas/following{/other_user}","gists_url":"https://api.github.com/users/saurabhagas/gists{/gist_id}","starred_url":"https://api.github.com/users/saurabhagas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saurabhagas/subscriptions","organizations_url":"https://api.github.com/users/saurabhagas/orgs","repos_url":"https://api.github.com/users/saurabhagas/repos","events_url":"https://api.github.com/users/saurabhagas/events{/privacy}","received_events_url":"https://api.github.com/users/saurabhagas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T08:18:32Z","updated_at":"2021-02-17T08:33:03Z","author_association":"NONE","body":"> I'm closing this since there was no reply. Feel free to reopen if you have time to pick it back up.\r\n\r\n@rdblue, sorry, this issue fell out of my radar.  I had given the reasoning behind this change in the tracking issue: https://github.com/apache/iceberg/issues/2148 (I've edited the description slightly to help the reader). If you're convinced, please reopen the PR and accept the change. Note that, I'm only interest in the class and its `ParquetConversions::fromParquetPrimitive` method, not all the methods in the class.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780386224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780517320","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-780517320","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":780517320,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDUxNzMyMA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T12:16:12Z","updated_at":"2021-02-17T12:16:12Z","author_association":"CONTRIBUTOR","body":"> We can make a tool to do this migration work, just like the snapshot expired, iceberg provides Java api and a spark action, but for some large hive tables, if it is only done through the Java api, it may be very slow, using the engine (spark or flink) can increase the speed of migration. If we only migrate a small hive table, we can run the flink program on our own machine, just like a test case. What do you think?\r\n\r\nSounds good. My only concern is the dependency on `StreamExecutionEnvironment` and other Flink constructs. That would cause Flink dependency, even if we do not use Flink for a minimal local migration. Is there a way to separate the logic and the parallel execution?\r\n\r\nWhat is the number of partitions/files when the parallelization becomes necessary? (Just out of curiosity, you might have some numbers)\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780517320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780800588","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-780800588","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":780800588,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDgwMDU4OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T19:36:22Z","updated_at":"2021-02-17T19:36:22Z","author_association":"CONTRIBUTOR","body":"Thanks for the PR, @szehon-ho! Let me take a look now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780800588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780811718","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780811718","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780811718,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDgxMTcxOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T19:54:18Z","updated_at":"2021-02-17T19:54:18Z","author_association":"CONTRIBUTOR","body":"Oops, I missed the last comment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780811718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780818768","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780818768","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780818768,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDgxODc2OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T20:03:47Z","updated_at":"2021-02-17T20:03:47Z","author_association":"CONTRIBUTOR","body":"So, @holdenk, are you saying instead of modifying the table properties during schema evolution, try to resolve them correctly during writes?\r\n\r\nLet's take an example. Suppose we have a metrics config for `sort_col_1` as `full`. Then we rename `sort_col_1` into `sort_col_2`. What should happen with metrics? I am afraid it will fail now as there is no `sort_col_1` anymore. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780818768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780820543","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-780820543","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":780820543,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDgyMDU0Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T20:07:16Z","updated_at":"2021-02-17T20:07:16Z","author_association":"CONTRIBUTOR","body":"@rdblue, you mean users that rely on the Table API for expiring snapshots? That probably does not rely on reachability set.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780820543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780829301","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-780829301","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":780829301,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDgyOTMwMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T20:22:28Z","updated_at":"2021-02-17T20:22:28Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer's comment on supporting streaming reads is a good one. Expiring snapshots in the middle will probably break that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780829301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780829314","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-780829314","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":780829314,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDgyOTMxNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T20:22:29Z","updated_at":"2021-02-17T20:22:29Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, yes I am talking about the table API for expiring snapshots. That uses an incremental approach. We would need to either convert that to a reachability-based implementation (which would be slower, but good to have) or disable it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780829314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780830166","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780830166","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780830166,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDgzMDE2Ng==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T20:23:57Z","updated_at":"2021-02-17T20:23:57Z","author_association":"CONTRIBUTOR","body":"So what I'm saying is when we write out table properties we resolve the current column name to the column index and write out the column index.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780830166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780832144","html_url":"https://github.com/apache/iceberg/issues/2221#issuecomment-780832144","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2221","id":780832144,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDgzMjE0NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T20:27:32Z","updated_at":"2021-02-17T20:27:32Z","author_association":"CONTRIBUTOR","body":"Well, I think we should delay adding new params to the procedure for now given the points that were raised.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780832144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780832994","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780832994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780832994,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDgzMjk5NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T20:29:05Z","updated_at":"2021-02-17T20:29:05Z","author_association":"CONTRIBUTOR","body":"Essentially migrate the metrics config to use column ids instead of column names?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780832994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780842763","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780842763","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780842763,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDg0Mjc2Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T20:47:07Z","updated_at":"2021-02-17T20:47:07Z","author_association":"CONTRIBUTOR","body":"Let me summarize how I got it.\r\n\r\nThe idea is to interpret table properties like `write.metadata.metrics.col1` as `write.metadata.metrics.10` (where 10 is the column id of `col1`). That way, we don't have to do anything when a column is renamed as the id stays same. We will also need to add some logic to convert column ids back into column names when showing table properties to the user.\r\n\r\n When we drop `col1`, it is alright to keep the old property and it will simply not be shown to the user?\r\n\r\nIs that the idea, @holdenk?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780842763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780847481","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780847481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780847481,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDg0NzQ4MQ==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T20:55:58Z","updated_at":"2021-02-17T20:55:58Z","author_association":"CONTRIBUTOR","body":"That's the idea, however now that I'm looking at the code again that would require changing the (public) API of `MetricsConfig.java` so it's maybe not ideal.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780847481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780850155","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780850155","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780850155,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDg1MDE1NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T21:00:56Z","updated_at":"2021-02-17T21:00:56Z","author_association":"CONTRIBUTOR","body":"We have been discussing using column ids in the metrics config for a while. I'd support the migration now.\r\n\r\n@RussellSpitzer @rdblue @shardulm94 @danielcweeks @pvary @openinx, thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780850155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780856834","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780856834","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780856834,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDg1NjgzNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T21:12:39Z","updated_at":"2021-02-17T21:12:39Z","author_association":"CONTRIBUTOR","body":"We will have to be careful with existing tables as they may be accessed by different versions of Iceberg but I feel we can figure that out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780856834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780860046","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-780860046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":780860046,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDg2MDA0Ng==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T21:17:30Z","updated_at":"2021-02-17T21:17:30Z","author_association":"CONTRIBUTOR","body":"Ah, that's a good point, how about I start with the rewriting for now and we can figure out what we want to do with the translation later?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780860046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780900517","html_url":"https://github.com/apache/iceberg/pull/2248#issuecomment-780900517","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2248","id":780900517,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDkwMDUxNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T22:37:11Z","updated_at":"2021-02-17T22:37:11Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @rdsr @RussellSpitzer @holdenk @shardulm94 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780900517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780928394","html_url":"https://github.com/apache/iceberg/issues/2249#issuecomment-780928394","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2249","id":780928394,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDkyODM5NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-17T23:45:45Z","updated_at":"2021-02-17T23:45:45Z","author_association":"CONTRIBUTOR","body":"@pvary, what do you think? I think if we drop table properties, they will be still in HMS, leaving props out of sync.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780928394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780974521","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-780974521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":780974521,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDk3NDUyMQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T01:36:04Z","updated_at":"2021-02-18T01:36:04Z","author_association":"CONTRIBUTOR","body":"> Sounds good. My only concern is the dependency on `StreamExecutionEnvironment` and other Flink constructs. That would cause Flink dependency, even if we do not use Flink for a minimal local migration. Is there a way to separate the logic and the parallel execution?\r\n\r\nAre you concern the conflict between `StreamExecutionEnvironment` and other flink constructs? `StreamExecutionEnvironment` is the basic environment for flink program execution. it will not conflict with other construction methods.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780974521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780975701","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-780975701","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":780975701,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDk3NTcwMQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T01:38:52Z","updated_at":"2021-02-18T01:38:52Z","author_association":"CONTRIBUTOR","body":"> What is the number of partitions/files when the parallelization becomes necessary? (Just out of curiosity, you might have some numbers)\r\n\r\nNow, the parallelism setting of flink is divided into two situations. For unpartitioned tables, I think it may be a small table. The current parallelism is the default parallelism of flink. For partitioned tables, the parallelism of flink job is  the number of partitions, but  In order to prevent too many partitions, causing migration job to request a lot of resources, users can set a max parallelism. When the number of partitions is greater than this max parallelism, the actual parallelism of the flink migrate job uses the configured max parallelism.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780975701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780975835","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-780975835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":780975835,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDk3NTgzNQ==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T01:39:12Z","updated_at":"2021-02-18T01:39:12Z","author_association":"CONTRIBUTOR","body":"> Thanks @yyanyy! I think this is getting close. The main thing is not exposing extra id-aware methods in the parser and also reading/writing manifests with IDs. Adding schema ID to snapshots will be a follow-up, right?\r\n\r\nThanks for the review and sorry for delay responding! And yes, schema ID to snapshot will be a follow up PR. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780975835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780992492","html_url":"https://github.com/apache/iceberg/issues/2068#issuecomment-780992492","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2068","id":780992492,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MDk5MjQ5Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T02:15:09Z","updated_at":"2021-02-18T02:15:09Z","author_association":"CONTRIBUTOR","body":"I think that we should only infer partitioning when we know that we are converting from a Hive table with identity-partition columns. Since that is a \"well-known\" format, it should be somewhat reliable. Random paths in a file system are more risky to parse for table data. I could be convinced otherwise, but it seems like a stretch to match an Iceberg table's partitioning to paths.\r\n\r\n+1 to checking file footers before importing. The files should not have IDs in the schemas and we should make sure that the schemas can be converted to something readable using the name mapping.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/780992492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781005093","html_url":"https://github.com/apache/iceberg/pull/2230#issuecomment-781005093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2230","id":781005093,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTAwNTA5Mw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T02:48:22Z","updated_at":"2021-02-18T02:48:22Z","author_association":"MEMBER","body":"> 1. this has a lot of similarity with the S3FileIO. As more services add support for Iceberg, should we extract the common logic to have a `ObjectStorageFileIO` in core? @rdblue what do you think?\r\n\r\nI think it may not worth to abstract the `ObjectStorageFileIO`.  In this PR we could see that aliyun `OSSFileIO` is quite similar to aws `S3FileIO` because aliyun object storage services are defining their API which are quite similar to aws API (When I implements the OSSMockApplication, I found that most of the arguments & API names are the same),  though we could make abstraction between aliyun & aws,  azure & google cloud storage API will be a quite different story,  we won't know whether does the abstraction match azure blob storage or GCS unless we implement the azure blob storage `FileIO` and GCS `FileIO`. \r\n\r\n> 2. I really like the approach for the mock application, but it feels that the whole thing can be published by aliyun for Iceberg to import. So just curious, any plan for that in the long term?\r\n\r\nAliyun Object storage services team is another team in our company,  seems currently they don't have the plan to maintain in their aliyun oss sdk release.  For our iceberg integration work,  we are just depending on few APIs so we don't have to maintain all the API from the aliyun official documents ( It's actually lightweight enough to get this OSSMockApplication in iceberg repo).  Another side, according to my observation, aliyun OSS API has been relatively stable for a long time, the maintenance cost is controllable for us. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781005093/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781040286","html_url":"https://github.com/apache/iceberg/issues/2068#issuecomment-781040286","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2068","id":781040286,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTA0MDI4Ng==","user":{"login":"electrum","id":9230,"node_id":"MDQ6VXNlcjkyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9230?v=4","gravatar_id":"","url":"https://api.github.com/users/electrum","html_url":"https://github.com/electrum","followers_url":"https://api.github.com/users/electrum/followers","following_url":"https://api.github.com/users/electrum/following{/other_user}","gists_url":"https://api.github.com/users/electrum/gists{/gist_id}","starred_url":"https://api.github.com/users/electrum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrum/subscriptions","organizations_url":"https://api.github.com/users/electrum/orgs","repos_url":"https://api.github.com/users/electrum/repos","events_url":"https://api.github.com/users/electrum/events{/privacy}","received_events_url":"https://api.github.com/users/electrum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T04:25:54Z","updated_at":"2021-02-18T04:25:54Z","author_association":"CONTRIBUTOR","body":"One more thing to add to the spec is that identity columns dont need to be present in the data file, since that is the case for Hive files. We support this in Trino, but I dont think it or any other migration scenario is tested.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781040286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781103072","html_url":"https://github.com/apache/iceberg/pull/2214#issuecomment-781103072","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2214","id":781103072,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTEwMzA3Mg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T06:56:03Z","updated_at":"2021-02-18T06:56:03Z","author_association":"CONTRIBUTOR","body":"The code change looks good to me, but I am a bit confused about the scope of this PR (I only read  the Spark path, but the same applies to Flink). In `SparkAppenderFactory`, only the constructor and `newEqDeleteWriter` are updated, but `newDataWriter` is not updated. The callers of the methods up to `SparkWrite.WriterFactory` are not updated to include sort order, so the methods you updated are basically not used. Do you plan to add all those things in another PR? I feel we can just add them here, based on what your title suggests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781103072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781105164","html_url":"https://github.com/apache/iceberg/pull/2010#issuecomment-781105164","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2010","id":781105164,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTEwNTE2NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T07:00:05Z","updated_at":"2021-02-18T07:00:05Z","author_association":"CONTRIBUTOR","body":"@openinx happy new year, any update for this? I think we can derive the row id feature for format v2 based on this PR. I can raise another one if you don't have time to do it here. And @rdblue any thoughts on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781105164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781257528","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-781257528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":781257528,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTI1NzUyOA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T10:51:55Z","updated_at":"2021-02-18T10:51:55Z","author_association":"CONTRIBUTOR","body":"I am looking for a way to migrate a native Hive table to a Hive table backed by an Iceberg table, and during my search I found this PR (along with the #2068 - Procedure for adding files to a Table), but I have also found the same thing for Flink: #2217 (Flink : migrate hive table to iceberg table).\r\n\r\nMaybe we should factor-out the common parts to a place which is accessible for both Spark and Flink (and for Hive as well). Like a common java API or something like it. Would this be possible?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781257528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781258888","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-781258888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":781258888,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTI1ODg4OA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T10:54:24Z","updated_at":"2021-02-18T10:54:24Z","author_association":"CONTRIBUTOR","body":"Found #2210 for Spark which tries to archive the same. We might want to synchronize our efforts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781258888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781260690","html_url":"https://github.com/apache/iceberg/issues/2249#issuecomment-781260690","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2249","id":781260690,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTI2MDY5MA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T10:57:41Z","updated_at":"2021-02-18T10:57:41Z","author_association":"CONTRIBUTOR","body":"When we will have the full sync, we definitely want to do this.\r\nOTOH we have to be careful with Hive related props like stats etc.\r\n\r\nTagged @marton-bod, as he has the property sync on his agenda","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781260690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781285453","html_url":"https://github.com/apache/iceberg/pull/2246#issuecomment-781285453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2246","id":781285453,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTI4NTQ1Mw==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T11:43:23Z","updated_at":"2021-02-18T11:43:23Z","author_association":"COLLABORATOR","body":"Thanks for the merge @pvary!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781285453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781309976","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-781309976","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":781309976,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTMwOTk3Ng==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T12:30:14Z","updated_at":"2021-02-18T12:31:24Z","author_association":"CONTRIBUTOR","body":"What happens if we have missing metrics? Could we still read the data, or we error out?\r\n\r\nAnyway, I would suggest to have a different prefix for the new properties, so we do not accidentally try to read column names as column ids or column ids as names.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781309976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781341675","html_url":"https://github.com/apache/iceberg/issues/2249#issuecomment-781341675","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2249","id":781341675,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTM0MTY3NQ==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T13:25:39Z","updated_at":"2021-02-18T13:25:39Z","author_association":"COLLABORATOR","body":"Hi Anton, \r\nGood point. I agree that we should try to keep the Iceberg and HMS table props in sync (perhaps with some additional props present only in HMS, as needed by Hive). There are 2 directions here:\r\n- Iceberg -> HMS: New and updated Iceberg properties are already pushed to HMS. As for deleted props, I can work on unsetting any HMS properties that are no longer present in the Iceberg table props. At first glance, this would be based on which keys are present in `base.properties()`, but are no longer present in `metadata.properties()` in `doCommit`.\r\n- HMS -> Iceberg: Our plan is to extend the hive `MetaHook` interface to add a `postAlterTable` method which is currently missing that'd enable users to run an `ALTER TABLE tbl SET TBLPROPERTIES('foo'='bar')` DDL from hive and get the prop change pushed down the to the Iceberg table props as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781341675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781350027","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-781350027","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":781350027,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTM1MDAyNw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T13:39:09Z","updated_at":"2021-02-18T13:39:09Z","author_association":"MEMBER","body":"@pvary we also have the migrate and snapshot actions","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781350027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781530064","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-781530064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":781530064,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTUzMDA2NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T18:00:08Z","updated_at":"2021-02-18T18:00:08Z","author_association":"CONTRIBUTOR","body":"> Ah, that's a good point, how about I start with the rewriting for now and we can figure out what we want to do with the translation later?\r\n\r\nSeems like old writers would still need us to rewrite, yeah.\r\n\r\n> What happens if we have missing metrics? Could we still read the data, or we error out?\r\n\r\nI *think* we just use the default value and never fail writes. If that is not the case, we should fix it.\r\n\r\n> Anyway, I would suggest to have a different prefix for the new properties,\r\n\r\nMaybe we can have some prefix for internal properties we don't want to show to the user? Thoughts, @holdenk @pvary @rdblue @RussellSpitzer?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781530064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781538336","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-781538336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":781538336,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTUzODMzNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T18:13:29Z","updated_at":"2021-02-18T18:13:29Z","author_association":"CONTRIBUTOR","body":"Also adding @RussellSpitzer who did the snapshot and migrate actions.\r\n\r\nRussell, could you take a look to make sure the migration path is similar for both query engines?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781538336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781548766","html_url":"https://github.com/apache/iceberg/pull/2248#issuecomment-781548766","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2248","id":781548766,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTU0ODc2Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T18:29:58Z","updated_at":"2021-02-18T18:29:58Z","author_association":"CONTRIBUTOR","body":"@shardulm94, this one is ready for another review round.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781548766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781550067","html_url":"https://github.com/apache/iceberg/pull/2250#issuecomment-781550067","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2250","id":781550067,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTU1MDA2Nw==","user":{"login":"prodeezy","id":1474591,"node_id":"MDQ6VXNlcjE0NzQ1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1474591?v=4","gravatar_id":"","url":"https://api.github.com/users/prodeezy","html_url":"https://github.com/prodeezy","followers_url":"https://api.github.com/users/prodeezy/followers","following_url":"https://api.github.com/users/prodeezy/following{/other_user}","gists_url":"https://api.github.com/users/prodeezy/gists{/gist_id}","starred_url":"https://api.github.com/users/prodeezy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prodeezy/subscriptions","organizations_url":"https://api.github.com/users/prodeezy/orgs","repos_url":"https://api.github.com/users/prodeezy/repos","events_url":"https://api.github.com/users/prodeezy/events{/privacy}","received_events_url":"https://api.github.com/users/prodeezy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T18:32:12Z","updated_at":"2021-02-18T18:32:12Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @jackye1995 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781550067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781570169","html_url":"https://github.com/apache/iceberg/pull/2230#issuecomment-781570169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2230","id":781570169,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTU3MDE2OQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T19:07:11Z","updated_at":"2021-02-18T19:07:11Z","author_association":"CONTRIBUTOR","body":"> I think it may not worth to abstract the ObjectStorageFileIO. In this PR we could see that aliyun OSSFileIO is quite similar to aws S3FileIO because aliyun object storage services are defining their API which are quite similar to aws API\r\n\r\nCool, in that case let's just take a note for each other when there are major changes happening to any of the FileIO, to see if the change is applicable to the other side.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781570169/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781651109","html_url":"https://github.com/apache/iceberg/pull/2250#issuecomment-781651109","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2250","id":781651109,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTY1MTEwOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T21:37:31Z","updated_at":"2021-02-18T21:37:31Z","author_association":"CONTRIBUTOR","body":"Thanks, @prodeezy!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781651109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781664020","html_url":"https://github.com/apache/iceberg/pull/2214#issuecomment-781664020","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2214","id":781664020,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTY2NDAyMA==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-18T22:03:10Z","updated_at":"2021-02-18T22:03:10Z","author_association":"CONTRIBUTOR","body":"Thanks Jack for reviewing the PR!\r\n\r\n> but newDataWriter is not updated. \r\n\r\nI think `newDataWriter` does have it in the last argument of constructor `DataWriter`? Or did I misunderstand your question? If you were actually referring to `newAppender`, since the creation of `ContentFile` that stores sort order information is outside the responsibility of `FileAppender`, the caller of it that creates data/delete file is responsible for passing the sort order around. I think it's the same reason as why we created `DataWriter`.\r\n\r\n> the methods you updated are basically not used\r\n\r\nYes, in this PR I was trying to add capability of passing sortOrder info to writers within Iceberg library. I did think about expanding the support to `SparkWrite` but eventually felt a bit hesitant to do so, since at the time when I worked on this PR, in Spark community the sort order design was in an early phase, and I wasn't sure if my assumption on how sort order information comes from in `SparkWrite` is accurate, that I'd rather let people who are the expert in individual engines to do this integration with library writers since they have to also integrate with engine anyway. I think the row level delete support is also in this style - `SparkAppenderFactory` constructor could take in row level delete related arguments, but `SparkWrite` and other spark code are not using such constructor yet. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781664020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781751681","html_url":"https://github.com/apache/iceberg/pull/2092#issuecomment-781751681","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2092","id":781751681,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTc1MTY4MQ==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T01:31:36Z","updated_at":"2021-02-19T01:31:36Z","author_association":"CONTRIBUTOR","body":"hi @rdblue would you please take another look at this PR at your convenience.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781751681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781758990","html_url":"https://github.com/apache/iceberg/pull/2092#issuecomment-781758990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2092","id":781758990,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTc1ODk5MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T01:53:46Z","updated_at":"2021-02-19T01:53:46Z","author_association":"CONTRIBUTOR","body":"Will do. Thanks for pinging me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781758990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781793924","html_url":"https://github.com/apache/iceberg/issues/2219#issuecomment-781793924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2219","id":781793924,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTc5MzkyNA==","user":{"login":"liudi1184","id":30306636,"node_id":"MDQ6VXNlcjMwMzA2NjM2","avatar_url":"https://avatars.githubusercontent.com/u/30306636?v=4","gravatar_id":"","url":"https://api.github.com/users/liudi1184","html_url":"https://github.com/liudi1184","followers_url":"https://api.github.com/users/liudi1184/followers","following_url":"https://api.github.com/users/liudi1184/following{/other_user}","gists_url":"https://api.github.com/users/liudi1184/gists{/gist_id}","starred_url":"https://api.github.com/users/liudi1184/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liudi1184/subscriptions","organizations_url":"https://api.github.com/users/liudi1184/orgs","repos_url":"https://api.github.com/users/liudi1184/repos","events_url":"https://api.github.com/users/liudi1184/events{/privacy}","received_events_url":"https://api.github.com/users/liudi1184/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T03:40:26Z","updated_at":"2021-02-19T03:40:26Z","author_association":"NONE","body":"I also follow your method, but I think there may be problems. When tracing the source code, we found that these fields were serialized as UnmodifiableMap, and then put elements into it, so an exception occurred.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781793924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]