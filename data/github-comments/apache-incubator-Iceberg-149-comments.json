[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042383593","html_url":"https://github.com/apache/iceberg/pull/4118#issuecomment-1042383593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4118","id":1042383593,"node_id":"IC_kwDOCW7NX84-IYLp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-16T22:47:14Z","updated_at":"2022-02-16T22:47:14Z","author_association":"CONTRIBUTOR","body":"I agree. Let's remove the dependency and use the one from Spark. Looks like we were incorrectly shading anyway because we didn't relocate the classes!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042383593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042384808","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042384808","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042384808,"node_id":"IC_kwDOCW7NX84-IYeo","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-16T22:49:18Z","updated_at":"2022-02-16T22:49:18Z","author_association":"CONTRIBUTOR","body":"@zhongyujiang, I think I would prefer a fix that avoids the root cause but still runs the test in streaming mode. I understand your concern about not being able to necessarily guarantee we won't have a flaky test, but we can probably set that high enough (1s?) that we don't see it in practice.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042384808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042394054","html_url":"https://github.com/apache/iceberg/pull/4140#issuecomment-1042394054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4140","id":1042394054,"node_id":"IC_kwDOCW7NX84-IavG","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-16T23:04:44Z","updated_at":"2022-02-16T23:04:44Z","author_association":"MEMBER","body":"> We rarely change this class, so I'm not sure it's worth all the reformatting and extra builder, but I'm okay with this if @RussellSpitzer is in favor.\r\n\r\nI basically feel the same way, unless we had some plans to add a lot more to this class I think it's probably fine the way it is. That's why I asked above what the new planned fields were.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042394054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042395900","html_url":"https://github.com/apache/iceberg/pull/4132#issuecomment-1042395900","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4132","id":1042395900,"node_id":"IC_kwDOCW7NX84-IbL8","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-16T23:07:55Z","updated_at":"2022-02-16T23:07:55Z","author_association":"MEMBER","body":"The description makes sense to me here, It will take me some time though to get through this whole PR, I'll try to set aside time later this week.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042395900/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042422713","html_url":"https://github.com/apache/iceberg/pull/4050#issuecomment-1042422713","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4050","id":1042422713,"node_id":"IC_kwDOCW7NX84-Ihu5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-16T23:57:17Z","updated_at":"2022-02-16T23:57:17Z","author_association":"CONTRIBUTOR","body":"Looks good to me once tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042422713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042448640","html_url":"https://github.com/apache/iceberg/pull/4140#issuecomment-1042448640","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4140","id":1042448640,"node_id":"IC_kwDOCW7NX84-IoEA","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T00:40:41Z","updated_at":"2022-02-17T00:40:41Z","author_association":"CONTRIBUTOR","body":"thanks @RussellSpitzer @rdblue .\r\nI got touched this class in #4115 when I want to add an plan executor. and found the noisy update way. to avoid always thinking like ' let's refactor it NEXT time ' and leading to more and more meaningless updates, I tried to do this right now here.\r\n\r\nIf it's really rarely updated, it's definitely ok to leave it as the way it is and close this PR.\r\n\r\nAnd given it's a simple change, i didn't open an issue in advance to discuss it. Sorry for that.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042448640/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042459386","html_url":"https://github.com/apache/iceberg/pull/2496#issuecomment-1042459386","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2496","id":1042459386,"node_id":"IC_kwDOCW7NX84-Iqr6","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T00:55:32Z","updated_at":"2022-02-17T00:55:32Z","author_association":"CONTRIBUTOR","body":"I'm not sure I understood the part about the call stack, but it seems that SQL behavior is to act as though the values is written into data files. I'm okay bending the rules a bit by making it an incompatible change, but I think that rewrites _should_ write the default value into data files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042459386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042486163","html_url":"https://github.com/apache/iceberg/issues/4114#issuecomment-1042486163","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4114","id":1042486163,"node_id":"IC_kwDOCW7NX84-IxOT","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T01:47:52Z","updated_at":"2022-02-17T01:47:52Z","author_association":"CONTRIBUTOR","body":"thanks @RussellSpitzer , I try test again and close this issues.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042486163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042493460","html_url":"https://github.com/apache/iceberg/issues/4090#issuecomment-1042493460","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4090","id":1042493460,"node_id":"IC_kwDOCW7NX84-IzAU","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T02:03:42Z","updated_at":"2022-02-17T02:03:42Z","author_association":"CONTRIBUTOR","body":"I think @szehon-ho is right. It looks like a race condition between the first delete (which may be attempted as a metadata delete) and the first insert into the table. Let me see the PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042493460/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042498233","html_url":"https://github.com/apache/iceberg/pull/4123#issuecomment-1042498233","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4123","id":1042498233,"node_id":"IC_kwDOCW7NX84-I0K5","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T02:12:50Z","updated_at":"2022-02-17T02:12:50Z","author_association":"CONTRIBUTOR","body":"I agree with the analysis. I had one nit but LGTM otherwise. Thanks, @szehon-ho for fixing and @KarlManong for reporting.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042498233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042518335","html_url":"https://github.com/apache/iceberg/issues/4072#issuecomment-1042518335","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4072","id":1042518335,"node_id":"IC_kwDOCW7NX84-I5E_","user":{"login":"haizhou-zhao","id":6187287,"node_id":"MDQ6VXNlcjYxODcyODc=","avatar_url":"https://avatars.githubusercontent.com/u/6187287?v=4","gravatar_id":"","url":"https://api.github.com/users/haizhou-zhao","html_url":"https://github.com/haizhou-zhao","followers_url":"https://api.github.com/users/haizhou-zhao/followers","following_url":"https://api.github.com/users/haizhou-zhao/following{/other_user}","gists_url":"https://api.github.com/users/haizhou-zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/haizhou-zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haizhou-zhao/subscriptions","organizations_url":"https://api.github.com/users/haizhou-zhao/orgs","repos_url":"https://api.github.com/users/haizhou-zhao/repos","events_url":"https://api.github.com/users/haizhou-zhao/events{/privacy}","received_events_url":"https://api.github.com/users/haizhou-zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T02:57:31Z","updated_at":"2022-02-17T02:57:31Z","author_association":"CONTRIBUTOR","body":"To summarize, the issue is incurred because ID properties are not preserved when projecting list schema. (We also found the same issue for map schema). It should be fixed by https://github.com/apache/iceberg/pull/4120.\r\n\r\nThanks @RussellSpitzer for helping out with the issue. I'm closing this as the PR mentioned above is fixed.\r\n\r\nAlso thanks to @rdblue @szehon-ho for reviewing the PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042518335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042551916","html_url":"https://github.com/apache/iceberg/pull/4115#issuecomment-1042551916","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4115","id":1042551916,"node_id":"IC_kwDOCW7NX84-JBRs","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T04:04:28Z","updated_at":"2022-02-17T04:04:28Z","author_association":"CONTRIBUTOR","body":"Hi @rdblue, i've created a new issue #4145 to track the api changes for different types of operations.\r\nPlease switch to the new PRs, after these PRs are merged, we can continue to fix #3776 in Flink.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042551916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042552146","html_url":"https://github.com/apache/iceberg/issues/4145#issuecomment-1042552146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4145","id":1042552146,"node_id":"IC_kwDOCW7NX84-JBVS","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T04:04:56Z","updated_at":"2022-02-17T04:04:56Z","author_association":"CONTRIBUTOR","body":"cc @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042552146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042561841","html_url":"https://github.com/apache/iceberg/issues/4072#issuecomment-1042561841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4072","id":1042561841,"node_id":"IC_kwDOCW7NX84-JDsx","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T04:24:38Z","updated_at":"2022-02-17T04:24:38Z","author_association":"COLLABORATOR","body":"Nice work!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042561841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042597162","html_url":"https://github.com/apache/iceberg/issues/3898#issuecomment-1042597162","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3898","id":1042597162,"node_id":"IC_kwDOCW7NX84-JMUq","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T05:46:55Z","updated_at":"2022-02-17T05:46:55Z","author_association":"CONTRIBUTOR","body":"I'd like to try it. Could you please assign it to me?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042597162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042599627","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042599627","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042599627,"node_id":"IC_kwDOCW7NX84-JM7L","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T05:52:46Z","updated_at":"2022-02-17T05:52:46Z","author_association":"CONTRIBUTOR","body":"@rdblue I have updated, not sure 1s is high enough but let's give it a try first.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042599627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042622082","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042622082","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042622082,"node_id":"IC_kwDOCW7NX84-JSaC","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T06:38:41Z","updated_at":"2022-02-17T06:38:41Z","author_association":"CONTRIBUTOR","body":"@zhongyujiang Flink default only has 1 concurrent checkpoint. could the scenario you described happen in this case?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042622082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042628537","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042628537","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042628537,"node_id":"IC_kwDOCW7NX84-JT-5","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T06:51:48Z","updated_at":"2022-02-17T06:51:48Z","author_association":"MEMBER","body":"@zhongyujiang , what's the current failure stacktrace you encountered  ?  I'd like to take a careful look to this problem, and hope we can fix this in this round work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042628537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042668763","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042668763","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042668763,"node_id":"IC_kwDOCW7NX84-Jdzb","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T07:59:04Z","updated_at":"2022-02-17T07:59:04Z","author_association":"CONTRIBUTOR","body":"> @zhongyujiang Flink default only has 1 concurrent checkpoint. could the scenario you described happen in this case?\r\n\r\nI think it's not relevant to Flink `checkpoint ` but to  `notifyCheckpointComplete`  working mechanism, quoted from method docs of `notifyCheckpointComplete`:\r\n\r\n> Notifies the listener that the checkpoint with the given checkpointId completed and was committed.\r\nThese notifications are \"best effort\", meaning they can sometimes be skipped. To behave properly, implementers need to follow the \"Checkpoint Subsuming Contract\". Please see the class-level JavaDocs for details.\r\nPlease note that checkpoints may generally overlap, so you cannot assume that the notifyCheckpointComplete() call is always for the latest prior checkpoint (or snapshot) that was taken on the function/operator implementing this interface. It might be for a checkpoint that was triggered earlier. Implementing the \"Checkpoint Subsuming Contract\" (see above) properly handles this situation correctly as well.\r\nPlease note that throwing exceptions from this method will not cause the completed checkpoint to be revoked. Throwing exceptions will typically cause task/job failure and trigger recovery.\r\n\r\n`IcebergFilesCommitter` will commit to Iceberg once get notified, and such notifications does not have the same ordering guarantee as Flink checkpoint.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042668763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042670791","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042670791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042670791,"node_id":"IC_kwDOCW7NX84-JeTH","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T08:02:04Z","updated_at":"2022-02-17T08:02:04Z","author_association":"CONTRIBUTOR","body":"> @zhongyujiang , what's the current failure stacktrace you encountered ? I'd like to take a careful look to this problem, and hope we can fix this in this round work.\r\n\r\nLike this:\r\n\r\n> java.lang.AssertionError: There should be 1 data file in partition 'aaa' expected:<1> but was:<2>\r\n\r\nHaven't encountered locally yet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042670791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042685511","html_url":"https://github.com/apache/iceberg/pull/4123#issuecomment-1042685511","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4123","id":1042685511,"node_id":"IC_kwDOCW7NX84-Jh5H","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T08:21:21Z","updated_at":"2022-02-17T08:22:11Z","author_association":"CONTRIBUTOR","body":"> I agree with the analysis. I had one nit but LGTM otherwise. Thanks, @szehon-ho for fixing and @KarlManong for reporting.\r\n\r\nMy pleasure. Somehow I can't reproduce now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042685511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042690568","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042690568","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042690568,"node_id":"IC_kwDOCW7NX84-JjII","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T08:27:30Z","updated_at":"2022-02-17T08:27:30Z","author_association":"CONTRIBUTOR","body":"@openinx Found [one](https://github.com/apache/iceberg/runs/5220342964?check_suite_focus=true#step:6:207) in CI:\r\n\r\n> org.apache.iceberg.flink.TestFlinkTableSink > testHashDistributeMode[catalogName=testhadoop, baseNamespace=, format=ORC, isStreaming=true] FAILED\r\n    java.lang.AssertionError: There should be 1 data file in partition 'aaa' expected:<1> but was:<2>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:647)\r\n        at org.apache.iceberg.flink.TestFlinkTableSink.testHashDistributeMode(TestFlinkTableSink.java:283)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042690568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042701849","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042701849","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042701849,"node_id":"IC_kwDOCW7NX84-Jl4Z","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T08:42:13Z","updated_at":"2022-02-17T08:42:13Z","author_association":"MEMBER","body":"Reconsidered this test case,  I think @zhongyujiang is getting the root cause in the correct direction.  Let's explain the cause here: \r\n\r\nIn the unit test case,  we are trying to write the following records into apache iceberg table by shuffling by partition field `data`  (The parallelism is 2): \r\n\r\n```\r\n(1, 'aaa'), (1, 'bbb'), (1, 'ccc')\r\n(2, 'aaa'), (2, 'bbb'), (2, 'ccc')\r\n(3, 'aaa'), (3, 'bbb'), (3, 'ccc')\r\n```\r\n\r\nAs we may produces multiple checkpoints when the streaming job is running,   Then it's possible that we write the records in the following checkpoints: \r\n\r\n* checkpoint#1\r\n  * (1, 'aaa')\r\n  * (1, 'bbb')\r\n  * (1, 'ccc')\r\n\r\n* checkpoint#2\r\n\r\n  * (2, 'aaa'), \r\n  * (2, 'bbb'), \r\n  * (2, 'ccc')\r\n  * (3, 'aaa'), \r\n  * (3, 'bbb'), \r\n  * (3, 'ccc')\r\n\r\nThen  it will produces a seperate data file for each partition in the given checkpoint.  Let's say: \r\n\r\n* checkpoint#1 \r\n  * produces `data-file-1` for partition `aaa`\r\n  * produces `data-file-2` for partition `bbb`\r\n  * produces `data-file-3` for partition `ccc`\r\n\r\n* checkpoint#2\r\n  * produces `data-file-4` for partition `aaa`\r\n  * produces `data-file-5` for partition `bbb`\r\n  * produces `data-file-6` for partition `ccc`\r\n\r\nAssume the snapshotState & notifyCheckpointComplete are arrived as the following:\r\n\r\n1. snapshotState(ckpt1);\r\n2. snapshotState(ckpt2);\r\n3. notifyCheckpointComplete(ckpt2);  ( It's possible just as the flink [javadoc](https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/common/state/CheckpointListener.java#L122) said)\r\n4. notifyCheckpointComplete(ckpt1);\r\n\r\nThen in the step#3,   it will commit one transaction with the alll the data files which comes from checkpoint#1 & checkpoint#2 (According to the this [IcebergFilesCommitter implementation](https://github.com/apache/iceberg/blob/d43cb4c296f8096300b43fe830fe6c4fb085aaa5/flink/v1.14/flink/src/main/java/org/apache/iceberg/flink/sink/IcebergFilesCommitter.java#L182)) ,  finally this latest snapshot will include all the data files from `data-file-1` to `data-file-6`. That is why we encounter the failure assertion.\r\n\r\n```\r\njava.lang.AssertionError: There should be 1 data file in partition 'aaa' expected:<1> but was:<2>\r\nat org.junit.Assert.fail(Assert.java:89)\r\nat org.junit.Assert.failNotEquals(Assert.java:835)\r\nat org.junit.Assert.assertEquals(Assert.java:647)\r\nat org.apache.iceberg.flink.TestFlinkTableSink.testHashDistributeMode(TestFlinkTableSink.java:283)\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042701849/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042718844","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042718844","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042718844,"node_id":"IC_kwDOCW7NX84-JqB8","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T09:03:07Z","updated_at":"2022-02-17T09:03:07Z","author_association":"MEMBER","body":"But I generally don't think the current fix is in the correct direction,  there are my points: \r\n* Indeed, increasing the checkpoint interval from 400ms to 1000ms reduce the probability to encounter this assertion failure, But it does not resolve the underlying real problem.  So I don't think it's right to increase the checkpoint interval.\r\n*  Assert that the snapshot's data file size is less than 2  does not change any thing in my view. \r\n\r\nI think the real intention that we designed this unit test is:  we want to ensure that there is only one generated data file in each given partition if we commit those rows in only one single deterministic iceberg transaction,  once we enable the switch `write.distribution-mode=hash` in both flink streaming & batch jobs. \r\n\r\nThe current root cause is:  we cannot make it trigger only one checkpoint for the given 9 rows in the flink streaming sql job.  So I think the correct direction is:  make only one checkpoint to write those 9 rows and finally we still assert there is only one data file in each given partition.  To accomplish this goal, I think we can use the [BoundedTestSource](https://github.com/apache/iceberg/blob/2d4b0ddc76fd47aa27ca4972d4f3a6f256921c58/flink/v1.14/flink/src/test/java/org/apache/iceberg/flink/source/BoundedTestSource.java#L49) to reimplement this unit test.  About the BoundedTestSource, [here](https://github.com/apache/iceberg/blob/2d4b0ddc76fd47aa27ca4972d4f3a6f256921c58/flink/v1.14/flink/src/test/java/org/apache/iceberg/flink/sink/TestFlinkIcebergSinkV2.java#L156) is a good example for how to producing multiple rows into a single checkpoint. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042718844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042862294","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1042862294","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1042862294,"node_id":"IC_kwDOCW7NX84-KNDW","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T11:42:18Z","updated_at":"2022-02-17T11:42:18Z","author_association":"CONTRIBUTOR","body":"> Assert that the snapshot's data file size is less than 2 does not change any thing in my view.\r\n\r\nChanging the assertion condition is not intended to solve the validation problem when there are merged results actually, like you said,  there could be more than one checkpoint in streaming mode, but there is no guarantee that each checkpoint contains exactly each partition's data. The situation could be like this:\r\n- checkpoint#1 \r\n    - (1, 'aaa')\r\n- checkpoint#2\r\n    - (1, 'bbb')\r\n...\r\n\r\nWhen results of ck1 and ck2 are not merged, then snapshot of ck1 would have only 1 data file for partition `aaa` but 0 file for other partitions and snapshot of ck2 is also similar, that's why I changed the assertition condition.\r\n\r\n> To accomplish this goal, I think we can use the [BoundedTestSource](https://github.com/apache/iceberg/blob/2d4b0ddc76fd47aa27ca4972d4f3a6f256921c58/flink/v1.14/flink/src/test/java/org/apache/iceberg/flink/source/BoundedTestSource.java#L49) to reimplement this unit test. About the BoundedTestSource, [here](https://github.com/apache/iceberg/blob/2d4b0ddc76fd47aa27ca4972d4f3a6f256921c58/flink/v1.14/flink/src/test/java/org/apache/iceberg/flink/sink/TestFlinkIcebergSinkV2.java#L156) is a good example for how to producing multiple rows into a single checkpoint.\r\n\r\nI also wanted to solve the problem by controlling the checkpoint in the beginning but didn't figure a convenient way to do so. Using `BoundedTestSource` seems like a feasible way, I'll try with it. @openinx Thanks for your advice.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042862294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042894906","html_url":"https://github.com/apache/iceberg/pull/4153#issuecomment-1042894906","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4153","id":1042894906,"node_id":"IC_kwDOCW7NX84-KVA6","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T12:22:57Z","updated_at":"2022-02-17T12:22:57Z","author_association":"CONTRIBUTOR","body":"@jackye1995 Can you please review once you get time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1042894906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043129773","html_url":"https://github.com/apache/iceberg/issues/3997#issuecomment-1043129773","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3997","id":1043129773,"node_id":"IC_kwDOCW7NX84-LOWt","user":{"login":"melin","id":1145830,"node_id":"MDQ6VXNlcjExNDU4MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1145830?v=4","gravatar_id":"","url":"https://api.github.com/users/melin","html_url":"https://github.com/melin","followers_url":"https://api.github.com/users/melin/followers","following_url":"https://api.github.com/users/melin/following{/other_user}","gists_url":"https://api.github.com/users/melin/gists{/gist_id}","starred_url":"https://api.github.com/users/melin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melin/subscriptions","organizations_url":"https://api.github.com/users/melin/orgs","repos_url":"https://api.github.com/users/melin/repos","events_url":"https://api.github.com/users/melin/events{/privacy}","received_events_url":"https://api.github.com/users/melin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T16:08:00Z","updated_at":"2022-02-17T16:08:00Z","author_association":"NONE","body":"\" file listing issue in Hudi metadata.\" => RFC - 15: HUDI Metadata Table and Cloud/DFS File Listing Improvements","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043129773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043185981","html_url":"https://github.com/apache/iceberg/pull/4135#issuecomment-1043185981","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4135","id":1043185981,"node_id":"IC_kwDOCW7NX84-LcE9","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T16:56:58Z","updated_at":"2022-02-17T16:56:58Z","author_association":"CONTRIBUTOR","body":"Looks good! I'll merge when tests are passing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043185981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043240608","html_url":"https://github.com/apache/iceberg/pull/4135#issuecomment-1043240608","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4135","id":1043240608,"node_id":"IC_kwDOCW7NX84-Lpag","user":{"login":"sririshindra","id":9795421,"node_id":"MDQ6VXNlcjk3OTU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/9795421?v=4","gravatar_id":"","url":"https://api.github.com/users/sririshindra","html_url":"https://github.com/sririshindra","followers_url":"https://api.github.com/users/sririshindra/followers","following_url":"https://api.github.com/users/sririshindra/following{/other_user}","gists_url":"https://api.github.com/users/sririshindra/gists{/gist_id}","starred_url":"https://api.github.com/users/sririshindra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sririshindra/subscriptions","organizations_url":"https://api.github.com/users/sririshindra/orgs","repos_url":"https://api.github.com/users/sririshindra/repos","events_url":"https://api.github.com/users/sririshindra/events{/privacy}","received_events_url":"https://api.github.com/users/sririshindra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T17:51:46Z","updated_at":"2022-02-17T17:51:46Z","author_association":"CONTRIBUTOR","body":"> Looks good! I'll merge when tests are passing.\r\n\r\nThanks @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043240608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043259837","html_url":"https://github.com/apache/iceberg/pull/4146#issuecomment-1043259837","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4146","id":1043259837,"node_id":"IC_kwDOCW7NX84-LuG9","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T18:11:54Z","updated_at":"2022-02-17T18:11:54Z","author_association":"CONTRIBUTOR","body":"Thanks, @yittg! Looks really close.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043259837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043347180","html_url":"https://github.com/apache/iceberg/pull/4052#issuecomment-1043347180","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4052","id":1043347180,"node_id":"IC_kwDOCW7NX84-MDbs","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T19:39:57Z","updated_at":"2022-02-17T19:49:34Z","author_association":"CONTRIBUTOR","body":"Sorry for the delay folks. Few updates:\r\n\r\n1.)  updated the PR with some integration tests and more unit tests. \r\n\r\n2.) The deletion batch size is configurable through s3.delete.batch-size.\r\n\r\n3.) The default is 250 instead of 1000. Tbh I think some rigorous benchmarking should be done here. I set to 250 mostly mimicking the similar change done in hadoop-aws https://github.com/apache/hadoop/commit/56dee667707926f3796c7757be1a133a362f05c9 which also used to perform batch deletions in 1000 until encountering major throttling issues. For reference if there are N keys in a batch, this will uses N requests in your throughput calculation done by S3 for controlling throttling. S3 limitations are 3500 TPS per prefix. So if we did 1000, in the worst case where most of the keys fall in the same prefix (if somebody has a hive-like file structure) then we would easily hit this limitation easily. If prefixes are better distributed we could get more throughput, but don't think we should rely on this assumption.\r\n\r\n4.) I do not think for the S3 case we need to worry about any de-duping. If the same key is passed in DeleteObjects multiple times, there are no failures. Also after the delete marker is set on the object, if deleteObjects is called later, the call still does not fail (DeleteObjects does not fail if the passed in keys do not exist. It's a no-op)\r\n\r\n@dramaticlly @jackye1995 Let me know your thoughts!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043347180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043357445","html_url":"https://github.com/apache/iceberg/pull/4117#issuecomment-1043357445","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4117","id":1043357445,"node_id":"IC_kwDOCW7NX84-MF8F","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T19:50:27Z","updated_at":"2022-02-17T19:50:27Z","author_association":"CONTRIBUTOR","body":"@openinx read the javadoc that you linked. seems that notifyCheckpointComplete can be skipped due to best effort. it also said that the notification can't be assumed for the latest snapshot. But it didn't say if they can come out of order. so the scenario could be\r\n```\r\nsnapshotState(ckpt1);\r\n// notifyCheckpointComplete(ckpt1); (missed)\r\nsnapshotState(ckpt2);\r\nnotifyCheckpointComplete(ckpt2); \r\n```\r\n\r\nAgree that precise control on the source could be the right solution here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043357445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043376306","html_url":"https://github.com/apache/iceberg/pull/4148#issuecomment-1043376306","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4148","id":1043376306,"node_id":"IC_kwDOCW7NX84-MKiy","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T20:09:14Z","updated_at":"2022-02-17T20:09:14Z","author_association":"CONTRIBUTOR","body":"Thanks, @yittg!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043376306/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043377253","html_url":"https://github.com/apache/iceberg/pull/4154#issuecomment-1043377253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4154","id":1043377253,"node_id":"IC_kwDOCW7NX84-MKxl","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T20:10:08Z","updated_at":"2022-02-17T20:10:55Z","author_association":"CONTRIBUTOR","body":"I think this feature is useful for operations like MERGE INTO where we populate changes from a source table that may have an evolved schema now. We have to be careful with assignment alignment in UPDATE and MERGE. I think Spark disables a few checks/rules if a table accepts any schema. That means we will have to reimplement it in Iceberg.\r\n\r\nWe will also have to modify our row-level rules in extensions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043377253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043385584","html_url":"https://github.com/apache/iceberg/pull/4152#issuecomment-1043385584","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4152","id":1043385584,"node_id":"IC_kwDOCW7NX84-MMzw","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T20:18:00Z","updated_at":"2022-02-17T20:18:00Z","author_association":"CONTRIBUTOR","body":"Just for my own curiosity, is it doable today by setting the table properties as in https://github.com/apache/iceberg/blob/master/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/actions/BaseExpireSnapshotsSparkAction.java#L215-L217","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043385584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043386710","html_url":"https://github.com/apache/iceberg/pull/4152#issuecomment-1043386710","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4152","id":1043386710,"node_id":"IC_kwDOCW7NX84-MNFW","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T20:19:05Z","updated_at":"2022-02-17T20:22:06Z","author_association":"CONTRIBUTOR","body":"This change looks good to me (one nit). Can we add a test that would invoke it, @0xffmeta?\r\nWe have an example in `TestDeleteReachableFilesActions` on how such a flag can be tested.\r\nWe should probably add something similar to `TestExpireSnapshotsProcedure`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043386710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043388374","html_url":"https://github.com/apache/iceberg/pull/4152#issuecomment-1043388374","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4152","id":1043388374,"node_id":"IC_kwDOCW7NX84-MNfW","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T20:20:40Z","updated_at":"2022-02-17T20:20:40Z","author_association":"CONTRIBUTOR","body":"@dramaticlly, it is doable today if you invoke the action directly and pass `stream-results` to it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043388374/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043393780","html_url":"https://github.com/apache/iceberg/pull/4152#issuecomment-1043393780","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4152","id":1043393780,"node_id":"IC_kwDOCW7NX84-MOz0","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T20:25:46Z","updated_at":"2022-02-17T20:25:57Z","author_association":"CONTRIBUTOR","body":"> @dramaticlly, it is doable today if you invoke the action directly and pass `stream-results` to it.\r\n\r\nThank you @aokolnychyi , does it make sense to backport this as procedure for spark 3.1/3.0/2.4 as well? Not necessarily in this PR but question in general","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043393780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043403790","html_url":"https://github.com/apache/iceberg/pull/3056#issuecomment-1043403790","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3056","id":1043403790,"node_id":"IC_kwDOCW7NX84-MRQO","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T20:35:10Z","updated_at":"2022-02-17T20:35:10Z","author_association":"CONTRIBUTOR","body":"Let me also take a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043403790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043468702","html_url":"https://github.com/apache/iceberg/pull/4075#issuecomment-1043468702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4075","id":1043468702,"node_id":"IC_kwDOCW7NX84-MhGe","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T21:31:11Z","updated_at":"2022-02-17T21:31:11Z","author_association":"CONTRIBUTOR","body":"Thanks, @zhongyujiang!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043468702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043483645","html_url":"https://github.com/apache/iceberg/pull/4155#issuecomment-1043483645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4155","id":1043483645,"node_id":"IC_kwDOCW7NX84-Mkv9","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T21:46:16Z","updated_at":"2022-02-17T21:46:16Z","author_association":"CONTRIBUTOR","body":"> I don't think this should remove `addStagedSnapshot` or `replaceCurrentSnapshot(Snapshot)` because 0.13.1 is a patch release. It's okay to remove them in master, but I wouldn't do it here. Instead, I'd say we should only remove the method that was accidentally added.\r\n\r\nRestored those methods. Only remove the one added by #4135.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043483645/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043496601","html_url":"https://github.com/apache/iceberg/pull/4155#issuecomment-1043496601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4155","id":1043496601,"node_id":"IC_kwDOCW7NX84-Mn6Z","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T21:53:12Z","updated_at":"2022-02-17T21:53:12Z","author_association":"CONTRIBUTOR","body":"Thanks, @wypoon!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043496601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043527521","html_url":"https://github.com/apache/iceberg/pull/4016#issuecomment-1043527521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4016","id":1043527521,"node_id":"IC_kwDOCW7NX84-Mvdh","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T22:12:49Z","updated_at":"2022-02-17T22:12:49Z","author_association":"CONTRIBUTOR","body":"Hey @rdblue the `__init__` will be called every time we request an instance of the type. First `__new__` will give us the instance (which the custom `__new__` on the class or inherited from `Singleton` will give) and then `__init__` will be called. It's true for both the parameterized typed and the non-parameterized ones.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043527521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043573693","html_url":"https://github.com/apache/iceberg/pull/2925#issuecomment-1043573693","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2925","id":1043573693,"node_id":"IC_kwDOCW7NX84-M6u9","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-17T22:53:06Z","updated_at":"2022-02-17T22:53:06Z","author_association":"COLLABORATOR","body":"@aokolnychyi thanks for the review, addressed the comments, when you another chance","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043573693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043758954","html_url":"https://github.com/apache/iceberg/pull/4146#issuecomment-1043758954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4146","id":1043758954,"node_id":"IC_kwDOCW7NX84-Nn9q","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T02:32:17Z","updated_at":"2022-02-18T02:32:17Z","author_association":"CONTRIBUTOR","body":"@rdblue I've appended some fix changes, PTAL.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043758954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043761316","html_url":"https://github.com/apache/iceberg/pull/4123#issuecomment-1043761316","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4123","id":1043761316,"node_id":"IC_kwDOCW7NX84-Noik","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T02:34:30Z","updated_at":"2022-02-18T02:34:30Z","author_association":"COLLABORATOR","body":"@aokolnychyi thanks for review!  whenever you have time for another look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043761316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043763087","html_url":"https://github.com/apache/iceberg/pull/4081#issuecomment-1043763087","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4081","id":1043763087,"node_id":"IC_kwDOCW7NX84-No-P","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T02:36:03Z","updated_at":"2022-02-18T02:36:03Z","author_association":"CONTRIBUTOR","body":"@rdblue I believe I've addressed all of the comments here and it should be ready for a final review. Once we get to parts of the code that are using FileIO instances I think some aggressive testing there should suss out any bad assumptions here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043763087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043765351","html_url":"https://github.com/apache/iceberg/pull/4140#issuecomment-1043765351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4140","id":1043765351,"node_id":"IC_kwDOCW7NX84-Nphn","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T02:38:02Z","updated_at":"2022-02-18T02:38:02Z","author_association":"CONTRIBUTOR","body":"closing it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043765351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043817208","html_url":"https://github.com/apache/iceberg/pull/3095#issuecomment-1043817208","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3095","id":1043817208,"node_id":"IC_kwDOCW7NX84-N2L4","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T03:22:37Z","updated_at":"2022-02-18T03:22:37Z","author_association":"NONE","body":"@hameizi @openinx @rdblue hi，boys，We are currently using the flink upsert function. In which version is this PR planned to be released?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043817208/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043817661","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-1043817661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":1043817661,"node_id":"IC_kwDOCW7NX84-N2S9","user":{"login":"liubo1022126","id":47106533,"node_id":"MDQ6VXNlcjQ3MTA2NTMz","avatar_url":"https://avatars.githubusercontent.com/u/47106533?v=4","gravatar_id":"","url":"https://api.github.com/users/liubo1022126","html_url":"https://github.com/liubo1022126","followers_url":"https://api.github.com/users/liubo1022126/followers","following_url":"https://api.github.com/users/liubo1022126/following{/other_user}","gists_url":"https://api.github.com/users/liubo1022126/gists{/gist_id}","starred_url":"https://api.github.com/users/liubo1022126/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liubo1022126/subscriptions","organizations_url":"https://api.github.com/users/liubo1022126/orgs","repos_url":"https://api.github.com/users/liubo1022126/repos","events_url":"https://api.github.com/users/liubo1022126/events{/privacy}","received_events_url":"https://api.github.com/users/liubo1022126/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T03:23:16Z","updated_at":"2022-02-18T03:23:16Z","author_association":"NONE","body":"@Reo-LEI @rdblue hi，boys，We are currently using the flink upsert function. In which version is this PR planned to be released?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043817661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043819927","html_url":"https://github.com/apache/iceberg/pull/2898#issuecomment-1043819927","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2898","id":1043819927,"node_id":"IC_kwDOCW7NX84-N22X","user":{"login":"Reo-LEI","id":17312872,"node_id":"MDQ6VXNlcjE3MzEyODcy","avatar_url":"https://avatars.githubusercontent.com/u/17312872?v=4","gravatar_id":"","url":"https://api.github.com/users/Reo-LEI","html_url":"https://github.com/Reo-LEI","followers_url":"https://api.github.com/users/Reo-LEI/followers","following_url":"https://api.github.com/users/Reo-LEI/following{/other_user}","gists_url":"https://api.github.com/users/Reo-LEI/gists{/gist_id}","starred_url":"https://api.github.com/users/Reo-LEI/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Reo-LEI/subscriptions","organizations_url":"https://api.github.com/users/Reo-LEI/orgs","repos_url":"https://api.github.com/users/Reo-LEI/repos","events_url":"https://api.github.com/users/Reo-LEI/events{/privacy}","received_events_url":"https://api.github.com/users/Reo-LEI/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T03:26:48Z","updated_at":"2022-02-18T03:27:00Z","author_association":"CONTRIBUTOR","body":"> @Reo-LEI @rdblue hi，boys，We are currently using the flink upsert function. In which version is this PR planned to be released?\r\n\r\nI will adressing the comments in this weeken. Thank you for your attention! @liubo1022126","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043819927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043929106","html_url":"https://github.com/apache/iceberg/pull/4158#issuecomment-1043929106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4158","id":1043929106,"node_id":"IC_kwDOCW7NX84-ORgS","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T05:35:02Z","updated_at":"2022-02-18T05:36:43Z","author_association":"MEMBER","body":"For Spark 2.4, I think it shoud be scala free?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043929106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043969088","html_url":"https://github.com/apache/iceberg/pull/3056#issuecomment-1043969088","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3056","id":1043969088,"node_id":"IC_kwDOCW7NX84-ObRA","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T06:07:44Z","updated_at":"2022-02-18T06:07:44Z","author_association":"CONTRIBUTOR","body":"@jackye1995 @RussellSpitzer @rdblue, the question about ownership and file removal comes up in a lot of discussions. I've created issue #4159 so that we can continue the discussion that happened on this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043969088/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043972430","html_url":"https://github.com/apache/iceberg/pull/4156#issuecomment-1043972430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4156","id":1043972430,"node_id":"IC_kwDOCW7NX84-OcFO","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T06:11:10Z","updated_at":"2022-02-18T06:11:10Z","author_association":"CONTRIBUTOR","body":"> LGTM. Good catch @hililiwei!\r\n\r\nCoincidence. I'm re-reading the document recently to deepen my understanding. 🤣 \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043972430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043977157","html_url":"https://github.com/apache/iceberg/pull/4152#issuecomment-1043977157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4152","id":1043977157,"node_id":"IC_kwDOCW7NX84-OdPF","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T06:16:09Z","updated_at":"2022-02-18T06:16:29Z","author_association":"CONTRIBUTOR","body":"> does it make sense to backport this as procedure for spark 3.1/3.0/2.4 as well?\r\n\r\n@dramaticlly, if there is anyone in the community interested in backporting that after this is done, sure!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043977157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043980035","html_url":"https://github.com/apache/iceberg/pull/4141#issuecomment-1043980035","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4141","id":1043980035,"node_id":"IC_kwDOCW7NX84-Od8D","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T06:19:18Z","updated_at":"2022-02-18T06:19:18Z","author_association":"CONTRIBUTOR","body":"Let me take a look tomorrow too. Sorry for the delay!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043980035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043981719","html_url":"https://github.com/apache/iceberg/pull/3376#issuecomment-1043981719","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3376","id":1043981719,"node_id":"IC_kwDOCW7NX84-OeWX","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T06:21:18Z","updated_at":"2022-02-18T06:21:18Z","author_association":"MEMBER","body":"@wang-x-xia Would you also like to add a new doc page to show people how to access apache iceberg tables backed with Dell EMC ECS storage in this https://github.com/apache/iceberg-docs project ?  ( Then it will display the rendered page in the apache official page).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043981719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043987222","html_url":"https://github.com/apache/iceberg/pull/4123#issuecomment-1043987222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4123","id":1043987222,"node_id":"IC_kwDOCW7NX84-OfsW","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T06:27:37Z","updated_at":"2022-02-18T06:27:37Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1043987222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044004996","html_url":"https://github.com/apache/iceberg/pull/3376#issuecomment-1044004996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3376","id":1044004996,"node_id":"IC_kwDOCW7NX84-OkCE","user":{"login":"mechgouki","id":8364215,"node_id":"MDQ6VXNlcjgzNjQyMTU=","avatar_url":"https://avatars.githubusercontent.com/u/8364215?v=4","gravatar_id":"","url":"https://api.github.com/users/mechgouki","html_url":"https://github.com/mechgouki","followers_url":"https://api.github.com/users/mechgouki/followers","following_url":"https://api.github.com/users/mechgouki/following{/other_user}","gists_url":"https://api.github.com/users/mechgouki/gists{/gist_id}","starred_url":"https://api.github.com/users/mechgouki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mechgouki/subscriptions","organizations_url":"https://api.github.com/users/mechgouki/orgs","repos_url":"https://api.github.com/users/mechgouki/repos","events_url":"https://api.github.com/users/mechgouki/events{/privacy}","received_events_url":"https://api.github.com/users/mechgouki/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T06:44:09Z","updated_at":"2022-02-18T06:44:09Z","author_association":"NONE","body":"> @wang-x-xia Would you also like to add a new doc page to show people how to access apache iceberg tables backed with Dell EMC ECS storage in this https://github.com/apache/iceberg-docs project ? ( Then it will display the rendered page in the apache official page).\r\n\r\nSure, we will work on that soon.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044004996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044006507","html_url":"https://github.com/apache/iceberg/pull/3376#issuecomment-1044006507","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3376","id":1044006507,"node_id":"IC_kwDOCW7NX84-OkZr","user":{"login":"wang-x-xia","id":83057695,"node_id":"MDQ6VXNlcjgzMDU3Njk1","avatar_url":"https://avatars.githubusercontent.com/u/83057695?v=4","gravatar_id":"","url":"https://api.github.com/users/wang-x-xia","html_url":"https://github.com/wang-x-xia","followers_url":"https://api.github.com/users/wang-x-xia/followers","following_url":"https://api.github.com/users/wang-x-xia/following{/other_user}","gists_url":"https://api.github.com/users/wang-x-xia/gists{/gist_id}","starred_url":"https://api.github.com/users/wang-x-xia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wang-x-xia/subscriptions","organizations_url":"https://api.github.com/users/wang-x-xia/orgs","repos_url":"https://api.github.com/users/wang-x-xia/repos","events_url":"https://api.github.com/users/wang-x-xia/events{/privacy}","received_events_url":"https://api.github.com/users/wang-x-xia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T06:45:16Z","updated_at":"2022-02-18T06:45:16Z","author_association":"CONTRIBUTOR","body":"@openinx Fine! I'll finish the doc and also the catalog implementation!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044006507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044252471","html_url":"https://github.com/apache/iceberg/issues/4079#issuecomment-1044252471","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4079","id":1044252471,"node_id":"IC_kwDOCW7NX84-Pgc3","user":{"login":"peay","id":7261177,"node_id":"MDQ6VXNlcjcyNjExNzc=","avatar_url":"https://avatars.githubusercontent.com/u/7261177?v=4","gravatar_id":"","url":"https://api.github.com/users/peay","html_url":"https://github.com/peay","followers_url":"https://api.github.com/users/peay/followers","following_url":"https://api.github.com/users/peay/following{/other_user}","gists_url":"https://api.github.com/users/peay/gists{/gist_id}","starred_url":"https://api.github.com/users/peay/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peay/subscriptions","organizations_url":"https://api.github.com/users/peay/orgs","repos_url":"https://api.github.com/users/peay/repos","events_url":"https://api.github.com/users/peay/events{/privacy}","received_events_url":"https://api.github.com/users/peay/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T09:58:52Z","updated_at":"2022-02-18T09:58:52Z","author_association":"NONE","body":"I believe the method is `partitionedBy`, not `partitionBy` - see, e.g., the example in https://spark.apache.org/docs/3.1.2/api/python/reference/api/pyspark.sql.DataFrame.writeTo.html.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044252471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044260521","html_url":"https://github.com/apache/iceberg/issues/4161#issuecomment-1044260521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4161","id":1044260521,"node_id":"IC_kwDOCW7NX84-Piap","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T10:03:23Z","updated_at":"2022-02-18T10:03:23Z","author_association":"CONTRIBUTOR","body":"BaseRewriteManifests check method:\r\n```\r\nprivate void validateDeletedManifests(Set<ManifestFile> currentManifests) {\r\n    // directly deleted manifests must be still present in the current snapshot\r\n    deletedManifests.stream()\r\n        .filter(manifest -> !currentManifests.contains(manifest))\r\n        .findAny()\r\n        .ifPresent(manifest -> {\r\n          throw new ValidationException(\"Manifest is missing: %s\", manifest.path());\r\n        });\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044260521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044365273","html_url":"https://github.com/apache/iceberg/issues/2796#issuecomment-1044365273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2796","id":1044365273,"node_id":"IC_kwDOCW7NX84-P7_Z","user":{"login":"otayel","id":11511576,"node_id":"MDQ6VXNlcjExNTExNTc2","avatar_url":"https://avatars.githubusercontent.com/u/11511576?v=4","gravatar_id":"","url":"https://api.github.com/users/otayel","html_url":"https://github.com/otayel","followers_url":"https://api.github.com/users/otayel/followers","following_url":"https://api.github.com/users/otayel/following{/other_user}","gists_url":"https://api.github.com/users/otayel/gists{/gist_id}","starred_url":"https://api.github.com/users/otayel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/otayel/subscriptions","organizations_url":"https://api.github.com/users/otayel/orgs","repos_url":"https://api.github.com/users/otayel/repos","events_url":"https://api.github.com/users/otayel/events{/privacy}","received_events_url":"https://api.github.com/users/otayel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T11:22:04Z","updated_at":"2022-02-18T11:22:04Z","author_association":"NONE","body":"I am also seeing this problem on our side. Any insights how we can solve it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044365273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044564560","html_url":"https://github.com/apache/iceberg/pull/3983#issuecomment-1044564560","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3983","id":1044564560,"node_id":"IC_kwDOCW7NX84-QspQ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T13:55:54Z","updated_at":"2022-02-18T14:02:03Z","author_association":"MEMBER","body":"66c77fad0 - Benchmark\r\nIcebergSortCompactionBenchmark.java \r\nhttps://github.com/apache/iceberg/blob/66c77fad0c9c14b479909f0c40e8a222d35c00b2/spark/v3.2/spark/src/jmh/java/org/apache/iceberg/spark/action/IcebergSortCompactionBenchmark.java\r\n \r\n g :iceberg-spark:iceberg-spark-3.2:jmh -PjmhIncludeRegex=IcebergSortCompactionBenchmark -PjmhOutputPath=benchmark/SortResult.txt\r\n\r\nMinimal effect on the timing of non-string compactions. Currently String is set at a buffer length of 128bytes which probably explains the dramatically more expensive ZOrder for operations containing Strings. I think additionally the Spark version here can bail on the first misaligned byte, while we read the entire buffer before we make any decision.\r\n\r\nMemory is managed in the ZOrder method via thread local bytebuffers owned by the Zorder Udf's created in the sort.  I need to check this over but I believe I did it correctly.\r\n\r\n Test makes 8 files , 10 million Records each and runs the Iceberg Compaction Algorithm\r\n Schema of the table is \r\n \r\n ```\r\n         .withColumnRenamed(\"id\", \"longCol\")\r\n        .withColumn(\"intCol\", expr(\"CAST(longCol AS INT)\"))\r\n        .withColumn(\"intCol2\", expr(\"CAST(longCol AS INT)\"))\r\n        .withColumn(\"intCol3\", expr(\"CAST(longCol AS INT)\"))\r\n        .withColumn(\"intCol4\", expr(\"CAST(longCol AS INT)\"))\r\n        .withColumn(\"floatCol\", expr(\"CAST(longCol AS FLOAT)\"))\r\n        .withColumn(\"doubleCol\", expr(\"CAST(longCol AS DOUBLE)\"))\r\n        .withColumn(\"dateCol\", date_add(current_date(), col(\"intCol\").mod(NUM_FILES)))\r\n        .withColumn(\"timestampCol\", expr(\"TO_TIMESTAMP(dateCol)\"))\r\n        .withColumn(\"stringCol\", expr(\"CAST(dateCol AS STRING)\"));\r\n```\r\n\r\nTest rewrites \r\n\r\n```\r\nBenchmark                                        Mode  Cnt     Score      Error  Units\r\n// Use 1 Int Column for sorting\r\nIcebergSortCompactionBenchmark.sortInt             ss    3   344.850 ±  146.488   s/op\r\nIcebergSortCompactionBenchmark.zSortInt            ss    3   370.162 ±   23.263   s/op\r\n\r\n// Use 2 Int Columns for sorting\r\nIcebergSortCompactionBenchmark.sortInt2            ss    3   331.688 ±   64.011   s/op\r\nIcebergSortCompactionBenchmark.zSortInt2           ss    3   384.922 ±  141.313   s/op\r\n\r\n// Use 3 Int Columns for sorting\r\nIcebergSortCompactionBenchmark.sortInt3            ss    3   331.971 ±   91.621   s/op\r\nIcebergSortCompactionBenchmark.zSortInt3           ss    3   398.508 ±   40.745   s/op\r\n\r\n// Use 4 Int Columns for sorting\r\nIcebergSortCompactionBenchmark.sortInt4            ss    3   345.414 ±   54.801   s/op\r\nIcebergSortCompactionBenchmark.zSortInt4           ss    3   403.732 ±   43.947   s/op\r\n\r\n// Use just a string column for sorting\r\nIcebergSortCompactionBenchmark.sortString          ss    3   449.647 ±  874.281   s/op \r\nIcebergSortCompactionBenchmark.zSortString         ss    3   823.717 ± 1306.732   s/op\r\n\r\n// Contains String Column String, Int, Date, Double\r\nIcebergSortCompactionBenchmark.sortFourColumns     ss    3   292.972 ± 1978.359   s/op\r\nIcebergSortCompactionBenchmark.zSortFourColumns    ss    3   913.779 ±  717.318   s/op\r\n\r\n// Contains \"stringCol\", \"intCol\", \"dateCol\", \"timestampCol\", \"doubleCol\", \"longCol\"\r\nIcebergSortCompactionBenchmark.sortSixColumns      ss    3   419.047 ±  113.040   s/op\r\nIcebergSortCompactionBenchmark.zSortSixColumns     ss    3  1024.332 ±  568.328   s/op \r\n```\r\n\r\n**Summary**\r\n\r\nFrom what I see here the main cost comes when we start writing significantly larger ZOrder values, although even in that case we still only get a cost of 2-3x of a normal sort (which is doing something quite different). I'm guessing we could do better with a custom sort expression which doesn't materialize the entire ZValue.\r\n\r\nThe actual transforms to byte representations seem to be a very small portion of our cost here. In the Int vs Int examples we see the Zorder code is only slightly slower than the normal Sort code. The time is dominated by the shuffle algorithm.\r\n\r\nCC: @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044564560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044821856","html_url":"https://github.com/apache/iceberg/pull/4111#issuecomment-1044821856","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4111","id":1044821856,"node_id":"IC_kwDOCW7NX84-Rrdg","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T16:48:39Z","updated_at":"2022-02-18T16:48:39Z","author_association":"CONTRIBUTOR","body":"Thanks, @hililiwei!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044821856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044865019","html_url":"https://github.com/apache/iceberg/pull/4163#issuecomment-1044865019","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4163","id":1044865019,"node_id":"IC_kwDOCW7NX84-R1_7","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T17:15:31Z","updated_at":"2022-02-18T17:15:31Z","author_association":"CONTRIBUTOR","body":"LGTM. Thanks @pan3793.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044865019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044918826","html_url":"https://github.com/apache/iceberg/pull/4158#issuecomment-1044918826","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4158","id":1044918826,"node_id":"IC_kwDOCW7NX84-SDIq","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T17:53:16Z","updated_at":"2022-02-18T17:58:13Z","author_association":"CONTRIBUTOR","body":"> For Spark 2.4, I think it shoud be scala free?\r\n\r\nCan you elaborate? All of the `sparkl-core` 2.4 jars [in Maven](https://mvnrepository.com/artifact/org.apache.spark/spark-core) have a both `_2.11` and `_2.12` version\r\n\r\nEDIT: I realize you likely mean that we don't compile Spark 2's iceberg-runtime artifact with Scala. In fact, all of the references to Scala I see in the main build file actually uses a 2.11 dependency for Spark 2's module.\r\n\r\nExample (as well as the `compileOnly` dependency of `spark-hive_2.11`): https://github.com/apache/iceberg/blob/9cc2ac8ec7172c78510bf4ddbcda9d9bc7b5a31c/spark/v2.4/build.gradle#L33","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044918826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044980909","html_url":"https://github.com/apache/iceberg/pull/4166#issuecomment-1044980909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4166","id":1044980909,"node_id":"IC_kwDOCW7NX84-SSSt","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T18:35:24Z","updated_at":"2022-02-18T18:35:24Z","author_association":"CONTRIBUTOR","body":"cc @arminnajafi @singhpk234 @amogh-jahagirdar @xiaoxuandev @yyanyy @natsukawa-kanou ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1044980909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045020189","html_url":"https://github.com/apache/iceberg/pull/3983#issuecomment-1045020189","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3983","id":1045020189,"node_id":"IC_kwDOCW7NX84-Sb4d","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T18:59:18Z","updated_at":"2022-02-18T18:59:18Z","author_association":"CONTRIBUTOR","body":"I'm a bit suspicious of those benchmarks because the error range is so high. The error rate for sortFourColumns is 6.7x the reported value. I'm not sure we can conclude much from those numbers. The scores look good in favor of plain integers (5-10% lower), but the error range is too high to know.\r\n\r\n> I'm guessing we could do better with a custom sort expression which doesn't materialize the entire ZValue.\r\n\r\nThat's one thing that using a float will do. We can convert the first 8 bytes back into a long and then use a secondary column of the remaining bytes or just discard them if we're okay with the loss of precision. That reduces the overall shuffle size and also makes Spark's internal operations much more efficient:\r\n* UnsafeRow returns primitive longs, rather than allocating arrays and copying bytes out of unsafe memory\r\n* The value is stored in the fixed-width portion of UnsafeRow, rather than using both length and the variable portion\r\n* Bytes are compared 8 at a time rather than 1-by-1\r\n\r\nI'm not very concerned with the cost of producing the zorder representation, just with the accesses Spark is going to do and the overall size. The floating point idea allows us to reduce the size and discard additional bits of we choose to. That seems like a win for keeping the additional data size down as well as avoiding allocations and thing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045020189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045044478","html_url":"https://github.com/apache/iceberg/pull/3983#issuecomment-1045044478","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3983","id":1045044478,"node_id":"IC_kwDOCW7NX84-Shz-","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T19:15:11Z","updated_at":"2022-02-18T19:15:11Z","author_association":"MEMBER","body":"> I'm a bit suspicious of those benchmarks because the error range is so high. The error rate for sortFourColumns is 6.7x the reported value. I'm not sure we can conclude much from those numbers. The scores look good in favor of plain integers (5-10% lower), but the error range is too high to know.\r\n\r\n\r\nThe error ranges are generated by some magic I do not understand, the actual variability within the runs was about 10 seconds (except for Sort Int 1) for the ints and within 100 seconds for Strings. So I don't know why JMH spits out the huge ranges.\r\n\r\nActual runs\r\n```\r\nSort Int1\r\nIteration   1: 234.163 s/op\r\nIteration   2: 226.640 s/op\r\nIteration   3: 418.113 s/op\r\n\r\nZSortInt1\r\nIteration   1: 371.631 s/op\r\nIteration   2: 369.345 s/op\r\nIteration   3: 369.511 s/op\r\n----------------\r\n\r\nSort Int2 \r\nIteration   1: 335.418 s/op\r\nIteration   2: 331.193 s/op\r\nIteration   3: 328.453 s/op\r\n\r\nZSorInt2\r\nIteration   1: 392.783 s/op\r\nIteration   2: 384.685 s/op\r\nIteration   3: 377.297 s/op\r\n------\r\n\r\nSort Int3\r\nIteration   1: 332.431 s/op\r\nIteration   2: 326.734 s/op\r\nIteration   3: 336.747 s/op\r\n\r\nZSortInt3\r\nIteration   1: 396.057 s/op\r\nIteration   2: 400.429 s/op\r\nIteration   3: 399.036 s/op\r\n---------------\r\n\r\nSortInt4\r\nIteration   1: 344.941 s/op\r\nIteration   2: 342.674 s/op\r\nIteration   3: 348.626 s/op\r\n\r\nZSortInt4\r\nIteration   1: 405.152 s/op\r\nIteration   2: 400.950 s/op\r\nIteration   3: 405.093 s/op\r\n\r\n---------------\r\nSort String\r\n\r\nIteration   1: 475.893 s/op\r\nIteration   2: 394.335 s/op\r\nIteration   3: 478.714 s/op\r\n\r\nZSort String\r\nIteration   1: 869.749 s/op\r\nIteration   2: 860.209 s/op\r\nIteration   3: 741.194 s/op\r\n\r\n-------------------\r\n\r\nSort4 Columns\r\nIteration   1: 234.163 s/op\r\nIteration   2: 226.640 s/op\r\nIteration   3: 418.113 s/op\r\n\r\nZSort4 Columns\r\nIteration   1:952.127 s/op\r\nIteration   2: 873.557 s/op\r\nIteration   3: 915.652 s/op\r\n\r\n------------------\r\nSort6 Columns\r\nIteration   1: 425.914 s/op\r\nIteration   2: 417.350 s/op\r\nIteration   3: 413.875 s/op\r\n\r\nZSort 6 Columns\r\nIteration   1: 1010.229 s/op\r\nIteration   2: 1002.726 s/op\r\nIteration   3: 1060.042 s/op\r\n```\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045044478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045054928","html_url":"https://github.com/apache/iceberg/pull/3983#issuecomment-1045054928","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3983","id":1045054928,"node_id":"IC_kwDOCW7NX84-SkXQ","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T19:22:54Z","updated_at":"2022-02-18T19:22:54Z","author_association":"MEMBER","body":"> > I'm guessing we could do better with a custom sort expression which doesn't materialize the entire ZValue.\r\n> \r\n> That's one thing that using a float will do. We can convert the first 8 bytes back into a long and then use a secondary column of the remaining bytes or just discard them if we're okay with the loss of precision. That reduces the overall shuffle size and also makes Spark's internal operations much more efficient:\r\n> \r\n> * UnsafeRow returns primitive longs, rather than allocating arrays and copying bytes out of unsafe memory\r\n> * The value is stored in the fixed-width portion of UnsafeRow, rather than using both length and the variable portion\r\n> * Bytes are compared 8 at a time rather than 1-by-1\r\n\r\nI think if this was actually the case we would see the 4 integer Sort version run much faster than the 4 IntegerZorder portion. But they aren't even though the 4 Integer one should only have to compare the first integer (all values for all columns are the same so only the first column needs to be read a compare time). It also doesn't have the cost of creating an extra column and serializing slightly more information. \r\n\r\nThe complexity of packing things into columns really doesn't seem like it will get us that much. I think as an example here I will trim our String key down to 8 bytes and rerun that test. I'm betting with that the timings will scale just with the raw number of bytes we have to interleave.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045054928/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045055044","html_url":"https://github.com/apache/iceberg/issues/4168#issuecomment-1045055044","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4168","id":1045055044,"node_id":"IC_kwDOCW7NX84-SkZE","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T19:23:00Z","updated_at":"2022-02-18T19:23:00Z","author_association":"CONTRIBUTOR","body":"So essentially what we observed is that the Flink S3 FileIO failed to upload the data files due to file not exist, but the missing data file is incorrectly tracked in iceberg manifest. So the subsequent query against the partition will fail as the claimed data file cannot be found.\r\n\r\nOur iceberg was setup on AWS S3 with versioned bucket and we can confirm that the \r\n- data file never get uploaded, no version exists of given path\r\n- the data file is being tracked in iceberg and we do see such non-exist data file in iceberg metadata query\r\n\r\nThis result in some nasty behavior where we need to reconcile the manifest state based on what exists in underlying file system, which is not possible. So we had to drop the partition as temporary work around. But I think it would be helpful to understand \r\n\r\nwhy do we run into the issue where iceberg commits before s3 confirm the data file is uploaded?\r\n\r\nIn the meantime, we are trying to see if we can have a simple repro of the issue\r\n\r\nCC @szehon-ho ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045055044/reactions","total_count":5,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045086515","html_url":"https://github.com/apache/iceberg/pull/3983#issuecomment-1045086515","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3983","id":1045086515,"node_id":"IC_kwDOCW7NX84-SsEz","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T19:48:03Z","updated_at":"2022-03-04T20:59:59Z","author_association":"MEMBER","body":"```\r\nZOrder Sort4Columns with only 8 Bytes of the String Considered when making the interleave column\r\nIteration   1: 298.384 s/op\r\nIteration   2: 316.174 s/op\r\nIteration   3: 312.037 s/op\r\n\r\nFor Reference sort with 4 Columns from the previous run\r\nSort4 Columns\r\nIteration   1: 234.163 s/op\r\nIteration   2: 226.640 s/op\r\nIteration   3: 418.113 s/op\r\n```\r\n\r\n\r\nThe dominating factor here is I'm pretty sure just the additional amount of bytes that need to be serialized back and forth and the cost of the interleave column, I don't think the sort comparison is really that significant compared to those costs\r\n\r\nOne more test, Forcing the ZOrder Column into exactly 8 Bytes (essentially once 8 bytes have been contributed the row is done regardless of how many bytes are in the input columns. \r\n\r\n```\r\nZOrder Sort4 Columns but the ZValue is only allowed to be 8 bytes long all other information is discarded\r\nIteration   1: 284.234 s/op\r\nIteration   2: 274.458 s/op\r\nIteration   3: 278.901 s/op\r\n```\r\n\r\n@rdblue added in a version where we have the ZOrder function return a Long instead of a byte array. So this is basically the same as the above test which only uses a max of 8 interleaved bytes. Then uses ByteBuffer.pos(0).getLong to place this value into a Spark Column. It ends up being slower than the byte comparison above. I don't know why.\r\n\r\n```\r\nIteration   1: 317.637 s/op\r\nIteration   2: 311.544 s/op\r\nIteration   3: 303.514 s/op\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045086515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045089615","html_url":"https://github.com/apache/iceberg/issues/4139#issuecomment-1045089615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4139","id":1045089615,"node_id":"IC_kwDOCW7NX84-Ss1P","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T19:50:03Z","updated_at":"2022-02-18T19:50:03Z","author_association":"COLLABORATOR","body":"@jackye1995 @rdblue @chenjunjiedada  (or sorry if missed someone also involved) wanted to check, has there been some  discussion of the whether this is a good way to go (re-use existing data_files table), versus making a new metadata table for delete files?  Thanks\r\n\r\nI am thinking that the obstacle would be the naming, ie 'files' indicates data+delete files , and its current counterpart 'all_data_files' indicates just data files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045089615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045110934","html_url":"https://github.com/apache/iceberg/pull/4141#issuecomment-1045110934","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4141","id":1045110934,"node_id":"IC_kwDOCW7NX84-SyCW","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T20:04:06Z","updated_at":"2022-02-18T20:04:06Z","author_association":"COLLABORATOR","body":"@RussellSpitzer replied to comments , when you have time for another look.  @aokolnychyi no problem, thanks for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045110934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045130210","html_url":"https://github.com/apache/iceberg/pull/4157#issuecomment-1045130210","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4157","id":1045130210,"node_id":"IC_kwDOCW7NX84-S2vi","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T20:21:22Z","updated_at":"2022-02-18T20:21:22Z","author_association":"CONTRIBUTOR","body":"@openinx I created a draft PR to update the release script (just for the Scala 2.13 with Spark support).\r\n\r\nI probably should have just opened a ticket. Please feel free to close that one if you update things related to the release (otherwise we'll be sure to update before Iceberg 0.14.0).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045130210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045139149","html_url":"https://github.com/apache/iceberg/pull/2496#issuecomment-1045139149","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2496","id":1045139149,"node_id":"IC_kwDOCW7NX84-S47N","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T20:30:04Z","updated_at":"2022-02-18T20:31:21Z","author_association":"MEMBER","body":"> I meant - without any rewriting implementation to change or customize anything - to have the reader check current call stack and detect if the caller is a rewriter, then we can have proper reading for un-materialized defaulted columns\r\n\r\nI'm not sure how this would work. Given my example again\r\n```\r\nGiven Row (A int)\r\nFile 1 - Row (1)\r\nFile 2 - Row (2)\r\nAlterTable Add Column (B int default (3)\r\nRewrite File 1\r\nFile1' = Row(1, 3) or Row(1, null)?\r\n```\r\n\r\nIf I choose Row(1, 3) then File2 will get a different value if the default is changed. (Forbidding changing the default sounds like an ok solution for this but i'm not a huge fan of table changes that have this kind of non-controlled behavior. A user choosing to Alter the default even after warning would have no real way to tell what rows got the new default and which didn't)\r\n\r\nIf I choose Row(1, null) then for Required B I don't have a problem since I can just read the default, for Optional I have a problem because now have this column as null and not missing.\r\n\r\nSo I'd say i'm \r\n+1 on saying defaults are immutable with a strong wording that changing defaults is only allowed with a special flag that strongly encourages users to fully rewrite their datafiles if they only want the default applied to new files added to the table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045139149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045332149","html_url":"https://github.com/apache/iceberg/pull/4169#issuecomment-1045332149","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4169","id":1045332149,"node_id":"IC_kwDOCW7NX84-ToC1","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T23:16:21Z","updated_at":"2022-02-18T23:16:21Z","author_association":"COLLABORATOR","body":"Note: on my first version I tried to redact the log message for any sensitive filters, but not sure if its worth the complexity as there's other places in core Iceberg where filters are logged.  But let me know if that's needed and I can look at it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045332149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045343278","html_url":"https://github.com/apache/iceberg/pull/4163#issuecomment-1045343278","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4163","id":1045343278,"node_id":"IC_kwDOCW7NX84-Tqwu","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T23:29:45Z","updated_at":"2022-02-18T23:29:45Z","author_association":"CONTRIBUTOR","body":"Thanks, @pan3793 @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045343278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045381361","html_url":"https://github.com/apache/iceberg/issues/4139#issuecomment-1045381361","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4139","id":1045381361,"node_id":"IC_kwDOCW7NX84-T0Dx","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-18T23:56:44Z","updated_at":"2022-02-18T23:56:44Z","author_association":"CONTRIBUTOR","body":"The `all_data_files` metadata table was added after we were planning to add delete files, which is why we fixed the name. I'd prefer to add a separate `delete_files` metadata table since they're reasonably separate. I'm not sure whether we should add deletes to `files` or not, but I like the ability to read separate metadata tables.\r\n\r\nWhat do you think, @szehon-ho?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045381361/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045389645","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-1045389645","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":1045389645,"node_id":"IC_kwDOCW7NX84-T2FN","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T00:02:34Z","updated_at":"2022-02-19T00:02:34Z","author_association":"CONTRIBUTOR","body":"Hi @chenjunjiedada, are we still pursuing this? Is there an ETA to share?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045389645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045401882","html_url":"https://github.com/apache/iceberg/issues/4139#issuecomment-1045401882","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4139","id":1045401882,"node_id":"IC_kwDOCW7NX84-T5Ea","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T00:11:09Z","updated_at":"2022-02-19T00:11:09Z","author_association":"COLLABORATOR","body":"Got it, thanks for the background/reply, then it seems all_data_files was designed to only have data files and thus we need all_delete_files.  \r\n\r\nWas initially thinking the content field in 'files' should be enough to filter out data vs deletes, but I think a delete_files table is also reasonable too to keep it symmetric (content is still useful to distinguish between kinds of deletes).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045401882/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045428982","html_url":"https://github.com/apache/iceberg/issues/4159#issuecomment-1045428982","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4159","id":1045428982,"node_id":"IC_kwDOCW7NX84-T_r2","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T00:30:36Z","updated_at":"2022-02-19T00:30:36Z","author_association":"CONTRIBUTOR","body":"FYI @nastra and @rymurr also.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045428982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045431113","html_url":"https://github.com/apache/iceberg/issues/4159#issuecomment-1045431113","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4159","id":1045431113,"node_id":"IC_kwDOCW7NX84-UANJ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T00:32:11Z","updated_at":"2022-02-19T00:32:11Z","author_association":"CONTRIBUTOR","body":"I agree with the approach of defining gc.enabled behavior more clearly and adding owned locations. If a file is in an owned location, then the table should always be able to delete it (though it may not choose to based on catalog policy).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045431113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045432279","html_url":"https://github.com/apache/iceberg/issues/4159#issuecomment-1045432279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4159","id":1045432279,"node_id":"IC_kwDOCW7NX84-UAfX","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T00:33:04Z","updated_at":"2022-02-19T00:33:04Z","author_association":"CONTRIBUTOR","body":"cc @openinx @stevenzwu ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045432279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045441889","html_url":"https://github.com/apache/iceberg/issues/4159#issuecomment-1045441889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4159","id":1045441889,"node_id":"IC_kwDOCW7NX84-UC1h","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T00:40:11Z","updated_at":"2022-02-19T00:42:11Z","author_association":"CONTRIBUTOR","body":"> If a file is in an owned location, then the table should always be able to delete it\r\n\r\nI agree with that but I'd phrase it slightly differently. It see it more like a consequence. I'd say `gc.enabled` should control whether we can delete data and delete files (i.e. expire snapshots). Metadata files are considered always owned and can be deleted during table purge. A list of owned locations indicate what locations can be scanned for orphan files and what locations can be deleted during table purge or removal of reachable files.\r\n\r\nThat being said, if `gc.enabled` is true and a data file is in a shared location not owned by the table, I think we should still allow its removal. We can't just drop the entire location, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045441889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045454895","html_url":"https://github.com/apache/iceberg/pull/4142#issuecomment-1045454895","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4142","id":1045454895,"node_id":"IC_kwDOCW7NX84-UGAv","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T00:49:52Z","updated_at":"2022-02-19T00:50:13Z","author_association":"CONTRIBUTOR","body":"This is going to be pretty useful for unit test and debugging. Thanks @szehon-ho.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045454895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045484646","html_url":"https://github.com/apache/iceberg/pull/4052#issuecomment-1045484646","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4052","id":1045484646,"node_id":"IC_kwDOCW7NX84-UNRm","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T01:12:19Z","updated_at":"2022-02-19T01:12:28Z","author_association":"CONTRIBUTOR","body":"For some reason I had the \"core\" label on the commit message, but this is API and AWS module updates. Updated the commit message to reflect this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045484646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045591360","html_url":"https://github.com/apache/iceberg/issues/4090#issuecomment-1045591360","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4090","id":1045591360,"node_id":"IC_kwDOCW7NX84-UnVA","user":{"login":"KarlManong","id":2627662,"node_id":"MDQ6VXNlcjI2Mjc2NjI=","avatar_url":"https://avatars.githubusercontent.com/u/2627662?v=4","gravatar_id":"","url":"https://api.github.com/users/KarlManong","html_url":"https://github.com/KarlManong","followers_url":"https://api.github.com/users/KarlManong/followers","following_url":"https://api.github.com/users/KarlManong/following{/other_user}","gists_url":"https://api.github.com/users/KarlManong/gists{/gist_id}","starred_url":"https://api.github.com/users/KarlManong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KarlManong/subscriptions","organizations_url":"https://api.github.com/users/KarlManong/orgs","repos_url":"https://api.github.com/users/KarlManong/repos","events_url":"https://api.github.com/users/KarlManong/events{/privacy}","received_events_url":"https://api.github.com/users/KarlManong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T02:34:21Z","updated_at":"2022-02-19T02:34:21Z","author_association":"CONTRIBUTOR","body":"Thank you @szehon-ho  @aokolnychyi !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045591360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045758240","html_url":"https://github.com/apache/iceberg/pull/4152#issuecomment-1045758240","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4152","id":1045758240,"node_id":"IC_kwDOCW7NX84-VQEg","user":{"login":"0xffmeta","id":98149057,"node_id":"U_kgDOBdmiwQ","avatar_url":"https://avatars.githubusercontent.com/u/98149057?v=4","gravatar_id":"","url":"https://api.github.com/users/0xffmeta","html_url":"https://github.com/0xffmeta","followers_url":"https://api.github.com/users/0xffmeta/followers","following_url":"https://api.github.com/users/0xffmeta/following{/other_user}","gists_url":"https://api.github.com/users/0xffmeta/gists{/gist_id}","starred_url":"https://api.github.com/users/0xffmeta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/0xffmeta/subscriptions","organizations_url":"https://api.github.com/users/0xffmeta/orgs","repos_url":"https://api.github.com/users/0xffmeta/repos","events_url":"https://api.github.com/users/0xffmeta/events{/privacy}","received_events_url":"https://api.github.com/users/0xffmeta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T04:49:54Z","updated_at":"2022-02-19T04:49:54Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer Thanks for the review. I have updated the PR as suggested in the comment. \r\n\r\nI'll backport this to other spark versions after this is merged. cc @dramaticlly @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045758240/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045919730","html_url":"https://github.com/apache/iceberg/pull/4111#issuecomment-1045919730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4111","id":1045919730,"node_id":"IC_kwDOCW7NX84-V3fy","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T07:07:19Z","updated_at":"2022-02-19T07:07:19Z","author_association":"CONTRIBUTOR","body":"> Thanks, @hililiwei!\r\n\r\n@rdblue Do we need to port it to Flink 1.12? In [multi-engine-support](https://iceberg.apache.org/multi-engine-support/) ,  the lifecycle stage of Flink 1.12 is `Deprecated`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045919730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045964525","html_url":"https://github.com/apache/iceberg/pull/4162#issuecomment-1045964525","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4162","id":1045964525,"node_id":"IC_kwDOCW7NX84-WCbt","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T08:11:14Z","updated_at":"2022-02-19T08:11:14Z","author_association":"CONTRIBUTOR","body":"> \r\n\r\nSorry, forgot to check all test cases...\r\nI will check all the relevant tests, and then add the corresponding test cases","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045964525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045995498","html_url":"https://github.com/apache/iceberg/pull/4158#issuecomment-1045995498","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4158","id":1045995498,"node_id":"IC_kwDOCW7NX84-WJ_q","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T11:26:10Z","updated_at":"2022-02-19T11:26:10Z","author_association":"MEMBER","body":"@kbendick the 2.4 runtime module does not use Scala jars as runtime dependencies, and itself is written in pure Java code.\r\n\r\n```\r\n./gradlew -DdefaultSparkVersions=2.4 :iceberg-spark:iceberg-spark-runtime:dependencies --configuration runtimeClasspath\r\n```\r\n\r\n```\r\n> Task :iceberg-spark:iceberg-spark-runtime:dependencies\r\n\r\n------------------------------------------------------------\r\nProject ':iceberg-spark:iceberg-spark-runtime'\r\n------------------------------------------------------------\r\n\r\nruntimeClasspath - Runtime classpath of source set 'main'.\r\n+--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n+--- project :iceberg-spark:iceberg-spark2\r\n|    +--- project :iceberg-api\r\n|    |    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    |    \\--- project :iceberg-bundled-guava\r\n|    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    +--- project :iceberg-bundled-guava\r\n|    +--- project :iceberg-common\r\n|    |    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    |    \\--- project :iceberg-bundled-guava\r\n|    +--- project :iceberg-core\r\n|    |    +--- project :iceberg-api (*)\r\n|    |    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    |    +--- project :iceberg-common (*)\r\n|    |    +--- project :iceberg-bundled-guava\r\n|    |    +--- org.apache.avro:avro -> 1.10.1\r\n|    |    |    +--- com.fasterxml.jackson.core:jackson-core:2.11.3 -> 2.11.4\r\n|    |    |    \\--- com.fasterxml.jackson.core:jackson-databind:2.11.3 -> 2.11.4\r\n|    |    |         +--- com.fasterxml.jackson.core:jackson-annotations:2.11.4\r\n|    |    |         \\--- com.fasterxml.jackson.core:jackson-core:2.11.4\r\n|    |    +--- com.fasterxml.jackson.core:jackson-databind -> 2.11.4 (*)\r\n|    |    +--- com.fasterxml.jackson.core:jackson-core -> 2.11.4\r\n|    |    +--- com.github.ben-manes.caffeine:caffeine -> 2.8.4\r\n|    |    |    +--- org.checkerframework:checker-qual:3.4.0\r\n|    |    |    \\--- com.google.errorprone:error_prone_annotations:2.3.4\r\n|    |    \\--- org.roaringbitmap:RoaringBitmap -> 0.9.22\r\n|    |         \\--- org.roaringbitmap:shims:0.9.22\r\n|    +--- project :iceberg-data\r\n|    |    +--- project :iceberg-api (*)\r\n|    |    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    |    +--- project :iceberg-bundled-guava\r\n|    |    +--- project :iceberg-core (*)\r\n|    |    +--- org.apache.orc:orc-core -> 1.7.3\r\n|    |    |    +--- org.apache.orc:orc-shims:1.7.3\r\n|    |    |    +--- io.airlift:aircompressor:0.21\r\n|    |    |    +--- org.jetbrains:annotations:17.0.0\r\n|    |    |    \\--- org.threeten:threeten-extra:1.5.0\r\n|    |    \\--- org.apache.parquet:parquet-avro -> 1.12.2\r\n|    |         +--- org.apache.parquet:parquet-column:1.12.2\r\n|    |         |    +--- org.apache.parquet:parquet-common:1.12.2\r\n|    |         |    |    +--- org.apache.parquet:parquet-format-structures:1.12.2\r\n|    |         |    |    \\--- org.apache.yetus:audience-annotations:0.12.0\r\n|    |         |    \\--- org.apache.parquet:parquet-encoding:1.12.2\r\n|    |         |         \\--- org.apache.parquet:parquet-common:1.12.2 (*)\r\n|    |         +--- org.apache.parquet:parquet-hadoop:1.12.2\r\n|    |         |    +--- org.apache.parquet:parquet-column:1.12.2 (*)\r\n|    |         |    +--- org.apache.parquet:parquet-format-structures:1.12.2\r\n|    |         |    +--- org.apache.parquet:parquet-jackson:1.12.2\r\n|    |         |    \\--- com.github.luben:zstd-jni:1.4.9-1\r\n|    |         \\--- org.apache.parquet:parquet-format-structures:1.12.2\r\n|    +--- project :iceberg-orc\r\n|    |    +--- project :iceberg-api (*)\r\n|    |    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    |    +--- project :iceberg-bundled-guava\r\n|    |    +--- project :iceberg-core (*)\r\n|    |    +--- org.apache.avro:avro -> 1.10.1 (*)\r\n|    |    \\--- org.apache.orc:orc-core -> 1.7.3 (*)\r\n|    +--- project :iceberg-parquet\r\n|    |    +--- project :iceberg-api (*)\r\n|    |    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    |    +--- project :iceberg-bundled-guava\r\n|    |    +--- project :iceberg-core (*)\r\n|    |    +--- project :iceberg-common (*)\r\n|    |    \\--- org.apache.parquet:parquet-avro -> 1.12.2 (*)\r\n|    +--- project :iceberg-arrow\r\n|    |    +--- project :iceberg-api (*)\r\n|    |    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    |    +--- project :iceberg-bundled-guava\r\n|    |    +--- project :iceberg-core (*)\r\n|    |    +--- project :iceberg-parquet (*)\r\n|    |    +--- org.apache.arrow:arrow-vector -> 7.0.0\r\n|    |    |    +--- org.apache.arrow:arrow-format:7.0.0\r\n|    |    |    |    \\--- com.google.flatbuffers:flatbuffers-java:1.12.0\r\n|    |    |    +--- org.apache.arrow:arrow-memory-core:7.0.0\r\n|    |    |    +--- com.fasterxml.jackson.core:jackson-core:2.11.4\r\n|    |    |    +--- com.fasterxml.jackson.core:jackson-annotations:2.11.4\r\n|    |    |    +--- com.fasterxml.jackson.core:jackson-databind:2.11.4 (*)\r\n|    |    |    \\--- com.google.flatbuffers:flatbuffers-java:1.12.0\r\n|    |    +--- org.apache.arrow:arrow-memory-netty -> 7.0.0\r\n|    |    |    \\--- org.apache.arrow:arrow-memory-core:7.0.0\r\n|    |    +--- org.apache.parquet:parquet-avro -> 1.12.2 (*)\r\n|    |    \\--- io.netty:netty-buffer -> 4.1.68.Final\r\n|    |         \\--- io.netty:netty-common:4.1.68.Final\r\n|    +--- com.github.ben-manes.caffeine:caffeine -> 2.8.4 (*)\r\n|    +--- org.apache.orc:orc-core -> 1.7.3 (*)\r\n|    \\--- org.apache.arrow:arrow-vector -> 7.0.0 (*)\r\n+--- project :iceberg-aws\r\n|    +--- project :iceberg-api (*)\r\n|    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    +--- project :iceberg-bundled-guava\r\n|    +--- project :iceberg-common (*)\r\n|    \\--- project :iceberg-core (*)\r\n+--- project :iceberg-aliyun\r\n|    +--- project :iceberg-api (*)\r\n|    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    +--- project :iceberg-bundled-guava\r\n|    +--- project :iceberg-core (*)\r\n|    \\--- project :iceberg-common (*)\r\n+--- project :iceberg-hive-metastore\r\n|    +--- project :iceberg-api (*)\r\n|    +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n|    +--- project :iceberg-bundled-guava\r\n|    +--- project :iceberg-core (*)\r\n|    +--- project :iceberg-common (*)\r\n|    \\--- com.github.ben-manes.caffeine:caffeine -> 2.8.4 (*)\r\n\\--- project :iceberg-nessie\r\n     +--- project :iceberg-api (*)\r\n     +--- com.github.stephenc.findbugs:findbugs-annotations -> 1.3.9-1\r\n     +--- project :iceberg-common (*)\r\n     +--- project :iceberg-core (*)\r\n     +--- project :iceberg-bundled-guava\r\n     \\--- org.projectnessie:nessie-client -> 0.20.0\r\n          \\--- org.projectnessie:nessie-model:0.20.0\r\n\r\n(*) - dependencies omitted (listed previously)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045995498/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045997888","html_url":"https://github.com/apache/iceberg/issues/4161#issuecomment-1045997888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4161","id":1045997888,"node_id":"IC_kwDOCW7NX84-WKlA","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T11:41:32Z","updated_at":"2022-02-19T11:41:32Z","author_association":"CONTRIBUTOR","body":"cc @racevedoo，@ajantha-bhat\r\nthe expire_snapshots->rewrite_data_files->rewrite_manifests->remove_orphan_files of processing in a transaction is it correct?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1045997888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046026576","html_url":"https://github.com/apache/iceberg/pull/4172#issuecomment-1046026576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4172","id":1046026576,"node_id":"IC_kwDOCW7NX84-WRlQ","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T14:12:46Z","updated_at":"2022-02-19T14:12:46Z","author_association":"MEMBER","body":"cc @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046026576/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046026629","html_url":"https://github.com/apache/iceberg/pull/4173#issuecomment-1046026629","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4173","id":1046026629,"node_id":"IC_kwDOCW7NX84-WRmF","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T14:13:01Z","updated_at":"2022-02-19T14:13:01Z","author_association":"MEMBER","body":"cc @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046026629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046040985","html_url":"https://github.com/apache/iceberg/pull/2807#issuecomment-1046040985","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2807","id":1046040985,"node_id":"IC_kwDOCW7NX84-WVGZ","user":{"login":"melin","id":1145830,"node_id":"MDQ6VXNlcjExNDU4MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1145830?v=4","gravatar_id":"","url":"https://api.github.com/users/melin","html_url":"https://github.com/melin","followers_url":"https://api.github.com/users/melin/followers","following_url":"https://api.github.com/users/melin/following{/other_user}","gists_url":"https://api.github.com/users/melin/gists{/gist_id}","starred_url":"https://api.github.com/users/melin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melin/subscriptions","organizations_url":"https://api.github.com/users/melin/orgs","repos_url":"https://api.github.com/users/melin/repos","events_url":"https://api.github.com/users/melin/events{/privacy}","received_events_url":"https://api.github.com/users/melin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T15:16:38Z","updated_at":"2022-02-19T15:16:38Z","author_association":"NONE","body":"@wang-x-xia  Ecs support hudi?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046040985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046041862","html_url":"https://github.com/apache/iceberg/issues/4161#issuecomment-1046041862","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4161","id":1046041862,"node_id":"IC_kwDOCW7NX84-WVUG","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T15:21:25Z","updated_at":"2022-02-19T15:21:25Z","author_association":"MEMBER","body":"> the expire_snapshots->rewrite_data_files->rewrite_manifests->remove_orphan_files of processing in a transaction is it correct?\r\n\r\nregarding the order I guess `expire_snapshots` should be called after `rewrite_data_files` files to clean up old data files which are compacted into the new files.\r\n\r\nNo need to call  `remove_orphan_files` every time (as having orphan files is rare scenario) \r\n\r\nAnd regarding the error on `rewrite_manifests`, \r\na. Is it a sequential operation or concurrent with other operations here?\r\nb. Is this problem only for table in hadoop catalog ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046041862/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046105144","html_url":"https://github.com/apache/iceberg/pull/4111#issuecomment-1046105144","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4111","id":1046105144,"node_id":"IC_kwDOCW7NX84-Wkw4","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T21:20:00Z","updated_at":"2022-02-19T21:20:00Z","author_association":"CONTRIBUTOR","body":"It's up to the people still using those modules. I probably wouldn't bother. It seems like there probably aren't a lot of people still using 1.12 that are waiting on HDFS support in the next Iceberg release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046105144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046105674","html_url":"https://github.com/apache/iceberg/pull/4118#issuecomment-1046105674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4118","id":1046105674,"node_id":"IC_kwDOCW7NX84-Wk5K","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-02-19T21:23:02Z","updated_at":"2022-02-19T21:23:02Z","author_association":"CONTRIBUTOR","body":"The changes look good, but this affects the LICENSE files as well. Can you remove the ANTLR section from the spark-runtime LICENSE files?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1046105674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]