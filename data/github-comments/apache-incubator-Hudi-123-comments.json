[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/832839927","html_url":"https://github.com/apache/hudi/pull/2520#issuecomment-832839927","issue_url":"https://api.github.com/repos/apache/hudi/issues/2520","id":832839927,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMjgzOTkyNw==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-05T16:38:54Z","updated_at":"2021-05-05T16:38:54Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2520?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2520](https://codecov.io/gh/apache/hudi/pull/2520?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (8b74eb7) into [master](https://codecov.io/gh/apache/hudi/commit/1db904a12ed295e08ded14bb5677dc02d76887a2?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (1db904a) will **decrease** coverage by `44.88%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2520/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2520?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2520       +/-   ##\n============================================\n- Coverage     54.22%   9.34%   -44.89%     \n+ Complexity     3809      48     -3761     \n============================================\n  Files           488      54      -434     \n  Lines         23574    2002    -21572     \n  Branches       2510     237     -2273     \n============================================\n- Hits          12783     187    -12596     \n+ Misses         9637    1802     -7835     \n+ Partials       1154      13     -1141     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `9.34% <ø> (-60.19%)` | `48.00 <ø> (-326.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2520?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [463 more](https://codecov.io/gh/apache/hudi/pull/2520/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/832839927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/832850225","html_url":"https://github.com/apache/hudi/issues/2265#issuecomment-832850225","issue_url":"https://api.github.com/repos/apache/hudi/issues/2265","id":832850225,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMjg1MDIyNQ==","user":{"login":"WilliamWhispell","id":1390230,"node_id":"MDQ6VXNlcjEzOTAyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/1390230?v=4","gravatar_id":"","url":"https://api.github.com/users/WilliamWhispell","html_url":"https://github.com/WilliamWhispell","followers_url":"https://api.github.com/users/WilliamWhispell/followers","following_url":"https://api.github.com/users/WilliamWhispell/following{/other_user}","gists_url":"https://api.github.com/users/WilliamWhispell/gists{/gist_id}","starred_url":"https://api.github.com/users/WilliamWhispell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WilliamWhispell/subscriptions","organizations_url":"https://api.github.com/users/WilliamWhispell/orgs","repos_url":"https://api.github.com/users/WilliamWhispell/repos","events_url":"https://api.github.com/users/WilliamWhispell/events{/privacy}","received_events_url":"https://api.github.com/users/WilliamWhispell/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-05T16:51:09Z","updated_at":"2021-05-05T16:51:09Z","author_association":"NONE","body":"ok, thanks. Yes the fix works for me","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/832850225/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/832882768","html_url":"https://github.com/apache/hudi/pull/2833#issuecomment-832882768","issue_url":"https://api.github.com/repos/apache/hudi/issues/2833","id":832882768,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMjg4Mjc2OA==","user":{"login":"zhedoubushishi","id":31263084,"node_id":"MDQ6VXNlcjMxMjYzMDg0","avatar_url":"https://avatars.githubusercontent.com/u/31263084?v=4","gravatar_id":"","url":"https://api.github.com/users/zhedoubushishi","html_url":"https://github.com/zhedoubushishi","followers_url":"https://api.github.com/users/zhedoubushishi/followers","following_url":"https://api.github.com/users/zhedoubushishi/following{/other_user}","gists_url":"https://api.github.com/users/zhedoubushishi/gists{/gist_id}","starred_url":"https://api.github.com/users/zhedoubushishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhedoubushishi/subscriptions","organizations_url":"https://api.github.com/users/zhedoubushishi/orgs","repos_url":"https://api.github.com/users/zhedoubushishi/repos","events_url":"https://api.github.com/users/zhedoubushishi/events{/privacy}","received_events_url":"https://api.github.com/users/zhedoubushishi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-05T17:41:53Z","updated_at":"2021-05-05T17:41:53Z","author_association":"CONTRIBUTOR","body":"> I recommend checking out:\r\n> \r\n> * https://github.com/apache/spark/blob/master/sql/catalyst/src/main/scala/org/apache/spark/sql/internal/SQLConf.scala\r\n> * https://github.com/apache/spark/blob/master/core/src/main/scala/org/apache/spark/SparkConf.scala\r\n> \r\n> It has some good pieces we can adopt and specially as we will move towards a file based configuration. Some things that just standout based on quick look, but you can dig deeper:\r\n> \r\n> * Specifying version from which that property is supported\r\n> * Whether the property is an internal config\r\n> * Differentiate between Alternate and Deprecated configs. For ex: Hudi table name has alternatives\r\n\r\nGood point! Version, Alternate & Deprecated are definitely something we can add. Will try to support them.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/832882768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833192518","html_url":"https://github.com/apache/hudi/pull/2645#issuecomment-833192518","issue_url":"https://api.github.com/repos/apache/hudi/issues/2645","id":833192518,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzE5MjUxOA==","user":{"login":"pengzhiwei2018","id":42458891,"node_id":"MDQ6VXNlcjQyNDU4ODkx","avatar_url":"https://avatars.githubusercontent.com/u/42458891?v=4","gravatar_id":"","url":"https://api.github.com/users/pengzhiwei2018","html_url":"https://github.com/pengzhiwei2018","followers_url":"https://api.github.com/users/pengzhiwei2018/followers","following_url":"https://api.github.com/users/pengzhiwei2018/following{/other_user}","gists_url":"https://api.github.com/users/pengzhiwei2018/gists{/gist_id}","starred_url":"https://api.github.com/users/pengzhiwei2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pengzhiwei2018/subscriptions","organizations_url":"https://api.github.com/users/pengzhiwei2018/orgs","repos_url":"https://api.github.com/users/pengzhiwei2018/repos","events_url":"https://api.github.com/users/pengzhiwei2018/events{/privacy}","received_events_url":"https://api.github.com/users/pengzhiwei2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T03:13:01Z","updated_at":"2021-05-06T04:10:43Z","author_association":"NONE","body":"Hi @vinothchandar , Thanks for your  working on the test.\r\n\r\n- CREATE TABLE\r\n> Even if it fails, it ends up creating the table (i.e its not atomic per se)\r\n\r\nYes, It is not atomic for CTAS currently. I can fix this in this PR later.\r\n\r\n> When selecting all columns (probably need more tests across data types)\r\n\r\nYes, I will add more tests across data types.\r\n\r\n\r\n> Truncate table\r\n\r\nFor `Truncate table`, we need do some work for hudi which is not covered in this PR. I will file another PR to solve this.\r\n\r\n\r\n\r\n- MergeInto\r\n>1、 Fails due to assignment field/schema mismatch\r\n\r\nCurrently, merge into cannot support Partial updates, we should specified all the fields of the target table in the update set assignments.\r\n\r\n>2、 Merges only allowed by PK\r\n\r\nYes, this is currently a limitation of PR to `merge into` as we discussed in the RFC-25. I think we can solve this in another PR.\r\n\r\n> 3、Merge not updating to new value\r\n\r\nThis is a same issue with 1，currently we do not support Partial updates.\r\n\r\n\r\n- Delete Table\r\n\r\n> Non PK based deletes are not working atm\r\n\r\nCurrently we cannot support delete or update a non-pk hudi table. For this case, we can use the `_hoodie_record_key` to  identify a record and do the delete & update. We can file a PR to support this.\r\n\r\n> Why do we have to encode column name into reach record key? i.e _hoodie_record_key = '1' vs being _hoodie_record_key = 'id:1'\r\n\r\nThis is hoodie's original behavior for `_hoodie_record_key`.\r\n\r\n\r\n- Create or Replace table\r\nThis has not supported in this PR. I will file a PR for this.\r\n\r\n\r\n- Create table, partitioned by\r\n> create table hudi_gh_ext using hudi partitioned by (type) location 'file:///tmp/hudi-gh-ext' as select type, public, payload, repo, actor, org, id, other  from gh_raw]\r\njava.lang.AssertionError: assertion failed\r\n\r\nThe partitioned column must be on the rightmost side of the SELECT column. This is \r\na requirement of Spark SQL. So we should move the `type` to the last select column, just like this:\r\n> create table hudi_gh_ext using hudi partitioned by (type) location 'file:///tmp/hudi-gh-ext' as select public, payload, repo, actor, org, id, other , type from gh_raw.\r\n\r\nI will add a translator to move the partition columns to the right most of the select list.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833192518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833195752","html_url":"https://github.com/apache/hudi/pull/2645#issuecomment-833195752","issue_url":"https://api.github.com/repos/apache/hudi/issues/2645","id":833195752,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzE5NTc1Mg==","user":{"login":"pengzhiwei2018","id":42458891,"node_id":"MDQ6VXNlcjQyNDU4ODkx","avatar_url":"https://avatars.githubusercontent.com/u/42458891?v=4","gravatar_id":"","url":"https://api.github.com/users/pengzhiwei2018","html_url":"https://github.com/pengzhiwei2018","followers_url":"https://api.github.com/users/pengzhiwei2018/followers","following_url":"https://api.github.com/users/pengzhiwei2018/following{/other_user}","gists_url":"https://api.github.com/users/pengzhiwei2018/gists{/gist_id}","starred_url":"https://api.github.com/users/pengzhiwei2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pengzhiwei2018/subscriptions","organizations_url":"https://api.github.com/users/pengzhiwei2018/orgs","repos_url":"https://api.github.com/users/pengzhiwei2018/repos","events_url":"https://api.github.com/users/pengzhiwei2018/events{/privacy}","received_events_url":"https://api.github.com/users/pengzhiwei2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T03:23:24Z","updated_at":"2021-05-06T03:24:04Z","author_association":"NONE","body":"> @pengzhiwei2018 few suggestions/questions . could you please clarify?\r\n> \r\n> * How does one pass any `HoodieWriteConfig` for a INSERT/UPDATE/DELETE/MERGE statement\r\n> * Setting user specified metadata with each commit. This is very important for interplay with deltastreamer etc.\r\n> * Do we support setting table properties? SET command.\r\n> * Can we add a functional test that does a sequence of statements and parameterize it for both COW/MOR? Want to ensure we can document the entire support matrix.\r\n> * Should we add more rigorous tests for  partitioned tables/data types?\r\n> \r\n> Next steps for me is to run it at a larger scale on a cluster.\r\n\r\n\r\nHi @vinothchandar \r\n> How does one pass any `HoodieWriteConfig` for a INSERT/UPDATE/DELETE/MERGE statement\r\n\r\nUsing the set options. e.g. `set hoodie.insert.shuffle.parallelism = 4`\r\n\r\n> Do we support setting table properties? SET command.\r\nYes, we support SET Command to set the write config and other runtime properties. For table properties like table type, table name, we can use the alter table command. \r\n\r\n> Can we add a functional test that does a sequence of statements and parameterize it for both COW/MOR? Want to ensure we can document the entire support matrix.\r\n\r\nYes, that is great. I will do this.\r\n\r\n> Should we add more rigorous tests for partitioned tables/data types?\r\n\r\nOf course, I will add more test case to cover more data types.\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833195752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833221898","html_url":"https://github.com/apache/hudi/pull/2893#issuecomment-833221898","issue_url":"https://api.github.com/repos/apache/hudi/issues/2893","id":833221898,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzIyMTg5OA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T04:50:40Z","updated_at":"2021-05-06T04:50:40Z","author_association":"MEMBER","body":"@pengzhiwei2018 could you also please review this PR?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833221898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833242199","html_url":"https://github.com/apache/hudi/pull/2904#issuecomment-833242199","issue_url":"https://api.github.com/repos/apache/hudi/issues/2904","id":833242199,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzI0MjE5OQ==","user":{"login":"MyLanPangzi","id":46845236,"node_id":"MDQ6VXNlcjQ2ODQ1MjM2","avatar_url":"https://avatars.githubusercontent.com/u/46845236?v=4","gravatar_id":"","url":"https://api.github.com/users/MyLanPangzi","html_url":"https://github.com/MyLanPangzi","followers_url":"https://api.github.com/users/MyLanPangzi/followers","following_url":"https://api.github.com/users/MyLanPangzi/following{/other_user}","gists_url":"https://api.github.com/users/MyLanPangzi/gists{/gist_id}","starred_url":"https://api.github.com/users/MyLanPangzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MyLanPangzi/subscriptions","organizations_url":"https://api.github.com/users/MyLanPangzi/orgs","repos_url":"https://api.github.com/users/MyLanPangzi/repos","events_url":"https://api.github.com/users/MyLanPangzi/events{/privacy}","received_events_url":"https://api.github.com/users/MyLanPangzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T05:43:02Z","updated_at":"2021-05-06T05:43:02Z","author_association":"CONTRIBUTOR","body":"@vinothchandar Hi, have anybody take time inspect the spark test ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833242199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833244809","html_url":"https://github.com/apache/hudi/pull/2908#issuecomment-833244809","issue_url":"https://api.github.com/repos/apache/hudi/issues/2908","id":833244809,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzI0NDgwOQ==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T05:49:09Z","updated_at":"2021-05-06T05:49:09Z","author_association":"CONTRIBUTOR","body":"Close because the local tests show that it is rarely triggered and the data may lost.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833244809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833247436","html_url":"https://github.com/apache/hudi/pull/2893#issuecomment-833247436","issue_url":"https://api.github.com/repos/apache/hudi/issues/2893","id":833247436,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzI0NzQzNg==","user":{"login":"pengzhiwei2018","id":42458891,"node_id":"MDQ6VXNlcjQyNDU4ODkx","avatar_url":"https://avatars.githubusercontent.com/u/42458891?v=4","gravatar_id":"","url":"https://api.github.com/users/pengzhiwei2018","html_url":"https://github.com/pengzhiwei2018","followers_url":"https://api.github.com/users/pengzhiwei2018/followers","following_url":"https://api.github.com/users/pengzhiwei2018/following{/other_user}","gists_url":"https://api.github.com/users/pengzhiwei2018/gists{/gist_id}","starred_url":"https://api.github.com/users/pengzhiwei2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pengzhiwei2018/subscriptions","organizations_url":"https://api.github.com/users/pengzhiwei2018/orgs","repos_url":"https://api.github.com/users/pengzhiwei2018/repos","events_url":"https://api.github.com/users/pengzhiwei2018/events{/privacy}","received_events_url":"https://api.github.com/users/pengzhiwei2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T05:55:05Z","updated_at":"2021-05-06T05:55:05Z","author_association":"NONE","body":"> @pengzhiwei2018 could you also please review this PR?\r\n\r\nThat is all right!  I will spend some time on this PR tonight.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833247436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833332159","html_url":"https://github.com/apache/hudi/pull/2719#issuecomment-833332159","issue_url":"https://api.github.com/repos/apache/hudi/issues/2719","id":833332159,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzMzMjE1OQ==","user":{"login":"MyLanPangzi","id":46845236,"node_id":"MDQ6VXNlcjQ2ODQ1MjM2","avatar_url":"https://avatars.githubusercontent.com/u/46845236?v=4","gravatar_id":"","url":"https://api.github.com/users/MyLanPangzi","html_url":"https://github.com/MyLanPangzi","followers_url":"https://api.github.com/users/MyLanPangzi/followers","following_url":"https://api.github.com/users/MyLanPangzi/following{/other_user}","gists_url":"https://api.github.com/users/MyLanPangzi/gists{/gist_id}","starred_url":"https://api.github.com/users/MyLanPangzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MyLanPangzi/subscriptions","organizations_url":"https://api.github.com/users/MyLanPangzi/orgs","repos_url":"https://api.github.com/users/MyLanPangzi/repos","events_url":"https://api.github.com/users/MyLanPangzi/events{/privacy}","received_events_url":"https://api.github.com/users/MyLanPangzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T08:21:10Z","updated_at":"2021-05-06T08:21:10Z","author_association":"CONTRIBUTOR","body":"i test with hive 2.3.8 and add follow shell. i got a runtime exception seems abnormal.\r\n\r\nHIVE_VERSION=$(hive --version|head -n 1|awk '{print $2}')\r\n\r\nif [[ $HIVE_VERSION =~ ^2 ]]; then\r\n  HIVE_DATANUCLEUS=`ls ${HIVE_HOME}/lib/datanucleus-*.jar | tr '\\n' ':'`\r\n  DERBY=`ls ${HIVE_HOME}/lib/derby-*.jar | tr '\\n' ':'`\r\n  JDO=`ls ${HIVE_HOME}/lib/javax.jdo-*.jar | tr '\\n' ':'`\r\n  HIVE_JARS=$HIVE_JARS:$HIVE_DATANUCLEUS:$DERBY:$JDO\r\nfi\r\necho \"$HIVE_VERSION\"\r\nif [[ $HIVE_VERSION =~ ^3 ]]; then\r\n  HIVE_CALCITE=`ls ${HIVE_HOME}/lib/calcite-*.jar | tr '\\n' ':'`\r\n  if [ -n \"$HIVE_CALCITE\" ]; then\r\n      HIVE_JARS=$HIVE_JARS:$HIVE_CALCITE\r\n  fi\r\n  HIVE_LIBFB303=`ls ${HIVE_HOME}/lib/libfb303-*.jar | tr '\\n' ':'`\r\n  if [ -n \"$HIVE_LIBFB303\" ]; then\r\n      HIVE_JARS=$HIVE_JARS:$HIVE_LIBFB303\r\n  fi\r\nfi\r\n\r\nRequired table missing : \"DBS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\norg.datanucleus.store.rdbms.exceptions.MissingTableException: Required table missing : \"DBS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\n        at org.datanucleus.store.rdbms.table.AbstractTable.exists(AbstractTable.java:606)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.performTablesValidation(RDBMSStoreManager.java:3385)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.run(RDBMSStoreManager.java:2896)\r\n        at org.datanucleus.store.rdbms.AbstractSchemaTransaction.execute(AbstractSchemaTransaction.java:119)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.manageClasses(RDBMSStoreManager.java:1627)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.getDatastoreClass(RDBMSStoreManager.java:672)\r\n        at org.datanucleus.store.rdbms.query.RDBMSQueryUtils.getStatementForCandidates(RDBMSQueryUtils.java:425)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileQueryFull(JDOQLQuery.java:865)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileInternal(JDOQLQuery.java:347)\r\n        at org.datanucleus.store.query.Query.executeQuery(Query.java:1816)\r\n        at org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)\r\n        at org.datanucleus.store.query.Query.execute(Query.java:1726)\r\n        at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:374)\r\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:216)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.ensureDbInit(MetaStoreDirectSql.java:181)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.<init>(MetaStoreDirectSql.java:144)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initializeHelper(ObjectStore.java:410)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:342)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:303)\r\n        at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:77)\r\n        at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:137)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:58)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStoreForConf(HiveMetaStore.java:628)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:594)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\n2021-05-02 06:39:10,326 WARN  [main] DataNucleus.Query (Log4JLogger.java:warn(106)) - Query for candidates of org.apache.hadoop.hive.metastore.model.MTableColumnStatistics and subclasses resulted in no possible candidates\r\nRequired table missing : \"CDS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\norg.datanucleus.store.rdbms.exceptions.MissingTableException: Required table missing : \"CDS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\n        at org.datanucleus.store.rdbms.table.AbstractTable.exists(AbstractTable.java:606)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.performTablesValidation(RDBMSStoreManager.java:3385)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.run(RDBMSStoreManager.java:2896)\r\n        at org.datanucleus.store.rdbms.AbstractSchemaTransaction.execute(AbstractSchemaTransaction.java:119)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.manageClasses(RDBMSStoreManager.java:1627)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.getDatastoreClass(RDBMSStoreManager.java:672)\r\n        at org.datanucleus.store.rdbms.query.RDBMSQueryUtils.getStatementForCandidates(RDBMSQueryUtils.java:425)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileQueryFull(JDOQLQuery.java:865)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileInternal(JDOQLQuery.java:347)\r\n        at org.datanucleus.store.query.Query.executeQuery(Query.java:1816)\r\n        at org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)\r\n        at org.datanucleus.store.query.Query.execute(Query.java:1726)\r\n        at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:374)\r\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:216)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.ensureDbInit(MetaStoreDirectSql.java:184)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.<init>(MetaStoreDirectSql.java:144)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initializeHelper(ObjectStore.java:410)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:342)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:303)\r\n        at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:77)\r\n        at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:137)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:58)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStoreForConf(HiveMetaStore.java:628)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:594)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\n2021-05-02 06:39:10,338 WARN  [main] DataNucleus.Query (Log4JLogger.java:warn(106)) - Query for candidates of org.apache.hadoop.hive.metastore.model.MPartitionColumnStatistics and subclasses resulted in no possible candidates\r\nRequired table missing : \"CDS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\norg.datanucleus.store.rdbms.exceptions.MissingTableException: Required table missing : \"CDS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\n        at org.datanucleus.store.rdbms.table.AbstractTable.exists(AbstractTable.java:606)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.performTablesValidation(RDBMSStoreManager.java:3385)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.run(RDBMSStoreManager.java:2896)\r\n        at org.datanucleus.store.rdbms.AbstractSchemaTransaction.execute(AbstractSchemaTransaction.java:119)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.manageClasses(RDBMSStoreManager.java:1627)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.getDatastoreClass(RDBMSStoreManager.java:672)\r\n        at org.datanucleus.store.rdbms.query.RDBMSQueryUtils.getStatementForCandidates(RDBMSQueryUtils.java:425)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileQueryFull(JDOQLQuery.java:865)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileInternal(JDOQLQuery.java:347)\r\n        at org.datanucleus.store.query.Query.executeQuery(Query.java:1816)\r\n        at org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)\r\n        at org.datanucleus.store.query.Query.execute(Query.java:1726)\r\n        at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:374)\r\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:216)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.ensureDbInit(MetaStoreDirectSql.java:187)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.<init>(MetaStoreDirectSql.java:144)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initializeHelper(ObjectStore.java:410)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:342)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:303)\r\n        at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:77)\r\n        at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:137)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:58)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStoreForConf(HiveMetaStore.java:628)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:594)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\n2021-05-02 06:39:10,517 WARN  [main] DataNucleus.Query (Log4JLogger.java:warn(106)) - Query for candidates of org.apache.hadoop.hive.metastore.model.MConstraint and subclasses resulted in no possible candidates\r\nRequired table missing : \"CDS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\norg.datanucleus.store.rdbms.exceptions.MissingTableException: Required table missing : \"CDS\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\n        at org.datanucleus.store.rdbms.table.AbstractTable.exists(AbstractTable.java:606)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.performTablesValidation(RDBMSStoreManager.java:3385)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.run(RDBMSStoreManager.java:2896)\r\n        at org.datanucleus.store.rdbms.AbstractSchemaTransaction.execute(AbstractSchemaTransaction.java:119)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.manageClasses(RDBMSStoreManager.java:1627)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.getDatastoreClass(RDBMSStoreManager.java:672)\r\n        at org.datanucleus.store.rdbms.query.RDBMSQueryUtils.getStatementForCandidates(RDBMSQueryUtils.java:425)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileQueryFull(JDOQLQuery.java:865)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileInternal(JDOQLQuery.java:347)\r\n        at org.datanucleus.store.query.Query.executeQuery(Query.java:1816)\r\n        at org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)\r\n        at org.datanucleus.store.query.Query.execute(Query.java:1726)\r\n        at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:374)\r\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:216)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.ensureDbInit(MetaStoreDirectSql.java:190)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.<init>(MetaStoreDirectSql.java:144)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initializeHelper(ObjectStore.java:410)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:342)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:303)\r\n        at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:77)\r\n        at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:137)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:58)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStoreForConf(HiveMetaStore.java:628)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:594)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\n2021-05-02 06:39:10,552 WARN  [main] metastore.MetaStoreDirectSql (MetaStoreDirectSql.java:runTestQuery(234)) - Self-test query [select \"DB_ID\" from \"DBS\"] failed; direct SQL is disabled\r\njavax.jdo.JDODataStoreException: Error executing SQL query \"select \"DB_ID\" from \"DBS\"\".\r\n        at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:543)\r\n        at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:391)\r\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:216)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.runTestQuery(MetaStoreDirectSql.java:230)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.<init>(MetaStoreDirectSql.java:144)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initializeHelper(ObjectStore.java:410)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:342)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:303)\r\n        at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:77)\r\n        at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:137)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:58)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStoreForConf(HiveMetaStore.java:628)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:594)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\nNestedThrowablesStackTrace:\r\njava.sql.SQLSyntaxErrorException: Table/View 'DBS' does not exist.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.<init>(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement20.<init>(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement30.<init>(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement40.<init>(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement42.<init>(Unknown Source)\r\n        at org.apache.derby.jdbc.Driver42.newEmbedPreparedStatement(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source)\r\n        at org.datanucleus.store.rdbms.datasource.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:274)\r\n        at org.datanucleus.store.rdbms.datasource.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:314)\r\n        at org.datanucleus.store.rdbms.SQLController.getStatementForQuery(SQLController.java:345)\r\n        at org.datanucleus.store.rdbms.query.RDBMSQueryUtils.getPreparedStatementForQuery(RDBMSQueryUtils.java:211)\r\n        at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:633)\r\n        at org.datanucleus.store.query.Query.executeQuery(Query.java:1855)\r\n        at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:807)\r\n        at org.datanucleus.store.query.Query.execute(Query.java:1726)\r\n        at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:374)\r\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:216)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.runTestQuery(MetaStoreDirectSql.java:230)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.<init>(MetaStoreDirectSql.java:144)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initializeHelper(ObjectStore.java:410)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:342)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:303)\r\n        at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:77)\r\n        at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:137)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:58)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.newRawStoreForConf(HiveMetaStore.java:628)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:594)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\nCaused by: java.sql.SQLException: Table/View 'DBS' does not exist.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n        ... 70 more\r\nCaused by: ERROR 42X05: Table/View 'DBS' does not exist.\r\n        at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)\r\n        at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source)\r\n        at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source)\r\n        at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source)\r\n        at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source)\r\n        at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source)\r\n        at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source)\r\n        at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source)\r\n        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source)\r\n        ... 64 more\r\n2021-05-02 06:39:10,555 INFO  [main] metastore.ObjectStore (ObjectStore.java:setConf(317)) - Initialized ObjectStore\r\n2021-05-02 06:39:10,587 WARN  [main] DataNucleus.Query (Log4JLogger.java:warn(106)) - Query for candidates of org.apache.hadoop.hive.metastore.model.MVersionTable and subclasses resulted in no possible candidates\r\nRequired table missing : \"VERSION\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\norg.datanucleus.store.rdbms.exceptions.MissingTableException: Required table missing : \"VERSION\" in Catalog \"\" Schema \"\". DataNucleus requires this table to perform its persistence operations. Either your MetaData is incorrect, or you need to enable \"datanucleus.schema.autoCreateTables\"\r\n        at org.datanucleus.store.rdbms.table.AbstractTable.exists(AbstractTable.java:606)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.performTablesValidation(RDBMSStoreManager.java:3385)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager$ClassAdder.run(RDBMSStoreManager.java:2896)\r\n        at org.datanucleus.store.rdbms.AbstractSchemaTransaction.execute(AbstractSchemaTransaction.java:119)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.manageClasses(RDBMSStoreManager.java:1627)\r\n        at org.datanucleus.store.rdbms.RDBMSStoreManager.getDatastoreClass(RDBMSStoreManager.java:672)\r\n        at org.datanucleus.store.rdbms.query.RDBMSQueryUtils.getStatementForCandidates(RDBMSQueryUtils.java:425)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileQueryFull(JDOQLQuery.java:865)\r\n        at org.datanucleus.store.rdbms.query.JDOQLQuery.compileInternal(JDOQLQuery.java:347)\r\n        at org.datanucleus.store.query.Query.executeQuery(Query.java:1816)\r\n        at org.datanucleus.store.query.Query.executeWithArray(Query.java:1744)\r\n        at org.datanucleus.store.query.Query.execute(Query.java:1726)\r\n        at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:374)\r\n        at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:216)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.getMSchemaVersion(ObjectStore.java:7864)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.getMetaStoreSchemaVersion(ObjectStore.java:7848)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.checkSchema(ObjectStore.java:7804)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.verifySchema(ObjectStore.java:7788)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:101)\r\n        at com.sun.proxy.$Proxy18.verifySchema(Unknown Source)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:595)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\n2021-05-02 06:39:10,597 ERROR [main] metastore.RetryingHMSHandler (RetryingHMSHandler.java:invokeInternal(204)) - MetaException(message:Version information not found in metastore. )\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.checkSchema(ObjectStore.java:7810)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.verifySchema(ObjectStore.java:7788)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:101)\r\n        at com.sun.proxy.$Proxy18.verifySchema(Unknown Source)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:595)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\n\r\n2021-05-02 06:39:10,597 ERROR [main] metastore.RetryingHMSHandler (RetryingHMSHandler.java:<init>(82)) - HMSHandler Fatal error: MetaException(message:Version information not found in metastore. )\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.checkSchema(ObjectStore.java:7810)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.verifySchema(ObjectStore.java:7788)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:101)\r\n        at com.sun.proxy.$Proxy18.verifySchema(Unknown Source)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:595)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\n\r\n2021-05-02 06:39:10,597 WARN  [main] metadata.Hive (Hive.java:registerAllFunctionsOnce(234)) - Failed to register all functions.\r\njava.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1709)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\nCaused by: java.lang.reflect.InvocationTargetException\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        ... 16 more\r\nCaused by: MetaException(message:Version information not found in metastore. )\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        ... 21 more\r\nCaused by: MetaException(message:Version information not found in metastore. )\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.checkSchema(ObjectStore.java:7810)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.verifySchema(ObjectStore.java:7788)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:101)\r\n        at com.sun.proxy.$Proxy18.verifySchema(Unknown Source)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:595)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n        ... 25 more\r\nException in thread \"main\" org.apache.hudi.hive.HoodieHiveSyncException: Got runtime exception when hive syncing\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:75)\r\n        at org.apache.hudi.hive.HiveSyncTool.main(HiveSyncTool.java:257)\r\nCaused by: org.apache.hudi.hive.HoodieHiveSyncException: Failed to create HiveMetaStoreClient\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:93)\r\n        at org.apache.hudi.hive.HiveSyncTool.<init>(HiveSyncTool.java:70)\r\n        ... 1 more\r\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:236)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.<init>(Hive.java:388)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.java:332)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.java:312)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.java:288)\r\n        at org.apache.hudi.hive.HoodieHiveClient.<init>(HoodieHiveClient.java:91)\r\n        ... 2 more\r\nCaused by: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1709)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\r\n        at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.java:3894)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.java:248)\r\n        at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.java:231)\r\n        ... 7 more\r\nCaused by: java.lang.reflect.InvocationTargetException\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\r\n        at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1707)\r\n        ... 16 more\r\nCaused by: MetaException(message:Version information not found in metastore. )\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:83)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:92)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:6902)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164)\r\n        at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\r\n        ... 21 more\r\nCaused by: MetaException(message:Version information not found in metastore. )\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.checkSchema(ObjectStore.java:7810)\r\n        at org.apache.hadoop.hive.metastore.ObjectStore.verifySchema(ObjectStore.java:7788)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:101)\r\n        at com.sun.proxy.$Proxy18.verifySchema(Unknown Source)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMSForConf(HiveMetaStore.java:595)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:588)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:655)\r\n        at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:431)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:498)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:148)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:107)\r\n        at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:79)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833332159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833342296","html_url":"https://github.com/apache/hudi/pull/2904#issuecomment-833342296","issue_url":"https://api.github.com/repos/apache/hudi/issues/2904","id":833342296,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzM0MjI5Ng==","user":{"login":"MyLanPangzi","id":46845236,"node_id":"MDQ6VXNlcjQ2ODQ1MjM2","avatar_url":"https://avatars.githubusercontent.com/u/46845236?v=4","gravatar_id":"","url":"https://api.github.com/users/MyLanPangzi","html_url":"https://github.com/MyLanPangzi","followers_url":"https://api.github.com/users/MyLanPangzi/followers","following_url":"https://api.github.com/users/MyLanPangzi/following{/other_user}","gists_url":"https://api.github.com/users/MyLanPangzi/gists{/gist_id}","starred_url":"https://api.github.com/users/MyLanPangzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MyLanPangzi/subscriptions","organizations_url":"https://api.github.com/users/MyLanPangzi/orgs","repos_url":"https://api.github.com/users/MyLanPangzi/repos","events_url":"https://api.github.com/users/MyLanPangzi/events{/privacy}","received_events_url":"https://api.github.com/users/MyLanPangzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T08:35:10Z","updated_at":"2021-05-06T08:35:10Z","author_association":"CONTRIBUTOR","body":"@danny0405 hi, the org.apache.hudi.sink.transform.TestRowDataToHoodieFunction#testRateLimit  cannot pass, could you help me inspect the ut ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833342296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833349514","html_url":"https://github.com/apache/hudi/issues/2917#issuecomment-833349514","issue_url":"https://api.github.com/repos/apache/hudi/issues/2917","id":833349514,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzM0OTUxNA==","user":{"login":"liijiankang","id":42951757,"node_id":"MDQ6VXNlcjQyOTUxNzU3","avatar_url":"https://avatars.githubusercontent.com/u/42951757?v=4","gravatar_id":"","url":"https://api.github.com/users/liijiankang","html_url":"https://github.com/liijiankang","followers_url":"https://api.github.com/users/liijiankang/followers","following_url":"https://api.github.com/users/liijiankang/following{/other_user}","gists_url":"https://api.github.com/users/liijiankang/gists{/gist_id}","starred_url":"https://api.github.com/users/liijiankang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liijiankang/subscriptions","organizations_url":"https://api.github.com/users/liijiankang/orgs","repos_url":"https://api.github.com/users/liijiankang/repos","events_url":"https://api.github.com/users/liijiankang/events{/privacy}","received_events_url":"https://api.github.com/users/liijiankang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T08:45:25Z","updated_at":"2021-05-06T08:45:25Z","author_association":"NONE","body":"![2](https://user-images.githubusercontent.com/42951757/117268956-6b121880-ae8a-11eb-8448-eed776dbcdcf.jpg)\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833349514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833459923","html_url":"https://github.com/apache/hudi/pull/2868#issuecomment-833459923","issue_url":"https://api.github.com/repos/apache/hudi/issues/2868","id":833459923,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzQ1OTkyMw==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T11:48:21Z","updated_at":"2021-05-06T11:48:21Z","author_association":"CONTRIBUTOR","body":"> see https://issues.apache.org/jira/browse/HUDI-1872\r\n\r\n@MyLanPangzi Are you interested in this ticket? To continue refactoring.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833459923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833493033","html_url":"https://github.com/apache/hudi/pull/2868#issuecomment-833493033","issue_url":"https://api.github.com/repos/apache/hudi/issues/2868","id":833493033,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzQ5MzAzMw==","user":{"login":"MyLanPangzi","id":46845236,"node_id":"MDQ6VXNlcjQ2ODQ1MjM2","avatar_url":"https://avatars.githubusercontent.com/u/46845236?v=4","gravatar_id":"","url":"https://api.github.com/users/MyLanPangzi","html_url":"https://github.com/MyLanPangzi","followers_url":"https://api.github.com/users/MyLanPangzi/followers","following_url":"https://api.github.com/users/MyLanPangzi/following{/other_user}","gists_url":"https://api.github.com/users/MyLanPangzi/gists{/gist_id}","starred_url":"https://api.github.com/users/MyLanPangzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MyLanPangzi/subscriptions","organizations_url":"https://api.github.com/users/MyLanPangzi/orgs","repos_url":"https://api.github.com/users/MyLanPangzi/repos","events_url":"https://api.github.com/users/MyLanPangzi/events{/privacy}","received_events_url":"https://api.github.com/users/MyLanPangzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T12:45:23Z","updated_at":"2021-05-06T12:45:23Z","author_association":"CONTRIBUTOR","body":"> > see https://issues.apache.org/jira/browse/HUDI-1872\r\n> \r\n> @MyLanPangzi Are you interested in this ticket? To continue refactoring.\r\n\r\nyes, I have already made part of it in my local repo.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833493033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833601155","html_url":"https://github.com/apache/hudi/pull/2784#issuecomment-833601155","issue_url":"https://api.github.com/repos/apache/hudi/issues/2784","id":833601155,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzYwMTE1NQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T15:10:47Z","updated_at":"2021-05-06T15:10:47Z","author_association":"MEMBER","body":"Thanks for this @ssdong and also the great explanation and detailed comments along the way. I am on it. This is a bit deep, been trying to set aside an hour or so. :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833601155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833682238","html_url":"https://github.com/apache/hudi/pull/2714#issuecomment-833682238","issue_url":"https://api.github.com/repos/apache/hudi/issues/2714","id":833682238,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzY4MjIzOA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T16:51:46Z","updated_at":"2021-05-06T16:51:46Z","author_association":"MEMBER","body":"This test is just flaky\r\n\r\n```\r\n[INFO] \r\n[ERROR] Failures: \r\n[ERROR]   TestHoodieMultiTableDeltaStreamer.testMultiTableExecutionWithKafkaSource:168 expected: <true> but was: <false>\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833682238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833683614","html_url":"https://github.com/apache/hudi/pull/2714#issuecomment-833683614","issue_url":"https://api.github.com/repos/apache/hudi/issues/2714","id":833683614,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzY4MzYxNA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T16:53:46Z","updated_at":"2021-05-06T16:53:46Z","author_association":"MEMBER","body":">it would be changed to debug if there are some stats to indicate the time cost. I think it is an important stat when profiling.\r\n\r\nTypically, we turn on logs with perf profiing only after a dashboard shows some regression right. For e.g in bloom filter code, this is what we do. Keep everything in `DEBUG` and only turn on as needed. Let me see if I can convince you otherwise :)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833683614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833746933","html_url":"https://github.com/apache/hudi/pull/2915#issuecomment-833746933","issue_url":"https://api.github.com/repos/apache/hudi/issues/2915","id":833746933,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzc0NjkzMw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-06T18:10:11Z","updated_at":"2021-05-06T18:10:11Z","author_association":"MEMBER","body":"Great suggestions @leesf ! We can file followups for those. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833746933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833971983","html_url":"https://github.com/apache/hudi/pull/2918#issuecomment-833971983","issue_url":"https://api.github.com/repos/apache/hudi/issues/2918","id":833971983,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzk3MTk4Mw==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T00:33:43Z","updated_at":"2021-05-07T18:58:01Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2918?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2918](https://codecov.io/gh/apache/hudi/pull/2918?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (32dbe35) into [master](https://codecov.io/gh/apache/hudi/commit/0284cdecce3136c28cd8599f77f9a0b174145265?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (0284cde) will **increase** coverage by `15.29%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2918/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2918?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2918       +/-   ##\n=============================================\n+ Coverage     54.23%   69.53%   +15.29%     \n+ Complexity     3810      374     -3436     \n=============================================\n  Files           488       54      -434     \n  Lines         23574     2002    -21572     \n  Branches       2510      237     -2273     \n=============================================\n- Hits          12786     1392    -11394     \n+ Misses         9636      478     -9158     \n+ Partials       1152      132     -1020     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `?` | `?` | |\n| hudicommon | `?` | `?` | |\n| hudiflink | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| hudisparkdatasource | `?` | `?` | |\n| hudisync | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `69.53% <ø> (-0.05%)` | `374.00 <ø> (-1.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2918?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.08% <0.00%> (-0.35%)` | `55.00% <0.00%> (-1.00%)` | |\n| [...n/java/org/apache/hudi/common/HoodieCleanStat.java](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL0hvb2RpZUNsZWFuU3RhdC5qYXZh) | | | |\n| [...n/scala/org/apache/hudi/HoodieMergeOnReadRDD.scala](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZU1lcmdlT25SZWFkUkRELnNjYWxh) | | | |\n| [...hadoop/realtime/RealtimeCompactedRecordReader.java](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3JlYWx0aW1lL1JlYWx0aW1lQ29tcGFjdGVkUmVjb3JkUmVhZGVyLmphdmE=) | | | |\n| [...che/hudi/exception/InvalidHoodiePathException.java](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL0ludmFsaWRIb29kaWVQYXRoRXhjZXB0aW9uLmphdmE=) | | | |\n| [.../hudi/async/SparkStreamingAsyncCompactService.java](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvYXN5bmMvU3BhcmtTdHJlYW1pbmdBc3luY0NvbXBhY3RTZXJ2aWNlLmphdmE=) | | | |\n| [...org/apache/hudi/common/model/TableServiceType.java](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL1RhYmxlU2VydmljZVR5cGUuamF2YQ==) | | | |\n| [.../common/util/queue/FunctionBasedQueueProducer.java](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvcXVldWUvRnVuY3Rpb25CYXNlZFF1ZXVlUHJvZHVjZXIuamF2YQ==) | | | |\n| [...ava/org/apache/hudi/cli/commands/UtilsCommand.java](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jbGkvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY2xpL2NvbW1hbmRzL1V0aWxzQ29tbWFuZC5qYXZh) | | | |\n| [.../hudi/table/format/cow/ParquetSplitReaderUtil.java](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9mb3JtYXQvY293L1BhcnF1ZXRTcGxpdFJlYWRlclV0aWwuamF2YQ==) | | | |\n| ... and [425 more](https://codecov.io/gh/apache/hudi/pull/2918/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833971983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833988217","html_url":"https://github.com/apache/hudi/pull/2915#issuecomment-833988217","issue_url":"https://api.github.com/repos/apache/hudi/issues/2915","id":833988217,"node_id":"MDEyOklzc3VlQ29tbWVudDgzMzk4ODIxNw==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T01:17:08Z","updated_at":"2021-05-07T01:17:08Z","author_association":"CONTRIBUTOR","body":"Can we add tests for these scenarios\r\n1. no matching rows with incremental fetch. lets say everything is caught up. \r\n2. records in source table range from 0 to 100. you set checkpoint as 200. again, this should return empty set. \r\n3. records in source table range from 100 to 200. checkpoint is set to 50 and source limit is 50. \r\n4. Do we have tests when source table has more records than source limit. something like (3) above. \r\n5. Write one long running test (10 iterations of incremental fetch). \r\n\r\nOrthogonal point: \r\nDid we consider option to renaming columns when inserting to hudi. not required in this diff. but in general. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/833988217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834023836","html_url":"https://github.com/apache/hudi/pull/2868#issuecomment-834023836","issue_url":"https://api.github.com/repos/apache/hudi/issues/2868","id":834023836,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDAyMzgzNg==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T02:58:30Z","updated_at":"2021-05-07T02:58:30Z","author_association":"CONTRIBUTOR","body":"> > > see https://issues.apache.org/jira/browse/HUDI-1872\r\n> > \r\n> > \r\n> > @MyLanPangzi Are you interested in this ticket? To continue refactoring.\r\n> \r\n> yes, I have already made part of it in my local repo.\r\n\r\nsg. thanks~","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834023836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834075609","html_url":"https://github.com/apache/hudi/pull/2719#issuecomment-834075609","issue_url":"https://api.github.com/repos/apache/hudi/issues/2719","id":834075609,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDA3NTYwOQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T05:21:20Z","updated_at":"2021-05-07T05:21:20Z","author_association":"MEMBER","body":"any reason why you closed this @MyLanPangzi ? \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834075609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834084750","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-834084750","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":834084750,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDA4NDc1MA==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T05:46:37Z","updated_at":"2021-05-07T05:46:37Z","author_association":"CONTRIBUTOR","body":"Hi @vinothchandar Can you take a look, this PR is small and we need this in emergency.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834084750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834085407","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-834085407","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":834085407,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDA4NTQwNw==","user":{"login":"sbernauer","id":29303194,"node_id":"MDQ6VXNlcjI5MzAzMTk0","avatar_url":"https://avatars.githubusercontent.com/u/29303194?v=4","gravatar_id":"","url":"https://api.github.com/users/sbernauer","html_url":"https://github.com/sbernauer","followers_url":"https://api.github.com/users/sbernauer/followers","following_url":"https://api.github.com/users/sbernauer/following{/other_user}","gists_url":"https://api.github.com/users/sbernauer/gists{/gist_id}","starred_url":"https://api.github.com/users/sbernauer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sbernauer/subscriptions","organizations_url":"https://api.github.com/users/sbernauer/orgs","repos_url":"https://api.github.com/users/sbernauer/repos","events_url":"https://api.github.com/users/sbernauer/events{/privacy}","received_events_url":"https://api.github.com/users/sbernauer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T05:48:18Z","updated_at":"2021-05-07T05:50:48Z","author_association":"CONTRIBUTOR","body":"Hi together,\r\n\r\nwe sadly can't do schema evolution for 10 months now (https://github.com/apache/hudi/issues/1845) and have to rely on ugly workarounds.\r\nMany thanks for working together to find a solution!\r\nWe have tested this patch out in our test systems and everything worked fine. When we rolled it out to production we noticed that the Memory consumption increased by multiple times. This caused our executors to spill to disk and crash. We had to rollback to a previous version.\r\nSo i would like to highlight the comment of @sathyaprakashg\r\n> @n3nash I am working on fixing build issue and will have that fix pushed soon. I would like to point out that with this new approach, we are stroing writer schema part of payload, which means, size of dataframe would increase to store same schema information with each record. Any suggestion on optimizing this?\r\n\r\nRegards,\r\nSebastian","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834085407/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834087051","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-834087051","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":834087051,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDA4NzA1MQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T05:52:39Z","updated_at":"2021-05-07T05:52:39Z","author_association":"MEMBER","body":"Actually pretty bummed to hear that. @nsivabalan @n3nash can we do something here to prioritize this? Or at least source more help from dev list/slack? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834087051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834091378","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-834091378","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":834091378,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDA5MTM3OA==","user":{"login":"dirksan28","id":49044267,"node_id":"MDQ6VXNlcjQ5MDQ0MjY3","avatar_url":"https://avatars.githubusercontent.com/u/49044267?v=4","gravatar_id":"","url":"https://api.github.com/users/dirksan28","html_url":"https://github.com/dirksan28","followers_url":"https://api.github.com/users/dirksan28/followers","following_url":"https://api.github.com/users/dirksan28/following{/other_user}","gists_url":"https://api.github.com/users/dirksan28/gists{/gist_id}","starred_url":"https://api.github.com/users/dirksan28/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dirksan28/subscriptions","organizations_url":"https://api.github.com/users/dirksan28/orgs","repos_url":"https://api.github.com/users/dirksan28/repos","events_url":"https://api.github.com/users/dirksan28/events{/privacy}","received_events_url":"https://api.github.com/users/dirksan28/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T06:01:32Z","updated_at":"2021-05-07T06:34:55Z","author_association":"NONE","body":"I've been observing this issue for several months now. From my point of view a working schema evolution is highly fundamental for the meaningful use of hudi. I am amazed that this is not classified as a mission critical. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834091378/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834095568","html_url":"https://github.com/apache/hudi/pull/2920#issuecomment-834095568","issue_url":"https://api.github.com/repos/apache/hudi/issues/2920","id":834095568,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDA5NTU2OA==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T06:10:00Z","updated_at":"2021-05-08T03:29:36Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2920?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2920](https://codecov.io/gh/apache/hudi/pull/2920?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (963c887) into [master](https://codecov.io/gh/apache/hudi/commit/528f4ca988209cbc9e519bd42b87b896aea992b6?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (528f4ca) will **decrease** coverage by `14.77%`.\n> The diff coverage is `97.29%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2920/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2920?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2920       +/-   ##\n=============================================\n- Coverage     69.53%   54.75%   -14.78%     \n- Complexity      374     3795     +3421     \n=============================================\n  Files            54      481      +427     \n  Lines          2002    23284    +21282     \n  Branches        237     2478     +2241     \n=============================================\n+ Hits           1392    12750    +11358     \n- Misses          478     9386     +8908     \n- Partials        132     1148     +1016     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `39.53% <ø> (?)` | `220.00 <ø> (?)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.37% <ø> (?)` | `1975.00 <ø> (?)` | |\n| hudiflink | `63.01% <97.29%> (?)` | `524.00 <2.00> (?)` | |\n| hudihadoopmr | `50.93% <ø> (?)` | `259.00 <ø> (?)` | |\n| hudisparkdatasource | `73.33% <ø> (?)` | `237.00 <ø> (?)` | |\n| hudisync | `46.52% <ø> (?)` | `144.00 <ø> (?)` | |\n| huditimelineservice | `64.36% <ø> (?)` | `62.00 <ø> (?)` | |\n| hudiutilities | `69.53% <ø> (ø)` | `374.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2920?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...java/org/apache/hudi/sink/StreamWriteFunction.java](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlRnVuY3Rpb24uamF2YQ==) | `81.04% <96.77%> (ø)` | `23.00 <1.00> (?)` | |\n| [...va/org/apache/hudi/configuration/FlinkOptions.java](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9jb25maWd1cmF0aW9uL0ZsaW5rT3B0aW9ucy5qYXZh) | `90.48% <100.00%> (ø)` | `11.00 <0.00> (?)` | |\n| [...e/hudi/sink/transform/RowDataToHoodieFunction.java](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3RyYW5zZm9ybS9Sb3dEYXRhVG9Ib29kaWVGdW5jdGlvbi5qYXZh) | `83.33% <100.00%> (ø)` | `5.00 <1.00> (?)` | |\n| [...n/java/org/apache/hudi/common/HoodieCleanStat.java](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL0hvb2RpZUNsZWFuU3RhdC5qYXZh) | `46.80% <0.00%> (ø)` | `9.00% <0.00%> (?%)` | |\n| [...n/scala/org/apache/hudi/HoodieMergeOnReadRDD.scala](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZU1lcmdlT25SZWFkUkRELnNjYWxh) | `90.76% <0.00%> (ø)` | `15.00% <0.00%> (?%)` | |\n| [...hadoop/realtime/RealtimeCompactedRecordReader.java](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3JlYWx0aW1lL1JlYWx0aW1lQ29tcGFjdGVkUmVjb3JkUmVhZGVyLmphdmE=) | `65.62% <0.00%> (ø)` | `14.00% <0.00%> (?%)` | |\n| [...che/hudi/exception/InvalidHoodiePathException.java](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZXhjZXB0aW9uL0ludmFsaWRIb29kaWVQYXRoRXhjZXB0aW9uLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [.../hudi/async/SparkStreamingAsyncCompactService.java](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvYXN5bmMvU3BhcmtTdHJlYW1pbmdBc3luY0NvbXBhY3RTZXJ2aWNlLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [...org/apache/hudi/common/model/TableServiceType.java](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL1RhYmxlU2VydmljZVR5cGUuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [.../common/util/queue/FunctionBasedQueueProducer.java](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvcXVldWUvRnVuY3Rpb25CYXNlZFF1ZXVlUHJvZHVjZXIuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| ... and [420 more](https://codecov.io/gh/apache/hudi/pull/2920/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834095568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834095894","html_url":"https://github.com/apache/hudi/pull/2904#issuecomment-834095894","issue_url":"https://api.github.com/repos/apache/hudi/issues/2904","id":834095894,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDA5NTg5NA==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T06:10:46Z","updated_at":"2021-05-07T06:10:46Z","author_association":"CONTRIBUTOR","body":"The test would be removed in HUDI-1878","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834095894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834111741","html_url":"https://github.com/apache/hudi/issues/2883#issuecomment-834111741","issue_url":"https://api.github.com/repos/apache/hudi/issues/2883","id":834111741,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDExMTc0MQ==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T06:45:56Z","updated_at":"2021-05-07T06:45:56Z","author_association":"CONTRIBUTOR","body":"> @yanghua @leesf @dannyhchen : can one of you folks take this up\r\n\r\nYes, you can change or rewrite your `HoodieFlinkStreamer` so that you can replace the source or do more things.\r\n\r\nOr, you can even reuse the `HoodieFlinkWriteClient` for more scalability if you want.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834111741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834115800","html_url":"https://github.com/apache/hudi/pull/2784#issuecomment-834115800","issue_url":"https://api.github.com/repos/apache/hudi/issues/2784","id":834115800,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDExNTgwMA==","user":{"login":"ssdong","id":3754011,"node_id":"MDQ6VXNlcjM3NTQwMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3754011?v=4","gravatar_id":"","url":"https://api.github.com/users/ssdong","html_url":"https://github.com/ssdong","followers_url":"https://api.github.com/users/ssdong/followers","following_url":"https://api.github.com/users/ssdong/following{/other_user}","gists_url":"https://api.github.com/users/ssdong/gists{/gist_id}","starred_url":"https://api.github.com/users/ssdong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ssdong/subscriptions","organizations_url":"https://api.github.com/users/ssdong/orgs","repos_url":"https://api.github.com/users/ssdong/repos","events_url":"https://api.github.com/users/ssdong/events{/privacy}","received_events_url":"https://api.github.com/users/ssdong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T06:54:12Z","updated_at":"2021-05-07T06:54:12Z","author_association":"CONTRIBUTOR","body":"@vinothchandar No problem! Thank you for your precious time and let me know if you have a second thought on this fix. :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834115800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834116492","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-834116492","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":834116492,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDExNjQ5Mg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T06:55:25Z","updated_at":"2021-05-07T06:55:25Z","author_association":"MEMBER","body":">This change is introducing another instance which will double the overhead. What benefits do you see by doing this ?\r\n\r\nWould it though? I mean, its just an object reference right? I am more concerned about the timeline not being refreshed across instantiations of writeclient from the same jvm ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834116492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834117293","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-834117293","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":834117293,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDExNzI5Mw==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T06:57:00Z","updated_at":"2021-05-07T06:57:00Z","author_association":"CONTRIBUTOR","body":"> AbstractHoodieClient\r\n\r\nThey are not singleton, as i said, each writer task takes a AbstractWriteClient, and there may be multiple write tasks in one process.\r\n\r\nI agree we should avoid adding state in helper methods, but it's fine for singleton pattern.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834117293/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834118649","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-834118649","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":834118649,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDExODY0OQ==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T06:59:33Z","updated_at":"2021-05-07T06:59:33Z","author_association":"CONTRIBUTOR","body":"> Looking at the usage of `createEmbeddedTimelineService()`, there are broadly two.\r\n> \r\n> * AbstractHoodieClient can start (during intiialization) and stop (during close()) the embedded server view. If we return the same static instance, it will be tied to the same underlying file system view which may be stale i.e may not see the new commit. See `createInMemoryFileSystemView()` in FileSystemViewManager for e.g which is initialized during the timeline server creation.\r\n> * DeltaStreamer in `DeltaSync#reInitWriteClient` actually keeps a single instance of the embedded timeline server. it would n't reinit each time.\r\n> \r\n> Overall, can we think through any side effects of this change?\r\n\r\nYes, so we should reload the active timeline each time we fetch the filesystem view from the meta client, the `TimelineService` would check the timeline hashcode from client right ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834118649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834118960","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-834118960","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":834118960,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDExODk2MA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T07:00:10Z","updated_at":"2021-05-07T07:02:03Z","author_association":"MEMBER","body":"I actually see that @n3nash has approved this several months ago, pending the perf  issue that @sathyaprakashg himself has pointed out. Agree with you,. Let me gather some context and see how we can move forward. I also wonder if we had landed other PRs around this. @nsivabalan remember you landed something around it or I am mistaken?\r\n\r\nAny reason we have not landed this @n3nash? any open items that you see besides the perf issue. (storing schema in payload should be avoided at all costs). This is what a schema registry solves for.  ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834118960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834124145","html_url":"https://github.com/apache/hudi/pull/2921#issuecomment-834124145","issue_url":"https://api.github.com/repos/apache/hudi/issues/2921","id":834124145,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDEyNDE0NQ==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T07:10:04Z","updated_at":"2021-05-07T07:54:20Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2921?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2921](https://codecov.io/gh/apache/hudi/pull/2921?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (8f0cd43) into [master](https://codecov.io/gh/apache/hudi/commit/0a5863939b8da149f6dab3ec0fdb86d77baa9739?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (0a58639) will **decrease** coverage by `14.81%`.\n> The diff coverage is `52.94%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2921/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2921?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2921       +/-   ##\n=============================================\n- Coverage     69.58%   54.76%   -14.82%     \n- Complexity      375     3796     +3421     \n=============================================\n  Files            54      481      +427     \n  Lines          2002    23284    +21282     \n  Branches        237     2479     +2242     \n=============================================\n+ Hits           1393    12752    +11359     \n- Misses          478     9382     +8904     \n- Partials        131     1150     +1019     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `39.53% <ø> (?)` | `220.00 <ø> (?)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.38% <ø> (?)` | `1975.00 <ø> (?)` | |\n| hudiflink | `62.94% <52.94%> (?)` | `525.00 <3.00> (?)` | |\n| hudihadoopmr | `50.93% <ø> (?)` | `259.00 <ø> (?)` | |\n| hudisparkdatasource | `73.33% <ø> (?)` | `237.00 <ø> (?)` | |\n| hudisync | `46.73% <ø> (?)` | `144.00 <ø> (?)` | |\n| huditimelineservice | `64.36% <ø> (?)` | `62.00 <ø> (?)` | |\n| hudiutilities | `69.53% <ø> (-0.05%)` | `374.00 <ø> (-1.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2921?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [.../hudi/table/format/mor/MergeOnReadInputFormat.java](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9mb3JtYXQvbW9yL01lcmdlT25SZWFkSW5wdXRGb3JtYXQuamF2YQ==) | `65.14% <20.00%> (ø)` | `18.00 <0.00> (?)` | |\n| [...ache/hudi/source/StreamReadMonitoringFunction.java](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zb3VyY2UvU3RyZWFtUmVhZE1vbml0b3JpbmdGdW5jdGlvbi5qYXZh) | `76.38% <63.63%> (ø)` | `34.00 <3.00> (?)` | |\n| [...java/org/apache/hudi/sink/StreamWriteFunction.java](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlRnVuY3Rpb24uamF2YQ==) | `77.60% <100.00%> (ø)` | `21.00 <0.00> (?)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.08% <0.00%> (-0.35%)` | `55.00% <0.00%> (-1.00%)` | |\n| [.../hadoop/realtime/RealtimeUnmergedRecordReader.java](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3JlYWx0aW1lL1JlYWx0aW1lVW5tZXJnZWRSZWNvcmRSZWFkZXIuamF2YQ==) | `97.56% <0.00%> (ø)` | `11.00% <0.00%> (?%)` | |\n| [...rg/apache/hudi/common/fs/NoOpConsistencyGuard.java](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL05vT3BDb25zaXN0ZW5jeUd1YXJkLmphdmE=) | `60.00% <0.00%> (ø)` | `3.00% <0.00%> (?%)` | |\n| [.../java/org/apache/hudi/common/util/RateLimiter.java](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvUmF0ZUxpbWl0ZXIuamF2YQ==) | `86.66% <0.00%> (ø)` | `9.00% <0.00%> (?%)` | |\n| [...e/hudi/hadoop/FileStatusWithBootstrapBaseFile.java](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL0ZpbGVTdGF0dXNXaXRoQm9vdHN0cmFwQmFzZUZpbGUuamF2YQ==) | `0.00% <0.00%> (ø)` | `0.00% <0.00%> (?%)` | |\n| [.../apache/hudi/common/model/HoodieRecordPayload.java](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL21vZGVsL0hvb2RpZVJlY29yZFBheWxvYWQuamF2YQ==) | `25.00% <0.00%> (ø)` | `1.00% <0.00%> (?%)` | |\n| [...g/apache/hudi/MergeOnReadIncrementalRelation.scala](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL01lcmdlT25SZWFkSW5jcmVtZW50YWxSZWxhdGlvbi5zY2FsYQ==) | `84.00% <0.00%> (ø)` | `24.00% <0.00%> (?%)` | |\n| ... and [421 more](https://codecov.io/gh/apache/hudi/pull/2921/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834124145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834130415","html_url":"https://github.com/apache/hudi/pull/2719#issuecomment-834130415","issue_url":"https://api.github.com/repos/apache/hudi/issues/2719","id":834130415,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDEzMDQxNQ==","user":{"login":"MyLanPangzi","id":46845236,"node_id":"MDQ6VXNlcjQ2ODQ1MjM2","avatar_url":"https://avatars.githubusercontent.com/u/46845236?v=4","gravatar_id":"","url":"https://api.github.com/users/MyLanPangzi","html_url":"https://github.com/MyLanPangzi","followers_url":"https://api.github.com/users/MyLanPangzi/followers","following_url":"https://api.github.com/users/MyLanPangzi/following{/other_user}","gists_url":"https://api.github.com/users/MyLanPangzi/gists{/gist_id}","starred_url":"https://api.github.com/users/MyLanPangzi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MyLanPangzi/subscriptions","organizations_url":"https://api.github.com/users/MyLanPangzi/orgs","repos_url":"https://api.github.com/users/MyLanPangzi/repos","events_url":"https://api.github.com/users/MyLanPangzi/events{/privacy}","received_events_url":"https://api.github.com/users/MyLanPangzi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T07:22:14Z","updated_at":"2021-05-07T07:23:33Z","author_association":"CONTRIBUTOR","body":"@vinothchandar  i think the hive dependencies too many to control...\r\ni can use anthor way to mapping hive table to hudi table.\r\ne.g\r\nCREATE EXTERNAL TABLE t1\r\n(\r\n    `_hoodie_commit_time`    STRING,\r\n    `_hoodie_commit_seqno`   STRING,\r\n    `_hoodie_record_key`     STRING,\r\n    `_hoodie_partition_path` STRING,\r\n    `_hoodie_file_name`      STRING,\r\n    shopid                   STRING\r\n) partitioned by (`sdt` string)\r\n    ROW FORMAT SERDE\r\n        'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'\r\n    STORED AS INPUTFORMAT\r\n        'org.apache.hudi.hadoop.realtime.HoodieParquetRealtimeInputFormat'\r\n        OUTPUTFORMAT\r\n            'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'\r\n    LOCATION 'hdfs://nameservice1/hudi/t1';\r\n\r\nALTER TABLE dwd_sale_sale_detail_rt ADD\r\n    PARTITION (`sdt` = '20210414') LOCATION 'hdfs://nameservice1/hudi/t1//20210414';\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834130415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834140226","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-834140226","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":834140226,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDE0MDIyNg==","user":{"login":"giaosudau","id":539238,"node_id":"MDQ6VXNlcjUzOTIzOA==","avatar_url":"https://avatars.githubusercontent.com/u/539238?v=4","gravatar_id":"","url":"https://api.github.com/users/giaosudau","html_url":"https://github.com/giaosudau","followers_url":"https://api.github.com/users/giaosudau/followers","following_url":"https://api.github.com/users/giaosudau/following{/other_user}","gists_url":"https://api.github.com/users/giaosudau/gists{/gist_id}","starred_url":"https://api.github.com/users/giaosudau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giaosudau/subscriptions","organizations_url":"https://api.github.com/users/giaosudau/orgs","repos_url":"https://api.github.com/users/giaosudau/repos","events_url":"https://api.github.com/users/giaosudau/events{/privacy}","received_events_url":"https://api.github.com/users/giaosudau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T07:39:33Z","updated_at":"2021-05-07T07:39:33Z","author_association":"CONTRIBUTOR","body":"Yes I am following this PR for the last 6 months. \r\nWhen I presented to my teammate I thought it works out of the box but it didn't. Kind of sad.\r\nPlease help put more focus on it.\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834140226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834312959","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-834312959","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":834312959,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDMxMjk1OQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T12:03:31Z","updated_at":"2021-05-07T12:03:31Z","author_association":"CONTRIBUTOR","body":"> I spent sometime to understand this PR. thanks for putting it up @sathyaprakashg. I have few clarifications.\r\n> \r\n> 1. Can you fix the description wrt latest status. I don't see SchemaBasedSchemaProvider etc.\r\n> 2. FYI We landed a [fix](https://github.com/apache/hudi/pull/2765) wrt default vals and null in unions. If incase, the schema post processing is not required at all w/ this fix, it would simplify things. Guess the namespace fix in this PR may not be required if the post processing step is not required. @bvaradar @n3nash : can you folks chime in here please. another related [fixed datatype jira](https://issues.apache.org/jira/browse/HUDI-1607). the backwards incompatibility may not be an issue if we go this route. \r\n> 3. Also, I pulled the test locally and was trying to verify things. Looks like the test is not generating records as intended in 3rd step. Here is what is happening.\r\n>    \r\n>    * TestDataSource generates data w/ intended schema(old)\r\n>    * But in SourceFormatAdapter, when we do AvroConversionUtils.createDataFrame(...), evolved schema is passed in. and so InputBatch<Dataset> returned from here has new column set to null for all records.\r\n>    * I also verified this from within the IdentityTransformer which was showing evolved schema and record having new column as well.\r\n>      so, essentially the test also need to be fixed.\r\n\r\n@vinothchandar : We need to iron out the perf issue. But these were my comments earlier. it could simplify the backwards compatibility issue which was being discussed. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834312959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834320533","html_url":"https://github.com/apache/hudi/pull/2920#issuecomment-834320533","issue_url":"https://api.github.com/repos/apache/hudi/issues/2920","id":834320533,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDMyMDUzMw==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T12:13:43Z","updated_at":"2021-05-07T12:13:43Z","author_association":"CONTRIBUTOR","body":"@danny0405 Conflicting files...","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834320533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834349577","html_url":"https://github.com/apache/hudi/pull/2922#issuecomment-834349577","issue_url":"https://api.github.com/repos/apache/hudi/issues/2922","id":834349577,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDM0OTU3Nw==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T12:49:22Z","updated_at":"2025-01-13T13:21:22Z","author_association":"NONE","body":"## [Codecov](https://app.codecov.io/gh/apache/hudi/pull/2922?dropdown=coverage&src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) Report\nAttention: Patch coverage is `0%` with `3 lines` in your changes missing coverage. Please review.\n> Project coverage is 9.34%. Comparing base [(`7a5af80`)](https://app.codecov.io/gh/apache/hudi/commit/7a5af806cfe54474014db5c70641c0c6269fff03?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) to head [(`8182c9a`)](https://app.codecov.io/gh/apache/hudi/commit/8182c9aff0d50f79953b3a14f13ca5acefc67828?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache).\n> Report is 4475 commits behind head on master.\n\n| [Files with missing lines](https://app.codecov.io/gh/apache/hudi/pull/2922?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | Patch % | Lines |\n|---|---|---|\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2Fdeltastreamer%2FDeltaSync.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | 0.00% | [1 Missing :warning: ](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) |\n| [...i/utilities/deltastreamer/HoodieDeltaStreamer.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2Fdeltastreamer%2FHoodieDeltaStreamer.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvSG9vZGllRGVsdGFTdHJlYW1lci5qYXZh) | 0.00% | [1 Missing :warning: ](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) |\n| [.../utilities/transform/SqlQueryBasedTransformer.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2Ftransform%2FSqlQueryBasedTransformer.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3RyYW5zZm9ybS9TcWxRdWVyeUJhc2VkVHJhbnNmb3JtZXIuamF2YQ==) | 0.00% | [1 Missing :warning: ](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) |\n\n> :exclamation:  There is a different number of reports uploaded between BASE (7a5af80) and HEAD (8182c9a). Click for more details.\n> \n> <details><summary>HEAD has 9 uploads less than BASE</summary>\n>\n>| Flag | BASE (7a5af80) | HEAD (8182c9a) |\n>|------|------|------|\n>|hudiutilities|2|1|\n>|hudiclient|2|1|\n>|hudicli|1|0|\n>|hudicommon|1|0|\n>|hudiflink|1|0|\n>|hudihadoopmr|1|0|\n>|hudisparkdatasource|1|0|\n>|hudisync|1|0|\n>|huditimelineservice|1|0|\n></details>\n\n<details><summary>Additional details and impacted files</summary>\n\n\n[![Impacted file tree graph](https://app.codecov.io/gh/apache/hudi/pull/2922/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache)](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache)\n\n```diff\n@@             Coverage Diff              @@\n##             master   #2922       +/-   ##\n============================================\n- Coverage     54.78%   9.34%   -45.45%     \n+ Complexity     3808      48     -3760     \n============================================\n  Files           481      54      -427     \n  Lines         23320    2002    -21318     \n  Branches       2488     237     -2251     \n============================================\n- Hits          12777     187    -12590     \n+ Misses         9389    1802     -7587     \n+ Partials       1154      13     -1141     \n```\n\n| [Flag](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flags&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | Coverage Δ | |\n|---|---|---|\n| [hudicli](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `?` | |\n| [hudiclient](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `∅ <ø> (∅)` | |\n| [hudicommon](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `?` | |\n| [hudiflink](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `?` | |\n| [hudihadoopmr](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `?` | |\n| [hudisparkdatasource](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `?` | |\n| [hudisync](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `?` | |\n| [huditimelineservice](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `?` | |\n| [hudiutilities](https://app.codecov.io/gh/apache/hudi/pull/2922/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `9.34% <0.00%> (-60.26%)` | :arrow_down: |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Files with missing lines](https://app.codecov.io/gh/apache/hudi/pull/2922?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | Coverage Δ | |\n|---|---|---|\n| [...org/apache/hudi/utilities/HoodieClusteringJob.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2FHoodieClusteringJob.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0hvb2RpZUNsdXN0ZXJpbmdKb2IuamF2YQ==) | `0.00% <ø> (ø)` | |\n| [.../apache/hudi/utilities/HoodieSnapshotExporter.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2FHoodieSnapshotExporter.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0hvb2RpZVNuYXBzaG90RXhwb3J0ZXIuamF2YQ==) | `83.62% <ø> (ø)` | |\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2FIdentitySplitter.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <ø> (ø)` | |\n| [...in/java/org/apache/hudi/utilities/UtilHelpers.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2FUtilHelpers.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL1V0aWxIZWxwZXJzLmphdmE=) | `34.30% <ø> (ø)` | |\n| [...callback/kafka/HoodieWriteCommitKafkaCallback.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2Fcallback%2Fkafka%2FHoodieWriteCommitKafkaCallback.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2NhbGxiYWNrL2thZmthL0hvb2RpZVdyaXRlQ29tbWl0S2Fma2FDYWxsYmFjay5qYXZh) | `0.00% <ø> (ø)` | |\n| [...ck/kafka/HoodieWriteCommitKafkaCallbackConfig.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2Fcallback%2Fkafka%2FHoodieWriteCommitKafkaCallbackConfig.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2NhbGxiYWNrL2thZmthL0hvb2RpZVdyaXRlQ29tbWl0S2Fma2FDYWxsYmFja0NvbmZpZy5qYXZh) | `0.00% <ø> (ø)` | |\n| [...ities/checkpointing/InitialCheckPointProvider.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2Fcheckpointing%2FInitialCheckPointProvider.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2NoZWNrcG9pbnRpbmcvSW5pdGlhbENoZWNrUG9pbnRQcm92aWRlci5qYXZh) | `0.00% <ø> (ø)` | |\n| [...alCheckpointFromAnotherHoodieTimelineProvider.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2Fcheckpointing%2FInitialCheckpointFromAnotherHoodieTimelineProvider.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2NoZWNrcG9pbnRpbmcvSW5pdGlhbENoZWNrcG9pbnRGcm9tQW5vdGhlckhvb2RpZVRpbWVsaW5lUHJvdmlkZXIuamF2YQ==) | `0.00% <ø> (ø)` | |\n| [...lities/checkpointing/KafkaConnectHdfsProvider.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2Fcheckpointing%2FKafkaConnectHdfsProvider.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2NoZWNrcG9pbnRpbmcvS2Fma2FDb25uZWN0SGRmc1Byb3ZpZGVyLmphdmE=) | `0.00% <ø> (ø)` | |\n| [...udi/utilities/deltastreamer/BootstrapExecutor.java](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree&filepath=hudi-utilities%2Fhudi-utilities-spark%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fhudi%2Futilities%2Fdeltastreamer%2FBootstrapExecutor.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-aHVkaS11dGlsaXRpZXMvaHVkaS11dGlsaXRpZXMtc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvQm9vdHN0cmFwRXhlY3V0b3IuamF2YQ==) | `0.00% <ø> (ø)` | |\n| ... and [44 more](https://app.codecov.io/gh/apache/hudi/pull/2922?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | |\n\n... and [427 files with indirect coverage changes](https://app.codecov.io/gh/apache/hudi/pull/2922/indirect-changes?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache)\n\n</details>","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834349577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834436516","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-834436516","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":834436516,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDQzNjUxNg==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T14:11:57Z","updated_at":"2021-05-07T14:11:57Z","author_association":"CONTRIBUTOR","body":"@sathyaprakashg and others: trying to understand the use-case here. I understand its related to deltastreamer receiving events in old schema after Hudi's dataset schema got evolved. what's the schema from schema provider when source is producing events in old schema (after schema got evolved w/ hudi dataset)? if the schema provider's schema is updated, I guess there is no need to store the writer schema w/ payload. \r\nAvroConversionUtils.createDataFrame() will ensure to convert the JavaRDD<GenRec> w/ old schema to Dataset<Row> w/ new schema if schemaProvider.SourceSchema() has the evolved schema. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834436516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834497022","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-834497022","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":834497022,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDQ5NzAyMg==","user":{"login":"tandonraghavs","id":53559945,"node_id":"MDQ6VXNlcjUzNTU5OTQ1","avatar_url":"https://avatars.githubusercontent.com/u/53559945?v=4","gravatar_id":"","url":"https://api.github.com/users/tandonraghavs","html_url":"https://github.com/tandonraghavs","followers_url":"https://api.github.com/users/tandonraghavs/followers","following_url":"https://api.github.com/users/tandonraghavs/following{/other_user}","gists_url":"https://api.github.com/users/tandonraghavs/gists{/gist_id}","starred_url":"https://api.github.com/users/tandonraghavs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tandonraghavs/subscriptions","organizations_url":"https://api.github.com/users/tandonraghavs/orgs","repos_url":"https://api.github.com/users/tandonraghavs/repos","events_url":"https://api.github.com/users/tandonraghavs/events{/privacy}","received_events_url":"https://api.github.com/users/tandonraghavs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T15:08:05Z","updated_at":"2021-05-07T15:08:05Z","author_association":"NONE","body":"@sathyaprakashg @vinothchandar Can this PR handle [this](https://github.com/apache/hudi/issues/2919) issue as well? \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834497022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834554256","html_url":"https://github.com/apache/hudi/pull/2809#issuecomment-834554256","issue_url":"https://api.github.com/repos/apache/hudi/issues/2809","id":834554256,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDU1NDI1Ng==","user":{"login":"jsbali","id":1778470,"node_id":"MDQ6VXNlcjE3Nzg0NzA=","avatar_url":"https://avatars.githubusercontent.com/u/1778470?v=4","gravatar_id":"","url":"https://api.github.com/users/jsbali","html_url":"https://github.com/jsbali","followers_url":"https://api.github.com/users/jsbali/followers","following_url":"https://api.github.com/users/jsbali/following{/other_user}","gists_url":"https://api.github.com/users/jsbali/gists{/gist_id}","starred_url":"https://api.github.com/users/jsbali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsbali/subscriptions","organizations_url":"https://api.github.com/users/jsbali/orgs","repos_url":"https://api.github.com/users/jsbali/repos","events_url":"https://api.github.com/users/jsbali/events{/privacy}","received_events_url":"https://api.github.com/users/jsbali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T15:48:13Z","updated_at":"2021-05-07T15:48:13Z","author_association":"CONTRIBUTOR","body":"@vinothchandar simplified the code and fixed a typo in javadoc as well","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834554256/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834595116","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-834595116","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":834595116,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDU5NTExNg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T16:27:11Z","updated_at":"2021-05-07T16:27:11Z","author_association":"MEMBER","body":">each writer task takes a AbstractWriteClient, and there may be multiple write tasks in one process.\r\n\r\n@danny0405 please help me understand this better. By one process, you mean one yarn flink job?  or jvm process? In Spark, the model is the executors talk to the driver running the embedded timeline server in Spark. We don't run the timeline server in the executors. Could you explain the Flink model little more\r\n\r\nLet me look at the code again to see if/how we avoid the side effects in the meantime. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834595116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834688893","html_url":"https://github.com/apache/hudi/pull/2809#issuecomment-834688893","issue_url":"https://api.github.com/repos/apache/hudi/issues/2809","id":834688893,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDY4ODg5Mw==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T18:48:39Z","updated_at":"2021-05-07T18:48:39Z","author_association":"MEMBER","body":"@jsbali could you check why CI is failing? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834688893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834715657","html_url":"https://github.com/apache/hudi/pull/2833#issuecomment-834715657","issue_url":"https://api.github.com/repos/apache/hudi/issues/2833","id":834715657,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDcxNTY1Nw==","user":{"login":"zhedoubushishi","id":31263084,"node_id":"MDQ6VXNlcjMxMjYzMDg0","avatar_url":"https://avatars.githubusercontent.com/u/31263084?v=4","gravatar_id":"","url":"https://api.github.com/users/zhedoubushishi","html_url":"https://github.com/zhedoubushishi","followers_url":"https://api.github.com/users/zhedoubushishi/followers","following_url":"https://api.github.com/users/zhedoubushishi/following{/other_user}","gists_url":"https://api.github.com/users/zhedoubushishi/gists{/gist_id}","starred_url":"https://api.github.com/users/zhedoubushishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhedoubushishi/subscriptions","organizations_url":"https://api.github.com/users/zhedoubushishi/orgs","repos_url":"https://api.github.com/users/zhedoubushishi/repos","events_url":"https://api.github.com/users/zhedoubushishi/events{/privacy}","received_events_url":"https://api.github.com/users/zhedoubushishi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T19:22:15Z","updated_at":"2021-05-07T19:22:15Z","author_association":"CONTRIBUTOR","body":"@xushiyan are you intrested in reviewing this PR? This PR refactored the current Hudi configuration framework and could potentially simply Hudi configuration.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834715657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834783294","html_url":"https://github.com/apache/hudi/pull/2921#issuecomment-834783294","issue_url":"https://api.github.com/repos/apache/hudi/issues/2921","id":834783294,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDc4MzI5NA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-07T21:12:09Z","updated_at":"2021-05-07T21:12:09Z","author_association":"MEMBER","body":"@danny0405 I saw this failure post merging. \r\n\r\n```\r\n[INFO] \r\n[INFO] Results:\r\n[INFO] \r\n[ERROR] Failures: \r\n[ERROR]   TestRowDataToHoodieFunction.testRateLimit:72 should process at least 5 seconds ==> expected: <true> but was: <false>\r\n```\r\n\r\nany chance this is flaky?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834783294/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834954263","html_url":"https://github.com/apache/hudi/pull/2809#issuecomment-834954263","issue_url":"https://api.github.com/repos/apache/hudi/issues/2809","id":834954263,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDk1NDI2Mw==","user":{"login":"jsbali","id":1778470,"node_id":"MDQ6VXNlcjE3Nzg0NzA=","avatar_url":"https://avatars.githubusercontent.com/u/1778470?v=4","gravatar_id":"","url":"https://api.github.com/users/jsbali","html_url":"https://github.com/jsbali","followers_url":"https://api.github.com/users/jsbali/followers","following_url":"https://api.github.com/users/jsbali/following{/other_user}","gists_url":"https://api.github.com/users/jsbali/gists{/gist_id}","starred_url":"https://api.github.com/users/jsbali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsbali/subscriptions","organizations_url":"https://api.github.com/users/jsbali/orgs","repos_url":"https://api.github.com/users/jsbali/repos","events_url":"https://api.github.com/users/jsbali/events{/privacy}","received_events_url":"https://api.github.com/users/jsbali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T01:55:14Z","updated_at":"2021-05-08T01:55:14Z","author_association":"CONTRIBUTOR","body":"Hey @satishkotha It passed after the empty commit but failed on merging the master with it :( .Also the failure seems unrelated to this PR.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834954263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834955549","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-834955549","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":834955549,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDk1NTU0OQ==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T01:57:06Z","updated_at":"2021-05-08T01:57:06Z","author_association":"CONTRIBUTOR","body":"> > each writer task takes a AbstractWriteClient, and there may be multiple write tasks in one process.\r\n> \r\n> @danny0405 please help me understand this better. By one process, you mean one yarn flink job? or jvm process? In Spark, the model is the executors talk to the driver running the embedded timeline server in Spark. We don't run the timeline server in the executors. Could you explain the Flink model little more\r\n> \r\n> Let me look at the code again to see if/how we avoid the side effects in the meantime.\r\n\r\nFor one process, i mean the JVM process, e.g the `TaskManager` of Flink, in flink write pipeline, the source records was assigned with file group ids then hand over to the write tasks, each write task write out these records buffer (grouping by file group id) using a write client there. Because the tasks are long running, each task starts a embedded timeline server there.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834955549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834961606","html_url":"https://github.com/apache/hudi/pull/2759#issuecomment-834961606","issue_url":"https://api.github.com/repos/apache/hudi/issues/2759","id":834961606,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDk2MTYwNg==","user":{"login":"li36909","id":3632162,"node_id":"MDQ6VXNlcjM2MzIxNjI=","avatar_url":"https://avatars.githubusercontent.com/u/3632162?v=4","gravatar_id":"","url":"https://api.github.com/users/li36909","html_url":"https://github.com/li36909","followers_url":"https://api.github.com/users/li36909/followers","following_url":"https://api.github.com/users/li36909/following{/other_user}","gists_url":"https://api.github.com/users/li36909/gists{/gist_id}","starred_url":"https://api.github.com/users/li36909/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/li36909/subscriptions","organizations_url":"https://api.github.com/users/li36909/orgs","repos_url":"https://api.github.com/users/li36909/repos","events_url":"https://api.github.com/users/li36909/events{/privacy}","received_events_url":"https://api.github.com/users/li36909/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T02:05:29Z","updated_at":"2021-05-08T02:05:29Z","author_association":"CONTRIBUTOR","body":"@vinothchandar thank you","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834961606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834968018","html_url":"https://github.com/apache/hudi/issues/2924#issuecomment-834968018","issue_url":"https://api.github.com/repos/apache/hudi/issues/2924","id":834968018,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDk2ODAxOA==","user":{"login":"root18039532923","id":45333549,"node_id":"MDQ6VXNlcjQ1MzMzNTQ5","avatar_url":"https://avatars.githubusercontent.com/u/45333549?v=4","gravatar_id":"","url":"https://api.github.com/users/root18039532923","html_url":"https://github.com/root18039532923","followers_url":"https://api.github.com/users/root18039532923/followers","following_url":"https://api.github.com/users/root18039532923/following{/other_user}","gists_url":"https://api.github.com/users/root18039532923/gists{/gist_id}","starred_url":"https://api.github.com/users/root18039532923/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/root18039532923/subscriptions","organizations_url":"https://api.github.com/users/root18039532923/orgs","repos_url":"https://api.github.com/users/root18039532923/repos","events_url":"https://api.github.com/users/root18039532923/events{/privacy}","received_events_url":"https://api.github.com/users/root18039532923/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T02:13:58Z","updated_at":"2021-05-08T02:13:58Z","author_association":"NONE","body":"I think it may be due to log files.Because I query mor_ro table,it is ok. @msridhar ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834968018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834969846","html_url":"https://github.com/apache/hudi/issues/2924#issuecomment-834969846","issue_url":"https://api.github.com/repos/apache/hudi/issues/2924","id":834969846,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNDk2OTg0Ng==","user":{"login":"root18039532923","id":45333549,"node_id":"MDQ6VXNlcjQ1MzMzNTQ5","avatar_url":"https://avatars.githubusercontent.com/u/45333549?v=4","gravatar_id":"","url":"https://api.github.com/users/root18039532923","html_url":"https://github.com/root18039532923","followers_url":"https://api.github.com/users/root18039532923/followers","following_url":"https://api.github.com/users/root18039532923/following{/other_user}","gists_url":"https://api.github.com/users/root18039532923/gists{/gist_id}","starred_url":"https://api.github.com/users/root18039532923/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/root18039532923/subscriptions","organizations_url":"https://api.github.com/users/root18039532923/orgs","repos_url":"https://api.github.com/users/root18039532923/repos","events_url":"https://api.github.com/users/root18039532923/events{/privacy}","received_events_url":"https://api.github.com/users/root18039532923/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T02:16:26Z","updated_at":"2021-05-08T02:16:26Z","author_association":"NONE","body":"@bvaradar  Can you help me solve this problem","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/834969846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835003864","html_url":"https://github.com/apache/hudi/issues/2830#issuecomment-835003864","issue_url":"https://api.github.com/repos/apache/hudi/issues/2830","id":835003864,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTAwMzg2NA==","user":{"login":"wsxGit","id":29750673,"node_id":"MDQ6VXNlcjI5NzUwNjcz","avatar_url":"https://avatars.githubusercontent.com/u/29750673?v=4","gravatar_id":"","url":"https://api.github.com/users/wsxGit","html_url":"https://github.com/wsxGit","followers_url":"https://api.github.com/users/wsxGit/followers","following_url":"https://api.github.com/users/wsxGit/following{/other_user}","gists_url":"https://api.github.com/users/wsxGit/gists{/gist_id}","starred_url":"https://api.github.com/users/wsxGit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wsxGit/subscriptions","organizations_url":"https://api.github.com/users/wsxGit/orgs","repos_url":"https://api.github.com/users/wsxGit/repos","events_url":"https://api.github.com/users/wsxGit/events{/privacy}","received_events_url":"https://api.github.com/users/wsxGit/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T02:57:36Z","updated_at":"2021-05-08T02:57:36Z","author_association":"NONE","body":"I have found reason ,hoodie.datasource.write.operation use UPSERT  sloved the issue\r\n\r\n> oh, I see you are using GLOBAL_BLOOM as your index. Can you tell us which version of hudi are you using and other env details.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835003864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835060053","html_url":"https://github.com/apache/hudi/pull/2921#issuecomment-835060053","issue_url":"https://api.github.com/repos/apache/hudi/issues/2921","id":835060053,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTA2MDA1Mw==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T03:51:02Z","updated_at":"2021-05-08T03:51:02Z","author_association":"CONTRIBUTOR","body":"> @danny0405 I saw this failure post merging.\r\n> \r\n> ```\r\n> [INFO] \r\n> [INFO] Results:\r\n> [INFO] \r\n> [ERROR] Failures: \r\n> [ERROR]   TestRowDataToHoodieFunction.testRateLimit:72 should process at least 5 seconds ==> expected: <true> but was: <false>\r\n> ```\r\n> \r\n> any chance this is flaky?\r\n\r\nYes, would remove the test together in HUDI-1878.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835060053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835063730","html_url":"https://github.com/apache/hudi/issues/2919#issuecomment-835063730","issue_url":"https://api.github.com/repos/apache/hudi/issues/2919","id":835063730,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTA2MzczMA==","user":{"login":"tandonraghav","id":10815442,"node_id":"MDQ6VXNlcjEwODE1NDQy","avatar_url":"https://avatars.githubusercontent.com/u/10815442?v=4","gravatar_id":"","url":"https://api.github.com/users/tandonraghav","html_url":"https://github.com/tandonraghav","followers_url":"https://api.github.com/users/tandonraghav/followers","following_url":"https://api.github.com/users/tandonraghav/following{/other_user}","gists_url":"https://api.github.com/users/tandonraghav/gists{/gist_id}","starred_url":"https://api.github.com/users/tandonraghav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tandonraghav/subscriptions","organizations_url":"https://api.github.com/users/tandonraghav/orgs","repos_url":"https://api.github.com/users/tandonraghav/repos","events_url":"https://api.github.com/users/tandonraghav/events{/privacy}","received_events_url":"https://api.github.com/users/tandonraghav/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T03:56:45Z","updated_at":"2021-05-08T03:56:45Z","author_association":"NONE","body":"@vinothchandar @nsivabalan  Can you guys please help here. I am stuck and cant things forward if Schema Evolution is not happening.\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835063730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835134388","html_url":"https://github.com/apache/hudi/pull/2645#issuecomment-835134388","issue_url":"https://api.github.com/repos/apache/hudi/issues/2645","id":835134388,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTEzNDM4OA==","user":{"login":"pengzhiwei2018","id":42458891,"node_id":"MDQ6VXNlcjQyNDU4ODkx","avatar_url":"https://avatars.githubusercontent.com/u/42458891?v=4","gravatar_id":"","url":"https://api.github.com/users/pengzhiwei2018","html_url":"https://github.com/pengzhiwei2018","followers_url":"https://api.github.com/users/pengzhiwei2018/followers","following_url":"https://api.github.com/users/pengzhiwei2018/following{/other_user}","gists_url":"https://api.github.com/users/pengzhiwei2018/gists{/gist_id}","starred_url":"https://api.github.com/users/pengzhiwei2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pengzhiwei2018/subscriptions","organizations_url":"https://api.github.com/users/pengzhiwei2018/orgs","repos_url":"https://api.github.com/users/pengzhiwei2018/repos","events_url":"https://api.github.com/users/pengzhiwei2018/events{/privacy}","received_events_url":"https://api.github.com/users/pengzhiwei2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T06:16:04Z","updated_at":"2021-05-11T02:23:13Z","author_association":"NONE","body":"Hi @vinothchandar @umehrot2 , The PR has updated,  mainly with the follow changes:\r\n- Support atomic for CTAS\r\n- Support use timestamp type as partition field\r\n- Fix exception when partition column is not in the rightest of select list for CTAS.\r\n- Add `TestSqlStatement` which does a sequence of statements. see [sql-statements.sql](https://github.com/apache/hudi/blob/171d607b1adc3972aa2c9e3efce5362368599d00/hudi-spark-datasource/hudi-spark/src/test/resources/sql-statements.sql)\r\n- Add more test case for CTAS & partitioned table.\r\n- Change the `SparkSqlAdpater` to `SparkAdapter`\r\n\r\nFor other issues your have mentioned above, I have filed a JIRA for each.\r\n- Support Truncate Command For Hoodie [1883](https://issues.apache.org/jira/browse/HUDI-1883)\r\n- Support Partial Update For MergeInto [1884](https://issues.apache.org/jira/browse/HUDI-1884)\r\n- Support Delete/Update Non-pk table [1885](https://issues.apache.org/jira/browse/HUDI-1885)\r\n\r\nAfter this first pr has merged, we can continue to solve these JIRAs.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835134388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835164772","html_url":"https://github.com/apache/hudi/pull/2925#issuecomment-835164772","issue_url":"https://api.github.com/repos/apache/hudi/issues/2925","id":835164772,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTE2NDc3Mg==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T07:15:25Z","updated_at":"2021-06-09T03:46:43Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2925?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2925](https://codecov.io/gh/apache/hudi/pull/2925?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (421012c) into [master](https://codecov.io/gh/apache/hudi/commit/f760ec543ec9ea23b7d4c9f61c76a283bd737f27?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (f760ec5) will **increase** coverage by `0.04%`.\n> The diff coverage is `95.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2925/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2925?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2925      +/-   ##\n============================================\n+ Coverage     55.31%   55.36%   +0.04%     \n- Complexity     4026     4028       +2     \n============================================\n  Files           520      520              \n  Lines         25295    25307      +12     \n  Branches       2872     2875       +3     \n============================================\n+ Hits          13993    14011      +18     \n+ Misses         9914     9908       -6     \n  Partials       1388     1388              \n```\n\n| Flag | Coverage Δ | |\n|---|---|---|\n| hudicli | `39.95% <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | |\n| hudicommon | `49.97% <ø> (ø)` | |\n| hudiflink | `62.98% <ø> (+0.14%)` | :arrow_up: |\n| hudihadoopmr | `51.43% <ø> (ø)` | |\n| hudisparkdatasource | `66.56% <100.00%> (+0.04%)` | :arrow_up: |\n| hudisync | `51.73% <92.85%> (+0.27%)` | :arrow_up: |\n| huditimelineservice | `64.36% <ø> (ø)` | |\n| hudiutilities | `71.11% <ø> (+0.04%)` | :arrow_up: |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2925?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | |\n|---|---|---|\n| [...in/java/org/apache/hudi/hive/util/ConfigUtils.java](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvdXRpbC9Db25maWdVdGlscy5qYXZh) | `73.91% <ø> (ø)` | |\n| [...c/main/java/org/apache/hudi/hive/HiveSyncTool.java](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvSGl2ZVN5bmNUb29sLmphdmE=) | `69.10% <92.85%> (+1.56%)` | :arrow_up: |\n| [...n/scala/org/apache/hudi/HoodieSparkSqlWriter.scala](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrU3FsV3JpdGVyLnNjYWxh) | `70.65% <100.00%> (+0.42%)` | :arrow_up: |\n| [...va/org/apache/hudi/configuration/FlinkOptions.java](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9jb25maWd1cmF0aW9uL0ZsaW5rT3B0aW9ucy5qYXZh) | `91.64% <0.00%> (-0.14%)` | :arrow_down: |\n| [.../org/apache/hudi/streamer/FlinkStreamerConfig.java](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zdHJlYW1lci9GbGlua1N0cmVhbWVyQ29uZmlnLmphdmE=) | `0.00% <0.00%> (ø)` | |\n| [...in/java/org/apache/hudi/hive/HoodieHiveClient.java](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvSG9vZGllSGl2ZUNsaWVudC5qYXZh) | `71.60% <0.00%> (ø)` | |\n| [...e/hudi/sink/transform/RowDataToHoodieFunction.java](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3RyYW5zZm9ybS9Sb3dEYXRhVG9Ib29kaWVGdW5jdGlvbi5qYXZh) | `100.00% <0.00%> (ø)` | |\n| [...main/scala/org/apache/hudi/HoodieWriterUtils.scala](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVdyaXRlclV0aWxzLnNjYWxh) | `83.33% <0.00%> (ø)` | |\n| [...i/bootstrap/SparkParquetBootstrapDataProvider.java](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvYm9vdHN0cmFwL1NwYXJrUGFycXVldEJvb3RzdHJhcERhdGFQcm92aWRlci5qYXZh) | `80.00% <0.00%> (ø)` | |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.18% <0.00%> (+0.33%)` | :arrow_up: |\n| ... and [1 more](https://codecov.io/gh/apache/hudi/pull/2925/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835164772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835187833","html_url":"https://github.com/apache/hudi/pull/2833#issuecomment-835187833","issue_url":"https://api.github.com/repos/apache/hudi/issues/2833","id":835187833,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTE4NzgzMw==","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T07:55:42Z","updated_at":"2021-05-08T07:55:42Z","author_association":"MEMBER","body":"@zhedoubushishi sure I'll also take a look.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835187833/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835216648","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-835216648","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":835216648,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTIxNjY0OA==","user":{"login":"sathyaprakashg","id":15080820,"node_id":"MDQ6VXNlcjE1MDgwODIw","avatar_url":"https://avatars.githubusercontent.com/u/15080820?v=4","gravatar_id":"","url":"https://api.github.com/users/sathyaprakashg","html_url":"https://github.com/sathyaprakashg","followers_url":"https://api.github.com/users/sathyaprakashg/followers","following_url":"https://api.github.com/users/sathyaprakashg/following{/other_user}","gists_url":"https://api.github.com/users/sathyaprakashg/gists{/gist_id}","starred_url":"https://api.github.com/users/sathyaprakashg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sathyaprakashg/subscriptions","organizations_url":"https://api.github.com/users/sathyaprakashg/orgs","repos_url":"https://api.github.com/users/sathyaprakashg/repos","events_url":"https://api.github.com/users/sathyaprakashg/events{/privacy}","received_events_url":"https://api.github.com/users/sathyaprakashg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T08:45:04Z","updated_at":"2021-05-08T08:45:04Z","author_association":"CONTRIBUTOR","body":"> @sathyaprakashg and others: trying to understand the use-case here. I understand its related to deltastreamer receiving events in old schema after Hudi's dataset schema got evolved. what's the schema from schema provider when source is producing events in old schema (after schema got evolved w/ hudi dataset)? if the schema provider's schema is updated, I guess there is no need to store the writer schema w/ payload.\r\n> AvroConversionUtils.createDataFrame() will ensure to convert the JavaRDD w/ old schema to Dataset w/ new schema if schemaProvider.SourceSchema() has the evolved schema.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835216648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835222588","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-835222588","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":835222588,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTIyMjU4OA==","user":{"login":"sathyaprakashg","id":15080820,"node_id":"MDQ6VXNlcjE1MDgwODIw","avatar_url":"https://avatars.githubusercontent.com/u/15080820?v=4","gravatar_id":"","url":"https://api.github.com/users/sathyaprakashg","html_url":"https://github.com/sathyaprakashg","followers_url":"https://api.github.com/users/sathyaprakashg/followers","following_url":"https://api.github.com/users/sathyaprakashg/following{/other_user}","gists_url":"https://api.github.com/users/sathyaprakashg/gists{/gist_id}","starred_url":"https://api.github.com/users/sathyaprakashg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sathyaprakashg/subscriptions","organizations_url":"https://api.github.com/users/sathyaprakashg/orgs","repos_url":"https://api.github.com/users/sathyaprakashg/repos","events_url":"https://api.github.com/users/sathyaprakashg/events{/privacy}","received_events_url":"https://api.github.com/users/sathyaprakashg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T08:55:37Z","updated_at":"2021-05-08T08:58:00Z","author_association":"CONTRIBUTOR","body":"> > @sathyaprakashg and others: trying to understand the use-case here. I understand its related to deltastreamer receiving events in old schema after Hudi's dataset schema got evolved. what's the schema from schema provider when source is producing events in old schema (after schema got evolved w/ hudi dataset)? if the schema provider's schema is updated, I guess there is no need to store the writer schema w/ payload.\r\n> > AvroConversionUtils.createDataFrame() will ensure to convert the JavaRDD w/ old schema to Dataset w/ new schema if schemaProvider.SourceSchema() has the evolved schema.\r\n\r\nIssue with schema evoluation happens in `HoodieAvroUtils.avroToBytes` and `HoodieAvroUtils.bytesToAvro`. Let us consider a scenario where there are two versions of schema in schema regsitry and in the 2nd (latest) version, there is a new field added. But data is stilling coming with schema version 1. \r\n\r\n`HoodieAvroUtils.avroToBytes` uses schema part of data (i.e v1 schema) to convert avro to bytes. `HoodieAvroUtils.bytesToAvro` uses the latest schema  (v2)  from schema registryto convert the bytes to avro. This will fail because v1 schema was used to convert to bytes, but v2 schema is being used to convert bytes back to avro. \r\n\r\nIn order to solve this, we need both v1 (writer schema) and v2 (reader schema) to convert bytes back to avro. We can get v2 schema from schema registry, but to get v1 schema, we were trying to store the writer schema part of the payload itself.\r\n\r\nPlease let me know if it is still not very clear","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835222588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835303925","html_url":"https://github.com/apache/hudi/pull/2926#issuecomment-835303925","issue_url":"https://api.github.com/repos/apache/hudi/issues/2926","id":835303925,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTMwMzkyNQ==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T11:16:33Z","updated_at":"2021-05-26T04:04:55Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2926?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2926](https://codecov.io/gh/apache/hudi/pull/2926?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (edf6c6b) into [master](https://codecov.io/gh/apache/hudi/commit/a5789c40673b36d40adab696706acc1446a286f8?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (a5789c4) will **increase** coverage by `2.10%`.\n> The diff coverage is `95.00%`.\n\n> :exclamation: Current head edf6c6b differs from pull request most recent head c4b07cb. Consider uploading reports for the commit c4b07cb to get more accurate results\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2926/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2926?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2926      +/-   ##\n============================================\n+ Coverage     53.00%   55.11%   +2.10%     \n- Complexity     3743     3845     +102     \n============================================\n  Files           488      485       -3     \n  Lines         23435    23512      +77     \n  Branches       2500     2519      +19     \n============================================\n+ Hits          12422    12958     +536     \n+ Misses         9913     9400     -513     \n- Partials       1100     1154      +54     \n```\n\n| Flag | Coverage Δ | |\n|---|---|---|\n| hudicli | `39.55% <ø> (+0.01%)` | :arrow_up: |\n| hudiclient | `∅ <ø> (∅)` | |\n| hudicommon | `50.31% <ø> (-0.35%)` | :arrow_down: |\n| hudiflink | `63.40% <ø> (+4.28%)` | :arrow_up: |\n| hudihadoopmr | `51.54% <ø> (+18.21%)` | :arrow_up: |\n| hudisparkdatasource | `74.30% <95.00%> (+0.96%)` | :arrow_up: |\n| hudisync | `46.44% <ø> (+0.33%)` | :arrow_up: |\n| huditimelineservice | `64.36% <ø> (ø)` | |\n| hudiutilities | `70.88% <ø> (+1.19%)` | :arrow_up: |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2926?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | |\n|---|---|---|\n| [.../org/apache/hudi/MergeOnReadSnapshotRelation.scala](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL01lcmdlT25SZWFkU25hcHNob3RSZWxhdGlvbi5zY2FsYQ==) | `89.62% <88.88%> (-0.38%)` | :arrow_down: |\n| [.../main/scala/org/apache/hudi/HoodieSparkUtils.scala](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrVXRpbHMuc2NhbGE=) | `91.57% <95.38%> (+8.24%)` | :arrow_up: |\n| [...c/main/scala/org/apache/hudi/HoodieFileIndex.scala](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZUZpbGVJbmRleC5zY2FsYQ==) | `81.01% <100.00%> (+1.92%)` | :arrow_up: |\n| [.../main/java/org/apache/hudi/util/AvroConvertor.java](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS91dGlsL0F2cm9Db252ZXJ0b3IuamF2YQ==) | `0.00% <0.00%> (-82.36%)` | :arrow_down: |\n| [.../hudi/table/format/mor/MergeOnReadInputFormat.java](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9mb3JtYXQvbW9yL01lcmdlT25SZWFkSW5wdXRGb3JtYXQuamF2YQ==) | `65.14% <0.00%> (-9.86%)` | :arrow_down: |\n| [...he/hudi/common/bootstrap/index/BootstrapIndex.java](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2Jvb3RzdHJhcC9pbmRleC9Cb290c3RyYXBJbmRleC5qYXZh) | `94.11% <0.00%> (-5.89%)` | :arrow_down: |\n| [...he/hudi/sink/partitioner/BucketAssignFunction.java](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL0J1Y2tldEFzc2lnbkZ1bmN0aW9uLmphdmE=) | `77.88% <0.00%> (-5.84%)` | :arrow_down: |\n| [...va/org/apache/hudi/sink/utils/HiveSyncContext.java](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3V0aWxzL0hpdmVTeW5jQ29udGV4dC5qYXZh) | `91.89% <0.00%> (-5.26%)` | :arrow_down: |\n| [...common/table/log/HoodieMergedLogRecordScanner.java](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVNZXJnZWRMb2dSZWNvcmRTY2FubmVyLmphdmE=) | `82.35% <0.00%> (-5.15%)` | :arrow_down: |\n| [.../java/org/apache/hudi/table/HoodieTableSource.java](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9Ib29kaWVUYWJsZVNvdXJjZS5qYXZh) | `58.60% <0.00%> (-4.77%)` | :arrow_down: |\n| ... and [65 more](https://codecov.io/gh/apache/hudi/pull/2926/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835303925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835403599","html_url":"https://github.com/apache/hudi/pull/2918#issuecomment-835403599","issue_url":"https://api.github.com/repos/apache/hudi/issues/2918","id":835403599,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTQwMzU5OQ==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T15:31:31Z","updated_at":"2021-05-08T15:31:31Z","author_association":"CONTRIBUTOR","body":"@satishkotha hello , have some doubt\r\n1. Just see add a test strategy . Will a formal strategy be added later？\r\n2. This PR is to support which Index?\r\n3. If every file group just transfrom to a same name file group. If the small files  can not merge ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835403599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835405054","html_url":"https://github.com/apache/hudi/pull/2776#issuecomment-835405054","issue_url":"https://api.github.com/repos/apache/hudi/issues/2776","id":835405054,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTQwNTA1NA==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T15:36:47Z","updated_at":"2021-05-08T15:36:47Z","author_association":"CONTRIBUTOR","body":"@nsivabalan Can you help to review ? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835405054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835429596","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-835429596","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":835429596,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTQyOTU5Ng==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T17:00:02Z","updated_at":"2021-05-08T17:00:33Z","author_association":"CONTRIBUTOR","body":"yes, thanks for clarifying. I guess, embedding schema in every payload might be detrimental as you have experienced. So, have thought of a diff approach to regenerate records w/ new schema at spark datasource layer. Only the batch that is getting ingested w/ old schema after table's schema got evolved will take a hit with this conversion. \r\n\r\nhttps://github.com/apache/hudi/pull/2927\r\n\r\nAlso, as I have mentioned earlier, if others (@n3nash , @bvaradar ) confirm that schema post processor is not required as a mandatory step with this [fix](https://github.com/apache/hudi/pull/2765) for default vals, we don't need any changes in delta streamer as such, just https://github.com/apache/hudi/pull/2927 would suffice. \r\n\r\n@n3nash is doing more testing around this as well. So, will wait for him to comment on the patch as well. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835429596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835430045","html_url":"https://github.com/apache/hudi/pull/2927#issuecomment-835430045","issue_url":"https://api.github.com/repos/apache/hudi/issues/2927","id":835430045,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTQzMDA0NQ==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T17:01:45Z","updated_at":"2021-06-11T01:00:56Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2927?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2927](https://codecov.io/gh/apache/hudi/pull/2927?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (2667501) into [master](https://codecov.io/gh/apache/hudi/commit/9e4114dd46cda4db23a24889cd267998734202da?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (9e4114d) will **increase** coverage by `0.04%`.\n> The diff coverage is `68.91%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2927/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2927?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2927      +/-   ##\n============================================\n+ Coverage     55.35%   55.39%   +0.04%     \n- Complexity     4027     4038      +11     \n============================================\n  Files           521      521              \n  Lines         25311    25367      +56     \n  Branches       2873     2884      +11     \n============================================\n+ Hits          14010    14053      +43     \n- Misses         9911     9926      +15     \n+ Partials       1390     1388       -2     \n```\n\n| Flag | Coverage Δ | |\n|---|---|---|\n| hudicli | `39.95% <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | |\n| hudicommon | `49.95% <0.00%> (-0.03%)` | :arrow_down: |\n| hudiflink | `63.03% <ø> (ø)` | |\n| hudihadoopmr | `51.43% <ø> (ø)` | |\n| hudisparkdatasource | `66.64% <92.59%> (+0.12%)` | :arrow_up: |\n| hudisync | `51.45% <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | |\n| hudiutilities | `71.25% <83.87%> (+0.29%)` | :arrow_up: |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2927?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | |\n|---|---|---|\n| [...c/main/java/org/apache/hudi/common/fs/FSUtils.java](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL0ZTVXRpbHMuamF2YQ==) | `46.85% <0.00%> (-0.23%)` | :arrow_down: |\n| [...pache/hudi/common/table/HoodieTableMetaClient.java](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL0hvb2RpZVRhYmxlTWV0YUNsaWVudC5qYXZh) | `63.63% <0.00%> (-0.25%)` | :arrow_down: |\n| [.../apache/hudi/common/table/TableSchemaResolver.java](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL1RhYmxlU2NoZW1hUmVzb2x2ZXIuamF2YQ==) | `0.00% <0.00%> (ø)` | |\n| [...in/java/org/apache/hudi/utilities/UtilHelpers.java](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL1V0aWxIZWxwZXJzLmphdmE=) | `65.77% <73.33%> (+1.24%)` | :arrow_up: |\n| [...i/utilities/deltastreamer/HoodieDeltaStreamer.java](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvSG9vZGllRGVsdGFTdHJlYW1lci5qYXZh) | `72.76% <85.71%> (+0.32%)` | :arrow_up: |\n| [.../main/scala/org/apache/hudi/HoodieSparkUtils.scala](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrVXRpbHMuc2NhbGE=) | `84.37% <88.88%> (+0.10%)` | :arrow_up: |\n| [...n/scala/org/apache/hudi/HoodieSparkSqlWriter.scala](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrU3FsV3JpdGVyLnNjYWxh) | `70.86% <93.33%> (+0.63%)` | :arrow_up: |\n| [...i/bootstrap/SparkParquetBootstrapDataProvider.java](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvYm9vdHN0cmFwL1NwYXJrUGFycXVldEJvb3RzdHJhcERhdGFQcm92aWRlci5qYXZh) | `80.00% <100.00%> (ø)` | |\n| [...main/scala/org/apache/hudi/HoodieWriterUtils.scala](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVdyaXRlclV0aWxzLnNjYWxh) | `83.67% <100.00%> (+0.34%)` | :arrow_up: |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.81% <100.00%> (+1.30%)` | :arrow_up: |\n| ... and [6 more](https://codecov.io/gh/apache/hudi/pull/2927/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835430045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835486764","html_url":"https://github.com/apache/hudi/pull/2012#issuecomment-835486764","issue_url":"https://api.github.com/repos/apache/hudi/issues/2012","id":835486764,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTQ4Njc2NA==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T19:43:52Z","updated_at":"2021-05-08T19:45:24Z","author_association":"CONTRIBUTOR","body":"At a high level, my understanding is there are 3 issues\r\n\r\n1. Removing namespace could cause backwards compatibility -> Validated with [this](https://github.com/apache/hudi/pull/2928) PR that it should be OK to make this change. \r\n2. Records with older schema received without a user defined schema. This breaks the `getInsertRecord` API since the writer schema is smaller than the reader schema and bytes to generic record conversion breaks, addressed by @nsivabalan [diff](https://github.com/apache/hudi/pull/2927)\r\n3. For general schema evolution to work when converting from DataFrame to Avro, we need to ensure that new elements added in the schema have a default value \"null\" using the UNION type as follows `name: a, type [\"null\", <type>]`. Spark's internal converter breaks the Avro spec of creating a UNION by reversing the order of null as follows `name: a, type [<type>, \"null\"]` , @nsivabalan fixed this with [this](https://github.com/apache/hudi/pull/2911) PR by relying on Hudi's internal ConversionHelper to ensure that \"null\" is appended first. Also, [this](https://github.com/apache/hudi/pull/2765) PR addressed some other issues as well. \r\n\r\nWith all of these 3 fixes, we should be able to land this PR. @sathyaprakashg Let us know if there were any other concerns that you came across. \r\n\r\n@nsivabalan I can confirm that (3) should be good to land. I've approved the diff and @bvaradar will be taking a look at this later today, once he confirms, we can land both (3) and then (2) with the assumption that (1) validates both. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835486764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835557307","html_url":"https://github.com/apache/hudi/pull/2809#issuecomment-835557307","issue_url":"https://api.github.com/repos/apache/hudi/issues/2809","id":835557307,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTU1NzMwNw==","user":{"login":"jsbali","id":1778470,"node_id":"MDQ6VXNlcjE3Nzg0NzA=","avatar_url":"https://avatars.githubusercontent.com/u/1778470?v=4","gravatar_id":"","url":"https://api.github.com/users/jsbali","html_url":"https://github.com/jsbali","followers_url":"https://api.github.com/users/jsbali/followers","following_url":"https://api.github.com/users/jsbali/following{/other_user}","gists_url":"https://api.github.com/users/jsbali/gists{/gist_id}","starred_url":"https://api.github.com/users/jsbali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsbali/subscriptions","organizations_url":"https://api.github.com/users/jsbali/orgs","repos_url":"https://api.github.com/users/jsbali/repos","events_url":"https://api.github.com/users/jsbali/events{/privacy}","received_events_url":"https://api.github.com/users/jsbali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-08T22:52:51Z","updated_at":"2021-05-08T22:52:51Z","author_association":"CONTRIBUTOR","body":"Yay it's green ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835557307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835640212","html_url":"https://github.com/apache/hudi/pull/2929#issuecomment-835640212","issue_url":"https://api.github.com/repos/apache/hudi/issues/2929","id":835640212,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTY0MDIxMg==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T02:37:49Z","updated_at":"2021-05-09T09:47:26Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2929?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2929](https://codecov.io/gh/apache/hudi/pull/2929?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (5cdff47) into [master](https://codecov.io/gh/apache/hudi/commit/bfbf993cbe3f1e3fab93095f4342ed17423efab5?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (bfbf993) will **decrease** coverage by `0.00%`.\n> The diff coverage is `46.15%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2929/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2929?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2929      +/-   ##\n============================================\n- Coverage     54.77%   54.76%   -0.01%     \n- Complexity     3796     3798       +2     \n============================================\n  Files           481      481              \n  Lines         23284    23291       +7     \n  Branches       2478     2480       +2     \n============================================\n+ Hits          12753    12756       +3     \n- Misses         9385     9386       +1     \n- Partials       1146     1149       +3     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `39.53% <ø> (ø)` | `220.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.41% <ø> (+0.02%)` | `1976.00 <ø> (+1.00)` | |\n| hudiflink | `62.88% <46.15%> (-0.13%)` | `525.00 <4.00> (+1.00)` | :arrow_down: |\n| hudihadoopmr | `50.93% <ø> (ø)` | `259.00 <ø> (ø)` | |\n| hudisparkdatasource | `73.33% <ø> (ø)` | `237.00 <ø> (ø)` | |\n| hudisync | `46.52% <ø> (ø)` | `144.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `62.00 <ø> (ø)` | |\n| hudiutilities | `69.58% <ø> (ø)` | `375.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2929?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...c/main/java/org/apache/hudi/util/StreamerUtil.java](https://codecov.io/gh/apache/hudi/pull/2929/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS91dGlsL1N0cmVhbWVyVXRpbC5qYXZh) | `53.65% <0.00%> (-1.35%)` | `17.00 <1.00> (+1.00)` | :arrow_down: |\n| [...java/org/apache/hudi/sink/StreamWriteFunction.java](https://codecov.io/gh/apache/hudi/pull/2929/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlRnVuY3Rpb24uamF2YQ==) | `78.98% <60.00%> (-2.07%)` | `23.00 <3.00> (ø)` | |\n| [...ache/hudi/common/fs/inline/InMemoryFileSystem.java](https://codecov.io/gh/apache/hudi/pull/2929/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL2lubGluZS9Jbk1lbW9yeUZpbGVTeXN0ZW0uamF2YQ==) | `89.65% <0.00%> (+10.34%)` | `16.00% <0.00%> (+1.00%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835640212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835670270","html_url":"https://github.com/apache/hudi/pull/2930#issuecomment-835670270","issue_url":"https://api.github.com/repos/apache/hudi/issues/2930","id":835670270,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTY3MDI3MA==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T04:18:14Z","updated_at":"2021-05-10T15:03:28Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2930?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2930](https://codecov.io/gh/apache/hudi/pull/2930?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (aaf35bf) into [master](https://codecov.io/gh/apache/hudi/commit/bfbf993cbe3f1e3fab93095f4342ed17423efab5?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (bfbf993) will **decrease** coverage by `0.01%`.\n> The diff coverage is `100.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2930/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2930?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2930      +/-   ##\n============================================\n- Coverage     54.77%   54.76%   -0.02%     \n- Complexity     3796     3801       +5     \n============================================\n  Files           481      481              \n  Lines         23284    23303      +19     \n  Branches       2478     2482       +4     \n============================================\n+ Hits          12753    12761       +8     \n- Misses         9385     9391       +6     \n- Partials       1146     1151       +5     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `39.53% <ø> (ø)` | `220.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.35% <ø> (-0.04%)` | `1975.00 <ø> (ø)` | |\n| hudiflink | `63.04% <100.00%> (+0.02%)` | `530.00 <6.00> (+6.00)` | |\n| hudihadoopmr | `50.93% <ø> (ø)` | `259.00 <ø> (ø)` | |\n| hudisparkdatasource | `73.33% <ø> (ø)` | `237.00 <ø> (ø)` | |\n| hudisync | `46.52% <ø> (ø)` | `144.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `62.00 <ø> (ø)` | |\n| hudiutilities | `69.53% <ø> (-0.05%)` | `374.00 <ø> (-1.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2930?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...java/org/apache/hudi/table/HoodieTableFactory.java](https://codecov.io/gh/apache/hudi/pull/2930/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9Ib29kaWVUYWJsZUZhY3RvcnkuamF2YQ==) | `91.66% <100.00%> (+1.83%)` | `23.00 <6.00> (+6.00)` | |\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2930/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `76.56% <0.00%> (-3.13%)` | `26.00% <0.00%> (ø%)` | |\n| [...java/org/apache/hudi/sink/StreamWriteFunction.java](https://codecov.io/gh/apache/hudi/pull/2930/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlRnVuY3Rpb24uamF2YQ==) | `78.98% <0.00%> (-2.07%)` | `23.00% <0.00%> (ø%)` | |\n| [...c/main/java/org/apache/hudi/util/StreamerUtil.java](https://codecov.io/gh/apache/hudi/pull/2930/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS91dGlsL1N0cmVhbWVyVXRpbC5qYXZh) | `53.65% <0.00%> (-1.35%)` | `17.00% <0.00%> (+1.00%)` | :arrow_down: |\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2930/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.08% <0.00%> (-0.35%)` | `55.00% <0.00%> (-1.00%)` | |\n| [...va/org/apache/hudi/table/format/FilePathUtils.java](https://codecov.io/gh/apache/hudi/pull/2930/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9mb3JtYXQvRmlsZVBhdGhVdGlscy5qYXZh) | `67.93% <0.00%> (+0.51%)` | `40.00% <0.00%> (-1.00%)` | :arrow_up: |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835670270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835768056","html_url":"https://github.com/apache/hudi/pull/2931#issuecomment-835768056","issue_url":"https://api.github.com/repos/apache/hudi/issues/2931","id":835768056,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNTc2ODA1Ng==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-09T09:45:24Z","updated_at":"2021-05-10T11:10:04Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2931?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2931](https://codecov.io/gh/apache/hudi/pull/2931?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (3131b53) into [master](https://codecov.io/gh/apache/hudi/commit/bfbf993cbe3f1e3fab93095f4342ed17423efab5?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (bfbf993) will **decrease** coverage by `0.01%`.\n> The diff coverage is `66.66%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2931/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2931?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2931      +/-   ##\n============================================\n- Coverage     54.77%   54.75%   -0.02%     \n  Complexity     3796     3796              \n============================================\n  Files           481      481              \n  Lines         23284    23290       +6     \n  Branches       2478     2480       +2     \n============================================\n  Hits          12753    12753              \n- Misses         9385     9388       +3     \n- Partials       1146     1149       +3     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `39.53% <ø> (ø)` | `220.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.38% <ø> (ø)` | `1975.00 <ø> (ø)` | |\n| hudiflink | `62.90% <66.66%> (-0.11%)` | `524.00 <0.00> (ø)` | |\n| hudihadoopmr | `50.93% <ø> (ø)` | `259.00 <ø> (ø)` | |\n| hudisparkdatasource | `73.33% <ø> (ø)` | `237.00 <ø> (ø)` | |\n| hudisync | `46.52% <ø> (ø)` | `144.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `62.00 <ø> (ø)` | |\n| hudiutilities | `69.58% <ø> (ø)` | `375.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2931?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/table/format/FilePathUtils.java](https://codecov.io/gh/apache/hudi/pull/2931/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS90YWJsZS9mb3JtYXQvRmlsZVBhdGhVdGlscy5qYXZh) | `67.93% <66.66%> (+0.51%)` | `40.00 <0.00> (-1.00)` | :arrow_up: |\n| [...java/org/apache/hudi/sink/StreamWriteFunction.java](https://codecov.io/gh/apache/hudi/pull/2931/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL1N0cmVhbVdyaXRlRnVuY3Rpb24uamF2YQ==) | `78.98% <0.00%> (-2.07%)` | `23.00% <0.00%> (ø%)` | |\n| [...c/main/java/org/apache/hudi/util/StreamerUtil.java](https://codecov.io/gh/apache/hudi/pull/2931/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS91dGlsL1N0cmVhbWVyVXRpbC5qYXZh) | `53.65% <0.00%> (-1.35%)` | `17.00% <0.00%> (+1.00%)` | :arrow_down: |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/835768056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/836220443","html_url":"https://github.com/apache/hudi/issues/2802#issuecomment-836220443","issue_url":"https://api.github.com/repos/apache/hudi/issues/2802","id":836220443,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjIyMDQ0Mw==","user":{"login":"aditiwari01","id":16352977,"node_id":"MDQ6VXNlcjE2MzUyOTc3","avatar_url":"https://avatars.githubusercontent.com/u/16352977?v=4","gravatar_id":"","url":"https://api.github.com/users/aditiwari01","html_url":"https://github.com/aditiwari01","followers_url":"https://api.github.com/users/aditiwari01/followers","following_url":"https://api.github.com/users/aditiwari01/following{/other_user}","gists_url":"https://api.github.com/users/aditiwari01/gists{/gist_id}","starred_url":"https://api.github.com/users/aditiwari01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aditiwari01/subscriptions","organizations_url":"https://api.github.com/users/aditiwari01/orgs","repos_url":"https://api.github.com/users/aditiwari01/repos","events_url":"https://api.github.com/users/aditiwari01/events{/privacy}","received_events_url":"https://api.github.com/users/aditiwari01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T06:00:58Z","updated_at":"2021-05-10T06:00:58Z","author_association":"CONTRIBUTOR","body":"@n3nash Did you get a chance to look at this?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/836220443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/836676096","html_url":"https://github.com/apache/hudi/pull/2933#issuecomment-836676096","issue_url":"https://api.github.com/repos/apache/hudi/issues/2933","id":836676096,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjY3NjA5Ng==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T13:06:08Z","updated_at":"2021-05-10T13:52:31Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2933?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2933](https://codecov.io/gh/apache/hudi/pull/2933?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (66379e3) into [master](https://codecov.io/gh/apache/hudi/commit/c1b331bcffaffde7661b75a9b846b117e9df63dc?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (c1b331b) will **increase** coverage by `0.67%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2933/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2933?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2933      +/-   ##\n============================================\n+ Coverage     54.07%   54.75%   +0.67%     \n- Complexity     3757     3797      +40     \n============================================\n  Files           481      481              \n  Lines         23291    23291              \n  Branches       2480     2480              \n============================================\n+ Hits          12595    12753     +158     \n+ Misses         9556     9389     -167     \n- Partials       1140     1149       +9     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `39.53% <ø> (ø)` | `220.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.38% <ø> (ø)` | `1975.00 <ø> (ø)` | |\n| hudiflink | `62.88% <ø> (ø)` | `525.00 <ø> (ø)` | |\n| hudihadoopmr | `50.93% <ø> (ø)` | `259.00 <ø> (ø)` | |\n| hudisparkdatasource | `73.33% <ø> (ø)` | `237.00 <ø> (ø)` | |\n| hudisync | `46.52% <ø> (ø)` | `144.00 <ø> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `62.00 <ø> (ø)` | |\n| hudiutilities | `69.58% <ø> (+7.89%)` | `375.00 <ø> (+40.00)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2933?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...apache/hudi/utilities/deltastreamer/DeltaSync.java](https://codecov.io/gh/apache/hudi/pull/2933/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2RlbHRhc3RyZWFtZXIvRGVsdGFTeW5jLmphdmE=) | `71.42% <0.00%> (+0.34%)` | `56.00% <0.00%> (+1.00%)` | |\n| [...in/java/org/apache/hudi/utilities/UtilHelpers.java](https://codecov.io/gh/apache/hudi/pull/2933/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL1V0aWxIZWxwZXJzLmphdmE=) | `64.53% <0.00%> (+23.83%)` | `33.00% <0.00%> (+6.00%)` | |\n| [...he/hudi/utilities/transform/AWSDmsTransformer.java](https://codecov.io/gh/apache/hudi/pull/2933/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3RyYW5zZm9ybS9BV1NEbXNUcmFuc2Zvcm1lci5qYXZh) | `66.66% <0.00%> (+66.66%)` | `2.00% <0.00%> (+2.00%)` | |\n| [...hudi/utilities/schema/JdbcbasedSchemaProvider.java](https://codecov.io/gh/apache/hudi/pull/2933/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9KZGJjYmFzZWRTY2hlbWFQcm92aWRlci5qYXZh) | `72.22% <0.00%> (+72.22%)` | `2.00% <0.00%> (+2.00%)` | |\n| [.../apache/hudi/utilities/HoodieSnapshotExporter.java](https://codecov.io/gh/apache/hudi/pull/2933/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0hvb2RpZVNuYXBzaG90RXhwb3J0ZXIuamF2YQ==) | `88.79% <0.00%> (+83.62%)` | `28.00% <0.00%> (+28.00%)` | |\n| [...ies/exception/HoodieSnapshotExporterException.java](https://codecov.io/gh/apache/hudi/pull/2933/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL2V4Y2VwdGlvbi9Ib29kaWVTbmFwc2hvdEV4cG9ydGVyRXhjZXB0aW9uLmphdmE=) | `100.00% <0.00%> (+100.00%)` | `1.00% <0.00%> (+1.00%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/836676096/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/836704935","html_url":"https://github.com/apache/hudi/issues/2913#issuecomment-836704935","issue_url":"https://api.github.com/repos/apache/hudi/issues/2913","id":836704935,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNjcwNDkzNQ==","user":{"login":"Akshay2Agarwal","id":11676397,"node_id":"MDQ6VXNlcjExNjc2Mzk3","avatar_url":"https://avatars.githubusercontent.com/u/11676397?v=4","gravatar_id":"","url":"https://api.github.com/users/Akshay2Agarwal","html_url":"https://github.com/Akshay2Agarwal","followers_url":"https://api.github.com/users/Akshay2Agarwal/followers","following_url":"https://api.github.com/users/Akshay2Agarwal/following{/other_user}","gists_url":"https://api.github.com/users/Akshay2Agarwal/gists{/gist_id}","starred_url":"https://api.github.com/users/Akshay2Agarwal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Akshay2Agarwal/subscriptions","organizations_url":"https://api.github.com/users/Akshay2Agarwal/orgs","repos_url":"https://api.github.com/users/Akshay2Agarwal/repos","events_url":"https://api.github.com/users/Akshay2Agarwal/events{/privacy}","received_events_url":"https://api.github.com/users/Akshay2Agarwal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T13:32:36Z","updated_at":"2021-05-10T13:32:36Z","author_association":"NONE","body":"Closing the ticket, as I read through the code, I realized hudi is integrated with hive2 and queryable in presto as an external table and not as managed table.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/836704935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837229546","html_url":"https://github.com/apache/hudi/issues/2123#issuecomment-837229546","issue_url":"https://api.github.com/repos/apache/hudi/issues/2123","id":837229546,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzIyOTU0Ng==","user":{"login":"l-jhon","id":27521093,"node_id":"MDQ6VXNlcjI3NTIxMDkz","avatar_url":"https://avatars.githubusercontent.com/u/27521093?v=4","gravatar_id":"","url":"https://api.github.com/users/l-jhon","html_url":"https://github.com/l-jhon","followers_url":"https://api.github.com/users/l-jhon/followers","following_url":"https://api.github.com/users/l-jhon/following{/other_user}","gists_url":"https://api.github.com/users/l-jhon/gists{/gist_id}","starred_url":"https://api.github.com/users/l-jhon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l-jhon/subscriptions","organizations_url":"https://api.github.com/users/l-jhon/orgs","repos_url":"https://api.github.com/users/l-jhon/repos","events_url":"https://api.github.com/users/l-jhon/events{/privacy}","received_events_url":"https://api.github.com/users/l-jhon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T19:49:25Z","updated_at":"2021-05-10T19:52:21Z","author_association":"NONE","body":"@jackye1995 Is it necessary to change something to make it work? Because I still have a problem.\r\n\r\nMy code:\r\n\r\n`spark = SparkSession \\`\r\n    `.builder \\`\r\n    `.appName(\"data_ingestion_incremental_dev\") \\`\r\n    `.config(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\") \\`\r\n    `.config(\"spark.sql.hive.convertMetastoreParquet\", \"false\") \\`\r\n    `.config(\"spark.sql.session.timeZone\", \"America/Sao_Paulo\") \\`\r\n    `.config(\"spark.hadoop.mapred.output.committer.class\",\"com.appsflyer.spark.DirectOutputCommitter\") \\`\r\n    `.config(\"mapreduce.fileoutputcommitter.marksuccessfuljobs\", \"false\") \\`\r\n    `.config(\"spark.dynamicAllocation.enabled\", \"true\") \\`\r\n    `.enableHiveSupport() \\`\r\n    `.getOrCreate()`\r\n\r\n`table.write \\`\r\n    `.format(\"org.apache.hudi\") \\`\r\n    `.option(\"hoodie.table.name\", f\"{data_source}_{table_name}\") \\`\r\n    `.option(\"hoodie.datasource.write.table.type\", \"COPY_ON_WRITE\") \\`\r\n    `.option(\"hoodie.datasource.write.operation\", \"INSERT\") \\`\r\n    `.option(\"hoodie.datasource.write.recordkey.field\", pk_column) \\`\r\n    `.option(\"hoodie.datasource.write.precombine.field\", incremental_column) \\`\r\n    `.option(\"hoodie.datasource.write.keygenerator.class\", \"org.apache.hudi.keygen.CustomKeyGenerator\") \\`\r\n    `.option(\"hoodie.datasource.write.partitionpath.field\", \"year:SIMPLE, month:SIMPLE, day:SIMPLE\") \\`\r\n    `.option(\"hoodie.datasource.hive_sync.enable\", True) \\`\r\n    `.option(\"hoodie.datasource.hive_sync.support_timestamp\", True) \\`\r\n    `.option(\"hoodie.datasource.hive_sync.database\", database_athena) \\`\r\n    `.option(\"hoodie.datasource.hive_sync.table\", f\"{data_source}_{table_name}\") \\`\r\n    `.option(\"hoodie.datasource.hive_sync.partition_fields\", \"year, month, day\") \\`\r\n    `.option(\"hoodie.datasource.hive_sync.partition_extractor_class\", \"org.apache.hudi.hive.MultiPartKeysValueExtractor\") \\`\r\n    `.option(\"hoodie.consistency.check.enabled\", True) \\`\r\n    `.option(\"hoodie.parquet.max.file.size\", 1073741824) \\`\r\n    `.option(\"hoodie.parquet.small.file.limit\", 629145600) \\`\r\n    `.option(\"hoodie.parquet.compression.codec\", \"snappy\") \\`\r\n    `.option(\"hoodie.copyonwrite.insert.split.size\", 500000) \\`\r\n    `.option(\"hoodie.copyonwrite.record.size.estimate\", 1024) \\`\r\n    `.mode(\"overwrite\") \\`\r\n    `.save(path_s3)`","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837229546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837234410","html_url":"https://github.com/apache/hudi/issues/2123#issuecomment-837234410","issue_url":"https://api.github.com/repos/apache/hudi/issues/2123","id":837234410,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzIzNDQxMA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T19:52:44Z","updated_at":"2021-05-10T19:52:57Z","author_association":"NONE","body":"@l-jhon could you provide more details on what your problem is? What is the table you create in Athena/Glue, and what query did you run?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837234410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837242269","html_url":"https://github.com/apache/hudi/issues/2123#issuecomment-837242269","issue_url":"https://api.github.com/repos/apache/hudi/issues/2123","id":837242269,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzI0MjI2OQ==","user":{"login":"l-jhon","id":27521093,"node_id":"MDQ6VXNlcjI3NTIxMDkz","avatar_url":"https://avatars.githubusercontent.com/u/27521093?v=4","gravatar_id":"","url":"https://api.github.com/users/l-jhon","html_url":"https://github.com/l-jhon","followers_url":"https://api.github.com/users/l-jhon/followers","following_url":"https://api.github.com/users/l-jhon/following{/other_user}","gists_url":"https://api.github.com/users/l-jhon/gists{/gist_id}","starred_url":"https://api.github.com/users/l-jhon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l-jhon/subscriptions","organizations_url":"https://api.github.com/users/l-jhon/orgs","repos_url":"https://api.github.com/users/l-jhon/repos","events_url":"https://api.github.com/users/l-jhon/events{/privacy}","received_events_url":"https://api.github.com/users/l-jhon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T19:58:10Z","updated_at":"2021-05-10T19:58:10Z","author_association":"NONE","body":"\r\n\r\n\r\n\r\n> @l-jhon could you provide more details on what your problem is? What is the table you create in Athena/Glue, and what query did you run?\r\n\r\nFor example, the output of Dataframe .show is: 2017-05-09 08:21:35, but output at Athena is +49134-01-07 05:30:00.000","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837242269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837249804","html_url":"https://github.com/apache/hudi/issues/2123#issuecomment-837249804","issue_url":"https://api.github.com/repos/apache/hudi/issues/2123","id":837249804,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzI0OTgwNA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T20:03:26Z","updated_at":"2021-05-10T20:03:26Z","author_association":"NONE","body":"> For example, the output of Dataframe .show is: 2017-05-09 08:21:35, but output at Athena is +49134-01-07 05:30:00.000\r\n\r\nWhat is the schema of the table through `DESCRIBE table`?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837249804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837270834","html_url":"https://github.com/apache/hudi/issues/2123#issuecomment-837270834","issue_url":"https://api.github.com/repos/apache/hudi/issues/2123","id":837270834,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzI3MDgzNA==","user":{"login":"l-jhon","id":27521093,"node_id":"MDQ6VXNlcjI3NTIxMDkz","avatar_url":"https://avatars.githubusercontent.com/u/27521093?v=4","gravatar_id":"","url":"https://api.github.com/users/l-jhon","html_url":"https://github.com/l-jhon","followers_url":"https://api.github.com/users/l-jhon/followers","following_url":"https://api.github.com/users/l-jhon/following{/other_user}","gists_url":"https://api.github.com/users/l-jhon/gists{/gist_id}","starred_url":"https://api.github.com/users/l-jhon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l-jhon/subscriptions","organizations_url":"https://api.github.com/users/l-jhon/orgs","repos_url":"https://api.github.com/users/l-jhon/repos","events_url":"https://api.github.com/users/l-jhon/events{/privacy}","received_events_url":"https://api.github.com/users/l-jhon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T20:17:33Z","updated_at":"2021-05-10T20:18:50Z","author_association":"NONE","body":"> > For example, the output of Dataframe .show is: 2017-05-09 08:21:35, but output at Athena is +49134-01-07 05:30:00.000\r\n> \r\n> What is the schema of the table through `DESCRIBE table`?\r\n\r\nFollows describe:\r\n\r\n`_hoodie_commit_time \tstring`              \r\n`_hoodie_commit_seqno\tstring`              \r\n`_hoodie_record_key  \tstring`              \r\n`_hoodie_partition_path\tstring`              \r\n`_hoodie_file_name   \tstring`              \r\n`origin              \t        string`              \r\n`created_at          \t        timestamp`          \r\n`updated_at          \t        timestamp`           \r\n`id                  \t                string`              \r\n`channel_order_code  \tstring`                           \r\n`purchase_timestamp  \ttimestamp`           \r\n     \r\n`# Partition Information`\r\n`year                \t        string`              \r\n`month               \t        string`              \r\n`day                 \t        string`              ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837270834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837283028","html_url":"https://github.com/apache/hudi/pull/2918#issuecomment-837283028","issue_url":"https://api.github.com/repos/apache/hudi/issues/2918","id":837283028,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzI4MzAyOA==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T20:25:35Z","updated_at":"2021-05-10T20:25:35Z","author_association":"MEMBER","body":"> @satishkotha hello , have some doubt\r\n> \r\n> 1. Just see add a test strategy . Will a formal strategy be added later？\r\n> 2. This PR is to support which Index?\r\n> 3. If every file group just transfrom to a same name file group. If the small files  can not merge ?\r\n\r\n@lw309637554 \r\n1. Yes, the actual strategy can be added easily if we agree on high level change\r\n2. This is to support HBaseIndex, which does not support update for record location\r\n3. yes, you are right. merging strategy cannot be applied to tables that use HBaseIndex. We can still local 'file-level' sorting i.e., sorting records in each data file by specified column so only one block (row group) needs to be read for queries.\r\n\r\nLet me know if you any other questions/comments.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837283028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837447578","html_url":"https://github.com/apache/hudi/pull/2845#issuecomment-837447578","issue_url":"https://api.github.com/repos/apache/hudi/issues/2845","id":837447578,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzQ0NzU3OA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T22:42:14Z","updated_at":"2021-05-10T22:42:14Z","author_association":"MEMBER","body":"@xushiyan @nsivabalan This looks like a reasonable fix, if we can add couple tests and land this. That would be great.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837447578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837449159","html_url":"https://github.com/apache/hudi/pull/2845#issuecomment-837449159","issue_url":"https://api.github.com/repos/apache/hudi/issues/2845","id":837449159,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzQ0OTE1OQ==","user":{"login":"xushiyan","id":2701446,"node_id":"MDQ6VXNlcjI3MDE0NDY=","avatar_url":"https://avatars.githubusercontent.com/u/2701446?v=4","gravatar_id":"","url":"https://api.github.com/users/xushiyan","html_url":"https://github.com/xushiyan","followers_url":"https://api.github.com/users/xushiyan/followers","following_url":"https://api.github.com/users/xushiyan/following{/other_user}","gists_url":"https://api.github.com/users/xushiyan/gists{/gist_id}","starred_url":"https://api.github.com/users/xushiyan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xushiyan/subscriptions","organizations_url":"https://api.github.com/users/xushiyan/orgs","repos_url":"https://api.github.com/users/xushiyan/repos","events_url":"https://api.github.com/users/xushiyan/events{/privacy}","received_events_url":"https://api.github.com/users/xushiyan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T22:44:06Z","updated_at":"2021-05-10T22:44:06Z","author_association":"MEMBER","body":"@vinothchandar sounds good. i'll add some tests in these 2 days","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837449159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837465319","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-837465319","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":837465319,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzQ2NTMxOQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-10T23:01:13Z","updated_at":"2021-05-10T23:01:13Z","author_association":"MEMBER","body":">each write task write out these records buffer (grouping by file group id) using a write client there.\r\n\r\nUnderstood. So each task manager is, sending RPC calls to the timeline server running locally? This is very different from Spark. What's the life cycle of the `write client` in each JVM process? i.e how often do we re-initialize it? (it can't be per record, so wondering) \r\n\r\nI get why you want a singleton now. Let's work together to figure something out. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837465319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837528970","html_url":"https://github.com/apache/hudi/pull/2722#issuecomment-837528970","issue_url":"https://api.github.com/repos/apache/hudi/issues/2722","id":837528970,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzUyODk3MA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T00:07:50Z","updated_at":"2021-05-11T00:07:50Z","author_association":"MEMBER","body":"@xiarixiaoyao Could you please rebase this PR . I tried doing this myself, seems tricky","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837528970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837632064","html_url":"https://github.com/apache/hudi/pull/2911#issuecomment-837632064","issue_url":"https://api.github.com/repos/apache/hudi/issues/2911","id":837632064,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzYzMjA2NA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T01:55:37Z","updated_at":"2021-05-11T01:55:37Z","author_association":"MEMBER","body":"@nsivabalan are n't there any tests affected by this change? Also do we even need this post processor feature anymore? Should can the entire feature instead of just making it not enabled by default?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837632064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837634888","html_url":"https://github.com/apache/hudi/pull/2879#issuecomment-837634888","issue_url":"https://api.github.com/repos/apache/hudi/issues/2879","id":837634888,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzYzNDg4OA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T01:58:45Z","updated_at":"2021-05-11T01:58:45Z","author_association":"MEMBER","body":"@jsbali @satishkotha  do we need #2532  to land for this? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837634888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837638216","html_url":"https://github.com/apache/hudi/pull/2720#issuecomment-837638216","issue_url":"https://api.github.com/repos/apache/hudi/issues/2720","id":837638216,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzYzODIxNg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T02:02:12Z","updated_at":"2021-05-11T02:02:12Z","author_association":"MEMBER","body":"@xiarixiaoyao do you intend to add a UT for this?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837638216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837659380","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-837659380","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":837659380,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzY1OTM4MA==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T02:23:25Z","updated_at":"2021-05-11T02:23:38Z","author_association":"CONTRIBUTOR","body":"> > each write task write out these records buffer (grouping by file group id) using a write client there.\r\n> \r\n> Understood. So each task manager is, sending RPC calls to the timeline server running locally? This is very different from Spark. What's the life cycle of the `write client` in each JVM process? i.e how often do we re-initialize it? (it can't be per record, so wondering)\r\n> \r\n> I get why you want a singleton now. Let's work together to figure something out.\r\n\r\nThe life cycle of the flink `write client` is: it is living until the job ends, we start a write client for each task and we use that client always. In my thoughts, if i request the embedded timeline server with a new instant time, the server should sync itself first, it is more easy for server to keep the freshness than client(i.e each client should figure out how and when to re-initialize the fs view server).","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837659380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837680457","html_url":"https://github.com/apache/hudi/issues/2935#issuecomment-837680457","issue_url":"https://api.github.com/repos/apache/hudi/issues/2935","id":837680457,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzY4MDQ1Nw==","user":{"login":"shenbinglife","id":16119667,"node_id":"MDQ6VXNlcjE2MTE5NjY3","avatar_url":"https://avatars.githubusercontent.com/u/16119667?v=4","gravatar_id":"","url":"https://api.github.com/users/shenbinglife","html_url":"https://github.com/shenbinglife","followers_url":"https://api.github.com/users/shenbinglife/followers","following_url":"https://api.github.com/users/shenbinglife/following{/other_user}","gists_url":"https://api.github.com/users/shenbinglife/gists{/gist_id}","starred_url":"https://api.github.com/users/shenbinglife/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shenbinglife/subscriptions","organizations_url":"https://api.github.com/users/shenbinglife/orgs","repos_url":"https://api.github.com/users/shenbinglife/repos","events_url":"https://api.github.com/users/shenbinglife/events{/privacy}","received_events_url":"https://api.github.com/users/shenbinglife/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T02:43:53Z","updated_at":"2021-05-11T02:43:53Z","author_association":"NONE","body":"I create a issue at https://issues.apache.org/jira/browse/HUDI-1893","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837680457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837684290","html_url":"https://github.com/apache/hudi/issues/2935#issuecomment-837684290","issue_url":"https://api.github.com/repos/apache/hudi/issues/2935","id":837684290,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzY4NDI5MA==","user":{"login":"pengzhiwei2018","id":42458891,"node_id":"MDQ6VXNlcjQyNDU4ODkx","avatar_url":"https://avatars.githubusercontent.com/u/42458891?v=4","gravatar_id":"","url":"https://api.github.com/users/pengzhiwei2018","html_url":"https://github.com/pengzhiwei2018","followers_url":"https://api.github.com/users/pengzhiwei2018/followers","following_url":"https://api.github.com/users/pengzhiwei2018/following{/other_user}","gists_url":"https://api.github.com/users/pengzhiwei2018/gists{/gist_id}","starred_url":"https://api.github.com/users/pengzhiwei2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pengzhiwei2018/subscriptions","organizations_url":"https://api.github.com/users/pengzhiwei2018/orgs","repos_url":"https://api.github.com/users/pengzhiwei2018/repos","events_url":"https://api.github.com/users/pengzhiwei2018/events{/privacy}","received_events_url":"https://api.github.com/users/pengzhiwei2018/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T02:47:45Z","updated_at":"2021-05-11T02:48:10Z","author_association":"NONE","body":"Hi @shenbinglife , Thanks for your feedback on this question. We have noticed this issue and after https://github.com/apache/hudi/pull/2893 merged, this will be solved. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837684290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837732845","html_url":"https://github.com/apache/hudi/pull/2722#issuecomment-837732845","issue_url":"https://api.github.com/repos/apache/hudi/issues/2722","id":837732845,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzczMjg0NQ==","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T03:35:51Z","updated_at":"2021-05-11T03:35:51Z","author_association":"CONTRIBUTOR","body":"@vinothchandar  i will  rebase this pr, thanks ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837732845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837735008","html_url":"https://github.com/apache/hudi/pull/2720#issuecomment-837735008","issue_url":"https://api.github.com/repos/apache/hudi/issues/2720","id":837735008,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzczNTAwOA==","user":{"login":"xiarixiaoyao","id":13514703,"node_id":"MDQ6VXNlcjEzNTE0NzAz","avatar_url":"https://avatars.githubusercontent.com/u/13514703?v=4","gravatar_id":"","url":"https://api.github.com/users/xiarixiaoyao","html_url":"https://github.com/xiarixiaoyao","followers_url":"https://api.github.com/users/xiarixiaoyao/followers","following_url":"https://api.github.com/users/xiarixiaoyao/following{/other_user}","gists_url":"https://api.github.com/users/xiarixiaoyao/gists{/gist_id}","starred_url":"https://api.github.com/users/xiarixiaoyao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiarixiaoyao/subscriptions","organizations_url":"https://api.github.com/users/xiarixiaoyao/orgs","repos_url":"https://api.github.com/users/xiarixiaoyao/repos","events_url":"https://api.github.com/users/xiarixiaoyao/events{/privacy}","received_events_url":"https://api.github.com/users/xiarixiaoyao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T03:37:55Z","updated_at":"2021-05-11T03:37:55Z","author_association":"CONTRIBUTOR","body":"@vinothchandar  i will do it  today, thanks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837735008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837816065","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-837816065","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":837816065,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzgxNjA2NQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T05:00:38Z","updated_at":"2021-05-11T05:00:38Z","author_association":"MEMBER","body":"> each task manager is, sending RPC calls to the timeline server running locally?\r\n\r\neach write task is sending a RPC call to itself? Could you confirm that. \r\n\r\n>we start a write client for each task and we use that client always.\r\n\r\nSo its a singleton per JVM for a given table? \r\n\r\n>if i request the embedded timeline server with a new instant time, the server should sync itself first, \r\n\r\nThe incremental timeline sync should be efficient. Is that what you are referring to? \r\n\r\nThanks for answering patiently. This model is very different. :) \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837816065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837889063","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-837889063","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":837889063,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzg4OTA2Mw==","user":{"login":"danny0405","id":7644508,"node_id":"MDQ6VXNlcjc2NDQ1MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7644508?v=4","gravatar_id":"","url":"https://api.github.com/users/danny0405","html_url":"https://github.com/danny0405","followers_url":"https://api.github.com/users/danny0405/followers","following_url":"https://api.github.com/users/danny0405/following{/other_user}","gists_url":"https://api.github.com/users/danny0405/gists{/gist_id}","starred_url":"https://api.github.com/users/danny0405/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danny0405/subscriptions","organizations_url":"https://api.github.com/users/danny0405/orgs","repos_url":"https://api.github.com/users/danny0405/repos","events_url":"https://api.github.com/users/danny0405/events{/privacy}","received_events_url":"https://api.github.com/users/danny0405/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T06:06:21Z","updated_at":"2021-05-11T08:57:19Z","author_association":"CONTRIBUTOR","body":"> each write task is sending a RPC call to itself? Could you confirm that.\r\n\r\nYes, i can confirm this. Each task initialized a write client when it starts so a separate timeline server by itself of its thread.\r\n\r\n> So its a singleton per JVM for a given table?\r\n\r\nIt is not singleton without this path, each write task thread takes a new server there.\r\n\r\n> The incremental timeline sync should be efficient. Is that what you are referring to?\r\n\r\nYes, if the incremental timeline sync is valid and efficient, there is no need to start a server each thread and we can make the server JVM singleton.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837889063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837925932","html_url":"https://github.com/apache/hudi/pull/2740#issuecomment-837925932","issue_url":"https://api.github.com/repos/apache/hudi/issues/2740","id":837925932,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzkyNTkzMg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T06:37:38Z","updated_at":"2021-05-11T06:37:38Z","author_association":"MEMBER","body":"This is a very valuable cleanup! Thanks @TeRS-K ! Over to you and @yanghua to land when ready. I also renamed that one file and pushed, kicked CI again","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837925932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837953122","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-837953122","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":837953122,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzk1MzEyMg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T07:00:35Z","updated_at":"2021-05-11T07:00:35Z","author_association":"MEMBER","body":"Longer term, I think we should think about running the timeline server with the job manager, rather than task manager IMO.\r\n\r\nI was trying to understand how incremental sync of new commits to timeline server happens. \r\n\r\n![image](https://user-images.githubusercontent.com/1179324/117772080-a6df1200-b1eb-11eb-9608-4dd7183bb5d1.png)\r\n\r\n@bvaradar wrote most of this code. But seems like there is a refresh interval after which the timeline server keeps itself updated with new instants on the timeline? We need to understand this a bit more, before making this singleton, regardless of other issues. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837953122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837963497","html_url":"https://github.com/apache/hudi/pull/2740#issuecomment-837963497","issue_url":"https://api.github.com/repos/apache/hudi/issues/2740","id":837963497,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzk2MzQ5Nw==","user":{"login":"codecov-commenter","id":65553080,"node_id":"MDQ6VXNlcjY1NTUzMDgw","avatar_url":"https://avatars.githubusercontent.com/u/65553080?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-commenter","html_url":"https://github.com/codecov-commenter","followers_url":"https://api.github.com/users/codecov-commenter/followers","following_url":"https://api.github.com/users/codecov-commenter/following{/other_user}","gists_url":"https://api.github.com/users/codecov-commenter/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-commenter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-commenter/subscriptions","organizations_url":"https://api.github.com/users/codecov-commenter/orgs","repos_url":"https://api.github.com/users/codecov-commenter/repos","events_url":"https://api.github.com/users/codecov-commenter/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-commenter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T07:09:32Z","updated_at":"2021-05-11T09:08:03Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2740?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) Report\n> Merging [#2740](https://codecov.io/gh/apache/hudi/pull/2740?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (764f1f2) into [master](https://codecov.io/gh/apache/hudi/commit/6786581c4842e47e1a8a8e942f54003dc151c7c6?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) (6786581) will **increase** coverage by `2.22%`.\n> The diff coverage is `38.46%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2740/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)](https://codecov.io/gh/apache/hudi/pull/2740?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2740      +/-   ##\n============================================\n+ Coverage     52.54%   54.77%   +2.22%     \n- Complexity     3707     3811     +104     \n============================================\n  Files           485      482       -3     \n  Lines         23171    23333     +162     \n  Branches       2459     2488      +29     \n============================================\n+ Hits          12176    12781     +605     \n+ Misses         9923     9396     -527     \n- Partials       1072     1156      +84     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `39.53% <0.00%> (-0.77%)` | `220.00 <0.00> (+5.00)` | :arrow_down: |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.36% <39.13%> (-0.32%)` | `1978.00 <6.00> (+2.00)` | :arrow_down: |\n| hudiflink | `63.05% <100.00%> (+6.47%)` | `530.00 <0.00> (+14.00)` | |\n| hudihadoopmr | `50.96% <ø> (+17.51%)` | `262.00 <ø> (+65.00)` | |\n| hudisparkdatasource | `73.33% <ø> (+2.00%)` | `237.00 <ø> (ø)` | |\n| hudisync | `46.44% <ø> (+0.74%)` | `144.00 <ø> (+13.00)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `62.00 <ø> (ø)` | |\n| hudiutilities | `69.59% <ø> (-0.14%)` | `378.00 <ø> (+5.00)` | :arrow_down: |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2740?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [.../main/scala/org/apache/hudi/cli/SparkHelpers.scala](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jbGkvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL2NsaS9TcGFya0hlbHBlcnMuc2NhbGE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...rg/apache/hudi/io/storage/HoodieParquetReader.java](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaW8vc3RvcmFnZS9Ib29kaWVQYXJxdWV0UmVhZGVyLmphdmE=) | `35.71% <16.66%> (+4.94%)` | `1.00 <0.00> (ø)` | |\n| [...ava/org/apache/hudi/common/util/BaseFileUtils.java](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvQmFzZUZpbGVVdGlscy5qYXZh) | `25.00% <25.00%> (ø)` | `2.00 <2.00> (?)` | |\n| [...java/org/apache/hudi/common/util/ParquetUtils.java](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3V0aWwvUGFycXVldFV0aWxzLmphdmE=) | `60.95% <50.00%> (-0.22%)` | `18.00 <2.00> (+1.00)` | :arrow_down: |\n| [...c/main/java/org/apache/hudi/common/fs/FSUtils.java](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL0ZTVXRpbHMuamF2YQ==) | `47.59% <100.00%> (+0.25%)` | `57.00 <2.00> (ø)` | |\n| [...he/hudi/sink/partitioner/BucketAssignFunction.java](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL0J1Y2tldEFzc2lnbkZ1bmN0aW9uLmphdmE=) | `83.90% <100.00%> (-1.28%)` | `17.00 <0.00> (ø)` | |\n| [.../main/java/org/apache/hudi/util/AvroConvertor.java](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS91dGlsL0F2cm9Db252ZXJ0b3IuamF2YQ==) | `0.00% <0.00%> (-82.36%)` | `0.00% <0.00%> (-6.00%)` | |\n| [.../apache/hudi/sink/partitioner/BucketAssigners.java](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL3BhcnRpdGlvbmVyL0J1Y2tldEFzc2lnbmVycy5qYXZh) | `33.33% <0.00%> (-16.67%)` | `2.00% <0.00%> (ø%)` | |\n| [...hadoop/realtime/RealtimeCompactedRecordReader.java](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1oYWRvb3AtbXIvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvaGFkb29wL3JlYWx0aW1lL1JlYWx0aW1lQ29tcGFjdGVkUmVjb3JkUmVhZGVyLmphdmE=) | `65.62% <0.00%> (-7.11%)` | `14.00% <0.00%> (+2.00%)` | :arrow_down: |\n| [...common/table/log/HoodieMergedLogRecordScanner.java](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVNZXJnZWRMb2dSZWNvcmRTY2FubmVyLmphdmE=) | `82.35% <0.00%> (-5.15%)` | `9.00% <0.00%> (-1.00%)` | |\n| ... and [68 more](https://codecov.io/gh/apache/hudi/pull/2740/diff?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=The+Apache+Software+Foundation) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/837963497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/838049296","html_url":"https://github.com/apache/hudi/pull/2899#issuecomment-838049296","issue_url":"https://api.github.com/repos/apache/hudi/issues/2899","id":838049296,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODA0OTI5Ng==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T08:16:34Z","updated_at":"2021-05-11T08:16:51Z","author_association":"MEMBER","body":"@danny0405 if your concern is memory usage alone and not the time taken to spin up the timeline server for each write task, then worth exploring if you want to use `EMBEDDED_KV_STORE` or `SPILLABLE_DISK` FileSystemViewStorageType instead. That will reduce memory pressure. \r\n\r\nIf you truly want the server to run with each TaskManager, I think we can do what you are trying to do here, but lets add a flag, that controls the reuse behavior and turn it on only for Flink path? I do think this will also involve testing of the incremental sync part more rigorously. Without the incremental sync, I think we end up calling AbstractTableFileSystemView#runSync(), which will reset and reinit file listings anyway, by refreshing the timeline (causes more listings to .hoodie/ each call to timeline server to check if local view is behind, see RequestHandler#syncIfLocalViewBehind) \r\n\r\nHope that helps! ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/838049296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/838059599","html_url":"https://github.com/apache/hudi/pull/2902#issuecomment-838059599","issue_url":"https://api.github.com/repos/apache/hudi/issues/2902","id":838059599,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODA1OTU5OQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T08:23:44Z","updated_at":"2021-05-11T08:23:44Z","author_association":"MEMBER","body":"@nsivabalan did you hav chance to review this?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/838059599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/838061297","html_url":"https://github.com/apache/hudi/pull/2912#issuecomment-838061297","issue_url":"https://api.github.com/repos/apache/hudi/issues/2912","id":838061297,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODA2MTI5Nw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T08:24:52Z","updated_at":"2021-05-11T08:24:52Z","author_association":"MEMBER","body":"No the documentation for th e CLI itself?\r\nhttps://hudi.apache.org/docs/deployment.html#cli ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/838061297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/838065811","html_url":"https://github.com/apache/hudi/pull/2496#issuecomment-838065811","issue_url":"https://api.github.com/repos/apache/hudi/issues/2496","id":838065811,"node_id":"MDEyOklzc3VlQ29tbWVudDgzODA2NTgxMQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-11T08:27:54Z","updated_at":"2021-05-11T08:27:54Z","author_association":"MEMBER","body":"@prashantwason ping! \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/838065811/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]