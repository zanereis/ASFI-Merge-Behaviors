[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287657280","html_url":"https://github.com/apache/couchdb/pull/415#issuecomment-287657280","issue_url":"https://api.github.com/repos/apache/couchdb/issues/415","id":287657280,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NzY1NzI4MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-19T23:32:05Z","updated_at":"2017-03-19T23:32:05Z","author_association":"MEMBER","body":"Already merged, closing this PR.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287657280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287657492","html_url":"https://github.com/apache/couchdb/pull/422#issuecomment-287657492","issue_url":"https://api.github.com/repos/apache/couchdb/issues/422","id":287657492,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NzY1NzQ5Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-19T23:35:57Z","updated_at":"2017-03-19T23:35:57Z","author_association":"MEMBER","body":"Addressed by commit: https://github.com/apache/couchdb/commit/112501c6db959489b077fa9ad2350b2ffc25de54\r\n\r\nerlang-reltool has been added but as @kxepal said we use our own rebar.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287657492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287657664","html_url":"https://github.com/apache/couchdb/pull/425#issuecomment-287657664","issue_url":"https://api.github.com/repos/apache/couchdb/issues/425","id":287657664,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NzY1NzY2NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-19T23:38:58Z","updated_at":"2017-03-19T23:38:58Z","author_association":"MEMBER","body":"@nickva Looks like @kxepal changed his -1 to a -0(ish), and the build passes (I'm rerunning the one platform that had a transient failure but expect success). Would you care to merge this change?\r\n\r\nI'd like to see a JIRA ticket for this as well, and a test case if it makes sense.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287657664/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287657676","html_url":"https://github.com/apache/couchdb/pull/430#issuecomment-287657676","issue_url":"https://api.github.com/repos/apache/couchdb/issues/430","id":287657676,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NzY1NzY3Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-19T23:39:15Z","updated_at":"2017-03-19T23:39:15Z","author_association":"MEMBER","body":"Outdated","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287657676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287703824","html_url":"https://github.com/apache/couchdb/pull/354#issuecomment-287703824","issue_url":"https://api.github.com/repos/apache/couchdb/issues/354","id":287703824,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NzcwMzgyNA==","user":{"login":"sebastianrothbucher","id":7339874,"node_id":"MDQ6VXNlcjczMzk4NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/7339874?v=4","gravatar_id":"","url":"https://api.github.com/users/sebastianrothbucher","html_url":"https://github.com/sebastianrothbucher","followers_url":"https://api.github.com/users/sebastianrothbucher/followers","following_url":"https://api.github.com/users/sebastianrothbucher/following{/other_user}","gists_url":"https://api.github.com/users/sebastianrothbucher/gists{/gist_id}","starred_url":"https://api.github.com/users/sebastianrothbucher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebastianrothbucher/subscriptions","organizations_url":"https://api.github.com/users/sebastianrothbucher/orgs","repos_url":"https://api.github.com/users/sebastianrothbucher/repos","events_url":"https://api.github.com/users/sebastianrothbucher/events{/privacy}","received_events_url":"https://api.github.com/users/sebastianrothbucher/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-20T08:56:51Z","updated_at":"2017-03-20T08:56:51Z","author_association":"CONTRIBUTOR","body":"as far as I can remember, we can indeed close it (leaving it up 2 @janl still)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287703824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287841505","html_url":"https://github.com/apache/couchdb/pull/340#issuecomment-287841505","issue_url":"https://api.github.com/repos/apache/couchdb/issues/340","id":287841505,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Nzg0MTUwNQ==","user":{"login":"klaemo","id":778624,"node_id":"MDQ6VXNlcjc3ODYyNA==","avatar_url":"https://avatars.githubusercontent.com/u/778624?v=4","gravatar_id":"","url":"https://api.github.com/users/klaemo","html_url":"https://github.com/klaemo","followers_url":"https://api.github.com/users/klaemo/followers","following_url":"https://api.github.com/users/klaemo/following{/other_user}","gists_url":"https://api.github.com/users/klaemo/gists{/gist_id}","starred_url":"https://api.github.com/users/klaemo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/klaemo/subscriptions","organizations_url":"https://api.github.com/users/klaemo/orgs","repos_url":"https://api.github.com/users/klaemo/repos","events_url":"https://api.github.com/users/klaemo/events{/privacy}","received_events_url":"https://api.github.com/users/klaemo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-20T17:47:48Z","updated_at":"2017-03-20T17:47:48Z","author_association":"CONTRIBUTOR","body":"I don't think so. There doesn't seem that much interest in a dockerized CouchDB development environment in the community. Also I don't have the time to maintain it anymore. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287841505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287867358","html_url":"https://github.com/apache/couchdb/pull/340#issuecomment-287867358","issue_url":"https://api.github.com/repos/apache/couchdb/issues/340","id":287867358,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Nzg2NzM1OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-20T19:13:48Z","updated_at":"2017-03-20T19:13:48Z","author_association":"MEMBER","body":"@klaemo Thanks. FYI we _are_ using Docker to build CouchDB in our Apache Jenkins CI environment. Details are over at the https://github.com/apache/couchdb-ci repository. Any comments you have are most welcome :)\r\n\r\nClosing this one out.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287867358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287885492","html_url":"https://github.com/apache/couchdb/pull/461#issuecomment-287885492","issue_url":"https://api.github.com/repos/apache/couchdb/issues/461","id":287885492,"node_id":"MDEyOklzc3VlQ29tbWVudDI4Nzg4NTQ5Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-20T20:21:40Z","updated_at":"2017-03-20T20:21:40Z","author_association":"MEMBER","body":"Test complete.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/287885492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/288080378","html_url":"https://github.com/apache/couchdb/pull/324#issuecomment-288080378","issue_url":"https://api.github.com/repos/apache/couchdb/issues/324","id":288080378,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODA4MDM3OA==","user":{"login":"benel","id":597307,"node_id":"MDQ6VXNlcjU5NzMwNw==","avatar_url":"https://avatars.githubusercontent.com/u/597307?v=4","gravatar_id":"","url":"https://api.github.com/users/benel","html_url":"https://github.com/benel","followers_url":"https://api.github.com/users/benel/followers","following_url":"https://api.github.com/users/benel/following{/other_user}","gists_url":"https://api.github.com/users/benel/gists{/gist_id}","starred_url":"https://api.github.com/users/benel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benel/subscriptions","organizations_url":"https://api.github.com/users/benel/orgs","repos_url":"https://api.github.com/users/benel/repos","events_url":"https://api.github.com/users/benel/events{/privacy}","received_events_url":"https://api.github.com/users/benel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-21T13:38:36Z","updated_at":"2017-03-21T13:39:34Z","author_association":"NONE","body":"@wohali Martin did this for me when he was one of my students. I'm not sure he's still on GitHub.\r\nWhich tests do you need to be run? Travis tests?\r\n\r\nIf yes, here is a rebase on CouchDB master branch: \r\nhttps://travis-ci.org/benel/couchdb/builds/213346474\r\nI will open a pull request if it's OK.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/288080378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/288239373","html_url":"https://github.com/apache/couchdb/pull/462#issuecomment-288239373","issue_url":"https://api.github.com/repos/apache/couchdb/issues/462","id":288239373,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODIzOTM3Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-21T22:28:49Z","updated_at":"2017-03-21T22:28:49Z","author_association":"MEMBER","body":"+1, thanks","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/288239373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/289520861","html_url":"https://github.com/apache/couchdb/pull/340#issuecomment-289520861","issue_url":"https://api.github.com/repos/apache/couchdb/issues/340","id":289520861,"node_id":"MDEyOklzc3VlQ29tbWVudDI4OTUyMDg2MQ==","user":{"login":"gabrielmancini","id":144915,"node_id":"MDQ6VXNlcjE0NDkxNQ==","avatar_url":"https://avatars.githubusercontent.com/u/144915?v=4","gravatar_id":"","url":"https://api.github.com/users/gabrielmancini","html_url":"https://github.com/gabrielmancini","followers_url":"https://api.github.com/users/gabrielmancini/followers","following_url":"https://api.github.com/users/gabrielmancini/following{/other_user}","gists_url":"https://api.github.com/users/gabrielmancini/gists{/gist_id}","starred_url":"https://api.github.com/users/gabrielmancini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gabrielmancini/subscriptions","organizations_url":"https://api.github.com/users/gabrielmancini/orgs","repos_url":"https://api.github.com/users/gabrielmancini/repos","events_url":"https://api.github.com/users/gabrielmancini/events{/privacy}","received_events_url":"https://api.github.com/users/gabrielmancini/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-27T17:15:32Z","updated_at":"2017-03-27T17:15:32Z","author_association":"NONE","body":"i use in my local development, but i dont find de logs","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/289520861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/289817856","html_url":"https://github.com/apache/couchdb/pull/425#issuecomment-289817856","issue_url":"https://api.github.com/repos/apache/couchdb/issues/425","id":289817856,"node_id":"MDEyOklzc3VlQ29tbWVudDI4OTgxNzg1Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-28T15:59:44Z","updated_at":"2017-03-28T15:59:44Z","author_association":"CONTRIBUTOR","body":"Thanks for taking a look @wohali  and @kxepal \r\n\r\nThere is a JIRA issue already: https://issues.apache.org/jira/browse/COUCHDB-3046.\r\n\r\nAlso rebased on master.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/289817856/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/290446057","html_url":"https://github.com/apache/couchdb/issues/464#issuecomment-290446057","issue_url":"https://api.github.com/repos/apache/couchdb/issues/464","id":290446057,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDQ0NjA1Nw==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-30T15:24:43Z","updated_at":"2017-03-30T15:24:43Z","author_association":"MEMBER","body":"See http://docs.couchdb.org/en/2.0.0/maintenance/compaction.html for details","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/290446057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/290635297","html_url":"https://github.com/apache/couchdb/pull/324#issuecomment-290635297","issue_url":"https://api.github.com/repos/apache/couchdb/issues/324","id":290635297,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDYzNTI5Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-31T07:12:28Z","updated_at":"2017-03-31T07:12:28Z","author_association":"MEMBER","body":"@benel Yes thank you! Open a new PR and reference this one. I will close this one now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/290635297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/290703241","html_url":"https://github.com/apache/couchdb/issues/464#issuecomment-290703241","issue_url":"https://api.github.com/repos/apache/couchdb/issues/464","id":290703241,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDcwMzI0MQ==","user":{"login":"larryaubstore","id":1501160,"node_id":"MDQ6VXNlcjE1MDExNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1501160?v=4","gravatar_id":"","url":"https://api.github.com/users/larryaubstore","html_url":"https://github.com/larryaubstore","followers_url":"https://api.github.com/users/larryaubstore/followers","following_url":"https://api.github.com/users/larryaubstore/following{/other_user}","gists_url":"https://api.github.com/users/larryaubstore/gists{/gist_id}","starred_url":"https://api.github.com/users/larryaubstore/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/larryaubstore/subscriptions","organizations_url":"https://api.github.com/users/larryaubstore/orgs","repos_url":"https://api.github.com/users/larryaubstore/repos","events_url":"https://api.github.com/users/larryaubstore/events{/privacy}","received_events_url":"https://api.github.com/users/larryaubstore/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-31T12:50:17Z","updated_at":"2017-03-31T12:50:17Z","author_association":"NONE","body":"Thank you for the quick response. Do you have an example somewhere ? \r\n\r\nI added this config in local.ini but it does not seem to work:\r\n\r\n`_default = [{db_fragmentation, \"70%\"}, {view_fragmentation, \"60%\"}, {from, \"07:00\"}, {to, \"11:00\"}]`\r\n\r\nDo I have to specify the databases somewhere ?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/290703241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/290706041","html_url":"https://github.com/apache/couchdb/issues/464#issuecomment-290706041","issue_url":"https://api.github.com/repos/apache/couchdb/issues/464","id":290706041,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDcwNjA0MQ==","user":{"login":"larryaubstore","id":1501160,"node_id":"MDQ6VXNlcjE1MDExNjA=","avatar_url":"https://avatars.githubusercontent.com/u/1501160?v=4","gravatar_id":"","url":"https://api.github.com/users/larryaubstore","html_url":"https://github.com/larryaubstore","followers_url":"https://api.github.com/users/larryaubstore/followers","following_url":"https://api.github.com/users/larryaubstore/following{/other_user}","gists_url":"https://api.github.com/users/larryaubstore/gists{/gist_id}","starred_url":"https://api.github.com/users/larryaubstore/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/larryaubstore/subscriptions","organizations_url":"https://api.github.com/users/larryaubstore/orgs","repos_url":"https://api.github.com/users/larryaubstore/repos","events_url":"https://api.github.com/users/larryaubstore/events{/privacy}","received_events_url":"https://api.github.com/users/larryaubstore/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-03-31T13:03:16Z","updated_at":"2017-03-31T13:35:31Z","author_association":"NONE","body":"The automatic compaction does not seem to work. I tried with 5%, it is never triggered:\r\n\r\n`_default = [{db_fragmentation, \"5%\"}, {view_fragmentation, \"5%\"}, {from, \"07:00\"}, {to, \"11:00\"}]`\r\n\r\nThere is an other thing that it is not clear to me. Does '_clean_up' operation included in compaction ?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/290706041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291308455","html_url":"https://github.com/apache/couchdb/pull/463#issuecomment-291308455","issue_url":"https://api.github.com/repos/apache/couchdb/issues/463","id":291308455,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTMwODQ1NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-03T23:13:36Z","updated_at":"2017-04-03T23:13:36Z","author_association":"MEMBER","body":"Bump. Can anyone take a look at this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291308455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291320747","html_url":"https://github.com/apache/couchdb/issues/467#issuecomment-291320747","issue_url":"https://api.github.com/repos/apache/couchdb/issues/467","id":291320747,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTMyMDc0Nw==","user":{"login":"Humbedooh","id":496607,"node_id":"MDQ6VXNlcjQ5NjYwNw==","avatar_url":"https://avatars.githubusercontent.com/u/496607?v=4","gravatar_id":"","url":"https://api.github.com/users/Humbedooh","html_url":"https://github.com/Humbedooh","followers_url":"https://api.github.com/users/Humbedooh/followers","following_url":"https://api.github.com/users/Humbedooh/following{/other_user}","gists_url":"https://api.github.com/users/Humbedooh/gists{/gist_id}","starred_url":"https://api.github.com/users/Humbedooh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Humbedooh/subscriptions","organizations_url":"https://api.github.com/users/Humbedooh/orgs","repos_url":"https://api.github.com/users/Humbedooh/repos","events_url":"https://api.github.com/users/Humbedooh/events{/privacy}","received_events_url":"https://api.github.com/users/Humbedooh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-03T23:40:58Z","updated_at":"2017-04-03T23:40:58Z","author_association":"MEMBER","body":"test test, this should only hit notifications","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291320747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291321677","html_url":"https://github.com/apache/couchdb/issues/467#issuecomment-291321677","issue_url":"https://api.github.com/repos/apache/couchdb/issues/467","id":291321677,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTMyMTY3Nw==","user":{"login":"Humbedooh","id":496607,"node_id":"MDQ6VXNlcjQ5NjYwNw==","avatar_url":"https://avatars.githubusercontent.com/u/496607?v=4","gravatar_id":"","url":"https://api.github.com/users/Humbedooh","html_url":"https://github.com/Humbedooh","followers_url":"https://api.github.com/users/Humbedooh/followers","following_url":"https://api.github.com/users/Humbedooh/following{/other_user}","gists_url":"https://api.github.com/users/Humbedooh/gists{/gist_id}","starred_url":"https://api.github.com/users/Humbedooh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Humbedooh/subscriptions","organizations_url":"https://api.github.com/users/Humbedooh/orgs","repos_url":"https://api.github.com/users/Humbedooh/repos","events_url":"https://api.github.com/users/Humbedooh/events{/privacy}","received_events_url":"https://api.github.com/users/Humbedooh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-03T23:43:02Z","updated_at":"2017-04-03T23:43:02Z","author_association":"MEMBER","body":"and this should bork to infra also :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291321677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291324154","html_url":"https://github.com/apache/couchdb/issues/467#issuecomment-291324154","issue_url":"https://api.github.com/repos/apache/couchdb/issues/467","id":291324154,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTMyNDE1NA==","user":{"login":"Humbedooh","id":496607,"node_id":"MDQ6VXNlcjQ5NjYwNw==","avatar_url":"https://avatars.githubusercontent.com/u/496607?v=4","gravatar_id":"","url":"https://api.github.com/users/Humbedooh","html_url":"https://github.com/Humbedooh","followers_url":"https://api.github.com/users/Humbedooh/followers","following_url":"https://api.github.com/users/Humbedooh/following{/other_user}","gists_url":"https://api.github.com/users/Humbedooh/gists{/gist_id}","starred_url":"https://api.github.com/users/Humbedooh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Humbedooh/subscriptions","organizations_url":"https://api.github.com/users/Humbedooh/orgs","repos_url":"https://api.github.com/users/Humbedooh/repos","events_url":"https://api.github.com/users/Humbedooh/events{/privacy}","received_events_url":"https://api.github.com/users/Humbedooh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-03T23:48:49Z","updated_at":"2017-04-03T23:48:49Z","author_association":"MEMBER","body":"or rather, this should bork.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291324154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291333384","html_url":"https://github.com/apache/couchdb/issues/467#issuecomment-291333384","issue_url":"https://api.github.com/repos/apache/couchdb/issues/467","id":291333384,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTMzMzM4NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-04T00:09:24Z","updated_at":"2017-04-04T00:09:24Z","author_association":"MEMBER","body":"I think we've got it now. Thanks @Humbedooh !","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291333384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291370240","html_url":"https://github.com/apache/couchdb/pull/466#issuecomment-291370240","issue_url":"https://api.github.com/repos/apache/couchdb/issues/466","id":291370240,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTM3MDI0MA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-04T01:52:44Z","updated_at":"2017-04-04T01:52:44Z","author_association":"CONTRIBUTOR","body":"I think we can close this as monorepo merge included this commit (but do verify if that's the case):\r\n\r\nI went by this commit message ` Add 'src/mango/' from commit '312e2c45535913c190cdef51f6ea65066ccd89dc'\r\njanl committed 2 days ago `","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291370240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291370564","html_url":"https://github.com/apache/couchdb/pull/463#issuecomment-291370564","issue_url":"https://api.github.com/repos/apache/couchdb/issues/463","id":291370564,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTM3MDU2NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-04T01:55:06Z","updated_at":"2017-04-04T01:55:19Z","author_association":"CONTRIBUTOR","body":"@wohali  Good idea!\r\n\r\n+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291370564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291431640","html_url":"https://github.com/apache/couchdb/issues/468#issuecomment-291431640","issue_url":"https://api.github.com/repos/apache/couchdb/issues/468","id":291431640,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTQzMTY0MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-04T08:35:35Z","updated_at":"2017-04-04T08:35:35Z","author_association":"MEMBER","body":"couch_peruser is indeed broken in 2.0.0; there are no plans to fix it at this time. The current plan is to replace the feature entirely with new functionality.\r\n\r\nIf you need couch_peruser functionality please use couchdb 1.6.x.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291431640/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291537866","html_url":"https://github.com/apache/couchdb/pull/469#issuecomment-291537866","issue_url":"https://api.github.com/repos/apache/couchdb/issues/469","id":291537866,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTUzNzg2Ng==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-04T15:32:08Z","updated_at":"2017-04-04T15:32:08Z","author_association":"MEMBER","body":"I ran the pouchdb-find tests locally against this fix and all tests passed. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291537866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291782010","html_url":"https://github.com/apache/couchdb/pull/469#issuecomment-291782010","issue_url":"https://api.github.com/repos/apache/couchdb/issues/469","id":291782010,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTc4MjAxMA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T07:49:06Z","updated_at":"2017-04-05T07:49:25Z","author_association":"CONTRIBUTOR","body":"Paul hit the nail for the gist of this, so the only thing I'm going to add is that for the tests, we should probably use the _explain endpoint and make sure we're choosing the right index. So\r\n\r\n1) Create a bunch of indexes with various columns lengths. \r\n\r\n2) Create selectors that use various combinations of fields\r\n\r\n3) Execute those queries but with _explain, and ensure that the correct index with the right prefix was used by checking the index name.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291782010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291798311","html_url":"https://github.com/apache/couchdb/pull/466#issuecomment-291798311","issue_url":"https://api.github.com/repos/apache/couchdb/issues/466","id":291798311,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTc5ODMxMQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T08:58:45Z","updated_at":"2017-04-05T08:58:45Z","author_association":"MEMBER","body":"Yup, @nickva you are correct. Thanks","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291798311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291855146","html_url":"https://github.com/apache/couchdb/pull/138#issuecomment-291855146","issue_url":"https://api.github.com/repos/apache/couchdb/issues/138","id":291855146,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTg1NTE0Ng==","user":{"login":"Kequc","id":584075,"node_id":"MDQ6VXNlcjU4NDA3NQ==","avatar_url":"https://avatars.githubusercontent.com/u/584075?v=4","gravatar_id":"","url":"https://api.github.com/users/Kequc","html_url":"https://github.com/Kequc","followers_url":"https://api.github.com/users/Kequc/followers","following_url":"https://api.github.com/users/Kequc/following{/other_user}","gists_url":"https://api.github.com/users/Kequc/gists{/gist_id}","starred_url":"https://api.github.com/users/Kequc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kequc/subscriptions","organizations_url":"https://api.github.com/users/Kequc/orgs","repos_url":"https://api.github.com/users/Kequc/repos","events_url":"https://api.github.com/users/Kequc/events{/privacy}","received_events_url":"https://api.github.com/users/Kequc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T13:06:35Z","updated_at":"2017-04-05T13:06:35Z","author_association":"NONE","body":"It would be beneficial to my library if the API between `POST /db` and `PUT /db/id` were more similar regarding multipart uploads. Currently I can only create a new document with attachments if I know the id I want to use ahead of time.\r\n\r\nOr maybe my CouchDB is too far out of date. Has this been fixed in recent versions?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291855146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291880170","html_url":"https://github.com/apache/couchdb/pull/340#issuecomment-291880170","issue_url":"https://api.github.com/repos/apache/couchdb/issues/340","id":291880170,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTg4MDE3MA==","user":{"login":"nono","id":2767,"node_id":"MDQ6VXNlcjI3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/2767?v=4","gravatar_id":"","url":"https://api.github.com/users/nono","html_url":"https://github.com/nono","followers_url":"https://api.github.com/users/nono/followers","following_url":"https://api.github.com/users/nono/following{/other_user}","gists_url":"https://api.github.com/users/nono/gists{/gist_id}","starred_url":"https://api.github.com/users/nono/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nono/subscriptions","organizations_url":"https://api.github.com/users/nono/orgs","repos_url":"https://api.github.com/users/nono/repos","events_url":"https://api.github.com/users/nono/events{/privacy}","received_events_url":"https://api.github.com/users/nono/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T14:32:16Z","updated_at":"2017-04-05T14:32:16Z","author_association":"NONE","body":"We are using the docker images for couchdb 2.0 for developing https://github.com/cozy/cozy-stack. Thanks you @klaemo!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291880170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291882516","html_url":"https://github.com/apache/couchdb/pull/340#issuecomment-291882516","issue_url":"https://api.github.com/repos/apache/couchdb/issues/340","id":291882516,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTg4MjUxNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T14:39:29Z","updated_at":"2017-04-05T14:39:29Z","author_association":"MEMBER","body":"@nono the docker images are unrelated to these changes. Those are over here: https://github.com/klaemo/docker-couchdb","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291882516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291922189","html_url":"https://github.com/apache/couchdb/pull/138#issuecomment-291922189","issue_url":"https://api.github.com/repos/apache/couchdb/issues/138","id":291922189,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTkyMjE4OQ==","user":{"login":"NorthNick","id":1299353,"node_id":"MDQ6VXNlcjEyOTkzNTM=","avatar_url":"https://avatars.githubusercontent.com/u/1299353?v=4","gravatar_id":"","url":"https://api.github.com/users/NorthNick","html_url":"https://github.com/NorthNick","followers_url":"https://api.github.com/users/NorthNick/followers","following_url":"https://api.github.com/users/NorthNick/following{/other_user}","gists_url":"https://api.github.com/users/NorthNick/gists{/gist_id}","starred_url":"https://api.github.com/users/NorthNick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NorthNick/subscriptions","organizations_url":"https://api.github.com/users/NorthNick/orgs","repos_url":"https://api.github.com/users/NorthNick/repos","events_url":"https://api.github.com/users/NorthNick/events{/privacy}","received_events_url":"https://api.github.com/users/NorthNick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T16:43:33Z","updated_at":"2017-04-05T16:43:33Z","author_association":"CONTRIBUTOR","body":"I believe it is still an issue in CouchDB 2. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291922189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291948168","html_url":"https://github.com/apache/couchdb/pull/469#issuecomment-291948168","issue_url":"https://api.github.com/repos/apache/couchdb/issues/469","id":291948168,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTk0ODE2OA==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T18:11:50Z","updated_at":"2017-04-05T18:12:11Z","author_association":"MEMBER","body":"This got lost:\r\nI've made an attempt at fixing this. I'm not 100% I fully understood @davisp explanation. In the situation of [a, b, c] and [a, d, e] I've defaulted to the indices names. The only problem with that is there is a possibility of a doc being in one index but not in another and this could lead to unexpected results for a user.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291948168/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291956472","html_url":"https://github.com/apache/couchdb/issues/472#issuecomment-291956472","issue_url":"https://api.github.com/repos/apache/couchdb/issues/472","id":291956472,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTk1NjQ3Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T18:40:35Z","updated_at":"2017-04-05T18:40:35Z","author_association":"MEMBER","body":"Nope, cats are. 😹 ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291956472/reactions","total_count":4,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291958334","html_url":"https://github.com/apache/couchdb/issues/472#issuecomment-291958334","issue_url":"https://api.github.com/repos/apache/couchdb/issues/472","id":291958334,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTk1ODMzNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T18:46:52Z","updated_at":"2017-04-05T18:46:52Z","author_association":"MEMBER","body":"🐈  🐕 🐿  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291958334/reactions","total_count":3,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291962449","html_url":"https://github.com/apache/couchdb/pull/471#issuecomment-291962449","issue_url":"https://api.github.com/repos/apache/couchdb/issues/471","id":291962449,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTk2MjQ0OQ==","user":{"login":"sagelywizard","id":167249,"node_id":"MDQ6VXNlcjE2NzI0OQ==","avatar_url":"https://avatars.githubusercontent.com/u/167249?v=4","gravatar_id":"","url":"https://api.github.com/users/sagelywizard","html_url":"https://github.com/sagelywizard","followers_url":"https://api.github.com/users/sagelywizard/followers","following_url":"https://api.github.com/users/sagelywizard/following{/other_user}","gists_url":"https://api.github.com/users/sagelywizard/gists{/gist_id}","starred_url":"https://api.github.com/users/sagelywizard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagelywizard/subscriptions","organizations_url":"https://api.github.com/users/sagelywizard/orgs","repos_url":"https://api.github.com/users/sagelywizard/repos","events_url":"https://api.github.com/users/sagelywizard/events{/privacy}","received_events_url":"https://api.github.com/users/sagelywizard/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-05T19:01:08Z","updated_at":"2017-04-05T19:01:08Z","author_association":"MEMBER","body":"Does this just push the failure from CouchDB to Clouseau? I think that this code originally assumed that the number of fields per doc is small enough to be considered constant, which is why O(n^2) with a fast operation like `lists:member` didn't matter. I think Clouseau makes the same assumption, so this change alone won't fix anything and will simply consume more CPU in the simple case. I might be wrong. @rnewson Have thoughts?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/291962449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292075085","html_url":"https://github.com/apache/couchdb/pull/471#issuecomment-292075085","issue_url":"https://api.github.com/repos/apache/couchdb/issues/471","id":292075085,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjA3NTA4NQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-06T05:47:13Z","updated_at":"2017-04-06T05:47:13Z","author_association":"CONTRIBUTOR","body":"@sagelywizard : yes, it does just push the failure over to Clouseau. We've already seen in production when users index everything, and the number of unique fields blows up the heap memory. In this particular case, there were so many fields that it never even made it to clouseau and got stuck in this process.\r\n\r\nWe have an option for users to disable the indexing of everything in the document, but if they still decide index a heavily nested  field with objects and arrays, then this issue could still occur. A while back, we discussed the possibility of adding another limit (# of levels deep we go in the object, or some total number of fields). Unfortunately, that would mean we'd also lose some ability for querying because those fields won't be indexed. That's for a bigger PR. \r\n\r\nThis is more of a cosmetic change, so we don't necessarily have to merge it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292075085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292090769","html_url":"https://github.com/apache/couchdb/pull/469#issuecomment-292090769","issue_url":"https://api.github.com/repos/apache/couchdb/issues/469","id":292090769,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjA5MDc2OQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-06T07:22:32Z","updated_at":"2017-04-06T07:23:41Z","author_association":"CONTRIBUTOR","body":"@garrensmith : @davisp was just saying that if you have the following indexes:\r\n\r\nIdx1 - [a, b, c, d]\r\nIdx2 - [a, b, c, e]\r\nIdx3 - [a, b, c]\r\n\r\nand you issued  a query with selectors using a,b,c, then we would choose Idx3. \r\n\r\nIf Idx3 didn't exist, then you need some sort of tiebreaker. The old way used a combination of\r\n[dbname, ddocid, viewname]. He was just saying you could still use this crude method as a tiebreaker, and use the ddocid (not all three elements).\r\n\r\nYou are right that this won't solve the issue when Idx1 is always chosen, and then a new Idx4 [a, b, c, f] which is alphabetically ahead of Idx1is added, then the user could possibly get different results. \r\n\r\nPaul did mention:\r\n\r\n\"In the future we could get fancy and cache selectors and a reduce query with the prefix range and prefer the view that has more documents.\"\r\n\r\nso that we could possibly choose the index with more documents and be a little more consistent. However, it's still probable that some indexes will contain different docs.  I'll think about it some more, but do you think that's more of index design on their part?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292090769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292157125","html_url":"https://github.com/apache/couchdb/pull/469#issuecomment-292157125","issue_url":"https://api.github.com/repos/apache/couchdb/issues/469","id":292157125,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjE1NzEyNQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-06T12:22:28Z","updated_at":"2017-04-06T12:22:28Z","author_association":"MEMBER","body":"@tonysun83 great. That makes sense. I think I have it to the point now where it will cover the above situations. Then in terms of choosing indexes with different docs, I think for now the best we can do is add documentation to explain that part. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292157125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292237042","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-292237042","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":292237042,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjIzNzA0Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-06T16:55:48Z","updated_at":"2017-04-06T16:56:32Z","author_association":"CONTRIBUTOR","body":"Some additional information from testing how new scheduling replicator handles a large amount of jobs.\r\n\r\nThis is a graph of adding 1M replication jobs to a cluster of 3 nodes. Replication jobs were added using couchdyno/rep tool : https://github.com/cloudant-labs/couchdyno/blob/master/README_rep.md\r\n\r\n```\r\nrep.replicate_all_and_compare(n=1000, num=1, normal=False) \r\n```\r\n\r\nThat creates a connected cluster of replications for for n=1000, it would create 1000*1000=1M replication jobs.\r\n\r\n![db_changes](https://cloud.githubusercontent.com/assets/211822/24765972/c1fb151c-1ac7-11e7-8fd5-45e44d1c4bc2.png)\r\n\r\n`couch_replicator.docs.db_changes` tracks the total number of changes seen by the replicator. In this case the replicator has seen the 1M replication documents created above.\r\n\r\n![jobs_total](https://cloud.githubusercontent.com/assets/211822/24766116/231f61e0-1ac8-11e7-9e32-8c95490df4f6.png)\r\n\r\n`couch_replicator.jobs.total` tracks the number of replication jobs managed by the scheduler. Out of the 1M jobs, each node in the cluster picked up about 330K each.\r\n\r\n![scheduler](https://cloud.githubusercontent.com/assets/211822/24766148/3daacf4a-1ac8-11e7-9577-60d502321804.png)\r\n\r\n`couch_replicator.jobs.starts` counts the number of jobs which have been started by the scheduler. In this case a time derivative was applied. So it shows how the scheduler interval works. Every time it runs it start another 20 jobs (this is specified by the max_churn parameter).\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292237042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292317910","html_url":"https://github.com/apache/couchdb/pull/473#issuecomment-292317910","issue_url":"https://api.github.com/repos/apache/couchdb/issues/473","id":292317910,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjMxNzkxMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-06T20:58:21Z","updated_at":"2017-04-06T20:58:21Z","author_association":"MEMBER","body":"@mhall119 Based on discussion with @janl we'd like to move this snap/ directory to the new couchdb-pkg repository along with all other packaging work (which includes my ongoing .deb, .rpm, BSD and Windows work).\r\n\r\nI know this will make things slightly more difficult for you and possibly Launchpad but I'm hoping we can make a recipe work. Can we discuss?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292317910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292340831","html_url":"https://github.com/apache/couchdb/pull/474#issuecomment-292340831","issue_url":"https://api.github.com/repos/apache/couchdb/issues/474","id":292340831,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjM0MDgzMQ==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-06T22:19:20Z","updated_at":"2017-04-06T22:19:20Z","author_association":"CONTRIBUTOR","body":"I expect to squash these commits once approved, but want to give appropriate credit to @eiri for the majority of this work.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292340831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292576373","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-292576373","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":292576373,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjU3NjM3Mw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-07T15:57:28Z","updated_at":"2017-04-07T15:57:28Z","author_association":"MEMBER","body":"Hooray scheduling replicator! This looks pretty awesome. Its quite big so I'm gonna split my review into roughly three parts: concerns, things that look like bugs, and then style issues. Commencing in 3, 2, 1, now!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292576373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292659556","html_url":"https://github.com/apache/couchdb/pull/361#issuecomment-292659556","issue_url":"https://api.github.com/repos/apache/couchdb/issues/361","id":292659556,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjY1OTU1Ng==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-07T21:44:57Z","updated_at":"2017-04-07T21:44:57Z","author_association":"MEMBER","body":"yes, would be affected (i.e, broken)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292659556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292660341","html_url":"https://github.com/apache/couchdb/pull/389#issuecomment-292660341","issue_url":"https://api.github.com/repos/apache/couchdb/issues/389","id":292660341,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjY2MDM0MQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-07T21:49:12Z","updated_at":"2017-04-07T21:49:12Z","author_association":"MEMBER","body":"sorry. @davisp is this right?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292660341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292660919","html_url":"https://github.com/apache/couchdb/pull/471#issuecomment-292660919","issue_url":"https://api.github.com/repos/apache/couchdb/issues/471","id":292660919,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjY2MDkxOQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-07T21:52:22Z","updated_at":"2017-04-07T21:52:22Z","author_association":"MEMBER","body":"I'm fine with improving mango performance. we should look at restricting field count in clouseau side though.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292660919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292679274","html_url":"https://github.com/apache/couchdb/pull/389#issuecomment-292679274","issue_url":"https://api.github.com/repos/apache/couchdb/issues/389","id":292679274,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjY3OTI3NA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-08T00:06:55Z","updated_at":"2017-04-08T00:06:55Z","author_association":"MEMBER","body":"Only on my phone so not 100% on reading the diff. @kxepal's explanation from a year ago is right as expected behavior. Heartbeat is how often to send a \"ping\" across the network and timeout is how long to wait for a change and the two should be independent. To my knowledge thats not broken so the change is confusing from that point of view.\r\n\r\nIf for some reason a heartbeat interval less than the timeout interval keeps a changes feed open forever then we have an issue. I don't see a test asserting the incorrect behavhior though so not sure. And its also possible we fixed this differently in the year since. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292679274/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292682217","html_url":"https://github.com/apache/couchdb/pull/361#issuecomment-292682217","issue_url":"https://api.github.com/repos/apache/couchdb/issues/361","id":292682217,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjY4MjIxNw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-08T00:39:27Z","updated_at":"2017-04-08T00:39:27Z","author_association":"MEMBER","body":"Stil on my phone but all I'm seeing is a diff in a config file which whie harmless suggests either the pr or my phone is broken. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292682217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292732921","html_url":"https://github.com/apache/couchdb/pull/361#issuecomment-292732921","issue_url":"https://api.github.com/repos/apache/couchdb/issues/361","id":292732921,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjczMjkyMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-08T17:26:37Z","updated_at":"2017-04-08T17:26:37Z","author_association":"MEMBER","body":"@gilv this patch is outdated. I'm going to close this PR for now. We'd love to have you rebase this against CouchDB 2.0 and re-submit -- please do! Thanks for your contribution to CouchDB.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/292732921/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293037299","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-293037299","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":293037299,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MzAzNzI5OQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-10T18:28:02Z","updated_at":"2017-04-10T18:28:02Z","author_association":"MEMBER","body":"Still taking my time to read through this thoroughly. I'm definitely appreciating how things are split out between different modules though I'm finding it a bit difficult to internalize the overall structure. It might be useful to have some sort of ascii art or just a textual description of the complete flow for the scheduler in src/couch_replicator/README.md or similar. Will keep reading though.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293037299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293051342","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-293051342","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":293051342,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MzA1MTM0Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-10T19:19:45Z","updated_at":"2017-04-10T19:20:26Z","author_association":"CONTRIBUTOR","body":"> Seems like couch_replicator_rate_limiter could use some tests and if we could pass our own now_msecs() value it'd be pretty simple to calculate some test data to assert we're generating the correct intervals.\r\n\r\nGot some rate limiter tests in : https://github.com/apache/couchdb/blob/63012-scheduler/src/couch_replicator/test/couch_replicator_rate_limiter_tests.erl\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293051342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293067926","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-293067926","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":293067926,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MzA2NzkyNg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-10T20:24:15Z","updated_at":"2017-04-10T20:24:15Z","author_association":"MEMBER","body":"Yeah, sorry to go back and note that. I found them after. I generally prefer tests separate from a module but in this case it might be nice to eventually move those to the module in case we ever move the module somewhere and make it more general to be re-used in other places cause it looks rather useful.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293067926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293084277","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-293084277","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":293084277,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MzA4NDI3Nw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-10T21:27:44Z","updated_at":"2017-04-10T21:27:44Z","author_association":"MEMBER","body":"Alright. Done for the day. I'm pretty sure I've got all the major bits paged into my brain. Everything seems pretty good. There are only two bits that we should think about a bit harder.\r\n\r\nThe HTTP handlers are a bit futzy. They currently aren't using fabirc/rexi style RPC and instead just use builtin Erlang RPC which is a bit of an odd departure from our standard approach to clustered HTTP requests. Also for the doc listing API its odd that we kind of just shove the lists out separately into a weirdly combined single view like output. Also any sort of skip is going to be rather non-performant so paging through our thousands of active replications concern is going to be ungood. I'd like to see this as a module using our standard fabric/rexi approach that is smart about paging and streaming results.\r\n\r\nThe doc processor architecture is a bit Rube Goldberg-ian. I can see why its that way given how all of the odd replication features kind of collide. User filter functions being the obvious complicating factor there.  I don't immediately see a better approach though given that the scheduler expects to have a replication_id before we tell it to do anything and that seems fairly legit. I'l stew on this overnight in case anything occurs to me.\r\n\r\nTomorrow I'm gonna write up a description/overview of the couch_replicator app as a check that my understanding matches everyone elses. And if so we can add that as a README in the application folder. Once I'm done there I'll actually pull and compile and run the test suite though I'm assuming that's already happened quite a lot but I'll also look at coverage and consider any tests that should be added for anything that's lacking significant coverage and is non-trivial.\r\n\r\nAwesome work on this everyone!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293084277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293127587","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-293127587","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":293127587,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MzEyNzU4Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-11T01:57:12Z","updated_at":"2017-04-11T01:57:12Z","author_association":"CONTRIBUTOR","body":"Many thanks @davisp for taking a look at this. \r\n\r\nWith your help found some sneaky bugs and a added number of great improvements.\r\n\r\nNow on the idea of how to simplify the doc processor (as in remove the complicated bit). I remember I was wondering at some point what if scheduler operated on documents instead of replication jobs. So the {DbName, DocId} becomes the Job ID and we use the scheduler to track and manage the lifecycle of \"when scheduled get replication ID (or check if changed), then start a replication job, and so on\" But that scheme got kind of complicated as well. It might have been less code overall but it would have been even harder to decipher.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/293127587/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294248839","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-294248839","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":294248839,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDI0ODgzOQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-14T22:30:35Z","updated_at":"2017-04-14T22:30:35Z","author_association":"MEMBER","body":"Also, I've opened this PR for anyone to review but I am gonna do more tests to verify. I originally wrote and tested these changes on top of pluggable storage engine work so in the interest of thoroughness I'll duplicate my testing on master vs this PR and will post results of that data.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294248839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294534383","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-294534383","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":294534383,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDUzNDM4Mw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-17T17:25:30Z","updated_at":"2017-04-18T05:29:58Z","author_association":"CONTRIBUTOR","body":"Used this script to create a stampede\r\n\r\n```\r\n#!/usr/bin/env python\r\n\r\nimport sys, couchdb, time, os, threading, uuid\r\nfrom multiprocessing.dummy import Pool as ThreadPool\r\n\r\nDB_URL='http://adm:pass@localhost:15984'\r\nDB_NAME = 'zag'\r\n\r\ndef worker((wid, event,  dbname)):\r\n    srv = couchdb.Server(DB_URL)\r\n    event.wait()\r\n    db = srv[dbname]\r\n    db[uuid.uuid4().hex] = {}\r\n    return wid\r\n\r\ndef main(dbname, wcount):\r\n    print \"DB URL:\",DB_URL,\"DB Name:\",dbname, \"wcount:\",wcount\r\n    pool = ThreadPool(wcount)\r\n    event = threading.Event()\r\n    try:\r\n        while True:\r\n            event.set()\r\n            args = [(wid, event, dbname) for wid in xrange(wcount)]\r\n            asyncres = pool.map_async(worker, args)\r\n            time.sleep(3)\r\n            print \"Ready to stampede\"\r\n            raw_input(\"Press any key when read:\")\r\n            event.clear()\r\n            print \"Send event\"\r\n            print \"Getting results (max wait = 5min)\"\r\n            print \"Got\", len(asyncres.get(300)), \"results\"\r\n            print\r\n    except (KeyboardInterrupt, SystemExit):\r\n        print \"closing pool\"\r\n        pool.join()\r\n        pool.close()\r\n\r\nif __name__=='__main__':\r\n    args=sys.argv[1:]\r\n    if len(args)==1:\r\n        wcount = int(args[0])\r\n        print \">>> wcount:\", wcount\r\n        dbname = DB_NAME\r\n    elif len(args)==2:\r\n        dbname, wcount = args[0], int(args[1])\r\n        print \">>> dbname:\", dbname, \"wcount:\", wcount\r\n    else:\r\n        raise Exception(\"Invalid arguments need dbname, numbatches, batchsize\")\r\n    main(dbname, wcount)\r\n```\r\n\r\nIt has strange bits as I copied another script I had. Used some large \r\n\r\nI was (probably foolishly) using`gen_server:multi_call(mem3_shards, shard_db_changed).` to clear the cache. After a while noticed dead writers in ?OPENERS which table was preventing new writers from being  created.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294534383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294545270","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-294545270","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":294545270,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDU0NTI3MA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-17T18:04:38Z","updated_at":"2017-04-17T18:04:38Z","author_association":"CONTRIBUTOR","body":"So it is not spawn link but workers are still not being cleaned it seems:\r\n\r\n```\r\n(node1@127.0.0.1)14> ets:tab2list(mem3_openers).\r\n[{<<\"foo\">>,<0.6748.0>},\r\n {<<\"_users\">>,<0.432.0>},\r\n {<<\"_global_changes\">>,<0.772.0>},\r\n {<<\"_replicator\">>,<0.489.0>}]\r\n(node1@127.0.0.1)15> erlang:is_process_alive(erlang:list_to_pid(\"<0.6748.0>\")).\r\nfalse\r\n```\r\n\r\nThis is after waiting for a while as well (5 minutes +).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294545270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294568118","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-294568118","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":294568118,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDU2ODExOA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-17T19:34:47Z","updated_at":"2017-04-17T19:34:47Z","author_association":"MEMBER","body":"Awesome work on this only had a couple notes after the README stuff. The new fabric stuff looks awesome.\r\n\r\n+1 once the README bits and the few other notes are addressed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294568118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294687262","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-294687262","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":294687262,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDY4NzI2Mg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T05:28:55Z","updated_at":"2017-04-18T14:17:30Z","author_association":"CONTRIBUTOR","body":"As promised, unit tests and also ets:delete_object fix:\r\n\r\nhttps://github.com/apache/couchdb/pull/479\r\n\r\nI hear we like PRs. So I made a PR for your PR. So you can PR while you PR.\r\n\r\n@jaydoane if you had some tests too, throw those in the ring in as well. The more, the merrier!\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294687262/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294860357","html_url":"https://github.com/apache/couchdb/pull/478#issuecomment-294860357","issue_url":"https://api.github.com/repos/apache/couchdb/issues/478","id":294860357,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDg2MDM1Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T14:22:01Z","updated_at":"2017-04-18T14:22:01Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294860357/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294903045","html_url":"https://github.com/apache/couchdb/pull/479#issuecomment-294903045","issue_url":"https://api.github.com/repos/apache/couchdb/issues/479","id":294903045,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDkwMzA0NQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T16:35:07Z","updated_at":"2017-04-18T16:35:07Z","author_association":"MEMBER","body":"Thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294903045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294922249","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-294922249","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":294922249,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDkyMjI0OQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T17:37:28Z","updated_at":"2017-04-18T17:37:28Z","author_association":"MEMBER","body":"Here's the relevant output from a suite of benchmarks I ran yesterday. The basic benchmark is to spawn 200 workers that write documents as fast as possible to a single clustered database. This benchmark uses four physical machines (one test generator, one load balancer, and a standard three node cluster) so its not bound by everything fighting on my laptop or anything. The benchmark reports that get generated are fairly lengthy and complete so I've just pulled out the relevant data for mem3_shards. If anyone wants to see more data feel free to ask and I can provide an entire ipynb that has everything down to 1s metric resolution of per-core CPU usage and entropy levels. :D\r\n\r\nOne of the neat bits of our benchmark setup is that we can setup a number of variables to vary and re-run benchmarks over the permutations. So below the A and B variables are what was varied. Its a bit confusing at first but once you read them a couple times it gets easier to see what's going on.\r\n\r\nFor this test I had two parameters, the version of CouchDB we're running and the value of Q for the database that's being written to. So our parameters are:\r\n\r\n<table>\r\n  <tr>\r\n    <th>Name</th>\r\n    <th>Variables</th>\r\n    <th>Values</th>\r\n  </tr>\r\n  <tr>\r\n    <td>Version</td>\r\n    <td>[A0, A1]</td>\r\n     <td>[5986, 6015]</td>\r\n  </tr>\r\n  <tr>\r\n    <td>CB_DB_Q</td>\r\n    <td>[B0, B1, B2]</td>\r\n    <td>[8.0, 64.0, 256.0]</td>\r\n  </tr>\r\n</table>\r\n\r\nOr in other words, I ran the same PUT docs benchmark against a database with Q=8, 64, and 256 for two versions of CouchDB: 5986 and 6015. Each benchmark run is for three minutes as our concern here is just the thundering herd at startup.\r\n\r\nThose version numbers are just Jenkins build numbers but they correspond to these two commits:\r\n\r\n5986: https://github.com/apache/couchdb/commit/5bd0b652788cc78eb05c78229d89bf74a70f9c00\r\n6015: https://github.com/apache/couchdb/pull/476/commits/a9b2ef2995d795167e8291c2d337c72c4f5f6893\r\n\r\nWhich are just master as of the other day and that same master with my mem3_shards change (and the unrelated commit `chmod +x couchspawnkillable.sh` which is harmless since these tests aren't testing couchjs stuff at all).\r\n\r\nSo, that's 6 benchmark permutations. For each of those 6 permutations I repeated the benchmark five times to ensure that we had a good picture of the behavior for each permutation. So in the following two graphs each of the box and whiskers represent the results for five runs for the given permutation.\r\n\r\nAlso, the box and whisker plots are color coded based on the version of CouchDB so that its easier to see the permutations. Red is 5986 and green is 6015. Luckily there's not much in these graphs that isn't obvious so we don't have to worry about those being bad colors for graphical analysis.\r\n\r\n![group-report-total-ops](https://cloud.githubusercontent.com/assets/19929/25143614/b93938ec-2430-11e7-8829-9096fb50bc9e.png)\r\n\r\nThis is the total number of operations done over the three minute benchmark. Reading the graph left to right this basically means, for Q=8 and 64, before and after are basically identical. But at Q=256 CouchDB performance gets terrible but is fixed with the mem3_shards change.\r\n\r\n![group-report-median-latency](https://cloud.githubusercontent.com/assets/19929/25143626/be4096b4-2430-11e7-9560-a96f20788927.png)\r\n\r\nThe second graph is *median* latency and shows us basically the same thing. Performance is nearly identical on Q=8 and 64 but master blows up with Q=256.\r\n\r\nThe next step is to look at a run from each of the two Q=256 run groups. Rather than overload this report with data I took the *best* run from master and am comparing it to the *worst* run with the mem3_shards fix. So basically this is the least favorable comparison for this PR change given the 25 different ways we could have compared pairwise. Though as you'll see it doesn't really matter...\r\n\r\nFor 5986:\r\n\r\n![b2-a0-mem3-shards-message-queue-len](https://cloud.githubusercontent.com/assets/19929/25143964/edc5e578-2431-11e7-957c-7e0d4d28990a.png)\r\n\r\nFor 6015:\r\n\r\n![b2-a1-mem3-shards-message-queue-len](https://cloud.githubusercontent.com/assets/19929/25143968/f076e98e-2431-11e7-8140-ba3f7261a72e.png)\r\n\r\nFirst up is a graph of the message queue lengths on mem3_shards during the benchmark. The graphs a bit hard to read from the render, but the shapes should be obvious. On 5986 mem3_shards backs up to nearly 90K messages. For 6015 there's no backup and the maximum message queue spike is to 72 messages on db1.\r\n\r\nFor 5986:\r\n\r\n![b2-a0-mem3-shard-chache-stats](https://cloud.githubusercontent.com/assets/19929/25144066/3ecadd52-2432-11e7-9260-4a0f78dd575c.png)\r\n\r\nFor 6015:\r\n\r\n![b2-a1-mem3-shard-cache-stats](https://cloud.githubusercontent.com/assets/19929/25144085/49046770-2432-11e7-8548-9a8301a0e4ae.png)\r\n\r\nLastly, the cache hit/miss rates between 5986 and 6015. Obviously on 5986 the cache is broken and the hit/miss rate is idling near 0. Given that these benchmarks are against a single database this is wrong. The database should be cached once when the benchmark starts and the hit rate will be at about the requests per second volume. This is what the graph for 6015 shows which indicates we've corrected the behavior.\r\n\r\nFor background the reason this happens is that the thundering herd starts up and all the workers have a cache miss so they all load the shard map from disk. When Q=256 the shard map is around 100KiB. When a few hundred clients gang up and all throw this at mem3_shards at once it suddenly has tens of megabytes in its message queue. When it reads a message from its queue the whole queue is copied onto the process heap which means its suddenly garbage collecting tens of megabytes of heap which basically causes it to slow to a halt. We've seen similar issues with couch_server under huge load. With the release of Erlang 19 there's a new option to not copy messages onto the heap which would help us here (however we support older VMs so that can't be our fix).\r\n\r\nThe fix in this PR is to use a temporary process to make the shard map copy outside of mem3_shards so that its heap doesn't blow up. And since we have to track those temporary processes we can also prevent multiple messages for the same shard map which cuts down on the message rates for mem3_shards during these thundering herd spikes.\r\n\r\nSo hopefully that wall of text is not overly confusing and shows that this is a pretty definitive improvement. Performance related changes are always a bit hard to nail down but with the benchmark data I think this is a pretty definitive improvement without any sort of regression for smaller values of Q.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294922249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294925807","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-294925807","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":294925807,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDkyNTgwNw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T17:47:47Z","updated_at":"2017-04-18T17:47:47Z","author_association":"CONTRIBUTOR","body":"+1 Very nice work.\r\n\r\nI like the pattern of using a separate single worker. Gotta remember it for the future.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294925807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294949056","html_url":"https://github.com/apache/couchdb/pull/482#issuecomment-294949056","issue_url":"https://api.github.com/repos/apache/couchdb/issues/482","id":294949056,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk0OTA1Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T19:08:28Z","updated_at":"2017-04-18T19:08:28Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294949056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294952810","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-294952810","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":294952810,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk1MjgxMA==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T19:23:02Z","updated_at":"2017-04-18T19:23:02Z","author_association":"CONTRIBUTOR","body":"I agree with @nickva that the \"writer process\" pattern is very cool, and probably worthy of a blog post.\r\n\r\nFWIW, the code looks great, and the tests all pass for me:\r\n```\r\n======================== EUnit ========================\r\nmodule 'mem3_shards'\r\n  mem3_shards:557: t_maybe_spawn_shard_writer_already_exists...[0.001 s] ok\r\n  mem3_shards:566: t_maybe_spawn_shard_writer_new...ok\r\n  mem3_shards:579: t_flush_writer_exists_normal...ok\r\n  mem3_shards:588: t_flush_writer_times_out...[0.106 s] ok\r\n  mem3_shards:597: t_flush_writer_crashes...ok\r\n  mem3_shards:605: t_writer_deletes_itself_when_done...ok\r\n  mem3_shards:618: t_writer_does_not_delete_other_writers_for_same_shard...ok\r\n  mem3_shards:633: t_spawn_writer_in_load_shards_from_db...[0.807 s] ok\r\n  mem3_shards:654: t_cache_insert_takes_new_update...ok\r\n  mem3_shards:666: t_cache_insert_ignores_stale_update_and_kills_worker...ok\r\n  [done in 2.302 s]\r\n=======================================================\r\n  All 10 tests passed.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294952810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294955139","html_url":"https://github.com/apache/couchdb/pull/481#issuecomment-294955139","issue_url":"https://api.github.com/repos/apache/couchdb/issues/481","id":294955139,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk1NTEzOQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T19:32:20Z","updated_at":"2017-04-18T19:32:20Z","author_association":"MEMBER","body":"That test failure is an unrelated JS test. 7 of 8 attempts passed the test.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294955139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294957847","html_url":"https://github.com/apache/couchdb/pull/481#issuecomment-294957847","issue_url":"https://api.github.com/repos/apache/couchdb/issues/481","id":294957847,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk1Nzg0Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T19:43:35Z","updated_at":"2017-04-18T19:43:35Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294957847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294970194","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-294970194","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":294970194,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk3MDE5NA==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T20:25:28Z","updated_at":"2017-04-18T20:25:28Z","author_association":"CONTRIBUTOR","body":"Great report! I personally learned a lot from it!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294970194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294976512","html_url":"https://github.com/apache/couchdb/pull/480#issuecomment-294976512","issue_url":"https://api.github.com/repos/apache/couchdb/issues/480","id":294976512,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk3NjUxMg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T20:45:35Z","updated_at":"2017-04-18T20:45:35Z","author_association":"CONTRIBUTOR","body":"Get this error\r\n\r\n```\r\nERROR: Failed to load /Users/nvatama/asf2/src/mango/rebar.config: {error,\r\n                                                                   {26,file,\r\n                                                                    {error,\r\n                                                                     undef,\r\n                                                                     [{lists,\r\n                                                                       keystore,\r\n                                                                       [erl_opts,\r\n                                                                        1,\r\n                                                                        {erl_opts,\r\n                                                                         [{d,\r\n                                                                           'HAVE_DREYFUS'}]}],\r\n                                                                       []},\r\n                                                                      {erl_eval,\r\n                                                                       do_apply,\r\n                                                                       6,\r\n                                                                       [{file,\r\n                                                                         \"erl_eval.erl\"},\r\n                                                                        {line,\r\n                                                                         670}]},\r\n                                                                      {file,\r\n                                                                       eval_stream2,\r\n                                                                       6,\r\n                                                                       [{file,\r\n                                                                         \"file.erl\"},\r\n                                                                        {line,\r\n                                                                         1386}]},\r\n                                                                      {file,\r\n                                                                       script,\r\n                                                                       2,\r\n                                                                       [{file,\r\n                                                                         \"file.erl\"},\r\n                                                                        {line,\r\n                                                                         1086}]},\r\n                                                                      {rebar_config,\r\n                                                                       new,2,\r\n                                                                       [{file,\r\n                                                                         \"src/rebar_config.erl\"},\r\n                                                                        {line,\r\n                                                                         238}]},\r\n                                                                      {rebar_core,\r\n                                                                       process_dir,\r\n                                                                       4,\r\n                                                                       [{file,\r\n                                                                         \"src/rebar_core.erl\"},\r\n                                                                        {line,\r\n                                                                         131}]},\r\n                                                                      {rebar_core,\r\n                                                                       process_each,\r\n                                                                       5,\r\n                                                                       [{file,\r\n                                                                         \"src/rebar_core.erl\"},\r\n                                                                        {line,\r\n                                                                         351}]},\r\n                                                                      {rebar_core,\r\n                                                                       process_dir1,\r\n                                                                       7,\r\n                                                                       [{file,\r\n                                                                         \"src/rebar_core.erl\"},\r\n                                                                        {line,\r\n                                                                         253}]}]}}}\r\n\r\n```\r\n\r\nThis seems to fix the issue:\r\n\r\n```\r\n lists:keystore(erl_opts, 1, CONFIG, {erl_opts, NewOpts}),\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294976512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294977119","html_url":"https://github.com/apache/couchdb/pull/480#issuecomment-294977119","issue_url":"https://api.github.com/repos/apache/couchdb/issues/480","id":294977119,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk3NzExOQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T20:47:33Z","updated_at":"2017-04-18T20:47:33Z","author_association":"MEMBER","body":"Yeap. Silly mistake.\r\n\r\nAlso went back and double checked how our build system does Dreyfus work and realized that the relative file path is quite dumb since people may want to be able to pull dreyfus in without having ot modify couchdb in a build chain. I managed to find a much cleaner check for dreyfus so updating that as well.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294977119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294979669","html_url":"https://github.com/apache/couchdb/pull/480#issuecomment-294979669","issue_url":"https://api.github.com/repos/apache/couchdb/issues/480","id":294979669,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk3OTY2OQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T20:55:21Z","updated_at":"2017-04-18T20:55:21Z","author_association":"MEMBER","body":"Updated. Fixed the silly lists:keystore mistake and replaced the relative paths with a `code:lib_dir(dreyfus)` check instead which is more robust than requiring dreyfus in a specific place on the filesystem.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294979669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294981458","html_url":"https://github.com/apache/couchdb/pull/480#issuecomment-294981458","issue_url":"https://api.github.com/repos/apache/couchdb/issues/480","id":294981458,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk4MTQ1OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T21:01:11Z","updated_at":"2017-04-18T21:01:11Z","author_association":"CONTRIBUTOR","body":"Default:\r\n\r\n```\r\n1> l(mango_cursor).\r\n{module,mango_cursor}\r\n2> mango_cursor:module_info().\r\n[{module,mango_cursor},\r\n {exports,[{create,3},\r\n           {explain,1},\r\n           {execute,3},\r\n           {maybe_filter_indexes,2},\r\n           {module_info,0},\r\n           {module_info,1}]},\r\n {attributes,[{vsn,[144027518958084404948992969280201332310]}]},\r\n {compile,[{options,[{outdir,\"ebin\"},\r\n                     debug_info,debug_info,\r\n                     {i,\"../\"},\r\n                     {i,\"include\"}]},\r\n           {version,\"7.0.3\"},\r\n           {source,\"/Users/nvatama/asf2/src/mango/src/mango_cursor.erl\"}]},\r\n {native,false},\r\n {md5,<<108,90,176,239,182,81,16,121,233,213,38,200,90,\r\n        22,150,86>>}]\r\n```\r\n\r\nwith Dreyfus dep:\r\n\r\n```\r\ndiff --git a/rebar.config.script b/rebar.config.script\r\nindex 201cc0c0e..a1e516dc8 100644\r\n--- a/rebar.config.script\r\n+++ b/rebar.config.script\r\n@@ -57,6 +57,8 @@ DepDescs = [\r\n %% Non-Erlang deps\r\n {docs,             {url, \"https://github.com/apache/couchdb-documentation\"},\r\n                    \"3b15a7cb5e1958bc71ac865b56d3081ab43f5942\", [raw]},\r\n+{dreyfus,          {url, \"git@github.com:cloudant-labs/dreyfus\"},\r\n+                  \"960725070dc75916d8ed4a24e8a7bbc208cbe1cd\"},\r\n {fauxton,          {url, \"https://github.com/apache/couchdb-fauxton\"},\r\n                   {tag, \"v1.1.11\"}, [raw]},\r\n %% Third party deps\r\n```\r\n\r\n```\r\n1> l(mango_cursor).\r\n{module,mango_cursor}\r\n2> mango_cursor:module_info().\r\n[{module,mango_cursor},\r\n {exports,[{create,3},\r\n           {explain,1},\r\n           {execute,3},\r\n           {maybe_filter_indexes,2},\r\n           {module_info,0},\r\n           {module_info,1}]},\r\n {attributes,[{vsn,[65408884502798159025533969682876367424]}]},\r\n {compile,[{options,[{outdir,\"ebin\"},\r\n                     debug_info,\r\n                     {d,'HAVE_DREYFUS'},\r\n                     {i,\"include\"}]},\r\n           {version,\"7.0.3\"},\r\n           {source,\"/Users/nvatama/asf2/src/mango/src/mango_cursor.erl\"}]},\r\n {native,false},\r\n {md5,<<49,53,74,253,105,250,209,249,34,62,28,25,96,208,\r\n        130,64>>}]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294981458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294981476","html_url":"https://github.com/apache/couchdb/pull/480#issuecomment-294981476","issue_url":"https://api.github.com/repos/apache/couchdb/issues/480","id":294981476,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDk4MTQ3Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-18T21:01:15Z","updated_at":"2017-04-18T21:01:15Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/294981476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/295531894","html_url":"https://github.com/apache/couchdb/pull/477#issuecomment-295531894","issue_url":"https://api.github.com/repos/apache/couchdb/issues/477","id":295531894,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NTUzMTg5NA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-20T01:29:28Z","updated_at":"2017-04-20T01:29:28Z","author_association":"CONTRIBUTOR","body":"hmmm got  failure for the test soft\r\n\r\n```\r\n  Test the view index LRU\r\n    couch_index_lru_tests:61: test_close_while_compacting...[0.265 s] ok\r\n    couch_index_lru_tests:130: test_soft_max...*failed*\r\nin function gen_server:call/3 (gen_server.erl, line 190)\r\nin call from couch_index_server:get_index/2 (src/couch_index_server.erl, line 182)\r\nin call from lists:map/2 (lists.erl, line 1237)\r\nin call from couch_index_lru_tests:'-test_soft_max/1-fun-11-'/1 (test/couch_index_lru_tests.erl, line 156)\r\n**exit:{badarg,\r\n    {gen_server,call,\r\n        [couch_index_server,\r\n         {get_index,\r\n             {test_index,\r\n                 {test_idx,<<\"eunit-test-db-1492651861\"...>>,\r\n                     {<<\"_design/i1\">>},\r\n                     <<\"CzF??\"...>>},\r\n                 <<\"eunit-test-db-14926518618861\"...>>,\r\n                 <<67,122,70,243,220,127,...>>}},\r\n         infinity]}}\r\n```\r\nWill take a look a little later tonight","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/295531894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/295533005","html_url":"https://github.com/apache/couchdb/pull/477#issuecomment-295533005","issue_url":"https://api.github.com/repos/apache/couchdb/issues/477","id":295533005,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NTUzMzAwNQ==","user":{"login":"sagelywizard","id":167249,"node_id":"MDQ6VXNlcjE2NzI0OQ==","avatar_url":"https://avatars.githubusercontent.com/u/167249?v=4","gravatar_id":"","url":"https://api.github.com/users/sagelywizard","html_url":"https://github.com/sagelywizard","followers_url":"https://api.github.com/users/sagelywizard/followers","following_url":"https://api.github.com/users/sagelywizard/following{/other_user}","gists_url":"https://api.github.com/users/sagelywizard/gists{/gist_id}","starred_url":"https://api.github.com/users/sagelywizard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sagelywizard/subscriptions","organizations_url":"https://api.github.com/users/sagelywizard/orgs","repos_url":"https://api.github.com/users/sagelywizard/repos","events_url":"https://api.github.com/users/sagelywizard/events{/privacy}","received_events_url":"https://api.github.com/users/sagelywizard/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-20T01:32:56Z","updated_at":"2017-04-20T01:32:56Z","author_association":"MEMBER","body":"Yeah, I saw that. I think it's a problem with meck. Let me know if you figure it out.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/295533005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296071370","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-296071370","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":296071370,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjA3MTM3MA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-21T05:21:56Z","updated_at":"2017-04-21T05:21:56Z","author_association":"CONTRIBUTOR","body":"anyone else get this error when running the mem3 suite:\r\n\r\n```\r\nin function meck_proc:wait/6 (src/meck_proc.erl, line 169)\r\nin call from mem3_sync_event_listener:'-should_restart_listener/1-fun-0-'/0 (src/mem3_sync_event_listener.erl, line 277)\r\n**error:timeout\r\n\r\n\r\n    mem3_sync_event_listener:282: should_terminate...[0.053 s] ok\r\n```\r\n? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296071370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296198850","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-296198850","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":296198850,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjE5ODg1MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-21T14:01:52Z","updated_at":"2017-04-21T14:01:52Z","author_association":"MEMBER","body":"This is very impressive, thanks for the hard work and diligent explanation!\r\n\r\n+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296198850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296216602","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-296216602","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":296216602,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjIxNjYwMg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-21T15:05:54Z","updated_at":"2017-04-21T15:05:54Z","author_association":"MEMBER","body":"@tonysun83 I assume you were running make check apps=mem3 or similar? That failing unit test should be fixed on master as of this commit:\r\n\r\nhttps://github.com/apache/couchdb/commit/c0fda54d3ed4f06f1e41db598859de23aaf0e3ac","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296216602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296228469","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-296228469","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":296228469,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjIyODQ2OQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-21T15:49:46Z","updated_at":"2017-04-21T15:49:46Z","author_association":"MEMBER","body":"@tonysun83 After adding those config options I went ahead and rebased this on master so that failing test is fixed on this branch as well.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296228469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296251199","html_url":"https://github.com/apache/couchdb/pull/483#issuecomment-296251199","issue_url":"https://api.github.com/repos/apache/couchdb/issues/483","id":296251199,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjI1MTE5OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-21T17:18:48Z","updated_at":"2017-04-21T17:18:48Z","author_association":"MEMBER","body":"Thanks @janl. I'll correct a few of the more straightforward tweaks today.\r\n\r\nI'd like to get feedback from at least a couple of people trying the script (other than me!) before merging, but if no one responds on user@ or dev@ by middle of next week, I'll merge anyway.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296251199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296252888","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-296252888","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":296252888,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjI1Mjg4OA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-21T17:25:58Z","updated_at":"2017-04-21T17:25:58Z","author_association":"CONTRIBUTOR","body":"tests pass for me now after rebase, +1, awesome analysis with the boxplots","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296252888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296312054","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-296312054","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":296312054,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjMxMjA1NA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-21T21:41:53Z","updated_at":"2017-04-21T21:41:53Z","author_association":"CONTRIBUTOR","body":"foundings -> findings ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296312054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296315646","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-296315646","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":296315646,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjMxNTY0Ng==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-21T22:01:45Z","updated_at":"2017-04-21T22:01:45Z","author_association":"CONTRIBUTOR","body":"Tests pass locally \r\n```\r\n======================== EUnit ========================\r\nmodule 'json_stream_parse'\r\nmodule 'couch_replicator_worker'\r\nmodule 'couch_replicator_utils'\r\nmodule 'couch_replicator_test_helper'\r\nmodule 'couch_replicator_sup'\r\nmodule 'couch_replicator_stats'\r\nmodule 'couch_replicator_small_max_request_size_target'\r\nmodule 'couch_replicator_scheduler_sup'\r\nmodule 'couch_replicator_scheduler_job'\r\nmodule 'couch_replicator_scheduler'\r\nmodule 'couch_replicator_rate_limiter_tables'\r\nmodule 'couch_replicator_rate_limiter'\r\nmodule 'couch_replicator_rate_limiter_tests'\r\nmodule 'couch_replicator_notifier'\r\nmodule 'couch_replicator_manager'\r\nmodule 'couch_replicator_job_sup'\r\nmodule 'couch_replicator_ids'\r\nmodule 'couch_replicator_httpd_util'\r\nmodule 'couch_replicator_httpd'\r\nmodule 'couch_replicator_httpc_pool'\r\nmodule 'couch_replicator_httpc_pool_tests'\r\nmodule 'couch_replicator_httpc'\r\nmodule 'couch_replicator_filters'\r\nmodule 'couch_replicator_fabric_rpc'\r\nmodule 'couch_replicator_fabric'\r\nmodule 'couch_replicator_docs'\r\nmodule 'couch_replicator_doc_processor_worker'\r\nmodule 'couch_replicator_doc_processor'\r\nmodule 'couch_replicator_db_changes'\r\nmodule 'couch_replicator_connection'\r\nmodule 'couch_replicator_connection_tests'\r\nmodule 'couch_replicator_clustering'\r\nmodule 'couch_replicator_changes_reader'\r\nmodule 'couch_replicator_app'\r\nmodule 'couch_replicator'\r\nmodule 'couch_replicator_use_checkpoints_tests'\r\nmodule 'couch_replicator_selector_tests'\r\nmodule 'couch_replicator_proxy_tests'\r\nmodule 'couch_replicator_modules_load_tests'\r\nmodule 'couch_replicator_missing_stubs_tests'\r\nmodule 'couch_replicator_many_leaves_tests'\r\nmodule 'couch_replicator_large_atts_tests'\r\nmodule 'couch_replicator_id_too_long_tests'\r\nmodule 'couch_replicator_filtered_tests'\r\nmodule 'couch_replicator_compact_tests'\r\n=======================================================\r\n  All 300 tests passed.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296315646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296414417","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-296414417","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":296414417,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjQxNDQxNw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-23T02:11:25Z","updated_at":"2017-04-23T02:11:25Z","author_association":"CONTRIBUTOR","body":"@davisp @iilyak @sagelywizard @tonysun83  Thanks again for taking a look. Really appreciate your time. This was no small PR.  There were a lot of good suggestions from you all and we improved the code quite a bit as a result.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296414417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296659661","html_url":"https://github.com/apache/couchdb/pull/487#issuecomment-296659661","issue_url":"https://api.github.com/repos/apache/couchdb/issues/487","id":296659661,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjY1OTY2MQ==","user":{"login":"ianpartridge","id":1423497,"node_id":"MDQ6VXNlcjE0MjM0OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1423497?v=4","gravatar_id":"","url":"https://api.github.com/users/ianpartridge","html_url":"https://github.com/ianpartridge","followers_url":"https://api.github.com/users/ianpartridge/followers","following_url":"https://api.github.com/users/ianpartridge/following{/other_user}","gists_url":"https://api.github.com/users/ianpartridge/gists{/gist_id}","starred_url":"https://api.github.com/users/ianpartridge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ianpartridge/subscriptions","organizations_url":"https://api.github.com/users/ianpartridge/orgs","repos_url":"https://api.github.com/users/ianpartridge/repos","events_url":"https://api.github.com/users/ianpartridge/events{/privacy}","received_events_url":"https://api.github.com/users/ianpartridge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-24T13:01:11Z","updated_at":"2017-04-24T13:01:11Z","author_association":"NONE","body":"Passing `--disable-fauxton` to `configure` also works around this problem.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296659661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296814041","html_url":"https://github.com/apache/couchdb/pull/488#issuecomment-296814041","issue_url":"https://api.github.com/repos/apache/couchdb/issues/488","id":296814041,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjgxNDA0MQ==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-24T20:34:19Z","updated_at":"2017-04-24T20:35:58Z","author_association":"CONTRIBUTOR","body":"+1. \r\nThis was reviewed earlier here https://github.com/apache/couchdb-couch-mrview/pull/72.\r\nThis is a redo of the PR for mono repository structure.\r\nTests pass locally against this branch as well.\r\n```\r\nCompiled test/couch_mrview_ddoc_validation_tests.erl\r\n    Running test function(s):\r\n      couch_mrview_all_docs_tests:all_docs_test_/0\r\n      couch_mrview_local_docs_tests:all_docs_test_/0\r\n======================== EUnit ========================\r\n_local_docs view tests\r\n  couch_mrview_local_docs_tests:68: should_query...ok\r\n  couch_mrview_local_docs_tests:81: should_query_with_range...ok\r\n  couch_mrview_local_docs_tests:95: should_query_with_range_rev...ok\r\n  couch_mrview_local_docs_tests:109: should_query_with_limit_and_skip...ok\r\n  couch_mrview_local_docs_tests:123: should_query_with_include_docs...ok\r\n  [done in 0.152 s]\r\n_all_docs view tests\r\n  couch_mrview_all_docs_tests:70: should_query...ok\r\n  couch_mrview_all_docs_tests:80: should_query_with_range...ok\r\n  couch_mrview_all_docs_tests:94: should_query_with_range_rev...ok\r\n  couch_mrview_all_docs_tests:108: should_query_with_limit_and_skip...ok\r\n  couch_mrview_all_docs_tests:126: should_query_with_include_docs...ok\r\n  couch_mrview_all_docs_tests:133: should_query_empty_views...ok\r\n  [done in 0.422 s]\r\n=======================================================\r\n  All 11 tests passed.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296814041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296928735","html_url":"https://github.com/apache/couchdb/pull/469#issuecomment-296928735","issue_url":"https://api.github.com/repos/apache/couchdb/issues/469","id":296928735,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjkyODczNQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-25T06:34:30Z","updated_at":"2017-04-25T06:34:41Z","author_association":"CONTRIBUTOR","body":"Good work @garrensmith, +1 for me.  @davisp  way want to double check","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296928735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296931031","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-296931031","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":296931031,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjkzMTAzMQ==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-25T06:46:36Z","updated_at":"2017-04-25T06:46:36Z","author_association":"CONTRIBUTOR","body":"I ran the dyno tests against a cluster that rate limits and was able to get replication completed with ten concurrent replications for 50K docs. I really like the history for ```_scheduler/jobs```:\r\n\r\n```\r\n\"history\": [\r\n                {\r\n                    \"timestamp\": \"2017-04-25T06:20:30Z\",\r\n                    \"type\": \"started\"\r\n                },\r\n                {\r\n                    \"timestamp\": \"2017-04-25T06:20:30Z\",\r\n                    \"type\": \"crashed\",\r\n                    \"reason\": \"max_backoff\"\r\n                },\r\n                {\r\n                    \"timestamp\": \"2017-04-25T05:12:12Z\",\r\n                    \"type\": \"started\"\r\n                },\r\n                {\r\n                    \"timestamp\": \"2017-04-25T05:12:12Z\",\r\n                    \"type\": \"crashed\",\r\n                    \"reason\": \"max_backoff\"\r\n                },\r\n                {\r\n                    \"timestamp\": \"2017-04-25T05:03:15Z\",\r\n                    \"type\": \"started\"\r\n                },\r\n                {\r\n                    \"timestamp\": \"2017-04-25T05:03:15Z\",\r\n                    \"type\": \"added\"\r\n                }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/296931031/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297048291","html_url":"https://github.com/apache/couchdb/pull/489#issuecomment-297048291","issue_url":"https://api.github.com/repos/apache/couchdb/issues/489","id":297048291,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzA0ODI5MQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-25T14:29:12Z","updated_at":"2017-04-25T14:29:12Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297048291/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297163184","html_url":"https://github.com/apache/couchdb/pull/476#issuecomment-297163184","issue_url":"https://api.github.com/repos/apache/couchdb/issues/476","id":297163184,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzE2MzE4NA==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-25T20:59:30Z","updated_at":"2017-04-25T20:59:30Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297163184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297231810","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-297231810","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":297231810,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzIzMTgxMA==","user":{"login":"redgeoff","id":3378986,"node_id":"MDQ6VXNlcjMzNzg5ODY=","avatar_url":"https://avatars.githubusercontent.com/u/3378986?v=4","gravatar_id":"","url":"https://api.github.com/users/redgeoff","html_url":"https://github.com/redgeoff","followers_url":"https://api.github.com/users/redgeoff/followers","following_url":"https://api.github.com/users/redgeoff/following{/other_user}","gists_url":"https://api.github.com/users/redgeoff/gists{/gist_id}","starred_url":"https://api.github.com/users/redgeoff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/redgeoff/subscriptions","organizations_url":"https://api.github.com/users/redgeoff/orgs","repos_url":"https://api.github.com/users/redgeoff/repos","events_url":"https://api.github.com/users/redgeoff/events{/privacy}","received_events_url":"https://api.github.com/users/redgeoff/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-26T04:03:18Z","updated_at":"2017-04-26T04:03:18Z","author_association":"CONTRIBUTOR","body":"Background: https://issues.apache.org/jira/browse/COUCHDB-3391\r\n\r\nSummary: I tested the max_jobs config and it doesn't appear to be working as I would expect. Sorry, if I missed a detail.\r\n\r\nSteps to reproduce:\r\n1. Pull and build https://github.com/apache/couchdb/pull/470\r\n2. Clone https://github.com/redgeoff/couchdb2-replicator-not-scalable-vagrant. I used vagrant to set up my test, but you should be able to run the tests outside a VM as well.\r\n3. Modify [couchdb2-replicator-not-scalable-vagrant/index.js](https://github.com/redgeoff/couchdb2-replicator-not-scalable-vagrant/blob/master/index.js) and replace localhost with the correct dev DB host\r\n4. Set the config replicator.max_jobs=10\r\n5. Run `npm run demo` (this just runs index.js)\r\n\r\n=> this results in `Unhandled rejection Error: internal_server_error` errors. If you were to modify https://github.com/redgeoff/couchdb2-replicator-not-scalable-vagrant/blob/master/index.js#L10 and use a smaller number, e.g. 10 then there would be no issue as you would not exhaust the file descriptors and db connections. My assumption is that the `max_jobs` config should throttle the replications and prevent the DB from throwing errors.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297231810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297509024","html_url":"https://github.com/apache/couchdb/issues/491#issuecomment-297509024","issue_url":"https://api.github.com/repos/apache/couchdb/issues/491","id":297509024,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzUwOTAyNA==","user":{"login":"knpwrs","id":174864,"node_id":"MDQ6VXNlcjE3NDg2NA==","avatar_url":"https://avatars.githubusercontent.com/u/174864?v=4","gravatar_id":"","url":"https://api.github.com/users/knpwrs","html_url":"https://github.com/knpwrs","followers_url":"https://api.github.com/users/knpwrs/followers","following_url":"https://api.github.com/users/knpwrs/following{/other_user}","gists_url":"https://api.github.com/users/knpwrs/gists{/gist_id}","starred_url":"https://api.github.com/users/knpwrs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/knpwrs/subscriptions","organizations_url":"https://api.github.com/users/knpwrs/orgs","repos_url":"https://api.github.com/users/knpwrs/repos","events_url":"https://api.github.com/users/knpwrs/events{/privacy}","received_events_url":"https://api.github.com/users/knpwrs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-26T19:00:12Z","updated_at":"2017-04-26T19:00:12Z","author_association":"NONE","body":"After some more research, it appears that the features supported will depend on external factors making a table like what I suggested more difficult.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297509024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297515901","html_url":"https://github.com/apache/couchdb/pull/470#issuecomment-297515901","issue_url":"https://api.github.com/repos/apache/couchdb/issues/470","id":297515901,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzUxNTkwMQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-26T19:27:06Z","updated_at":"2017-04-26T19:28:48Z","author_association":"CONTRIBUTOR","body":"@redgeoff \r\n\r\nThanks for taking a look!\r\n\r\n`max_jobs` parameter would limit the number of running replication jobs at one time. File descriptors can be exhausted by other things not just replication tasks. In this case it is probably the databases opened. Also note each db by default is split into 8 shards (the `q` value). So that starts to add up.\r\n\r\nI gave your setup a try and got it to work with these settings:\r\n\r\n(I didn't try to minimize them, you can probably tweak them to find minimal values)\r\n\r\nFD limits:\r\n`$ ulimit  -n 8192`\r\n\r\nConfig settings:\r\n\r\n`couchdb.max_dbs_open = 3000`\r\n`cluster.q=1`\r\n`cluster.n=1`\r\n`replicator.max_jobs = 10`\r\n`replicator.worker_processes = 1`\r\n\r\nI put q=1, n=1 based on your use case in https://issues.apache.org/jira/browse/COUCHDB-3391\r\n\r\nWith all that set up. Started couch (I build a local scheduling replicator in Vagrant)\r\n\r\n```\r\ncouchdb@ubuntu-xenial:~/couchdb$ ./bin/couchdb\r\n[info] 2017-04-26T19:22:44.457066Z couchdb@localhost <0.7.0> -------- Application couch_log started on node couchdb@localhost\r\n...\r\n```\r\n\r\nCreated `_users` and `_replicator` dbs. I am not sure if your test does this. Here is how it looks:\r\n```\r\ncouchdb@ubuntu-xenial:/vagrant$ http put http://localhost:5984/_users\r\nHTTP/1.1 201 Created\r\n...\r\n\r\n{\r\n    \"ok\": true\r\n}\r\n\r\ncouchdb@ubuntu-xenial:/vagrant$ http put http://localhost:5984/_replicator\r\nHTTP/1.1 201 Created\r\n...\r\n\r\n{\r\n    \"ok\": true\r\n}\r\n```\r\n\r\nRan your demo:\r\n\r\n```\r\nnpm run demo\r\n\r\n> couchdb2-replicator-not-scalable-vagrant@0.0.1 demo /vagrant\r\n> ./index.js\r\n```\r\n\r\nwithout any errors.\r\n\r\nAnd finally showing off the states-based filtering:\r\n\r\n```\r\n$ http http://localhost:5984/_scheduler/docs?states=running\r\nHTTP/1.1 200 OK\r\n...\r\n\r\n{\r\n    \"docs\": [\r\n        {\r\n            \"database\": \"_replicator\",\r\n            \"doc_id\": \"7e801385699c0723d64ce2b684000378\",\r\n            \"error_count\": 0,\r\n            \"id\": \"2f691a8a3e337142691e7679e2c146a1+continuous\",\r\n            \"info\": null,\r\n            \"last_updated\": \"2017-04-26T19:14:07Z\",\r\n            \"node\": \"couchdb@localhost\",\r\n            \"proxy\": null,\r\n            \"source\": \"http://localhost:5984/test_1493234045679_2_a/\",\r\n            \"start_time\": \"2017-04-26T19:14:07Z\",\r\n            \"state\": \"running\",\r\n            \"target\": \"http://localhost:5984/test_1493234045679_2_b/\"\r\n        },\r\n        {\r\n            \"database\": \"_replicator\",\r\n            \"doc_id\": \"7e801385699c0723d64ce2b684001144\",\r\n            \"error_count\": 0,\r\n            \"id\": \"2f42b5ccbfb20e82d319054af8cb7828+continuous\",\r\n            \"info\": null,\r\n            \"last_updated\": \"2017-04-26T19:14:08Z\",\r\n            \"node\": \"couchdb@localhost\",\r\n            \"proxy\": null,\r\n            \"source\": \"http://localhost:5984/test_1493234045679_6_a/\",\r\n            \"start_time\": \"2017-04-26T19:14:08Z\",\r\n            \"state\": \"running\",\r\n            \"target\": \"http://localhost:5984/test_1493234045679_6_b/\"\r\n        },\r\n      ...<8 more docs in here>...\r\n    ],\r\n    \"offset\": 0,\r\n    \"total_rows\": 1000\r\n}\r\n```\r\n\r\nWithout any crashes \r\n\r\n```\r\nhttp http://localhost:5984/_scheduler/docs?states=crashing\r\nHTTP/1.1 200 OK\r\nCache-Control: must-revalidate\r\nContent-Type: application/json\r\nDate: Wed, 26 Apr 2017 19:26:03 GMT\r\nServer: CouchDB/2.0.0-49786f7 (Erlang OTP/18)\r\nTransfer-Encoding: chunked\r\nX-Couch-Request-ID: 465148b54d\r\nX-CouchDB-Body-Time: 0\r\n\r\n{\r\n    \"docs\": [],\r\n    \"offset\": 0,\r\n    \"total_rows\": 1000\r\n}\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297515901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297517073","html_url":"https://github.com/apache/couchdb/issues/491#issuecomment-297517073","issue_url":"https://api.github.com/repos/apache/couchdb/issues/491","id":297517073,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzUxNzA3Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-26T19:31:50Z","updated_at":"2017-04-26T19:31:50Z","author_association":"MEMBER","body":"CouchDB is based on SpiderMonkey 1.8.5 which is equivalent to approximately Firefox 4.0. There are plans to update the JS engine in CouchDB but they are still in the formative stages.\r\n\r\nClosing this for now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297517073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297601729","html_url":"https://github.com/apache/couchdb/issues/493#issuecomment-297601729","issue_url":"https://api.github.com/repos/apache/couchdb/issues/493","id":297601729,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzYwMTcyOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-27T03:30:11Z","updated_at":"2017-04-27T03:30:11Z","author_association":"MEMBER","body":"Hi @natew, you caught us in the switchover between JIRA and GitHub Issues. If you follow our dev@couchdb.apache.org mailing list you'll see more news on this in the coming weeks.\r\n\r\nI'm going to close this out for now - but please don't hesitate to ask questions if you have any on the mailing lists!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297601729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297610123","html_url":"https://github.com/apache/couchdb/pull/487#issuecomment-297610123","issue_url":"https://api.github.com/repos/apache/couchdb/issues/487","id":297610123,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzYxMDEyMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-27T04:42:23Z","updated_at":"2017-04-27T04:42:23Z","author_association":"MEMBER","body":"Hi @ianpartridge,\r\n\r\nUnfortunately, even on 16.04, `apt-get install npm` isn't new enough to bring in our recommended version of NPM, which is 3.x (comes with Node 6.x). See https://github.com/apache/couchdb-fauxton/blob/master/readme.md for this specification.\r\n\r\nOur CI workflow explicitly calls out this Node 6.x requirement: https://github.com/apache/couchdb-ci/blob/master/ansible/debian-8-base.yml#L22\r\n\r\nIf you want to update your PR (and squash, please) so that it points readers at Fauxton's `readme.md` for specific requirements, and/or the use of `--disable-fauxton`, I'd be happy to merge your change.\r\n\r\nThanks for your contribution to Apache CouchDB!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297610123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297642282","html_url":"https://github.com/apache/couchdb/pull/494#issuecomment-297642282","issue_url":"https://api.github.com/repos/apache/couchdb/issues/494","id":297642282,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzY0MjI4Mg==","user":{"login":"kxepal","id":785983,"node_id":"MDQ6VXNlcjc4NTk4Mw==","avatar_url":"https://avatars.githubusercontent.com/u/785983?v=4","gravatar_id":"","url":"https://api.github.com/users/kxepal","html_url":"https://github.com/kxepal","followers_url":"https://api.github.com/users/kxepal/followers","following_url":"https://api.github.com/users/kxepal/following{/other_user}","gists_url":"https://api.github.com/users/kxepal/gists{/gist_id}","starred_url":"https://api.github.com/users/kxepal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kxepal/subscriptions","organizations_url":"https://api.github.com/users/kxepal/orgs","repos_url":"https://api.github.com/users/kxepal/repos","events_url":"https://api.github.com/users/kxepal/events{/privacy}","received_events_url":"https://api.github.com/users/kxepal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-27T08:02:16Z","updated_at":"2017-04-27T08:02:16Z","author_association":"MEMBER","body":"Thank you for your contribution and interest to this problem!\r\n\r\nUnfortuanelly, I have two things to notice:\r\n1. You need to create a new feature branch for your PR from the branch to which you want it get merged (it's `2.0.x` now), but...\r\n2. `application/json` is always UTF-8 by default and his MIME type doesn't accepts any parameters per [RFC-7159](https://tools.ietf.org/html/rfc7159). See sections [8.1](https://tools.ietf.org/html/rfc7159#section-8.1) and [11](https://tools.ietf.org/html/rfc7159#section-11) for more information. \r\n\r\nI think there is nothing need to do and everything should works fine. Do you have any issues caused by missed charset on MIME type? And why?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297642282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297647868","html_url":"https://github.com/apache/couchdb/pull/487#issuecomment-297647868","issue_url":"https://api.github.com/repos/apache/couchdb/issues/487","id":297647868,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzY0Nzg2OA==","user":{"login":"ianpartridge","id":1423497,"node_id":"MDQ6VXNlcjE0MjM0OTc=","avatar_url":"https://avatars.githubusercontent.com/u/1423497?v=4","gravatar_id":"","url":"https://api.github.com/users/ianpartridge","html_url":"https://github.com/ianpartridge","followers_url":"https://api.github.com/users/ianpartridge/followers","following_url":"https://api.github.com/users/ianpartridge/following{/other_user}","gists_url":"https://api.github.com/users/ianpartridge/gists{/gist_id}","starred_url":"https://api.github.com/users/ianpartridge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ianpartridge/subscriptions","organizations_url":"https://api.github.com/users/ianpartridge/orgs","repos_url":"https://api.github.com/users/ianpartridge/repos","events_url":"https://api.github.com/users/ianpartridge/events{/privacy}","received_events_url":"https://api.github.com/users/ianpartridge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-27T08:26:36Z","updated_at":"2017-04-27T08:26:36Z","author_association":"NONE","body":"Thanks @wohali! Thinking about this a bit more, shouldn't `configure` check for Fauxton pre-requisites and fail if they aren't present?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297647868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297695922","html_url":"https://github.com/apache/couchdb/pull/494#issuecomment-297695922","issue_url":"https://api.github.com/repos/apache/couchdb/issues/494","id":297695922,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzY5NTkyMg==","user":{"login":"FgfdCBVCbnsebtgf","id":20582836,"node_id":"MDQ6VXNlcjIwNTgyODM2","avatar_url":"https://avatars.githubusercontent.com/u/20582836?v=4","gravatar_id":"","url":"https://api.github.com/users/FgfdCBVCbnsebtgf","html_url":"https://github.com/FgfdCBVCbnsebtgf","followers_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/followers","following_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/following{/other_user}","gists_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/gists{/gist_id}","starred_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/subscriptions","organizations_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/orgs","repos_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/repos","events_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/events{/privacy}","received_events_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-27T12:12:32Z","updated_at":"2017-04-27T12:12:32Z","author_association":"NONE","body":"Hello, the Chromium version 57.0.2987.98 Built on Ubuntu , running on Ubuntu 17.04 (64-bit) does not show correctly the accent characters.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297695922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297741300","html_url":"https://github.com/apache/couchdb/pull/496#issuecomment-297741300","issue_url":"https://api.github.com/repos/apache/couchdb/issues/496","id":297741300,"node_id":"MDEyOklzc3VlQ29tbWVudDI5Nzc0MTMwMA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-27T15:03:49Z","updated_at":"2017-04-27T15:03:49Z","author_association":"MEMBER","body":"Also for documentation I'm not sure what we want to do there. Should I open a PR for the docs now or should we wait and let this soak on master and just let the more adventurous folk take cracks at running and writing new storage engines to make sure there's nothing major that needs reworked?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297741300/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297745272","html_url":"https://github.com/apache/couchdb/pull/496#issuecomment-297745272","issue_url":"https://api.github.com/repos/apache/couchdb/issues/496","id":297745272,"node_id":"MDEyOklzc3VlQ29tbWVudDI5Nzc0NTI3Mg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-04-27T15:15:25Z","updated_at":"2017-04-27T15:15:25Z","author_association":"MEMBER","body":"Also, I forgot to link out to the first complete alternative storage engines.\r\n\r\nhttps://github.com/cloudant/couch_ngen\r\n\r\nThe couch_ngen engine (its a super terrible name I know) was one that I wrote fairly quickly just to try and prove that the API wasn't artificially restrictive. The biggest thing here is that I'm using multiple files for a single database to try and make things like compaction faster. This is the same general shape as the existing legacy engine with a few tweaks that we've considered over the years but never actually tried to implement due to upgrade concerns. This also uses a NIF for file I/O with dirty schedulers (thus your Erlang VM needs to have dirty schedulers enabled to run this engine). Initial benchmarks show this engine to be significantly faster than the legacy engine at the local node interface. Unfortunately those gains don't show up nearly as well at the clustered interface (so we've got more work to do there :)\r\n\r\nhttps://github.com/cloudant-labs/lethe/tree/initial-branch\r\n\r\nLethe is the first engine written by !me. This work is by @chewbranca trying to investigate the storage engine API by actually using it to write a storage engine. Lethe is an ephemeral/in-memory storage engine. Think ramdisk database thing. Its not been benchmarked to the best of my knowledge but last I heard it was passing the storage engine test suite and could run most of the existing test suite (it doesn't support attachments which are optional in the API).\r\n\r\nThere are some other obvious candidates for storage engines as well that I've not tried (on purpose to let others play with something new and interesting). LevelDB/RocksDB, LMDB, PostgreSQL, SQLite, Bitcask, etc all come to mind as obvious things to play with. Also something I've been contemplating is writing a custom storage engine in C that is behaviorally similar to the existing code but hopefully significantly faster (though remember if speed is your goal we've got more work to do in the clustering layer :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/297745272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]