[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206742404","html_url":"https://github.com/apache/iceberg/pull/5401#issuecomment-1206742404","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5401","id":1206742404,"node_id":"IC_kwDOCW7NX85H7W2E","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T18:33:55Z","updated_at":"2022-08-05T18:33:55Z","author_association":"CONTRIBUTOR","body":"Thanks @stevenzwu for the PR and @Fokko for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206742404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206769070","html_url":"https://github.com/apache/iceberg/pull/5439#issuecomment-1206769070","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5439","id":1206769070,"node_id":"IC_kwDOCW7NX85H7dWu","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T19:00:55Z","updated_at":"2022-08-05T19:00:55Z","author_association":"CONTRIBUTOR","body":"> This is mostly for local testing (against my local file system), but I also think we'll need this in the case of HDFS. We could just stub them out for object stores. I agree that we should leave potential harmful methods such as `ls` out üëçüèª\r\n\r\nOnce we put it into the base class, it becomes part of the api though.  Seems like if this is specific to the implementation (e.g. hive metastore) we could just use something directly from there without going through FileIO.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206769070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206777099","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1206777099","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1206777099,"node_id":"IC_kwDOCW7NX85H7fUL","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T19:08:49Z","updated_at":"2022-08-05T19:08:49Z","author_association":"NONE","body":"i have change it to java to work around the compilation error, but i am still seeing the same kryo serialization issue on ImmutableMap\r\nCaused by: java.lang.UnsupportedOperationException\r\n\tat org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap.put(ImmutableMap.java:714)\r\n\r\nHere is the code change I have made, do i miss anything?\r\n\r\nAdd spark config\r\n  .config(\"spark.kryo.registrator\", \"xxx.CustomKryoRegistrator\")\r\n\r\nimport com.esotericsoftware.kryo.Kryo;\r\nimport org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap;\r\nimport org.apache.spark.serializer.KryoRegistrator;\r\n\r\npublic class CustomKryoRegistrator implements KryoRegistrator {\r\n    @Override\r\n    public void registerClasses(Kryo kryo){\r\n        final ImmutableRelocatedMapSerializer serializer = new ImmutableRelocatedMapSerializer();\r\n        kryo.register(java.util.HashMap.class);\r\n        kryo.register(ImmutableMap.class, serializer);\r\n    }\r\n}\r\n\r\nimport com.esotericsoftware.kryo.Kryo;\r\nimport com.esotericsoftware.kryo.Serializer;\r\nimport com.esotericsoftware.kryo.io.Input;\r\nimport com.esotericsoftware.kryo.io.Output;\r\nimport com.google.common.collect.Maps;\r\nimport org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap;\r\n\r\npublic class ImmutableRelocatedMapSerializer extends Serializer<ImmutableMap> {\r\n\r\n    private static final boolean DOES_NOT_ACCEPT_NULL = true;\r\n    private static final boolean IMMUTABLE = true;\r\n\r\n    public ImmutableRelocatedMapSerializer() {\r\n        super(DOES_NOT_ACCEPT_NULL, IMMUTABLE);\r\n    }\r\n\r\n    @Override\r\n    public void write(Kryo kryo, Output output, ImmutableMap object) {\r\n        kryo.writeObject(output, Maps.newHashMap(object));\r\n    }\r\n\r\n    @Override\r\n    public ImmutableMap read(Kryo kryo, Input input, Class<ImmutableMap> type) {\r\n        java.util.Map map = kryo.readObject(input, java.util.HashMap.class);\r\n        return ImmutableMap.copyOf(map);\r\n    }\r\n}\r\n\r\nI have also tried the following, did not work either\r\n\r\nval sparkConf = new SparkConf().setAppName(appName).registerKryoClasses(Array(classOf[org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap[Any, Any]]))\r\n\r\nspark = SparkSession\r\n.builder()\r\n.config(\"spark.sql.legacy.parquet.datetimeRebaseModeInWrite\", \"CORRECTED\")\r\n.config(\"spark.sql.extensions\", \"org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\") // Iceberg related configs\r\n.config(\"spark.sql.autoBroadcastJoinThreshold\", \"-1\")\r\n.config(\"spark.sql.adaptive.autoBroadcastJoinThreshold\", \"-1\")\r\n.config(s\"spark.sql.catalog.iceberg_catalog\", \"org.apache.iceberg.spark.SparkCatalog\")\r\n.config(s\"spark.sql.catalog.iceberg_catalog.warehouse\", warehousePath)\r\n.config(s\"spark.sql.catalog.iceberg_catalog.catalog-impl\", \"org.apache.iceberg.aws.glue.GlueCatalog\")\r\n.config(s\"spark.sql.catalog.iceberg_catalog.io-impl\", \"org.apache.iceberg.aws.s3.S3FileIO\")\r\n.config(s\"spark.sql.catalog.iceberg_catalog.client.factory\", \"org.apache.iceberg.aws.AssumeRoleAwsClientFactory\")\r\n.config(s\"spark.sql.catalog.iceberg_catalog.client.assume-role.arn\", s\"arn:aws:iam::$catalogId:role/$role\")\r\n.config(s\"spark.sql.catalog.iceberg_catalog.client.assume-role.region\", \"us-east-2\")\r\n.config(\"spark.sql.iceberg.handle-timestamp-without-timezone\", \"true\")\r\n.config(\"spark.hadoop.hive.metastore.glue.catalogid\", catalogId)\r\n.config(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\")\r\n.config(sparkConf)\r\n.enableHiveSupport()\r\n.getOrCreate()","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206777099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206803875","html_url":"https://github.com/apache/iceberg/issues/5442#issuecomment-1206803875","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5442","id":1206803875,"node_id":"IC_kwDOCW7NX85H7l2j","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T19:48:53Z","updated_at":"2022-08-05T19:48:53Z","author_association":"CONTRIBUTOR","body":"Does this still hapoen if the table is refreshed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206803875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206814006","html_url":"https://github.com/apache/iceberg/issues/5442#issuecomment-1206814006","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5442","id":1206814006,"node_id":"IC_kwDOCW7NX85H7oU2","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T20:04:56Z","updated_at":"2022-08-05T20:04:56Z","author_association":"CONTRIBUTOR","body":"Oh this seems intentional based on the comment above `newSnapshotLog.clear()` below.\r\n\r\nThough there's possibly a better way of handling the intermediate history states that never actually existed vs simply clearing the whole history log.\r\n\r\nI think the `snapshots` metadata table would still have all the snapshot data, but ideally just the entries that need to be trimmed from the history log are removed.\r\n\r\nhttps://github.com/apache/iceberg/blob/353c53910195b81bd5ceb908c12ed8113bbb4e3b/core/src/main/java/org/apache/iceberg/TableMetadata.java#L1558-L1593","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206814006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206851665","html_url":"https://github.com/apache/iceberg/issues/5442#issuecomment-1206851665","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5442","id":1206851665,"node_id":"IC_kwDOCW7NX85H7xhR","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T20:46:14Z","updated_at":"2022-08-05T20:46:14Z","author_association":"CONTRIBUTOR","body":"I tried this with `refresh` and it doesn't make a difference.\r\n\r\nI think the logic for `intermediateSnapshotIdSet` needs to possibly be updated, but I'm still looking through the comment about time-travel queries.\r\n\r\nIf anybody else has any ideas, feel free to chime in üòÖ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206851665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206892329","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1206892329","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1206892329,"node_id":"IC_kwDOCW7NX85H77cp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T21:31:38Z","updated_at":"2022-08-05T21:31:38Z","author_association":"CONTRIBUTOR","body":"Thanks for pinging me, @singhpk234. Looks like we need to convert the properties map over to a HashMap rather than an immutable map. Good catch!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1206892329/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207094236","html_url":"https://github.com/apache/iceberg/pull/5398#issuecomment-1207094236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5398","id":1207094236,"node_id":"IC_kwDOCW7NX85H8svc","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-05T23:57:12Z","updated_at":"2022-08-05T23:57:12Z","author_association":"CONTRIBUTOR","body":"Let's separate this to API and Spark work, so people have consensus of the API added before we add the actual impl.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207094236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207099095","html_url":"https://github.com/apache/iceberg/issues/3903#issuecomment-1207099095","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3903","id":1207099095,"node_id":"IC_kwDOCW7NX85H8t7X","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-06T00:12:14Z","updated_at":"2022-08-06T00:12:14Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207099095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207120003","html_url":"https://github.com/apache/iceberg/pull/5451#issuecomment-1207120003","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5451","id":1207120003,"node_id":"IC_kwDOCW7NX85H8zCD","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-06T01:32:14Z","updated_at":"2022-08-06T01:32:14Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207120003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207120699","html_url":"https://github.com/apache/iceberg/pull/5452#issuecomment-1207120699","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5452","id":1207120699,"node_id":"IC_kwDOCW7NX85H8zM7","user":{"login":"bryanck","id":5475421,"node_id":"MDQ6VXNlcjU0NzU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5475421?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanck","html_url":"https://github.com/bryanck","followers_url":"https://api.github.com/users/bryanck/followers","following_url":"https://api.github.com/users/bryanck/following{/other_user}","gists_url":"https://api.github.com/users/bryanck/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanck/subscriptions","organizations_url":"https://api.github.com/users/bryanck/orgs","repos_url":"https://api.github.com/users/bryanck/repos","events_url":"https://api.github.com/users/bryanck/events{/privacy}","received_events_url":"https://api.github.com/users/bryanck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-06T01:34:34Z","updated_at":"2022-08-06T01:34:34Z","author_association":"CONTRIBUTOR","body":"It seems as if the version of Scala 2.13 in use can't use Jackson 2.13, which Arrow is bringing in transitively now. I'll see if there is a solution, otherwise I will close this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207120699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207126977","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1207126977","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1207126977,"node_id":"IC_kwDOCW7NX85H80vB","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-06T02:13:12Z","updated_at":"2022-08-06T02:13:12Z","author_association":"NONE","body":"Just wondering you have an estimation for when the changes can be released? Let me know, thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207126977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207224290","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1207224290","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1207224290,"node_id":"IC_kwDOCW7NX85H9Mfi","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-06T14:27:46Z","updated_at":"2022-08-06T16:18:56Z","author_association":"CONTRIBUTOR","body":"@szehon-ho as the discussion above, please take a look on my latest change. This modification can minimally invade the `commit` logic. And the original `registerTable` means table from null to a new table. New logic (drop then create) is also in line with the original logic. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207224290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207292966","html_url":"https://github.com/apache/iceberg/pull/1849#issuecomment-1207292966","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1849","id":1207292966,"node_id":"IC_kwDOCW7NX85H9dQm","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-06T22:39:14Z","updated_at":"2022-08-06T22:39:14Z","author_association":"NONE","body":"Abandoning due to lack of time/consensus.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207292966/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207441506","html_url":"https://github.com/apache/iceberg/pull/5439#issuecomment-1207441506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5439","id":1207441506,"node_id":"IC_kwDOCW7NX85H-Bhi","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T16:25:28Z","updated_at":"2022-08-07T16:25:28Z","author_association":"CONTRIBUTOR","body":"HDFS will automatically create directories. If we want to test locally, we should make a LocalFileIO that has the expected behavior.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207441506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207445660","html_url":"https://github.com/apache/iceberg/pull/5436#issuecomment-1207445660","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5436","id":1207445660,"node_id":"IC_kwDOCW7NX85H-Cic","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T16:53:40Z","updated_at":"2022-08-07T16:53:40Z","author_association":"CONTRIBUTOR","body":"Looks like PyArrow already implements this: https://github.com/apache/arrow/blob/31494860c23ff7fe38a748a09c58822378605477/python/pyarrow/io.pxi#L121-L122\r\n\r\nI'll merge. Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207445660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207446722","html_url":"https://github.com/apache/iceberg/pull/5444#issuecomment-1207446722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5444","id":1207446722,"node_id":"IC_kwDOCW7NX85H-CzC","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T17:00:02Z","updated_at":"2022-08-07T17:00:02Z","author_association":"CONTRIBUTOR","body":"@ebyhr, I don't think that this makes sense. `ContentFile` is the base class that we use when storing or retrieving `DataFile` and `DeleteFile` in Iceberg metadata. Adding modified time like this would require tracking file modification time in Iceberg metadata.\r\n\r\nTracking modified time in Iceberg metadata isn't necessary. The files in an Iceberg table are considered immutable and they should never be modified. The only time that actually matters for an Iceberg file is when the file was added to Iceberg metadata, but that should be tracked by the added snapshot, not by adding more metadata to manifest files.\r\n\r\nWithout a description, it's hard to tell what you're trying to accomplish with this, so I'm going to close it. If you want, add a description that explains why you're making this change and we can help you solve your problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207446722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207448238","html_url":"https://github.com/apache/iceberg/pull/5443#issuecomment-1207448238","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5443","id":1207448238,"node_id":"IC_kwDOCW7NX85H-DKu","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T17:09:29Z","updated_at":"2022-08-07T17:09:29Z","author_association":"CONTRIBUTOR","body":"Looks good overall, just a couple of minor things you may want to look at.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207448238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207452823","html_url":"https://github.com/apache/iceberg/pull/5158#issuecomment-1207452823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5158","id":1207452823,"node_id":"IC_kwDOCW7NX85H-ESX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T17:38:15Z","updated_at":"2022-08-07T17:38:15Z","author_association":"CONTRIBUTOR","body":"I think it is good to note that the default is the data value, but document the settings exist.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207452823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207452921","html_url":"https://github.com/apache/iceberg/pull/5150#issuecomment-1207452921","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5150","id":1207452921,"node_id":"IC_kwDOCW7NX85H-ET5","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T17:38:20Z","updated_at":"2022-08-07T17:41:25Z","author_association":"CONTRIBUTOR","body":"@namrathamyske Thanks for this! \r\nHigh level comment, I think we should separate the API and the Spark integration changes. Also at the API level, I think it makes sense to separate useBranch and useTag, rather than having one useSnapshotRef , because branching can be combined with time travel, but tagging cannot be; although that could just be an implementation detail we handle. Semantically from an API perspective though it seems cleaner to separate the 2. \r\n\r\nLet me know what you think.  Checkout this thread https://github.com/apache/iceberg/pull/4428#discussion_r838741565\r\n\r\nI have this PR https://github.com/apache/iceberg/pull/5364 for branching + time travel, I think we could do a separate one for tagging.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207452921/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207453841","html_url":"https://github.com/apache/iceberg/pull/4926#issuecomment-1207453841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4926","id":1207453841,"node_id":"IC_kwDOCW7NX85H-EiR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T17:41:40Z","updated_at":"2022-08-07T17:41:40Z","author_association":"CONTRIBUTOR","body":"Looks like this is close, but we need to fix the `toBranch` definition and revapi checks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207453841/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207460759","html_url":"https://github.com/apache/iceberg/pull/4926#issuecomment-1207460759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4926","id":1207460759,"node_id":"IC_kwDOCW7NX85H-GOX","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T18:22:04Z","updated_at":"2022-08-07T18:22:04Z","author_association":"CONTRIBUTOR","body":"@namrathamyske raised a PR to your fork to address the revapi and moving the default implementation up to the interface level. https://github.com/namrathamyske/iceberg/pull/3/files","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207460759/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207469306","html_url":"https://github.com/apache/iceberg/pull/5360#issuecomment-1207469306","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5360","id":1207469306,"node_id":"IC_kwDOCW7NX85H-IT6","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T19:18:33Z","updated_at":"2022-08-07T19:18:33Z","author_association":"CONTRIBUTOR","body":"@rdblue I opened #5456 and #5457 which breaks out the `io` and `catalog` portion of this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207469306/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207475027","html_url":"https://github.com/apache/iceberg/pull/5439#issuecomment-1207475027","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5439","id":1207475027,"node_id":"IC_kwDOCW7NX85H-JtT","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T19:58:16Z","updated_at":"2022-08-07T19:58:16Z","author_association":"CONTRIBUTOR","body":"> Once we put it into the base class, it becomes part of the api though. Seems like if this is specific to the implementation (e.g. hive metastore) we could just use something directly from there without going through FileIO.\r\n\r\nIt would be relevant for every catalog that creates the table metadata (the REST catalog does this for us).\r\n\r\n> HDFS will automatically create directories. If we want to test locally, we should make a LocalFileIO that has the expected behavior.\r\n\r\nAlright, in that case, it doesn't make sense to implement this in the actual code. I'll create a wrapper for any FileIO that will first create the directory.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207475027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207476648","html_url":"https://github.com/apache/iceberg/issues/4997#issuecomment-1207476648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4997","id":1207476648,"node_id":"IC_kwDOCW7NX85H-KGo","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T20:08:41Z","updated_at":"2022-08-07T20:11:51Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @kbendick Hey just to follow up on the potential scalable solutions here. I wonder do you have any suggestion on how to fix this? Our users are hitting this issue more often and we have to keep educate them which slow down the Iceberg adoption, it will be great if we can resolve it from the engine level.\r\n\r\n@RussellSpitzer do you see it is doable to add what we are seeing in this optimizer as well? https://github.com/apache/spark/blob/master/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/UnwrapCastInBinaryComparison.scala\r\n\r\n@RussellSpitzer Also you said that this is an issue for external datasource, I wonder why it is not an issue for the internal datasource and will it be easier to solve this on the Iceberg catalyst?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207476648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207476670","html_url":"https://github.com/apache/iceberg/pull/5456#issuecomment-1207476670","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5456","id":1207476670,"node_id":"IC_kwDOCW7NX85H-KG-","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T20:08:52Z","updated_at":"2022-08-07T20:08:52Z","author_association":"CONTRIBUTOR","body":"Thanks, @samredai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207476670/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207478555","html_url":"https://github.com/apache/iceberg/issues/5122#issuecomment-1207478555","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5122","id":1207478555,"node_id":"IC_kwDOCW7NX85H-Kkb","user":{"login":"mrendi29","id":42871239,"node_id":"MDQ6VXNlcjQyODcxMjM5","avatar_url":"https://avatars.githubusercontent.com/u/42871239?v=4","gravatar_id":"","url":"https://api.github.com/users/mrendi29","html_url":"https://github.com/mrendi29","followers_url":"https://api.github.com/users/mrendi29/followers","following_url":"https://api.github.com/users/mrendi29/following{/other_user}","gists_url":"https://api.github.com/users/mrendi29/gists{/gist_id}","starred_url":"https://api.github.com/users/mrendi29/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrendi29/subscriptions","organizations_url":"https://api.github.com/users/mrendi29/orgs","repos_url":"https://api.github.com/users/mrendi29/repos","events_url":"https://api.github.com/users/mrendi29/events{/privacy}","received_events_url":"https://api.github.com/users/mrendi29/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T20:19:38Z","updated_at":"2022-08-07T20:19:38Z","author_association":"NONE","body":"+1  for rust sdk","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207478555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207478697","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1207478697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1207478697,"node_id":"IC_kwDOCW7NX85H-Kmp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T20:20:34Z","updated_at":"2022-08-07T20:20:34Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, what I originally meant was that it would be fine for the caller to manually call `dropTable` first. I'm hesitant to add a `force` option because it's basically the same thing as a reset, we just hide it a bit.\r\n\r\nThinking about the problem a bit more, I'm not sure that the use cases we're trying to satisfy make this a catalog operation. If this is about replacing the metadata for a single existing table, why not make this a table operation? Or better yet, why not use the existing table operation to do this? If the table exists, then you can always call `table.operations().commit(table.operations().current(), replacementMetadata)`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207478697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207479352","html_url":"https://github.com/apache/iceberg/pull/5457#issuecomment-1207479352","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5457","id":1207479352,"node_id":"IC_kwDOCW7NX85H-Kw4","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T20:24:43Z","updated_at":"2022-08-07T20:24:43Z","author_association":"CONTRIBUTOR","body":"Thanks, @samredai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207479352/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207479719","html_url":"https://github.com/apache/iceberg/pull/5437#issuecomment-1207479719","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5437","id":1207479719,"node_id":"IC_kwDOCW7NX85H-K2n","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T20:27:10Z","updated_at":"2022-08-07T20:27:10Z","author_association":"CONTRIBUTOR","body":"This looks like the right fix to me. Thanks, @singhpk234! Could you also add tests for the other FileIO implementations?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207479719/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207489316","html_url":"https://github.com/apache/iceberg/pull/5417#issuecomment-1207489316","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5417","id":1207489316,"node_id":"IC_kwDOCW7NX85H-NMk","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T21:32:20Z","updated_at":"2022-08-07T21:32:20Z","author_association":"CONTRIBUTOR","body":"I like this a lot, but I think we should make some adjustments so that the output is usable with other CLI tools. It feels weird to work with a CLI that pretty-prints and can't be used in combination with `awk` and `grep` easily. I made some comments on the implementation for this. I think just using `Table.grid` in most places is a good compromise between the trade-offs. And this should route error text to stderr as well.\r\n\r\nI also thought about the command structure for a while. I definitely prefer not to mirror the API directly, unless we have an API where that is the expectation (like, the `aws s3api` functionality). Most people will use this CLI to do something, like explore a catalog or find information on a table. I think the CLI should be written to make those use cases effective and easy.\r\n\r\nFor example, currently there's a `load-table` command that corresponds to `load_table` in the catalog API. But loading a table is just a first step in a series of actions to do something useful. It doesn't make sense to me to load a table as a CLI command because the caller is coming with a purpose beyond that first step, like looking at the columns of a table and their documentation. It may be that the user wants to see the schema, the partitioning, table properties, or maybe a summary of everything. All of those cases load the table, but showing the same information each time is distracting.\r\n\r\nI think that the CLI should have distinct commands that are more focused on a purpose, like `schema` to show a table schema, or `properties` to show table or namespace properties. Like these, for example:\r\n\r\n```\r\npyiceberg schema db.table\r\npyiceberg spec db.table\r\npyiceberg order db.table\r\npyiceberg uuid db.table\r\npyiceberg location db.table\r\npyiceberg properties db.table\r\n```\r\n\r\nWe probably do want a `summary` or `describe` command that shows more information.\r\n\r\nIt's also strange for the to tell the API what type of object is being operated on or expected. That's another artifact of mirroring the catalog API. When I use `ls`, I don't need to tell the command that I want to list a directory or a symlinked directory. I also don't need to tell `ls` what I'm looking for, it just lists everything. I think `pyiceberg` should work the same way. Rather than having `list-tables` and `list-namespaces`, I think we should have a single `list` command that shows the output of both API calls. We can use `[bold blue]` to format namespaces and use filters, like `--tables`, to restrict the type of objects shown. Commands that I think would work with both namespaces and tables are `describe`, `properties`, `set`, and `remove`:\r\n\r\n```\r\npyiceberg describe db\r\npyiceberg describe db.table\r\npyiceberg properties db\r\npyiceberg properties db.table\r\npyiceberg set db properties a=b\r\npyiceberg set db.t1 properties a=b\r\npyiceberg remove db properties a b\r\npyiceberg remove db.t1 properties a b\r\n```\r\n\r\nThe exception to that are the `create` and `drop` commands, which should probably be explicit about what you're dropping (like `rm` vs `rmdir`): `pyiceberg drop table db.table`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207489316/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207492068","html_url":"https://github.com/apache/iceberg/pull/5458#issuecomment-1207492068","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5458","id":1207492068,"node_id":"IC_kwDOCW7NX85H-N3k","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T21:54:13Z","updated_at":"2022-08-07T21:54:13Z","author_association":"CONTRIBUTOR","body":"Thanks, @samredai!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207492068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207494698","html_url":"https://github.com/apache/iceberg/pull/5429#issuecomment-1207494698","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5429","id":1207494698,"node_id":"IC_kwDOCW7NX85H-Ogq","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T22:13:24Z","updated_at":"2022-08-07T22:13:24Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207494698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207495393","html_url":"https://github.com/apache/iceberg/pull/5338#issuecomment-1207495393","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5338","id":1207495393,"node_id":"IC_kwDOCW7NX85H-Orh","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T22:18:04Z","updated_at":"2022-08-07T22:19:27Z","author_association":"CONTRIBUTOR","body":"@Fokko, sorry, but I think I was wrong in my initial review. I think instead of renaming these, we actually want to rename the fields that we write so that they match the spec. Because we use the same column for both `DataFile` and `DeleteFile` to count the number of `ADDED` rows, we should use a neutral name so `added_files_count` is correct.\r\n\r\nLooks like the problem here is that the original `added_data_files_count` is used instead of `added_files_count`, not that the variable names don't match.\r\n\r\nThis is what I meant by this comment:\r\n\r\n> I think we can also update the field names. Those won't break anything because the only names that matter are the ones in the read schema.\r\n\r\nI'm not sure why I thought the constant renames looked good though, since that would rename the constants to match the out-of-date manifest field names, which we should update instead.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207495393/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207496070","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1207496070","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1207496070,"node_id":"IC_kwDOCW7NX85H-O2G","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T22:22:37Z","updated_at":"2022-08-07T22:22:37Z","author_association":"MEMBER","body":"@rdblue The issue with those solutions for our use case is that they only work if the current metadata is valid. If not, we cannot drop the table via the Catalog api (requires loading the metadata first) which has led me to constantly showing folks how to access the hive via the Spark external client wrapper. The same issue occurs if we want to make this a table operation, we can't perform an operation on a table which doesn't have a valid metadata.json.\n\nOur issue is that in Spark we can't Drop the table or point to a new metadata without using an api for the metastore directly. Ideally I think the Iceberg catalog implementation should provide an exit valve for these situations so users aren't required to manually connect to the underlying catalog system themselves. \n\nI am open to other solutions here but I'm not very worried about folks overusing this api, it tends to only come up when the user is already in a really bad state.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207496070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207496195","html_url":"https://github.com/apache/iceberg/pull/5433#issuecomment-1207496195","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5433","id":1207496195,"node_id":"IC_kwDOCW7NX85H-O4D","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T22:23:24Z","updated_at":"2022-08-07T22:23:24Z","author_association":"CONTRIBUTOR","body":"Thanks, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207496195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207496575","html_url":"https://github.com/apache/iceberg/pull/5434#issuecomment-1207496575","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5434","id":1207496575,"node_id":"IC_kwDOCW7NX85H-O9_","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T22:25:29Z","updated_at":"2022-08-07T22:25:29Z","author_association":"CONTRIBUTOR","body":"I think it's better to put names like this after a `:` instead of adding characters that can get copied and moved to other places. Putting names after `:` still allows you to see when they are empty or null (e.g. `Cannot find field: `) without adding non-whitespace characters.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207496575/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207498607","html_url":"https://github.com/apache/iceberg/issues/4997#issuecomment-1207498607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4997","id":1207498607,"node_id":"IC_kwDOCW7NX85H-Pdv","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T22:38:35Z","updated_at":"2022-08-07T22:38:35Z","author_association":"MEMBER","body":"It's a spark limitation, it's only able to pass filter expressions to external Datasources which previously just included basic predicates, although with V2 expressions we probably will have more latitude here.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207498607/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207499359","html_url":"https://github.com/apache/iceberg/pull/5444#issuecomment-1207499359","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5444","id":1207499359,"node_id":"IC_kwDOCW7NX85H-Ppf","user":{"login":"ebyhr","id":6237050,"node_id":"MDQ6VXNlcjYyMzcwNTA=","avatar_url":"https://avatars.githubusercontent.com/u/6237050?v=4","gravatar_id":"","url":"https://api.github.com/users/ebyhr","html_url":"https://github.com/ebyhr","followers_url":"https://api.github.com/users/ebyhr/followers","following_url":"https://api.github.com/users/ebyhr/following{/other_user}","gists_url":"https://api.github.com/users/ebyhr/gists{/gist_id}","starred_url":"https://api.github.com/users/ebyhr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ebyhr/subscriptions","organizations_url":"https://api.github.com/users/ebyhr/orgs","repos_url":"https://api.github.com/users/ebyhr/repos","events_url":"https://api.github.com/users/ebyhr/events{/privacy}","received_events_url":"https://api.github.com/users/ebyhr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T22:44:04Z","updated_at":"2022-08-07T23:12:51Z","author_association":"CONTRIBUTOR","body":"@rdblue Add the description. You can chime in on https://apache-iceberg.slack.com/archives/C025PH0G1D4/p1657006270692089 if you want to talk interactively. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207499359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207500016","html_url":"https://github.com/apache/iceberg/pull/5439#issuecomment-1207500016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5439","id":1207500016,"node_id":"IC_kwDOCW7NX85H-Pzw","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T22:48:25Z","updated_at":"2022-08-07T22:48:25Z","author_association":"CONTRIBUTOR","body":"> Alright, in that case, it doesn't make sense to implement this in the actual code. I'll create a wrapper for any FileIO that will first create the directory.\r\n\r\nI don't think I follow. The expectation is that `OutputStream.create` will create the file and any necessary directory structure above it. That's the default behavior for HDFS, S3, and other object stores, so I don't think that we need a generic wrapper. We may need to ensure that directories exist for some URI schemes in specific implementations (maybe arrow doesn't do this?) but I don't think we could make a generic wrapper that does it. At least, I don't see what a generic wrapper would call.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207500016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207503065","html_url":"https://github.com/apache/iceberg/pull/5425#issuecomment-1207503065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5425","id":1207503065,"node_id":"IC_kwDOCW7NX85H-QjZ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T23:06:59Z","updated_at":"2022-08-07T23:06:59Z","author_association":"CONTRIBUTOR","body":"@stevenzwu can you take a look at this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207503065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207506887","html_url":"https://github.com/apache/iceberg/pull/5150#issuecomment-1207506887","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5150","id":1207506887,"node_id":"IC_kwDOCW7NX85H-RfH","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T23:24:45Z","updated_at":"2022-08-07T23:24:45Z","author_association":"CONTRIBUTOR","body":"@rdblue @amogh-jahagirdar Thanks for your review! working on changes for this!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207506887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207507710","html_url":"https://github.com/apache/iceberg/pull/4926#issuecomment-1207507710","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4926","id":1207507710,"node_id":"IC_kwDOCW7NX85H-Rr-","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-07T23:29:46Z","updated_at":"2022-08-07T23:29:46Z","author_association":"CONTRIBUTOR","body":"@rdblue Merged PR with @amogh-jahagirdar's changes which had changes wrt to review comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207507710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207516224","html_url":"https://github.com/apache/iceberg/issues/4068#issuecomment-1207516224","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4068","id":1207516224,"node_id":"IC_kwDOCW7NX85H-TxA","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T00:11:28Z","updated_at":"2022-08-08T00:11:28Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207516224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207516230","html_url":"https://github.com/apache/iceberg/issues/4065#issuecomment-1207516230","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4065","id":1207516230,"node_id":"IC_kwDOCW7NX85H-TxG","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T00:11:29Z","updated_at":"2022-08-08T00:11:29Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207516230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207526424","html_url":"https://github.com/apache/iceberg/issues/4012#issuecomment-1207526424","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4012","id":1207526424,"node_id":"IC_kwDOCW7NX85H-WQY","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T00:43:03Z","updated_at":"2022-08-08T00:43:03Z","author_association":"CONTRIBUTOR","body":"Wire S3 batch deletion for snapshot expiration can be found in #5412 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207526424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207527248","html_url":"https://github.com/apache/iceberg/pull/5459#issuecomment-1207527248","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5459","id":1207527248,"node_id":"IC_kwDOCW7NX85H-WdQ","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T00:45:29Z","updated_at":"2022-08-08T00:45:29Z","author_association":"CONTRIBUTOR","body":"Currently it does not have any testing, I know we have some issue using s3mock, can we add an integ test in aws module for delete all files in a table?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207527248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207528968","html_url":"https://github.com/apache/iceberg/pull/5459#issuecomment-1207528968","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5459","id":1207528968,"node_id":"IC_kwDOCW7NX85H-W4I","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T00:50:03Z","updated_at":"2022-08-08T00:50:03Z","author_association":"CONTRIBUTOR","body":"> Currently it does not have any testing, I know we have some issue using s3mock, can we add an integ test in aws module for delete all files in a table?\r\n\r\nYeah, I was just looking into it. If needed, I can add integration tests to the TestGlueCatalogTable. TestGlueCatalogTable already tests purging and the underlying file IO is S3, so if those succeed we should be good. I will run those and validate as well as add any other cases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207528968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207535343","html_url":"https://github.com/apache/iceberg/pull/5459#issuecomment-1207535343","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5459","id":1207535343,"node_id":"IC_kwDOCW7NX85H-Ybv","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T01:03:03Z","updated_at":"2022-08-08T01:03:03Z","author_association":"CONTRIBUTOR","body":"> TestGlueCatalogTable already tests purging and the underlying file IO is S3, so if those succeed we should be good. I will run those and validate as well as add any other cases.\r\n\r\nI don't think we have enough files generated to trigger the full code path, let's make sure we do that","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207535343/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207554438","html_url":"https://github.com/apache/iceberg/issues/5453#issuecomment-1207554438","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5453","id":1207554438,"node_id":"IC_kwDOCW7NX85H-dGG","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T01:35:43Z","updated_at":"2022-08-08T01:35:43Z","author_association":"CONTRIBUTOR","body":"The stack trace reads like there's an S3 request timeout.\r\n\r\nCan you provide the following infirmation?\r\n\r\n1. The exact Iceberg runtime jar dependency used (ensure that you're using the spark 3.3 iceberg bundle\r\n2. The catalog are you using (eg hadoop, hive, DynamoDB, etc).\r\n3. The Spark configuration used, including configuration settings for initializing the Iceberg catalog plus any non-default Spark configs applied.\r\n\r\nHave you confirmed that this same code over _the same input data_ works with your previous Spark 3.2 settings? And not necessarily previous runs, but this _same_ input data? Given that there seems to be an S3 upload timeout, it would be really helpful to compare the previous setup to the new setup over the exact same dataset to be able to truly compare the two. Otherwise it's hard to be sure that the problem isn't simply input skew of your data (eg the input dataset is much larger than normal, it's much more skewed on the columns being sorted on and thus takes much more time to sort, etc). \r\n\r\nIt would also be _very_ helpful to provide the Query plan from your old setup and from the new setup (either the output of `EXPLAIN EXTENDED` or a screenshot of the whole DAG for the Query from the SQL tab for both the old Spark 3.2 with Iceberg 0.13 and for the new Spark 3.3 with Iceberg 0.14).\r\n\r\nAssuming that you're using the correct Spark iceberg runtime JAR for Spark 3.3.0, I'm wondering if maybe Spark's adaptive execution is lowering the parallelism of the write stage, which is then increasing the size of the data upload to S3 and leading to the timeout.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207554438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207564941","html_url":"https://github.com/apache/iceberg/issues/5453#issuecomment-1207564941","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5453","id":1207564941,"node_id":"IC_kwDOCW7NX85H-fqN","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T01:57:07Z","updated_at":"2022-08-08T01:57:07Z","author_association":"CONTRIBUTOR","body":"To get around the issue, assuming you're using `S3FileIO` (which it seems like you are), you might consider increasing the number of multipart upload threads if the issue is indeed just a plain S3 upload timeout:\r\n- https://iceberg.apache.org/docs/latest/aws/#progressive-multipart-upload\r\n\r\nOther things that might help would be allowing Spark to sort the arrays without using the UDFs, but instead using `array_sort` (and possibly using a UDF for the comparison logic, but that might not be needed and keep in mind that UDFs are always best avoided if Spark's built-in functions can achieve the same thing).\r\n\r\nExamples of `sort_array` and `array_sort` (including without a UDF or with one but only one used for comparison and not whole array sorting): https://towardsdatascience.com/the-definitive-way-to-sort-arrays-in-spark-1224f5529961","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207564941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207631150","html_url":"https://github.com/apache/iceberg/pull/5462#issuecomment-1207631150","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5462","id":1207631150,"node_id":"IC_kwDOCW7NX85H-v0u","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T03:51:30Z","updated_at":"2022-08-08T03:51:30Z","author_association":"COLLABORATOR","body":"@Fokko can you help to review it? Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207631150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207637722","html_url":"https://github.com/apache/iceberg/pull/5435#issuecomment-1207637722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5435","id":1207637722,"node_id":"IC_kwDOCW7NX85H-xba","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T04:06:15Z","updated_at":"2022-08-08T04:06:15Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue @kbendick @zhongyujiang @huaxingao for your time to review. Comments have been addressed. Pls take another look when you are free.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207637722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207663648","html_url":"https://github.com/apache/iceberg/issues/4997#issuecomment-1207663648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4997","id":1207663648,"node_id":"IC_kwDOCW7NX85H-3wg","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T04:53:27Z","updated_at":"2022-08-08T04:53:27Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer is it possible to add similar support as what https://github.com/apache/spark/blob/master/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/UnwrapCastInBinaryComparison.scala has done?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207663648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207672827","html_url":"https://github.com/apache/iceberg/pull/5278#issuecomment-1207672827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5278","id":1207672827,"node_id":"IC_kwDOCW7NX85H-5_7","user":{"login":"XN137","id":1204398,"node_id":"MDQ6VXNlcjEyMDQzOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1204398?v=4","gravatar_id":"","url":"https://api.github.com/users/XN137","html_url":"https://github.com/XN137","followers_url":"https://api.github.com/users/XN137/followers","following_url":"https://api.github.com/users/XN137/following{/other_user}","gists_url":"https://api.github.com/users/XN137/gists{/gist_id}","starred_url":"https://api.github.com/users/XN137/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XN137/subscriptions","organizations_url":"https://api.github.com/users/XN137/orgs","repos_url":"https://api.github.com/users/XN137/repos","events_url":"https://api.github.com/users/XN137/events{/privacy}","received_events_url":"https://api.github.com/users/XN137/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T05:11:03Z","updated_at":"2022-08-08T05:11:03Z","author_association":"CONTRIBUTOR","body":"rebased and upgraded to v7.5.1\r\n\r\nping @rdblue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207672827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207674598","html_url":"https://github.com/apache/iceberg/issues/5104#issuecomment-1207674598","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5104","id":1207674598,"node_id":"IC_kwDOCW7NX85H-6bm","user":{"login":"yqf1991","id":14036137,"node_id":"MDQ6VXNlcjE0MDM2MTM3","avatar_url":"https://avatars.githubusercontent.com/u/14036137?v=4","gravatar_id":"","url":"https://api.github.com/users/yqf1991","html_url":"https://github.com/yqf1991","followers_url":"https://api.github.com/users/yqf1991/followers","following_url":"https://api.github.com/users/yqf1991/following{/other_user}","gists_url":"https://api.github.com/users/yqf1991/gists{/gist_id}","starred_url":"https://api.github.com/users/yqf1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yqf1991/subscriptions","organizations_url":"https://api.github.com/users/yqf1991/orgs","repos_url":"https://api.github.com/users/yqf1991/repos","events_url":"https://api.github.com/users/yqf1991/events{/privacy}","received_events_url":"https://api.github.com/users/yqf1991/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T05:14:17Z","updated_at":"2022-08-08T05:14:17Z","author_association":"NONE","body":"+1 ,i meet the same thing ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207674598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207735685","html_url":"https://github.com/apache/iceberg/pull/5434#issuecomment-1207735685","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5434","id":1207735685,"node_id":"IC_kwDOCW7NX85H_JWF","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T06:50:52Z","updated_at":"2022-08-08T06:50:52Z","author_association":"CONTRIBUTOR","body":"> I think it's better to put names like this after a `:` instead of adding characters that can get copied and moved to other places. Putting names after `:` still allows you to see when they are empty or null (e.g. `Cannot find field: `) without adding non-whitespace characters.\r\n\r\nThat makes sense, but how would we want to handle something like `Cannot parse %s from non-array value: %s`?\r\nI feel that `Cannot parse '%s' from non-array value: %s` improves readability. Or we could add the property name to the end in this particular case to have `Cannot parse from non-array value: %s: %s`.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207735685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207816082","html_url":"https://github.com/apache/iceberg/pull/5463#issuecomment-1207816082","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5463","id":1207816082,"node_id":"IC_kwDOCW7NX85H_c-S","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T08:21:46Z","updated_at":"2022-08-08T08:21:46Z","author_association":"MEMBER","body":"cc: @snazy ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207816082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207907487","html_url":"https://github.com/apache/iceberg/pull/5021#issuecomment-1207907487","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5021","id":1207907487,"node_id":"IC_kwDOCW7NX85H_zSf","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T09:51:02Z","updated_at":"2022-08-08T09:51:02Z","author_association":"MEMBER","body":"Updated to apply https://github.com/apache/iceberg/pull/5450#discussion_r939727956. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207907487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207917346","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1207917346","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1207917346,"node_id":"IC_kwDOCW7NX85H_1si","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T10:00:53Z","updated_at":"2022-08-08T10:00:53Z","author_association":"CONTRIBUTOR","body":"But call `table.operations().commit(table.operations().current(), replacementMetadata)` can't update the metadata location (There is some check logic in this method that prevents changes).\r\n I think this PR provides a command line way to accomplish this function.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207917346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207918086","html_url":"https://github.com/apache/iceberg/pull/5450#issuecomment-1207918086","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5450","id":1207918086,"node_id":"IC_kwDOCW7NX85H_14G","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T10:01:37Z","updated_at":"2022-08-08T10:01:37Z","author_association":"MEMBER","body":"Thanks @rdblue for a thorough review. Comments applied, please take another look if you want.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1207918086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208195889","html_url":"https://github.com/apache/iceberg/pull/5281#issuecomment-1208195889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5281","id":1208195889,"node_id":"IC_kwDOCW7NX85IA5sx","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T14:21:33Z","updated_at":"2022-08-08T14:21:33Z","author_association":"CONTRIBUTOR","body":"Auto-formatted and added `IF EXISTS`.\r\nCould you please help to take a look when you are avaliable? @amogh-jahagirdar\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208195889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208324423","html_url":"https://github.com/apache/iceberg/issues/4997#issuecomment-1208324423","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4997","id":1208324423,"node_id":"IC_kwDOCW7NX85IBZFH","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T16:11:09Z","updated_at":"2022-08-08T16:11:09Z","author_association":"MEMBER","body":"@puchengy it seems so, that rule currently only handles casts between numeric types, but seems it also be extended to handle casts between date and string (although we should be conservative there and do not allow any invalid case to slip through). Feel free to raise a PR in Spark if you want to work on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208324423/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208344824","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1208344824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1208344824,"node_id":"IC_kwDOCW7NX85IBeD4","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T16:30:04Z","updated_at":"2022-08-08T16:30:04Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer, I see what you mean. What about fixing the Hive catalog so that the commit succeeds if table metadata can't be loaded? It sounds like we should have better handling for broken tables.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208344824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208351284","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1208351284","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1208351284,"node_id":"IC_kwDOCW7NX85IBfo0","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T16:35:23Z","updated_at":"2022-08-08T16:35:23Z","author_association":"MEMBER","body":"> @RussellSpitzer, I see what you mean. What about fixing the Hive catalog so that the commit succeeds if table metadata can't be loaded? It sounds like we should have better handling for broken tables.\r\n\r\nThat would be ok for me as well, I'm really just looking for a blessed way of fixing these states. I think allowing for dropping an non-iceberg or iceberg table with invalid metadata is probably ok too but that does seem a little scary to me than having an explicit register command which we know isn't part of normal operations.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208351284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208364488","html_url":"https://github.com/apache/iceberg/pull/5425#issuecomment-1208364488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5425","id":1208364488,"node_id":"IC_kwDOCW7NX85IBi3I","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T16:48:39Z","updated_at":"2022-08-08T16:48:39Z","author_association":"CONTRIBUTOR","body":"@rdblue I already left a concern in the issue: https://github.com/apache/iceberg/issues/4190#issuecomment-1203467785.\r\n\r\nIt is too expensive to loading tables at every parallel writer and refresh table at every file open. That can stress the metadata system. Hence, I am not sure if this is the right direction.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208364488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208416907","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1208416907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1208416907,"node_id":"IC_kwDOCW7NX85IBvqL","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T17:40:27Z","updated_at":"2022-08-08T17:40:27Z","author_association":"COLLABORATOR","body":"> What about fixing the Hive catalog so that the commit succeeds if table metadata can't be loaded? It sounds like we should have better handling for broken tables.\r\n\r\nAre we suggesting change dropTable to continue if table metadata cannot be loaded?  (I assume we wont add any force flag?).  That sounds like a great feature, its one of the pain points using Iceberg at least on Hive catalog, dropping a tables where metadata doesnt exist, would love to see a pr on that.\r\n\r\nIt's not the complete solution to the issue I initially filed (rollback corrupt metadata) though, and agree it still would be nice if there's a blessed way somehow","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208416907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208430033","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1208430033","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1208430033,"node_id":"IC_kwDOCW7NX85IBy3R","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T17:54:17Z","updated_at":"2022-08-08T17:54:17Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, in part, yes. I think that if we have situations where a table is corrupted then we should handle those in a better way than just having a table that requires manual intervention. Making DROP work for those tables sounds like a good idea to me. Maybe we could also update `registerTable` to overwrite a corrupt Iceberg table using similar logic. Then we wouldn't need a flag.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208430033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208472725","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1208472725","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1208472725,"node_id":"IC_kwDOCW7NX85IB9SV","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T18:38:15Z","updated_at":"2022-08-08T18:38:15Z","author_association":"CONTRIBUTOR","body":"+1 to detect if the table is corrupt first, then register the table with the new metadata file location. No flag is needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208472725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208479003","html_url":"https://github.com/apache/iceberg/issues/5461#issuecomment-1208479003","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5461","id":1208479003,"node_id":"IC_kwDOCW7NX85IB-0b","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T18:45:37Z","updated_at":"2022-08-09T18:19:42Z","author_association":"CONTRIBUTOR","body":"The `Number of reduce tasks is set to 0 since there's no reduce operator` is something you can ignore. That's just saying that this is a map only job.\r\n\r\nWhat about this here?\r\n```\r\nAn error was reported inserting data. However, it can be successfully executed when ‚Äúset hive.exec.mode.local.auto=true;‚Äù.\r\n```\r\n\r\nDid you try `set hive.exec.mode.local.auto=true;` -- as mentioned in the error -- and did that work?\r\n\r\nAlso, can you provide the Iceberg related configuration for the table and for the job / session? Did you run the `add jar` command and the other steps from https://iceberg.apache.org/docs/latest/hive/?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208479003/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208484436","html_url":"https://github.com/apache/iceberg/issues/5461#issuecomment-1208484436","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5461","id":1208484436,"node_id":"IC_kwDOCW7NX85ICAJU","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T18:49:24Z","updated_at":"2022-08-08T18:49:24Z","author_association":"CONTRIBUTOR","body":"To be more precise, the 0.12.1 Iceberg docs on Hive are here: https://iceberg.apache.org/docs/0.12.1/hive/\r\n\r\nIf there's anymore error stack trace, that would be helpful. As well as the configuration and set up.\r\n\r\nYou also have to set `engine.hive.enabled` on the table that's being written to. See the docs linked above for more info on all of the steps that need to be run such as session properties to set and jars to be added and configuring the catalog properly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208484436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208487791","html_url":"https://github.com/apache/iceberg/issues/5453#issuecomment-1208487791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5453","id":1208487791,"node_id":"IC_kwDOCW7NX85ICA9v","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T18:53:10Z","updated_at":"2022-08-08T18:53:10Z","author_association":"CONTRIBUTOR","body":"Based on the expanded output of the Python stack trace (I didn't scroll over), it seems like _maybe_ one of your tasks is `yield`-ing empty data in your \"dagster\" library. That might lead to the unexpected EOF error (either writing data or reading it back into the JVM from Python - I suspect the second).\r\n\r\nMaybe check that that yield statement isn't returning empty data when trying to coerce to an iterator or something funky?\r\n\r\n```\r\n  File \"/usr/local/lib/python3.9/site-packages/dagster/core/execution/plan/utils.py\", line 47, in solid_execution_error_boundary\r\n    yield\r\n  File \"/usr/local/lib/python3.9/site-packages/dagster/utils/__init__.py\", line 406, in iterate_with_context\r\n    next_output = next(iterator)\r\n  File \"/usr/local/lib/python3.9/site-packages/dagster/core/execution/plan/compute_generator.py\", line 66, in _coerce_solid_compute_fn_to_iterator\r\n    result = fn(context, **kwargs) if context_arg_provided else fn(**kwargs)\r\n  File \"/var/lib/ngods/dagster/spark.py\", line 20, in normalize_food_arrays_op\r\n    data = spark.sql(\r\n  File \"/usr/local/lib/python3.9/site-packages/pyspark/sql/session.py\", line 1034, in sql\r\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\r\n  File \"/usr/local/lib/python3.9/site-packages/py4j/java_gateway.py\", line 1321, in __call__\r\n    return_value = get_return_value(\r\n  File \"/usr/local/lib/python3.9/site-packages/pyspark/sql/utils.py\", line 190, in deco\r\n    return f(*a, **kw)\r\n  File \"/usr/local/lib/python3.9/site-packages/py4j/protocol.py\", line 326, in get_return_value\r\n    raise Py4JJavaError(\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208487791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208518468","html_url":"https://github.com/apache/iceberg/pull/4926#issuecomment-1208518468","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4926","id":1208518468,"node_id":"IC_kwDOCW7NX85ICIdE","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T19:24:02Z","updated_at":"2022-08-08T19:24:02Z","author_association":"CONTRIBUTOR","body":"Thanks @jackye1995 for triggering the approval workflow. @rdblue when you get a chance, let us know how the change looks! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208518468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208572864","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1208572864","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1208572864,"node_id":"IC_kwDOCW7NX85ICVvA","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T20:22:56Z","updated_at":"2022-08-08T20:22:56Z","author_association":"NONE","body":"@singhpk234 i have specified java serializer, but still getting the same kryo exception?\r\n\r\n.config(\"spark.serializer\", \"org.apache.spark.serializer.JavaSerializer\")\r\n\r\n22/08/08 20:19:23 WARN TaskSetManager: Lost task 4.0 in stage 15.0 (TID 1037) (ip-10-158-77-88.cmhemr.indeed.net executor 4): java.io.IOException: com.esotericsoftware.kryo.KryoException: java.lang.UnsupportedOperationException\r\nSerialization trace:\r\nproperties (org.apache.iceberg.aws.s3.S3FileIO)\r\nio (org.apache.iceberg.spark.source.SerializableTableWithSize)\r\n\tat org.apache.spark.util.Utils$.tryOrIOException(Utils.scala:1412)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.readBroadcastBlock(TorrentBroadcast.scala:226)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.getValue(TorrentBroadcast.scala:103)\r\n\tat org.apache.spark.broadcast.Broadcast.value(Broadcast.scala:70)\r\n\tat org.apache.iceberg.spark.source.SparkWrite$WriterFactory.createWriter(SparkWrite.java:566)\r\n\tat org.apache.iceberg.spark.source.SparkWrite$WriterFactory.createWriter(SparkWrite.java:561)\r\n\tat org.apache.spark.sql.execution.datasources.v2.DataWritingSparkTask$.run(WriteToDataSourceV2Exec.scala:408)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2TableWriteExec.$anonfun$writeWithV2$2(WriteToDataSourceV2Exec.scala:360)\r\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:750)\r\nCaused by: com.esotericsoftware.kryo.KryoException: java.lang.UnsupportedOperationException\r\nSerialization trace:\r\nproperties (org.apache.iceberg.aws.s3.S3FileIO)\r\nio (org.apache.iceberg.spark.source.SerializableTableWithSize)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:144)\r\n\tat com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:543)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:731)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:125)\r\n\tat com.esotericsoftware.kryo.serializers.FieldSerializer.read(FieldSerializer.java:543)\r\n\tat com.esotericsoftware.kryo.Kryo.readClassAndObject(Kryo.java:813)\r\n\tat org.apache.spark.serializer.KryoDeserializationStream.readObject(KryoSerializer.scala:297)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast$.$anonfun$unBlockifyObject$4(TorrentBroadcast.scala:336)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast$.unBlockifyObject(TorrentBroadcast.scala:338)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.$anonfun$readBroadcastBlock$4(TorrentBroadcast.scala:257)\r\n\tat scala.Option.getOrElse(Option.scala:189)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.$anonfun$readBroadcastBlock$2(TorrentBroadcast.scala:231)\r\n\tat org.apache.spark.util.KeyLock.withLock(KeyLock.scala:64)\r\n\tat org.apache.spark.broadcast.TorrentBroadcast.$anonfun$readBroadcastBlock$1(TorrentBroadcast.scala:226)\r\n\tat org.apache.spark.util.Utils$.tryOrIOException(Utils.scala:1405)\r\n\t... 15 more\r\n\r\nCaused by: java.lang.UnsupportedOperationException\r\n\tat org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap.put(ImmutableMap.java:714)\r\n\tat com.esotericsoftware.kryo.serializers.MapSerializer.read(MapSerializer.java:162)\r\n\tat com.esotericsoftware.kryo.serializers.MapSerializer.read(MapSerializer.java:39)\r\n\tat com.esotericsoftware.kryo.Kryo.readObject(Kryo.java:731)\r\n\tat com.esotericsoftware.kryo.serializers.ObjectField.read(ObjectField.java:125)\r\n\t... 30 more\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208572864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208652182","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1208652182","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1208652182,"node_id":"IC_kwDOCW7NX85ICpGW","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T21:54:29Z","updated_at":"2022-08-08T21:54:29Z","author_association":"COLLABORATOR","body":"Sounds good.  The only corruption detection we can tell now is if the metadata.json no longer exists, I think, unless there are other things we can easily detect.\r\n\r\nMy initial thought for this pr was actually for non-corrupt case (ie, I have a metadata json that loads fine, but the metadata is wrong, eg  issues listed in #5163).  But I guess the consensus is , the user just writes a script to drop and register the Iceberg table with the right metadata json in that case, and we don't want to extend Iceberg Catalog at this point to handle those cases.\r\n\r\n@yabola sorry about that, but I guess if you want to instead make a patch for the issue (make HiveCatalog.dropTable able to handle non-exist metadata json).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208652182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208689348","html_url":"https://github.com/apache/iceberg/pull/5464#issuecomment-1208689348","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5464","id":1208689348,"node_id":"IC_kwDOCW7NX85ICyLE","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T22:37:11Z","updated_at":"2022-08-08T22:37:11Z","author_association":"CONTRIBUTOR","body":"Looks great. Thanks, @nastra!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208689348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208697810","html_url":"https://github.com/apache/iceberg/issues/2542#issuecomment-1208697810","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2542","id":1208697810,"node_id":"IC_kwDOCW7NX85IC0PS","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-08T22:49:38Z","updated_at":"2022-08-08T22:49:38Z","author_association":"COLLABORATOR","body":"Was chatting with @dramaticlly about it, cc if you want to look at it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208697810/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208801111","html_url":"https://github.com/apache/iceberg/pull/5029#issuecomment-1208801111","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5029","id":1208801111,"node_id":"IC_kwDOCW7NX85IDNdX","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T01:36:54Z","updated_at":"2022-08-09T01:36:54Z","author_association":"CONTRIBUTOR","body":"As the core is being modified, this PR needs to wait for #5364  and #5475  to complete.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208801111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208830953","html_url":"https://github.com/apache/iceberg/pull/4812#issuecomment-1208830953","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4812","id":1208830953,"node_id":"IC_kwDOCW7NX85IDUvp","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T02:10:58Z","updated_at":"2022-08-09T02:10:58Z","author_association":"COLLABORATOR","body":"Some test was cancelled, re-triggering","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208830953/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208850831","html_url":"https://github.com/apache/iceberg/pull/5425#issuecomment-1208850831","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5425","id":1208850831,"node_id":"IC_kwDOCW7NX85IDZmP","user":{"login":"lintingbin","id":5699014,"node_id":"MDQ6VXNlcjU2OTkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5699014?v=4","gravatar_id":"","url":"https://api.github.com/users/lintingbin","html_url":"https://github.com/lintingbin","followers_url":"https://api.github.com/users/lintingbin/followers","following_url":"https://api.github.com/users/lintingbin/following{/other_user}","gists_url":"https://api.github.com/users/lintingbin/gists{/gist_id}","starred_url":"https://api.github.com/users/lintingbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lintingbin/subscriptions","organizations_url":"https://api.github.com/users/lintingbin/orgs","repos_url":"https://api.github.com/users/lintingbin/repos","events_url":"https://api.github.com/users/lintingbin/events{/privacy}","received_events_url":"https://api.github.com/users/lintingbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T02:47:42Z","updated_at":"2022-08-09T02:47:42Z","author_association":"CONTRIBUTOR","body":"@stevenzwu You're right. This does have performance issues. What do you think if we add a broadcast operator to refresh the table, and then send the changed schema to IcebergStreamWriter?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208850831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208875668","html_url":"https://github.com/apache/iceberg/pull/5476#issuecomment-1208875668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5476","id":1208875668,"node_id":"IC_kwDOCW7NX85IDfqU","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T03:43:51Z","updated_at":"2022-08-09T03:43:51Z","author_association":"CONTRIBUTOR","body":"I will just merge this because it is a simple style fix, thanks for the work!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208875668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208884855","html_url":"https://github.com/apache/iceberg/pull/5476#issuecomment-1208884855","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5476","id":1208884855,"node_id":"IC_kwDOCW7NX85IDh53","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T04:04:10Z","updated_at":"2022-08-09T04:04:10Z","author_association":"CONTRIBUTOR","body":"Thanks for the review Jack!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208884855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208885471","html_url":"https://github.com/apache/iceberg/pull/5425#issuecomment-1208885471","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5425","id":1208885471,"node_id":"IC_kwDOCW7NX85IDiDf","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T04:05:14Z","updated_at":"2022-08-09T04:05:14Z","author_association":"CONTRIBUTOR","body":"@lintingbin2009 yes, broadcast operator would work well. Alternatively, if we can have the general operator coordinator available in Flink, it would be a good fit for this problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208885471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208960883","html_url":"https://github.com/apache/iceberg/pull/5425#issuecomment-1208960883","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5425","id":1208960883,"node_id":"IC_kwDOCW7NX85ID0dz","user":{"login":"lintingbin","id":5699014,"node_id":"MDQ6VXNlcjU2OTkwMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/5699014?v=4","gravatar_id":"","url":"https://api.github.com/users/lintingbin","html_url":"https://github.com/lintingbin","followers_url":"https://api.github.com/users/lintingbin/followers","following_url":"https://api.github.com/users/lintingbin/following{/other_user}","gists_url":"https://api.github.com/users/lintingbin/gists{/gist_id}","starred_url":"https://api.github.com/users/lintingbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lintingbin/subscriptions","organizations_url":"https://api.github.com/users/lintingbin/orgs","repos_url":"https://api.github.com/users/lintingbin/repos","events_url":"https://api.github.com/users/lintingbin/events{/privacy}","received_events_url":"https://api.github.com/users/lintingbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T06:18:38Z","updated_at":"2022-08-09T06:18:38Z","author_association":"CONTRIBUTOR","body":"@stevenzwu ok, I will try to use the operator coordinator to refresh the table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208960883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208967246","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1208967246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1208967246,"node_id":"IC_kwDOCW7NX85ID2BO","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T06:28:38Z","updated_at":"2022-08-09T06:28:38Z","author_association":"CONTRIBUTOR","body":"@jessiedanwang I am not sure how kryo serializer comes to play here, are your spark confs overriden somewhere else ?\r\n\r\nIdeally if you don't specify any serializer by default i think spark uses java serializer.\r\n\r\nNote : I tried it with both with specifying `spark.serializer=org.apache.spark.serializer.JavaSerializer` and without specifying any serializer and can confirm it worked for me .. here is a sample spark submit (mostly taken from your spark submit example posted above) \r\n\r\n``` shell\r\nspark-shell --packages org.apache.iceberg:iceberg-spark-runtime-3.1_2.12:0.14.0,software.amazon.awssdk:bundle:2.17.243,software.amazon.awssdk:url-connection-client:2.17.243 --conf spark.serializer=org.apache.spark.serializer.JavaSerializer  \\\r\n--conf spark.driver.memory=4g --conf spark.executor.cores=4 --conf spark.dynamicAllocation.enabled=true --conf spark.sql.catalog.my_catalog=org.apache.iceberg.spark.SparkCatalog --conf spark.sql.catalog.my_catalog.warehouse=s3://<bucket>/<prefix>  \\\r\n--conf spark.sql.catalog.my_catalog.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog --conf spark.sql.catalog.my_catalog.io-impl=org.apache.iceberg.aws.s3.S3FileIO \\\r\n--conf spark.sql.catalog.my_catalog.lock-impl=org.apache.iceberg.aws.glue.DynamoLockManager --conf spark.sql.catalog.my_catalog.lock.table=myGlueLockTable\r\n```\r\n\r\n----\r\n\r\nRegarding kryo serializer class for name :\r\n>   kryo.register(Class.forName(\"org.apache.iceberg.relocated.com.google.common.collect.ImmutableMap\"), serializer)\r\n\r\nyou should this class instead : \r\n```  java\r\nkryo.register(\r\n          Class.forName(\"org.apache.iceberg.relocated.com.google.common.collect.SingletonImmutableBiMap\"),\r\n          serializer);\r\n```\r\n\r\nas this is the actual class being used...  for just POC purpose in the custom serializer i wrote in comment above i just did `    kryo.register(obj.getClass(), serializer);` \r\n\r\nHere is a complete git diff of my changes with custom serializer using `class.forName` : https://gist.github.com/singhpk234/5e570b04a8f8145846e1019a820eaef7\r\n\r\nI hope it helps !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1208967246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209300544","html_url":"https://github.com/apache/iceberg/issues/5027#issuecomment-1209300544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5027","id":1209300544,"node_id":"IC_kwDOCW7NX85IFHZA","user":{"login":"Kontinuation","id":5501374,"node_id":"MDQ6VXNlcjU1MDEzNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/5501374?v=4","gravatar_id":"","url":"https://api.github.com/users/Kontinuation","html_url":"https://github.com/Kontinuation","followers_url":"https://api.github.com/users/Kontinuation/followers","following_url":"https://api.github.com/users/Kontinuation/following{/other_user}","gists_url":"https://api.github.com/users/Kontinuation/gists{/gist_id}","starred_url":"https://api.github.com/users/Kontinuation/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kontinuation/subscriptions","organizations_url":"https://api.github.com/users/Kontinuation/orgs","repos_url":"https://api.github.com/users/Kontinuation/repos","events_url":"https://api.github.com/users/Kontinuation/events{/privacy}","received_events_url":"https://api.github.com/users/Kontinuation/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T12:11:53Z","updated_at":"2022-08-09T12:11:53Z","author_association":"MEMBER","body":"`NAMESPACE_PROPERTY_KEY` [was defined as `VARCHAR(5500)`](https://github.com/apache/iceberg/blob/apache-iceberg-0.14.0/core/src/main/java/org/apache/iceberg/jdbc/JdbcUtil.java#L91), it may not have to be that long. Some value less than 500 is good enough I guess?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209300544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209433520","html_url":"https://github.com/apache/iceberg/pull/4898#issuecomment-1209433520","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4898","id":1209433520,"node_id":"IC_kwDOCW7NX85IFn2w","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T14:09:44Z","updated_at":"2022-08-09T14:09:44Z","author_association":"CONTRIBUTOR","body":"Hi @szehon-ho thanks for reviewing this again. \r\n\r\n> Also I noticed, spec-id and schema is already written in the header of each manifest. As far as I can tell, it seems to be the right one that the manifest was written in, even after rewriteManifests. Wondering at a high level, is it adequate for the optimization you are planning?\r\n\r\nWhat happened after the rewritten data file? It seems like the schema of the manifest file is the current table schema. And those manifest entries in the same manifest file could have a different schema after rewrite. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209433520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209488025","html_url":"https://github.com/apache/iceberg/pull/5021#issuecomment-1209488025","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5021","id":1209488025,"node_id":"IC_kwDOCW7NX85IF1KZ","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T14:53:07Z","updated_at":"2022-08-09T14:53:07Z","author_association":"MEMBER","body":"Build failure \r\n```\r\n> Could not resolve all files for configuration ':classpath'.\r\n   > Could not resolve com.palantir.baseline:gradle-baseline-java:4.0.0.\r\n     Required by:\r\n         project :\r\n      > Could not resolve com.palantir.baseline:gradle-baseline-java:4.0.0.\r\n         > Could not get resource 'https://plugins.gradle.org/m2/com/palantir/baseline/gradle-baseline-java/4.0.0/gradle-baseline-java-4.0.0.pom'.\r\n            > Could not GET 'https://plugins.gradle.org/m2/com/palantir/baseline/gradle-baseline-java/4.0.0/gradle-baseline-java-4.0.0.pom'.\r\n               > The server may not support the client's requested TLS protocol versions: (TLSv1.2, TLSv1.3). You may need to configure the client to allow other protocols to be used. See: https://docs.gradle.org/7.4.2/userguide/build_environment.html#gradle_system_properties\r\n                  > Received fatal alert: handshake_failure\r\n```\r\n\r\nlooks unrelated.\r\n\r\nLet me push amended commit to restart the build.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209488025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209526319","html_url":"https://github.com/apache/iceberg/pull/5425#issuecomment-1209526319","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5425","id":1209526319,"node_id":"IC_kwDOCW7NX85IF-gv","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T15:23:13Z","updated_at":"2022-08-09T15:23:13Z","author_association":"CONTRIBUTOR","body":"@lintingbin2009 operator coordinator base is not available yet in Flink. Here is the jira ticket that my colleague created: https://issues.apache.org/jira/browse/FLINK-27405. We will try to push it forward hopefully in the near future.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209526319/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209593273","html_url":"https://github.com/apache/iceberg/pull/5455#issuecomment-1209593273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5455","id":1209593273,"node_id":"IC_kwDOCW7NX85IGO25","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T16:16:20Z","updated_at":"2022-08-09T16:16:20Z","author_association":"CONTRIBUTOR","body":"Thanks, @dependabot!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209593273/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209594696","html_url":"https://github.com/apache/iceberg/pull/5478#issuecomment-1209594696","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5478","id":1209594696,"node_id":"IC_kwDOCW7NX85IGPNI","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T16:17:45Z","updated_at":"2022-08-09T16:17:45Z","author_association":"CONTRIBUTOR","body":"I don't agree with this change. I think it's good to know that this is skipped, rather than not being able to distinguish between missing logs and not trying to remove the files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209594696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209606913","html_url":"https://github.com/apache/iceberg/pull/5327#issuecomment-1209606913","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5327","id":1209606913,"node_id":"IC_kwDOCW7NX85IGSMB","user":{"login":"yabola","id":31469905,"node_id":"MDQ6VXNlcjMxNDY5OTA1","avatar_url":"https://avatars.githubusercontent.com/u/31469905?v=4","gravatar_id":"","url":"https://api.github.com/users/yabola","html_url":"https://github.com/yabola","followers_url":"https://api.github.com/users/yabola/followers","following_url":"https://api.github.com/users/yabola/following{/other_user}","gists_url":"https://api.github.com/users/yabola/gists{/gist_id}","starred_url":"https://api.github.com/users/yabola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yabola/subscriptions","organizations_url":"https://api.github.com/users/yabola/orgs","repos_url":"https://api.github.com/users/yabola/repos","events_url":"https://api.github.com/users/yabola/events{/privacy}","received_events_url":"https://api.github.com/users/yabola/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T16:29:38Z","updated_at":"2022-08-09T16:29:38Z","author_association":"CONTRIBUTOR","body":"@szehon-ho Sure, I will make another PR for drop corrupt table. Thanks for all your discussions ! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209606913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209607359","html_url":"https://github.com/apache/iceberg/pull/5478#issuecomment-1209607359","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5478","id":1209607359,"node_id":"IC_kwDOCW7NX85IGSS_","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T16:30:04Z","updated_at":"2022-08-09T16:30:04Z","author_association":"MEMBER","body":"We could just move the log line to the \"clean expired\" branch of the if statement, and log \"Local removal of files enabled. Cleaning up manifest and data files\"?\r\n\r\nThat way you can differentiate between \"cleanup disabled\" and \"empty\"?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209607359/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209620514","html_url":"https://github.com/apache/iceberg/pull/5478#issuecomment-1209620514","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5478","id":1209620514,"node_id":"IC_kwDOCW7NX85IGVgi","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T16:43:19Z","updated_at":"2022-08-09T16:58:05Z","author_association":"MEMBER","body":"@RussellSpitzer : Thanks for the suggestion. I added a log at the proper place to identify the empty case.\r\n\r\n@rdblue : If the logs are not present, we can assume cleanup is disabled? if it is not disabled, some logs related to clean-up will be printed. For the users who run the `ExpireSnapshotsAction` this log was confusing as mentioned in the description.\r\nAlso for `ExpireSnapshotsAction`, internal clean-up is always disabled.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209620514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209624233","html_url":"https://github.com/apache/iceberg/issues/5477#issuecomment-1209624233","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5477","id":1209624233,"node_id":"IC_kwDOCW7NX85IGWap","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T16:47:07Z","updated_at":"2022-08-09T16:48:04Z","author_association":"CONTRIBUTOR","body":"Technically there's `-DsparkVersions`, `-DflinkVersions`, `-DhiveVersions` and `-DscalaVersion`, as we can see from `dev/stage-binaries.sh`.\r\n\r\nSo maybe we just document that each of those exists? Some things like `scalaVersion` only affect certain packages (namely Spark related ones).\r\n\r\nFor reference, the complete build steps at present (except the `build` command should be used not `publishApachePublicationToMavenRepository`):\r\n\r\nhttps://github.com/apache/iceberg/blob/b1ab35d66c8f19c9107094b4e26aa8beae94bf22/dev/stage-binaries.sh#L21-L31","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209624233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209635918","html_url":"https://github.com/apache/iceberg/pull/5478#issuecomment-1209635918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5478","id":1209635918,"node_id":"IC_kwDOCW7NX85IGZRO","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T16:58:55Z","updated_at":"2022-08-09T16:58:55Z","author_association":"CONTRIBUTOR","body":"I would like a lot to distinguish between \"didn't try\" and \"nothing to clean up\" -- even when \"nothing to clean up\" is because there were no expired files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209635918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209643668","html_url":"https://github.com/apache/iceberg/pull/5346#issuecomment-1209643668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5346","id":1209643668,"node_id":"IC_kwDOCW7NX85IGbKU","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T17:07:22Z","updated_at":"2022-08-09T17:07:22Z","author_association":"COLLABORATOR","body":"@zhaomin1423 actually do you mind doing the same change for other spark versions?  I feel normally we do feature  for specific spark version(s), but for something like this that's purely cosmetic, would prefer to keep the code synchronized so its easier to backport changes if necessary.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209643668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209643867","html_url":"https://github.com/apache/iceberg/issues/5414#issuecomment-1209643867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5414","id":1209643867,"node_id":"IC_kwDOCW7NX85IGbNb","user":{"login":"jessiedanwang","id":25239320,"node_id":"MDQ6VXNlcjI1MjM5MzIw","avatar_url":"https://avatars.githubusercontent.com/u/25239320?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiedanwang","html_url":"https://github.com/jessiedanwang","followers_url":"https://api.github.com/users/jessiedanwang/followers","following_url":"https://api.github.com/users/jessiedanwang/following{/other_user}","gists_url":"https://api.github.com/users/jessiedanwang/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiedanwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiedanwang/subscriptions","organizations_url":"https://api.github.com/users/jessiedanwang/orgs","repos_url":"https://api.github.com/users/jessiedanwang/repos","events_url":"https://api.github.com/users/jessiedanwang/events{/privacy}","received_events_url":"https://api.github.com/users/jessiedanwang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T17:07:34Z","updated_at":"2022-08-09T17:07:34Z","author_association":"NONE","body":"thanks for getting back to me. I cleaned up the existing database created previously, and now JavaSerializer works. However, kryo serialization is still generating the same error even after i have changed the class name to org.apache.iceberg.relocated.com.google.common.collect.SingletonImmutableBiMap for some reason, which is puzzling. I noticed that the change you made is on spark 3.3 branch, and i am using spark 3.1.2, but i do not think spark version should make a difference, correct?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209643867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209652918","html_url":"https://github.com/apache/iceberg/pull/4898#issuecomment-1209652918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4898","id":1209652918,"node_id":"IC_kwDOCW7NX85IGda2","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T17:17:02Z","updated_at":"2022-08-09T17:17:02Z","author_association":"COLLABORATOR","body":"@ConeyLiu that's a good question, I think (may be wrong) rewriteDataFiles groups files by partition/partition spec, and may not preserve the old schemas.  Ie, all the data files are rewritten with latest schema of that partition spec.  \r\n\r\nI think the situation would be the same even in your proposal to add new schemaid field to data_file, right?  After rewriteDataFiles we have to carry over the latest schema-id of each spec , in order for your initial proposed optimization to be accurate?  Because there may be data in the new file that was written by a later schema.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209652918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209710530","html_url":"https://github.com/apache/iceberg/pull/5443#issuecomment-1209710530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5443","id":1209710530,"node_id":"IC_kwDOCW7NX85IGrfC","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-08-09T18:10:09Z","updated_at":"2022-08-09T18:10:09Z","author_association":"COLLABORATOR","body":"Thanks  @rdblue , for the fast review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1209710530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]