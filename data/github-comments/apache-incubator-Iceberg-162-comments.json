[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098348838","html_url":"https://github.com/apache/iceberg/pull/4555#issuecomment-1098348838","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4555","id":1098348838,"node_id":"IC_kwDOCW7NX85Bd3km","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T18:19:16Z","updated_at":"2022-04-13T18:19:16Z","author_association":"CONTRIBUTOR","body":"@rdblue would you be able to provide some thoughts on this? Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098348838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098375342","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1098375342","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1098375342,"node_id":"IC_kwDOCW7NX85Bd-Cu","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T18:50:32Z","updated_at":"2022-04-13T18:59:07Z","author_association":"CONTRIBUTOR","body":"@kbendick, I agree it is useful to supply locations instead of relying on listing. I believe there is an open PR that can be merged prior to any work discussed here.\r\n\r\n@karuppayya and I spent some time discussing and I personally think @szehon-ho's idea with having an error mode is quite promising. I'd probably have only `error` and `ignore` modes and combine it with other ideas mentioned on this thread. \r\n\r\n- Normalize the path part of URIs to avoid cosmetic differences like extra slashes.\r\n- Introduce `prefix-mismatch-mode` option. Possible values are `error` (default) and `ignore`.\r\n- Expose ways to influence the comparison. For instance, allow passing equivalent schemes.\r\n\r\nI like this approach because it will throw an exception if something suspicious happens and will provide a user ways to resolve conflicts instead of silently taking some action.\r\n\r\nThe actual algorithm can be like this:\r\n\r\n- Build actual file DF\r\n    - Either provided by the user or acquired via listing. If listing, the location must contain a scheme and authority.\r\n- Build reachable file DF via metadata tables\r\n- Transform both actual and reachable DFs so that they contain `scheme`, `authority`, `path` columns.\r\n- Perform LEFT OUTER JOIN on `path` and map partitions.\r\n\r\n```\r\n| actual_scheme | actual_authority | path | valid_scheme | valid_authority | path |\r\n ---------------------------------------------------------------------------------\r\ns3, bucket1, p0, null, null, null -> orphan (no match for the normalized path)\r\ns3, bucket1, p1, null, null, p1 -> not orphan (null scheme/authority in metadata match any scheme/authority)\r\ns3, bucket1, p2, s3a, bucket1, p2 -> not orphan (must have defaults for equivalent schemes like s3 and s3a)\r\ns3, bucket1, p3, s3a, bucket2, p3 -> error by default and can be either ignored or the user may indicate that bucket1 and bucket2 are different, which will make s3, bucket1, p3 orphan. \r\n```\r\n\r\nThis way, we don't need separate DFs with and without prefix and can have more sophisticated comparison.\r\n\r\nAny thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098375342/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098418166","html_url":"https://github.com/apache/iceberg/pull/4528#issuecomment-1098418166","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4528","id":1098418166,"node_id":"IC_kwDOCW7NX85BeIf2","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T19:45:32Z","updated_at":"2022-04-13T19:45:32Z","author_association":"CONTRIBUTOR","body":"FYI @flyrain ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098418166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098445606","html_url":"https://github.com/apache/iceberg/pull/4520#issuecomment-1098445606","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4520","id":1098445606,"node_id":"IC_kwDOCW7NX85BePMm","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T20:15:34Z","updated_at":"2022-04-13T20:15:34Z","author_association":"CONTRIBUTOR","body":"I merged this one to unblock one local change I have. @RussellSpitzer @rdblue, if you could still review, it would be great.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098445606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098462205","html_url":"https://github.com/apache/iceberg/issues/4292#issuecomment-1098462205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4292","id":1098462205,"node_id":"IC_kwDOCW7NX85BeTP9","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T20:34:09Z","updated_at":"2022-04-13T20:34:09Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing, @szlta!\r\n\r\nIt looks like the only remaining point is this:\r\n\r\n> Consider reusing equivalent columns with column IDs during spec evolutions.\r\n\r\nI agree it is quite tricky. Shall we close this issue as the original problem seems to be fixed and open a new issue for the remaining work?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098462205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098519353","html_url":"https://github.com/apache/iceberg/pull/4118#issuecomment-1098519353","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4118","id":1098519353,"node_id":"IC_kwDOCW7NX85BehM5","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T21:48:26Z","updated_at":"2022-04-13T21:48:26Z","author_association":"MEMBER","body":"Any plan to merge the fix to 0.13? Hit it when running `add partition field` with Spark 3.2.1 + Iceberg 0.13.1\r\n\r\n```bash\r\n[spark-3.2.1-bin-hadoop2.7]# bin/spark-sql --packages org.apache.iceberg:iceberg-spark-runtime-3.2_2.12:0.13.1\r\n...\r\nspark-sql> CREATE TABLE local.db.table (id bigint, data string) USING iceberg;\r\nTime taken: 2.61 seconds\r\nspark-sql> INSERT INTO local.db.table VALUES (1, 'a'), (2, 'b'), (3, 'c');\r\nTime taken: 2.745 seconds\r\nspark-sql> table local.db.table;\r\n1       a\r\n2       b\r\n3       c\r\nTime taken: 0.418 seconds, Fetched 3 row(s)\r\nspark-sql> alter table local.db.table add partition field id;\r\nANTLR Runtime version 4.8 used for parser compilation does not match the current runtime version 4.7.1ANTLR Runtime version 4.8 used for parser compilation does not match the current runtime version 4.7.1\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098519353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098520209","html_url":"https://github.com/apache/iceberg/pull/4118#issuecomment-1098520209","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4118","id":1098520209,"node_id":"IC_kwDOCW7NX85BehaR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T21:49:39Z","updated_at":"2022-04-13T21:49:39Z","author_association":"CONTRIBUTOR","body":"@jzhuge, the fix is to update the ANTLR version to match Spark's ANTLR version. It should be a fairly simple PR. Would you like to open it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098520209/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098524289","html_url":"https://github.com/apache/iceberg/pull/4520#issuecomment-1098524289","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4520","id":1098524289,"node_id":"IC_kwDOCW7NX85BeiaB","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T21:55:58Z","updated_at":"2022-04-13T21:55:58Z","author_association":"COLLABORATOR","body":"Thanks all, ill also look at merging this to the 0.13.x branch for the 0.13.2 release (as the metadata tables hierarchy is different in master).  @rdblue Let me know if this is not the right branch.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098524289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098528062","html_url":"https://github.com/apache/iceberg/pull/3470#issuecomment-1098528062","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3470","id":1098528062,"node_id":"IC_kwDOCW7NX85BejU-","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T22:02:33Z","updated_at":"2022-04-13T22:02:33Z","author_association":"MEMBER","body":"Oh sorry I forgot we talked about this before. Everyone is on board so let's move forward.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098528062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098528694","html_url":"https://github.com/apache/iceberg/pull/3470#issuecomment-1098528694","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3470","id":1098528694,"node_id":"IC_kwDOCW7NX85Beje2","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T22:03:42Z","updated_at":"2022-04-13T22:03:50Z","author_association":"MEMBER","body":"Thanks @ggershinsky for the pr and \r\n@jackye1995 + @flyrain and @shangxinli  for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098528694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098551481","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1098551481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1098551481,"node_id":"IC_kwDOCW7NX85BepC5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T22:47:39Z","updated_at":"2022-04-13T22:47:39Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, that plan sounds great to me. I think that covers all the cases we need to.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098551481/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098552511","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1098552511","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1098552511,"node_id":"IC_kwDOCW7NX85BepS_","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-13T22:49:48Z","updated_at":"2022-04-13T22:49:48Z","author_association":"COLLABORATOR","body":"Yea, it sounds good.\r\n\r\nIf I understand correctly, we will have a pluggable way to specify \"prefix equivalencies\", and default ones like :\r\n\r\n-  S3/S3A => schemes are equal\r\n-  HDFS scheme=> ignore authority\r\n\r\nThen prefix-mismatch-mode = error, will cause error if the prefixes are still different after applying these equivalencies.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098552511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098590641","html_url":"https://github.com/apache/iceberg/pull/4553#issuecomment-1098590641","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4553","id":1098590641,"node_id":"IC_kwDOCW7NX85Beymx","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T00:13:45Z","updated_at":"2022-04-14T00:13:45Z","author_association":"CONTRIBUTOR","body":"Oh also cc @openinx @stevenzwu @Reo-LEI @hililiwei if you're interested in taking a look at this test case that fails when updating the codebase to Flink 1.15.\r\n\r\nI had to make a few additions that are marked by `// UPDATED` in the code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098590641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098638470","html_url":"https://github.com/apache/iceberg/issues/4552#issuecomment-1098638470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4552","id":1098638470,"node_id":"IC_kwDOCW7NX85Be-SG","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T02:07:40Z","updated_at":"2022-04-14T02:07:40Z","author_association":"CONTRIBUTOR","body":"In upsert mode there will generate one delete data for everyone insert data, and the delete data will be write to equal delete file(if there is duplicate primary key data be write in one snapshot will add postion delete file).So, just as you see there are two files that one data file and one equal delete file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098638470/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098732569","html_url":"https://github.com/apache/iceberg/issues/4552#issuecomment-1098732569","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4552","id":1098732569,"node_id":"IC_kwDOCW7NX85BfVQZ","user":{"login":"0xffmeta","id":98149057,"node_id":"U_kgDOBdmiwQ","avatar_url":"https://avatars.githubusercontent.com/u/98149057?v=4","gravatar_id":"","url":"https://api.github.com/users/0xffmeta","html_url":"https://github.com/0xffmeta","followers_url":"https://api.github.com/users/0xffmeta/followers","following_url":"https://api.github.com/users/0xffmeta/following{/other_user}","gists_url":"https://api.github.com/users/0xffmeta/gists{/gist_id}","starred_url":"https://api.github.com/users/0xffmeta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/0xffmeta/subscriptions","organizations_url":"https://api.github.com/users/0xffmeta/orgs","repos_url":"https://api.github.com/users/0xffmeta/repos","events_url":"https://api.github.com/users/0xffmeta/events{/privacy}","received_events_url":"https://api.github.com/users/0xffmeta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T05:46:55Z","updated_at":"2022-04-14T05:46:55Z","author_association":"CONTRIBUTOR","body":"@hameizi Thanks for the help. Do we have any documentation for the file naming convention? I noticed `xx-00002.parquet` and `xx-00001.parquet`, and similar for `xx-m0.avro` and `xx-m1.avro`. \r\nI checked this [doc](https://iceberg.apache.org/spec/), but seems no related documentation. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098732569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098734473","html_url":"https://github.com/apache/iceberg/issues/4552#issuecomment-1098734473","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4552","id":1098734473,"node_id":"IC_kwDOCW7NX85BfVuJ","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T05:51:18Z","updated_at":"2022-04-14T05:51:18Z","author_association":"CONTRIBUTOR","body":"> @hameizi Thanks for the help. Do we have any documentation for the file naming convention? I noticed `xx-00002.parquet` and `xx-00001.parquet`, and similar for `xx-m0.avro` and `xx-m1.avro`. I checked this [doc](https://iceberg.apache.org/spec/), but seems no related documentation.\r\n\r\nYou can see https://iceberg.apache.org/spec/#manifests and https://iceberg.apache.org/spec/#row-level-deletes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098734473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098858094","html_url":"https://github.com/apache/iceberg/pull/4307#issuecomment-1098858094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4307","id":1098858094,"node_id":"IC_kwDOCW7NX85Bfz5u","user":{"login":"ulmako","id":2621219,"node_id":"MDQ6VXNlcjI2MjEyMTk=","avatar_url":"https://avatars.githubusercontent.com/u/2621219?v=4","gravatar_id":"","url":"https://api.github.com/users/ulmako","html_url":"https://github.com/ulmako","followers_url":"https://api.github.com/users/ulmako/followers","following_url":"https://api.github.com/users/ulmako/following{/other_user}","gists_url":"https://api.github.com/users/ulmako/gists{/gist_id}","starred_url":"https://api.github.com/users/ulmako/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ulmako/subscriptions","organizations_url":"https://api.github.com/users/ulmako/orgs","repos_url":"https://api.github.com/users/ulmako/repos","events_url":"https://api.github.com/users/ulmako/events{/privacy}","received_events_url":"https://api.github.com/users/ulmako/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T08:38:19Z","updated_at":"2022-04-14T08:38:19Z","author_association":"CONTRIBUTOR","body":"@rdblue, sorry it took me so long to remove the `+1000`. I somehow missed your last comment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1098858094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099109951","html_url":"https://github.com/apache/iceberg/pull/4377#issuecomment-1099109951","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4377","id":1099109951,"node_id":"IC_kwDOCW7NX85BgxY_","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T11:57:16Z","updated_at":"2022-04-14T11:57:16Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer PR is ready for another round of review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099109951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099377529","html_url":"https://github.com/apache/iceberg/pull/4516#issuecomment-1099377529","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4516","id":1099377529,"node_id":"IC_kwDOCW7NX85Bhyt5","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T16:29:47Z","updated_at":"2022-04-14T16:29:47Z","author_association":"COLLABORATOR","body":"I tried to test these cases, while this fixes the PartitionsTable schema, some of the partition entries may have problems (as current spec is still used in a few other places).   I made #4560 pr as a follow up (@szlta sorry I was not sure if you were working on going to work on this or something else).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099377529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099379194","html_url":"https://github.com/apache/iceberg/pull/4560#issuecomment-1099379194","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4560","id":1099379194,"node_id":"IC_kwDOCW7NX85BhzH6","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T16:30:57Z","updated_at":"2022-04-14T16:30:57Z","author_association":"COLLABORATOR","body":"FYI @rdblue @aokolnychyi @RussellSpitzer @szlta if can you help review, thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099379194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099462449","html_url":"https://github.com/apache/iceberg/pull/4558#issuecomment-1099462449","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4558","id":1099462449,"node_id":"IC_kwDOCW7NX85BiHcx","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T17:45:02Z","updated_at":"2022-04-14T17:45:02Z","author_association":"MEMBER","body":"Definitely worth doing\r\nThanks @liuml07 ! I always forget this\r\n\r\nThanks @szehon-ho for reviewing as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099462449/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099523480","html_url":"https://github.com/apache/iceberg/issues/4563#issuecomment-1099523480","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4563","id":1099523480,"node_id":"IC_kwDOCW7NX85BiWWY","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T18:46:39Z","updated_at":"2022-04-14T18:46:39Z","author_association":"CONTRIBUTOR","body":"Hm. I think that we want to allow the user to drop columns that are used by old partition specs. But that means we will need to handle specs that can't be bound to the current schema.\r\n\r\nWe recently introduced an `UnboundPartitionSpec` class that can be used in places before there is a schema to use with the spec. I think we should probably use that in other places instead of a `PartitionSpec` that has a concrete schema.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099523480/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099541194","html_url":"https://github.com/apache/iceberg/pull/4465#issuecomment-1099541194","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4465","id":1099541194,"node_id":"IC_kwDOCW7NX85BiarK","user":{"login":"electrum","id":9230,"node_id":"MDQ6VXNlcjkyMzA=","avatar_url":"https://avatars.githubusercontent.com/u/9230?v=4","gravatar_id":"","url":"https://api.github.com/users/electrum","html_url":"https://github.com/electrum","followers_url":"https://api.github.com/users/electrum/followers","following_url":"https://api.github.com/users/electrum/following{/other_user}","gists_url":"https://api.github.com/users/electrum/gists{/gist_id}","starred_url":"https://api.github.com/users/electrum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrum/subscriptions","organizations_url":"https://api.github.com/users/electrum/orgs","repos_url":"https://api.github.com/users/electrum/repos","events_url":"https://api.github.com/users/electrum/events{/privacy}","received_events_url":"https://api.github.com/users/electrum/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T19:11:15Z","updated_at":"2022-04-14T19:11:15Z","author_association":"CONTRIBUTOR","body":"Does this support Data Lake Storage Gen2?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099541194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099553833","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1099553833","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1099553833,"node_id":"IC_kwDOCW7NX85Bidwp","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T19:29:25Z","updated_at":"2022-04-14T19:29:25Z","author_association":"CONTRIBUTOR","body":"I was thinking about giving up on `ignore-*` options and instead exposing two options in the procedure that would be translated into `Map<String, List<String>>` in the underlying action:\r\n\r\n```\r\nequal_schemes\r\nequal_authorities\r\n```\r\n\r\nThat does not solve one case when buckets are indeed different but the path is the same and we have a valid orphan file.\r\n\r\n```\r\ns3://bucket1/path/to/file.parquet\r\ns3://bucket2/path/to/file.parquet\r\n```\r\n\r\nFor that purpose, we can expose `unequal_authorities` unless anyone has better ideas.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099553833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099651817","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1099651817","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1099651817,"node_id":"IC_kwDOCW7NX85Bi1rp","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T21:39:55Z","updated_at":"2022-04-14T21:51:01Z","author_association":"COLLABORATOR","body":"> That does not solve one case when buckets are indeed different but the path is the same and we have a valid orphan file.\r\n\r\nSorry I'm missing this example, why does equalAuthority=false not handle this case and we need more than two flags?\r\n\r\nOne thought to keep the prefix-mismatch-mode flag simple with only error/ignore, is have separate PrefixComparator:\r\n-equals(String thisScheme, String thatScheme, String thisAuth, String thatAuth)\r\nwith built in S3/HDFS defaults, which can be configured.\r\n\r\nIt would normally not need configuration from user but could allow user to customize it (say restrict HDFS to specific authority equality depending on namenode mappings.  Ex, \r\n\r\nprefix.mismatch.mode=error\r\nprefix.compartaor.authority.equals=nn1, 1.2.3.4:8000 // * for all equals, unset it for all unequal?\r\nprefix.comparator.scheme.equals =s3,s3a  \r\nprefix.comparator=...  //if need to override entire comparator?\r\n\r\nBut up to you, if this is overkill","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099651817/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099682611","html_url":"https://github.com/apache/iceberg/pull/4465#issuecomment-1099682611","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4465","id":1099682611,"node_id":"IC_kwDOCW7NX85Bi9Mz","user":{"login":"sumeetgajjar","id":7351922,"node_id":"MDQ6VXNlcjczNTE5MjI=","avatar_url":"https://avatars.githubusercontent.com/u/7351922?v=4","gravatar_id":"","url":"https://api.github.com/users/sumeetgajjar","html_url":"https://github.com/sumeetgajjar","followers_url":"https://api.github.com/users/sumeetgajjar/followers","following_url":"https://api.github.com/users/sumeetgajjar/following{/other_user}","gists_url":"https://api.github.com/users/sumeetgajjar/gists{/gist_id}","starred_url":"https://api.github.com/users/sumeetgajjar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sumeetgajjar/subscriptions","organizations_url":"https://api.github.com/users/sumeetgajjar/orgs","repos_url":"https://api.github.com/users/sumeetgajjar/repos","events_url":"https://api.github.com/users/sumeetgajjar/events{/privacy}","received_events_url":"https://api.github.com/users/sumeetgajjar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T22:32:45Z","updated_at":"2022-04-14T22:32:45Z","author_association":"CONTRIBUTOR","body":"> Does this support Data Lake Storage Gen2?\r\n\r\nHi @electrum - yes, DataLake Storage Gen2 is supported. In fact, we only support Gen2. \r\nGen1 is set to retire on Feb 29, 2024 thus no point in adding support for it: https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-overview","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099682611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099688485","html_url":"https://github.com/apache/iceberg/pull/4556#issuecomment-1099688485","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4556","id":1099688485,"node_id":"IC_kwDOCW7NX85Bi-ol","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T22:36:51Z","updated_at":"2022-04-14T22:36:51Z","author_association":"COLLABORATOR","body":"Thanks @polaris6 , maybe we can fill the description for future reference","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099688485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099692359","html_url":"https://github.com/apache/iceberg/pull/4559#issuecomment-1099692359","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4559","id":1099692359,"node_id":"IC_kwDOCW7NX85Bi_lH","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T22:39:06Z","updated_at":"2022-04-14T22:39:06Z","author_association":"COLLABORATOR","body":"Thanks @GoGoWen ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099692359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099703296","html_url":"https://github.com/apache/iceberg/pull/4518#issuecomment-1099703296","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4518","id":1099703296,"node_id":"IC_kwDOCW7NX85BjCQA","user":{"login":"rizaon","id":6033430,"node_id":"MDQ6VXNlcjYwMzM0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/6033430?v=4","gravatar_id":"","url":"https://api.github.com/users/rizaon","html_url":"https://github.com/rizaon","followers_url":"https://api.github.com/users/rizaon/followers","following_url":"https://api.github.com/users/rizaon/following{/other_user}","gists_url":"https://api.github.com/users/rizaon/gists{/gist_id}","starred_url":"https://api.github.com/users/rizaon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rizaon/subscriptions","organizations_url":"https://api.github.com/users/rizaon/orgs","repos_url":"https://api.github.com/users/rizaon/repos","events_url":"https://api.github.com/users/rizaon/events{/privacy}","received_events_url":"https://api.github.com/users/rizaon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-14T23:02:18Z","updated_at":"2022-04-14T23:02:18Z","author_association":"CONTRIBUTOR","body":"[c032b7a](https://github.com/apache/iceberg/pull/4518/commits/c032b7ab2f2db941fe5433c13a38dfcb8bf538ef) implement caching as a new FileIO class, CachingHadoopFileIO. A new Tables class, CachingHadoopTables, is also added to assist with testing.\r\n\r\nWe tried to avoid `lazyStats()` call as much as possible by checking the cache first before checking for stream length. This comes with a risk of keeping stale data in memory when the actual file is already deleted, as shown in `CachingHiveTableTest.testMissingMetadataWontCauseHang()`. This is probably fine, given the immutable nature of iceberg metadata. Otherwise, application should invalidate cache entry first to force re-read / `lazyStats()` call.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099703296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099734525","html_url":"https://github.com/apache/iceberg/pull/4546#issuecomment-1099734525","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4546","id":1099734525,"node_id":"IC_kwDOCW7NX85BjJ39","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T00:13:58Z","updated_at":"2022-04-15T00:37:32Z","author_association":"CONTRIBUTOR","body":"> One concern I was thinking in general even from #4456 , whether all this JSON parsing increase the commit times which can be sensitive for Streaming applications (I guess having that flag to control partition length is good in #4456 as user can set it to 0 if so, but it doesn't help these ones). At some point should measure the commit time perf for large tables. Or just have a follow up pr for a flag to disable all these stats persistence altogether if its a concern, as right now there's no way to opt-out, wdyt?\r\n\r\nOut of all table properties synced to HMS, schema, snapshot summary, partition spec will more likely impact the commit perf. We may think of a general way to control that.  I'd suggest to handle that in another PR. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099734525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099764828","html_url":"https://github.com/apache/iceberg/pull/4566#issuecomment-1099764828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4566","id":1099764828,"node_id":"IC_kwDOCW7NX85BjRRc","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T01:10:32Z","updated_at":"2022-04-15T01:10:32Z","author_association":"CONTRIBUTOR","body":"cc @kbendick @szehon-ho @karuppayya @RussellSpitzer @flyrain @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099764828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099802157","html_url":"https://github.com/apache/iceberg/pull/4553#issuecomment-1099802157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4553","id":1099802157,"node_id":"IC_kwDOCW7NX85BjaYt","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T02:51:50Z","updated_at":"2022-04-15T02:51:50Z","author_association":"CONTRIBUTOR","body":"> In this test, the primary key fo the changelog table is the same as the partition schema (vs a subset).\r\n> \r\n> ```\r\n> org.apache.iceberg.flink.TestChangeLogTable > testChangeLogOnDataKey[PartitionedTable=true] FAILED\r\n>     java.lang.AssertionError: Should have the expected records for the checkpoint#2 expected:<[Record(1, aaa), Record(2, ccc), Record(2, aaa), Record(1, ccc)]> but was:<[Record(1, aaa), Record(2, bbb), Record(2, ccc), Record(2, aaa), Record(1, bbb, 1, false), Record(1, ccc)]>\r\n>         at org.junit.Assert.fail(Assert.java:89)\r\n>         at org.junit.Assert.failNotEquals(Assert.java:835)\r\n>         at org.junit.Assert.assertEquals(Assert.java:120)\r\n>         at org.apache.iceberg.flink.TestChangeLogTable.testSqlChangeLog(TestChangeLogTable.java:285)\r\n>         at org.apache.iceberg.flink.TestChangeLogTable.testChangeLogOnDataKey(TestChangeLogTable.java:167)\r\n> \r\n\r\n@kbendick After roughly investigating, guess that it is because the condition whether apply upsert materialize changed.\r\nAfter applying SinkUpsertMaterializer, the records iceberg writer receiving are not the original input records, it causes the failing case. \r\nIn 1.14.0, the condition returns false. We can disable it temporarily by setting `table.exec.sink.upsert-materialize` to None, then the cases can pass.\r\n\r\nMaybe the test cases are invalid, we can decide whether to and how to fix it after more investigating.\r\n\r\nFYI:\r\nhttps://github.com/apache/flink/pull/17699","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099802157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099804287","html_url":"https://github.com/apache/iceberg/issues/4567#issuecomment-1099804287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4567","id":1099804287,"node_id":"IC_kwDOCW7NX85Bja5_","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T02:58:34Z","updated_at":"2022-04-15T02:59:05Z","author_association":"MEMBER","body":"Iceberg tables only have two possible versions (1 or 2) and this is stored in the format-version table property \n\n1. Is the original spec\n2. Includes delete files for merge on read","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099804287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099821048","html_url":"https://github.com/apache/iceberg/issues/4567#issuecomment-1099821048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4567","id":1099821048,"node_id":"IC_kwDOCW7NX85Bje_4","user":{"login":"sontt710","id":31494976,"node_id":"MDQ6VXNlcjMxNDk0OTc2","avatar_url":"https://avatars.githubusercontent.com/u/31494976?v=4","gravatar_id":"","url":"https://api.github.com/users/sontt710","html_url":"https://github.com/sontt710","followers_url":"https://api.github.com/users/sontt710/followers","following_url":"https://api.github.com/users/sontt710/following{/other_user}","gists_url":"https://api.github.com/users/sontt710/gists{/gist_id}","starred_url":"https://api.github.com/users/sontt710/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sontt710/subscriptions","organizations_url":"https://api.github.com/users/sontt710/orgs","repos_url":"https://api.github.com/users/sontt710/repos","events_url":"https://api.github.com/users/sontt710/events{/privacy}","received_events_url":"https://api.github.com/users/sontt710/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T03:37:38Z","updated_at":"2022-04-15T03:37:38Z","author_association":"NONE","body":"Thanks @RussellSpitzer , I agree with you.\r\n\r\nBut in Our environment have multiple iceberg-spark-runtime-* for testing, so I want to know table was created from which runtime version","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099821048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099835170","html_url":"https://github.com/apache/iceberg/issues/4567#issuecomment-1099835170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4567","id":1099835170,"node_id":"IC_kwDOCW7NX85Bjici","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T04:16:18Z","updated_at":"2022-04-15T04:16:18Z","author_association":"MEMBER","body":"This is not recorded in any way as the version shouldn't make a difference in the spec the table is written with. There should be no material difference other than possibly changing defaults.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099835170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099844506","html_url":"https://github.com/apache/iceberg/issues/4565#issuecomment-1099844506","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4565","id":1099844506,"node_id":"IC_kwDOCW7NX85Bjkua","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T04:39:56Z","updated_at":"2022-04-15T04:39:56Z","author_association":"CONTRIBUTOR","body":"Does removing the field using the transform also results in the same scenario?\r\n\r\n```\r\ntable.updateSpec().removeField(Expressions.truncate(\"id\", 5000000)).commit();\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099844506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099847636","html_url":"https://github.com/apache/iceberg/issues/4567#issuecomment-1099847636","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4567","id":1099847636,"node_id":"IC_kwDOCW7NX85BjlfU","user":{"login":"sontt710","id":31494976,"node_id":"MDQ6VXNlcjMxNDk0OTc2","avatar_url":"https://avatars.githubusercontent.com/u/31494976?v=4","gravatar_id":"","url":"https://api.github.com/users/sontt710","html_url":"https://github.com/sontt710","followers_url":"https://api.github.com/users/sontt710/followers","following_url":"https://api.github.com/users/sontt710/following{/other_user}","gists_url":"https://api.github.com/users/sontt710/gists{/gist_id}","starred_url":"https://api.github.com/users/sontt710/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sontt710/subscriptions","organizations_url":"https://api.github.com/users/sontt710/orgs","repos_url":"https://api.github.com/users/sontt710/repos","events_url":"https://api.github.com/users/sontt710/events{/privacy}","received_events_url":"https://api.github.com/users/sontt710/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T04:50:42Z","updated_at":"2022-04-15T04:50:42Z","author_association":"NONE","body":"thanks @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099847636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099851125","html_url":"https://github.com/apache/iceberg/issues/4565#issuecomment-1099851125","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4565","id":1099851125,"node_id":"IC_kwDOCW7NX85BjmV1","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T05:02:43Z","updated_at":"2022-04-15T05:02:43Z","author_association":"MEMBER","body":"@nreich , Could you try with the latest master code? I think you met with [this issue](https://github.com/apache/iceberg/pull/3411), the partition evolution is not handled properly in 0.13.1 for manifest metadata table and it got fixed recently and will be shipped in upcoming 0.13.2 release","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099851125/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099879332","html_url":"https://github.com/apache/iceberg/pull/4553#issuecomment-1099879332","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4553","id":1099879332,"node_id":"IC_kwDOCW7NX85BjtOk","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T06:04:02Z","updated_at":"2022-04-15T06:04:02Z","author_association":"CONTRIBUTOR","body":"> > In this test, the primary key fo the changelog table is the same as the partition schema (vs a subset).\r\n> > ```\r\n> > org.apache.iceberg.flink.TestChangeLogTable > testChangeLogOnDataKey[PartitionedTable=true] FAILED\r\n> >     java.lang.AssertionError: Should have the expected records for the checkpoint#2 expected:<[Record(1, aaa), Record(2, ccc), Record(2, aaa), Record(1, ccc)]> but was:<[Record(1, aaa), Record(2, bbb), Record(2, ccc), Record(2, aaa), Record(1, bbb, 1, false), Record(1, ccc)]>\r\n> >         at org.junit.Assert.fail(Assert.java:89)\r\n> >         at org.junit.Assert.failNotEquals(Assert.java:835)\r\n> >         at org.junit.Assert.assertEquals(Assert.java:120)\r\n> >         at org.apache.iceberg.flink.TestChangeLogTable.testSqlChangeLog(TestChangeLogTable.java:285)\r\n> >         at org.apache.iceberg.flink.TestChangeLogTable.testChangeLogOnDataKey(TestChangeLogTable.java:167)\r\n> > ```\r\n> \r\n> @kbendick After roughly investigating, guess that it is because the condition whether apply upsert materialize changed. After applying SinkUpsertMaterializer, the records iceberg writer receiving are not the original input records, it causes the failing case. In 1.14.0, the condition returns false. We can disable it temporarily by setting `table.exec.sink.upsert-materialize` to None, then the cases can pass.\r\n> \r\n> Maybe the test cases are invalid, we can decide whether to and how to fix it after more investigating.\r\n> \r\n> FYI: [apache/flink#17699](https://github.com/apache/flink/pull/17699)\r\n\r\nThank you @yittg! In the interests of keeping the code the same for the port, lets add the config value and then open an issue to update the tests if need be.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099879332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099890173","html_url":"https://github.com/apache/iceberg/pull/4463#issuecomment-1099890173","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4463","id":1099890173,"node_id":"IC_kwDOCW7NX85Bjv39","user":{"login":"polaris6","id":29967142,"node_id":"MDQ6VXNlcjI5OTY3MTQy","avatar_url":"https://avatars.githubusercontent.com/u/29967142?v=4","gravatar_id":"","url":"https://api.github.com/users/polaris6","html_url":"https://github.com/polaris6","followers_url":"https://api.github.com/users/polaris6/followers","following_url":"https://api.github.com/users/polaris6/following{/other_user}","gists_url":"https://api.github.com/users/polaris6/gists{/gist_id}","starred_url":"https://api.github.com/users/polaris6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polaris6/subscriptions","organizations_url":"https://api.github.com/users/polaris6/orgs","repos_url":"https://api.github.com/users/polaris6/repos","events_url":"https://api.github.com/users/polaris6/events{/privacy}","received_events_url":"https://api.github.com/users/polaris6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T06:28:47Z","updated_at":"2022-04-16T02:33:33Z","author_association":"CONTRIBUTOR","body":"@rdblue Hi Ryan Blue, excuse me, could you please help me to review this pr? thank you very much!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099890173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099900415","html_url":"https://github.com/apache/iceberg/pull/3411#issuecomment-1099900415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3411","id":1099900415,"node_id":"IC_kwDOCW7NX85BjyX_","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T06:52:01Z","updated_at":"2022-04-15T06:58:09Z","author_association":"COLLABORATOR","body":"Should this fix be included in 0.13.2?  @rdblue @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099900415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099949158","html_url":"https://github.com/apache/iceberg/pull/2577#issuecomment-1099949158","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2577","id":1099949158,"node_id":"IC_kwDOCW7NX85Bj-Rm","user":{"login":"jshmchenxi","id":11854435,"node_id":"MDQ6VXNlcjExODU0NDM1","avatar_url":"https://avatars.githubusercontent.com/u/11854435?v=4","gravatar_id":"","url":"https://api.github.com/users/jshmchenxi","html_url":"https://github.com/jshmchenxi","followers_url":"https://api.github.com/users/jshmchenxi/followers","following_url":"https://api.github.com/users/jshmchenxi/following{/other_user}","gists_url":"https://api.github.com/users/jshmchenxi/gists{/gist_id}","starred_url":"https://api.github.com/users/jshmchenxi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jshmchenxi/subscriptions","organizations_url":"https://api.github.com/users/jshmchenxi/orgs","repos_url":"https://api.github.com/users/jshmchenxi/repos","events_url":"https://api.github.com/users/jshmchenxi/events{/privacy}","received_events_url":"https://api.github.com/users/jshmchenxi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T08:09:35Z","updated_at":"2022-04-15T08:09:35Z","author_association":"CONTRIBUTOR","body":"Sure, thanks Ryan!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1099949158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100075111","html_url":"https://github.com/apache/iceberg/pull/4534#issuecomment-1100075111","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4534","id":1100075111,"node_id":"IC_kwDOCW7NX85BkdBn","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T12:25:11Z","updated_at":"2022-04-15T12:25:11Z","author_association":"MEMBER","body":"> This makes sense to me, although i was wondering when I saw the title whether you were going to implement a full FileIO since we could be using that now. I think this is fine for these tests though\r\n\r\nNot until i need that :) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100075111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100085945","html_url":"https://github.com/apache/iceberg/pull/4534#issuecomment-1100085945","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4534","id":1100085945,"node_id":"IC_kwDOCW7NX85Bkfq5","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T12:49:55Z","updated_at":"2022-04-15T12:49:55Z","author_association":"MEMBER","body":"AC ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100085945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100184079","html_url":"https://github.com/apache/iceberg/pull/3411#issuecomment-1100184079","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3411","id":1100184079,"node_id":"IC_kwDOCW7NX85Bk3oP","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T15:40:16Z","updated_at":"2022-04-15T15:40:16Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, that sounds fine to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100184079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100197829","html_url":"https://github.com/apache/iceberg/pull/4554#issuecomment-1100197829","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4554","id":1100197829,"node_id":"IC_kwDOCW7NX85Bk6_F","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:02:45Z","updated_at":"2022-04-15T16:02:45Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100197829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100214247","html_url":"https://github.com/apache/iceberg/pull/3411#issuecomment-1100214247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3411","id":1100214247,"node_id":"IC_kwDOCW7NX85Bk-_n","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:31:25Z","updated_at":"2022-04-15T16:31:49Z","author_association":"COLLABORATOR","body":":thumbsup: looks like it has popped up in a few places.  \r\n\r\nThanks, @ConeyLiu  let me know if you want to make a pr against 0.13.x branch and I can review, otherwise i will take a look.  (not sure exactly if thats the process)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100214247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100216684","html_url":"https://github.com/apache/iceberg/pull/4561#issuecomment-1100216684","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4561","id":1100216684,"node_id":"IC_kwDOCW7NX85Bk_ls","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:36:13Z","updated_at":"2022-04-15T16:36:13Z","author_association":"CONTRIBUTOR","body":"@wuwenchi, can you please credit the author of the unit test?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100216684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100216969","html_url":"https://github.com/apache/iceberg/pull/4546#issuecomment-1100216969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4546","id":1100216969,"node_id":"IC_kwDOCW7NX85Bk_qJ","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:36:55Z","updated_at":"2022-04-15T16:36:55Z","author_association":"COLLABORATOR","body":"> Out of all table properties synced to HMS, schema, snapshot summary, partition spec will more likely impact the commit perf. We may think of a general way to control that. I'd suggest to handle that in another PR.\r\n\r\nYea I was mentioning, a follow-up PR is fine, or if someone has any other idea about this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100216969/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100219075","html_url":"https://github.com/apache/iceberg/pull/4555#issuecomment-1100219075","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4555","id":1100219075,"node_id":"IC_kwDOCW7NX85BlALD","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:41:23Z","updated_at":"2022-04-15T16:41:23Z","author_association":"CONTRIBUTOR","body":"@SinghAsDev, does reading 2-level lists work after this PR? Could you write an end-to-end test that validates it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100219075/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100221708","html_url":"https://github.com/apache/iceberg/pull/4298#issuecomment-1100221708","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4298","id":1100221708,"node_id":"IC_kwDOCW7NX85BlA0M","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:47:03Z","updated_at":"2022-04-15T16:47:03Z","author_association":"CONTRIBUTOR","body":"@openinx, is this related to the other PR that refactors the writers? Should we work on this one or the other one first?\r\n\r\nAlso, is there any way to break this into smaller PRs for review? This is quite large and I'm concerned about getting it reviewed since it is big.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100221708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100221967","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1100221967","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1100221967,"node_id":"IC_kwDOCW7NX85BlA4P","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:47:38Z","updated_at":"2022-04-15T16:47:38Z","author_association":"CONTRIBUTOR","body":"> > Is there any blocker that we cannot just fix this bug in flink 1.12 ? In my context, I think the approach to fix the bug in fink 1.12 is just porting the patch from flink1.13/1.14 to flink1.12, I usually just export it to a patch file and replace the v1.14 to v1.12 globally.\r\n> \r\n> My understanding is that there is a bug in Flink 1.12 that prevents us from fixing this, but I'm not sure what that is. I think we'll need @kbendick to jump in and give the details.\r\n> \r\n> I agree with you, if we can easily adapt the fix for 1.13 and 1.14, then we should just fix it!\r\n\r\n@rdblue is correct. The patch from https://github.com/apache/iceberg/pull/4364 didn't work with Flink 1.12. The problem still persists. https://github.com/apache/iceberg/pull/4418 did not pass all unit tests and I was not able to resolve them. So I agree with Ryan that it's probably better to disable this one feature instead of continue to allow users to get incorrect results.\r\n\r\nIf they're somehow ok with the results they're getting, they can remain on Iceberg 0.13.1.\r\n\r\nI repushed the branch from https://github.com/apache/iceberg/pull/4418  that originally had the patch for 1.12 . Let me try using `DATE` instead of `TO_DATE` to see if that resolves the issue. Otherwise, I think it's best to continue to disable this one feature in 1.12, given that we'll be removing 1.12 in the next major release anyway.\r\n\r\nBut if we can't get it to work, I don't think we should block the patch release on fixing it given that technically Flink 1.12 is deprecated upstream anyway and we've removed support in Iceberg 0.14.0-SNAPSHOT too. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100221967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100224883","html_url":"https://github.com/apache/iceberg/pull/4246#issuecomment-1100224883","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4246","id":1100224883,"node_id":"IC_kwDOCW7NX85BlBlz","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:50:57Z","updated_at":"2022-04-15T16:50:57Z","author_association":"CONTRIBUTOR","body":"We need to know more about the differences between `Schema` and `ResolvedSchema`. Is there a summary anywhere that we can take a look at for migrating?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100224883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100225475","html_url":"https://github.com/apache/iceberg/pull/4246#issuecomment-1100225475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4246","id":1100225475,"node_id":"IC_kwDOCW7NX85BlBvD","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:52:13Z","updated_at":"2022-04-15T16:52:13Z","author_association":"CONTRIBUTOR","body":"I found this FLIP that seems to be related to `ResolvedSchema`, but we should be sure that we're sure of the differences between the two so we can be sure we're using them correctly: https://cwiki.apache.org/confluence/display/FLINK/FLIP-164%3A+Improve+Schema+Handling+in+Catalogs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100225475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100227279","html_url":"https://github.com/apache/iceberg/pull/3977#issuecomment-1100227279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3977","id":1100227279,"node_id":"IC_kwDOCW7NX85BlCLP","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:56:01Z","updated_at":"2022-04-15T16:56:01Z","author_association":"CONTRIBUTOR","body":"I think the general consensus here was that reclaiming memory by closing files is not the right approach. Instead, Iceberg supports Avro so you can write using a format that takes significantly less memory, and you can shuffle the data to minimize the number of open files in any give task.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100227279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100227624","html_url":"https://github.com/apache/iceberg/pull/3975#issuecomment-1100227624","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3975","id":1100227624,"node_id":"IC_kwDOCW7NX85BlCQo","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T16:56:45Z","updated_at":"2022-04-15T16:56:45Z","author_association":"CONTRIBUTOR","body":"@openinx, can you review this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100227624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100248332","html_url":"https://github.com/apache/iceberg/pull/4466#issuecomment-1100248332","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4466","id":1100248332,"node_id":"IC_kwDOCW7NX85BlHUM","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T17:30:14Z","updated_at":"2022-04-15T17:30:14Z","author_association":"CONTRIBUTOR","body":"Thanks @dramaticlly I think it's good now in that respect. @rdblue are we all set?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100248332/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100250076","html_url":"https://github.com/apache/iceberg/pull/4377#issuecomment-1100250076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4377","id":1100250076,"node_id":"IC_kwDOCW7NX85BlHvc","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T17:33:16Z","updated_at":"2022-04-15T17:33:16Z","author_association":"MEMBER","body":"Thanks for the patch @rajarshisarkar , Let's do a quick followup to move the changes into 3.0 and 3.1","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100250076/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100293518","html_url":"https://github.com/apache/iceberg/pull/4418#issuecomment-1100293518","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4418","id":1100293518,"node_id":"IC_kwDOCW7NX85BlSWO","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T18:57:51Z","updated_at":"2022-04-15T18:57:51Z","author_association":"CONTRIBUTOR","body":"I updated this PR to use `DATE` instead of `TO_DATE`, as we discovered in https://github.com/apache/iceberg/pull/4532  that `TO_DATE` was causing tests to process rows out of order during `INSERT VALUES`.\r\n\r\nHowever, the tests all still fail in 1.12.\r\n\r\nI think that So I'm still not able to get 1.12 to correctly process upserts. I think we should disable `upsert` mode in Flink 1.12 in the next patch with a recommendation to upgrade to 1.13 as proposed here: https://github.com/apache/iceberg/pull/4519\r\n\r\n```\r\n> Task :iceberg-flink:iceberg-flink-1.12:test\r\n\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyEqualToPartitionKey[catalogName=testhadoop, baseNamespace=default, format=PARQUET, isStreaming=true] FAILED\r\n    java.lang.AssertionError: expected:<[2,aaa, 3,bbb]> but was:<[1,aaa, 3,bbb]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:140)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyEqualToPartitionKey(TestFlinkUpsert.java:178)\r\n\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyFieldsAtBeginningOfSchema[catalogName=testhadoop, baseNamespace=default, format=PARQUET, isStreaming=true] FAILED\r\n    java.lang.AssertionError: expected:<[aaa,2022-03-01,2, bbb,2022-03-01,3]> but was:<[aaa,2022-03-01,1, bbb,2022-03-01,3]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:140)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyFieldsAtBeginningOfSchema(TestFlinkUpsert.java:219)\r\n\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyFieldsAtEndOfTableSchema[catalogName=testhadoop, baseNamespace=default, format=PARQUET, isStreaming=false] FAILED\r\n    java.lang.AssertionError: expected:<[2,aaa,2022-03-01, 3,bbb,2022-03-01]> but was:<[1,aaa,2022-03-01, 3,bbb,2022-03-01]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:140)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyFieldsAtEndOfTableSchema(TestFlinkUpsert.java:262)\r\n\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyEqualToPartitionKey[catalogName=testhadoop, baseNamespace=default, format=PARQUET, isStreaming=false] FAILED\r\n    java.lang.AssertionError: expected:<[2,aaa, 3,bbb]> but was:<[1,aaa, 3,bbb]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:140)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyEqualToPartitionKey(TestFlinkUpsert.java:178)\r\n\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyFieldsAtEndOfTableSchema[catalogName=testhadoop, baseNamespace=default, format=AVRO, isStreaming=true] FAILED\r\n    java.lang.AssertionError: expected:<[2,aaa,2022-03-01, 3,bbb,2022-03-01]> but was:<[1,aaa,2022-03-01, 3,bbb,2022-03-01]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:140)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyFieldsAtEndOfTableSchema(TestFlinkUpsert.java:262)\r\n\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyEqualToPartitionKey[catalogName=testhadoop, baseNamespace=default, format=AVRO, isStreaming=true] FAILED\r\n    java.lang.AssertionError: expected:<[2,aaa, 3,bbb]> but was:<[1,aaa, 3,bbb]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:140)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyEqualToPartitionKey(TestFlinkUpsert.java:178)\r\n\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyFieldsAtEndOfTableSchema[catalogName=testhadoop, baseNamespace=default, format=AVRO, isStreaming=false] FAILED\r\n    java.lang.AssertionError: expected:<[2,aaa,2022-03-01, 3,bbb,2022-03-01]> but was:<[1,aaa,2022-03-01, 3,bbb,2022-03-01]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:140)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyFieldsAtEndOfTableSchema(TestFlinkUpsert.java:262)\r\n\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyEqualToPartitionKey[catalogName=testhadoop, baseNamespace=default, format=AVRO, isStreaming=false] FAILED\r\n    java.lang.AssertionError: expected:<[2,aaa, 3,bbb]> but was:<[1,aaa, 3,bbb]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:140)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyEqualToPartitionKey(TestFlinkUpsert.java:178)\r\n\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyEqualToPartitionKey[catalogName=testhadoop, baseNamespace=default, format=ORC, isStreaming=false] FAILED\r\n    java.lang.AssertionError: expected:<[2,aaa, 3,bbb]> but was:<[1,aaa, 3,bbb]>\r\n        at org.junit.Assert.fail(Assert.java:89)\r\n        at org.junit.Assert.failNotEquals(Assert.java:835)\r\n        at org.junit.Assert.assertEquals(Assert.java:120)\r\n        at org.junit.Assert.assertEquals(Assert.java:146)\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:140)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyEqualToPartitionKey(TestFlinkUpsert.java:178)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100293518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100294375","html_url":"https://github.com/apache/iceberg/pull/4418#issuecomment-1100294375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4418","id":1100294375,"node_id":"IC_kwDOCW7NX85BlSjn","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T18:59:21Z","updated_at":"2022-04-15T18:59:21Z","author_association":"CONTRIBUTOR","body":"Also, Github is saying that all checks are passing as Flink 1.12 has been removed in master. Checking out this branch and running it locally shows that the issue is still present.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100294375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100301495","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1100301495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1100301495,"node_id":"IC_kwDOCW7NX85BlUS3","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T19:13:21Z","updated_at":"2022-04-15T19:14:39Z","author_association":"CONTRIBUTOR","body":"@openinx I left a note on the original PR to backport the fix to Flink 1.12 of which tests are failing (and repushed the branch so you could see for yourself) here https://github.com/apache/iceberg/pull/4418\r\n\r\nI was unable to find any difference int he code between the two when I was working on it before, but if you're able to make it work then by all means that would be great. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100301495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100352064","html_url":"https://github.com/apache/iceberg/issues/4564#issuecomment-1100352064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4564","id":1100352064,"node_id":"IC_kwDOCW7NX85BlgpA","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T20:02:44Z","updated_at":"2022-04-18T17:10:22Z","author_association":"CONTRIBUTOR","body":"> I have created the table using Athena console and also via a Glue pyspark job with the same end result. Could anyone help resolve this issue?\r\n\r\nJust to clarify, you mean you also tried creating the table through Glue Pyspark and after a subsequent read attempt it failed? \r\n\r\nIf so this seems to indicate an issue in Iceberg, since for Glue pyspark, you'd still be using the spark iceberg dependencies. I was also able to reproduce a similar empty \"folder\" issue through Athena when the table is created with a location where the locations is 1 bucket and 1 nested \"folder\" (in quotes because it's not really a folder). \r\n\r\n```\r\nRoot Location 's3://insert-iceberg-test/f3' \r\n\r\nINSERT PATH\r\ns3://insert-iceberg-test/f3/data/4e23cb0e//f3/id_bucket=6/4e6e49d0-98c2-4440-90de-76c0d7e6a440.gz.parquet\r\n```\r\n\r\nHowever, if there are 2 nested folders in the bucket, the insert path is as expected (Missing the extra / separator in the object key)\r\n```\r\nRoot LOCATION\r\ns3://insert-iceberg-test/f1/f2\r\n\r\nINSERT PATH\r\ns3://insert-iceberg-test/f1/f2/data/0eb31aa4/f1/f2/id_bucket=4/febda4a0-2ace-4447-a932-03fbeba36e48.gz.parquet\r\n```\r\n\r\nIn the end I'm able to query the data since these are keys stored in the manifests, but it does cause issues for external systems which expect some physical layout. \r\n\r\nBut in your case the bucket itself is missing in the path, or is fund_perf_f your bucket? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100352064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100394139","html_url":"https://github.com/apache/iceberg/pull/4301#issuecomment-1100394139","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4301","id":1100394139,"node_id":"IC_kwDOCW7NX85Blq6b","user":{"login":"sgcowell","id":24662068,"node_id":"MDQ6VXNlcjI0NjYyMDY4","avatar_url":"https://avatars.githubusercontent.com/u/24662068?v=4","gravatar_id":"","url":"https://api.github.com/users/sgcowell","html_url":"https://github.com/sgcowell","followers_url":"https://api.github.com/users/sgcowell/followers","following_url":"https://api.github.com/users/sgcowell/following{/other_user}","gists_url":"https://api.github.com/users/sgcowell/gists{/gist_id}","starred_url":"https://api.github.com/users/sgcowell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgcowell/subscriptions","organizations_url":"https://api.github.com/users/sgcowell/orgs","repos_url":"https://api.github.com/users/sgcowell/repos","events_url":"https://api.github.com/users/sgcowell/events{/privacy}","received_events_url":"https://api.github.com/users/sgcowell/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-15T21:04:33Z","updated_at":"2022-04-15T21:04:33Z","author_association":"NONE","body":"Will default values be part of format version 2, or will this be part of a new format version 3?   If it's format version 2, what happens when existing Iceberg versions read table metadata with default values in it?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100394139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100511408","html_url":"https://github.com/apache/iceberg/pull/3411#issuecomment-1100511408","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3411","id":1100511408,"node_id":"IC_kwDOCW7NX85BmHiw","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-16T02:20:00Z","updated_at":"2022-04-16T02:20:00Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho, will do it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100511408/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100517364","html_url":"https://github.com/apache/iceberg/pull/4572#issuecomment-1100517364","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4572","id":1100517364,"node_id":"IC_kwDOCW7NX85BmI_0","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-16T03:00:32Z","updated_at":"2022-04-16T03:00:32Z","author_association":"CONTRIBUTOR","body":"cc @szehon-ho @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100517364/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100581470","html_url":"https://github.com/apache/iceberg/pull/4568#issuecomment-1100581470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4568","id":1100581470,"node_id":"IC_kwDOCW7NX85BmYpe","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-16T05:56:00Z","updated_at":"2022-04-16T05:56:00Z","author_association":"CONTRIBUTOR","body":"cc @rdblue, @jackye1995 ,  @szehon-ho , @RussellSpitzer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100581470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100633027","html_url":"https://github.com/apache/iceberg/issues/4563#issuecomment-1100633027","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4563","id":1100633027,"node_id":"IC_kwDOCW7NX85BmlPD","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-16T10:32:33Z","updated_at":"2022-04-16T10:32:33Z","author_association":"CONTRIBUTOR","body":"I want to try fix it. @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100633027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100647100","html_url":"https://github.com/apache/iceberg/pull/4561#issuecomment-1100647100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4561","id":1100647100,"node_id":"IC_kwDOCW7NX85Bmoq8","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-16T11:48:53Z","updated_at":"2022-04-16T11:48:53Z","author_association":"CONTRIBUTOR","body":"> @wuwenchi, can you please credit the author of the unit test?\r\n\r\n@openinx Could you please review this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100647100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100800646","html_url":"https://github.com/apache/iceberg/issues/4144#issuecomment-1100800646","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4144","id":1100800646,"node_id":"IC_kwDOCW7NX85BnOKG","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T04:22:25Z","updated_at":"2022-04-17T04:22:25Z","author_association":"CONTRIBUTOR","body":"I can confirm the fix is working for 0.13.x branch. So I am closing this diff. cc: @SinghAsDev ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100800646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100836275","html_url":"https://github.com/apache/iceberg/issues/4563#issuecomment-1100836275","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4563","id":1100836275,"node_id":"IC_kwDOCW7NX85BnW2z","user":{"login":"swapz-z","id":40524373,"node_id":"MDQ6VXNlcjQwNTI0Mzcz","avatar_url":"https://avatars.githubusercontent.com/u/40524373?v=4","gravatar_id":"","url":"https://api.github.com/users/swapz-z","html_url":"https://github.com/swapz-z","followers_url":"https://api.github.com/users/swapz-z/followers","following_url":"https://api.github.com/users/swapz-z/following{/other_user}","gists_url":"https://api.github.com/users/swapz-z/gists{/gist_id}","starred_url":"https://api.github.com/users/swapz-z/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swapz-z/subscriptions","organizations_url":"https://api.github.com/users/swapz-z/orgs","repos_url":"https://api.github.com/users/swapz-z/repos","events_url":"https://api.github.com/users/swapz-z/events{/privacy}","received_events_url":"https://api.github.com/users/swapz-z/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T09:05:33Z","updated_at":"2022-04-17T09:05:33Z","author_association":"NONE","body":"Hey @felixYyu \r\nI am new to the opensource contribution process.\r\nHowever, in order to get my hands dirty, I feel this would be a great starting point to setup and reproduce the issue and then analyse it.\r\nDo let me know if it's okay for you if I can tag along with you for this first issue. And be a part of this process ? \r\n\r\nThanks in advance","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100836275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100937533","html_url":"https://github.com/apache/iceberg/pull/4573#issuecomment-1100937533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4573","id":1100937533,"node_id":"IC_kwDOCW7NX85Bnvk9","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T19:34:43Z","updated_at":"2022-04-17T19:34:43Z","author_association":"MEMBER","body":"Could you rebase your PR once more, @williamhyun ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100937533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100938698","html_url":"https://github.com/apache/iceberg/issues/4564#issuecomment-1100938698","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4564","id":1100938698,"node_id":"IC_kwDOCW7NX85Bnv3K","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T19:42:36Z","updated_at":"2022-04-17T19:42:36Z","author_association":"CONTRIBUTOR","body":"Looks like a malformed path since it starts with `s3:///`. There's no bucket.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100938698/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100941694","html_url":"https://github.com/apache/iceberg/pull/4561#issuecomment-1100941694","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4561","id":1100941694,"node_id":"IC_kwDOCW7NX85Bnwl-","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T20:05:34Z","updated_at":"2022-04-17T20:05:34Z","author_association":"CONTRIBUTOR","body":"@wuwenchi, please credit the original author of the test before we can merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100941694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100967612","html_url":"https://github.com/apache/iceberg/pull/4575#issuecomment-1100967612","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4575","id":1100967612,"node_id":"IC_kwDOCW7NX85Bn268","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-17T23:27:35Z","updated_at":"2022-04-18T19:31:11Z","author_association":"CONTRIBUTOR","body":"An alternative to this that we should also consider is adding `SessionContext` to catalog calls. That would add an interface like this:\r\n\r\n```java\r\npublic interface SessionCatalog extends Catalog {\r\n  final class SessionContext {\r\n    private final String sessionId;\r\n    private final String identity;\r\n    private final String credential;\r\n    private final Map<String, String> sessionConfig;\r\n\r\n    public SessionContext(String sessionId, String identity, String credential, Map<String, String> sessionConfig) {\r\n      this.sessionId = sessionId;\r\n      this.identity = identity;\r\n      this.credential = credential;\r\n      this.sessionConfig = sessionConfig;\r\n    }\r\n\r\n    public String sessionId() {\r\n      return sessionId;\r\n    }\r\n\r\n    public String identity() {\r\n      return identity;\r\n    }\r\n\r\n    public String credential() {\r\n      return credential;\r\n    }\r\n\r\n    public Map<String, String> sessionConfig() {\r\n      return sessionConfig;\r\n    }\r\n  }\r\n\r\n  void initialize(String name, Map<String, String> properties);\r\n\r\n  String name();\r\n  \r\n  Catalog withContext(SessionContext context);\r\n\r\n  List<TableIdentifier> listTables(SessionContext context, Namespace namespace);\r\n\r\n  TableBuilder buildTable(SessionContext context, TableIdentifier ident, Schema schema);\r\n\r\n  Table registerTable(TableIdentifier ident, String metadataFileLocation);\r\n\r\n  default boolean tableExists(SessionContext context, TableIdentifier ident) {\r\n    try {\r\n      loadTable(context, ident);\r\n      return true;\r\n    } catch (NoSuchTableException e) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  Table loadTable(SessionContext context, TableIdentifier ident);\r\n\r\n  boolean dropTable(SessionContext context, TableIdentifier ident);\r\n\r\n  boolean purgeTable(SessionContext context, TableIdentifier ident);\r\n\r\n  void renameTable(SessionContext context, TableIdentifier from, TableIdentifier to);\r\n\r\n  void invalidateTable(SessionContext context, TableIdentifier ident);\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1100967612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101008515","html_url":"https://github.com/apache/iceberg/pull/4574#issuecomment-1101008515","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4574","id":1101008515,"node_id":"IC_kwDOCW7NX85BoA6D","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T01:29:34Z","updated_at":"2022-04-18T01:29:34Z","author_association":"CONTRIBUTOR","body":"cc: @rdblue @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101008515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101025838","html_url":"https://github.com/apache/iceberg/pull/4418#issuecomment-1101025838","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4418","id":1101025838,"node_id":"IC_kwDOCW7NX85BoFIu","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T02:10:58Z","updated_at":"2022-04-18T02:10:58Z","author_association":"MEMBER","body":"If this failure can be reproduced locally, then we can just open the intellij idea debugger to analysis the written columnar files to see what's wrong there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101025838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101053954","html_url":"https://github.com/apache/iceberg/pull/4577#issuecomment-1101053954","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4577","id":1101053954,"node_id":"IC_kwDOCW7NX85BoMAC","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T03:19:39Z","updated_at":"2022-04-18T03:19:39Z","author_association":"CONTRIBUTOR","body":"Thanks, @chenjunjiedada for the review. And cc @rdblue @szehon-ho @aokolnychyi @RussellSpitzer, could you help to review this? Thanks in advance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101053954/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101092942","html_url":"https://github.com/apache/iceberg/pull/4578#issuecomment-1101092942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4578","id":1101092942,"node_id":"IC_kwDOCW7NX85BoVhO","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T04:52:21Z","updated_at":"2022-04-18T04:52:21Z","author_association":"CONTRIBUTOR","body":"Still missing unit tests on this but wanted to get feedback on the code while I add the tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101092942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101179019","html_url":"https://github.com/apache/iceberg/pull/4561#issuecomment-1101179019","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4561","id":1101179019,"node_id":"IC_kwDOCW7NX85BoqiL","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T07:32:38Z","updated_at":"2022-04-18T07:32:38Z","author_association":"MEMBER","body":"> @wuwenchi, please credit the original author of the test before we can merge this.\r\n\r\n@rdblue , this unit test was added by @wuwenchi for addressing the table properties changes for *primary key* tables,  in theory the  original author of it is @wuwenchi .  So I think we don't need to credit others, right ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101179019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101183829","html_url":"https://github.com/apache/iceberg/pull/4298#issuecomment-1101183829","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4298","id":1101183829,"node_id":"IC_kwDOCW7NX85BortV","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T07:41:44Z","updated_at":"2022-04-18T07:41:44Z","author_association":"MEMBER","body":"@rdblue thanks for your attentions for this part.  The base PR is here: https://github.com/apache/iceberg/pull/4264 .  I think we need to get that one reviewed & merged firstly, so that we can optimize the write path for further features.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101183829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101354085","html_url":"https://github.com/apache/iceberg/issues/4510#issuecomment-1101354085","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4510","id":1101354085,"node_id":"IC_kwDOCW7NX85BpVRl","user":{"login":"itaise","id":64745584,"node_id":"MDQ6VXNlcjY0NzQ1NTg0","avatar_url":"https://avatars.githubusercontent.com/u/64745584?v=4","gravatar_id":"","url":"https://api.github.com/users/itaise","html_url":"https://github.com/itaise","followers_url":"https://api.github.com/users/itaise/followers","following_url":"https://api.github.com/users/itaise/following{/other_user}","gists_url":"https://api.github.com/users/itaise/gists{/gist_id}","starred_url":"https://api.github.com/users/itaise/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itaise/subscriptions","organizations_url":"https://api.github.com/users/itaise/orgs","repos_url":"https://api.github.com/users/itaise/repos","events_url":"https://api.github.com/users/itaise/events{/privacy}","received_events_url":"https://api.github.com/users/itaise/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T12:16:47Z","updated_at":"2022-04-18T12:16:47Z","author_association":"NONE","body":"@rdblue We will highly appreciate your input on that, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101354085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101380297","html_url":"https://github.com/apache/iceberg/issues/4510#issuecomment-1101380297","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4510","id":1101380297,"node_id":"IC_kwDOCW7NX85BpbrJ","user":{"login":"itaise","id":64745584,"node_id":"MDQ6VXNlcjY0NzQ1NTg0","avatar_url":"https://avatars.githubusercontent.com/u/64745584?v=4","gravatar_id":"","url":"https://api.github.com/users/itaise","html_url":"https://github.com/itaise","followers_url":"https://api.github.com/users/itaise/followers","following_url":"https://api.github.com/users/itaise/following{/other_user}","gists_url":"https://api.github.com/users/itaise/gists{/gist_id}","starred_url":"https://api.github.com/users/itaise/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itaise/subscriptions","organizations_url":"https://api.github.com/users/itaise/orgs","repos_url":"https://api.github.com/users/itaise/repos","events_url":"https://api.github.com/users/itaise/events{/privacy}","received_events_url":"https://api.github.com/users/itaise/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T12:44:33Z","updated_at":"2022-04-18T12:44:33Z","author_association":"NONE","body":"This happens also when using the DataFrameWriter V2, for example: \r\n\r\n`df.writeTo(\"iprod.test_schema.example\").partitionedBy(partition_column).createOrReplace()`\r\n\r\nand also with: \r\n`df.writeTo(\"iprod.test_schema.example\").partitionedBy(partition_column).replace()`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101380297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101465437","html_url":"https://github.com/apache/iceberg/pull/4579#issuecomment-1101465437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4579","id":1101465437,"node_id":"IC_kwDOCW7NX85Bpwdd","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T14:46:21Z","updated_at":"2022-04-18T14:46:21Z","author_association":"MEMBER","body":"Thanks @rajarshisarkar + @singhpk234","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101465437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101486057","html_url":"https://github.com/apache/iceberg/pull/4518#issuecomment-1101486057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4518","id":1101486057,"node_id":"IC_kwDOCW7NX85Bp1fp","user":{"login":"rizaon","id":6033430,"node_id":"MDQ6VXNlcjYwMzM0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/6033430?v=4","gravatar_id":"","url":"https://api.github.com/users/rizaon","html_url":"https://github.com/rizaon","followers_url":"https://api.github.com/users/rizaon/followers","following_url":"https://api.github.com/users/rizaon/following{/other_user}","gists_url":"https://api.github.com/users/rizaon/gists{/gist_id}","starred_url":"https://api.github.com/users/rizaon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rizaon/subscriptions","organizations_url":"https://api.github.com/users/rizaon/orgs","repos_url":"https://api.github.com/users/rizaon/repos","events_url":"https://api.github.com/users/rizaon/events{/privacy}","received_events_url":"https://api.github.com/users/rizaon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T15:13:41Z","updated_at":"2022-04-18T15:13:41Z","author_association":"CONTRIBUTOR","body":"Hello @rdblue. This PR is ready for review.\r\n\r\nPlease let me know if there is any new feedback or request. I'm happy to follow up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101486057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101547317","html_url":"https://github.com/apache/iceberg/issues/4581#issuecomment-1101547317","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4581","id":1101547317,"node_id":"IC_kwDOCW7NX85BqEc1","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T16:32:02Z","updated_at":"2022-04-18T16:32:02Z","author_association":"MEMBER","body":"I'm working on a PR for this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101547317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101549963","html_url":"https://github.com/apache/iceberg/pull/4580#issuecomment-1101549963","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4580","id":1101549963,"node_id":"IC_kwDOCW7NX85BqFGL","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T16:36:01Z","updated_at":"2022-04-18T16:36:01Z","author_association":"CONTRIBUTOR","body":"Here is the japi-compliance-checker report for iceberg-api jar before and after this change\r\n\r\n[api-compatibility-report.pdf](https://github.com/apache/iceberg/files/8506868/api-compatibility-report.pdf)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101549963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101571737","html_url":"https://github.com/apache/iceberg/pull/4580#issuecomment-1101571737","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4580","id":1101571737,"node_id":"IC_kwDOCW7NX85BqKaZ","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T17:07:11Z","updated_at":"2022-04-18T17:07:11Z","author_association":"CONTRIBUTOR","body":"@rdblue @openinx @yittg @aokolnychyi @flyrain @flashJd can you please take a look at this approach and see if it makes sense?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101571737/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101622276","html_url":"https://github.com/apache/iceberg/issues/4581#issuecomment-1101622276","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4581","id":1101622276,"node_id":"IC_kwDOCW7NX85BqWwE","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T18:13:07Z","updated_at":"2022-04-18T18:13:07Z","author_association":"MEMBER","body":"Actually after looking at this for a while I think we should probably just always handle UUID as binary type in Spark rather than trying to do a String conversion. I think if the end user needs the string representation they can always cast?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101622276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101742147","html_url":"https://github.com/apache/iceberg/pull/4548#issuecomment-1101742147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4548","id":1101742147,"node_id":"IC_kwDOCW7NX85Bq0BD","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:37:31Z","updated_at":"2022-04-18T20:37:31Z","author_association":"CONTRIBUTOR","body":"thanks for the fix!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101742147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101755352","html_url":"https://github.com/apache/iceberg/pull/4528#issuecomment-1101755352","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4528","id":1101755352,"node_id":"IC_kwDOCW7NX85Bq3PY","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:50:34Z","updated_at":"2022-04-18T21:13:05Z","author_association":"CONTRIBUTOR","body":"@flashJd it seems that this is trying to address both scan planning and CDC read. might be easier to separate them out.\r\n\r\nRegarding scan planning, I just created a new PR #4580  on adding a new `IncrementalTableScan` interface. Would love to get your feedbacks and see if we can align on the effort.\r\n\r\nalso how is this one different with PR #3095 mentioned in the description? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101755352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101758100","html_url":"https://github.com/apache/iceberg/pull/4580#issuecomment-1101758100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4580","id":1101758100,"node_id":"IC_kwDOCW7NX85Bq36U","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T20:52:17Z","updated_at":"2022-04-18T20:52:17Z","author_association":"CONTRIBUTOR","body":"cc @hameizi the author of PR #3095 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101758100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101819065","html_url":"https://github.com/apache/iceberg/pull/4561#issuecomment-1101819065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4561","id":1101819065,"node_id":"IC_kwDOCW7NX85BrGy5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T22:31:01Z","updated_at":"2022-04-18T22:31:54Z","author_association":"CONTRIBUTOR","body":"@openinx, the test looks nearly identical to the [test](https://github.com/apache/iceberg/pull/3614/files#diff-2c8ac6c96a4608e31ba079ccb7cd04dcd50cd9dc57c1c81eeeb5bc75c151c275R322) in #3614 from a different author.\r\n\r\nIt's easy to make small mistakes like this, but I do think that we should credit the person that wrote the original test.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101819065/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101820907","html_url":"https://github.com/apache/iceberg/pull/3577#issuecomment-1101820907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3577","id":1101820907,"node_id":"IC_kwDOCW7NX85BrHPr","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-18T22:34:13Z","updated_at":"2022-04-18T22:34:13Z","author_association":"CONTRIBUTOR","body":"I'm going to close this because I don't think we ended up going with the idea of adding references to TableIdentifier.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101820907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101922521","html_url":"https://github.com/apache/iceberg/pull/4561#issuecomment-1101922521","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4561","id":1101922521,"node_id":"IC_kwDOCW7NX85BrgDZ","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T02:10:48Z","updated_at":"2022-04-19T02:10:48Z","author_association":"CONTRIBUTOR","body":"@rdblue   Sorry, I didn't notice this pr #3614  @Initial-neko before...\r\n\r\nI want to add iceberg support for watermark and computed columns, and save these informations to table properties.\r\nI found this problem when I alter a table with a primary key.\r\n\r\n In fact, I write the test according to original test (\r\nhttps://github.com/apache/iceberg/blob/master/flink/v1.14/flink/src/test/java/org/apache/iceberg/flink/TestFlinkCatalogTable.java#L296-L318 ) which written by @openinx , and I only add `primary key` in DDL sql.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101922521/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101946212","html_url":"https://github.com/apache/iceberg/pull/4572#issuecomment-1101946212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4572","id":1101946212,"node_id":"IC_kwDOCW7NX85Brl1k","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T03:05:13Z","updated_at":"2022-04-19T03:05:13Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1101946212/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102020073","html_url":"https://github.com/apache/iceberg/issues/4176#issuecomment-1102020073","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4176","id":1102020073,"node_id":"IC_kwDOCW7NX85Br33p","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T04:45:25Z","updated_at":"2022-04-19T04:47:10Z","author_association":"CONTRIBUTOR","body":"@coolderli  can u provide ur spark version\\iceberg version, I have tested this DDL with spark3.2 and iceberg 0.13.1, and everything is fine.\r\n\r\n![1650343429873](https://user-images.githubusercontent.com/10529123/163921777-92b35e78-cb7f-4032-a2fc-3c6573c3e8a1.jpg)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102020073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102047703","html_url":"https://github.com/apache/iceberg/issues/4583#issuecomment-1102047703","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4583","id":1102047703,"node_id":"IC_kwDOCW7NX85Br-nX","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T05:04:09Z","updated_at":"2022-04-19T05:04:09Z","author_association":"CONTRIBUTOR","body":"can this feature come in handy to your use-case : \r\n\r\n- https://github.com/apache/iceberg/pull/4011","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102047703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102110824","html_url":"https://github.com/apache/iceberg/pull/3095#issuecomment-1102110824","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3095","id":1102110824,"node_id":"IC_kwDOCW7NX85BsOBo","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T05:45:13Z","updated_at":"2022-04-19T05:45:13Z","author_association":"CONTRIBUTOR","body":"@stevenzwu I will perfect this PR after https://github.com/apache/iceberg/pull/4580 finished, because there is some correlation between them.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102110824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102133321","html_url":"https://github.com/apache/iceberg/pull/3975#issuecomment-1102133321","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3975","id":1102133321,"node_id":"IC_kwDOCW7NX85BsThJ","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T06:15:20Z","updated_at":"2022-04-19T06:15:20Z","author_association":"CONTRIBUTOR","body":"@openinx can you review this? thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102133321/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102364425","html_url":"https://github.com/apache/iceberg/pull/3956#issuecomment-1102364425","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3956","id":1102364425,"node_id":"IC_kwDOCW7NX85BtL8J","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T09:16:49Z","updated_at":"2022-04-19T09:16:49Z","author_association":"CONTRIBUTOR","body":"It looks like invalid now, closed it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102364425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]