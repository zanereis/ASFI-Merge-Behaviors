[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806046326","html_url":"https://github.com/apache/iceberg/pull/2367#issuecomment-806046326","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2367","id":806046326,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjA0NjMyNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T18:09:17Z","updated_at":"2021-03-24T18:09:17Z","author_association":"CONTRIBUTOR","body":"I think that this fix is a good starting point. For files that are added to a snapshot table after creation, it is better to leak those than to delete files from the original table. I think we should move forward with this PR and then try to catch more data files later.\r\n\r\nAs for the Hive property, I'm not sure what to do but it is a good thing to consider separately. What respects that property? I think Iceberg uses it somewhere, but that may just be in the Hive code. I think having a clear understanding of what it does and where it is currently used is the right place to start.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806046326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806052406","html_url":"https://github.com/apache/iceberg/pull/2361#issuecomment-806052406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2361","id":806052406,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjA1MjQwNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T18:18:17Z","updated_at":"2021-03-24T18:18:17Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806052406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806060174","html_url":"https://github.com/apache/iceberg/pull/2363#issuecomment-806060174","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2363","id":806060174,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjA2MDE3NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T18:30:13Z","updated_at":"2021-03-24T18:30:13Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks @springle!\r\n\r\n@aokolnychyi, do you think we can get this into 0.11.1?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806060174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806064567","html_url":"https://github.com/apache/iceberg/pull/2363#issuecomment-806064567","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2363","id":806064567,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjA2NDU2Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T18:37:23Z","updated_at":"2021-03-24T18:37:23Z","author_association":"CONTRIBUTOR","body":"Will add","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806064567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806070509","html_url":"https://github.com/apache/iceberg/pull/2370#issuecomment-806070509","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2370","id":806070509,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjA3MDUwOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T18:47:23Z","updated_at":"2021-03-24T18:48:03Z","author_association":"CONTRIBUTOR","body":"Thanks for looking into this, @wynjauu. It's always good to check places that may benefit from a refactor. Here, I don't think that this refactor is a good idea. There are good reasons why the code is structured this way.\r\n\r\nFirst, the call to `encryption.decrypt` passes all of the encrypted input files at the same time by passing a single iterator. That allows an encryption manager to do a single batch call to fetch the keys for those files, which is much more important than avoiding extra loops.\r\n\r\nSecond, the same delete file may be used for more than one data file. In the rewrite, `decrypt` would be called once for each copy of the same file rather than just once, and a duplicate would result in an exception from the immutable map builder. That's why we use a mutable map of location to key metadata and then create encrypted input files from the entries.\r\n\r\nWhile this does more loops, it is actually more performant and correct to do it this way. It is much more important to deduplicate decryption and to use the batch decrypt call than to avoid an extra loop or two over a small collection. I'm going to close this and #2369, but feel free to reopen if you want to discuss it more. Thanks for contributing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806070509/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806071210","html_url":"https://github.com/apache/iceberg/issues/2369#issuecomment-806071210","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2369","id":806071210,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjA3MTIxMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T18:48:34Z","updated_at":"2021-03-24T18:48:34Z","author_association":"CONTRIBUTOR","body":"I'm closing this because I don't think the refactor is a good idea. More details are on the PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806071210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806072927","html_url":"https://github.com/apache/iceberg/pull/2358#issuecomment-806072927","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2358","id":806072927,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjA3MjkyNw==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T18:51:20Z","updated_at":"2021-03-24T18:51:20Z","author_association":"COLLABORATOR","body":"Hi @aokolnychyi @rdblue no rush at all, but ping for attention when you have a free cycle for feedback.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806072927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806103048","html_url":"https://github.com/apache/iceberg/pull/2365#issuecomment-806103048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2365","id":806103048,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjEwMzA0OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T19:33:29Z","updated_at":"2021-03-24T19:33:29Z","author_association":"CONTRIBUTOR","body":"I considered adding similar syntax when I added the ADD and DROP DDL. I think the problem with this is that it implies that the original field is changed, rather than dropped and added. In format v2, we can sort of do that by replacing the field and using the previous field's name, but even then the values from the old field will no longer appear. In v1, a drop actually replaces the field with a `void` or `alwaysNull` transform and adds a new field to the end of the spec. It seems to me like that would be confusing behavior for `CHANGE`.\r\n\r\nOne option to fix this is to use `REPLACE` instead, which I think doesn't imply that the field itself is still there, but updated or changed. But then the syntax is further away from column DDL so I'm not sure if that's a good idea. What do you think, @jackye1995, @aokolnychyi, @yyanyy?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806103048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806113814","html_url":"https://github.com/apache/iceberg/pull/2352#issuecomment-806113814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2352","id":806113814,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjExMzgxNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T19:39:57Z","updated_at":"2021-03-24T19:39:57Z","author_association":"CONTRIBUTOR","body":"@rzhang10, I think the problem with this is that it will cause more columns than needed to be projected. `GetProjectedIds` is used to get the IDs from an expected schema. If that expected schema contains an empty struct, then the struct itself will be selected. But when we apply that projection to a file schema using `select`, the entire struct from the file will be selected. That's because you might select a struct using syntax like `SELECT location FROM table`, where `location` is `struct<latitude: double, longitude: double>`.\r\n\r\nI think there might be a different way to solve the problem you're hitting. What method is used to produce the read schema from the expected schema and a file schema? I suspect that's what we need to update.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806113814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806131975","html_url":"https://github.com/apache/iceberg/pull/2333#issuecomment-806131975","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2333","id":806131975,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjEzMTk3NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T19:50:52Z","updated_at":"2021-03-24T19:50:52Z","author_association":"CONTRIBUTOR","body":"@jackye1995, can you elaborate on your performance concerns if the configuration isn't final? I'm not sure that would be a problem.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806131975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806156032","html_url":"https://github.com/apache/iceberg/pull/2333#issuecomment-806156032","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2333","id":806156032,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjE1NjAzMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T20:12:26Z","updated_at":"2021-03-24T20:12:26Z","author_association":"CONTRIBUTOR","body":"Sorry, I missed this PR. I can hold 0.11.1 RC for a little longer.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806156032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806164297","html_url":"https://github.com/apache/iceberg/pull/2333#issuecomment-806164297","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2333","id":806164297,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjE2NDI5Nw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T20:26:39Z","updated_at":"2021-03-24T21:00:11Z","author_association":"CONTRIBUTOR","body":"@rdblue \r\n\r\n> I think this can be collapsed into a single DynConstructors call that lists both implementations. \r\n\r\nThe issue with that approach is that I still need a boolean to check if I need to call the `setConf` for no-arg constructor, and there was no way to get that boolean. I guess I can bypass that by checking `instanceof Configurable` for all FileIOs, so if we decide to go with that route I can make the change accordingly.\r\n\r\n> can you elaborate on your performance concerns if the configuration isn't final?\r\n\r\nI would actually prefer to use this approach of adding no-arg consturctor for `HadoopFileIO` which makes the whole concept of FIleIO loading much simpler. But I see `conf()` is called in all read and write paths to create a serializable configuration to avoid Kryo serialization issue. There is definitely a small difference for using final versus not final, but the difference might not be significant from a broader view, I do not have a definitive answer for that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806164297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806190054","html_url":"https://github.com/apache/iceberg/pull/2333#issuecomment-806190054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2333","id":806190054,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjE5MDA1NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T21:13:33Z","updated_at":"2021-03-24T21:13:33Z","author_association":"CONTRIBUTOR","body":"> Sorry, I missed this PR. I can hold 0.11.1 RC for a little longer.\r\n\r\nThank you Anton!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806190054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806195038","html_url":"https://github.com/apache/iceberg/pull/2365#issuecomment-806195038","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2365","id":806195038,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjE5NTAzOA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T21:22:51Z","updated_at":"2021-03-24T21:22:51Z","author_association":"CONTRIBUTOR","body":"@rdblue yes I agree CHANGE might cause some wrong interpretation, but I don't think it is a big issue for end users, especially people who are only interacting through SQL. If they see the `alwaysNull` partition field I think people would understand it means that partition field was dropped in favor of the current one.\r\n\r\nI am good with REPLACE, it is also a part of HiveQL, and Athena also supports it for column updates.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806195038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806210557","html_url":"https://github.com/apache/iceberg/pull/2379#issuecomment-806210557","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2379","id":806210557,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjIxMDU1Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T21:54:20Z","updated_at":"2021-03-24T21:56:34Z","author_association":"MEMBER","body":"Note this is currently a WIP and is missing some functionality ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806210557/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806211441","html_url":"https://github.com/apache/iceberg/pull/2379#issuecomment-806211441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2379","id":806211441,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjIxMTQ0MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T21:56:21Z","updated_at":"2021-03-24T21:56:21Z","author_association":"MEMBER","body":"@aokolnychyi , @openinx , @zhangjun0x01, @jerryshao ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806211441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806269627","html_url":"https://github.com/apache/iceberg/pull/2367#issuecomment-806269627","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2367","id":806269627,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjI2OTYyNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T00:26:03Z","updated_at":"2021-03-25T00:26:03Z","author_association":"CONTRIBUTOR","body":"Thanks, everyone! I think we should continue discussing the purge flag in Hive.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806269627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806378945","html_url":"https://github.com/apache/iceberg/pull/2362#issuecomment-806378945","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2362","id":806378945,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjM3ODk0NQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T05:39:14Z","updated_at":"2021-03-25T05:39:14Z","author_association":"CONTRIBUTOR","body":"This is still WIP but is ready for a more detailed review round. Added Kryo tests will fail but that's not really related to this PR. We have to fix `Schema` serialization.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806378945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806408355","html_url":"https://github.com/apache/iceberg/pull/2330#issuecomment-806408355","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2330","id":806408355,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjQwODM1NQ==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T06:50:46Z","updated_at":"2021-03-25T06:50:46Z","author_association":"CONTRIBUTOR","body":"Hi @aokolnychyi, thanks for the review and nice suggestion. I have made the changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806408355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806419842","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-806419842","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":806419842,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjQxOTg0Mg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T07:13:14Z","updated_at":"2021-03-25T07:13:14Z","author_association":"MEMBER","body":"I like this PR ,  just left several comments. We may need to change this title to `Core: Add RowKey Specification in format v2`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806419842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806579536","html_url":"https://github.com/apache/iceberg/pull/2010#issuecomment-806579536","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2010","id":806579536,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjU3OTUzNg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T11:36:09Z","updated_at":"2021-03-25T11:36:09Z","author_association":"MEMBER","body":"Close this now because we've had a PR #2354 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806579536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806582742","html_url":"https://github.com/apache/iceberg/issues/2374#issuecomment-806582742","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2374","id":806582742,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjU4Mjc0Mg==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T11:41:51Z","updated_at":"2021-03-25T11:41:51Z","author_association":"COLLABORATOR","body":"Just a note if anyone hits this on Spark 3.0.x, for the cache issue (2 above) a workaround is:\r\n\r\n`spark.sessionState.catalogManager.catalog(catalogName).asInstanceOf[SparkSessionCatalog].dropTable(db, table)`\r\n\r\nOtherwise you are stuck, there are no way to 'refresh table' as Spark does a tableExists check.\r\n\r\nIt doesn't fix the other issues though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806582742/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806687999","html_url":"https://github.com/apache/iceberg/pull/2367#issuecomment-806687999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2367","id":806687999,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjY4Nzk5OQ==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T12:53:14Z","updated_at":"2021-03-25T12:53:14Z","author_association":"COLLABORATOR","body":"@aokolnychyi Thanks for your questions, Anton.\r\n\r\n> How does Hive populate deleteData in commitDropTable?\r\n\r\n`deleteData` is set to true by default here: [Hive.java](https://github.com/apache/hive/blob/branch-3.1/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java#L965). This ensures data is automatically deleted for managed tables.\r\nHowever, data is not deleted for external tables pre-Hive4: [HiveMetaStore.java](https://github.com/apache/hive/blob/branch-3.1/standalone-metastore/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java#L2543), \r\nIntroduced in Hive4, we can now force the deletion even for external tables with the `external.table.purge=TRUE` property: [Docs](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-ExternalTables)\r\n\r\n> Is it correct that external.table.purge is not specific to Iceberg, it used in other tables too?\r\n\r\nCorrect, it's used for Hive tables as well.\r\n\r\nSo at the moment, all Hive Iceberg tables are external, therefore their data is not dropped automatically by Hive2 and Hive3 (Hive4 does so with the purge flag). Currently our solution for that is to check for the `external.table.purge` property in the `HiveIcebergMetaHook`, and if set, call `Catalogs.dropTable/CatalogUtil.dropTableData` to delete the data ourselves in the postHook.\r\n\r\n A Hive user should be able to decide whether or not data deletion is desirable for a table by changing the table property `external.table.purge`. Going forward, some of the options I see to avoid surprises:\r\n\r\n- Synchronizing `external.table.purge` with `gc.enabled`. When one changes, the other is changed accordingly. This could already work when changing the `gc.enabled` (and then altering the purge prop in HMS accordingly), but not the other way around (since `ALTER TABLE SET TBLPROPERTIES` is not implemented yet to push down HMS prop changes to Iceberg - although this is on our roadmap already). \r\n- Adding the `gc.enabled` prop to the HMS table props as well, make it control the data deletion for iceberg tables via the MetaHook (+ update docs to let users know of this) and let users change this prop via ALTER TABLE as desired. I don't really like this one, because it introduces an inconsistency between Iceberg and Hive tables.\r\n- Leaving things as is, but updating the Hive docs so that users are aware that DROP TABLE for Iceberg tables might behave differently depending on Iceberg configuration, and improve logging. I'm no big fan of this either.\r\n\r\nAt first glance, I think I'd prefer the first option. Any thoughts on this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806687999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806986428","html_url":"https://github.com/apache/iceberg/pull/2282#issuecomment-806986428","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2282","id":806986428,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjk4NjQyOA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T15:51:22Z","updated_at":"2021-03-25T15:51:22Z","author_association":"MEMBER","body":"@shardulm94 ping :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/806986428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807231637","html_url":"https://github.com/apache/iceberg/pull/2330#issuecomment-807231637","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2330","id":807231637,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzIzMTYzNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T18:23:03Z","updated_at":"2021-03-25T18:23:03Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, I think we can add more reserved properties in parallel. It's a good idea to add sort order, but spec can already be viewed in Spark using `DESCRIBE FORMATTED` so I don't think we need to add it. We should also consider the fact that users will try to set these properties directly, and make sure we have a good error message when it doesn't work.\r\n\r\nThis PR looks good to me. Any other comments before merging?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807231637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807263898","html_url":"https://github.com/apache/iceberg/pull/2333#issuecomment-807263898","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2333","id":807263898,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzI2Mzg5OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T18:42:58Z","updated_at":"2021-03-25T18:42:58Z","author_association":"CONTRIBUTOR","body":"@jackye1995, let's go with the no-arg constructor and remove `final`. Configuration is primarily accessed to create `FileIO`, which can then have a `final` reference. So I don't think this is in a critical path and we shouldn't worry about it. Probably not worth making the contract for dynamic loading more complicated and difficult to maintain.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807263898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807271699","html_url":"https://github.com/apache/iceberg/pull/2292#issuecomment-807271699","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2292","id":807271699,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzI3MTY5OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T18:47:58Z","updated_at":"2021-03-25T18:47:58Z","author_association":"CONTRIBUTOR","body":"Looks great! Thanks for the updates, and sorry I wasn't able to get back to this sooner.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807271699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807310913","html_url":"https://github.com/apache/iceberg/pull/2333#issuecomment-807310913","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2333","id":807310913,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzMxMDkxMw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T19:13:46Z","updated_at":"2021-03-25T19:13:46Z","author_association":"CONTRIBUTOR","body":"@rdblue I was just going to reply, I did some benchmarking, as expected there is a difference but it was at microsecond level, so I think it should be fine to just remove the final. I think I was overly conservative on this, thanks for the suggestion!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807310913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807874241","html_url":"https://github.com/apache/iceberg/issues/2357#issuecomment-807874241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2357","id":807874241,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzg3NDI0MQ==","user":{"login":"junsionzhang","id":10653297,"node_id":"MDQ6VXNlcjEwNjUzMjk3","avatar_url":"https://avatars.githubusercontent.com/u/10653297?v=4","gravatar_id":"","url":"https://api.github.com/users/junsionzhang","html_url":"https://github.com/junsionzhang","followers_url":"https://api.github.com/users/junsionzhang/followers","following_url":"https://api.github.com/users/junsionzhang/following{/other_user}","gists_url":"https://api.github.com/users/junsionzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/junsionzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junsionzhang/subscriptions","organizations_url":"https://api.github.com/users/junsionzhang/orgs","repos_url":"https://api.github.com/users/junsionzhang/repos","events_url":"https://api.github.com/users/junsionzhang/events{/privacy}","received_events_url":"https://api.github.com/users/junsionzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T01:57:56Z","updated_at":"2021-03-26T01:57:56Z","author_association":"NONE","body":"> Sorry @junsionzhang, I was not clear enough:\r\n> \r\n> * Please provide the output for `set iceberg.mr.catalog` - I suspect the catalog is not set in your Hive environment.\r\n> \r\n> Base on the output of the `DESCRIBE` I see that when the table is created the `hive.engine.enabled` was not set to true, so the `SerDe`, `InputFormat`, `OutputFormat` is not set correctly.\r\n> \r\n> Please check the https://iceberg.apache.org/hive/ page for more details.\r\n> \r\n> Thanks,\r\n> Peter\r\n\r\nThank you so much.\r\n1)when I run 'SET iceberg.mr.catalog;' for the first time after luanching hive comannd ,it says ''iceberg.mr.catalog is undefined'\r\nbut after  running 'SET iceberg.mr.catalog=hive' ,the command  'SET iceberg.mr.catalog;'  works fine and the ouput is 'iceberg.mr.catalog=hive'\r\n2) I do put the iceberg-hive-runtime-0.11.0.jar under $HIVE_HOME/lib\r\n3) what the SerDe, InputFormat, OutputFormat should be if everything is correct?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807874241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807887013","html_url":"https://github.com/apache/iceberg/issues/2351#issuecomment-807887013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2351","id":807887013,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzg4NzAxMw==","user":{"login":"yfcck","id":43957,"node_id":"MDQ6VXNlcjQzOTU3","avatar_url":"https://avatars.githubusercontent.com/u/43957?v=4","gravatar_id":"","url":"https://api.github.com/users/yfcck","html_url":"https://github.com/yfcck","followers_url":"https://api.github.com/users/yfcck/followers","following_url":"https://api.github.com/users/yfcck/following{/other_user}","gists_url":"https://api.github.com/users/yfcck/gists{/gist_id}","starred_url":"https://api.github.com/users/yfcck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yfcck/subscriptions","organizations_url":"https://api.github.com/users/yfcck/orgs","repos_url":"https://api.github.com/users/yfcck/repos","events_url":"https://api.github.com/users/yfcck/events{/privacy}","received_events_url":"https://api.github.com/users/yfcck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T02:25:45Z","updated_at":"2021-03-26T02:25:45Z","author_association":"NONE","body":"> @yyanyy @jackye1995 Did you encounter the similar issue ?\r\n\r\nhalo \r\n\r\nsure_date range 2018-2021\r\n\r\n```\r\nval partitionSpec = PartitionSpec.builderFor(schema).day(\"sure_date\").build()\r\n\r\njava.lang.IllegalStateException: Already closed files for partition: sure_date_day=2020-09-03\r\n\r\n\r\nval partitionSpec = PartitionSpec.builderFor(schema).month(\"sure_date\").build()\r\n\r\njava.lang.IllegalStateException: Already closed files for partition: sure_date_month=2020-09\r\n\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807887013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807915453","html_url":"https://github.com/apache/iceberg/issues/2383#issuecomment-807915453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2383","id":807915453,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzkxNTQ1Mw==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T03:49:03Z","updated_at":"2021-03-26T03:49:03Z","author_association":"MEMBER","body":"Temporary solution is revert #2331, see #2382","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807915453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807982041","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-807982041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":807982041,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzk4MjA0MQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T06:49:03Z","updated_at":"2021-03-26T06:49:03Z","author_association":"MEMBER","body":"I checked this RowKey specification twice again,  in my opinion  I think it's good enough to get this merged,  but since it's an  basic specification for iceberg table format.  I'd like to invite @rdblue and @aokolnychyi to do the double-check,  will be so appreciate if you two get this check when you have time, thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807982041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807982656","html_url":"https://github.com/apache/iceberg/pull/2343#issuecomment-807982656","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2343","id":807982656,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzk4MjY1Ng==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T06:50:23Z","updated_at":"2021-03-26T06:50:23Z","author_association":"MEMBER","body":"Let me rebase this PR to the latest commits, Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/807982656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808002861","html_url":"https://github.com/apache/iceberg/pull/2294#issuecomment-808002861","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2294","id":808002861,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODAwMjg2MQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T07:29:11Z","updated_at":"2021-03-26T07:29:11Z","author_association":"MEMBER","body":"Filed an issue to address the flakey unit test https://github.com/apache/iceberg/issues/2384, will retry the travis CI. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808002861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808007746","html_url":"https://github.com/apache/iceberg/issues/2384#issuecomment-808007746","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2384","id":808007746,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODAwNzc0Ng==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T07:38:32Z","updated_at":"2021-03-26T07:38:32Z","author_association":"MEMBER","body":"Checked the code path ( https://github.com/apache/iceberg/blob/master/flink/src/test/java/org/apache/iceberg/flink/TestFlinkTableSink.java#L290),  If the flink job did a failover, then it will produce some data files under the partition directories,  which has not been committed to apache iceberg table, so actually those files should not be visible to iceberg users.  I think we'd better to change the way to get the partition files by `Table.newScan().planFiles()`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808007746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808012608","html_url":"https://github.com/apache/iceberg/issues/1684#issuecomment-808012608","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1684","id":808012608,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODAxMjYwOA==","user":{"login":"junsionzhang","id":10653297,"node_id":"MDQ6VXNlcjEwNjUzMjk3","avatar_url":"https://avatars.githubusercontent.com/u/10653297?v=4","gravatar_id":"","url":"https://api.github.com/users/junsionzhang","html_url":"https://github.com/junsionzhang","followers_url":"https://api.github.com/users/junsionzhang/followers","following_url":"https://api.github.com/users/junsionzhang/following{/other_user}","gists_url":"https://api.github.com/users/junsionzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/junsionzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junsionzhang/subscriptions","organizations_url":"https://api.github.com/users/junsionzhang/orgs","repos_url":"https://api.github.com/users/junsionzhang/repos","events_url":"https://api.github.com/users/junsionzhang/events{/privacy}","received_events_url":"https://api.github.com/users/junsionzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T07:48:05Z","updated_at":"2021-03-26T07:48:05Z","author_association":"NONE","body":"> Hi @paulzanmei\r\n> \r\n> I tried your case on my local host, I did not query the hive catalog table ( which is created in flink sql) in hive sql successfully, but I did the similar thing successfully for hadoop table. Say the following steps would work:\r\n> \r\n> Step#1 : Create a hadoop catalog/database/table in flink sql and then write one record:\r\n> \r\n> ```shell\r\n> Flink SQL> CREATE CATALOG hadoop_catalog WITH (\r\n> >   'type'='iceberg',\r\n> >   'catalog-type'='hadoop',\r\n> >   'clients'='5',\r\n> >   'warehouse'='file:///Users/openinx/test/hive-warehouse1'\r\n> > );\r\n> [INFO] Catalog has been created.\r\n> \r\n> Flink SQL> show databases;\r\n> default_database\r\n> \r\n> Flink SQL> show tables; \r\n> [INFO] Result was empty.\r\n> \r\n> Flink SQL> use catalog hadoop_catalog; \r\n> \r\n> Flink SQL> show tables;\r\n> sample\r\n> \r\n> Flink SQL> insert into sample select 1, 'a';\r\n> [INFO] Submitting SQL update statement to the cluster...\r\n> [INFO] Table update statement has been successfully submitted to the cluster:\r\n> Job ID: 4b4b8c2b1a8d6f876a56f55abe4de1fe\r\n> ```\r\n> \r\n> Step#2: Create an external hive table in hive shell:\r\n> \r\n> ```sql\r\n> CREATE EXTERNAL TABLE sample_mirror2\r\n> STORED BY 'org.apache.iceberg.mr.hive.HiveIcebergStorageHandler'\r\n> LOCATION 'file:///Users/openinx/test/hive-warehouse1/default/sample';\r\n> ```\r\n> \r\n> And show tables:\r\n> \r\n> ```\r\n> show tables; \r\n> \r\n> +-----------------+\r\n> |    tab_name     |\r\n> +-----------------+\r\n> | sample_mirror2  |\r\n> +-----------------+\r\n> 1 rows selected (0.056 seconds)\r\n> ```\r\n> \r\n> Step#3: Query the records in hive shell:\r\n> \r\n> ```sql\r\n> select * from sample_mirror2;\r\n> \r\n> +--------------------+----------------------+\r\n> | sample_mirror2.id  | sample_mirror2.data  |\r\n> +--------------------+----------------------+\r\n> | 1                  | a                    |\r\n> +--------------------+----------------------+\r\n> 1 row selected (0.86 seconds)\r\n> ```\r\n> \r\n> I will figure out why it does not work for hive catalog table. @paulzanmei FYI\r\n\r\nhi, have you figured out the reason now ?  @JingsongLi  said 'Hive reader only supports read a existed Hadoop table...' ,but I think the link(https://iceberg.apache.org/hive/) does not say it clearly .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808012608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808017300","html_url":"https://github.com/apache/iceberg/issues/2357#issuecomment-808017300","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2357","id":808017300,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODAxNzMwMA==","user":{"login":"junsionzhang","id":10653297,"node_id":"MDQ6VXNlcjEwNjUzMjk3","avatar_url":"https://avatars.githubusercontent.com/u/10653297?v=4","gravatar_id":"","url":"https://api.github.com/users/junsionzhang","html_url":"https://github.com/junsionzhang","followers_url":"https://api.github.com/users/junsionzhang/followers","following_url":"https://api.github.com/users/junsionzhang/following{/other_user}","gists_url":"https://api.github.com/users/junsionzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/junsionzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junsionzhang/subscriptions","organizations_url":"https://api.github.com/users/junsionzhang/orgs","repos_url":"https://api.github.com/users/junsionzhang/repos","events_url":"https://api.github.com/users/junsionzhang/events{/privacy}","received_events_url":"https://api.github.com/users/junsionzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T07:56:58Z","updated_at":"2021-03-26T07:56:58Z","author_association":"NONE","body":"> Sorry @junsionzhang, I was not clear enough:\r\n> \r\n> * Please provide the output for `set iceberg.mr.catalog` - I suspect the catalog is not set in your Hive environment.\r\n> \r\n> Base on the output of the `DESCRIBE` I see that when the table is created the `hive.engine.enabled` was not set to true, so the `SerDe`, `InputFormat`, `OutputFormat` is not set correctly.\r\n> \r\n> Please check the https://iceberg.apache.org/hive/ page for more details.\r\n> \r\n> Thanks,\r\n> Peter\r\n\r\nIt seems the same question as  openinx. same steps ,same result. hadoop works but hive cannot  https://github.com/apache/iceberg/issues/1684#issuecomment-720339705","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808017300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808104730","html_url":"https://github.com/apache/iceberg/issues/2357#issuecomment-808104730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2357","id":808104730,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODEwNDczMA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T10:30:36Z","updated_at":"2021-03-26T10:30:36Z","author_association":"CONTRIBUTOR","body":"The issue you have linked is for older version of Iceberg. It should be possible to read the table from Hive with 0.11.0 version of Iceberg.\r\n\r\nBased on your answers I see two problems:\r\n1. When you are trying to read a table stored in HiveCatalog, you should set the catalog to hive. This could be set in the hive-site.xml, or before issuing the query you could issue the following command:\r\n```\r\nSET iceberg.mr.catalog=hive\r\n```\r\n2. When creating the table the `iceberg.engine.hive.enabled` should be set to true in the config. See the relevant part in the docs:\r\n> The value iceberg.engine.hive.enabled needs to be set to true and added to the Hive configuration file on the classpath of the application creating or modifying (altering, inserting etc.) the table.\r\n\r\nFor checking 1. you can issue `set iceberg.mr.catalog` and if the output is different from `hive` you should set it manually for the session (as you have already done based on you last comment)\r\n\r\nFor checking 2. you can issue `DESCRIBE FORMATTED <table_name>` and check if the SerDe, InputFormat, OutputFormat is set to the correct ones. If the table is created correctly then it should be something like this:\r\n```\r\nSerDe Library: org.apache.iceberg.mr.hive.HiveIcebergSerDe\r\nInputFormat: org.apache.iceberg.mr.hive.HiveIcebergInputFormat\r\nOutputFormat: org.apache.iceberg.mr.hive.HiveIcebergOutputFormat\r\n```\r\n\r\nThis should be done at table creation. I am not too familiar how Flink creates the table but alternatively it could be done at creation / modification time by setting the `engine.hive.enabled` Iceberg table property to `true`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808104730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808513458","html_url":"https://github.com/apache/iceberg/issues/2231#issuecomment-808513458","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2231","id":808513458,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODUxMzQ1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T21:17:37Z","updated_at":"2021-03-26T21:17:37Z","author_association":"CONTRIBUTOR","body":"We've considered naming snapshots as a \"tagging\" feature (to borrow a term from git). I'm also interested in named branches as well, since I think you may want to actually maintain data that has been tagged. I don't have current plans to build this yet, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808513458/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808520184","html_url":"https://github.com/apache/iceberg/pull/2385#issuecomment-808520184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2385","id":808520184,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODUyMDE4NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T21:33:13Z","updated_at":"2021-03-26T21:33:13Z","author_association":"CONTRIBUTOR","body":"Thanks, @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808520184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808603097","html_url":"https://github.com/apache/iceberg/pull/2365#issuecomment-808603097","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2365","id":808603097,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODYwMzA5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-27T00:27:19Z","updated_at":"2021-03-27T00:27:19Z","author_association":"CONTRIBUTOR","body":"This looks ready to go to me. I think there's a minor typo in the `simpleString` method to fix, but otherwise this is good to go. Thanks @jackye1995!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808603097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808606039","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-808606039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":808606039,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODYwNjAzOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-27T00:42:58Z","updated_at":"2021-03-27T00:42:58Z","author_association":"CONTRIBUTOR","body":"@jackye1995 and @openinx, I have a few questions about this before I'm comfortable merging it. Thanks for working on this so far!\r\n\r\nWhy do we need to track multiple versions of the row identifier like we do for schema, partition spec, and sort order? I think of this as the \"fields that identify a row\". Is it helpful to have more than one view of how rows are identified?\r\n\r\nTo answer that, we need to consider whether two versions are ever valid at the same time, and how row IDs are going to evolve over time:\r\n* Row identifier columns may be set, either to initialize or to fix a mistake (e.g., used account_id instead of profile_id)\r\n* Row identifier columns may be added, when a new identifying column is added to the schema (e.g., adding profile_id to a table previously identified by only account_id)\r\n\r\nI think both of those operations only require setting the current way of identifying rows, not keeping track of the previous ways. I'm interested to hear what everyone thinks about that and whether there is agreement.\r\n\r\nIf I'm correct, then I would probably not keep track of multiple versions here. If I'm not, then I think we should ask whether the row ID columns should be tracked in the schema itself rather than separately versioned, since they will probably change at the same time the schema does -- when adding a new column that is now part of the identifier.\r\n\r\nIt would be great to hear from @aokolnychyi on this as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808606039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808718975","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-808718975","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":808718975,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODcxODk3NQ==","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-27T11:37:40Z","updated_at":"2021-03-27T11:41:30Z","author_association":"NONE","body":"@jackye1995 I am passing `io-impl` to hive catalog in flink to save data in s3. I am getting the following error when trying to write data in S3 but I was able to write data to hdfs\r\n\r\n```\r\nException in thread \"main\" java.lang.NoClassDefFoundError: software/amazon/awssdk/services/s3/model/ObjectCannedACL\r\n\tat org.apache.iceberg.aws.AwsProperties.<init>(AwsProperties.java:236)\r\n\tat org.apache.iceberg.aws.s3.S3FileIO.initialize(S3FileIO.java:108)\r\n\tat org.apache.iceberg.CatalogUtil.loadFileIO(CatalogUtil.java:237)\r\n\tat org.apache.iceberg.hive.HiveCatalog.initialize(HiveCatalog.java:168)\r\n\tat org.apache.iceberg.hive.HiveCatalog.<init>(HiveCatalog.java:147)\r\n\tat org.apache.iceberg.flink.CatalogLoader$HiveCatalogLoader.loadCatalog(CatalogLoader.java:112)\r\n```\r\n\r\nHere's my code\r\n\r\n```Java\r\nConfiguration hadoopConf = new Configuration();\r\nhadoopConf.set(ConfigProperties.ENGINE_HIVE_ENABLED, \"true\");\r\nMap<String, String> catalogProperties = new HashMap<String, String>() {\r\n    {\r\n        put(\"uri\", \"thrift://AWS_EMR_MASTER_IP:9083\");\r\n        put(\"warehouse\", \"s3://bucket/warehouse/prefix\");\r\n        put(\"io-impl\", \"org.apache.iceberg.aws.s3.S3FileIO\");\r\n    }\r\n};\r\n\r\nCatalogLoader catalogLoader = CatalogLoader.hive(\"hive_catalog\", hadoopConf, catalogProperties);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808718975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808722969","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-808722969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":808722969,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODcyMjk2OQ==","user":{"login":"ayush-san","id":57655135,"node_id":"MDQ6VXNlcjU3NjU1MTM1","avatar_url":"https://avatars.githubusercontent.com/u/57655135?v=4","gravatar_id":"","url":"https://api.github.com/users/ayush-san","html_url":"https://github.com/ayush-san","followers_url":"https://api.github.com/users/ayush-san/followers","following_url":"https://api.github.com/users/ayush-san/following{/other_user}","gists_url":"https://api.github.com/users/ayush-san/gists{/gist_id}","starred_url":"https://api.github.com/users/ayush-san/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayush-san/subscriptions","organizations_url":"https://api.github.com/users/ayush-san/orgs","repos_url":"https://api.github.com/users/ayush-san/repos","events_url":"https://api.github.com/users/ayush-san/events{/privacy}","received_events_url":"https://api.github.com/users/ayush-san/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-27T12:10:15Z","updated_at":"2021-03-27T12:10:15Z","author_association":"NONE","body":"Please ignore my above message, as I was testing my job in the local environment it didn't have s3 library. I fixed it by adding software.amazon.awssdk.s3 library in my local.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808722969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808733308","html_url":"https://github.com/apache/iceberg/issues/2384#issuecomment-808733308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2384","id":808733308,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODczMzMwOA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-27T13:30:04Z","updated_at":"2021-03-27T13:30:04Z","author_association":"MEMBER","body":"Close this via https://github.com/apache/iceberg/pull/2385","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808733308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808747848","html_url":"https://github.com/apache/iceberg/issues/2388#issuecomment-808747848","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2388","id":808747848,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODc0Nzg0OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-27T15:15:42Z","updated_at":"2021-03-27T15:15:42Z","author_association":"MEMBER","body":"This is covered by #2244 which is currently in review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808747848/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808748042","html_url":"https://github.com/apache/iceberg/issues/2388#issuecomment-808748042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2388","id":808748042,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODc0ODA0Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-27T15:17:05Z","updated_at":"2021-03-27T15:17:05Z","author_association":"MEMBER","body":"Pr at #2282","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808748042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808941917","html_url":"https://github.com/apache/iceberg/issues/2391#issuecomment-808941917","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2391","id":808941917,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODk0MTkxNw==","user":{"login":"shangxinli","id":31421745,"node_id":"MDQ6VXNlcjMxNDIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31421745?v=4","gravatar_id":"","url":"https://api.github.com/users/shangxinli","html_url":"https://github.com/shangxinli","followers_url":"https://api.github.com/users/shangxinli/followers","following_url":"https://api.github.com/users/shangxinli/following{/other_user}","gists_url":"https://api.github.com/users/shangxinli/gists{/gist_id}","starred_url":"https://api.github.com/users/shangxinli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shangxinli/subscriptions","organizations_url":"https://api.github.com/users/shangxinli/orgs","repos_url":"https://api.github.com/users/shangxinli/repos","events_url":"https://api.github.com/users/shangxinli/events{/privacy}","received_events_url":"https://api.github.com/users/shangxinli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-28T18:55:49Z","updated_at":"2021-03-28T18:55:49Z","author_association":"CONTRIBUTOR","body":"cc @chenjunjiedada ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808941917/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808947121","html_url":"https://github.com/apache/iceberg/issues/2390#issuecomment-808947121","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2390","id":808947121,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODk0NzEyMQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-28T19:31:23Z","updated_at":"2021-03-28T19:31:23Z","author_association":"MEMBER","body":"We are already testing with builds of this, so the bump should be safe","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/808947121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809011235","html_url":"https://github.com/apache/iceberg/issues/2382#issuecomment-809011235","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2382","id":809011235,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTAxMTIzNQ==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T01:49:14Z","updated_at":"2021-03-29T01:49:14Z","author_association":"MEMBER","body":"cc @RussellSpitzer","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809011235/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809019427","html_url":"https://github.com/apache/iceberg/issues/2382#issuecomment-809019427","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2382","id":809019427,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTAxOTQyNw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T02:15:58Z","updated_at":"2021-03-29T02:15:58Z","author_association":"MEMBER","body":"We may need to provide several integration tests to validate that the spark-runtime jar & flink-runtime jar. Those tests will set up  a spark/flink mini cluster, and then load generated the spark/flink runtime jar, and finally run the sql script to do the validation.  In this way,  we could avoid the broken case when merging patches.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809019427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809033279","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-809033279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":809033279,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTAzMzI3OQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T03:06:21Z","updated_at":"2021-03-29T03:06:21Z","author_association":"MEMBER","body":"I think we should keep trace of multiple version in apache iceberg schema, let's discuss the case you described: adding profile_id to table previously identified by only account_id. \r\n\r\nt1:   User defines the `account_id` as the row identifier; \r\nt2:   Write few records into the table; \r\nt3:   Write few equality deletions (by `account_id`) into table; \r\nt4:   Adding `profile_id` to row identifier, now the identifier is `account_id` & `profile_id`; \r\nt5:   Write few equality deletions ( by `account_id` & `profile_id`) into table;\r\n\r\nIn my option,  the iceberg table format's row identifier specification is introduced because we expect the standard SQL's `PRIMARY KEY` could be mapped to those row identifier columns automatically \r\n\r\n(\r\nif we don't have the row identifier spec then we don't know how to track those keys when create table like: \r\n\r\n```sql\r\nCREATE TABLE sample(id INT, data STRING,  PRIMARY KEY (id) NOT ENFORCED);\r\n```\r\n)\r\n\r\nBack to the above case,  at the timestamp `t4` & `t5`,  the table's row identifier is `account_id` & `profile_id`.  If people want to read the snapshot at timestamp `t3`, then we should use the row identifier `account_id`.  So if we don't track the multiple version of identifier,  How could we read the row identifier from old snapshots ?  If use the latest `account_id` & `profile_id`,  that seems confuse people a lot because those rows are deleted only by field `account_id` actually.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809033279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809034581","html_url":"https://github.com/apache/iceberg/pull/2294#issuecomment-809034581","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2294","id":809034581,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTAzNDU4MQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T03:10:50Z","updated_at":"2021-03-29T03:10:50Z","author_association":"MEMBER","body":"Got this merged,  thanks @yyanyy and @chenjunjiedada for reviewing. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809034581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809037022","html_url":"https://github.com/apache/iceberg/pull/2364#issuecomment-809037022","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2364","id":809037022,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTAzNzAyMg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T03:18:22Z","updated_at":"2021-03-29T03:18:22Z","author_association":"MEMBER","body":"@chenjunjiedada  Thanks for updating this patch,  I've got the https://github.com/apache/iceberg/pull/2294 merged, that patch extends RewriteFiles API to rewrite both insert data files and delete files in iceberg.  I think we could rebase this patch based on the latest commit.  I will take a look at the patch again once you've rebased this. Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809037022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809039729","html_url":"https://github.com/apache/iceberg/issues/2344#issuecomment-809039729","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2344","id":809039729,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTAzOTcyOQ==","user":{"login":"chinaboyll","id":33946944,"node_id":"MDQ6VXNlcjMzOTQ2OTQ0","avatar_url":"https://avatars.githubusercontent.com/u/33946944?v=4","gravatar_id":"","url":"https://api.github.com/users/chinaboyll","html_url":"https://github.com/chinaboyll","followers_url":"https://api.github.com/users/chinaboyll/followers","following_url":"https://api.github.com/users/chinaboyll/following{/other_user}","gists_url":"https://api.github.com/users/chinaboyll/gists{/gist_id}","starred_url":"https://api.github.com/users/chinaboyll/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chinaboyll/subscriptions","organizations_url":"https://api.github.com/users/chinaboyll/orgs","repos_url":"https://api.github.com/users/chinaboyll/repos","events_url":"https://api.github.com/users/chinaboyll/events{/privacy}","received_events_url":"https://api.github.com/users/chinaboyll/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T03:27:00Z","updated_at":"2021-03-29T03:27:00Z","author_association":"NONE","body":"> I believe it is a Spark Version error because the extensions library is calling on a specific Spark internal function which is missing, but I don't see how that could be unless multiple Spark versions were on the classpath at the same time,\r\n\r\nthanks a lot","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809039729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809081325","html_url":"https://github.com/apache/iceberg/issues/2382#issuecomment-809081325","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2382","id":809081325,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTA4MTMyNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T05:37:13Z","updated_at":"2021-03-29T05:37:13Z","author_association":"MEMBER","body":"For Spark we could just run in local mode, no need to setup a full cluster. The classpath issues would be the same.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809081325/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809134936","html_url":"https://github.com/apache/iceberg/pull/2129#issuecomment-809134936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2129","id":809134936,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTEzNDkzNg==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T07:18:33Z","updated_at":"2021-03-29T07:18:48Z","author_association":"CONTRIBUTOR","body":"@rdblue @rymurr @pvary @marton-bod Could you please have a second look at this change? The caching related changes were merged in with #2325. Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809134936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809187598","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-809187598","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":809187598,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTE4NzU5OA==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T08:36:37Z","updated_at":"2021-03-29T08:36:37Z","author_association":"CONTRIBUTOR","body":"Hey @danielcweeks did you want to give this a review or can I go ahead and merge?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809187598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809214413","html_url":"https://github.com/apache/iceberg/issues/2388#issuecomment-809214413","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2388","id":809214413,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTIxNDQxMw==","user":{"login":"wynjauu","id":32868128,"node_id":"MDQ6VXNlcjMyODY4MTI4","avatar_url":"https://avatars.githubusercontent.com/u/32868128?v=4","gravatar_id":"","url":"https://api.github.com/users/wynjauu","html_url":"https://github.com/wynjauu","followers_url":"https://api.github.com/users/wynjauu/followers","following_url":"https://api.github.com/users/wynjauu/following{/other_user}","gists_url":"https://api.github.com/users/wynjauu/gists{/gist_id}","starred_url":"https://api.github.com/users/wynjauu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wynjauu/subscriptions","organizations_url":"https://api.github.com/users/wynjauu/orgs","repos_url":"https://api.github.com/users/wynjauu/repos","events_url":"https://api.github.com/users/wynjauu/events{/privacy}","received_events_url":"https://api.github.com/users/wynjauu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T09:13:14Z","updated_at":"2021-03-29T09:13:14Z","author_association":"NONE","body":"Thanks, I closed this and will continue to follow https://github.com/apache/iceberg/pull/2282\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809214413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809237209","html_url":"https://github.com/apache/iceberg/pull/2380#issuecomment-809237209","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2380","id":809237209,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTIzNzIwOQ==","user":{"login":"uncleGen","id":7402327,"node_id":"MDQ6VXNlcjc0MDIzMjc=","avatar_url":"https://avatars.githubusercontent.com/u/7402327?v=4","gravatar_id":"","url":"https://api.github.com/users/uncleGen","html_url":"https://github.com/uncleGen","followers_url":"https://api.github.com/users/uncleGen/followers","following_url":"https://api.github.com/users/uncleGen/following{/other_user}","gists_url":"https://api.github.com/users/uncleGen/gists{/gist_id}","starred_url":"https://api.github.com/users/uncleGen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uncleGen/subscriptions","organizations_url":"https://api.github.com/users/uncleGen/orgs","repos_url":"https://api.github.com/users/uncleGen/repos","events_url":"https://api.github.com/users/uncleGen/events{/privacy}","received_events_url":"https://api.github.com/users/uncleGen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T09:43:19Z","updated_at":"2021-03-29T09:43:19Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809237209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809393405","html_url":"https://github.com/apache/iceberg/pull/2304#issuecomment-809393405","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2304","id":809393405,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTM5MzQwNQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T13:50:51Z","updated_at":"2021-03-29T13:50:51Z","author_association":"CONTRIBUTOR","body":"@rdblue any thoughts on this one? This is as per #1808 and to isolate SQL extensions from actual nessie code. \r\n\r\nI am ok w/ most of it but I am wondering if we really want a `Reference` in the interface it seems tightly coupled to git-like concepts","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809393405/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809447783","html_url":"https://github.com/apache/iceberg/issues/2391#issuecomment-809447783","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2391","id":809447783,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTQ0Nzc4Mw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T14:56:22Z","updated_at":"2021-03-29T14:56:22Z","author_association":"COLLABORATOR","body":"Thanks for ping me, @shangxinli ! Let me try locally first, will post PR once it works well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809447783/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809468612","html_url":"https://github.com/apache/iceberg/pull/2364#issuecomment-809468612","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2364","id":809468612,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTQ2ODYxMg==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T15:20:29Z","updated_at":"2021-03-29T15:20:29Z","author_association":"COLLABORATOR","body":"Thanks for review, @openinx !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809468612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809493573","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-809493573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":809493573,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTQ5MzU3Mw==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T15:53:11Z","updated_at":"2021-03-29T15:53:11Z","author_association":"CONTRIBUTOR","body":"@szehon-ho Just one comment about swallowing failures, bot other than that, it looks good to me.  @rymurr feel free to merge when you think it's ready.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809493573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809539515","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-809539515","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":809539515,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTUzOTUxNQ==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T16:51:16Z","updated_at":"2021-03-29T16:51:16Z","author_association":"CONTRIBUTOR","body":"@openinx for your example, my understanding is that at t3, the equality delete file would have a row like `account_id=xxx`, and at t5, the new equality file would have a row like `account_id=yyy, profile_id=zzz`, basically the row key information at that point of time is already in the delete file written at that time. When time traveling to t4, the delete file written at that time can still work without the need to consult the latest row key.\r\n\r\n@rdblue I actually mostly agree with what you mention, as I don't see why the example mentioned by openinx would not work, but maybe I missed something there. But I decided to go with the versioned approach because I think it can potentially be used to provide some uniqueness guarantee at read time in the future by merging rows, given the fact that now we basically have a primary key concept through RowKey and a sort key concept through SortOrder. And at that time, we will need this information to be present in the specific snapshot that we time travel to.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809539515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809549272","html_url":"https://github.com/apache/iceberg/issues/2168#issuecomment-809549272","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2168","id":809549272,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTU0OTI3Mg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T17:05:39Z","updated_at":"2021-03-29T17:05:39Z","author_association":"CONTRIBUTOR","body":"Cool, sorry I was out during the weekend. It seems worth adding a section describing these details about Flink in the documentation since there have been multiple people asking the same question, let me just do that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809549272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809556897","html_url":"https://github.com/apache/iceberg/pull/2365#issuecomment-809556897","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2365","id":809556897,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTU1Njg5Nw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T17:17:34Z","updated_at":"2021-03-29T17:17:34Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks for the review, I updated the simple string.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809556897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809705825","html_url":"https://github.com/apache/iceberg/pull/2365#issuecomment-809705825","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2365","id":809705825,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTcwNTgyNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T20:52:38Z","updated_at":"2021-03-29T20:52:38Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks @jackye1995!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809705825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809718836","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-809718836","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":809718836,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTcxODgzNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T21:14:22Z","updated_at":"2021-03-29T21:14:22Z","author_association":"CONTRIBUTOR","body":"@openinx, I think that @jackye1995 is right about how the case you described would be encoded. The delete files themselves always encode what columns are used for the equality delete.\r\n\r\nThere is no requirement that a delete file's delete columns match the table's row identifier fields. That's one reason why we can encode deletes right now, before we've added the row identifier tracking. That also enables deleting rows by different fields than the row identifier fields, which is what makes the evolution case possible.\r\n\r\nThe row identifier fields are related to deletes only in that in situations where we don't have explicit delete columns in the operation, we can default the delete columns to the row identifier fields. That's to support the `UPSERT` case, where we define the identity fields in table metadata rather than in the sink configuration.\r\n\r\nFrom @jackye1995's second comment, I think there is at least some agreement that the row identifier columns don't need to be tracked over time. That's because there is no way to go back to an older snapshot and then manipulate that data. Time travel is read-only and data manipulation is always applied to the current snapshot, so it is reasonable that there is only ever one version of the row identifier that matters: the one that is configured at the start of the operation.\r\n\r\nBefore moving ahead with this, I think we should simplify it and remove the versioning.\r\n\r\nI'm also wondering about the field ordering mentioned in the code. Is that relevant? I think of the row identifier fields as unordered and simply used to produce a projection of the table schema that is a row identifier, in whatever field order the schema had. So I would model this as an unordered set of IDs rather than as an ordered collection.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809718836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809740239","html_url":"https://github.com/apache/iceberg/pull/2333#issuecomment-809740239","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2333","id":809740239,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTc0MDIzOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T21:56:45Z","updated_at":"2021-03-29T21:56:45Z","author_association":"CONTRIBUTOR","body":"Thanks everyone! I am going to include this change in 0.11.1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809740239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809745464","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-809745464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":809745464,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTc0NTQ2NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T22:08:25Z","updated_at":"2021-03-29T22:08:25Z","author_association":"CONTRIBUTOR","body":"@rdblue for the ordering, I was thinking about potential features like clustering index, where the order of primary key matters for performance of the index. But I am okay to start simple by removing versioning and making the fields unordered for now. \r\n\r\n@openinx are you okay with those changes?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809745464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809749423","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-809749423","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":809749423,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTc0OTQyMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T22:17:17Z","updated_at":"2021-03-29T22:17:17Z","author_association":"CONTRIBUTOR","body":"@jackye1995, I don't think that the row identifier fields are strongly related to a clustering index. Records in an Iceberg table are physically sorted according to some order used at write time, and also distributed by a hash or ordered distribution. That logic is independent. And a future index type that has some order for its contents would probably be separately configured and would also not use the row identifier fields.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809749423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809758474","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-809758474","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":809758474,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTc1ODQ3NA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T22:38:05Z","updated_at":"2021-03-29T22:38:05Z","author_association":"CONTRIBUTOR","body":"@rdblue sounds good to me, I will make the update, thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809758474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809813597","html_url":"https://github.com/apache/iceberg/pull/2293#issuecomment-809813597","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2293","id":809813597,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTgxMzU5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T00:24:20Z","updated_at":"2021-03-30T00:24:20Z","author_association":"CONTRIBUTOR","body":"Looks great! Thanks for fixing this, @edgarRd!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809813597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809822338","html_url":"https://github.com/apache/iceberg/pull/2336#issuecomment-809822338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2336","id":809822338,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTgyMjMzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T00:51:22Z","updated_at":"2021-03-30T00:51:22Z","author_association":"CONTRIBUTOR","body":"@omaraloraini, just want to check with you to see if you're willing to re-open and update this? I think this could be a good performance improvement after all!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809822338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809823407","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-809823407","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":809823407,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTgyMzQwNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T00:54:54Z","updated_at":"2021-03-30T00:54:54Z","author_association":"CONTRIBUTOR","body":"@chenjunjiedada, I started reviewing this again, but I think we should reconsider the direction that this is taking.\r\n\r\nMy initial review comments were based on this change in isolation, which left out position deletes. Adding position deletes is harder because you can't union the rows that are deleted by position with the rows deleted by equality because a row may have been deleted by both if a position delete is encoded, followed by an equality delete that applies to the same data file. You could update this to avoid the duplicates, but I think that would result in substantial changes and doesn't actually get us closer to what you're trying to do.\r\n\r\nIf I understand correctly, what you're trying to do is to create a Spark `DataFrame` of deleted rows. That way, you could use Spark to project `_file` and `_pos`, sort it by those fields, and then write the position delete files from the resulting `DataFrame`. That's probably why you didn't consider position-based deletes in the initial PR. Is this correct?\r\n\r\nIf so, I think that the approach should be slightly different. Updating the filter supports the original goal of rewriting equality deletes, but is strangely specific and doesn't easily support other uses. Instead, I think that the way to do this is to select _all_ rows and set a metadata column to indicate whether or not the row is deleted. That's an easy way to guarantee that the deleted rows are returned just once because every row is returned once. The filtering may set the same \"_is_deleted\" field on the record but that's okay. Then we can use the resulting DataFrame for more operations, like inspecting row-level deletes or producing records for streaming (both inserted and deleted).\r\n\r\nWhat do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809823407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809826433","html_url":"https://github.com/apache/iceberg/pull/2336#issuecomment-809826433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2336","id":809826433,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTgyNjQzMw==","user":{"login":"ooraini","id":5780138,"node_id":"MDQ6VXNlcjU3ODAxMzg=","avatar_url":"https://avatars.githubusercontent.com/u/5780138?v=4","gravatar_id":"","url":"https://api.github.com/users/ooraini","html_url":"https://github.com/ooraini","followers_url":"https://api.github.com/users/ooraini/followers","following_url":"https://api.github.com/users/ooraini/following{/other_user}","gists_url":"https://api.github.com/users/ooraini/gists{/gist_id}","starred_url":"https://api.github.com/users/ooraini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ooraini/subscriptions","organizations_url":"https://api.github.com/users/ooraini/orgs","repos_url":"https://api.github.com/users/ooraini/repos","events_url":"https://api.github.com/users/ooraini/events{/privacy}","received_events_url":"https://api.github.com/users/ooraini/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T01:03:26Z","updated_at":"2021-03-30T01:03:26Z","author_association":"NONE","body":"@rdblue, I did some other test and things seems to have regressed, I'm not confident in the change, and introducing more public API surface without a lot of added value is making me hesitant.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809826433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809846246","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-809846246","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":809846246,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTg0NjI0Ng==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T01:56:26Z","updated_at":"2021-03-30T01:56:26Z","author_association":"COLLABORATOR","body":"Thanks for the review and comments!\r\n\r\nThe original thought is to handle equality delete and position delete respectively,  which I called a different level of minor compactions. The separate compactions allow users to control the file scan more fine-grained, so as to mitigate overhead to name node. For example, users could monitor the number of equality deletes and position deletes from the snapshot summary and performs a spark or flink action to do the specific compaction.\r\n\r\nI didn't consider reading all deleted row because I thought it is major compaction and it may similar to the action remove all deletes. If we want to support one more level compaction which read all deletes and rewrite them to position deletes I think your suggestion definitely works.\r\n\r\nSo I think it would be better to remove the logic of reading all deleted rows in this PR, and use the suggested way to implement it and also add an action for it. While I'd like to keep the current separate compaction actions for the fine-grained usage. Does that make sense to you?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809846246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809869373","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-809869373","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":809869373,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTg2OTM3Mw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T03:03:40Z","updated_at":"2021-03-30T03:03:40Z","author_association":"MEMBER","body":"> basically the row key information at that point of time is already in the delete file written at that time.  \r\n\r\n@jackye1995 @rdblue  Yes,  I can understand that we've maintained the equality field ids inside each equality delete files and iterating records from an old snapshot should be correct because we've considered [applying process](https://github.com/apache/iceberg/blob/90225d6c9413016d611e2ce5eff37db1bc1b4fc5/data/src/main/java/org/apache/iceberg/data/DeleteFilter.java#L126) for different equality fields ids. \r\n\r\nBut in this [comment](https://github.com/apache/iceberg/pull/2354#issuecomment-809033279), I'm not discussing the data correctness (the data correctness has no problem).  I mean people should be able to read the old `RowKey` from an older snapshot. In this issue https://github.com/apache/iceberg/issues/1029,  we are proposing to attach the `schema` in snapshot so that users could create a complete table based on an existing snapshot by using CTAS or RTAS, in this scenarios I think we also need to use the old `PartitionSpec`, `SortOrder`, `RowKey` in the newly created table.  Then at the iceberg table level,  people could see the consistent table metadata.\r\n\r\nAnother case is rollback to an older snapshot by replacing the latest snapshot,  though we currently do not support replacing schema/partition-spec/sort-order with the old one,  but in my mind I think we'd better to because providing an uniformed view of data files, schema and other table metadata at the old timestamp `t3` matches the expectations from end users. \r\n\r\nThat's why I recommended to track the multiple versions of `RowKey` in iceberg table metadata. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809869373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809904718","html_url":"https://github.com/apache/iceberg/pull/2362#issuecomment-809904718","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2362","id":809904718,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTkwNDcxOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T04:48:05Z","updated_at":"2021-03-30T04:48:05Z","author_association":"CONTRIBUTOR","body":"This is ready for a detailed review round, @pvary @rdblue @szehon-ho @RussellSpitzer.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809904718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809907809","html_url":"https://github.com/apache/iceberg/pull/2362#issuecomment-809907809","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2362","id":809907809,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTkwNzgwOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T04:56:47Z","updated_at":"2021-03-30T04:56:47Z","author_association":"CONTRIBUTOR","body":"I can probably split this into 2-3 PRs. Let me do that tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809907809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809948658","html_url":"https://github.com/apache/iceberg/pull/2393#issuecomment-809948658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2393","id":809948658,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTk0ODY1OA==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T06:27:13Z","updated_at":"2021-03-30T06:27:13Z","author_association":"CONTRIBUTOR","body":"Hi @RussellSpitzer, @szehon-ho, can you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809948658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809950961","html_url":"https://github.com/apache/iceberg/pull/2330#issuecomment-809950961","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2330","id":809950961,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTk1MDk2MQ==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T06:31:28Z","updated_at":"2021-03-30T06:31:28Z","author_association":"CONTRIBUTOR","body":"Hi @aokolnychyi @rdblue @RussellSpitzer, is this PR ready for merging?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809950961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809976337","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-809976337","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":809976337,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTk3NjMzNw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T07:16:41Z","updated_at":"2021-03-30T07:16:41Z","author_association":"MEMBER","body":"In my original mind,  there are two kinds of compaction:  \r\n\r\na.  convert all equality deletes into position deletes.  As whether should we eliminate the duplicate position deletes at the same time, the difference for me is:  if the duplicate pos-deletes is removed during rewrite, the user's reading efficiency will be higher; if not, the reading efficiency will be worse. Generally speaking, I think it is a trade-off problem in performance optimization.  Both of them seems to be acceptable to me. \r\n\r\nb. Eliminate all deletes (include pos-deletes and equality-deletes). It is very suitable for the situation where delete has a high proportion in the whole table.  On the one hand, we can save a lot of unnecessary storage, and on the other hand, we can avoid a lot of inefficient joins when reading data.  [This](https://github.com/apache/iceberg/pull/2303/files#diff-605d0d98a73f67629cddbceb9a566e8655844a3cdf46b4dbcebd0e19102e82b4R128) is more simpler to implement compared to the case.a. \r\n\r\nAfter reading @rdblue 's [comment](https://github.com/apache/iceberg/pull/2372#issuecomment-809823407) , what makes me feel the most valuable is:  we can use the abstraction of meta-column to achieve code unification of case.a, case.b, and the normal read path.  Saying if we have an `iterable=Iterable<Row>` with `_is_deleted` flag inside each row: \r\n\r\nFor case.a,   we could just use `Iterables.transform(Iterables.filter(iterable, row -> row.isDeleted()), row -> (row.file(), row.pos()))`  to generate all the pos-deletes.\r\n\r\nFor case.b,  we could just use `Iterables.filter(iterable, row -> !row.isDeleted())` to get all remaining rows.\r\n\r\nFor the normal read path, it's same to the case.b.\r\n\r\nThis implementation greatly reduces the complexity of various paths, I think we can try this kind of code implementation.\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809976337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809988883","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-809988883","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":809988883,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTk4ODg4Mw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T07:35:59Z","updated_at":"2021-03-30T07:35:59Z","author_association":"MEMBER","body":"As producing records for streaming (both inserted and deleted),  I'm not quite sure whether will it work because people usually consume delta files between two snapshots incrementally.   The equality deletes from delta files will need to be applied to the downstream consumer firstly because they are deleting the records that has been committed in the previous txn, while pos-deletes are deleting the records committed in the current txn. Applying the row marked _is_deleted directly to the downstream table may cause the upstream's pos-delete to delete data that should not be deleted in downstream.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/809988883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810067302","html_url":"https://github.com/apache/iceberg/issues/2198#issuecomment-810067302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2198","id":810067302,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDA2NzMwMg==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T09:27:22Z","updated_at":"2021-03-30T09:27:22Z","author_association":"CONTRIBUTOR","body":"Sorry for the late reply, i found that this exception only occurs in the initializeMapOperator phase, org.apache.iceberg.mr.hive.HiveIcebergSerDe will not be used to deserialize data from hive table, so i just simply caught this exception and logged it, then everything works fine.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810067302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810092443","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-810092443","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":810092443,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDA5MjQ0Mw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T10:04:31Z","updated_at":"2021-03-30T10:04:31Z","author_association":"MEMBER","body":"> Instead, I think that the way to do this is to select all rows and set a metadata column to indicate whether or not the row is deleted.\r\n\r\nI've tried to think about how to add the `_is_deleted` metadata column for each record read from Parquet/Orc Readers. The workflow should be: \r\n\r\n1.   Add a boolean reader at the tail when constructing the Parquet/Orc Readers for the given iceberg schema,  the boolean reader will just fill a default value `false` for each record.   The real value will be filled after checked the equality delete files & pos delete files iteratively; \r\n2.  The struct parquet/orc reader read the whole row,  now the `_is_deleted` value is `false` by default; \r\n3.  Check the equality delete files and position delete files.  set the `_is_deleted` to be `true` if the row has been deleted successfully.  it will require the flink RowData & spark InternalRow provide `setValue(pos, value)` interface to update the real value of `_is_deleted`.\r\n4.  Return `Iterable<Row>`.\r\n\r\nThe most complicated work occurs in the third step,  because we will need to refactor all the `Deletes#filter` path to return a boolean flag for a row , rather than just returning the filtered `iterable<T>`.  This will mean that we have almost refactored the logic related to delete filter. Now I am a little hesitant whether it is necessary to do this.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810092443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810167438","html_url":"https://github.com/apache/iceberg/pull/2228#issuecomment-810167438","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2228","id":810167438,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDE2NzQzOA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T12:08:16Z","updated_at":"2021-03-30T12:08:16Z","author_association":"CONTRIBUTOR","body":"Merged to master.\r\nThanks for the review @rdblue, @marton-bod, @jackye1995, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810167438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810389971","html_url":"https://github.com/apache/iceberg/issues/1378#issuecomment-810389971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1378","id":810389971,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDM4OTk3MQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T16:09:42Z","updated_at":"2021-03-30T16:09:42Z","author_association":"MEMBER","body":"#1744 I have a ongoing fix for this, @rdblue and I were in dialog about the proper way to fix this and had some disagreements. I do want to get back to it and fix this properly","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810389971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810390392","html_url":"https://github.com/apache/iceberg/pull/1744#issuecomment-810390392","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1744","id":810390392,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDM5MDM5Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T16:10:17Z","updated_at":"2021-03-30T16:10:17Z","author_association":"MEMBER","body":"@szehon-ho Let's work together to figure out a solution to this :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810390392/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810410893","html_url":"https://github.com/apache/iceberg/pull/2354#issuecomment-810410893","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2354","id":810410893,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQxMDg5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T16:39:55Z","updated_at":"2021-03-30T16:39:55Z","author_association":"CONTRIBUTOR","body":"@openinx, I think understand what you're saying: that if we track the schema for a snapshot then why not track the partition spec, sort order, and row identifier information?\r\n\r\nThe reason is that the partition spec, sort order, and row identifier do not affect existing snapshots. Those are used when writing, not when reading. When reading, we always use whatever the data files are written with.\r\n\r\nA good example of this is partition spec. The table has a \"default\" partition spec that is used when writing new data, but existing data in the table was already written with one or more specs that don't change. Once a manifest is written using some partition spec, that spec is fixed and part of the metadata tree. We don't need to keep around the spec that was used to produce a given snapshot because it isn't useful. What is useful is what spec was used to write any given manifest, and that's encoded in the manifest's metadata.\r\n\r\nSort order and row identifier fields are the same way. Once we've written data in some order, we attach the order and we don't need to know what the table's order was anymore. For delete file fields, we can use the table's row identifier fields but once we've done that we don't need to know what the table's configuration was any more.\r\n\r\nSchema is a bit different because we need to know what the \"current\" schema was in order to time-travel because we can change the schema and continue reading the same data files afterward.\r\n\r\nI think that we should not attach the row identifier fields to the schema, and should instead consider them table metadata that gets used on write, but is not needed for time travel.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810410893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810430372","html_url":"https://github.com/apache/iceberg/pull/2393#issuecomment-810430372","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2393","id":810430372,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQzMDM3Mg==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T17:09:11Z","updated_at":"2021-03-30T17:09:11Z","author_association":"COLLABORATOR","body":"Thanks @flyrain for fixing the doc!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810430372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810435064","html_url":"https://github.com/apache/iceberg/pull/2393#issuecomment-810435064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2393","id":810435064,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQzNTA2NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T17:16:26Z","updated_at":"2021-03-30T17:16:26Z","author_association":"MEMBER","body":"Thanks @flyrain !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810435064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810453141","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-810453141","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":810453141,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQ1MzE0MQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T17:44:39Z","updated_at":"2021-03-30T18:24:05Z","author_association":"COLLABORATOR","body":"@rymurr  thanks for remembering, i was going to ping you as well now that you are committer :).  I updated with a basic log, just wondering about the set, let me know and i can change as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810453141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810457680","html_url":"https://github.com/apache/iceberg/pull/2330#issuecomment-810457680","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2330","id":810457680,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQ1NzY4MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T17:51:49Z","updated_at":"2021-03-30T17:51:49Z","author_association":"CONTRIBUTOR","body":"Since there were no more comments, I merged this. Thanks @flyrain!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810457680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810458594","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-810458594","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":810458594,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQ1ODU5NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T17:53:11Z","updated_at":"2021-03-30T17:53:11Z","author_association":"CONTRIBUTOR","body":"> The most complicated work occurs in the third step, because we will need to refactor all the `Deletes#filter` path to return a boolean flag for a row, rather than just returning the filtered `Iterable<T>`. This will mean that we have almost refactored the logic related to delete filter. Now I am a little hesitant whether it is necessary to do this.\r\n\r\nI think we can leave most of the existing read path as-is because we don't need to do this unless we are projecting deleted rows, but I agree with you that this would be a bit more work. That's why we need to consider the purpose of this change. It sounds like the goal is to rewrite equality deletes as position deletes, but it isn't quite clear. @chenjunjiedada or @openinx, can you confirm why you wanted to be able to read equality-deleted rows like this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810458594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810461257","html_url":"https://github.com/apache/iceberg/pull/2343#issuecomment-810461257","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2343","id":810461257,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQ2MTI1Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T17:57:07Z","updated_at":"2021-03-30T17:57:07Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks for fixing this, @openinx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810461257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810472428","html_url":"https://github.com/apache/iceberg/pull/2324#issuecomment-810472428","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2324","id":810472428,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQ3MjQyOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T18:13:55Z","updated_at":"2021-03-30T18:13:55Z","author_association":"CONTRIBUTOR","body":"@rymurr, do you want to update this now that #2328 is in?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810472428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810473537","html_url":"https://github.com/apache/iceberg/pull/2386#issuecomment-810473537","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2386","id":810473537,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQ3MzUzNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T18:15:41Z","updated_at":"2021-03-30T18:15:41Z","author_association":"CONTRIBUTOR","body":"This looks fine to me, but it would be good to have someone more familiar with Flink take a look. @stevenzwu, could you review this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810473537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810473752","html_url":"https://github.com/apache/iceberg/pull/2330#issuecomment-810473752","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2330","id":810473752,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQ3Mzc1Mg==","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T18:16:02Z","updated_at":"2021-03-30T18:16:02Z","author_association":"CONTRIBUTOR","body":"Thanks @RussellSpitzer, @aokolnychyi and @rdblue for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/810473752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]