[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/795644434","html_url":"https://github.com/apache/accumulo/issues/1924#issuecomment-795644434","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1924","id":795644434,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTY0NDQzNA==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T15:54:45Z","updated_at":"2021-03-10T15:54:45Z","author_association":"MEMBER","body":"From what I can tell, there is no easy way to get this to work while using `WeakHashMap`. It seems the strong reference to `name` in `SharedRateLimiter` might be unavoidable. Maybe the best option is just to use `HashMap`.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/795644434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/795906094","html_url":"https://github.com/apache/accumulo/pull/1656#issuecomment-795906094","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1656","id":795906094,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTkwNjA5NA==","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T18:52:32Z","updated_at":"2021-03-10T18:52:32Z","author_association":"CONTRIBUTOR","body":"> @friedlou What does this change accomplish? There is no description of the change that helps us understand what it is trying to accomplish. From what I can tell, the most obvious consequence is fewer log messages: one for all failures, rather than individual messages for each failure in the loop that is skipped later, perhaps? I'm not sure that's much of an improvement, especially since, as @milleruntime says, it only affects the legacy bulk import. Am I missing something? Is there another benefit to this change?\r\n\r\nThe main reason for this is that we have timing issues associated with bulk loading where we need to ensure that the master waits long enough for the tserver to finish its retries. We have multiple situations that occur when tservers fail to assign things in a timely fashion.  The most nasty of those is where the garbage collector has removed the file because all of the other tablets have successfully assigned and major compacted away.  Meanwhile a tablet doing retries finally assigns the file and finds it gone.  When we have retries if becomes difficult to bound the time so we were attempting to set the retries to 0 only to find out that it still retried once.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/795906094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/795953193","html_url":"https://github.com/apache/accumulo/issues/1963#issuecomment-795953193","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1963","id":795953193,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NTk1MzE5Mw==","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T19:25:56Z","updated_at":"2021-03-10T19:28:43Z","author_association":"CONTRIBUTOR","body":"Perhaps a trace mechanism akin to a scan trace is doable where we can trace the life of a file through the accumulo system.  That could include everything from initial mapping through to deletion.  This would be a large undertaking but perhaps worth the effort if we can minimize the performance impact.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/795953193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796081347","html_url":"https://github.com/apache/accumulo/pull/1780#issuecomment-796081347","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1780","id":796081347,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjA4MTM0Nw==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T20:49:14Z","updated_at":"2021-03-10T20:49:14Z","author_association":"MEMBER","body":"There has been some recent discussion about following through with a thrift upgrade. It seems since work has been done on this PR, thrift 14.1 has been released. Does this seem like an improvement we should make at this time?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796081347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796141534","html_url":"https://github.com/apache/accumulo/issues/1963#issuecomment-796141534","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1963","id":796141534,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjE0MTUzNA==","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-10T21:26:03Z","updated_at":"2021-03-10T21:30:21Z","author_association":"CONTRIBUTOR","body":"Created an initial pull request #1964 which shows the generation of a simple JSON encoded mapping file.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796141534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796391614","html_url":"https://github.com/apache/accumulo/pull/1780#issuecomment-796391614","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1780","id":796391614,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjM5MTYxNA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T02:43:13Z","updated_at":"2021-03-11T02:43:13Z","author_association":"MEMBER","body":"> There has been some recent discussion about following through with a thrift upgrade. It seems since work has been done on this PR, thrift 14.1 has been released. Does this seem like an improvement we should make at this time?\r\n\r\nIf somebody does the work required to get us to the newer version, then yes, we should apply it. Such work would supersede this PR.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796391614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796396470","html_url":"https://github.com/apache/accumulo/issues/1924#issuecomment-796396470","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1924","id":796396470,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NjM5NjQ3MA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T02:53:21Z","updated_at":"2021-03-11T02:53:21Z","author_association":"MEMBER","body":"@DomGarguilo The `WeakHashMap` already uses weakly referenced keys. However, the objects in the value are strong references by default. The way to ensure the values in the hashmap don't retain strong references to the keys in the map is to wrap the values themselves in a `WeakReference`. So, instead of a `WeakHashMap<String,SharedRateLimiter>`, you would simply wrap the values and make them `WeakHashMap<String,WeakReference<SharedRateLimiter>>` instead.  See the implementation note in the [`WeakHashMap` javadoc](https://docs.oracle.com/javase/8/docs/api/java/util/WeakHashMap.html) for a similar explanation.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796396470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796875355","html_url":"https://github.com/apache/accumulo/pull/1964#issuecomment-796875355","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1964","id":796875355,"node_id":"MDEyOklzc3VlQ29tbWVudDc5Njg3NTM1NQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-11T16:42:19Z","updated_at":"2021-03-11T16:42:19Z","author_association":"CONTRIBUTOR","body":"This is an enhancement and 1.10 is only going to have bug fix releases.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/796875355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/797635529","html_url":"https://github.com/apache/accumulo/pull/1656#issuecomment-797635529","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1656","id":797635529,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzYzNTUyOQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T17:19:57Z","updated_at":"2021-03-12T17:19:57Z","author_association":"CONTRIBUTOR","body":"I am not convinced setting retries to 0 will necessarily improve your situation as that could lead to a lot more bulk import failures. But I agree that the intuitive behavior of setting \"tserver.bulk.retry.max\" to 0 should be that it won't retry. I think this would be OK as a bug fix for 1.10. @friedlou is that where you meant this to go? Otherwise, you are just making changes to the deprecated code in 2.1.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/797635529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/797648755","html_url":"https://github.com/apache/accumulo/pull/1656#issuecomment-797648755","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1656","id":797648755,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzY0ODc1NQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T17:42:39Z","updated_at":"2021-03-12T17:42:39Z","author_association":"CONTRIBUTOR","body":"Also, this may no longer be a problem with the new bulk import in 2.x (or a different problem altogether since the new one will keep retrying to load the files asynchronously).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/797648755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/797694175","html_url":"https://github.com/apache/accumulo/issues/1949#issuecomment-797694175","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1949","id":797694175,"node_id":"MDEyOklzc3VlQ29tbWVudDc5NzY5NDE3NQ==","user":{"login":"harjitdotsingh","id":75006,"node_id":"MDQ6VXNlcjc1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/75006?v=4","gravatar_id":"","url":"https://api.github.com/users/harjitdotsingh","html_url":"https://github.com/harjitdotsingh","followers_url":"https://api.github.com/users/harjitdotsingh/followers","following_url":"https://api.github.com/users/harjitdotsingh/following{/other_user}","gists_url":"https://api.github.com/users/harjitdotsingh/gists{/gist_id}","starred_url":"https://api.github.com/users/harjitdotsingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harjitdotsingh/subscriptions","organizations_url":"https://api.github.com/users/harjitdotsingh/orgs","repos_url":"https://api.github.com/users/harjitdotsingh/repos","events_url":"https://api.github.com/users/harjitdotsingh/events{/privacy}","received_events_url":"https://api.github.com/users/harjitdotsingh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-12T19:12:01Z","updated_at":"2021-03-12T19:12:23Z","author_association":"CONTRIBUTOR","body":"I would like to start working on this. @ctubbsii Which files/methods need to be deprecated?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/797694175/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798530244","html_url":"https://github.com/apache/accumulo/pull/1969#issuecomment-798530244","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1969","id":798530244,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODUzMDI0NA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T15:42:15Z","updated_at":"2021-03-13T15:42:15Z","author_association":"MEMBER","body":"This should be updated, but dependabot's naive approach is inadequate, since more needs to be done to resolve this than simply updating the dependency version.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798530244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798530284","html_url":"https://github.com/apache/accumulo/pull/1969#issuecomment-798530284","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1969","id":798530284,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODUzMDI4NA==","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T15:42:17Z","updated_at":"2021-03-13T15:42:17Z","author_association":"CONTRIBUTOR","body":"OK, I won't notify you again about this release, but will get in touch when a new version is available. If you'd rather skip all updates until the next major or minor version, let me know by commenting `@dependabot ignore this major version` or `@dependabot ignore this minor version`.\n\nIf you change your mind, just re-open this PR and I'll resolve any conflicts on it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798530284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798546622","html_url":"https://github.com/apache/accumulo/issues/1949#issuecomment-798546622","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1949","id":798546622,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODU0NjYyMg==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T15:55:33Z","updated_at":"2021-03-13T15:55:33Z","author_association":"MEMBER","body":"@harjitdotsingh I've assigned it to you, based on your interest. The ScriptCommand is the relevant java class. For reference, the DebugCommand is one that is already deprecated, as is the DeleteScanIterCommand. The former models deprecating the class with an annotation and the description for the help documentation in the shell, while the latter models printing a warning message when it is used (I'm not sure why the latter doesn't also deprecate the class itself; it probably should be annotated as deprecated also, but that's a separate issue). Deprecating this command should involve performing both steps... annotation/description update and a warning when used. A separate PR should be made against the draft release notes in the website repository at https://github.com/apache/accumulo-website/blob/main/_posts/release/2020-01-19-accumulo-2.1.0.md for updating the release notes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798546622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798563527","html_url":"https://github.com/apache/accumulo/pull/1964#issuecomment-798563527","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1964","id":798563527,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODU2MzUyNw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-13T16:07:41Z","updated_at":"2021-03-13T16:07:41Z","author_association":"MEMBER","body":"I don't have enough knowledge of the bulk import code to understand exactly what this accomplishes, but it seems to me that this is a slight implementation change intended to leave files around to help troubleshoot, and does not have any associated API changes. Is that correct?\r\n\r\nAlthough we're only doing bugfixes on 1.10, I don't necessarily have a problem including a change that helps troubleshooting for further bugfixes, if the change is small and low-risk. However, I did have a few questions about these proposed changes:\r\n1. Does this risk leaving extra files scattered around the filesystem that aren't cleaned up or is this placed in a directory that is already subject to cleanup?\r\n2. Why not use one of the JSON libraries (like Gson) on our class path instead of manually constructing a JSON blob? Is there a performance concern?\r\n3. Does the new behavior of adding a new file risk breaking existing user code around bulk import?\r\n4. How does this change impact the new bulk import code paths and behavior, if it does at all?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798563527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798843022","html_url":"https://github.com/apache/accumulo/pull/1970#issuecomment-798843022","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1970","id":798843022,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODg0MzAyMg==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T06:30:31Z","updated_at":"2021-03-14T06:30:31Z","author_association":"MEMBER","body":"@harjitdotsingh Thank you for your contribution. I left a comment and suggestion in my code review. I also took the liberty of changing the title and description in this PR, so it stands on its own, and describes what changes are included in this PR. When this is ready to be merged, we will edit the commit message to ensure it is presented similarly to how I've changed it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798843022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798911125","html_url":"https://github.com/apache/accumulo/pull/1970#issuecomment-798911125","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1970","id":798911125,"node_id":"MDEyOklzc3VlQ29tbWVudDc5ODkxMTEyNQ==","user":{"login":"harjitdotsingh","id":75006,"node_id":"MDQ6VXNlcjc1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/75006?v=4","gravatar_id":"","url":"https://api.github.com/users/harjitdotsingh","html_url":"https://github.com/harjitdotsingh","followers_url":"https://api.github.com/users/harjitdotsingh/followers","following_url":"https://api.github.com/users/harjitdotsingh/following{/other_user}","gists_url":"https://api.github.com/users/harjitdotsingh/gists{/gist_id}","starred_url":"https://api.github.com/users/harjitdotsingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harjitdotsingh/subscriptions","organizations_url":"https://api.github.com/users/harjitdotsingh/orgs","repos_url":"https://api.github.com/users/harjitdotsingh/repos","events_url":"https://api.github.com/users/harjitdotsingh/events{/privacy}","received_events_url":"https://api.github.com/users/harjitdotsingh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-14T13:48:42Z","updated_at":"2021-03-14T13:48:42Z","author_association":"CONTRIBUTOR","body":"Thanks for all the comments. I will try to fix them tonight. IMHO all these strings should be part of a property file so that we can change them easily rather than embedding them in code. Also is there an IRC/Gitter channel?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/798911125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799048940","html_url":"https://github.com/apache/accumulo/pull/1970#issuecomment-799048940","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1970","id":799048940,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTA0ODk0MA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T02:32:34Z","updated_at":"2021-03-15T02:32:34Z","author_association":"MEMBER","body":"> IMHO all these strings should be part of a property file so that we can change them easily rather than embedding them in code.\r\n\r\nThese ones are part of code, so that way the documentation and code are adjacent, and each command is modular and stands on its own. If we were to change that it would be a big undertaking, and its own separate task. I'm not sure it's worth it, though.\r\n\r\n> Also is there an IRC/Gitter channel?\r\n\r\nWe used to have an IRC channel, but it didn't get used much. The main mode of communication, like all Apache projects is our developer mailing list, but we also now have a Slack channel. See [our contact page](https://accumulo.apache.org/contact-us/) for details.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799048940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799325045","html_url":"https://github.com/apache/accumulo/pull/1958#issuecomment-799325045","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1958","id":799325045,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTMyNTA0NQ==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T10:58:50Z","updated_at":"2021-03-15T10:58:50Z","author_association":"CONTRIBUTOR","body":"@ctubbsii @EdColeman Thoughts on my most recent changes? This should be ready for review again. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799325045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799409657","html_url":"https://github.com/apache/accumulo/pull/1958#issuecomment-799409657","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1958","id":799409657,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTQwOTY1Nw==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T13:14:37Z","updated_at":"2021-03-15T13:14:37Z","author_association":"CONTRIBUTOR","body":"If there are ZooLock and ZooQueueLock type ephemeral nodes at the same path, ZooLock and ZooQueueLock will still emit warnings, right? I wonder if in that case we should log at debug or trace that we are ignoring the nodes that do not match the pattern as it's the case that paths are being used concurrently for different purposes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799409657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799418416","html_url":"https://github.com/apache/accumulo/pull/1958#issuecomment-799418416","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1958","id":799418416,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTQxODQxNg==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T13:27:24Z","updated_at":"2021-03-15T13:27:24Z","author_association":"CONTRIBUTOR","body":"Do you know of a case for when that would occur? I am trying to think of a way to test it but I am not sure. From what I can tell, there are only a few areas of the code where we use `ZooQueueLock` (things like CreateTable use it) while `ZooLock` is used the majority of the time. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799418416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799420114","html_url":"https://github.com/apache/accumulo/pull/1958#issuecomment-799420114","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1958","id":799420114,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTQyMDExNA==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T13:29:50Z","updated_at":"2021-03-15T13:29:50Z","author_association":"CONTRIBUTOR","body":"Wasn't that the issue in https://github.com/apache/accumulo/issues/1935 ?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799420114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799422707","html_url":"https://github.com/apache/accumulo/pull/1958#issuecomment-799422707","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1958","id":799422707,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTQyMjcwNw==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T13:33:11Z","updated_at":"2021-03-15T13:34:44Z","author_association":"CONTRIBUTOR","body":"Most of the issue was using the wrong verification function inside `AdminUtil`. It called the ZooLock one whereas it only dealt with Fate locks which use `ZooQueueLock`. \r\n\r\nI need to edit the title because this PR is now just adding a validation and sort function inside `ZooQueueLock` to verify FateLocks. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799422707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799425295","html_url":"https://github.com/apache/accumulo/pull/1958#issuecomment-799425295","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1958","id":799425295,"node_id":"MDEyOklzc3VlQ29tbWVudDc5OTQyNTI5NQ==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-15T13:36:46Z","updated_at":"2021-03-15T13:36:46Z","author_association":"CONTRIBUTOR","body":"Ok, I see, I retract my statement then.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/799425295/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800373709","html_url":"https://github.com/apache/accumulo/issues/947#issuecomment-800373709","issue_url":"https://api.github.com/repos/apache/accumulo/issues/947","id":800373709,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDM3MzcwOQ==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T15:41:04Z","updated_at":"2021-03-16T15:41:04Z","author_association":"MEMBER","body":"I would like to be assigned to this ticket please.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800373709/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800377083","html_url":"https://github.com/apache/accumulo/issues/947#issuecomment-800377083","issue_url":"https://api.github.com/repos/apache/accumulo/issues/947","id":800377083,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDM3NzA4Mw==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T15:45:16Z","updated_at":"2021-03-16T15:45:16Z","author_association":"CONTRIBUTOR","body":"If these changes involve reading properties from zookeeper - could you hold off - the storage of those is close to being changed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800377083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800378982","html_url":"https://github.com/apache/accumulo/issues/947#issuecomment-800378982","issue_url":"https://api.github.com/repos/apache/accumulo/issues/947","id":800378982,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDM3ODk4Mg==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T15:47:45Z","updated_at":"2021-03-16T15:47:45Z","author_association":"MEMBER","body":"> If these changes involve reading properties from zookeeper - could you hold off - the storage of those is close to being changed.\r\n\r\nYes, will do.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800378982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800410586","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-800410586","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":800410586,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDQxMDU4Ng==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T16:27:24Z","updated_at":"2021-03-16T16:27:24Z","author_association":"CONTRIBUTOR","body":"The extra commits are from merging these changes from an alternate branch I had. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800410586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800471221","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-800471221","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":800471221,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDQ3MTIyMQ==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T17:40:50Z","updated_at":"2021-03-16T17:40:50Z","author_association":"CONTRIBUTOR","body":"Thanks for taking the time to review it! ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800471221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800598544","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-800598544","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":800598544,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDU5ODU0NA==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T20:55:39Z","updated_at":"2021-03-16T20:55:39Z","author_association":"CONTRIBUTOR","body":"I have no remaining issues once Christopher's suggestions are resolved.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800598544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800602630","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-800602630","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":800602630,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDYwMjYzMA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T21:02:39Z","updated_at":"2021-03-16T21:02:39Z","author_association":"MEMBER","body":"I do have some follow-up suggestions I was working on that I thought would make sense as part of this PR. @Manno15 any problem if I push them directly to your branch for inclusion? We can revert if there's any objection.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800602630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800604479","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-800604479","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":800604479,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDYwNDQ3OQ==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T21:05:57Z","updated_at":"2021-03-16T21:05:57Z","author_association":"CONTRIBUTOR","body":"@ctubbsii Go ahead. I will review them in the morning.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800604479/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800640887","html_url":"https://github.com/apache/accumulo/issues/1134#issuecomment-800640887","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1134","id":800640887,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDY0MDg4Nw==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-16T21:59:51Z","updated_at":"2021-03-16T21:59:51Z","author_association":"CONTRIBUTOR","body":"@DomGarguilo - are you interested in having this assigned to you for an initial look?  \r\n\r\nmicrometer.io seems really promising - but the first steps would be to become familiar with the current metrics and  the requirements of metrics systems in general.  The Prometheus docs provide a view of the collection / display side of things as well as guidance on naming to prevent issues with high-cardinality and how it impacts time series collection systems.  \r\n\r\nmicrometer.io handles a lot of the naming and unit issues and can convert between different collection system styles (for example jmx and Prometheus styles), so the Prometheus docs really just provide a viewpoint - but keep in mind that Prometheus is a common collector / display system (along with jmx and statsD as other common systems)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800640887/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800733715","html_url":"https://github.com/apache/accumulo/issues/1949#issuecomment-800733715","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1949","id":800733715,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDczMzcxNQ==","user":{"login":"harjitdotsingh","id":75006,"node_id":"MDQ6VXNlcjc1MDA2","avatar_url":"https://avatars.githubusercontent.com/u/75006?v=4","gravatar_id":"","url":"https://api.github.com/users/harjitdotsingh","html_url":"https://github.com/harjitdotsingh","followers_url":"https://api.github.com/users/harjitdotsingh/followers","following_url":"https://api.github.com/users/harjitdotsingh/following{/other_user}","gists_url":"https://api.github.com/users/harjitdotsingh/gists{/gist_id}","starred_url":"https://api.github.com/users/harjitdotsingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/harjitdotsingh/subscriptions","organizations_url":"https://api.github.com/users/harjitdotsingh/orgs","repos_url":"https://api.github.com/users/harjitdotsingh/repos","events_url":"https://api.github.com/users/harjitdotsingh/events{/privacy}","received_events_url":"https://api.github.com/users/harjitdotsingh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-17T01:56:40Z","updated_at":"2021-03-17T01:56:40Z","author_association":"CONTRIBUTOR","body":"@ctubbsii - I have updated the files. Let me know if there is anything else that needs attention on this PR. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800733715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800990172","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-800990172","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":800990172,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMDk5MDE3Mg==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-17T10:59:26Z","updated_at":"2021-03-17T10:59:26Z","author_association":"CONTRIBUTOR","body":"I like your additions. Some comments below, in order of the commit points. \r\n\r\n- The renaming was going to happen in #1967 which is why I didn't do it here. \r\n- I did have something akin to this in my original commit but wasn't quite sure if it was better or not. So I removed it in the next commit. I did it this way so I can drop the second one if I changed my mind about it. I  do personally like having the path function better though. \r\n- I am indifferent to the `var` and method name change. I agree the shorter name is probably better, especially with a comment on the method now to explain its intent.\r\n- Good change, I thought the fields were already final so that was my mistake.\r\n- Make sense if it wasn't used. Good change.\r\nEverything else looks good. \r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/800990172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801092416","html_url":"https://github.com/apache/accumulo/issues/1134#issuecomment-801092416","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1134","id":801092416,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMTA5MjQxNg==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-17T13:45:07Z","updated_at":"2021-03-17T13:45:07Z","author_association":"MEMBER","body":"> @DomGarguilo - are you interested in having this assigned to you for an initial look?\r\n\r\nSure","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801092416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801334257","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-801334257","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":801334257,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMTMzNDI1Nw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-17T19:00:57Z","updated_at":"2021-03-17T19:00:57Z","author_association":"MEMBER","body":"> I like your additions. Some comments below, in order of the commit points.\r\n> \r\n> * The renaming was going to happen in #1967 which is why I didn't do it here.\r\n\r\nThis PR can fix both #1966 and #1967. One PR to address two issues. I think `ServiceLock` is a good name for `ZooLock`, so if there aren't any objections to that name, I'll add that rename to this PR also, and then we can merge it and close both issues.\r\n\r\n> * Good change, I thought the fields were already final so that was my mistake.\r\n\r\nTo be clear, my additions weren't corrective in any way. I didn't see any mistakes. My additions were supplemental only, building on what you did. :smiley_cat:","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801334257/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801346842","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-801346842","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":801346842,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMTM0Njg0Mg==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-17T19:20:52Z","updated_at":"2021-03-17T19:20:52Z","author_association":"CONTRIBUTOR","body":"> This PR can fix both #1966 and #1967. One PR to address two issues. I think ServiceLock is a good name for ZooLock, so if there aren't any objections to that name, I'll add that rename to this PR also, and then we can merge it and close both issues.\r\n\r\nI am also okay with that name if no one else objects or has any other alternatives for the rename in #1967. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801346842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801422909","html_url":"https://github.com/apache/accumulo/issues/1949#issuecomment-801422909","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1949","id":801422909,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMTQyMjkwOQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-17T20:30:56Z","updated_at":"2021-03-17T20:30:56Z","author_association":"MEMBER","body":"@harjitdotsingh Thanks! I will try to take a look tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801422909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801795376","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-801795376","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":801795376,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMTc5NTM3Ng==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T10:09:55Z","updated_at":"2021-03-18T10:09:55Z","author_association":"CONTRIBUTOR","body":"@ctubbsii Everything looks good to me. Is there anything else that you think needs to be added? If not, I can merge this in. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801795376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801959825","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-801959825","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":801959825,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMTk1OTgyNQ==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T14:10:11Z","updated_at":"2021-03-18T14:10:11Z","author_association":"CONTRIBUTOR","body":"I also ran the IT suite and everything passes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/801959825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802052724","html_url":"https://github.com/apache/accumulo/pull/1972#issuecomment-802052724","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1972","id":802052724,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjA1MjcyNA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T16:07:51Z","updated_at":"2021-03-18T16:07:51Z","author_association":"MEMBER","body":"@Manno15 I merged it. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802052724/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802116880","html_url":"https://github.com/apache/accumulo/issues/1134#issuecomment-802116880","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1134","id":802116880,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjExNjg4MA==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T17:03:27Z","updated_at":"2021-03-18T17:03:27Z","author_association":"MEMBER","body":"@EdColeman - I'm starting to look into this and trying to get more familiar with everything. I was wondering if the main reason for the proposed switch away from hadoop metrics is the ability to allow plugable sources/sinks like you mentioned earlier or if there are other reasons as well.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802116880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802153648","html_url":"https://github.com/apache/accumulo/issues/1561#issuecomment-802153648","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1561","id":802153648,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjE1MzY0OA==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-18T17:39:29Z","updated_at":"2021-03-18T17:39:29Z","author_association":"MEMBER","body":"Not sure if I would call this a duplicate but it seems very similar to #1134. Might be able to merge the discussion of these two and remove one of them.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802153648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802817171","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-802817171","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":802817171,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjgxNzE3MQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T13:02:05Z","updated_at":"2021-03-19T13:02:05Z","author_association":"CONTRIBUTOR","body":"I think these changes are good to go for review. I think there is still more follow on work but they are in a good place and I don't want this PR getting any bigger. One improvement I want to do as a follow on is to cache the decrypters so we don't have to call init every time we read a file.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802817171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802952960","html_url":"https://github.com/apache/accumulo/issues/1134#issuecomment-802952960","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1134","id":802952960,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMjk1Mjk2MA==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T16:22:20Z","updated_at":"2021-03-19T16:22:20Z","author_association":"CONTRIBUTOR","body":"Plug-able source and sinks are a big advantage - but others include:\r\n- eliminate an unnecessary hadoop dependency in the Accumulo code base.\r\n- simplify metrics - the hadoop metrics can be cumbersome to configure and to use in the code - mircometer seems much more straight forward. The goal would be to reduce the complexity of adding metrics so that often requested metrics enhancements would be easier to make going forward.\r\n\r\n ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/802952960/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803058019","html_url":"https://github.com/apache/accumulo/issues/1561#issuecomment-803058019","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1561","id":803058019,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMzA1ODAxOQ==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T19:22:59Z","updated_at":"2021-03-19T19:22:59Z","author_association":"CONTRIBUTOR","body":"Good catch - I think 1134 was first written to see what was viable, and this one was created once micrometer seemed to meet our requirements - no preference to which one is used going forward.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803058019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803070387","html_url":"https://github.com/apache/accumulo/issues/1561#issuecomment-803070387","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1561","id":803070387,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMzA3MDM4Nw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T19:40:27Z","updated_at":"2021-03-19T19:40:27Z","author_association":"MEMBER","body":"I'll close this one as a duplicate of #1134 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803070387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803097488","html_url":"https://github.com/apache/accumulo/issues/1973#issuecomment-803097488","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1973","id":803097488,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMzA5NzQ4OA==","user":{"login":"keith-ratcliffe","id":1606834,"node_id":"MDQ6VXNlcjE2MDY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1606834?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-ratcliffe","html_url":"https://github.com/keith-ratcliffe","followers_url":"https://api.github.com/users/keith-ratcliffe/followers","following_url":"https://api.github.com/users/keith-ratcliffe/following{/other_user}","gists_url":"https://api.github.com/users/keith-ratcliffe/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-ratcliffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-ratcliffe/subscriptions","organizations_url":"https://api.github.com/users/keith-ratcliffe/orgs","repos_url":"https://api.github.com/users/keith-ratcliffe/repos","events_url":"https://api.github.com/users/keith-ratcliffe/events{/privacy}","received_events_url":"https://api.github.com/users/keith-ratcliffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T20:17:01Z","updated_at":"2021-03-19T20:17:01Z","author_association":"CONTRIBUTOR","body":"Update: Apparently I misstated our cache config changes above. Sorry about that\r\n(OHC wasn't involved, although we had been testing that recently)\r\n\r\nLRU cache had already been re-enabled, so the sequence of events was actually...\r\n\r\n1. We were testing with LRU cache manager configured, but with data and index cache both disabled\r\n2. Index cache was enabled via the shell followed by a few hours of testing. No errors observed during this time\r\n3. Data cache was then enabled via the shell, with several more hours of testing overnight. Errors became apparent the next day upon review and continued up until a restart of Accumulo was performed\r\n4. No additional errors have been observed since the restart\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803097488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803102844","html_url":"https://github.com/apache/accumulo/issues/1973#issuecomment-803102844","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1973","id":803102844,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMzEwMjg0NA==","user":{"login":"keith-ratcliffe","id":1606834,"node_id":"MDQ6VXNlcjE2MDY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1606834?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-ratcliffe","html_url":"https://github.com/keith-ratcliffe","followers_url":"https://api.github.com/users/keith-ratcliffe/followers","following_url":"https://api.github.com/users/keith-ratcliffe/following{/other_user}","gists_url":"https://api.github.com/users/keith-ratcliffe/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-ratcliffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-ratcliffe/subscriptions","organizations_url":"https://api.github.com/users/keith-ratcliffe/orgs","repos_url":"https://api.github.com/users/keith-ratcliffe/repos","events_url":"https://api.github.com/users/keith-ratcliffe/events{/privacy}","received_events_url":"https://api.github.com/users/keith-ratcliffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T20:24:39Z","updated_at":"2021-03-19T20:24:39Z","author_association":"CONTRIBUTOR","body":"We'll try to replicate this and collect more info as well","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803102844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803166065","html_url":"https://github.com/apache/accumulo/issues/1973#issuecomment-803166065","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1973","id":803166065,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMzE2NjA2NQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-19T22:17:52Z","updated_at":"2021-03-19T22:18:11Z","author_association":"MEMBER","body":"@keith-ratcliffe We could probably easily prevent the error if we disallowed cache manager reconfiguration without a restart of the process, like we do with some other properties. How detrimental would that naive solution be to your use case?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803166065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803206342","html_url":"https://github.com/apache/accumulo/issues/1973#issuecomment-803206342","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1973","id":803206342,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMzIwNjM0Mg==","user":{"login":"keith-ratcliffe","id":1606834,"node_id":"MDQ6VXNlcjE2MDY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1606834?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-ratcliffe","html_url":"https://github.com/keith-ratcliffe","followers_url":"https://api.github.com/users/keith-ratcliffe/followers","following_url":"https://api.github.com/users/keith-ratcliffe/following{/other_user}","gists_url":"https://api.github.com/users/keith-ratcliffe/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-ratcliffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-ratcliffe/subscriptions","organizations_url":"https://api.github.com/users/keith-ratcliffe/orgs","repos_url":"https://api.github.com/users/keith-ratcliffe/repos","events_url":"https://api.github.com/users/keith-ratcliffe/events{/privacy}","received_events_url":"https://api.github.com/users/keith-ratcliffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-20T00:28:05Z","updated_at":"2021-03-20T00:28:05Z","author_association":"CONTRIBUTOR","body":"> @keith-ratcliffe We could probably easily prevent the error if we disallowed cache manager reconfiguration without a restart of the process, like we do with some other properties. How detrimental would that naive solution be to your use case?\r\n\r\nMakes sense. Not detrimental at all, really. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803206342/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803317434","html_url":"https://github.com/apache/accumulo/pull/1703#issuecomment-803317434","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1703","id":803317434,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMzMxNzQzNA==","user":{"login":"jkosh44","id":10800303,"node_id":"MDQ6VXNlcjEwODAwMzAz","avatar_url":"https://avatars.githubusercontent.com/u/10800303?v=4","gravatar_id":"","url":"https://api.github.com/users/jkosh44","html_url":"https://github.com/jkosh44","followers_url":"https://api.github.com/users/jkosh44/followers","following_url":"https://api.github.com/users/jkosh44/following{/other_user}","gists_url":"https://api.github.com/users/jkosh44/gists{/gist_id}","starred_url":"https://api.github.com/users/jkosh44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkosh44/subscriptions","organizations_url":"https://api.github.com/users/jkosh44/orgs","repos_url":"https://api.github.com/users/jkosh44/repos","events_url":"https://api.github.com/users/jkosh44/events{/privacy}","received_events_url":"https://api.github.com/users/jkosh44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-20T13:16:44Z","updated_at":"2021-03-20T13:16:44Z","author_association":"CONTRIBUTOR","body":"@ctubbsii so sorry that I never responded to the comments, my github notifications have been messed up and I never saw these. For what it's worth the changes look fine to me.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/803317434/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/804377834","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-804377834","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":804377834,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNDM3NzgzNA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-22T20:38:21Z","updated_at":"2021-03-22T20:38:21Z","author_association":"CONTRIBUTOR","body":"@ctubbsii let me know what you think of the changes in 82dd8a5 before I take the time to change the names in the tests.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/804377834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805166757","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-805166757","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":805166757,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNTE2Njc1Nw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-23T19:18:46Z","updated_at":"2021-03-23T19:18:46Z","author_association":"CONTRIBUTOR","body":"> @ctubbsii let me know what you think of the changes in [82dd8a5](https://github.com/apache/accumulo/commit/82dd8a546cc2fcf53ac0b4910299925ed99bf693) before I take the time to change the names in the tests.\r\n\r\nI settled on `AESCryptoService` with inner classes of `Table` and `WAL`. So to configure encryption a user needs these properties:\r\n<pre>\r\ntserver.walog.crypto.encrypt.service=org.apache.accumulo.core.spi.crypto.AESCryptoService$WAL\r\ntserver.walog.crypto.decrypt.service=org.apache.accumulo.core.spi.crypto.AESCryptoService$WAL\r\ntserver.walog.crypto.opts.key.uri=/home/mike/workspace/uno/CryptoTest-testkeyfile\r\ntable.crypto.encrypt.service=org.apache.accumulo.core.spi.crypto.AESCryptoService$Table\r\ntable.crypto.decrypt.services=org.apache.accumulo.core.spi.crypto.AESCryptoService$Table\r\ntable.crypto.opts.key.uri=/home/mike/workspace/uno/CryptoTest-testkeyfile\r\n</pre>","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805166757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805262080","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-805262080","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":805262080,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNTI2MjA4MA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-23T21:08:45Z","updated_at":"2021-03-23T21:09:47Z","author_association":"MEMBER","body":"> > @ctubbsii let me know what you think of the changes in [82dd8a5]\r\n\r\nI still prefer the idea of keeping the crypto stuff contained in a single module. Something like:\r\n\r\n```properties\r\ninstance.crypto.service=com.example.crypto.service.ExampleCryptoService\r\ninstance.crypto.opts.wal.SOMEKEY=SOMEVALUE\r\ninstance.crypto.opts.table.t1.SOMEKEY=SOMEVALUE\r\ninstance.crypto.opts.table.t2.SOMEKEY=SOMEVALUE\r\n```\r\n\r\nor (depending on implementation):\r\n\r\n```properties\r\ninstance.crypto.service=com.example.crypto.service.ExampleCryptoService\r\ninstance.crypto.opts.wal.SOMEKEY=SOMEVALUE\r\n; a per-table setting that works because the crypto service is a factory for encryptor/decryptor\r\n; that is capable of making decisions based on per-table config\r\ntable.crypto.opts.SOMETABLEOPT=SOMEVALUE\r\n```\r\n\r\nWith both of these, the main point is that there is only ever a single crypto service for the system. However, the functionality of that service is capable of providing crypto services for multiple tables and/or the WAL. Your change just relocates the implementation into inner classes, but they are still effectively separate classes that are configured separately, meaning separate authorities for managing the file-based crypto.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805262080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805783808","html_url":"https://github.com/apache/accumulo/pull/1964#issuecomment-805783808","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1964","id":805783808,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNTc4MzgwOA==","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T12:33:43Z","updated_at":"2021-03-24T12:33:43Z","author_association":"CONTRIBUTOR","body":"This is not any kind of api change but merely a mechanism by which the client can track where the bulk imported file went.  On some or our systems I installed a mechanism to track this information via the logs, so this is not really needed anymore.  I am closing this pull request.  The original ticket however still stands in which it would be good to facilitate a mechanism to track files through the system from bulk import through compactions and garbage collection.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805783808/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805785093","html_url":"https://github.com/apache/accumulo/issues/1963#issuecomment-805785093","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1963","id":805785093,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNTc4NTA5Mw==","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T12:35:57Z","updated_at":"2021-03-24T12:35:57Z","author_association":"CONTRIBUTOR","body":"I would like this ticket to stand as something to consider which is to create a mechanism akin to trace which allows us to track a file through the system; from bulk import through compaction through garbage collection.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805785093/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805799474","html_url":"https://github.com/apache/accumulo/pull/1964#issuecomment-805799474","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1964","id":805799474,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNTc5OTQ3NA==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T12:59:46Z","updated_at":"2021-03-24T12:59:46Z","author_association":"CONTRIBUTOR","body":"Was the necessary info in the log files already, or did you add additional logging?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805799474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805867495","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-805867495","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":805867495,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNTg2NzQ5NQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T14:27:58Z","updated_at":"2021-03-24T14:27:58Z","author_association":"CONTRIBUTOR","body":"> instance.crypto.opts.table.t1.SOMEKEY=SOMEVALUE\r\n\r\nI don't think this will work with the way Accumulo handles table properties differently. Also aren't `instance` properties used to determine the hash for a cluster? It would also be confusing because it breaks the delineations set by the prefix properties.\r\n\r\n> With both of these, the main point is that there is only ever a single crypto service for the system. However, the functionality of that service is capable of providing crypto services for multiple tables and/or the WAL. Your change just relocates the implementation into inner classes, but they are still effectively separate classes that are configured separately, meaning separate authorities for managing the file-based crypto.\r\n\r\nYes but the crypto implementation for Table class won't work with WALs, due to the type of encryption. I was trying to keep them separate enough to make this clear that not all types of crypto will work with WALs vs Tables but keep them together enough to implement the same interfaces.\r\n\r\nI believe what you want is what we have now, passing in the environment to the impl and letting it decided Table vs WAL. The problem is Accumulo needs to know whether the CryptoService is being used per table or tserver (WAL). Otherwise it gets very confusing looking at the code and trying to decipher the purpose of the CryptoService. Some of this can be derived from the code, for example within RFile or BCFile is obvious. But other parts are not, like the Tserver or FileUtilties. We can make sure to name variables based on use but the CryptoServiceFactory is a static utility.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/805867495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/806080969","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-806080969","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":806080969,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNjA4MDk2OQ==","user":{"login":"PircDef","id":31989480,"node_id":"MDQ6VXNlcjMxOTg5NDgw","avatar_url":"https://avatars.githubusercontent.com/u/31989480?v=4","gravatar_id":"","url":"https://api.github.com/users/PircDef","html_url":"https://github.com/PircDef","followers_url":"https://api.github.com/users/PircDef/followers","following_url":"https://api.github.com/users/PircDef/following{/other_user}","gists_url":"https://api.github.com/users/PircDef/gists{/gist_id}","starred_url":"https://api.github.com/users/PircDef/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PircDef/subscriptions","organizations_url":"https://api.github.com/users/PircDef/orgs","repos_url":"https://api.github.com/users/PircDef/repos","events_url":"https://api.github.com/users/PircDef/events{/privacy}","received_events_url":"https://api.github.com/users/PircDef/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-24T19:04:57Z","updated_at":"2021-03-24T19:04:57Z","author_association":"MEMBER","body":"> With both of these, the main point is that there is only ever a single crypto service for the system. However, the functionality of that service is capable of providing crypto services for multiple tables and/or the WAL. Your change just relocates the implementation into inner classes, but they are still effectively separate classes that are configured separately, meaning separate authorities for managing the file-based crypto.\r\n\r\nOne of the goals for the crypto service in 2.0 was to make it more modular. Admins should be able to replace crypto services as necessary. Any new service needs to be capable of decrypting existing data. This means it needs to be able to decrypt any data encrypted by all prior services. As it stands now, all decrypters from all prior services would need to be part of the current crypto service. These changes remedy that by allowing prior crypto services to continue to provide their own decrypters. \r\n\r\nThere is a case to be made for table specific crypto services. Allowing for table-level configuration enables data owners to control the crypto for their data in their table. Consider a case where someone wants to bulk import existing RFiles into a new table in another Accumulo instance. Lets assume they use a custom crypto service. With table-level crypto services, they would need to provide their RFiles and crypto service in order to read the data without requiring any changes to existing crypto services.\r\n\r\nI think it is a good idea to explicitly specify the default crypto service used by Accumulo if a table is not specifically configured. This could allow for a single authority when appropriate. Would another option such as:\r\n\r\n    instance.allow.table.crypto=false\r\n\r\nbe a reasonable compromise? This would allow admins to explicitly enable or disable table-level crypto services. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/806080969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807143548","html_url":"https://github.com/apache/accumulo/issues/1975#issuecomment-807143548","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1975","id":807143548,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzE0MzU0OA==","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T17:28:33Z","updated_at":"2021-03-25T17:28:33Z","author_association":"CONTRIBUTOR","body":"I would guess that you are observing a livelock due to recursive `computeIfAbsent` calls being unsupported by `ConcurrentHashMap`. You can verify this using jstack.\r\n\r\nThe TinyLFU cache uses this method for the loader calls,\r\n\r\nhttps://github.com/apache/accumulo/blob/1dc72fce2c781dee597c8c11876a3bc6c321c199/core/src/main/java/org/apache/accumulo/core/file/blockfile/cache/tinylfu/TinyLfuBlockCache.java#L251-L254\r\n\r\nIn comparison, the Lru cache does this using the racy get-load-put idiom,\r\n\r\nhttps://github.com/apache/accumulo/blob/1dc72fce2c781dee597c8c11876a3bc6c321c199/core/src/main/java/org/apache/accumulo/core/file/blockfile/cache/lru/SynchronousLoadingBlockCache.java#L73-L83\r\n\r\nThe benefit of `computeIfAbsent` is that it protects against [cache stampedes](https://medium.com/@DoorDash/avoiding-cache-stampede-at-doordash-55bbf596d94b). If this can be recursive, then it should be updated to the racy style like the Lru cache.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807143548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807283723","html_url":"https://github.com/apache/accumulo/issues/1975#issuecomment-807283723","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1975","id":807283723,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzI4MzcyMw==","user":{"login":"keith-ratcliffe","id":1606834,"node_id":"MDQ6VXNlcjE2MDY4MzQ=","avatar_url":"https://avatars.githubusercontent.com/u/1606834?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-ratcliffe","html_url":"https://github.com/keith-ratcliffe","followers_url":"https://api.github.com/users/keith-ratcliffe/followers","following_url":"https://api.github.com/users/keith-ratcliffe/following{/other_user}","gists_url":"https://api.github.com/users/keith-ratcliffe/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-ratcliffe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-ratcliffe/subscriptions","organizations_url":"https://api.github.com/users/keith-ratcliffe/orgs","repos_url":"https://api.github.com/users/keith-ratcliffe/repos","events_url":"https://api.github.com/users/keith-ratcliffe/events{/privacy}","received_events_url":"https://api.github.com/users/keith-ratcliffe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T18:55:55Z","updated_at":"2021-03-25T18:55:55Z","author_association":"CONTRIBUTOR","body":"@ben-manes Thanks. I believe you are correct. Here's a jstack exerpt showing a deadlock that we experienced...\r\n```\r\nat java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)\r\n        at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:175)\r\n\"User: **** Start: 1612279224878 Client: xxx.xxx.xxx.xxx:41554 Tablet: f;20190610_21;20190610_20\":\r\n        at sun.misc.Unsafe.park(Native Method)\r\n        - parking to wait for  <0x000000052ae8b878> (a java.util.concurrent.locks.ReentrantLock$NonfairSync)\r\n        at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:870)\r\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1199)\r\n        at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(ReentrantLock.java:209)\r\n        at java.util.concurrent.locks.ReentrantLock.lock(ReentrantLock.java:285)\r\n        at com.github.benmanes.caffeine.cache.BoundedLocalCache$BoundedPolicy$BoundedEviction.getMaximum(BoundedLocalCache.java:3454)\r\n        at org.apache.accumulo.core.file.blockfile.cache.tinylfu.TinyLfuBlockCache.load(TinyLfuBlockCache.java:204)\r\n        at org.apache.accumulo.core.file.blockfile.cache.tinylfu.TinyLfuBlockCache.lambda$getBlock$2(TinyLfuBlockCache.java:238)\r\n        at org.apache.accumulo.core.file.blockfile.cache.tinylfu.TinyLfuBlockCache$$Lambda$129/316262722.apply(Unknown Source)\r\n        at com.github.benmanes.caffeine.cache.LocalCache.lambda$statsAware$0(LocalCache.java:142)\r\n        at com.github.benmanes.caffeine.cache.LocalCache$$Lambda$130/304458428.apply(Unknown Source)\r\n        at com.github.benmanes.caffeine.cache.BoundedLocalCache.lambda$doComputeIfAbsent$14(BoundedLocalCache.java:2337)\r\n        at com.github.benmanes.caffeine.cache.BoundedLocalCache$$Lambda$131/899711363.apply(Unknown Source)\r\n        at java.util.concurrent.ConcurrentHashMap.compute(ConcurrentHashMap.java:1892)\r\n        - locked <0x0000000685ba4df0> (a java.util.concurrent.ConcurrentHashMap$Node)\r\n        at com.github.benmanes.caffeine.cache.BoundedLocalCache.doComputeIfAbsent(BoundedLocalCache.java:2335)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807283723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807707806","html_url":"https://github.com/apache/accumulo/issues/1963#issuecomment-807707806","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1963","id":807707806,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzcwNzgwNg==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T23:19:06Z","updated_at":"2021-03-25T23:19:06Z","author_association":"MEMBER","body":"#1480 added a TabletLogger class to centralize management of logging events for tablet activity. A similar logger utility class could be used for centralized tracking of log messages pertaining to file activity.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807707806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807745614","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-807745614","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":807745614,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzc0NTYxNA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T23:43:54Z","updated_at":"2021-03-25T23:43:54Z","author_association":"MEMBER","body":"> > instance.crypto.opts.table.t1.SOMEKEY=SOMEVALUE\r\n> \r\n> I don't think this will work with the way Accumulo handles table properties differently. Also aren't `instance` properties used to determine the hash for a cluster? It would also be confusing because it breaks the delineations set by the prefix properties.\r\n\r\n`general.*` would also work (and could be changed at runtime, unlike `instance.*`). The main point here is that these aren't characteristics of the table, but rather, characteristics of the crypto service module that inform it of how to behave in specific contexts.\r\n\r\n> > With both of these, the main point is that there is only ever a single crypto service for the system. However, the functionality of that service is capable of providing crypto services for multiple tables and/or the WAL. Your change just relocates the implementation into inner classes, but they are still effectively separate classes that are configured separately, meaning separate authorities for managing the file-based crypto.\r\n> \r\n> Yes but the crypto implementation for Table class won't work with WALs, due to the type of encryption.\r\n\r\nRight, that's why the config is associated with the crypto service module, as opts, rather than tied to a table's characteristics. What opts work for which contexts, depends largely on the crypto service module's capabilities and is not solely an inherent characteristics of Accumulo objects (tables, WALs, etc.). Offloading this responsibility to the module\r\n\r\n> I was trying to keep them separate enough to make this clear that not all types of crypto will work with WALs vs Tables but keep them together enough to implement the same interfaces.\r\n\r\nThat makes sense, but I don't think we need to have separate services conforming to the same interface for these. We can have a single service interface that provides services for both streaming encrypters/decrypters suitable for WAL, and for block encrypters/decrypters suitable for RFiles. If we really wanted to have them conform to the same interface, maybe that's okay, but instead of merely being colocated and configured separately, they could dangle off a single crypto service interface as sub-services, so you only have to configure the main crypto service module, and that acts as a factory for the sub-services that dangle from it.\r\n\r\n> I believe what you want is what we have now, passing in the environment to the impl and letting it decided Table vs WAL.\r\n\r\nI do lean towards the design principles that were put into the earlier effort, yes.\r\n\r\n> The problem is Accumulo needs to know whether the CryptoService is being used per table or tserver (WAL). Otherwise it gets very confusing looking at the code and trying to decipher the purpose of the CryptoService. Some of this can be derived from the code, for example within RFile or BCFile is obvious. But other parts are not, like the Tserver or FileUtilties. We can make sure to name variables based on use but the CryptoServiceFactory is a static utility.\r\n\r\nI think we can adapt the existing design by incorporating additional context information into the API, so the crypto service module can make decisions about the encrypters/decrypters to provide, based on the context it is given.\r\n\r\nIn general, what I'm arguing for is an API design that looks like:\r\n\r\n```java\r\npublic interface SomeService {\r\n  public SomeObject getSomeObject(Context ctx);\r\n}\r\n```\r\n\r\nrather than one that looks like:\r\n\r\n```java\r\npublic interface SomeService {\r\n  public SomeObject getSomeObject();\r\n}\r\n\r\npublic class SomeServiceForContext1 extend SomeService {\r\n  public SomeObject getSomeObject() {};\r\n}\r\n\r\npublic interface SomeServiceForContext2 extend SomeService {\r\n  public SomeObject getSomeObject() {};\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807745614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807755673","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-807755673","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":807755673,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzc1NTY3Mw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-25T23:50:00Z","updated_at":"2021-03-25T23:50:00Z","author_association":"MEMBER","body":"> > With both of these, the main point is that there is only ever a single crypto service for the system. However, the functionality of that service is capable of providing crypto services for multiple tables and/or the WAL. Your change just relocates the implementation into inner classes, but they are still effectively separate classes that are configured separately, meaning separate authorities for managing the file-based crypto.\r\n> \r\n> One of the goals for the crypto service in 2.0 was to make it more modular. Admins should be able to replace crypto services as necessary. Any new service needs to be capable of decrypting existing data. This means it needs to be able to decrypt any data encrypted by all prior services. As it stands now, all decrypters from all prior services would need to be part of the current crypto service. These changes remedy that by allowing prior crypto services to continue to provide their own decrypters.\r\n\r\nA centralized crypto service module is not necessarily monolithic. It can be composed of modular components. But that granularity, if required, is now seen in the construction and configuration of a single drop-in service, rather than exposed as a multitude of configuration options in Accumulo itself. Essentially, I'm arguing for hierarchical modularity, rather than a flat modularity model.\r\n\r\n> There is a case to be made for table specific crypto services.\r\n\r\nI agree. I'm not arguing against per-table crypto. Just arguing for a slightly different interface and configuration for it, so it's easier to offload the maintenance and configuration outside of Accumulo's core responsibilities (hierarchical modularity).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807755673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807846622","html_url":"https://github.com/apache/accumulo/issues/1975#issuecomment-807846622","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1975","id":807846622,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNzg0NjYyMg==","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T00:54:12Z","updated_at":"2021-03-26T00:54:12Z","author_association":"CONTRIBUTOR","body":"This might be slightly different, but similar.\r\n\r\nhttps://github.com/apache/accumulo/blob/1dc72fce2c781dee597c8c11876a3bc6c321c199/core/src/main/java/org/apache/accumulo/core/file/blockfile/cache/tinylfu/TinyLfuBlockCache.java#L202-L209\r\n\r\nThis calls `policy.getMaximum()` which currently reads under the eviction policy's lock as it is a non-volatile field. That called under the a `ConcurrentHashMap#compute` method, which takes a lock on the hashbin. If another thread is evicting, it would hold the policy lock and a hash collision might require the same hashbin lock for the entry's removal. This would cause the deadlock you are seeing.\r\n\r\nOne solution is to store the maxSize as a local variable, since it is never changed. I suppose the policy's accessor was used for convenience.\r\n\r\nAnother option is if Caffeine made this field a volatile so it could be read lock-free. That wasn't done since its otherwise used under the lock (being set, eviction) and policy methods are not expected to be called frequently. There are other methods on policy that need the lock, so we could only solves a few simple cases.\r\n\r\nIn this case, I think stashing the maximum size as a final field would be simplest and not require a dependency to be released.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/807846622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808233403","html_url":"https://github.com/apache/accumulo/issues/1976#issuecomment-808233403","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1976","id":808233403,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODIzMzQwMw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T13:47:43Z","updated_at":"2021-03-26T13:47:43Z","author_association":"MEMBER","body":"Could try to add a debug statement in `ClassLoaderUtil.getClassLoader(context)` to verify the shell is correctly obtaining the context from the table config and it is reaching this code with the correct context, and to check the returned ClassLoader class `name()`.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808233403/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808237782","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-808237782","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":808237782,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODIzNzc4Mg==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T13:53:49Z","updated_at":"2021-03-26T13:53:49Z","author_association":"CONTRIBUTOR","body":"> general.* would also work (and could be changed at runtime, unlike instance.*). The main point here is that these aren't characteristics of the table, but rather, characteristics of the crypto service module that inform it of how to behave in specific contexts.\r\n\r\nUsing the general prefix might work. I think being able to change the configuration at runtime is important when dealing with per-table changes. \r\n\r\nBut I think by not including encryption as a table characteristic we are pushing more complexity to the user and creating more complexity in the code. Instead of the user configuring the service like they would other table specific classes (balancer, scan dispatcher) they have to know specialized options within the service (they will have to know some, key location etc). Then Accumulo has to deal with special circumstances of having general properties that operate on a per-table basis. How will table operations like clone or export table know how to include encryption as part of the operation? As a user, I would expect a cloned table to also be encrypted. It seems you are creating a lot of complexity just to save a few properties.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808237782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808252030","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-808252030","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":808252030,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODI1MjAzMA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T14:12:41Z","updated_at":"2021-03-26T14:13:37Z","author_association":"MEMBER","body":"> But I think by not including encryption as a table characteristic we are pushing more complexity to the user and creating more complexity in the code. Instead of the user configuring the service like they would other table specific classes (balancer, scan dispatcher) they have to know specialized options within the service (they will have to know some, key location etc). Then Accumulo has to deal with special circumstances of having general properties that operate on a per-table basis. How will table operations like clone or export table know how to include encryption as part of the operation? As a user, I would expect a cloned table to also be encrypted. It seems you are creating a lot of complexity just to save a few properties.\r\n\r\nI think you're right that it makes sense to have some of this as table characteristics. I wasn't arguing against that part of the config. But your point is well-taken, and definitely leads itself to using the `table.crypto.opts.SOMETABLEOPT=SOMEVALUE` suggestion I mentioned above so that the per-table characteristics are stored with the table, rather than in the instance/general configuration opts (except for the WAL-related opts, which are necessarily in instance or general opts).\r\n\r\nSince I was just looking at the classloader stuff a moment ago, I think I will use that as an analogy:\r\n\r\nThe classloader has a \"context\" property on a table. This context is a hint to the centrally managed classloader factory service. The clasloader factory is responsible for constructing a classloader, given a context. It can choose to ignore the context and provide the same classloader every time. Or, it can decide to produce a classloader that depends on the context (such as interpreting the context as a class path and returning a corresponding URLClassLoader). The classloader factory is the authority, but takes hints from the per-table characteristic.\r\n\r\nI think this model works well, and I think it should be applied to the per-table crypto as well. I believe this is similar to how the per-table balancer works as well, as well as the per-table volume chooser. The scan dispatcher is a bit more complicated, but I think it's also similar, in that there is centralized executors in the tserver, and the per-table config (dispatcher) provides information to select an executor.\r\n\r\nIn short: centralized pluggable services, that have per-table config I think is better than having per-table services.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808252030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808278751","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-808278751","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":808278751,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODI3ODc1MQ==","user":{"login":"PircDef","id":31989480,"node_id":"MDQ6VXNlcjMxOTg5NDgw","avatar_url":"https://avatars.githubusercontent.com/u/31989480?v=4","gravatar_id":"","url":"https://api.github.com/users/PircDef","html_url":"https://github.com/PircDef","followers_url":"https://api.github.com/users/PircDef/followers","following_url":"https://api.github.com/users/PircDef/following{/other_user}","gists_url":"https://api.github.com/users/PircDef/gists{/gist_id}","starred_url":"https://api.github.com/users/PircDef/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PircDef/subscriptions","organizations_url":"https://api.github.com/users/PircDef/orgs","repos_url":"https://api.github.com/users/PircDef/repos","events_url":"https://api.github.com/users/PircDef/events{/privacy}","received_events_url":"https://api.github.com/users/PircDef/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T14:49:27Z","updated_at":"2021-03-26T14:49:27Z","author_association":"MEMBER","body":"> In short: centralized pluggable services, that have per-table config I think is better than having per-table services.\r\n\r\nI think I must be misunderstanding something. How do you envision this for tables that are imported from users that do not use the existing service at all? I'm thinking of the word service as roughly meaning \"encrypter, decrypter, and key utilities\". The PR has even less, leaving the utilities up to the encrypter/decrypters.\r\n```\r\npublic interface CryptoService {\r\n  enum Scope {WAL, RFILE}\r\n  FileEncrypter getEncrypter();\r\n  FileDecrypter getDecrypter();\r\n}\r\n```\r\nLets assume that an Accumulo instance is running with the default crypto service (AESCryptoService) enabled. User A wants to import their table, and they have a custom encrypter/decrypter. Additionally, they have some custom utilities for communicating with their key server. Under this pull request, all of this custom software would be bundled under the UserACryptoService, and Accumulo would have to be configured to use this service when requested by the table. \r\n\r\nHow do you see this working with a centralized pluggable service? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808278751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808346830","html_url":"https://github.com/apache/accumulo/issues/1977#issuecomment-808346830","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1977","id":808346830,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODM0NjgzMA==","user":{"login":"jmark99","id":31573345,"node_id":"MDQ6VXNlcjMxNTczMzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31573345?v=4","gravatar_id":"","url":"https://api.github.com/users/jmark99","html_url":"https://github.com/jmark99","followers_url":"https://api.github.com/users/jmark99/followers","following_url":"https://api.github.com/users/jmark99/following{/other_user}","gists_url":"https://api.github.com/users/jmark99/gists{/gist_id}","starred_url":"https://api.github.com/users/jmark99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmark99/subscriptions","organizations_url":"https://api.github.com/users/jmark99/orgs","repos_url":"https://api.github.com/users/jmark99/repos","events_url":"https://api.github.com/users/jmark99/events{/privacy}","received_events_url":"https://api.github.com/users/jmark99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T16:23:00Z","updated_at":"2021-03-26T16:23:00Z","author_association":"CONTRIBUTOR","body":"I'm not sure this is failing as much as the return from the config -f call is failing to display result properly. If you set the context then then use the -t option along with the -f option it appears to be set.\r\n\r\n<pre>\r\nroot@uno> createtable foo\r\nroot@uno foo> config -t foo -s table.classpath.context=cx1\r\nroot@uno foo> config -f classpath -t foo\r\n-----------+----------------------------+-----------------------------------------------------------------\r\nSCOPE      | NAME                       | VALUE\r\n-----------+----------------------------+-----------------------------------------------------------------\r\ndefault    | table.classpath.context .. | \r\ntable      |    @override ............. | cx1\r\n-----------+----------------------------+-----------------------------------------------------------------\r\nroot@uno foo> config -f classpath\r\n-----------+-------------------------------+--------------------------------------------------------------\r\nSCOPE      | NAME                          | VALUE\r\n-----------+-------------------------------+--------------------------------------------------------------\r\ndefault    | general.classpaths .......... | \r\ndefault    | general.dynamic.classpaths .. | \r\ndefault    | general.vfs.classpaths ...... | \r\ndefault    | table.classpath.context ..... | \r\n-----------+-------------------------------+--------------------------------------------------------------\r\nroot@uno foo> config -f classpath -t foo\r\n-----------+-------------------------------+--------------------------------------------------------------\r\nSCOPE      | NAME                          | VALUE\r\n-----------+-------------------------------+--------------------------------------------------------------\r\ndefault    | table.classpath.context ..... | \r\ntable      |    @override ................ | cx1\r\n-----------+-------------------------------+--------------------------------------------------------------\r\n</pre>\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808346830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808465370","html_url":"https://github.com/apache/accumulo/issues/1977#issuecomment-808465370","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1977","id":808465370,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODQ2NTM3MA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T19:34:50Z","updated_at":"2021-03-26T19:34:50Z","author_association":"MEMBER","body":"If you're setting it to the same value at the per-table scope that it is set to at the system scope, then the per-table value won't be displayed. That's because the way configs inherit from their parent in the config hierarchy makes it impossible to tell the difference between a table config being set at the table scope or inherited from the system scope. It's possible with some implementation changes to detect this, but there really isn't a reason to, since the display shows `overrides` only, and not merely that something is `set`. For something to be an `override`, it has to actually change the value in some way.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808465370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808476222","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-808476222","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":808476222,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODQ3NjIyMg==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T19:57:10Z","updated_at":"2021-03-26T19:58:21Z","author_association":"MEMBER","body":"I'm thinking something like:\r\n\r\n```java\r\npublic interface CryptoService {\r\n  enum Scope {WAL, RFILE}\r\n  FileEncrypter getEncrypter(Context); // where Context contains information like {Scope=RFILE, Config=tableConfig(t1)}\r\n  FileDecrypter getDecrypter(Context);\r\n}\r\n```\r\n \r\n> Lets assume that an Accumulo instance is running with the default crypto service (AESCryptoService) enabled. User A wants to import their table, and they have a custom encrypter/decrypter.\r\n\r\nI would argue for them using a CryptoService that supports their custom encrypter/decrypter features, as well as any others that the rest of the system supports. The config to indicate to the service which encrypter/decrypter features/algorithms/etc. to use can still be per-table config... but the crypto service responsible for interpreting those config options is inside the centrally configured CryptoService implementation, and not living inside Accumulo core code.\r\n\r\nRight now, it seems that this is the workflow:\r\n\r\n* Accumulo determines the context and gathers context information (table config, WAL config, etc.)\r\n* Accumulo retrieves a user-configured crypto service from the context\r\n* The crypto service provides the encrypter/decrypter for that context with additional context information passed in (like table config)\r\n\r\nMy argument is for a workflow that looks like:\r\n\r\n* Accumulo determines the context and gathers context information (table config, WAL config, etc.)\r\n* Accumulo passes the context to the singleton crypto service\r\n* The crypto service provides an encrypter/decrypter appropriate for the given context\r\n\r\nThis moves the decision making about which encrypter/decrypter to use into the singleton CryptoService, and removes Accumulo's responsibility to manage/instantiate multiple crypto services for different contexts, and removes the user's responsibility to configure multiple crypto services, rather than simply different crypto algorithms/options for a singleton crypto service.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808476222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808496468","html_url":"https://github.com/apache/accumulo/issues/1977#issuecomment-808496468","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1977","id":808496468,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODQ5NjQ2OA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T20:40:09Z","updated_at":"2021-03-26T20:40:09Z","author_association":"CONTRIBUTOR","body":"> I'm not sure this is failing as much as the return from the config -f call is failing to display result properly. If you set the context then then use the -t option along with the -f option it appears to be set.\r\n\r\nAh interesting, thanks. It looks like this isn't a bug as just an oddity of the way Accumulo configuration and the shell commands work.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808496468/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808507891","html_url":"https://github.com/apache/accumulo/issues/1976#issuecomment-808507891","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1976","id":808507891,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODUwNzg5MQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T21:05:40Z","updated_at":"2021-03-26T21:05:40Z","author_association":"CONTRIBUTOR","body":"The obfuscation in the classloading code makes it difficult to debug what is going on. I was seeing a null context on the server side but I think that was a red herring as it appears it wasn't making it to the server code. I finally just printed the exception in the shell:\r\n<pre>\r\njava.lang.ClassNotFoundException: org.apache.accumulo.test.FooFilter\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:471) ~[?:?]\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:589) ~[?:?]\r\n\tat org.apache.accumulo.start.classloader.AccumuloClassLoader$1.loadClass(AccumuloClassLoader.java:212) ~[accumulo-start-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:522) ~[?:?]\r\n\tat org.apache.accumulo.shell.commands.SetIterCommand.setUpOptions(SetIterCommand.java:211) ~[accumulo-shell-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\r\n\tat org.apache.accumulo.shell.commands.SetIterCommand.execute(SetIterCommand.java:103) ~[accumulo-shell-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\r\n\tat org.apache.accumulo.shell.Shell.execCommand(Shell.java:779) ~[accumulo-shell-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\r\n\tat org.apache.accumulo.shell.Shell.start(Shell.java:598) ~[accumulo-shell-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\r\n\tat org.apache.accumulo.shell.Shell.execute(Shell.java:528) ~[accumulo-shell-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\r\n\tat org.apache.accumulo.start.Main.lambda$execKeyword$0(Main.java:126) ~[accumulo-start-2.1.0-SNAPSHOT.jar:2.1.0-SNAPSHOT]\r\n</pre>\r\n\r\nI am not sure why the URLClassLoader is being used in this case as I would assume DefaultContextClassLoaderFactory would be the default.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808507891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808515043","html_url":"https://github.com/apache/accumulo/issues/1977#issuecomment-808515043","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1977","id":808515043,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODUxNTA0Mw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T21:21:15Z","updated_at":"2021-03-26T21:21:15Z","author_association":"CONTRIBUTOR","body":"On the topic of setting config in the shell... why doesn't this work?\r\n<pre>\r\nroot@uno> config -s general.context.class.loader.factory=org.apache.accumulo.core.classloader.DefaultContextClassLoaderFactory\r\n2021-03-26T17:12:20,561 [shell.Shell] ERROR: org.apache.accumulo.core.util.BadArgumentException: Property cannot be modified in zookeeper near index 10\r\nconfig -s general.context.class.loader.factory=org.apache.accumulo.core.classloader.DefaultContextClassLoaderFactory\r\n          ^\r\n</pre>\r\n\r\nLooking at the validation code in [Property](https://github.com/apache/accumulo/blob/0781550076f04d12716650fd64881d8b9d041afa/core/src/main/java/org/apache/accumulo/core/conf/Property.java#L1343), only properties that start with \"general.custom\" can be modified with the config command? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808515043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808553363","html_url":"https://github.com/apache/accumulo/issues/1978#issuecomment-808553363","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1978","id":808553363,"node_id":"MDEyOklzc3VlQ29tbWVudDgwODU1MzM2Mw==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-26T22:08:39Z","updated_at":"2021-03-26T22:08:39Z","author_association":"CONTRIBUTOR","body":"Thats the default value for the property, right? You are saying that setting it causes the error?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/808553363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809028626","html_url":"https://github.com/apache/accumulo/issues/1977#issuecomment-809028626","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1977","id":809028626,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTAyODYyNg==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T02:49:23Z","updated_at":"2021-03-29T02:49:23Z","author_association":"MEMBER","body":"> On the topic of setting config in the shell... why doesn't this work?\r\n\r\nWe are very selective about which properties are configurable in ZooKeeper, because some don't make sense to be read from ZooKeeper after a service has started up, or can cause problems. What you linked in the code is a curated allow list for such properties. The error in the shell reflects the documentation about these properties at https://accumulo.apache.org/docs/2.x/configuration/server-properties that marks them as `zk mutable` (with possible values of `no`, `yes`, and `yes but requires restart of <X service>`). The properties that generate an error in the shell are properties which would be documented as `zk mutable: no`.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809028626/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809036899","html_url":"https://github.com/apache/accumulo/issues/1976#issuecomment-809036899","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1976","id":809036899,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTAzNjg5OQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T03:17:57Z","updated_at":"2021-03-29T03:20:12Z","author_association":"MEMBER","body":"> The obfuscation in the classloading code makes it difficult to debug what is going on.\r\n\r\nThat complexity was one of the motivations for moving the classloading code out of Accumulo and supporting its features in a different way. The transition period is a bit rough, though, because we still have to support the existing behavior with the existing config. But, once we can drop these deprecated classes (presumably 3.0?), a lot of this code will make a lot more sense and these features will be much more maintainable.\r\n\r\n> I am not sure why the URLClassLoader is being used in this case as I would assume DefaultContextClassLoaderFactory would be the default.\r\n\r\nIn order to preserve the existing behavior, the DefaultContextClassLoaderFactory currently delegates to the old AccumuloVFSClassLoader, which in turn, uses AccumuloClassLoader as the parent of any VFS classloaders it creates. This parent AccumuloClassLoader is little more than a wrapper around URLClassLoader designed to handle the URLs in the (now deprecated) `general.classpaths` property. So, URLClassLoader makes sense here. What doesn't make sense is why it's using the standard classloader, rather than the context-specific classloader.\r\n\r\nIt's possible it's because the context for the table is being set after the table is created (which is consistent with you seeing `null` for the context), and the property is being read from an outdated ZooCache from the table's initial creation. Instead of setting the table property after the table is created, you could try setting it at creation time with `createtable -prop table.classpath.context=cx1 nofoo`","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809036899/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809044384","html_url":"https://github.com/apache/accumulo/issues/1978#issuecomment-809044384","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1978","id":809044384,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTA0NDM4NA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T03:43:00Z","updated_at":"2021-03-29T03:43:00Z","author_association":"MEMBER","body":"The default value is an empty string, and it is constructed specially when no user implementation is provided. The DefaultContextClassLoaderFactory implements our built-in behavior, which can change over time, and should not be configured by users. The current implementation uses the SiteConfiguration and delegates to the AccumuloVFSClassLoader to preserve the previous VFS class loading behavior until that is removed.\r\n\r\nThis isn't a bug. It's not intended to be exposed to, or configured by, users. It is a special implementation for internal use and does not have a no-arg constructor and cannot be instantiated like a user-provided factory.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809044384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809305529","html_url":"https://github.com/apache/accumulo/issues/1976#issuecomment-809305529","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1976","id":809305529,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTMwNTUyOQ==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T11:31:49Z","updated_at":"2021-03-29T11:31:49Z","author_association":"CONTRIBUTOR","body":"I recently tested the classloaders implementation in 2.1 using the procedure at https://github.com/apache/accumulo-classloaders/blob/main/modules/vfs-class-loader/TESTING.md","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809305529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809483846","html_url":"https://github.com/apache/accumulo/issues/1978#issuecomment-809483846","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1978","id":809483846,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTQ4Mzg0Ng==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T15:40:17Z","updated_at":"2021-03-29T15:40:17Z","author_association":"CONTRIBUTOR","body":"> The default value is an empty string, and it is constructed specially when no user implementation is provided. The DefaultContextClassLoaderFactory implements our built-in behavior, which can change over time, and should not be configured by users. The current implementation uses the SiteConfiguration and delegates to the AccumuloVFSClassLoader to preserve the previous VFS class loading behavior until that is removed.\r\n\r\nOK then I guess the bug is in the default behavior of the empty string configuration, which I am seeing in #1976. I will close this and continue the discussion on that ticket.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809483846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809488888","html_url":"https://github.com/apache/accumulo/issues/1976#issuecomment-809488888","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1976","id":809488888,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTQ4ODg4OA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T15:46:56Z","updated_at":"2021-03-29T15:46:56Z","author_association":"CONTRIBUTOR","body":"> It's possible it's because the context for the table is being set after the table is created (which is consistent with you seeing null for the context), and the property is being read from an outdated ZooCache from the table's initial creation. \r\n\r\nThat would explain why I saw it work once after running another example, assuming I forced the ZooCache to update.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809488888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809516207","html_url":"https://github.com/apache/accumulo/issues/1976#issuecomment-809516207","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1976","id":809516207,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTUxNjIwNw==","user":{"login":"jmark99","id":31573345,"node_id":"MDQ6VXNlcjMxNTczMzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31573345?v=4","gravatar_id":"","url":"https://api.github.com/users/jmark99","html_url":"https://github.com/jmark99","followers_url":"https://api.github.com/users/jmark99/followers","following_url":"https://api.github.com/users/jmark99/following{/other_user}","gists_url":"https://api.github.com/users/jmark99/gists{/gist_id}","starred_url":"https://api.github.com/users/jmark99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmark99/subscriptions","organizations_url":"https://api.github.com/users/jmark99/orgs","repos_url":"https://api.github.com/users/jmark99/repos","events_url":"https://api.github.com/users/jmark99/events{/privacy}","received_events_url":"https://api.github.com/users/jmark99/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T16:16:42Z","updated_at":"2021-03-29T16:16:42Z","author_association":"CONTRIBUTOR","body":"I created a new instance and tried @ctubbsii suggestion but ended up with same result (class not found).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809516207/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809638010","html_url":"https://github.com/apache/accumulo/issues/1976#issuecomment-809638010","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1976","id":809638010,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTYzODAxMA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-29T19:09:15Z","updated_at":"2021-03-29T19:09:15Z","author_association":"CONTRIBUTOR","body":"I think I found the issue. The problem was with one of the methods in the Shell that got the table context. See #1979 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/809638010/reactions","total_count":2,"+1":1,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810149371","html_url":"https://github.com/apache/accumulo/pull/1980#issuecomment-810149371","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1980","id":810149371,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDE0OTM3MQ==","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T11:36:17Z","updated_at":"2021-03-30T11:36:17Z","author_association":"CONTRIBUTOR","body":"From a quick look, some general things you may want to consider:\r\n\r\n  - Format the printed time in UTC with ISO-8601 format instead of java Date default.\r\n  - Provide more descriptive naming in functions instead of timestamp, maybe topCreated() or timeTopCreated()?  \r\n\r\nThe rational for a more descriptive function name than getTimestamp - there are multiple timestamps important in overall FATE transaction life cycle, some of which might be useful if additional FATE timing information was ever extended. If the function naming reflected the operation from an \"external\" perspective then it may be easier differentiate what time this is retrieving (FATE top creation) rather than some of the other possibilities. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810149371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810151002","html_url":"https://github.com/apache/accumulo/pull/1980#issuecomment-810151002","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1980","id":810151002,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDE1MTAwMg==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T11:39:20Z","updated_at":"2021-03-30T11:39:20Z","author_association":"CONTRIBUTOR","body":"Good ideas, especially on the naming convention. I wasn't sure on the time zone part which is why I stuck with the default. I will look into making that change. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810151002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810200838","html_url":"https://github.com/apache/accumulo/pull/1910#issuecomment-810200838","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1910","id":810200838,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDIwMDgzOA==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T12:48:36Z","updated_at":"2021-03-30T12:48:36Z","author_association":"CONTRIBUTOR","body":"Is there an example of how to use this?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810200838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810260759","html_url":"https://github.com/apache/accumulo/pull/1980#issuecomment-810260759","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1980","id":810260759,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDI2MDc1OQ==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T13:44:33Z","updated_at":"2021-03-30T13:44:33Z","author_association":"CONTRIBUTOR","body":"> Format the printed time in UTC with ISO-8601 format instead of java Date default.\r\n\r\nThe original ticket specified a more human-readable print statement. My latest commit does that. What are your thoughts on this @EdColeman? I did keep it in the same order as expect with iso_8601 (I believe). Picture below: \r\n![image](https://user-images.githubusercontent.com/29436247/112998934-8035b200-913c-11eb-8fa6-18affb87b1d4.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810260759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810345340","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-810345340","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":810345340,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDM0NTM0MA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T15:14:57Z","updated_at":"2021-03-30T15:14:57Z","author_association":"CONTRIBUTOR","body":"Although I don't understand how the ClassLoader code works with in regards to Table context, I think I see what you are getting at. I am not sure how to implement it though so I will probably step away from this for a bit.\r\n\r\n> Accumulo passes the context to the singleton crypto service\r\n\r\nI thought we were trying to get away from static singleton classes? The impl that I was going for was object creation based on configuration.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810345340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810358584","html_url":"https://github.com/apache/accumulo/pull/1910#issuecomment-810358584","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1910","id":810358584,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDM1ODU4NA==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T15:32:24Z","updated_at":"2021-03-30T15:32:24Z","author_association":"CONTRIBUTOR","body":"> Is there an example of how to use this?\r\n\r\nI used this recently to quickly create some data for testing compactions.  Below is a bit of bash I wrote to use this new feature.\r\n\r\n```bash\r\nbin/accumulo jshell -<<EOF\r\nvar client=Accumulo.newClient().from(\"conf/accumulo-client.properties\").build();\r\nvar writer=client.createBatchWriter(\"testTable\");\r\nString prev = \"\";\r\nfor(int i = 0; i < 2000000; i++){ var uuid = UUID.randomUUID().toString(); Mutation m = new Mutation(uuid); m.put(\"\",\"\",prev); writer.addMutation(m); prev = uuid;}\r\nwriter.close()\r\n/exit\r\nEOF\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810358584/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810456687","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-810456687","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":810456687,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQ1NjY4Nw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T17:50:09Z","updated_at":"2021-03-30T17:50:09Z","author_association":"MEMBER","body":"> Although I don't understand how the ClassLoader code works with in regards to Table context, I think I see what you are getting at. I am not sure how to implement it though so I will probably step away from this for a bit.\r\n\r\nI don't think this pertains to ClassLoader code. I meant \"context\" in the generic sense of \"surrounding environmental state for the action\", not the per-table contexts for class loading. For these purposes, \"context\" would be something like:\r\n\r\nType of crypter being requested (encrypter or decrypter), map of general crypto opts from system config AND one of:\r\n\r\n* WAL file name, map of any WAL-specific crypto opts from system config\r\n* Table name, RFile name, tablet?, map of table crypto opts from table-specific config\r\n\r\n> \r\n> > Accumulo passes the context to the singleton crypto service\r\n> \r\n> I thought we were trying to get away from static singleton classes? The impl that I was going for was object creation based on configuration.\r\n\r\nNot a static singleton. Just a singleton dangling off of ServerContext for the lifetime of the service. (We have this already today: `serverContext.getCryptoService()`)\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810456687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810466796","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-810466796","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":810466796,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDQ2Njc5Ng==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T18:05:17Z","updated_at":"2021-03-30T18:05:17Z","author_association":"CONTRIBUTOR","body":"OK I think it will be easier to go back to the drawing board and start a fresh branch off of what we have now in main. Closing this for now.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810466796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810509234","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-810509234","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":810509234,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDUwOTIzNA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T19:09:12Z","updated_at":"2021-03-30T19:09:12Z","author_association":"CONTRIBUTOR","body":"@ctubbsii did you have any ideas how to configure the decrypters? @PircDef and I both thinks we should avoid directly loading a class from bytes in a file for security reasons. We thought it would be better to only load classes configured and then compare the bytes read from the file against the classes loaded for decryption.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810509234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810560743","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-810560743","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":810560743,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDU2MDc0Mw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T20:36:26Z","updated_at":"2021-03-30T20:36:26Z","author_association":"MEMBER","body":"> @ctubbsii did you have any ideas how to configure the decrypters? @PircDef and I both thinks we should avoid directly loading a class from bytes in a file for security reasons.\r\n\r\nI agree.\r\n\r\n> We thought it would be better to only load classes configured and then compare the bytes read from the file against the classes loaded for decryption.\r\n\r\nI think you lost me a bit here. I don't see any reason we should serialize any classes to the files at all... only parameters.\r\n\r\nFor example (pseudo-code):\r\n\r\n```java\r\nvar cryptoService = serverContext.getCryptoService();\r\n\r\n// encrypt file\r\nvar encryptionContext = createRFileEncryptionContextForTableFromConfig({tableName, tableConfig});\r\nvar encrypter = cryptoService.getEncrypter(encryptionContext);\r\nvar encryptedOutputStream = newEncryptedOutputStream();\r\nwhile (plaintext.hasMoreBytes()) {\r\n  encryptedOutputStream.append(encrypter.encrypt(plaintext.moreBytes()));\r\n}\r\nvar encryptedRFile = encryptedOutputStream.finish(encrypter.params());\r\n\r\n// decrypt file\r\nvar decryptParams = encryptedRFile.readCryptoHeader(file);\r\nvar decryptionContext = createRFileDecryptionContextForTableFromFileAndConfig({tableName, tableConfig, decryptParams});\r\nvar decrypter = cryptoService.getDecrypter(decryptionContext);\r\nvar plaintextOutputStream = newPlaintextOutputStream();\r\nwhile (encryptedRFile.hasMoreBytes()) {\r\n  plaintextOutputStream.append(decrypter.decrypt(encryptedRFile.moreBytes()));\r\n}\r\nvar plaintextRFile = plaintextOutputStream.toFile();\r\n```\r\n\r\nThis is the basic outline, but the specific API could vary depending on where exactly the file header is read (whether it's in the decrypter itself, or inside Accumulo and merely passed to the decrypter).\r\n\r\nAlso, I believe what I just wrote out is essentially how it works today, except for the lack of having the table name and table config  as part of the encrypt/decrypt contexts. I believe that currently, the only encryption context is the opts in the system config, but the decrypt context does use the params serialized in the RFile.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810560743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810574371","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-810574371","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":810574371,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDU3NDM3MQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T21:00:15Z","updated_at":"2021-03-30T21:04:44Z","author_association":"CONTRIBUTOR","body":"> var decryptionContext = createRFileDecryptionContextForTableFromFileAndConfig({tableName, tableConfig, decryptParams});\r\n\r\nI was wondering what the user should put in `tableConfig` for decryption. Should it be a list of classes to use for decryption? That is where I was going with this PR... User sets `table.crypto.decrypters=CryptoClassA,CryptoClassB,OldCrypto`. Then when we read the decryptParams like you have:\r\n> var decryptParams = encryptedRFile.readCryptoHeader(file);\r\n\r\nWe look at the class name written in the `decryptParams` and see if it matches one of the classes configured in `table.crypto.decrypters`. \r\n\r\nAsked in another way... How do we prevent user from writing code that does bad things? Aka..\r\n<pre>\r\n @Override\r\npublic FileDecrypter getFileDecrypter(CryptoEnvironment env) {\r\n  //load bad class name by accident\r\n  var decryptParams = env.getDecryptParams();\r\n  String maliciousClassName = decryptParams.getClassName();\r\n  return loadClass(maliciousClassName);\r\n}","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810574371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810580911","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-810580911","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":810580911,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDU4MDkxMQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T21:11:59Z","updated_at":"2021-03-30T21:11:59Z","author_association":"MEMBER","body":"> > var decryptionContext = createRFileDecryptionContextForTableFromFileAndConfig({tableName, tableConfig, decryptParams});\r\n> \r\n> I was wondering what the user should put in `tableConfig` for decryption. Should it be a list of classes to use for decryption? That is where I was going with this PR... User sets `table.crypto.decrypters=CryptoClassA,CryptoClassB,OldCrypto`. Then when we read the decryptParams like you have:\r\n> \r\n> > var decryptParams = encryptedRFile.readCryptoHeader(file);\r\n> \r\n> We look at the class name written in the `decryptParams` and see if it matches one of the classes configured in `table.crypto.decrypters`.\r\n\r\nThe user shouldn't be configuring the decrypter class at all. That's too low-level to be convenient for users. The CryptoService should make that decision. Users should be configuring options that are CryptoService-dependent in `table.crypto.opts.*`. The CryptoService implementation that users configure for the system would be responsible for documenting what options are available and what they do.\r\n\r\n> \r\n> Asked in another way... How do we prevent user from writing code that does bad things? Aka..\r\n> \r\n>  @Override\r\n> public FileDecrypter getFileDecrypter(CryptoEnvironment env) {\r\n> //load class bad class name\r\n> var decryptParams = env.getDecryptParams();\r\n> String maliciousClassName = decryptParams.getClassName();\r\n> return loadClass(maliciousClassName);\r\n> }\r\n\r\nThat would be the responsibility of the CryptoService implementation itself to guard against. A good implementation of the CryptoService won't have options to specify arbitrary class names to use, but will do something more sensible... like provide options for the crypto algorithm, and it will instantiate its own decrypter implementation based on the algorithm selected.\r\n\r\nWe can't protect against users deploying a bad CryptoService implementation though. The responsibility is on them to deploy only dependencies they trust, including implementations of pluggable Accumulo components shipped in separate jars.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810580911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810582527","html_url":"https://github.com/apache/accumulo/pull/1968#issuecomment-810582527","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1968","id":810582527,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDU4MjUyNw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-30T21:15:03Z","updated_at":"2021-03-30T21:15:03Z","author_association":"CONTRIBUTOR","body":"Another issue I ran into was how to get information down into BCFile. There is limited information for reading/writing once you get way down into the weeds:\r\nhttps://github.com/apache/accumulo/blob/0781550076f04d12716650fd64881d8b9d041afa/core/src/main/java/org/apache/accumulo/core/file/rfile/bcfile/BCFile.java#L317-L331\r\n\r\nIn this PR, I created the Encrypter or List<Decrypters> based on the configuration and passed that down into BCFile. If we want to create the environment object (`encryptionContext` or `decryptionContext` in your example) down in the belly of BCFile what do we pass to it? The safest way seems to pass `AccumuloConfiguration` down but I want to avoid having to refactor all of our internal file utilities every time we want to add something to the environment object. I guess we could pass down the environment object itself (`encryptionContext` or `decryptionContext`) creating it at the higher levels. But we would still need to create the CryptoService so we can call `cryptoService.getDecrypter(decryptionContext)`","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810582527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810992200","html_url":"https://github.com/apache/accumulo/pull/1980#issuecomment-810992200","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1980","id":810992200,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDk5MjIwMA==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-03-31T11:30:28Z","updated_at":"2021-03-31T11:30:28Z","author_association":"CONTRIBUTOR","body":"@EdColeman I think this is finalized for review again. Is there anything else you recommend I fix? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/810992200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]