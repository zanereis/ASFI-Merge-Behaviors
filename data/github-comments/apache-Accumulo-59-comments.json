[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/759575122","html_url":"https://github.com/apache/accumulo/pull/1865#issuecomment-759575122","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1865","id":759575122,"node_id":"MDEyOklzc3VlQ29tbWVudDc1OTU3NTEyMg==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-13T16:45:22Z","updated_at":"2021-01-13T16:45:22Z","author_association":"MEMBER","body":"@brianloss When you merge these in the UI, GitHub usually appends the PR number as `(#1865)` (in this case) to the end of the subject line of the commit message. It's helpful to have these in the history, even if the commit additionally references other issues in the body of the git commit message (or elsewhere in the subject line). I noticed in this PR (and your previous one), these references to the PR in which the work was done were not included in the commit message when it was merged, so I wanted to bring this to your attention, because it's helpful to keep these, so it's easier to find the PR from the commit.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/759575122/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760380660","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760380660","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760380660,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDM4MDY2MA==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T18:20:46Z","updated_at":"2021-01-14T18:20:46Z","author_association":"MEMBER","body":"I was thinking of taking this on. In looking at the Properties class, it appears it already supports `Deprecated` and `ReplacedBy` annotations on properties. Given that, I was thinking something like the following could work:\r\n\r\n1. Copy all `MASTER_` properties and make a `MANAGER_` equivalent.\r\n2. Deprecate all `MASTER_` properties and set the `ReplacedBy` property to the corresponding `MANAGER_` property.\r\n3. Anywhere a `MASTER_` property is used, retrieve either the new or old property using [AccumuloConfiguration.resolve](https://github.com/apache/accumulo/blob/bdcab448b5c4fb44118197615fe2e231816da01c/core/src/main/java/org/apache/accumulo/core/conf/AccumuloConfiguration.java#L97).\r\n\r\nDoes that seem like a reasonable strategy?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760380660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760393519","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760393519","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760393519,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDM5MzUxOQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T18:42:29Z","updated_at":"2021-01-14T18:42:29Z","author_association":"MEMBER","body":"@brianloss I think it might be a bit burdensome to use `AccumuloConfiguration.resolve` in so many places. Also, it might get complicated if we are monitoring any properties for changes (I'm not sure if we are). As an alternative, I was thinking we could:\r\n\r\n1. Produce an error if both `master.*` and `manager.*` properties exist in the `SiteConfiguration` file on startup and fail to start,\r\n2. Automatically remap any `master.*` to `manager.*` when loading the `SiteConfiguration` file, issuing a warning if any `master.*` are detected, and\r\n3. On upgrade, rename any properties in ZooKeeper automatically.\r\n\r\nThat way, we don't need to maintain any deprecated properties side-by-side in `Property.java` for this, or do anything special to deal with `AccumuloConfiguration.resolve`. We can simply rename the enums and property keys in `Property.java`.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760393519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760402227","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760402227","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760402227,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQwMjIyNw==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T18:58:16Z","updated_at":"2021-01-14T18:58:16Z","author_association":"MEMBER","body":"@ctubbsii I don't know why I assumed Property was in the public API but since it's not, I agree your approach will be cleaner. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760402227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760404978","html_url":"https://github.com/apache/accumulo/issues/1791#issuecomment-760404978","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1791","id":760404978,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQwNDk3OA==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T19:03:28Z","updated_at":"2021-01-14T20:03:42Z","author_association":"MEMBER","body":"This test fails for me more often then it passes. I got the same error as you for shutDownAndResumeTserver once but most of the time this test reaches the 5 minute timeout for me. It did pass once in which case the crashAndResumeTserver test failed with similar error: \r\n```java\r\njava.lang.AssertionError: \r\nExpected :[1;11;10]\r\nActual   :[1;18;17, 1;11;10, 1;19;18, 1;12;11, 1;13;12, 1;14;13, 1;15;14, 1;16;15, 1;17;16, 1;8;7]\r\n\r\n\tat org.junit.Assert.fail(Assert.java:89)\r\n\tat org.junit.Assert.failNotEquals(Assert.java:835)\r\n\tat org.junit.Assert.assertEquals(Assert.java:120)\r\n\tat org.junit.Assert.assertEquals(Assert.java:146)\r\n\tat org.apache.accumulo.test.master.SuspendedTabletsIT.suspensionTestBody(SuspendedTabletsIT.java:225)\r\n\tat org.apache.accumulo.test.master.SuspendedTabletsIT.crashAndResumeTserver(SuspendedTabletsIT.java:100)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n\tat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)\r\n\tat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:288)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:282)\r\n\tat java.base/java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:264)\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java)\r\n\tat java.base/java.lang.Thread.run(Thread.java:834)\r\n```\r\nIt looks like in both cases an assertEquals() fails comparing a set of dead tablets and another set of tablets. In both cases either the expected value is a subset of the actual value or vise-versa. I'm not too sure what this means yet but im looking into it.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760404978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760405575","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760405575","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760405575,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQwNTU3NQ==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T19:04:38Z","updated_at":"2021-01-14T19:04:38Z","author_association":"CONTRIBUTOR","body":"I like the idea of centralizing handling of the old master props in the code and avoiding `AccumuloConfiguration.resolve` in lots of places. It would also be nice to avoid having lots of deprecated master props in the Accumulo Property ENUM if possible and centrally handle this special case in the code instead.  The centralized handling needs to ensure we have a concept of what the current master props are and freeze those, not mapping future new manager props to master props that never existed.\r\n\r\n@ctubbsii I like your proposal, it seems to imply that users would no longer be able to set master props in zookeeper.  Was that what you were thinking?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760405575/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760407386","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760407386","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760407386,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQwNzM4Ng==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T19:08:21Z","updated_at":"2021-01-14T19:08:21Z","author_association":"MEMBER","body":"> @ctubbsii I like your proposal, it seems to imply that users would no longer be able to set master props in zookeeper.  Was that what you were thinking?\n\nYes it was. We would still support reading an old config file, but would otherwise prevent any new properties from being set using the old names.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760407386/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760411494","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760411494","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760411494,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQxMTQ5NA==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T19:16:45Z","updated_at":"2021-01-14T19:16:45Z","author_association":"CONTRIBUTOR","body":"> Yes it was. We would still support reading an old config file, but would otherwise prevent any new properties from being set using the old names.\r\n\r\nThat means these props would not be going through a deprecation cycle? That could have a negative impact on any automation developed around Accumulo.  Its not always user sitting at terminals setting properties. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760411494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760419434","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760419434","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760419434,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQxOTQzNA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T19:28:49Z","updated_at":"2021-01-14T19:30:24Z","author_association":"MEMBER","body":"> That means these props would not be going through a deprecation cycle? That could have a negative impact on any automation developed around Accumulo. Its not always user sitting at terminals setting properties.\r\n\r\nWith my suggestion, they would still go through a deprecation cycle of a sort. While deprecated, we would still respect existing config files (property reads), but yes, it would disallow automation of the type you describe (property writes) that alters these properties in ZooKeeper... at least, without any additional effort. It would also disallow mixing old and new in the same config file. This seemed like the simplest approach that covered the most bases to me.\r\n\r\nWe could put in the additional effort of allowing such properties by translating any incoming property changes intended for the ZooKeeper store via the API from `master.*` to `manager.*` to support the automation you describe. However, I'm not sure this would really be worth it... because automation would already be negatively impacted because the returned properties when querying would not show the old properties. So, if there were automation reading, modifying, and writing, it wouldn't be able to see the `master.*` properties.\r\n\r\nI'm fine with not adding in this additional effort, though, because I think the risk is pretty low. Automation of the type that would change the `master.*` properties without human intervention seems like it'd be a rare thing, if it exists at all.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760419434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760438448","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760438448","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760438448,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQzODQ0OA==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T19:52:53Z","updated_at":"2021-01-14T19:52:53Z","author_association":"CONTRIBUTOR","body":"> With my suggestion, they would still go through a deprecation cycle of a sort. \r\n\r\nHaving sets of deprecated properties that behave in very different ways would be confusing from a user perspective.  It would need to be reflected in the documentation, so users know what to do. \r\n\r\n> We could put in the additional effort of allowing such properties by translating any incoming property changes intended for the ZooKeeper store via the API from master.* to manager.* to support the automation you describe. \r\n\r\nCould try to put specialized handling in AccumuloConfiguration to map these props on lookup.  Like what resolve does, but not spreading it everywhere in the code.  This may not be additional effort but not sure.  \r\n\r\nThinking it would be nice to centralize the handling of this large group of deprecated properties in the code (avoiding specialized per property handling in the code), but make them behave like every other deprecated property in Accumulo from a users perspective. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760438448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760441639","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760441639","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760441639,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQ0MTYzOQ==","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T19:57:59Z","updated_at":"2021-01-14T19:58:43Z","author_association":"CONTRIBUTOR","body":"I am thinking we may be too nice here.  I propose:\r\n1) Fail to startup if any of the master.* properties still exist in the site file with an informative message.\r\n2) Use the version upgrade mechanism to fix any overrides in zookeeper.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760441639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760455032","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760455032","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760455032,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQ1NTAzMg==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T20:24:33Z","updated_at":"2021-01-14T20:24:33Z","author_association":"MEMBER","body":"> > With my suggestion, they would still go through a deprecation cycle of a sort.\r\n> \r\n> Having sets of deprecated properties that behave in very different ways would be confusing from a user perspective. It would need to be reflected in the documentation, so users know what to do.\r\n\r\nI was wondering about this too. Even though the class Property is not in the public API, by having a mechanism to deprecate properties and using that mechanism, including on `master.bulk.rename.threadpool.size`, it seems we're treating them as though they are part of the public API.\r\n\r\n> Could try to put specialized handling in AccumuloConfiguration to map these props on lookup. Like what resolve does, but not spreading it everywhere in the code. This may not be additional effort but not sure.\r\n\r\nMaybe this idea is worth exploring? It seems like possibly it could be done in the `get(Property)` method.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760455032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760465143","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760465143","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760465143,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQ2NTE0Mw==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T20:45:01Z","updated_at":"2021-01-14T20:50:41Z","author_association":"CONTRIBUTOR","body":"> it seems we're treating them as though they are part of the public API.\r\n\r\nI think this treatment derives from the fact that they are user facing.  I am uncertain about the best path in this particular situation, but I do know its good to give user facing changes a bit more consideration.  The conversation is making me think about property deprecation in Accumulo in general.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760465143/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760468313","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760468313","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760468313,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQ2ODMxMw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T20:51:32Z","updated_at":"2021-01-14T20:51:32Z","author_association":"MEMBER","body":"> Having sets of deprecated properties that behave in very different ways would be confusing from a user perspective. It would need to be reflected in the documentation, so users know what to do.\r\n> \r\n\r\nThis is kind of a special case. I think we could document it well enough, and provide meaningful error/warning messages, that consistency with regular property deprecations won't matter much, because it will be clear what to do from the documentation and/or messages.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760468313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760491536","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760491536","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760491536,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDQ5MTUzNg==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T21:36:18Z","updated_at":"2021-01-14T21:36:18Z","author_association":"MEMBER","body":"I was looking at `Property` and `AccumuloConfiguration` and was wondering what people think about something like the following... In `Property` the class has a member variable `replacedBy` that gets filled in if the `ReplacedBy` annotation is on a specific `Property` enum (that's done by `Property.precomputeAnnotations` which is invoked on each property enum value. What if we changed that to something like `deprecatedNames` so that a given property could have its deprecated names associated with it. I say names, plural, since we already have `master.bulk.rename.threadpool.size` deprecated and replaced by `master.rename.threadpool.size` so in my example the `deprecatedNames` for `manager.rename.threadpool.size`would be both `master.rename.threadpool.size` and `master.bulk.rename.threadpool.size`.\r\n\r\nWith this change, we could restructure `AccumuloConfiguration` so that `get` is no longer an abstract method (we'd rename the current abstract method and all of it's implementations to something else, call it `internalGet` for now) and then it would call the `internalGet` method with the property name. If that's not found, then it could try any `deprecatedNames` in turn. This would allow us to maintain the old and new property names and not have to use `AccumuloConfiguration.resolve`. In fact, any existing deprecated properties could take advantage of this approach too. At startup, we could still go through the site configuration and warn if we find any property names that are in the deprecated.\r\n\r\nI'm not familiar enough with the property handling code to recognize if there's some fatal flaw in this idea, so please let me know if I missed something. Barring that, it seems like it could solve the concerns with the previously suggested approaches for this ticket and also provide a cleaner mechanism for any future property deprecations.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760491536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760524853","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760524853","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760524853,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDUyNDg1Mw==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-14T22:46:31Z","updated_at":"2021-01-14T22:46:31Z","author_association":"CONTRIBUTOR","body":"> I'm not familiar enough with the property handling code to recognize if there's some fatal flaw in this idea, so please let me know if I missed something.\r\n\r\nThe broad strokes you mentioned SGTM, if there is a fatal flaw it will certainly show up during implementation.  It seems like a good general change  that may make the prop deprecation code more maintainable, centralized, and consistent.\r\n\r\nTrying to think about how the proposal relates to this issue, I am trying to think of special cases that are unique to this large set of deprecated properties. One thing that comes to mind, is having a gigantic list of individually deprecated master props in the generated props docs.  That would be noisy and not very useful.\r\n\r\nNot sure if this [documetation](https://github.com/apache/accumulo-website#updating-property-documentation-for-releases) still works, it outlines how to render the [props docs](https://accumulo.apache.org/docs/2.x/configuration/server-properties).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760524853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760621401","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760621401","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760621401,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDYyMTQwMQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T03:28:06Z","updated_at":"2021-01-15T03:29:30Z","author_association":"MEMBER","body":"@brianloss There are a few concerns I'd have with that proposal:\r\n\r\n1. Extra complexity (it seems a little more complicated and a lot more code changing than the previous proposals),\r\n2. I think we should encourage phase out of these deprecated stuffs, not continued support indefinitely for code or properties that have been discontinued (this plan sounds like the intent is to support \"old names\" in perpetuity; in this case, we actually want to discontinue the use of the term \"master\" in its entirety; this is possibly true for other cases, as well), and\r\n3. Properties are *rarely* simply renamed... they are most often changed because of a shift in their semantics. Supporting \"old names\" implies simple renames. That is the case for this change, but this is, as I've said, a special case.\r\n\r\nI agree with @keith-turner 's concern about having a gigantic list of individually deprecated properties in the docs. I had been thinking about that as well. In the proposal I suggested, it would be simple to add a section to the generated properties documentation to document that (and how) the `master.` prefix is deprecated.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760621401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760938382","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-760938382","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":760938382,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MDkzODM4Mg==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T13:20:53Z","updated_at":"2021-01-15T13:33:04Z","author_association":"MEMBER","body":"> @brianloss There are a few concerns I'd have with that proposal:\r\n> \r\n> 1. Extra complexity (it seems a little more complicated and a lot more code changing than the previous proposals),\r\n\r\nI'm not sure it's that complicated since the changes would be pretty much limited to Property and AccumuloConfiguration (changes to the AccumuloConfiguration sub-classes would be through IDE refactoring, and all of the property enum renames and their cascading changes would happen with any approach). I had been thinking I might prototype it and see, but the idea was just a thought, and see below...\r\n\r\n> 2. I think we should encourage phase out of these deprecated stuffs, not continued support indefinitely for code or properties that have been discontinued (this plan sounds like the intent is to support \"old names\" in perpetuity; in this case, we actually want to discontinue the use of the term \"master\" in its entirety; this is possibly true for other cases, as well), and\r\n\r\nI wasn't intending that we'd support the old names indefinitely, but rather follow semver rules (even though we don't _have_ to for the properties) and have them be fully supported until the next major release when they could be removed.\r\n\r\n> 3. Properties are _rarely_ simply renamed... they are most often changed because of a shift in their semantics. Supporting \"old names\" implies simple renames. That is the case for this change, but this is, as I've said, a special case.\r\n> \r\n> I agree with @keith-turner 's concern about having a gigantic list of individually deprecated properties in the docs. I had been thinking about that as well. In the proposal I suggested, it would be simple to add a section to the generated properties documentation to document that (and how) the `master.` prefix is deprecated.\r\n\r\nThat's a fair point about simple renames. If we don't think they're likely to happen again any time soon **and** we don't think our user community will be upset about a partially incompatible change (not being able to use set the old property names in Zookeeper) on a minor version release, then I can just implement what you suggested. I also agree the documentation is important and we wouldn't want the noise of a huge list of deprecated properties in the docs.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/760938382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761014093","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-761014093","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":761014093,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTAxNDA5Mw==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T15:38:09Z","updated_at":"2021-01-15T15:40:17Z","author_association":"CONTRIBUTOR","body":"> Extra complexity\r\n\r\nI agree that lots of complexity should not be added to the code to support this one case. The complexity of the Accumulo code base could be considered in conjunction w/ the complexity of the user experience.  Having sets of deprecated properties w/ different runtime behaviors is a complicated user experience.  An ideal solution would reduce the complexity of both, not sure it exists though.\r\n\r\n> Properties are rarely simply renamed..\r\n\r\nThat is a good point.  There was not a 1:1 relationship between the deprecated prop and replacements in the recent PR #1861 I did.\r\n\r\n> I think we should encourage phase out of these deprecated stuffs, not continued support indefinitely for code or properties that have been discontinued\r\n\r\nThis is really its own issue, but this comment made me think of the following. If we wanted to adopt something more aggressive than semver for removing deprecated props, doing it before 2.1 is released is a good time. Thinking any prop deprecated before an LTS release could be removed in main after the LTS is released (this would be more relaxed that semver possibly).  Not sure about non-LTS releases.  The new policy could be documented and warnings logged for deprecated props could mention when the removal will happen.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761014093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761068173","html_url":"https://github.com/apache/accumulo/pull/1803#issuecomment-761068173","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1803","id":761068173,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTA2ODE3Mw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T17:13:43Z","updated_at":"2021-01-15T17:13:43Z","author_association":"CONTRIBUTOR","body":"I think I figured out the issue with this change.  The problem is with how `RecoveryManager.recoverLogs()` works.  The first time the Master will call `RecoveryManager.recoverLogs()` it will generate `dest` (call it dest1) using `RecoveryPath.getRecoveryPath()`.  RecoveryManager will check for a \"finished\" file at this location, which won't exist yet and kick off the log sorting process.  The LogSorter job will complete and put a \"finished\" marker at dest1.  The next time the Master tries to assign the Tablet, it will call `RecoveryManager.recoverLogs()` and generate a second `dest` (call it dest2).  RecoveryManager will check for a \"finished\" file at dest2, won't see it and start another log sort process.  The \"finished\" file is never seen by the next call of `RecoveryManager.recoverLogs()` and the log sorting process will continue indefinitely. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761068173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761071982","html_url":"https://github.com/apache/accumulo/pull/1803#issuecomment-761071982","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1803","id":761071982,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTA3MTk4Mg==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T17:20:46Z","updated_at":"2021-01-15T17:20:46Z","author_association":"CONTRIBUTOR","body":"That is correct @milleruntime. Some ideas have been thrown around on how to fix it but implementing it has been more difficult since `TabletServer.java` also uses `RecoveryPath.java` for recovering tablets. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761071982/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761087325","html_url":"https://github.com/apache/accumulo/pull/1803#issuecomment-761087325","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1803","id":761087325,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTA4NzMyNQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T17:50:16Z","updated_at":"2021-01-15T17:50:16Z","author_association":"CONTRIBUTOR","body":"I think using the name of the tserver as the unique sub directory under the WAL directory would work.  As an added benefit, when the RecoveryManager sees that dir at the beginning of `recoveryLogs` it could also check if that tserver is still alive (coming from the master so this may be as simple as looking in a list of tservers).  It would still be possible that the tserver is alive and the thread died/hung or it was restarted so that sort process is gone.  But we could print warnings for this case and start another sort either way.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761087325/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761136440","html_url":"https://github.com/apache/accumulo/pull/1803#issuecomment-761136440","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1803","id":761136440,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTEzNjQ0MA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T19:19:30Z","updated_at":"2021-01-15T19:19:30Z","author_association":"MEMBER","body":"> I think using the name of the tserver as the unique sub directory under the WAL directory would work. As an added benefit, when the RecoveryManager sees that dir at the beginning of `recoveryLogs` it could also check if that tserver is still alive (coming from the master so this may be as simple as looking in a list of tservers). It would still be possible that the tserver is alive and the thread died/hung or it was restarted so that sort process is gone. But we could print warnings for this case and start another sort either way.\r\n\r\nThe hiccup I can see with this is that I don't know what \"name of the tserver\" is. The most common identifier for a tserver is the hostname and port, but these are not necessarily unique (tservers fail and restart on the same host/port). I was actually just thinking about the tserver generating a unique ID internally when it starts, that can be used to make unique directories. The unique ID could be logged, or could be sent in hello messages to the manager server, or stored in Zookeeper locks, for additional uses, but for this issue, it would be enough to just log the directory that it created to be used for recovery.\r\n\r\nOnce the uniqueness issue is ironed out, with unique names, the SimpleGarbageCollector still needs to be updated and tested to ensure it works properly, cleaning up the old directories. I mocked up a patch above for that, but it has not been tested.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761136440/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761153214","html_url":"https://github.com/apache/accumulo/issues/1640#issuecomment-761153214","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1640","id":761153214,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTE1MzIxNA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T19:36:42Z","updated_at":"2021-01-15T19:36:42Z","author_association":"MEMBER","body":"I don't think we should adopt anything more aggressive than semver for deprecated props, but I do think this is a special case that may need to be considered apart from what we might do \"normally\", and that it's okay to flex semver under special circumstances. However, I don't think we need to do that here. Given the conversation indicating a desire to keep support for setting new properties in the API using the old names, I think we can preserve deprecation consistency with very simple changes, that keep complexity low for users and maintainers:\r\n\r\n1. remap SiteConfiguration props on load,\r\n2. remap ZooConfiguration on upgrade, and\r\n3. remap props for setProperty() on API call.\r\n\r\n(All with appropriate log messages and updated documentation, of course.)\r\n\r\nThe remapping function could even be located in a single place, to make it easier to drop support for the deprecated props in the next major release.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761153214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761200846","html_url":"https://github.com/apache/accumulo/issues/1791#issuecomment-761200846","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1791","id":761200846,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTIwMDg0Ng==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-15T21:15:01Z","updated_at":"2021-01-15T21:15:01Z","author_association":"MEMBER","body":"@milleruntime Are you working on this? I noticed you are assigned to this ticket.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761200846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761284659","html_url":"https://github.com/apache/accumulo/issues/1791#issuecomment-761284659","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1791","id":761284659,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTI4NDY1OQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-16T01:25:39Z","updated_at":"2021-01-16T01:25:39Z","author_association":"CONTRIBUTOR","body":"> @milleruntime Are you working on this? I noticed you are assigned to this ticket.\r\n\r\nNot at the moment, no, knock yourself out!  I had looked into it some last year but don't remember if I got anywhere.  My guess is that since I don't have a branch for it, I did not find anything significant.   I assigned it to you","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761284659/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761286151","html_url":"https://github.com/apache/accumulo/issues/1384#issuecomment-761286151","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1384","id":761286151,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTI4NjE1MQ==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-16T01:35:37Z","updated_at":"2021-01-16T01:35:37Z","author_association":"CONTRIBUTOR","body":"Opened apache/accumulo-website#257.  \r\n\r\nI experimented with creating the old style ~del splits points in 2.0.1, upgrading, creating new style split, and then merging.  I took some notes from these experiments and stored them at the link below.\r\n\r\nhttps://gist.github.com/keith-turner/9896c511f71d47b06eb8af46ed74b691","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761286151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761614572","html_url":"https://github.com/apache/accumulo/issues/1384#issuecomment-761614572","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1384","id":761614572,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTYxNDU3Mg==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-16T18:47:45Z","updated_at":"2021-01-16T18:47:45Z","author_association":"MEMBER","body":"Is this issue satisfied by the referenced documentation PR, or is there more to do for this?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761614572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761730032","html_url":"https://github.com/apache/accumulo/issues/1384#issuecomment-761730032","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1384","id":761730032,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTczMDAzMg==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-17T04:28:27Z","updated_at":"2021-01-17T04:30:09Z","author_association":"CONTRIBUTOR","body":"> Is this issue satisfied by the referenced documentation PR, or is there more to do for this?\r\n\r\nYeah the referenced website PR satisfies this issue.  The linked gist is just some notes from experiments I did to collect info to write the PR.  I used jshell to run Accumulo code in those experiments, that was neat.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761730032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761731624","html_url":"https://github.com/apache/accumulo/issues/1384#issuecomment-761731624","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1384","id":761731624,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTczMTYyNA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-17T04:52:12Z","updated_at":"2021-01-17T04:52:12Z","author_association":"MEMBER","body":"> Yeah the referenced website PR satisfies this issue. The linked gist is just some notes from experiments I did to collect info to write the PR.\r\n\r\nOkay, I'll close this then, since apache/accumulo-website#257 is the intended solution. (For some reason, I thought GitHub had already linked a reference to that PR, but it didn't... it only linked to the commits in the PR, not to the PR itself.)\r\n\r\n> I used jshell to run Accumulo code in those experiments, that was neat.\r\n\r\nI've used that recently as well. It's nice (assuming the class path is set up, and you know the fluent entry point to the API). I was thinking we might want to write a `bin/accumulo jshell` command to initialize jshell with the Accumulo class path and customized initial imports to make it even easier. A recent new contributor who I know was going through the tour on the website recently, @slackwinner, might be interested in picking that up. I will reach out to them after the (U.S.) holiday weekend, to gauge their interest and will create a separate ticket. Also, the more fluent code we write, the easier jshell is to use, with its tab completion. It might even overtake the value of our current shell at some point.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/761731624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/762876881","html_url":"https://github.com/apache/accumulo/issues/1384#issuecomment-762876881","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1384","id":762876881,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mjg3Njg4MQ==","user":{"login":"slackwinner","id":50567198,"node_id":"MDQ6VXNlcjUwNTY3MTk4","avatar_url":"https://avatars.githubusercontent.com/u/50567198?v=4","gravatar_id":"","url":"https://api.github.com/users/slackwinner","html_url":"https://github.com/slackwinner","followers_url":"https://api.github.com/users/slackwinner/followers","following_url":"https://api.github.com/users/slackwinner/following{/other_user}","gists_url":"https://api.github.com/users/slackwinner/gists{/gist_id}","starred_url":"https://api.github.com/users/slackwinner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/slackwinner/subscriptions","organizations_url":"https://api.github.com/users/slackwinner/orgs","repos_url":"https://api.github.com/users/slackwinner/repos","events_url":"https://api.github.com/users/slackwinner/events{/privacy}","received_events_url":"https://api.github.com/users/slackwinner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T14:30:38Z","updated_at":"2021-01-19T14:30:38Z","author_association":"CONTRIBUTOR","body":"@ctubbsii I'd be happy to assist the team with creating the bin/accumulo jshell command if it's needed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/762876881/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/762933158","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-762933158","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":762933158,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjkzMzE1OA==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T15:51:20Z","updated_at":"2021-01-19T15:51:20Z","author_association":"CONTRIBUTOR","body":"@keith-turner @DomGarguilo @EdColeman - with this latest commit I attempted to implement the recipe at https://zookeeper.apache.org/doc/current/recipes.html#sc_recipes_Locks. If we have two processes (A and B) we might end up with the following ephemeral sequential nodes:\r\n\r\n```\r\nzlock#44755fbe-1c9e-40b3-AAAA-03abaf950d7e#0000000001 (created by server but missed by client, A has the lock)\r\nzlock#44755fbe-1c9e-40b3-AAAA-03abaf950d7e#0000000002 (created by server and returned to the client)\r\nzlock#44755fbe-1c9e-40b3-BBBB-03abaf950d7e#0000000003 (created by server but missed by client)\r\nzlock#44755fbe-1c9e-40b3-BBBB-03abaf950d7e#0000000004 (created by server and returned to the client, B is watching 2)\r\n```\r\n\r\nI'm going to see what I can do to test this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/762933158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763051560","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-763051560","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":763051560,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzA1MTU2MA==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T18:55:05Z","updated_at":"2021-01-19T18:55:05Z","author_association":"CONTRIBUTOR","body":"@EdColeman  @keith-turner  - I added a test in [525e3ed](https://github.com/apache/accumulo/pull/1866/commits/525e3eda79514ff728b9d168fcc146e6d8599980) and I am running into something unexpected. If you look at the test output you will see that 4 nodes are created in ZK, but the call to [zk.getChildren](https://github.com/apache/accumulo/pull/1866/commits/525e3eda79514ff728b9d168fcc146e6d8599980#diff-3eaaf5fe7d173dc365a6164af9d3c0bbbfb6e5a66115bb942ae01960e8396caeR393) only returns 3 nodes. This is the reason for one of the checks being commented out currently. Working on trying to understand why this might occur. Any insight would be helpful.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763051560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763098205","html_url":"https://github.com/apache/accumulo/issues/1870#issuecomment-763098205","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1870","id":763098205,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzA5ODIwNQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T20:09:41Z","updated_at":"2021-01-19T20:09:41Z","author_association":"MEMBER","body":"@slackwinner had expressed interest in working on this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763098205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763098484","html_url":"https://github.com/apache/accumulo/issues/1384#issuecomment-763098484","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1384","id":763098484,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzA5ODQ4NA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T20:10:09Z","updated_at":"2021-01-19T20:10:09Z","author_association":"MEMBER","body":"> @ctubbsii I'd be happy to assist the team with creating the bin/accumulo jshell command if it's needed.\r\n\r\nI created a separate issue to track that at #1870","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763098484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763099727","html_url":"https://github.com/apache/accumulo/issues/1791#issuecomment-763099727","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1791","id":763099727,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzA5OTcyNw==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T20:12:25Z","updated_at":"2021-01-19T20:12:25Z","author_association":"MEMBER","body":"The `assertEquals` that is failing compares the equivalence of the tablets on a server before and after that server is suspended. There is a comment before the assert that reads: \r\n> By this point, all tablets should be either hosted or suspended. All suspended tablets should \"belong\" to the dead tablet servers, and should be in exactly the same place as before any tserver death.\r\n\r\nI'm not too sure if this statement is true however I have observed tablets travelling between servers before and after being suspended. Below is a printout of the list of tablets on two servers before and after suspension:\r\n```java\r\n2021-01-19T14:27:28,658 [master.SuspendedTabletsIT] DEBUG: Suspended thor:42727: [1;29;28, 1;1<, 1;10;1, 1;11;10, 1;12;11, 1;24;23, 1;4;3, 1;15;14, 1;3;29, 1;27;26, 1;28;27, 1;8;7]\r\n2021-01-19T14:27:28,664 [master.SuspendedTabletsIT] DEBUG: Previously hosted thor:42727: [1;29;28, 1;1<, 1;10;1, 1;11;10, 1;12;11, 1;15;14, 1;3;29, 1;27;26, 1;28;27, 1;8;7]\r\n2021-01-19T14:27:28,664 [master.SuspendedTabletsIT] DEBUG: Suspended thor:44931: [1;21;20, 1;20;2, 1;22;21, 1;23;22, 1;25;24, 1;5;4, 1;26;25, 1;16;15]\r\n2021-01-19T14:27:28,664 [master.SuspendedTabletsIT] DEBUG: Previously hosted thor:44931: [1;21;20, 1;20;2, 1;22;21, 1;23;22, 1;24;23, 1;4;3, 1;25;24, 1;5;4, 1;26;25, 1;16;15]\r\n```\r\nIts a bit hard to read but some tablets that appeared on server A are appearing on server B and vise-versa. This tells me that either the assert in this test is making an incorrect assumption about the nature of tablets on a suspended server, or the test is behaving correctly and catching a valid error. Any thoughts would be helpful.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763099727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763103936","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-763103936","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":763103936,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzEwMzkzNg==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T20:17:51Z","updated_at":"2021-01-19T20:17:51Z","author_association":"CONTRIBUTOR","body":"I think I figured it out. ZooLock.tryLock() deletes the ephemeral node that it creates if it can't grab the lock.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763103936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763108854","html_url":"https://github.com/apache/accumulo/issues/1791#issuecomment-763108854","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1791","id":763108854,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzEwODg1NA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T20:22:50Z","updated_at":"2021-01-19T20:23:40Z","author_association":"MEMBER","body":"> This tells me that either the assert in this test is making an incorrect assumption about the nature of tablets on a suspended server, or the test is behaving correctly and catching a valid error. Any thoughts would be helpful.\r\n\r\nThat is a correct interpretation of the reported error. The intent of the suspending feature is to ensure that tablets get reassigned to the same server as before, if the outage is brief enough. One would need to investigate to determine why they are migrating... but here are a few possible scenarios:\r\n\r\n* the suspend time elapsed and the tablets are free to migrate before we are able to check (possibly because the tserver took too long to restart or WAL recovery on tablet load is causing the suspend time to elapse before we check the tablet states)\r\n* the tserver fully recovered and then participated in subsequent migrations\r\n* we're splitting tablets and creating new migrations (possibly because splits weren't stabilized before killing the tserver)\r\n* the balancer is misbehaving, and rebalancing when it isn't supposed to\r\n* they migrated before we killed the tserver, but we didn't record it correctly in the test","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763108854/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763177665","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-763177665","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":763177665,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE3NzY2NQ==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T22:17:57Z","updated_at":"2021-01-19T22:17:57Z","author_association":"CONTRIBUTOR","body":"I ended up renaming a bunch of variables so that I could understand what was going on. Lots of \"async\"-named things, but nothing asynchronous going on. The copious amount of comments were helpful too :-)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763177665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763527083","html_url":"https://github.com/apache/accumulo/pull/1868#issuecomment-763527083","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1868","id":763527083,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzUyNzA4Mw==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T11:06:17Z","updated_at":"2021-01-20T11:06:25Z","author_association":"CONTRIBUTOR","body":"Thanks, @ctubbsii  for fixing the build issue. I pushed while running out of the office so I didn't do a full `-Psunny` build. Is this good to merge or is there more to be done?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763527083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763612129","html_url":"https://github.com/apache/accumulo/pull/1803#issuecomment-763612129","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1803","id":763612129,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzYxMjEyOQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T13:40:23Z","updated_at":"2021-01-20T13:40:23Z","author_association":"CONTRIBUTOR","body":"> The hiccup I can see with this is that I don't know what \"name of the tserver\" is. The most common identifier for a tserver is the hostname and port, but these are not necessarily unique (tservers fail and restart on the same host/port).\r\n\r\nI think that is fine for recovery sorting.  If a tserver fails or restarts, then I don't think we want to restart the sort anyway.  I don't know if it is possible or worth the trouble of trying to recover the sort recovery.  I was thinking hostname and port was enough to indicate a sort was kicked off and by which server.  We also wouldn't need additional code to store the unique ID if we use hostname and port.\r\n\r\nGood point about updating the GC.  I think we may also need to introduce an age off property (or reuse another) to know when we should give up waiting for a sort to finish.  I am not sure how long we would want to wait for the sort to finish.  Waiting too long will prevent Tablet's from loading but larger clusters can take hours to recovery.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763612129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763625181","html_url":"https://github.com/apache/accumulo/pull/1651#issuecomment-763625181","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1651","id":763625181,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzYyNTE4MQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T14:02:14Z","updated_at":"2021-01-20T14:02:14Z","author_association":"CONTRIBUTOR","body":"@cradal Do you have plans on finishing this PR? If not, I can get take it over if you'd like. I recently used this code and have at least one place it could be used in #1821 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763625181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763641119","html_url":"https://github.com/apache/accumulo/issues/1625#issuecomment-763641119","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1625","id":763641119,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzY0MTExOQ==","user":{"login":"GreenCee","id":23325390,"node_id":"MDQ6VXNlcjIzMzI1Mzkw","avatar_url":"https://avatars.githubusercontent.com/u/23325390?v=4","gravatar_id":"","url":"https://api.github.com/users/GreenCee","html_url":"https://github.com/GreenCee","followers_url":"https://api.github.com/users/GreenCee/followers","following_url":"https://api.github.com/users/GreenCee/following{/other_user}","gists_url":"https://api.github.com/users/GreenCee/gists{/gist_id}","starred_url":"https://api.github.com/users/GreenCee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GreenCee/subscriptions","organizations_url":"https://api.github.com/users/GreenCee/orgs","repos_url":"https://api.github.com/users/GreenCee/repos","events_url":"https://api.github.com/users/GreenCee/events{/privacy}","received_events_url":"https://api.github.com/users/GreenCee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T14:25:28Z","updated_at":"2021-01-20T14:26:30Z","author_association":"NONE","body":"Working on this with only a few minor fixes\r\n\r\nIt's setup to create an interactive bash, but before submitting a PR I want to setup to also run the commands as args for unattended or fire-and-forget type builds.\r\n\r\ndocker run accumulo-docker-build mvn package\r\n\r\nIn particular using this to limit build resource permutations for issues like https://github.com/apache/accumulo/issues/1811\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763641119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763651666","html_url":"https://github.com/apache/accumulo/issues/1773#issuecomment-763651666","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1773","id":763651666,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzY1MTY2Ng==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T14:41:20Z","updated_at":"2021-01-20T14:41:20Z","author_association":"CONTRIBUTOR","body":"Since this ticket was mainly for analysis, I will close it as I was unable to find a bug.  I did come up with some ideas for improvements that I opened in #1872 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763651666/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763747735","html_url":"https://github.com/apache/accumulo/pull/1871#issuecomment-763747735","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1871","id":763747735,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzc0NzczNQ==","user":{"login":"karthick-rn","id":7976585,"node_id":"MDQ6VXNlcjc5NzY1ODU=","avatar_url":"https://avatars.githubusercontent.com/u/7976585?v=4","gravatar_id":"","url":"https://api.github.com/users/karthick-rn","html_url":"https://github.com/karthick-rn","followers_url":"https://api.github.com/users/karthick-rn/followers","following_url":"https://api.github.com/users/karthick-rn/following{/other_user}","gists_url":"https://api.github.com/users/karthick-rn/gists{/gist_id}","starred_url":"https://api.github.com/users/karthick-rn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karthick-rn/subscriptions","organizations_url":"https://api.github.com/users/karthick-rn/orgs","repos_url":"https://api.github.com/users/karthick-rn/repos","events_url":"https://api.github.com/users/karthick-rn/events{/privacy}","received_events_url":"https://api.github.com/users/karthick-rn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T16:18:26Z","updated_at":"2021-01-20T16:18:26Z","author_association":"CONTRIBUTOR","body":"The change looks good. I have also tested this PR against Muchos(requires few changes) & verified the rename to \"Manager\" has successfully taken effect. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763747735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763897239","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-763897239","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":763897239,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzg5NzIzOQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T20:00:49Z","updated_at":"2021-01-20T20:00:49Z","author_association":"CONTRIBUTOR","body":"The motivation for this enhancement came from the work around for #1773, when Deletes are taking too long on a cluster with lots of activity.  The work around is to offline and then online the table, which will allow the delete to finish. I am not sure exactly why this works but my guess was that it short circuits the delete steps, bypassing the typical transition path tablets take when deleted.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763897239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763920242","html_url":"https://github.com/apache/accumulo/pull/1651#issuecomment-763920242","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1651","id":763920242,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzkyMDI0Mg==","user":{"login":"cradal","id":20303105,"node_id":"MDQ6VXNlcjIwMzAzMTA1","avatar_url":"https://avatars.githubusercontent.com/u/20303105?v=4","gravatar_id":"","url":"https://api.github.com/users/cradal","html_url":"https://github.com/cradal","followers_url":"https://api.github.com/users/cradal/followers","following_url":"https://api.github.com/users/cradal/following{/other_user}","gists_url":"https://api.github.com/users/cradal/gists{/gist_id}","starred_url":"https://api.github.com/users/cradal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cradal/subscriptions","organizations_url":"https://api.github.com/users/cradal/orgs","repos_url":"https://api.github.com/users/cradal/repos","events_url":"https://api.github.com/users/cradal/events{/privacy}","received_events_url":"https://api.github.com/users/cradal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T20:43:53Z","updated_at":"2021-01-20T20:43:53Z","author_association":"CONTRIBUTOR","body":"I would like to finish it up. I just wasn't sure if the changes I last made\nwere okay or not.\n\nOn Wed, Jan 20, 2021, 9:02 AM Mike Miller <notifications@github.com> wrote:\n\n> @cradal <https://github.com/cradal> Do you have plans on finishing this\n> PR? If not, I can get take it over if you'd like. I recently used this code\n> and have at least one place it could be used in #1821\n> <https://github.com/apache/accumulo/pull/1821>\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/accumulo/pull/1651#issuecomment-763625181>, or\n> unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AE242AMLIHC6N7K6OFLBE7LS23O7RANCNFSM4OSYFTZQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763920242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763938722","html_url":"https://github.com/apache/accumulo/issues/1874#issuecomment-763938722","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1874","id":763938722,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzkzODcyMg==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T20:58:15Z","updated_at":"2021-01-20T20:58:15Z","author_association":"CONTRIBUTOR","body":"Relevant code is [here](https://github.com/apache/accumulo/blob/main/core/src/main/java/org/apache/accumulo/core/util/threads/AccumuloUncaughtExceptionHandler.java)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763938722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763971905","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-763971905","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":763971905,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk3MTkwNQ==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T21:50:27Z","updated_at":"2021-01-20T21:50:27Z","author_association":"CONTRIBUTOR","body":"I wonder if delete table unnecessarily waits on tablets that are running compactions.  There are mechanisms in the code to cancel a running compactions, can't remember when its called though.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763971905/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763972338","html_url":"https://github.com/apache/accumulo/issues/1874#issuecomment-763972338","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1874","id":763972338,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk3MjMzOA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T21:51:16Z","updated_at":"2021-01-20T21:51:16Z","author_association":"MEMBER","body":"@dlmarion I'm going to close this issue for a few reasons:\r\n\r\n1. it doesn't represent anything actionable to do, and therefore isn't very good as an issue in our issue tracker,\r\n2. it's not a good idea to assign tasks to others, even just to try to tag them, because ASF is composed of volunteers, and people should be able to opt-in to tasks, rather than have it assigned to them, and\r\n3. tagging a select group of people without asking them a specific question or responding to them is not good practice, even if they've previously expressed interested; it could be seen as spamming those no longer interested in a topic, or could be interpreted as excluding others who might be interested,\r\n\r\nIf you're trying to initiate a discussion, the best place to do that within the Apache Software Foundation is with a discussion thread on a project's dev mailing list. That is the standard, community-inclusive way to create a dialogue in an Apache community, especially if there is large-scale or substantially impactful design decision-making to be done.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763972338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763981604","html_url":"https://github.com/apache/accumulo/pull/1651#issuecomment-763981604","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1651","id":763981604,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk4MTYwNA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T22:08:34Z","updated_at":"2021-01-20T22:08:34Z","author_association":"MEMBER","body":"I attempted to resolve the merge conflicts to help out in getting this PR back into a healthy state. I will leave the rest to @cradal and/or @milleruntime ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763981604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763983046","html_url":"https://github.com/apache/accumulo/issues/1874#issuecomment-763983046","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1874","id":763983046,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk4MzA0Ng==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T22:11:08Z","updated_at":"2021-01-20T22:11:08Z","author_association":"CONTRIBUTOR","body":"@ctubbsii - Should we get rid of the `Question` issue type then?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763983046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763987527","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-763987527","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":763987527,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk4NzUyNw==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T22:18:32Z","updated_at":"2021-01-20T22:18:32Z","author_association":"CONTRIBUTOR","body":"I will see if I can back out the variable name changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763987527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763994728","html_url":"https://github.com/apache/accumulo/issues/1874#issuecomment-763994728","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1874","id":763994728,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk5NDcyOA==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T22:30:32Z","updated_at":"2021-01-20T22:30:32Z","author_association":"MEMBER","body":"> @ctubbsii - Should we get rid of the `Question` issue type then?\r\n\r\nThe Question label is a built-in one that is created by default by GitHub when you enable issues on a GitHub repository. It can be deleted, but I wouldn't, because it is useful to use it when users ask questions on our project issue tracker. We have no control over what issues users might create, so it's useful to have a label so we can use it to distinguish their questions from actionable items. When users do that, we can either answer and close, or we can recommend they contact the mailing list. Either way, it's still useful to have the label, so we can separate them from other issues.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763994728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763997733","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-763997733","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":763997733,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzk5NzczMw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T22:36:02Z","updated_at":"2021-01-20T22:36:02Z","author_association":"MEMBER","body":"> I will see if I can back out the variable name changes.\r\n\r\nIf it's too much trouble, don't worry about it. I was just thinking it might make code review easier. I can always rename them back in my IDE if I want to minimize the diff for my own review satisfaction.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/763997733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764200297","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-764200297","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":764200297,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDIwMDI5Nw==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T03:00:42Z","updated_at":"2021-01-21T03:00:42Z","author_association":"CONTRIBUTOR","body":"> I will see if I can back out the variable name changes.\r\n\r\nThe name changes do add a bit of work to the review for some diffs, but it's ok w/ me to leave them as is.  I like the changes and have become familiar with them.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764200297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764620318","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-764620318","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":764620318,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDYyMDMxOA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T12:48:05Z","updated_at":"2021-01-21T12:48:05Z","author_association":"CONTRIBUTOR","body":"Compactions being the big hang up seems likely because the offline/online FATE code is very similar to the DeleteTable step, which both call `TableManager.transitionTableState()`, changing the state in Zookeeper. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764620318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764699683","html_url":"https://github.com/apache/accumulo/issues/1875#issuecomment-764699683","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1875","id":764699683,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDY5OTY4Mw==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T14:55:46Z","updated_at":"2021-01-21T14:55:46Z","author_association":"CONTRIBUTOR","body":"I will try to reproduce on my end and investigate. Did you do anything special beyond running CI? Was this running against main and with the most recent commit? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764699683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764713231","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-764713231","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":764713231,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDcxMzIzMQ==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T15:15:48Z","updated_at":"2021-01-21T15:15:48Z","author_association":"CONTRIBUTOR","body":"I looked around in the code, in 2.1.0-SNAP there is an attempt to cancel any running compactions. \r\n\r\nhttps://github.com/apache/accumulo/blob/0bfa4251930dc763ffabd9c2ece4b45f36ae6bc9/server/tserver/src/main/java/org/apache/accumulo/tserver/tablet/Tablet.java#L1197\r\n\r\nIn 1.10 there is also some code w/ the intent to cancel compactions.\r\n\r\nhttps://github.com/apache/accumulo/blob/018756754ff0f289a8b30f846af8b7092270318d/server/tserver/src/main/java/org/apache/accumulo/tserver/tablet/Tablet.java#L1365\r\n\r\nWonder if these are working as intended. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764713231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764725087","html_url":"https://github.com/apache/accumulo/issues/1875#issuecomment-764725087","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1875","id":764725087,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDcyNTA4Nw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T15:32:33Z","updated_at":"2021-01-21T15:32:33Z","author_association":"CONTRIBUTOR","body":"Not really, I just added some debugging for what I am working on.  I think the commit it was based off was: bbd87a6693fc5cdbbe947b0821a4f05a18cf905b","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764725087/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764725889","html_url":"https://github.com/apache/accumulo/issues/1875#issuecomment-764725889","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1875","id":764725889,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDcyNTg4OQ==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T15:33:41Z","updated_at":"2021-01-21T15:33:41Z","author_association":"CONTRIBUTOR","body":"Okay, I will see what I come up with. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764725889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764728783","html_url":"https://github.com/apache/accumulo/issues/1875#issuecomment-764728783","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1875","id":764728783,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDcyODc4Mw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T15:37:40Z","updated_at":"2021-01-21T15:37:40Z","author_association":"CONTRIBUTOR","body":"I was trying to reproduce #1775 and did change `tserver.hold.time.max` to 5s.  Although, I was unable to reproduce the monitor error, I did see this error happen twice.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764728783/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764733046","html_url":"https://github.com/apache/accumulo/issues/1875#issuecomment-764733046","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1875","id":764733046,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDczMzA0Ng==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T15:43:48Z","updated_at":"2021-01-21T15:53:50Z","author_association":"CONTRIBUTOR","body":"I get the error now. I wonder if it's tied to the hold time as I wasn't getting it until after I changed that. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764733046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764743070","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-764743070","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":764743070,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDc0MzA3MA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T15:56:44Z","updated_at":"2021-01-21T15:56:44Z","author_association":"CONTRIBUTOR","body":"Looking at where `Tablet.close()` is happening in `UnloadTabletHandler`, there is a chunk of code that could wait, preventing the close from being called:\r\nhttps://github.com/apache/accumulo/blob/bbd87a6693fc5cdbbe947b0821a4f05a18cf905b/server/tserver/src/main/java/org/apache/accumulo/tserver/UnloadTabletHandler.java#L66-L72","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764743070/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764745745","html_url":"https://github.com/apache/accumulo/issues/1791#issuecomment-764745745","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1791","id":764745745,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDc0NTc0NQ==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T16:00:34Z","updated_at":"2021-01-21T16:00:34Z","author_association":"MEMBER","body":"The issue may be caused by this section of code:\r\n```java\r\n      // Wait for all of the tablets to hosted ...\r\n      log.info(\"Waiting on hosting and balance\");\r\n      TabletLocations ds;\r\n      for (ds = TabletLocations.retrieve(ctx, tableName); ds.hostedCount != TABLETS;\r\n          ds = TabletLocations.retrieve(ctx, tableName)) {\r\n        Thread.sleep(1000);\r\n      }\r\n\r\n      // ... and balanced.\r\n      ctx.instanceOperations().waitForBalance();\r\n      do {\r\n        // Give at least another 5 seconds for migrations to finish up\r\n        Thread.sleep(5000);\r\n        ds = TabletLocations.retrieve(ctx, tableName);\r\n      } while (ds.hostedCount != TABLETS);\r\n\r\n      // Pray all of our tservers have at least 1 tablet.\r\n      assertEquals(TSERVERS, ds.hosted.keySet().size());\r\n\r\n      // Kill two tablet servers hosting our tablets. This should put tablets into suspended state,\r\n      // and thus halt balancing.\r\n\r\n      TabletLocations beforeDeathState = ds;\r\n\r\n      serverStopper.eliminateTabletServers(ctx, beforeDeathState, 2);\r\n```\r\nThe problem may be coming from the amount of time that is waited for migrations to finish. In the for loop, the break condition is the same as the do-while loop meaning once the for loop is finished the do-while will only execute once(essentially rendering it useless). This may be an issue since the migrations are only ever given 5 seconds to complete before the pre-suspension state of the tablets are recorded. After this happens, 2 servers are killed which sometimes takes a bit of time. This may be the window of time in which the tablets migrate under the radar.\r\n\r\nI have tried increasing this amount of time and haven't gotten the error since, however this error doesn't happen too often as is so its hard to tell if this is definitely the cause.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764745745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764746811","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-764746811","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":764746811,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDc0NjgxMQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T16:02:09Z","updated_at":"2021-01-21T16:02:09Z","author_association":"CONTRIBUTOR","body":"Would it be possible to have deadlock on `server.openingTablets` if Accumulo is trying to load and unload a tablet at the same time?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764746811/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764756839","html_url":"https://github.com/apache/accumulo/pull/1873#issuecomment-764756839","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1873","id":764756839,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDc1NjgzOQ==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T16:13:08Z","updated_at":"2021-01-21T16:13:08Z","author_association":"MEMBER","body":"@ctubbsii I have incorporated the changes you suggested [here](https://github.com/brianloss/accumulo/pull/1) and also added [Property.MASTER_PREFIX](https://github.com/apache/accumulo/pull/1873/files#diff-6c2d215eebb1a6157a2b7d95f49496834bd91a150c8aedd97cca6b01aedc05cbR254) back in as a deprecated property (with an updated description indicating the deprecation and replacement). Please have another look when you get a chance. Thanks.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764756839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764781419","html_url":"https://github.com/apache/accumulo/issues/1875#issuecomment-764781419","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1875","id":764781419,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDc4MTQxOQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T16:44:04Z","updated_at":"2021-01-21T16:44:04Z","author_association":"CONTRIBUTOR","body":"I looks like it only happens when a compaction is cancelled.  It is because the comparator that is used on the queue will sometimes return a `TraceRunnable` object since these can exist on the queue as well.  The cast in the `removeIf` check needs to mirror what is going on in this method:\r\nhttps://github.com/apache/accumulo/blob/e62ace6a9d37572d95999f5412c6148efbba50b9/server/tserver/src/main/java/org/apache/accumulo/tserver/compactions/CompactionExecutor.java#L128-L138","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764781419/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764783383","html_url":"https://github.com/apache/accumulo/issues/1791#issuecomment-764783383","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1791","id":764783383,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDc4MzM4Mw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T16:46:58Z","updated_at":"2021-01-21T16:46:58Z","author_association":"MEMBER","body":"> In the for loop, the break condition is the same as the do-while loop meaning once the for loop is finished the do-while will only execute once(essentially rendering it useless).\r\n\r\nIt does call `waitForBalance` before entering this second loop, so even though the loop condition is the same, I think the expectation is that `waitForBalance` call could make the condition not true temporarily, hence the second loop. I'm not sure if this 5 seconds is enough time to guarantee that balance has actually started.\r\n\r\n> After this happens, 2 servers are killed which sometimes takes a bit of time. This may be the window of time in which the tablets migrate under the radar.\r\n\r\nHopefully not. Once balancing has settled, there should be little reason for them to migrate.\r\n\r\n> I have tried increasing this amount of time and haven't gotten the error since, however this error doesn't happen too often as is so its hard to tell if this is definitely the cause.\r\n\r\nYou could try shortening the time to see if the error appears more often afterwards. That might help indicate that increasing the time is definitely going to improve the stability of the test and is the correct path forward.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764783383/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764811146","html_url":"https://github.com/apache/accumulo/issues/1791#issuecomment-764811146","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1791","id":764811146,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDgxMTE0Ng==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T17:26:42Z","updated_at":"2021-01-21T17:26:42Z","author_association":"CONTRIBUTOR","body":"@DomGarguilo I agree with your assessments of that IT and I think you are on the right path.  Your analysis led me to look at what the Master is doing in `waitForBalance` and I noticed a TODO in the findbugs warning suppression: \r\nhttps://github.com/apache/accumulo/blob/bbd87a6693fc5cdbbe947b0821a4f05a18cf905b/server/manager/src/main/java/org/apache/accumulo/master/Master.java#L1594-L1608\r\nIt may be worthwhile to take a look at this code.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764811146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764813685","html_url":"https://github.com/apache/accumulo/issues/1875#issuecomment-764813685","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1875","id":764813685,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDgxMzY4NQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T17:30:44Z","updated_at":"2021-01-21T17:30:44Z","author_association":"CONTRIBUTOR","body":"@Manno15 I think I fixed this issue in #1876 but I wouldn't mind for you to give it a test to see if you can see the error again, since you saw it as well.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764813685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764813882","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-764813882","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":764813882,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDgxMzg4Mg==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T17:31:03Z","updated_at":"2021-01-21T17:31:03Z","author_association":"CONTRIBUTOR","body":"> Would it be possible to have deadlock on server.openingTablets if Accumulo is trying to load and unload a tablet at the same time?\r\n\r\nMaybe, if not deadlock it could get stuck there a long time.   Thinking maybe the method could just return if the tablet is currently opening instead of waiting.   Another unload message will be sent later.\r\n\r\nOne approach to this issue is to try to add enough debugging info so that if the issue does happen again, can see where things are gummed up. For example could possibly add some logging to the unload handler.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764813882/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764820443","html_url":"https://github.com/apache/accumulo/issues/1775#issuecomment-764820443","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1775","id":764820443,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDgyMDQ0Mw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T17:42:06Z","updated_at":"2021-01-21T17:42:06Z","author_association":"CONTRIBUTOR","body":"@karthick-rn I would be curious to know if you are still seeing this error on a more recent build of Accumulo snapshot.  I have been running CI on an Uno cluster with modified hold time but have been unable to reproduce this failure.  The commit I built off of was bbd87a6693fc5cdbbe947b0821a4f05a18cf905b","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764820443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764824883","html_url":"https://github.com/apache/accumulo/issues/1875#issuecomment-764824883","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1875","id":764824883,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDgyNDg4Mw==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T17:48:46Z","updated_at":"2021-01-21T17:48:46Z","author_association":"CONTRIBUTOR","body":"I will test and let you know. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764824883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764844081","html_url":"https://github.com/apache/accumulo/pull/1876#issuecomment-764844081","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1876","id":764844081,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg0NDA4MQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:19:59Z","updated_at":"2021-01-21T18:19:59Z","author_association":"CONTRIBUTOR","body":"Great! Thanks @Manno15 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764844081/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764857847","html_url":"https://github.com/apache/accumulo/issues/1775#issuecomment-764857847","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1775","id":764857847,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg1Nzg0Nw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:44:53Z","updated_at":"2021-01-21T18:44:53Z","author_association":"CONTRIBUTOR","body":"Ah whoops... its probably the part `tserverStatus.size() > 1` which I am unable to pass using Uno with 1 tserver:\r\nhttps://github.com/apache/accumulo/blob/80a5d253249359f8863ad1b54126852e958820d4/server/manager/src/main/java/org/apache/accumulo/master/Master.java#L853","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/764857847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765421720","html_url":"https://github.com/apache/accumulo/pull/1871#issuecomment-765421720","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1871","id":765421720,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTQyMTcyMA==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T14:05:54Z","updated_at":"2021-01-22T14:05:54Z","author_association":"CONTRIBUTOR","body":"FYI I am still seeing the thread name `[master.Master] ` in the log display master:\r\n`manager_ip-10-113-12-25.err:2021-01-22T08:58:31,257 [master.Master] WARN : Tablet server ip-10-113-12-25:9997[10000321f5e0007] exceeded maximum hold time: attempting to kill it\r\n`\r\nNot sure if that is something we can change yet or not.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765421720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765430091","html_url":"https://github.com/apache/accumulo/pull/1871#issuecomment-765430091","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1871","id":765430091,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTQzMDA5MQ==","user":{"login":"karthick-rn","id":7976585,"node_id":"MDQ6VXNlcjc5NzY1ODU=","avatar_url":"https://avatars.githubusercontent.com/u/7976585?v=4","gravatar_id":"","url":"https://api.github.com/users/karthick-rn","html_url":"https://github.com/karthick-rn","followers_url":"https://api.github.com/users/karthick-rn/followers","following_url":"https://api.github.com/users/karthick-rn/following{/other_user}","gists_url":"https://api.github.com/users/karthick-rn/gists{/gist_id}","starred_url":"https://api.github.com/users/karthick-rn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karthick-rn/subscriptions","organizations_url":"https://api.github.com/users/karthick-rn/orgs","repos_url":"https://api.github.com/users/karthick-rn/repos","events_url":"https://api.github.com/users/karthick-rn/events{/privacy}","received_events_url":"https://api.github.com/users/karthick-rn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T14:17:21Z","updated_at":"2021-01-22T14:17:21Z","author_association":"CONTRIBUTOR","body":"> FYI I am still seeing the thread name `[master.Master] ` in the log display master:\r\n> `manager_ip-10-113-12-25.err:2021-01-22T08:58:31,257 [master.Master] WARN : Tablet server ip-10-113-12-25:9997[10000321f5e0007] exceeded maximum hold time: attempting to kill it `\r\n> Not sure if that is something we can change yet or not.\r\n\r\nI noticed this, but wasn't sure if the intention was to rename the thread name as well. Good you've brought this up. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765430091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765433118","html_url":"https://github.com/apache/accumulo/pull/1871#issuecomment-765433118","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1871","id":765433118,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTQzMzExOA==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T14:21:10Z","updated_at":"2021-01-22T14:21:10Z","author_association":"MEMBER","body":"I believe #1642 will cover that, since the log message is showing the class name which is currently still org.apache.accumulo.master.Master.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765433118/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765442600","html_url":"https://github.com/apache/accumulo/issues/1775#issuecomment-765442600","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1775","id":765442600,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTQ0MjYwMA==","user":{"login":"karthick-rn","id":7976585,"node_id":"MDQ6VXNlcjc5NzY1ODU=","avatar_url":"https://avatars.githubusercontent.com/u/7976585?v=4","gravatar_id":"","url":"https://api.github.com/users/karthick-rn","html_url":"https://github.com/karthick-rn","followers_url":"https://api.github.com/users/karthick-rn/followers","following_url":"https://api.github.com/users/karthick-rn/following{/other_user}","gists_url":"https://api.github.com/users/karthick-rn/gists{/gist_id}","starred_url":"https://api.github.com/users/karthick-rn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karthick-rn/subscriptions","organizations_url":"https://api.github.com/users/karthick-rn/orgs","repos_url":"https://api.github.com/users/karthick-rn/repos","events_url":"https://api.github.com/users/karthick-rn/events{/privacy}","received_events_url":"https://api.github.com/users/karthick-rn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T14:33:45Z","updated_at":"2021-01-22T14:33:45Z","author_association":"CONTRIBUTOR","body":"> @karthick-rn I would be curious to know if you are still seeing this error on a more recent build of Accumulo snapshot. I have been running CI on an Uno cluster with modified hold time but have been unable to reproduce this failure. The commit I built off of was [bbd87a6](https://github.com/apache/accumulo/commit/bbd87a6693fc5cdbbe947b0821a4f05a18cf905b)\r\n\r\n@milleruntime I can test this on the latest build and let you know. In the past, I was able to repro this issue with '1' tserver. Do you want me to do the same or try with '2' tservers?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765442600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765457455","html_url":"https://github.com/apache/accumulo/issues/1775#issuecomment-765457455","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1775","id":765457455,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTQ1NzQ1NQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T14:52:48Z","updated_at":"2021-01-22T15:22:38Z","author_association":"CONTRIBUTOR","body":"I was finally able to reproduce this error.  I ran CI on Uno with 2 tservers with these properties:\r\n<pre>\r\ntserver.hold.time.max=500ms\r\ntserver.memory.maps.max=5%\r\n</pre>\r\n\r\nIt also helped to increase the flush entries on CI: test.ci.ingest.entries.flush\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765457455/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765494749","html_url":"https://github.com/apache/accumulo/pull/1878#issuecomment-765494749","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1878","id":765494749,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTQ5NDc0OQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T15:42:11Z","updated_at":"2021-01-22T15:42:11Z","author_association":"CONTRIBUTOR","body":"I tested this in Uno and it will now show up as a Dead tserver in the Monitor.  The Master will print an additional warning once it sees this server unexpectedly in the badserver list and before removing it.\r\n<pre>\r\n2021-01-22T10:24:04,492 [master.Master] WARN : Tablet server ip-10-113-12-25:10000[100006d30700006] exceeded maximum hold time: attempting to kill it\r\n..\r\n2021-01-22T10:24:04,608 [master.Master] WARN : Lost servers [ip-10-113-12-25:10000[100006d30700006]]\r\n</pre>","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765494749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765511757","html_url":"https://github.com/apache/accumulo/pull/1878#issuecomment-765511757","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1878","id":765511757,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTUxMTc1Nw==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T16:04:46Z","updated_at":"2021-01-22T16:06:06Z","author_association":"CONTRIBUTOR","body":"On an aside, did you get the error message:\r\n<pre>\r\n2021-01-22T10:59:44,318 [server.TThreadPoolServer] ERROR: Thrift error occurred during processing of message.\r\n</pre>\r\n\r\n This is from the tracer process and is probably just because that server died but I am unsure. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765511757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765513235","html_url":"https://github.com/apache/accumulo/pull/1878#issuecomment-765513235","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1878","id":765513235,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTUxMzIzNQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T16:06:43Z","updated_at":"2021-01-22T16:06:43Z","author_association":"CONTRIBUTOR","body":"> On an aside, did you get the error message:\r\n> \r\n> 2021-01-22T10:59:44,318 [server.TThreadPoolServer] ERROR: Thrift error occurred during processing of message.\r\n> \r\n> This is from the tracer process and is probably just because that server died but I am unsure.\r\n\r\nI did see this in the tracer log.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765513235/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765620827","html_url":"https://github.com/apache/accumulo/pull/1873#issuecomment-765620827","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1873","id":765620827,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTYyMDgyNw==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T18:59:05Z","updated_at":"2021-01-22T18:59:05Z","author_association":"MEMBER","body":"@keith-turner, after some feedback from and discussions with @ctubbsii we ended up changing the approach some. It's a little less general, but there were going to be some problems in dealing setting table-specific and namespace-specific properties that it just didn't seem like were worth it given that we don't have a use case for changing table-specific properties. Can you have another look and make sure you're still ok with the changes?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765620827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765682788","html_url":"https://github.com/apache/accumulo/issues/1642#issuecomment-765682788","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1642","id":765682788,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTY4Mjc4OA==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T21:03:40Z","updated_at":"2021-01-22T21:03:40Z","author_association":"MEMBER","body":"I've been looking into this issue and see at least a couple problematic areas:\r\n1. [org.apache.accumulo.server.master.balancer.TabletBalancer](https://github.com/apache/accumulo/blob/main/server/base/src/main/java/org/apache/accumulo/server/master/balancer/TabletBalancer.java) and its class hierarchy. The balancers are configured using site and/or zookeeper properties. We could handle renaming those properties much like we're doing in #1640. However, users also have implemented custom balancers, and renaming the package would break custom balancers. This is not just because of the package holding TabletBalancer (and the built-in balancers) but because the method signature for `getAssignments` and `balance` also includes thrift classes in the org.apache.accumulo.core.master.thrift package. While none of this falls under the [public API](https://accumulo.apache.org/api/), it would still be disruptive to have 2.1 cause breaking code changes for users. In an offline discussion with @keith-turner, he suggested re-creating the balancers in the [spi package](https://github.com/apache/accumulo/blob/main/core/src/main/java/org/apache/accumulo/core/spi/package-info.java) and ensuring the interfaces use types that are in the public API. I believe the idea is to deprecate all masters and add a new SPI version in 2.1. Then for 3.0, remove all of the deprecated master code.\r\n2. Thrift interfaces in the master package would cause a binary incompatibility for older client code. For example, [TableOperationsImpl](https://github.com/apache/accumulo/blob/main/core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java) contacts [MasterClientService](https://github.com/apache/accumulo/blob/main/core/src/main/thrift/master.thrift#L216). If we rename that service to ManagerClientService, then 2.0 client code would no longer be able to talk to a 2.1 manager. While there's no requirement to support that, I'm wondering if it's better to make some of the changes in 3.0 given that the first bullet point above also means keeping some thrift-generated classes where they are until 3.0.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765682788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765696679","html_url":"https://github.com/apache/accumulo/issues/1642#issuecomment-765696679","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1642","id":765696679,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTY5NjY3OQ==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T21:31:16Z","updated_at":"2021-01-22T21:33:55Z","author_association":"MEMBER","body":"FWIW, 2.0 can't talk to 2.1 anyway, because we've already bumped the wire version in d9ed7b411c9ca686c89870a363ca199042057d2d (EDIT: actually, that might not affect clients; in any case, we definitely don't guarantee wire compatibility with clients across minor releases.)\r\n\r\nI'd be fine waiting until 3.0 to do the package rename, if we want to have the balancer stuff go through a deprecation cycle, as though it were public API. I'd also be fine ripping off the bandage quickly, and relying on the fact that it's not public API and has always been subject to change. In either case, the road block seems to be the lack of a balancer SPI that avoids internal and thrift-specific types.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/765696679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766826825","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-766826825","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":766826825,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NjgyNjgyNQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T13:46:11Z","updated_at":"2021-01-25T13:46:11Z","author_association":"CONTRIBUTOR","body":"I added a log info statement before waiting in the UnloadTabletHandler #1881\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766826825/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766828297","html_url":"https://github.com/apache/accumulo/issues/1880#issuecomment-766828297","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1880","id":766828297,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NjgyODI5Nw==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T13:48:14Z","updated_at":"2021-01-25T13:48:14Z","author_association":"CONTRIBUTOR","body":"This is a sub-task of https://github.com/apache/accumulo/issues/1659","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766828297/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766828727","html_url":"https://github.com/apache/accumulo/issues/1642#issuecomment-766828727","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1642","id":766828727,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NjgyODcyNw==","user":{"login":"brianloss","id":5400335,"node_id":"MDQ6VXNlcjU0MDAzMzU=","avatar_url":"https://avatars.githubusercontent.com/u/5400335?v=4","gravatar_id":"","url":"https://api.github.com/users/brianloss","html_url":"https://github.com/brianloss","followers_url":"https://api.github.com/users/brianloss/followers","following_url":"https://api.github.com/users/brianloss/following{/other_user}","gists_url":"https://api.github.com/users/brianloss/gists{/gist_id}","starred_url":"https://api.github.com/users/brianloss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brianloss/subscriptions","organizations_url":"https://api.github.com/users/brianloss/orgs","repos_url":"https://api.github.com/users/brianloss/repos","events_url":"https://api.github.com/users/brianloss/events{/privacy}","received_events_url":"https://api.github.com/users/brianloss/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T13:48:57Z","updated_at":"2021-01-25T13:48:57Z","author_association":"MEMBER","body":"> I'd be fine waiting until 3.0 to do the package rename, if we want to have the balancer stuff go through a deprecation cycle, as though it were public API.\r\n\r\nDoes it have to be an all or nothing? Would it make sense to rename as much as we can now (everything that doesn't impact the balancers) and then complete the renaming in 3.0? Or, given that an SPI will probably have objects for the tablet server status and migrations that wrap the existing thrift objects, maybe we could do something similar with renamed thrift objects for the existing balancers. That is, leave the existing thrift classes (that are used by balancers) alone and then generate the new ones in the new package for use by the tablet servers and SPI. The master would then copy data from the new thrift objects that are returned by the tservers into old package versions and send those to the old balancer (if in use). That would allow the current balancers to be deprecated but still used. Given that the thrift objects have public fields, we'd have to copy all of the data so there'd be a performance cost, but we'd only have to do that work if the deprecated balancer is in use.\r\n\r\n> In either case, the road block seems to be the lack of a balancer SPI that avoids internal and thrift-specific types.\r\n\r\nAgreed. I added #1880 to separate that work and make it easier to review independent of any changes from this issue.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766828727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766860625","html_url":"https://github.com/apache/accumulo/pull/1881#issuecomment-766860625","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1881","id":766860625,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Njg2MDYyNQ==","user":{"login":"Manno15","id":29436247,"node_id":"MDQ6VXNlcjI5NDM2MjQ3","avatar_url":"https://avatars.githubusercontent.com/u/29436247?v=4","gravatar_id":"","url":"https://api.github.com/users/Manno15","html_url":"https://github.com/Manno15","followers_url":"https://api.github.com/users/Manno15/followers","following_url":"https://api.github.com/users/Manno15/following{/other_user}","gists_url":"https://api.github.com/users/Manno15/gists{/gist_id}","starred_url":"https://api.github.com/users/Manno15/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Manno15/subscriptions","organizations_url":"https://api.github.com/users/Manno15/orgs","repos_url":"https://api.github.com/users/Manno15/repos","events_url":"https://api.github.com/users/Manno15/events{/privacy}","received_events_url":"https://api.github.com/users/Manno15/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T14:38:28Z","updated_at":"2021-01-25T14:38:28Z","author_association":"CONTRIBUTOR","body":"Unsure on why the build keeps failing. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766860625/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766961695","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-766961695","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":766961695,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Njk2MTY5NQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T17:02:57Z","updated_at":"2021-01-25T17:02:57Z","author_association":"CONTRIBUTOR","body":"I did some testing with Uno running MultiTable RW and have yet to see the log statement I added in #1881.  I was able to see the delete FATE `CleanUp` waiting briefly and it was usually for compactions. So I think your theory of waiting for compactions is more likely.\r\n\r\nFrom the master log:\r\n<pre>\r\n2021-01-25 10:16:20,209 [tableOps.CleanUp] DEBUG: Still waiting for table(1k) to be deleted; Target tablet state: UNASSIGNED, Current tablet state: HOSTED, locationState: 1k<;9@(null,localhost:11000[1000072ccc80003],localhost:11000[1000072ccc80003])\r\n</pre>\r\nFrom tserver log:\r\n<pre>\r\n2021-01-25 10:16:19,508 [tablet.MinorCompactor] DEBUG: Begin minor compaction hdfs://localhost:8020/accumulo/tables/1k/default_tablet/F0000265.rf_tmp 1k<;9\r\n2021-01-25 10:16:20,202 [tablet.Tablet] DEBUG: initiateClose(saveState=false queueMinC=false disableWrites=false) 1k<;9\r\n2021-01-25 10:16:20,202 [tablet.Tablet] DEBUG: completeClose(saveState=false completeClose=true) 1k<;9\r\n2021-01-25 10:16:21,375 [tablet.Compactor] DEBUG: Compaction 1k<;9 14,027 read | 14,027 written |  7,889 entries/sec |  1.778 secs |   47,299,377 bytes | 26602574.241 byte/sec\r\n2021-01-25 10:16:21,377 [tablet.Tablet] DEBUG: Logs for memory compacted: 1k<;9 localhost:11000/hdfs://localhost:8020/accumulo/wal/localhost+11000/bbbd0052-911d-4204-990b-ddfef97738bf\r\n2021-01-25 10:16:21,377 [tablet.Tablet] DEBUG: Logs to be destroyed: 1k<;9 localhost:11000/hdfs://localhost:8020/accumulo/wal/localhost+11000/bbbd0052-911d-4204-990b-ddfef97738bf\r\n2021-01-25 10:16:21,386 [tablet.DatafileManager] TABLET_HIST: 1k<;9 MinC [memory] -> hdfs://localhost:8020/accumulo/tables/1k/default_tablet/F0000265.rf\r\n2021-01-25 10:16:21,386 [tablet.DatafileManager] DEBUG: MinC finish lock 0.00 secs 1k<;9\r\n2021-01-25 10:16:21,436 [tablet.Tablet] TABLET_HIST: 1k<;9 closed\r\n2021-01-25 10:16:21,437 [tserver.TabletServer] DEBUG: Unassigning 1k<;9@(null,localhost:11000[1000072ccc80003],null)\r\n2021-01-25 10:16:21,441 [tserver.TabletServer] INFO : unloaded 1k<;9\r\n</pre>\r\n\r\nWhile looking at this code path, I also found another point where it could be waiting and that was for active scans during the `Tablet.close()`. \r\nhttps://github.com/apache/accumulo/blob/9c957ab55f28f10dde1321eb613a9ec3e2fa5322/server/tserver/src/main/java/org/apache/accumulo/tserver/tablet/Tablet.java#L1439-L1446","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/766961695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767014746","html_url":"https://github.com/apache/accumulo/issues/1872#issuecomment-767014746","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1872","id":767014746,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzAxNDc0Ng==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T18:18:30Z","updated_at":"2021-01-25T18:18:30Z","author_association":"CONTRIBUTOR","body":"Instead of messing with the current delete work flow, another idea would be to enhance the delete command for the client.  We could have an option for the client wait for delete to complete.  We could then provide information as to what it is waiting on (scans, compactions, etc). While this wouldn't change any behavior in Accumulo, it would provide feedback directly to the client and allow them to make better decisions. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767014746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767018351","html_url":"https://github.com/apache/accumulo/pull/1881#issuecomment-767018351","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1881","id":767018351,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzAxODM1MQ==","user":{"login":"milleruntime","id":11872539,"node_id":"MDQ6VXNlcjExODcyNTM5","avatar_url":"https://avatars.githubusercontent.com/u/11872539?v=4","gravatar_id":"","url":"https://api.github.com/users/milleruntime","html_url":"https://github.com/milleruntime","followers_url":"https://api.github.com/users/milleruntime/followers","following_url":"https://api.github.com/users/milleruntime/following{/other_user}","gists_url":"https://api.github.com/users/milleruntime/gists{/gist_id}","starred_url":"https://api.github.com/users/milleruntime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/milleruntime/subscriptions","organizations_url":"https://api.github.com/users/milleruntime/orgs","repos_url":"https://api.github.com/users/milleruntime/repos","events_url":"https://api.github.com/users/milleruntime/events{/privacy}","received_events_url":"https://api.github.com/users/milleruntime/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T18:24:37Z","updated_at":"2021-01-25T18:24:37Z","author_association":"CONTRIBUTOR","body":"Seems it was just flaky network issues on some servers.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767018351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767079633","html_url":"https://github.com/apache/accumulo/issues/1642#issuecomment-767079633","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1642","id":767079633,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzA3OTYzMw==","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T20:05:02Z","updated_at":"2021-01-25T20:05:02Z","author_association":"MEMBER","body":"> Does it have to be an all or nothing? Would it make sense to rename as much as we can now (everything that doesn't impact the balancers) and then complete the renaming in 3.0?\r\n\r\nNo, it doesn't have to be all or nothing. It might make sense to rename as much as we can now... the value is that it may highlight more potential breakage points than the balancer so there aren't surprises with the final renames for 3.0. The downside is that it's extra work... and and increased risk of other breakage if we miss something.\r\n\r\n> Or, given that an SPI will probably have objects for the tablet server status and migrations that wrap the existing thrift objects, maybe we could do something similar with renamed thrift objects for the existing balancers. That is, leave the existing thrift classes (that are used by balancers) alone and then generate the new ones in the new package for use by the tablet servers and SPI. The master would then copy data from the new thrift objects that are returned by the tservers into old package versions and send those to the old balancer (if in use). That would allow the current balancers to be deprecated but still used. Given that the thrift objects have public fields, we'd have to copy all of the data so there'd be a performance cost, but we'd only have to do that work if the deprecated balancer is in use.\r\n\r\nI think that's a reasonable solution if we really need to support compatibility with the older non-public balancer API. But, rather than assume we need to support that compatibility, I'd like to take a moment to wonder about the benefits of doing so, and whether the maintenance cost of the migration path is worth it:\r\n\r\nAre users who require custom balancers the kind of users who would be willing to tolerate performance hits? Or, are they the kind of users who would prefer to migrate to the stable SPI, rather than stay on the non-public API? I suspect they are much more likely to be in the latter group. And, if that's true, then it would be extra maintenance and development work to retain compatibility with an internal non-public API that should see very little use.\r\n\r\nIt's probably not much work to support the compatibility, so it's *probably* worth it to stay compatible, but I think it's worth at least asking the question.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767079633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767109627","html_url":"https://github.com/apache/accumulo/issues/1791#issuecomment-767109627","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1791","id":767109627,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzEwOTYyNw==","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T21:01:08Z","updated_at":"2021-01-25T21:01:08Z","author_association":"MEMBER","body":">     * the suspend time elapsed and the tablets are free to migrate before we are able to check (possibly because the tserver took too long to restart or WAL recovery on tablet load is causing the suspend time to elapse before we check the tablet states)\r\nIt seems like the suspend time elapsing could very well be the cause of this issue. I don't think that the time taken for the tserver to restart has bearing on this issue because the inconsistent tablet locations are recorded before tservers are restarted.\r\n>     * the tserver fully recovered and then participated in subsequent migrations\r\nI do not think this can be the case because the tservers are not restarted until after the issue-causing assert occurs. This error happens between the time the pre-death tablet location are noted and the point at which the suspended tablets are gathered, and then their tablets are compared to their pre-suspend location.\r\n>     * we're splitting tablets and creating new migrations (possibly because splits weren't stabilized before killing the tserver)\r\nI'm not sure that this can be the case because the splits happen near the start of the test, then time is allowed for migrations and such to finish. A printout of the tablet locations after balancing consistently shows the 3 servers used in this test with 10 tablets on each which seems balanced.\r\n>     * the balancer is misbehaving, and rebalancing when it isn't supposed to\r\nSeems very likely but I am having trouble looking into this.\r\n>     * they migrated before we killed the tserver, but we didn't record it correctly in the test\r\nThis could be the case but does not seem likely. There is a brief window of time between when the tablet locations are recorded and the tservers are killed however I have tried allowing time before this happens for migrations to finish and it does not seem to increase the reliability of this test.\r\n\r\nHopefully I did not misinterpret any of your points, @ctubbsii. I'm also not sure why the formatting is messed up with quoting the bullets.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767109627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767188215","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-767188215","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":767188215,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzE4ODIxNQ==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-25T23:54:26Z","updated_at":"2021-01-25T23:55:09Z","author_association":"CONTRIBUTOR","body":"@dlmarion I ran an experiment w/ this code locally.  First I made the following change on my local copy, to always force the creation of multiple ephemeral nodes.\r\n\r\n```diff\r\ndiff --git a/core/src/main/java/org/apache/accumulo/fate/zookeeper/ZooLock.java b/core/src/main/java/org/apache/accumulo/fate/zookeeper/ZooLock.java\r\nindex f79ca72c50..1f87ee3c3a 100644\r\n--- a/core/src/main/java/org/apache/accumulo/fate/zookeeper/ZooLock.java\r\n+++ b/core/src/main/java/org/apache/accumulo/fate/zookeeper/ZooLock.java\r\n@@ -370,6 +370,11 @@ public class ZooLock implements Watcher {\r\n       // except that instead of the ephemeral lock node being of the form guid-lock- use lock-guid-.\r\n       // Another deviation from the recipe is that we cleanup any extraneous ephermal nodes that\r\n       // were created.\r\n+\r\n+      for(int i = 0; i < 3; i++) {\r\n+        zooKeeper.putEphemeralSequential(lockPathPrefix, data);\r\n+      }\r\n+\r\n       final String createPath = zooKeeper.putEphemeralSequential(lockPathPrefix, data);\r\n       LOG.trace(\"[{}] Ephemeral node {} created\", this.getZLockPrefix(), createPath);\r\n\r\n```\r\n\r\nThen I started up Accumulo using these changes, enabled trace logging for ZooLock, and restarted the tserver.  After that I saw the following in the tserver logs.\r\n\r\n```\r\n2021-01-25T18:32:35,744 [zookeeper.ZooLock] TRACE: [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] Ephemeral node /accumulo/3cad24a9-53a9-4a6a-a846-ba24c5d747b9/tservers/accumulo:9997/zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000007 created\r\n2021-01-25T18:32:35,754 [zookeeper.ZooLock] TRACE: Children nodes\r\n2021-01-25T18:32:35,754 [zookeeper.ZooLock] TRACE: - zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000004\r\n2021-01-25T18:32:35,754 [zookeeper.ZooLock] TRACE: - zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000005\r\n2021-01-25T18:32:35,754 [zookeeper.ZooLock] TRACE: - zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000006\r\n2021-01-25T18:32:35,754 [zookeeper.ZooLock] TRACE: - zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000007\r\n2021-01-25T18:32:35,755 [zookeeper.ZooLock] TRACE: [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] lowest sequential node found: /accumulo/3cad24a9-53a9-4a6a-a846-ba24c5d747b9/tservers/accumulo:9997/zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000004\r\n2021-01-25T18:32:35,755 [zookeeper.ZooLock] INFO : [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] Zookeeper client missed server response, multiple ephemeral child nodes created at /accumulo/3cad24a9-53a9-4a6a-a846-ba24c5d747b9/tservers/accumulo:9997/zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#\r\n2021-01-25T18:32:35,755 [zookeeper.ZooLock] TRACE: [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] higher sequential node found: zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000005, deleting it\r\n2021-01-25T18:32:35,758 [zookeeper.ZooLock] INFO : [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] Zookeeper client missed server response, multiple ephemeral child nodes created at /accumulo/3cad24a9-53a9-4a6a-a846-ba24c5d747b9/tservers/accumulo:9997/zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#\r\n2021-01-25T18:32:35,758 [zookeeper.ZooLock] TRACE: [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] higher sequential node found: zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000006, deleting it\r\n2021-01-25T18:32:35,760 [zookeeper.ZooLock] INFO : [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] Zookeeper client missed server response, multiple ephemeral child nodes created at /accumulo/3cad24a9-53a9-4a6a-a846-ba24c5d747b9/tservers/accumulo:9997/zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#\r\n2021-01-25T18:32:35,760 [zookeeper.ZooLock] TRACE: [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] higher sequential node found: zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000007, deleting it\r\n2021-01-25T18:32:35,761 [zookeeper.ZooLock] TRACE: [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] Setting watcher on /accumulo/3cad24a9-53a9-4a6a-a846-ba24c5d747b9/tservers/accumulo:9997/zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000004\r\n2021-01-25T18:32:35,764 [zookeeper.ZooLock] TRACE: Children nodes\r\n2021-01-25T18:32:35,764 [zookeeper.ZooLock] TRACE: - zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000004\r\n2021-01-25T18:32:35,764 [zookeeper.ZooLock] TRACE: [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] First candidate is my lock, acquiring\r\n2021-01-25T18:32:35,764 [tserver.TabletServer] DEBUG: Obtained tablet server lock /accumulo/3cad24a9-53a9-4a6a-a846-ba24c5d747b9/tservers/accumulo:9997/zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000004\r\n2021-01-25T18:32:35,768 [zookeeper.ZooLock] TRACE: Children nodes\r\n2021-01-25T18:32:35,768 [zookeeper.ZooLock] TRACE: - zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000004\r\n```\r\n\r\nThen I did the following in zkCli.\r\n\r\n```\r\n[zk: localhost:2181(CONNECTED) 0] addauth digest accumulo:uno\r\n[zk: localhost:2181(CONNECTED) 1] ls /accumulo/\r\n3cad24a9-53a9-4a6a-a846-ba24c5d747b9   instances                              \r\n[zk: localhost:2181(CONNECTED) 1] ls /accumulo/3cad24a9-53a9-4a6a-a846-ba24c5d747b9/tservers/accumulo:9997 \r\n[zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000004]\r\n[zk: localhost:2181(CONNECTED) 2] delete /accumulo/3cad24a9-53a9-4a6a-a846-ba24c5d747b9/tservers/accumulo:9997/zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000004\r\n```\r\n\r\nAfter that I saw the following in the tserver logs and confirmed the tserver was not running.\r\n\r\n```\r\n2021-01-25T18:37:43,487 [zookeeper.ZooLock] TRACE: [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#0000000004 was deleted\r\n2021-01-25T18:37:43,489 [tserver.TabletServer] ERROR: Lost tablet server lock (reason = LOCK_DELETED), exiting.\r\n```\r\n\r\nEverything worked great.  After running this experiment I am thinking the log messages related to creating the lock that are trace could be debug.  Locks are not created often, locks are really important, and the information could be useful for debugging. Also I noticed the following log message was emitted multiple times.\r\n\r\n```\r\nINFO : [zlock#93852053-1721-4f2a-a8fe-ee4b9398389e#] Zookeeper client missed server response, multiple ephemeral child nodes created at /accumulo/3cad24a9-53a9-4a6a-a846-\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767188215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767193103","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-767193103","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":767193103,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzE5MzEwMw==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-26T00:07:59Z","updated_at":"2021-01-26T00:07:59Z","author_association":"CONTRIBUTOR","body":"@keith-turner That's great. I can certainly change the log level. I'll also see what I can do to suppress the multiple server response missed log messages. I'm curious why in the tserver log that the ephemeral sequential sequence number started at 4. Is it because the tserver was already running at that address before you stopped it and changed the log level? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767193103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767193472","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-767193472","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":767193472,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzE5MzQ3Mg==","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-26T00:09:03Z","updated_at":"2021-01-26T00:09:43Z","author_association":"CONTRIBUTOR","body":"> Is it because the tserver was already running at that address before you stopped it and changed the log level?\r\n\r\nYes","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767193472/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767194001","html_url":"https://github.com/apache/accumulo/pull/1866#issuecomment-767194001","issue_url":"https://api.github.com/repos/apache/accumulo/issues/1866","id":767194001,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzE5NDAwMQ==","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-26T00:10:34Z","updated_at":"2021-01-26T00:10:34Z","author_association":"CONTRIBUTOR","body":"Are you able to start 2 masters?\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/767194001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]