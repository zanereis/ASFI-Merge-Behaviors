[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770291719","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-770291719","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":770291719,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDI5MTcxOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-30T22:40:52Z","updated_at":"2021-01-30T22:40:52Z","author_association":"CONTRIBUTOR","body":"> Do we want to add a last-assigned-schema-id to table metadata?\r\n\r\nMy initial thought was no because the schema IDs are completely local to a metadata file. We can reassign all IDs from one file to the next and as long as they are internally consistent we are okay. The IDs are not embedded in separate files that might get improperly used.\r\n\r\nBut, the Nessie comment you pointed to is a good one to think about. I think it is still okay because Nessie merges would either be fast-forward, or would re-apply changes and create entirely new metadata files. So the internal consistency argument still holds.\r\n\r\n> Do we want to assign special schema IDs to metadata tables, to avoid potential collision on schema IDs?\r\n\r\nI don't think so.\r\n\r\n> Do we want to add snapshot-id to only history entries, or Snapshot interface?\r\n\r\nI would add it to Snapshot, not just History. Snapshot is what will be used for time travel queries. I would avoid adding too much metadata to history.\r\n\r\n> I think currently when replacing a table, earlier history entries/snapshotLog will be reset to empty (second to last argument in here). Is this expected? do we want to fix this as a separate issue?\r\n\r\nI think we should follow up and keep the history. I think the reason for this is because we previously didn't have any compatibility across schemas (IDs were completely reassigned, so time travel would be incorrect). But that's fixed now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770291719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770327766","html_url":"https://github.com/apache/iceberg/pull/2110#issuecomment-770327766","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2110","id":770327766,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDMyNzc2Ng==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-31T05:10:36Z","updated_at":"2021-01-31T05:10:36Z","author_association":"CONTRIBUTOR","body":"> Great to see this! I think you will need to specify version for calcite-core as well since it is excluded from hive-exec.\r\n> \r\n> Note Hive 2.3.8 still uses Avro 1.8.2, although it should be compatible with Avro 1.10.\r\n\r\nSeems like calcite-druid is only required during `iceberg-mr` testing [calcite-core is already include in test scope]. Instead of adding at compileOnly, I think we should only add calcite druid as a test dep under `iceberg-mr` only","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770327766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770344943","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-770344943","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":770344943,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDM0NDk0Mw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-31T08:15:28Z","updated_at":"2021-01-31T08:15:28Z","author_association":"CONTRIBUTOR","body":"Thanks everybody for the reviews so far. I know it's not a tiny PR so I really appreciate it.\r\n\r\nI will update everything that's been mentioned. ðŸ‘ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770344943/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770348101","html_url":"https://github.com/apache/iceberg/pull/2187#issuecomment-770348101","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2187","id":770348101,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDM0ODEwMQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-31T08:45:58Z","updated_at":"2021-01-31T08:45:58Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770348101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770437552","html_url":"https://github.com/apache/iceberg/pull/2110#issuecomment-770437552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2110","id":770437552,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDQzNzU1Mg==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-31T19:34:47Z","updated_at":"2021-01-31T19:34:47Z","author_association":"CONTRIBUTOR","body":"@sunchao Can you shed some light on why calcite has been removed as a dependency from Hive? I haven't been involved in this discussion.\r\n\r\n@rdsr Good catch, I've moved them to `testCompile`.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770437552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770437945","html_url":"https://github.com/apache/iceberg/pull/2084#issuecomment-770437945","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2084","id":770437945,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDQzNzk0NQ==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-31T19:37:12Z","updated_at":"2021-01-31T19:37:12Z","author_association":"CONTRIBUTOR","body":"Awesome, sure thing. Pulled in latest master, and resolved the conflicts!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770437945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770440648","html_url":"https://github.com/apache/iceberg/pull/2110#issuecomment-770440648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2110","id":770440648,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDQ0MDY0OA==","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-31T19:55:21Z","updated_at":"2021-01-31T19:55:21Z","author_association":"MEMBER","body":"@Fokko it was removed as part of shading Guava- see [HIVE-22126](https://issues.apache.org/jira/browse/HIVE-22126) and [HIVE-23980](https://issues.apache.org/jira/browse/HIVE-23980).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770440648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770500766","html_url":"https://github.com/apache/iceberg/pull/2092#issuecomment-770500766","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2092","id":770500766,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDUwMDc2Ng==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T01:26:42Z","updated_at":"2021-02-01T01:26:42Z","author_association":"CONTRIBUTOR","body":"hi @rdblueThanks again, I have updating it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770500766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770560002","html_url":"https://github.com/apache/iceberg/pull/2189#issuecomment-770560002","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2189","id":770560002,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDU2MDAwMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T04:45:33Z","updated_at":"2021-02-01T04:45:33Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @dilipbiswal ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770560002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770592453","html_url":"https://github.com/apache/iceberg/issues/1078#issuecomment-770592453","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1078","id":770592453,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDU5MjQ1Mw==","user":{"login":"medb","id":3035518,"node_id":"MDQ6VXNlcjMwMzU1MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3035518?v=4","gravatar_id":"","url":"https://api.github.com/users/medb","html_url":"https://github.com/medb","followers_url":"https://api.github.com/users/medb/followers","following_url":"https://api.github.com/users/medb/following{/other_user}","gists_url":"https://api.github.com/users/medb/gists{/gist_id}","starred_url":"https://api.github.com/users/medb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/medb/subscriptions","organizations_url":"https://api.github.com/users/medb/orgs","repos_url":"https://api.github.com/users/medb/repos","events_url":"https://api.github.com/users/medb/events{/privacy}","received_events_url":"https://api.github.com/users/medb/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T05:57:54Z","updated_at":"2021-02-01T05:58:11Z","author_association":"NONE","body":"@asheeshgarg Did you resolve this issue? Maybe you just need to increase number of records that are written in each Parquet file? (if slowness come from the fact that persisting sparse data in Parquet produces many small files)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770592453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770595519","html_url":"https://github.com/apache/iceberg/pull/2189#issuecomment-770595519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2189","id":770595519,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDU5NTUxOQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T06:05:09Z","updated_at":"2021-02-01T06:05:09Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi Looks reasonable to me !!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770595519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770616220","html_url":"https://github.com/apache/iceberg/pull/2171#issuecomment-770616220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2171","id":770616220,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDYxNjIyMA==","user":{"login":"qphien","id":17759741,"node_id":"MDQ6VXNlcjE3NzU5NzQx","avatar_url":"https://avatars.githubusercontent.com/u/17759741?v=4","gravatar_id":"","url":"https://api.github.com/users/qphien","html_url":"https://github.com/qphien","followers_url":"https://api.github.com/users/qphien/followers","following_url":"https://api.github.com/users/qphien/following{/other_user}","gists_url":"https://api.github.com/users/qphien/gists{/gist_id}","starred_url":"https://api.github.com/users/qphien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qphien/subscriptions","organizations_url":"https://api.github.com/users/qphien/orgs","repos_url":"https://api.github.com/users/qphien/repos","events_url":"https://api.github.com/users/qphien/events{/privacy}","received_events_url":"https://api.github.com/users/qphien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T06:49:21Z","updated_at":"2021-02-01T06:49:21Z","author_association":"CONTRIBUTOR","body":"Close the PR. TEZ-4248 is a better way to solve the problem. The problem about vectorization on mr will be discussed in https://github.com/apache/iceberg/issues/2120.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770616220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770687222","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-770687222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":770687222,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDY4NzIyMg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T08:52:17Z","updated_at":"2021-02-01T08:52:17Z","author_association":"CONTRIBUTOR","body":"> @pvary, could you elaborate a bit more? I am not sure I got it.\r\n\r\nBy my understanding the relevant change in #1875 is [this](https://github.com/apache/iceberg/commit/6731211eaf746c6a4abfe71386ef53172a3fc137#diff-e3082ef0c407c6d7644f453cd24a426eedc21fcdcb1fc501beeffb07b3070135L141-R138):\r\n```\r\n-      HiveCatalog hiveCatalog = HiveCatalogs.loadCatalog(conf);\r\n-      TableIdentifier tableIdentifier = TableIdentifier.parse(path.get());\r\n-      return hiveCatalog.loadTable(tableIdentifier);\r\n+      return CustomCatalogs.table(lazySparkSession(), path.get());\r\n```\r\n\r\nAm I right when assuming that this change replaces `HiveCatalogs.loadCatalog(conf)` with `CatalogUtil.buildIcebergCatalog(name, options, conf)`, which ultimately calls `CatalogUtil.loadCatalog(catalogImpl, name, options, conf)`?\r\n\r\nOne important difference between the 2 methods is that `HiveCatalogs.loadCatalog(conf)` comes with a `CATALOG_CACHE`, so if you call loadCatalog with the same thrift uri then we reuse the previously created HiveCatalog instance. This is good as this reuses the HiveClientPool instance in that catalog, and also could be problematic since if there is any difference in the configuration then it will not be applied to the new pool. OTOH `CatalogUtil` always creates a new HiveCatalog instance and with it a HiveClientPool instance.\r\n\r\nMy assumption was that the tests are creating multiple Catalog instances or they are not closing the Catalog instances correctly and this is the problem which causes the exhaustion of the Metastore thread pool.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770687222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770747783","html_url":"https://github.com/apache/iceberg/pull/2163#issuecomment-770747783","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2163","id":770747783,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDc0Nzc4Mw==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T10:23:47Z","updated_at":"2021-02-01T10:23:47Z","author_association":"COLLABORATOR","body":"@pvary @lcspinter could you please review when you get the chance? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770747783/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770791526","html_url":"https://github.com/apache/iceberg/pull/2163#issuecomment-770791526","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2163","id":770791526,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDc5MTUyNg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T11:36:04Z","updated_at":"2021-02-01T11:36:04Z","author_association":"CONTRIBUTOR","body":"+1 from my side, but I would like to see @rdblue's opinion about pushing code which we can not create tests for.\r\n\r\n@rdblue: A bit of context: Internally we were able to run write tests with Tez, but there are multiple unreleased fixes needed for Hive and Tez too. The fixes are available on the apache repos but they are not present on any of the releases ATM. Releasing both components would be a slow process because of the dependencies, and would greatly delay adding code here. Shall we wait for those releases or we can put code here which could only be used by patched versions of Hive and Tez?\r\n\r\nThanks,\r\nPeter\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770791526/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770826956","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-770826956","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":770826956,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDgyNjk1Ng==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T12:39:41Z","updated_at":"2021-02-01T12:39:41Z","author_association":"MEMBER","body":"@stevenzwu , one more thing:  we will need to enable this unit test  https://github.com/apache/iceberg/blob/e58eba1fdd95c94b964e5b97322e73060d29d38a/flink/src/test/java/org/apache/iceberg/flink/TestFlinkCatalogTable.java#L129 after we upgrade to flink 1.12. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770826956/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770835035","html_url":"https://github.com/apache/iceberg/issues/2033#issuecomment-770835035","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2033","id":770835035,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDgzNTAzNQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T12:53:14Z","updated_at":"2021-02-01T12:53:14Z","author_association":"MEMBER","body":"Thanks @elkhand for your patient debugging, it's really impressive,  your suggested workflow looks great before we resolve this bug in flink.  and thanks @kezhuw for reporting this bug to apache flink.   I think this issue exposes a problem with the current integration of flink and iceberg:  we did not have unit tests to address the flink savepoint issue,  so I  opened an issue to address this : https://github.com/apache/iceberg/issues/2190. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770835035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770873937","html_url":"https://github.com/apache/iceberg/pull/2121#issuecomment-770873937","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2121","id":770873937,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDg3MzkzNw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T13:55:15Z","updated_at":"2021-02-01T13:55:15Z","author_association":"CONTRIBUTOR","body":"@rdblue: Could you please take a look at this PR? Only adds a single test case which failed for tez writes. Nothing fancy, but good to have a test case for MR as well.\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770873937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770879090","html_url":"https://github.com/apache/iceberg/issues/1927#issuecomment-770879090","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1927","id":770879090,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDg3OTA5MA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T14:02:42Z","updated_at":"2021-02-01T14:02:42Z","author_association":"CONTRIBUTOR","body":"@lcspinter: Could we close this?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770879090/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770879192","html_url":"https://github.com/apache/iceberg/issues/1926#issuecomment-770879192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1926","id":770879192,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDg3OTE5Mg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T14:02:52Z","updated_at":"2021-02-01T14:02:52Z","author_association":"CONTRIBUTOR","body":"@lcspinter: Could we close this?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770879192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770879287","html_url":"https://github.com/apache/iceberg/issues/1925#issuecomment-770879287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1925","id":770879287,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDg3OTI4Nw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T14:03:01Z","updated_at":"2021-02-01T14:03:01Z","author_association":"CONTRIBUTOR","body":"@lcspinter: Could we close this?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770879287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770880667","html_url":"https://github.com/apache/iceberg/issues/1923#issuecomment-770880667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1923","id":770880667,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDg4MDY2Nw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T14:04:51Z","updated_at":"2021-02-01T14:04:51Z","author_association":"CONTRIBUTOR","body":"@lcspinter checked the possibilities and the `ObjectInspectors` are in the mr module and the schema conversion is in the hive-metastore module. If we want to keep them separated there is no easy way to merge the logic. We can skip this task in the hopes that the supported data types are fairly constant","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770880667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770882167","html_url":"https://github.com/apache/iceberg/issues/1921#issuecomment-770882167","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1921","id":770882167,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDg4MjE2Nw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T14:06:53Z","updated_at":"2021-02-01T14:06:53Z","author_association":"CONTRIBUTOR","body":"Fixed by @lcspinter  in #2086","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770882167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770882579","html_url":"https://github.com/apache/iceberg/pull/2077#issuecomment-770882579","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2077","id":770882579,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDg4MjU3OQ==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T14:07:29Z","updated_at":"2021-02-01T14:07:29Z","author_association":"CONTRIBUTOR","body":"fixes #1925  #1926  #1927 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770882579/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770886069","html_url":"https://github.com/apache/iceberg/issues/1155#issuecomment-770886069","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1155","id":770886069,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDg4NjA2OQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T14:12:18Z","updated_at":"2021-02-01T14:12:18Z","author_association":"CONTRIBUTOR","body":"I think we can close this issue, as the catalog configuration is already there.\r\nWhat do you think @rdsr?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770886069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770887073","html_url":"https://github.com/apache/iceberg/issues/798#issuecomment-770887073","issue_url":"https://api.github.com/repos/apache/iceberg/issues/798","id":770887073,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDg4NzA3Mw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T14:13:45Z","updated_at":"2021-02-01T14:13:45Z","author_association":"CONTRIBUTOR","body":"@figo10203: Could we close this issue as abandoned? Or is this problem still exists?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/770887073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771004466","html_url":"https://github.com/apache/iceberg/issues/1155#issuecomment-771004466","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1155","id":771004466,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTAwNDQ2Ng==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T17:01:03Z","updated_at":"2021-02-01T17:01:03Z","author_association":"CONTRIBUTOR","body":"I think so too, I haven't been following the code changes, but I do see in the `hive.md` that we can use `HiveCatalog`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771004466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771034458","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-771034458","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":771034458,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTAzNDQ1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T17:46:55Z","updated_at":"2021-02-01T17:46:55Z","author_association":"CONTRIBUTOR","body":"I don't think that's the relevant change. The delete tests use a registered catalog through SQL and don't use the `IcebergSource`. The problem was a different pool size because of the way the catalog is now constructed.\r\n\r\nAlso, `CustomCatalogs` has its own catalog cache so that catalogs are not loaded more than once by name.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771034458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771040413","html_url":"https://github.com/apache/iceberg/pull/2084#issuecomment-771040413","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2084","id":771040413,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTA0MDQxMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T17:56:50Z","updated_at":"2021-02-01T17:56:50Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi FYI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771040413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771040520","html_url":"https://github.com/apache/iceberg/pull/2084#issuecomment-771040520","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2084","id":771040520,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTA0MDUyMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T17:57:00Z","updated_at":"2021-02-01T17:57:00Z","author_association":"CONTRIBUTOR","body":"Thanks for the update, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771040520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771045379","html_url":"https://github.com/apache/iceberg/pull/2187#issuecomment-771045379","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2187","id":771045379,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTA0NTM3OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T18:04:19Z","updated_at":"2021-02-01T18:04:19Z","author_association":"CONTRIBUTOR","body":"Looks good to me. Any other comments, @aokolnychyi?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771045379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771070700","html_url":"https://github.com/apache/iceberg/pull/2188#issuecomment-771070700","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2188","id":771070700,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTA3MDcwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T18:40:44Z","updated_at":"2021-02-01T18:40:44Z","author_association":"CONTRIBUTOR","body":"@jun-he, can you roll back the field and and method name changes in other classes? I think we only need to change the table metadata property, not the others.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771070700/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771071959","html_url":"https://github.com/apache/iceberg/pull/2110#issuecomment-771071959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2110","id":771071959,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTA3MTk1OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T18:42:57Z","updated_at":"2021-02-01T18:42:57Z","author_association":"CONTRIBUTOR","body":"Looks good. Thanks for catching the test issue, @rdsr!\r\n\r\nThanks for the update, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771071959/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771092618","html_url":"https://github.com/apache/iceberg/pull/2188#issuecomment-771092618","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2188","id":771092618,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTA5MjYxOA==","user":{"login":"jun-he","id":12246263,"node_id":"MDQ6VXNlcjEyMjQ2MjYz","avatar_url":"https://avatars.githubusercontent.com/u/12246263?v=4","gravatar_id":"","url":"https://api.github.com/users/jun-he","html_url":"https://github.com/jun-he","followers_url":"https://api.github.com/users/jun-he/followers","following_url":"https://api.github.com/users/jun-he/following{/other_user}","gists_url":"https://api.github.com/users/jun-he/gists{/gist_id}","starred_url":"https://api.github.com/users/jun-he/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jun-he/subscriptions","organizations_url":"https://api.github.com/users/jun-he/orgs","repos_url":"https://api.github.com/users/jun-he/repos","events_url":"https://api.github.com/users/jun-he/events{/privacy}","received_events_url":"https://api.github.com/users/jun-he/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T19:15:45Z","updated_at":"2021-02-01T19:15:45Z","author_association":"COLLABORATOR","body":"@rdblue Thanks for the review and updated the PR accordingly.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771092618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771098371","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-771098371","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":771098371,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTA5ODM3MQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T19:25:34Z","updated_at":"2021-02-01T19:25:34Z","author_association":"CONTRIBUTOR","body":"> I don't think that's the relevant change. The delete tests use a registered catalog through SQL and don't use the `IcebergSource`. The problem was a different pool size because of the way the catalog is now constructed.\r\n\r\nYeah, you are right. The `IcebergSource` is not used there.\r\n\r\nThe key change in the cache still might be relevant in tests/uses where `IcebergSource` is used, but definitely not here.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771098371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771149668","html_url":"https://github.com/apache/iceberg/pull/2188#issuecomment-771149668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2188","id":771149668,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTE0OTY2OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T20:52:08Z","updated_at":"2021-02-01T20:52:08Z","author_association":"CONTRIBUTOR","body":"Thanks, @jun-he! Looks good.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771149668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771190634","html_url":"https://github.com/apache/iceberg/pull/2121#issuecomment-771190634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2121","id":771190634,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTE5MDYzNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T22:04:10Z","updated_at":"2021-02-01T22:04:10Z","author_association":"CONTRIBUTOR","body":"Overall, this looks fine. One minor question about why it creates an extra list. Otherwise +1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771190634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771196216","html_url":"https://github.com/apache/iceberg/pull/2189#issuecomment-771196216","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2189","id":771196216,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTE5NjIxNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T22:14:06Z","updated_at":"2021-02-01T22:14:06Z","author_association":"CONTRIBUTOR","body":"Looks good overall. I'd prefer to restructure the left anti join cases, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771196216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771199874","html_url":"https://github.com/apache/iceberg/pull/2163#issuecomment-771199874","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2163","id":771199874,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTE5OTg3NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T22:20:39Z","updated_at":"2021-02-01T22:20:39Z","author_association":"CONTRIBUTOR","body":"@pvary, @marton-bod, as long as we are passing the existing tests, I think it is fine to add code that will be more thoroughly tested later. Better to get it in sooner.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771199874/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771203997","html_url":"https://github.com/apache/iceberg/pull/1648#issuecomment-771203997","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1648","id":771203997,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTIwMzk5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T22:27:30Z","updated_at":"2021-02-01T22:27:30Z","author_association":"CONTRIBUTOR","body":"@Fokko, could you rebase this? Now that the Jackson update is in, I think we can work on it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771203997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771215176","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-771215176","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":771215176,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTIxNTE3Ng==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-01T22:51:46Z","updated_at":"2021-02-01T22:51:46Z","author_association":"CONTRIBUTOR","body":"@openinx I enabled `TestFlinkCatalogTable#testCreateTableIfNotExists()` test. I have to make two adjustments. In particular, I have to remove `WITH ('location'='/tmp/location')\"` from the SQL in 2nd create. Otherwise, HadoopCatalog fails the validation. Also, for this test purpose, it is probably not important for the 2nd create to set a new location.\r\n\r\n```\r\nTest testCreateTableIfNotExists[catalogName = testhadoop baseNamespace = ](org.apache.iceberg.flink.TestFlinkCatalogTable) failed with:\r\norg.apache.flink.table.api.TableException: Could not execute CreateTable in path `testhadoop`.`db`.`tl`\r\n  at org.apache.flink.table.catalog.CatalogManager.execute(CatalogManager.java:796)\r\n  at org.apache.flink.table.catalog.CatalogManager.createTable(CatalogManager.java:632)\r\n  at org.apache.flink.table.api.internal.TableEnvironmentImpl.executeOperation(TableEnvironmentImpl.java:776)\r\n  at org.apache.flink.table.api.internal.TableEnvironmentImpl.executeSql(TableEnvironmentImpl.java:666)\r\n  at org.apache.iceberg.flink.FlinkTestBase.exec(FlinkTestBase.java:103)\r\n  at org.apache.iceberg.flink.FlinkTestBase.exec(FlinkTestBase.java:107)\r\n  at org.apache.iceberg.flink.FlinkTestBase.sql(FlinkTestBase.java:111)\r\n  at org.apache.iceberg.flink.TestFlinkCatalogTable.testCreateTableIfNotExists(TestFlinkCatalogTable.java:139)\r\n  ...\r\n Caused by: java.lang.IllegalArgumentException: Cannot set a custom location for a path-based table. Expected file:///var/folders/4d/3shff9g95pz81jmgrcn74zl00000gn/T/junit5877951167101792089/db/tl but got /tmp/location\r\n  at org.apache.iceberg.relocated.com.google.common.base.Preconditions.checkArgument(Preconditions.java:142)\r\n  at org.apache.iceberg.hadoop.HadoopCatalog$HadoopCatalogTableBuilder.withLocation(HadoopCatalog.java:441)\r\n  at org.apache.iceberg.CachingCatalog$CachingTableBuilder.withLocation(CachingCatalog.java:191)\r\n  at org.apache.iceberg.CachingCatalog.createTable(CachingCatalog.java:104)\r\n  at org.apache.iceberg.flink.FlinkCatalog.createTable(FlinkCatalog.java:377)\r\n  at org.apache.flink.table.catalog.CatalogManager.lambda$createTable$10(CatalogManager.java:633)\r\n  at org.apache.flink.table.catalog.CatalogManager.execute(CatalogManager.java:790)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771215176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771296624","html_url":"https://github.com/apache/iceberg/issues/2172#issuecomment-771296624","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2172","id":771296624,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTI5NjYyNA==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T02:13:44Z","updated_at":"2021-02-02T02:13:44Z","author_association":"CONTRIBUTOR","body":"@openinx just a follow up question. I ingested the data using the datastream Flink CDC api. I then used the FlinkSink in Iceberg to write to the Iceberg table. However, I can't seem to figure out this behaviour.\r\n\r\nThe application reads all the rows in the source db, but then doesn't write to the Iceberg table until I cancel the job (it's as if the data gets committed and shows up in S3 once I cancel the job). I checked if there was any backpressure in the job and there was none.\r\n\r\nFrom reading into the IcebergFilesCommitter, it seems that Iceberg writes the files on checkpoints ? (please correct me if I'm wrong, I didn't go through the entire implementation). I then enabled checkpoints at an interval of 30seconds and still same result. Will FlinkSink wait until it reaches the 128Mb default parquet files size in Iceberg before it writes out the file ?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771296624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771320010","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-771320010","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":771320010,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTMyMDAxMA==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T03:10:34Z","updated_at":"2021-02-02T03:10:34Z","author_association":"CONTRIBUTOR","body":"> > Do we want to add a last-assigned-schema-id to table metadata?\r\n> \r\n> My initial thought was no because the schema IDs are completely local to a metadata file. We can reassign all IDs from one file to the next and as long as they are internally consistent we are okay. The IDs are not embedded in separate files that might get improperly used.\r\n> \r\n> But, the Nessie comment you pointed to is a good one to think about. I think it is still okay because Nessie merges would either be fast-forward, or would re-apply changes and create entirely new metadata files. So the internal consistency argument still holds.\r\n> \r\n> > Do we want to assign special schema IDs to metadata tables, to avoid potential collision on schema IDs?\r\n> \r\n> I don't think so.\r\n> \r\n> > Do we want to add snapshot-id to only history entries, or Snapshot interface?\r\n> \r\n> I would add it to Snapshot, not just History. Snapshot is what will be used for time travel queries. I would avoid adding too much metadata to history.\r\n> \r\n> > I think currently when replacing a table, earlier history entries/snapshotLog will be reset to empty (second to last argument in here). Is this expected? do we want to fix this as a separate issue?\r\n> \r\n> I think we should follow up and keep the history. I think the reason for this is because we previously didn't have any compatibility across schemas (IDs were completely reassigned, so time travel would be incorrect). But that's fixed now.\r\n\r\nThank you for the review and the input! I'll create a separate issue to mention the history problem and link here. Do you have any suggestion on if we want to add schema id to the history table? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771320010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771324860","html_url":"https://github.com/apache/iceberg/issues/2172#issuecomment-771324860","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2172","id":771324860,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTMyNDg2MA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T03:22:13Z","updated_at":"2021-02-02T03:22:13Z","author_association":"MEMBER","body":"Yes, the flink sink will commit those files for every checkpoint interval actually. If you can not see the newly committed data files in S3,  then I guess it should have some problems.   Did you recover the flink job from a savepoint ?  There's a bug that will cause the similar issue, you might want to read the issue: https://github.com/apache/iceberg/issues/2033#issue-779721770, and the current solution (before release the next flink) is here: https://github.com/apache/iceberg/issues/2033#issuecomment-769952948 \r\n\r\nIf not the case, do you have some logs that could help to dig into this problem?   Java stacktrace ?  Thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771324860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771342449","html_url":"https://github.com/apache/iceberg/pull/2193#issuecomment-771342449","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2193","id":771342449,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTM0MjQ0OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T04:09:10Z","updated_at":"2021-02-02T04:09:22Z","author_association":"CONTRIBUTOR","body":"cc @dilipbiswal @rdblue @RussellSpitzer @mehtaashish23 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771342449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771361950","html_url":"https://github.com/apache/iceberg/pull/2189#issuecomment-771361950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2189","id":771361950,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTM2MTk1MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T04:59:24Z","updated_at":"2021-02-02T06:35:45Z","author_association":"CONTRIBUTOR","body":"I can ignore `MethodLengthChecker` just in the apply method instead of removing the rule but I am not sure that rule is useful. Spark, for example, does not enforce it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771361950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771363814","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-771363814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":771363814,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTM2MzgxNA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T05:04:29Z","updated_at":"2021-02-02T05:04:29Z","author_association":"CONTRIBUTOR","body":"@openinx I addressed your last round of comments. Thanks a lot for the great feedbacks.\r\n\r\nthx for [catch the case](https://github.com/apache/iceberg/pull/1956#discussion_r568279087) about still using `TableColumn.physical`. I have fixed it. I also did a search and found no more usage.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771363814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771377523","html_url":"https://github.com/apache/iceberg/issues/2172#issuecomment-771377523","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2172","id":771377523,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTM3NzUyMw==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T05:40:08Z","updated_at":"2021-02-02T05:40:08Z","author_association":"CONTRIBUTOR","body":"@openinx Sorry, it was just an issue with how I implemented a custom debezium deserializer (wrong RowKind for some rows). After I fixed that everything works fine. \r\n\r\nCould maybe help me understand this scenario. Lets say in the source db we only get like 10 rows inserted in the last 1 hour and we set our Flink checkpoint interval to 1 hr. Will FlinkSink just just commit a new parquet file with these 10 rows ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771377523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771435975","html_url":"https://github.com/apache/iceberg/pull/1648#issuecomment-771435975","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1648","id":771435975,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTQzNTk3NQ==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T07:41:16Z","updated_at":"2021-02-02T07:41:16Z","author_association":"CONTRIBUTOR","body":"@rdblue Sure thing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771435975/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771448892","html_url":"https://github.com/apache/iceberg/pull/2047#issuecomment-771448892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2047","id":771448892,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTQ0ODg5Mg==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T08:06:26Z","updated_at":"2021-02-02T08:06:26Z","author_association":"MEMBER","body":"@stevenzwu ,   You mean this PR will be the next one for reviewing which was separated from this big one (https://github.com/apache/iceberg/pull/2105) ?   For my understanding, this is just an unit tests refactor and we could pull request the next feature PR for reviewing,  could just just improve the unit tests when iterating the unified flink source work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771448892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771495594","html_url":"https://github.com/apache/iceberg/pull/2193#issuecomment-771495594","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2193","id":771495594,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTQ5NTU5NA==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T09:25:51Z","updated_at":"2021-02-02T09:25:51Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi Looks good to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771495594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771579446","html_url":"https://github.com/apache/iceberg/pull/2182#issuecomment-771579446","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2182","id":771579446,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTU3OTQ0Ng==","user":{"login":"PiyushHurpadeDremio","id":71250524,"node_id":"MDQ6VXNlcjcxMjUwNTI0","avatar_url":"https://avatars.githubusercontent.com/u/71250524?v=4","gravatar_id":"","url":"https://api.github.com/users/PiyushHurpadeDremio","html_url":"https://github.com/PiyushHurpadeDremio","followers_url":"https://api.github.com/users/PiyushHurpadeDremio/followers","following_url":"https://api.github.com/users/PiyushHurpadeDremio/following{/other_user}","gists_url":"https://api.github.com/users/PiyushHurpadeDremio/gists{/gist_id}","starred_url":"https://api.github.com/users/PiyushHurpadeDremio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PiyushHurpadeDremio/subscriptions","organizations_url":"https://api.github.com/users/PiyushHurpadeDremio/orgs","repos_url":"https://api.github.com/users/PiyushHurpadeDremio/repos","events_url":"https://api.github.com/users/PiyushHurpadeDremio/events{/privacy}","received_events_url":"https://api.github.com/users/PiyushHurpadeDremio/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T11:45:44Z","updated_at":"2021-02-02T11:45:44Z","author_association":"NONE","body":"@rdblue  Can you please review this PR. This PR is implementation of issue [#1833 ](https://github.com/apache/iceberg/issues/1833). Briefly, this PR implements support for partition stats. In each snapshot we will have partition stats file for each partition spec. If no partition stats are updated for partition spec in new snapshot, we will point it to older partition stats file for that partition_stats_file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771579446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771605789","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-771605789","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":771605789,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTYwNTc4OQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T12:36:44Z","updated_at":"2021-02-02T12:36:44Z","author_association":"CONTRIBUTOR","body":"\r\n> That said, I think we should fix `HiveCatalog` constructor that just accepts a Hadoop conf. \r\n\r\nagreed, will take a look at that\r\n\r\n> Also, I would remove the constructor from `HiveClientPool` that does not accept the pool size (it is package private and only used in one place I am suggesting to update). \r\n\r\nalso agreed","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771605789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771611181","html_url":"https://github.com/apache/iceberg/pull/2180#issuecomment-771611181","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2180","id":771611181,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTYxMTE4MQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T12:46:59Z","updated_at":"2021-02-02T12:46:59Z","author_association":"CONTRIBUTOR","body":"Maybe this question is for a new issue but: What do people think about the `HiveCatalog` lifecycle in general? It has been bothering me after I ran into an issue where `HiveCatalog` was being GC-ed, hence closing the `HiveClientPool` and breaking some cached `HiveTableOperations`. I've looked into a more formal resource ownership model but it breaks a lot of unit tests as the lifetime of `HiveCatalog` isn't consistent across tests. If it is valuable to standardise the lifetime of a `HiveCatalog` in a unit test and define the lifetime in a typical user application we can discuss and I post a patch. Thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771611181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771636006","html_url":"https://github.com/apache/iceberg/issues/2198#issuecomment-771636006","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2198","id":771636006,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTYzNjAwNg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T13:31:34Z","updated_at":"2021-02-02T13:31:34Z","author_association":"CONTRIBUTOR","body":"@dixingxing0: I have tried this in the unit tests where the customers table is an iceberg table and have 3 rows:\r\n```\r\nCREATE TABLE c2 (customer_id bigint, first_name string, last_name string);\r\n\r\nselect count(1),count(a.customer_id),count(b.customer_id)\r\nfrom (select customer_id, concat_ws(first_name, last_name) as str from default.customers where customer_id>0) a\r\nfull outer join (select customer_id, concat_ws(first_name, last_name) as str from default.c2 where customer_id>0) b\r\non a.str=b.str \r\nwhere a.str is null or b.str is null;\r\n```\r\n\r\nThe queries were successfully executed on my env (Hive 2.3.7/3.1.2, Iceberg master branch)\r\n\r\nTo repro the case there are several things that would be really helpful:\r\n- `SHOW CREATE TABLE` output for both source tables\r\n- Could you please check if the `empty` file actually in the `hive_table1` directory?\r\n- Could you provide some test data for the iceberg_table?\r\n- Could you please try to simplify the query?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771636006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771672435","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-771672435","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":771672435,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTY3MjQzNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T14:28:28Z","updated_at":"2021-02-02T14:28:28Z","author_association":"MEMBER","body":"That does seem pretty dangerous although I haven't seen this happen before.\n\nDo you have the snapshot summary for the compaction operation? It should\nhopefully also provide some hints as to what is going on\nIt would also be great if you had a programmatic reproduction of the issue.\n\nOn Tue, Feb 2, 2021 at 12:38 AM Stephen-Robin <notifications@github.com>\nwrote:\n\n> There is a high probability of data loss after compaction through some\n> rewrite data files test. After compacting a table ,some rows will be lost.\n>\n> The reproduction process is as follows:\n>\n>    1.\n>\n>    create a new iceberg table\n>    create table test (id int, age int) using iceberg;\n>    2.\n>\n>    Write initial data, Keep writing data until the generated file size is\n>    more than 10M(splitTargetSize), Which is 11M in this example\n>    insert into test values (1,2),(3,4);\n>    insert into test select * from test;\n>    [image: image]\n>    <https://user-images.githubusercontent.com/77377842/106560840-a424af00-6562-11eb-840e-321d8e926396.png>\n>    3.\n>\n>    count the number of rows in the table: select count(*) from table\n>    [image: image]\n>    <https://user-images.githubusercontent.com/77377842/106560909-c74f5e80-6562-11eb-8d84-9346864aa9d4.png>\n>    4.\n>\n>    execute compaction\n>    The compaction params like splitTargetSize are 10M and other\n>    parameters such as splitOpenFileCost(4M) are default values.\n>    Actions.forTable(table).rewriteDataFiles.targetSizeInBytes(10 * 10 *\n>    1024).execute()\n>    5.\n>\n>    count the number of rows in the table: select count(*) from table\n>\n> [image: image]\n> <https://user-images.githubusercontent.com/77377842/106560966-dcc48880-6562-11eb-8135-09d5b74a2483.png>\n>\n> Actually, The origin 11M file has been split into a 10M file A and a 1M\n> file B after bin pack. However the CombinedScanTask with only one\n> FileScanTask will be filtered out.\n> When RewriteFiles.commit() is executed finally, because the 1M file B\n> exists, the 11M manifest corresponding files will be deleted (status set 2).\n> Regardless of whether the remaining 1M file B was successfully written, we\n> lost the 10M file A.\n>\n> The result shows that the number of rows was exactly half missing, because\n> the 11M parquet file was missing in this example, and the remaining 1M file\n> B did not rewrite the new data file because the origin Parquet row group\n> split point was not found.\n>\n> In my opinion, the Iceberg RewriteFile operation not only combines small\n> files, but also needs to split large files.\n> Flink may need to deal with more small file merging cases, in addition to\n> small file merging, Spark also need to consider as much as possible the\n> reasonable segmentation of large files. In either case, it is necessary to\n> ensure the reliability of the data\n>\n> Please anyone confirm if this is a problem, If there is a problem, I have\n> tried to fix and submit a pr right away.\n>\n> Thanks\n>\n> â€”\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/2195>, or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YIJBMUL45MCVHPGZQLS46MVBANCNFSM4W6CJNSA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771672435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771698156","html_url":"https://github.com/apache/iceberg/pull/2129#issuecomment-771698156","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2129","id":771698156,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTY5ODE1Ng==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T15:04:23Z","updated_at":"2021-02-02T15:05:24Z","author_association":"CONTRIBUTOR","body":"@rdblue I followed your recommendations with a few minor changes.\r\n\r\nThis is how it works now:\r\n- If the table has an `iceberg.catalog=<catalog_name>` property then use all the properties prefixed with `iceberg.catalog.<catalog_name>` from the hive global config for catalog instantiation. There is one exception, when `iceberg.catalog=location_based_table`. In this case, no catalog is needed, since we are loading the table based on location.\r\n- If the table is missing `iceberg.catalog`, fall back to `iceberg.mr.catalog` like you recommended\r\n\r\nPreviously we supported the so-called \"custom\" catalogs, and these type of catalogs were instantiated through a catalog loader class (`iceberg.mr.catalog.loader.class`).  The catalog loader class collected all the relevant properties which are important for that specific catalog type and instantiated the catalog. \r\nRight now I'm using CatalogUtil.buildIcebergCatalog() to get a catalog instance. This method expects the mandatory catalog specific properties. In order to assemble this collection, I would need to know what properties are required, but since we are talking about a custom catalog, basically this can be anything. In the end, I decided the remove the support of custom catalog configuration through the `iceberg.mr.catalog.loader.class` property.\r\nOf course, it is still possible to configure custom catalogs, but only through the `iceberg.catalog` table property. This way I know that all the catalog specific parameters are prefixed, and I can pass them to the CatalogUtil.buildIcebergCatalog().\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771698156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771712074","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-771712074","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":771712074,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTcxMjA3NA==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T15:23:46Z","updated_at":"2021-02-02T15:24:51Z","author_association":"CONTRIBUTOR","body":"> That does seem pretty dangerous although I haven't seen this happen before. Do you have the snapshot summary for the compaction operation? It should hopefully also provide some hints as to what is going on It would also be great if you had a programmatic reproduction of the issue.\r\n> [â€¦](#)\r\n\r\n\r\n@RussellSpitzer Thanks for your reply.I have described how to reproduce in the issue.Â \r\n\r\nFirst create a new iceberg table, and insert initial values.Â The compactionÂ params like splitTargetSize are 10M and other parameters such as splitOpenFileCost(4M) are default values.\r\nThen insert data continuously through `insert into table select * from table`, until the size of the most recently generated parquet file is more than 10M, which is 11M in this example.Â \r\nFinally, call the BaseRewriteDataFilesAction rewriteDataFiles interface to execute compaction.\r\nThe main problem is the code marked in this red box\r\n \r\n![image](https://user-images.githubusercontent.com/77377842/106620728-cfcc8700-65ac-11eb-8533-c8ec1e14d999.png)\r\n\r\nThe main purpose is to filter out the CombinedScanTask that only has one scanTask. For example, a file size is 8M, and the default value of the open file cost is 4M. After bin pack, the 8M files are in a package. The line code is to filter out. In this case, redundant writing is avoided, but files that exceed the split target size will have problems in the issue.\r\nI have tried to fix the problem and can view itÂ https://github.com/apache/iceberg/pull/2196/commits.\r\nIf you need some data during my test, I will provide it at any time\r\n\r\nThanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771712074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771713658","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-771713658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":771713658,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTcxMzY1OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T15:26:04Z","updated_at":"2021-02-02T15:26:04Z","author_association":"MEMBER","body":"I'm not sure how the above line would cause data loss, it looks like it just there to determine which files to be re-written. You are correct it will not split files, but I'm not sure why they would be dropped. \r\n\r\nThe results are used here correct?\r\n\r\nhttps://github.com/apache/iceberg/blob/f5d11c6d1bac88d71f91957655b50c7021900c48/core/src/main/java/org/apache/iceberg/actions/BaseRewriteDataFilesAction.java#L242\r\n\r\n\r\nhttps://github.com/apache/iceberg/blob/f5d11c6d1bac88d71f91957655b50c7021900c48/core/src/main/java/org/apache/iceberg/actions/BaseRewriteDataFilesAction.java#L261-L274\r\n\r\nTo determine which files must be deleted and what they will be replaced with, a file exceeding the threshold should be ignored by the rewrite? This should result in the file just being untouched, it should be removed from the table I think ...\r\n\r\nI'll see if I can write up a quick repo\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771713658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771725145","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-771725145","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":771725145,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTcyNTE0NQ==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T15:41:07Z","updated_at":"2021-02-02T16:01:39Z","author_association":"CONTRIBUTOR","body":"> I'm not sure how the above line would cause data loss, it looks like it just there to determine which files to be re-written. You are correct it will not split files, but I'm not sure why they would be dropped.\r\n\r\n@RussellSpitzer  Thanks for your reply.\r\nWhen we have a 'large file' that size is larger than 'targetSizeInBytes'. Some part of this 'large file' that occupy whole bin pack will not be rewrite. But the whole 'large file' will be deleted because it is in the currentDataFiles.\r\n\r\nUsing the example mentioned in the issue, file part A (10M) is not in currentFile,  file part B (1M) is in currentFile, but file A (10M) is not in addedFile.But after commit, the manifest status corresponding to the initial 11M file will be set to deleted\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771725145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771779923","html_url":"https://github.com/apache/iceberg/pull/2047#issuecomment-771779923","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2047","id":771779923,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTc3OTkyMw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T16:49:09Z","updated_at":"2021-02-02T22:46:29Z","author_association":"CONTRIBUTOR","body":"@openinx yes, please help review this unit test refactoring next. The main reason is to avoid constant needs of resolving merge conflicts after periodical rebasing. Other FLIP-27 source code and tests are more isolated and less likely to get merge conflicts during the probably long review process.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771779923/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771781055","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-771781055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":771781055,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTc4MTA1NQ==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T16:50:30Z","updated_at":"2021-02-02T17:05:23Z","author_association":"CONTRIBUTOR","body":"> That does seem pretty dangerous although I haven't seen this happen before. Do you have the snapshot summary for the compaction operation? It should hopefully also provide some hints as to what is going on It would also be great if you had a programmatic reproduction of the issue.\r\n\r\n@RussellSpitzer Thanks for your reply\r\nI just ran my previous experiment again and  will introduce my reproduction process in detail below.\r\nCreating tables and inserting data have been mentioned above, Then \r\n![image](https://user-images.githubusercontent.com/77377842/106631262-8cc3e100-65b7-11eb-87a8-dc99ac4fb786.png)\r\n![image](https://user-images.githubusercontent.com/77377842/106631285-92212b80-65b7-11eb-9b42-0cf61d83a827.png)\r\n\r\ndata files as follows\r\n![image](https://user-images.githubusercontent.com/77377842/106633145-7880e380-65b9-11eb-8b87-57b154be15ce.png)\r\n\r\nThen execute compaction:\r\n![image](https://user-images.githubusercontent.com/77377842/106631412-b7ae3500-65b7-11eb-9eb0-514ff8a065d2.png)\r\n\r\nDuring the execution, I debugged.\r\n![image](https://user-images.githubusercontent.com/77377842/106632069-533fa580-65b8-11eb-8539-feac7d78f7df.png)\r\n\r\nThe variable `combinedScanTasks` includes the divided small file part B (1407488 bytes), but there is no part A (10M) file.\r\n![image](https://user-images.githubusercontent.com/77377842/106632142-6488b200-65b8-11eb-838f-1ff9d8b81a6a.png)\r\nThe Variable `currentDataFiles` includes an initial file of 11MB in size. \r\nThe file of 11MB will be deleted during commit, but the 10M file B has not been rewritten.\r\nThen snapshot file concerned as follows:\r\n![image](https://user-images.githubusercontent.com/77377842/106635461-d1517b80-65bb-11eb-8356-99dfcb2c47ba.png)\r\n\r\n![image](https://user-images.githubusercontent.com/77377842/106635316-a8c98180-65bb-11eb-9d17-696729a6200b.png)\r\n\r\n![image](https://user-images.githubusercontent.com/77377842/106632492-c5b08580-65b8-11eb-9b2b-e0d414f83a38.png)\r\n\r\nshow the rows of table\r\n![image](https://user-images.githubusercontent.com/77377842/106632545-d660fb80-65b8-11eb-81da-864e66f508a5.png)\r\n![image](https://user-images.githubusercontent.com/77377842/106632610-e973cb80-65b8-11eb-9441-a566041c5c67.png)\r\nWe can find that the 11MB data file has been lost\r\n\r\ndata files as follows:\r\n![image](https://user-images.githubusercontent.com/77377842/106632989-4cfdf900-65b9-11eb-8213-21f534f997d8.png)\r\nThe red box is the new rewritten data\r\n\r\n\r\nI think the problem described in my issue may exist.\r\nLooking forward to your reply\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771781055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771811055","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-771811055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":771811055,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTgxMTA1NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T17:20:58Z","updated_at":"2021-02-02T17:26:03Z","author_association":"MEMBER","body":"I wrote a programmatic repo which fits into TestRewriteDataFilesAction, (although I would like to shrink the test file size). Oddly this is not deterministic, It does not fail every time ...\r\n\r\n```java\r\n  @Test\r\n  public void testRewriteDataFilesLargeFile() {\r\n    PartitionSpec spec = PartitionSpec.unpartitioned();\r\n    Map<String, String> options = Maps.newHashMap();\r\n    Table table = TABLES.create(SCHEMA, spec, options, tableLocation);\r\n\r\n    Assert.assertNull(\"Table must be empty\", table.currentSnapshot());\r\n\r\n    List<ThreeColumnRecord> records1 = Lists.newArrayList();\r\n\r\n    IntStream.range(0, 2000000).forEach(i -> records1.add(new ThreeColumnRecord(i, \"foo\" + i, \"bar\" + i)));\r\n    Dataset<Row> df = spark.createDataFrame(records1, ThreeColumnRecord.class).repartition(1);\r\n    writeDF(df);\r\n\r\n    List<ThreeColumnRecord> records2 = Lists.newArrayList(\r\n        new ThreeColumnRecord(2, \"CCCCCCCCCC\", \"CCCC\"),\r\n        new ThreeColumnRecord(2, \"DDDDDDDDDD\", \"DDDD\")\r\n    );\r\n    writeRecords(records2);\r\n\r\n    table.refresh();\r\n\r\n    Actions actions = Actions.forTable(table);\r\n\r\n    long originalNumRecords = spark.read().format(\"iceberg\").load(tableLocation).count();\r\n\r\n    table.updateProperties().set(TableProperties.SPLIT_SIZE, String.valueOf(1024 * 1024 * 10));\r\n    table.refresh();\r\n\r\n    actions.rewriteDataFiles()\r\n        .targetSizeInBytes(1024 * 1024 * 10)\r\n        .execute();\r\n\r\n    long postRewriteNumRecords = spark.read().format(\"iceberg\").load(tableLocation).count();\r\n\r\n    Assert.assertEquals(originalNumRecords, postRewriteNumRecords);\r\n  }\r\n  ```\r\n  This code occasionally drops all of the records from the first write.\r\n  \r\n  ```\r\n  java.lang.AssertionError: expected:<2000002> but was:<2>\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/413025/106638385-6d8e6a80-6549-11eb-9fff-2fc15421a428.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771811055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771824024","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-771824024","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":771824024,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTgyNDAyNA==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T17:35:09Z","updated_at":"2021-02-02T17:37:59Z","author_association":"CONTRIBUTOR","body":"> I wrote a programmatic repo which fits into TestRewriteDataFilesAction, (although I would like to shrink the test file size). Oddly this is not deterministic, It does not fail every time ...\r\n> \r\n@RussellSpitzer  Thank you for writing the test code to reproduce.\r\nDuring my test, I did not modify TableProperties.SPLIT_SIZE. The default value was used, but the splitTargetSize was set to 10M during compaction.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771824024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771828530","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-771828530","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":771828530,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTgyODUzMA==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T17:40:36Z","updated_at":"2021-02-02T17:59:28Z","author_association":"CONTRIBUTOR","body":"> I wrote a programmatic repo which fits into TestRewriteDataFilesAction, (although I would like to shrink the test file size). Oddly this is not deterministic, It does not fail every time ...\r\n> \r\n@RussellSpitzer I think you have reproduced the problem I mentioned, and the cause of the problem has been explained above. for further confirmation, I think you may insert a breakpoint at line 232 of the BaseRewriteDataFilesAction file to see if the file written for the first time is filtered out, similar to the screenshot above.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771828530/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771883039","html_url":"https://github.com/apache/iceberg/pull/2193#issuecomment-771883039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2193","id":771883039,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTg4MzAzOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T18:46:42Z","updated_at":"2021-02-02T18:46:42Z","author_association":"CONTRIBUTOR","body":"The PR is ready for another round.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771883039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771885951","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-771885951","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":771885951,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTg4NTk1MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T18:50:18Z","updated_at":"2021-02-02T18:50:18Z","author_association":"CONTRIBUTOR","body":"@openinx and @stevenzwu, what is the compatibility impact of this change? Does master no longer work with 1.11?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771885951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771885958","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-771885958","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":771885958,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTg4NTk1OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T18:50:19Z","updated_at":"2021-02-02T18:50:19Z","author_association":"MEMBER","body":"I tried a slightly different fix were we just check in the filter command whether there is more than 1 file OR if there is a single file but it is a partial scan, Scan Length < File sizeInBytes and that seems to work as well without building up the fileName set which may be an issue with very large numbers of files.\r\n\r\n```java\r\nprivate boolean isPartialFileScan(CombinedScanTask task) {\r\n    if (task.files().size() == 1) {\r\n      FileScanTask fileScanTask = task.files().iterator().next();\r\n      boolean test = (fileScanTask.file().fileSizeInBytes() - fileScanTask.length()) != 0;\r\n      return test;\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n```\r\n\r\n```\r\n        .filter(task -> task.files().size() > 1 || isPartialFileScan(task)) // Either we are combining multiple files or we have broken a file into smaller pieces\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771885958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771889183","html_url":"https://github.com/apache/iceberg/pull/2187#issuecomment-771889183","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2187","id":771889183,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTg4OTE4Mw==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T18:54:31Z","updated_at":"2021-02-02T18:54:31Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi Could we get this in if you are okay ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771889183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771899750","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-771899750","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":771899750,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTg5OTc1MA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T19:08:03Z","updated_at":"2021-02-02T19:08:03Z","author_association":"CONTRIBUTOR","body":"@rdblue that is correct. master won't work with Flink 1.11 anymore. \r\n\r\nThe main reason is that the new FLIP-27 Flink source implementation will depend APIs only available from Flink 1.12. there were some discussions on how to make Flink connector works with both Flink 1.11 and 1.12 like adopting the gradle magic from Beam. In the end, it seems that most people are fine with having master only working with Flink 1.12.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771899750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771938772","html_url":"https://github.com/apache/iceberg/pull/2189#issuecomment-771938772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2189","id":771938772,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTkzODc3Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T20:01:28Z","updated_at":"2021-02-02T20:01:28Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @rdblue @dilipbiswal @mehtaashish23!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771938772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771946663","html_url":"https://github.com/apache/iceberg/pull/2193#issuecomment-771946663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2193","id":771946663,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTk0NjY2Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T20:12:17Z","updated_at":"2021-02-02T20:12:17Z","author_association":"CONTRIBUTOR","body":"I see no major blockers with this. There are a few things to consider, but overall I think this can go in and we can improve it from there.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771946663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771982107","html_url":"https://github.com/apache/iceberg/pull/2187#issuecomment-771982107","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2187","id":771982107,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTk4MjEwNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T21:00:40Z","updated_at":"2021-02-02T21:00:40Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771982107/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771982116","html_url":"https://github.com/apache/iceberg/pull/2187#issuecomment-771982116","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2187","id":771982116,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTk4MjExNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T21:00:41Z","updated_at":"2021-02-02T21:00:41Z","author_association":"CONTRIBUTOR","body":"I just talked with Anton and he said we're good to go.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771982116/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771983200","html_url":"https://github.com/apache/iceberg/pull/2199#issuecomment-771983200","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2199","id":771983200,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTk4MzIwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T21:01:43Z","updated_at":"2021-02-02T21:01:43Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, can you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771983200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771998471","html_url":"https://github.com/apache/iceberg/pull/2187#issuecomment-771998471","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2187","id":771998471,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MTk5ODQ3MQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T21:24:12Z","updated_at":"2021-02-02T21:24:12Z","author_association":"CONTRIBUTOR","body":"Thank you very much @rdblue @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/771998471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772044013","html_url":"https://github.com/apache/iceberg/pull/2182#issuecomment-772044013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2182","id":772044013,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjA0NDAxMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T22:17:03Z","updated_at":"2021-02-02T22:17:03Z","author_association":"CONTRIBUTOR","body":"Thanks for pinging me, @PiyushHurpadeDremio. Looks like the next step is to agree on a design for tracking partition stats?\r\n\r\nI see from the description that this is adding a file to each snapshot that has an entry per partition tuple that has file and record counts. Do you think that this is going to be sufficient for other partition stats as well? What is the underlying use case you're trying to solve with number of files and number of rows?\r\n\r\nWould it also make sense to add partition-level stats like column lower/upper bounds, value counts, null counts, and NaN counts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772044013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772052442","html_url":"https://github.com/apache/iceberg/pull/2182#issuecomment-772052442","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2182","id":772052442,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjA1MjQ0Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T22:27:40Z","updated_at":"2021-02-02T22:27:40Z","author_association":"CONTRIBUTOR","body":"I also think that we need to have a concrete plan for how these files are created and updated.\r\n\r\nThe number of partitions in a table could easily be a few million. That's quite a bit to write each time a snapshot is produced, since these files are immutable. And because these would be maintained by applying the changes from one to the next (rather than scanning all of the metadata) the cost would be to read an entire file and write an entire file. That's quite a bit of extra work that I don't think we want to require for each write to a table.\r\n\r\nI think we would want to add a way to track a file and the snapshot for which it was produced, so that we can figure out what changed since and update it asynchronously.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772052442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772093130","html_url":"https://github.com/apache/iceberg/pull/2159#issuecomment-772093130","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2159","id":772093130,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjA5MzEzMA==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T23:44:39Z","updated_at":"2021-02-02T23:44:39Z","author_association":"CONTRIBUTOR","body":"@jackye1995 can you take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772093130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772096804","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772096804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772096804,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjA5NjgwNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-02T23:54:13Z","updated_at":"2021-02-02T23:54:13Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, can you take a look at this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772096804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772102052","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-772102052","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":772102052,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjEwMjA1Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T00:06:18Z","updated_at":"2021-02-03T00:06:18Z","author_association":"CONTRIBUTOR","body":"> Do you have any suggestion on if we want to add schema id to the history table?\r\n\r\nI don't think that we want to add it to history. The snapshot log should refer to snapshots by ID and we can get the schema easily enough from there. For the actual metadata table, we don't want to expose schema ID because that's something that users should ideally never need to know much about. We've avoided adding IDs in other similar situations. For example, you can rewrite manifests for a specific partition spec, by ID. But we didn't include that in the stored procedure because we haven't exposed the partition spec ID anywhere to SQL users.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772102052/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772103041","html_url":"https://github.com/apache/iceberg/pull/2121#issuecomment-772103041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2121","id":772103041,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjEwMzA0MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T00:08:33Z","updated_at":"2021-02-03T00:08:33Z","author_association":"CONTRIBUTOR","body":"Thanks, @pvary!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772103041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772104841","html_url":"https://github.com/apache/iceberg/pull/2150#issuecomment-772104841","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2150","id":772104841,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjEwNDg0MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T00:12:50Z","updated_at":"2021-02-03T00:12:50Z","author_association":"CONTRIBUTOR","body":"Thanks, @marton-bod! And thanks for reviewing, @pvary!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772104841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772121417","html_url":"https://github.com/apache/iceberg/pull/1872#issuecomment-772121417","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1872","id":772121417,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjEyMTQxNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T00:52:01Z","updated_at":"2021-02-03T00:52:01Z","author_association":"CONTRIBUTOR","body":"@yyanyy, looks mostly good. I think we should be a little bit more careful in the evaluator, but otherwise there's nothing other than minor changes needed. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772121417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772128148","html_url":"https://github.com/apache/iceberg/pull/1820#issuecomment-772128148","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1820","id":772128148,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjEyODE0OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T01:04:47Z","updated_at":"2021-02-03T01:04:47Z","author_association":"CONTRIBUTOR","body":"Looks great, thanks @yyanyy!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772128148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772129492","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772129492","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772129492,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjEyOTQ5Mg==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T01:08:11Z","updated_at":"2021-02-03T01:08:11Z","author_association":"CONTRIBUTOR","body":"I am sorry, this is a known bug,I had found the bug  when I did the Rewrite Action,and I had open a PR #1762 , just not merged ,the purpose of this rewrite Action is to compaction small files, so I think it is more reasonable to exclude data files which size > the target size during table scan.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772129492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772138414","html_url":"https://github.com/apache/iceberg/pull/1790#issuecomment-772138414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1790","id":772138414,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjEzODQxNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T01:29:51Z","updated_at":"2021-02-03T01:29:51Z","author_association":"CONTRIBUTOR","body":"Looks good now. Thanks for the latest update, I think it is a bit cleaner now that it doesn't pass the type description.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772138414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772145893","html_url":"https://github.com/apache/iceberg/pull/1975#issuecomment-772145893","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1975","id":772145893,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjE0NTg5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T01:47:07Z","updated_at":"2021-02-03T01:47:07Z","author_association":"CONTRIBUTOR","body":"Looks great, thanks @yyanyy!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772145893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772146944","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772146944","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772146944,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjE0Njk0NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T01:49:27Z","updated_at":"2021-02-03T01:49:27Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01, next time please highlight that there is a correctness problem. I didn't know that #1762 fixed a correctness problem or we would have prioritized it and made sure it was in the 0.11.0 release. Thanks for pointing us to that issue, we will take a look at both alternative solutions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772146944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772152173","html_url":"https://github.com/apache/iceberg/pull/1946#issuecomment-772152173","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1946","id":772152173,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjE1MjE3Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T02:01:24Z","updated_at":"2021-02-03T02:01:24Z","author_association":"CONTRIBUTOR","body":"Thanks, @yyanyy! This looks good now so I merged it. That should unblock the next steps.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772152173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772152597","html_url":"https://github.com/apache/iceberg/pull/1963#issuecomment-772152597","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1963","id":772152597,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjE1MjU5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T02:02:09Z","updated_at":"2021-02-03T02:02:09Z","author_association":"CONTRIBUTOR","body":"@yyanyy, can you rebase this? I think merging #1946 caused conflicts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772152597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772160296","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772160296","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772160296,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjE2MDI5Ng==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T02:19:38Z","updated_at":"2021-02-03T02:25:48Z","author_association":"CONTRIBUTOR","body":"> I am sorry, this is a known bug,I had found the bug when I did the Rewrite Action,and I had open a PR #1762 , just not merged ,the purpose of this rewrite Action is to compaction small files, so I think it is more reasonable to exclude data files which size > the target size during table scan.\r\n\r\n@zhangjun0x01  \r\nHi zhangjun, I found that large files exceeding the threshold were filtered out in PR.[#1762](https://github.com/apache/iceberg/pull/1762/files) , Perhapsd the rewrite data file operation should not only includes small file merging, but also large files should be segmented and rewritten. This PR has already rewritten large files after segmentation. What do you think about this, and thanks rdblue for pushing this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772160296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772175903","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772175903","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772175903,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjE3NTkwMw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T02:44:53Z","updated_at":"2021-02-03T02:44:53Z","author_association":"CONTRIBUTOR","body":"@Stephen-Robin I think there is no need to split the large file, because if the file size exceeds the target size, it will be automatically split into multiple `CombinedScanTasks` when reading, and read concurrently, instead of having a task to read the large file. Splitting a large file into multiple small files will make the Rewrite Action consume more resources, and too many small files are not friendly to hdfs. what do you think about ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772175903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772186229","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772186229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772186229,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjE4NjIyOQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T03:12:00Z","updated_at":"2021-02-03T03:12:00Z","author_association":"CONTRIBUTOR","body":"> @zhangjun0x01, next time please highlight that there is a correctness problem. I didn't know that #1762 fixed a correctness problem or we would have prioritized it and made sure it was in the 0.11.0 release. Thanks for pointing us to that issue, we will take a look at both alternative solutions.\r\n\r\nI'm very sorry, this problem should be resolved before 0.11.0 release. When I submitted this pr, I requested openinx to help me to review, maybe he be busy, I forgot this pr when 0.11.0  was released, I must pay attention to this problem next time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772186229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772188549","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772188549","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772188549,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjE4ODU0OQ==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T03:17:25Z","updated_at":"2021-02-03T03:17:25Z","author_association":"CONTRIBUTOR","body":"You're welcome to subscribe dev@ mailing list and participate discussion, RC verification, etc. Github mention is easy to slip through, so once you find some urgent things like regression or correctness, dev@ mailing list (or Slack channel) is appropriate place to share.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772188549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772200752","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772200752","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772200752,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjIwMDc1Mg==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T03:46:10Z","updated_at":"2021-02-03T03:46:57Z","author_association":"CONTRIBUTOR","body":"> @Stephen-Robin Splitting a large file into multiple small files will make the Rewrite Action consume more resources, and too many small files are not friendly to hdfs. what do you think about ?\r\n\r\n@zhangjun0x01 \r\nI think it makes sense to split large files into smaller files. \r\n1. the userâ€™s goal is to get the expected file size.\r\n2. When the split target size is set to such as 256M, rewriting large files after splitting will not significantly increase the load of hdfs.\r\n3. After splitting into small files, it is convenient for  filtering by  file metadata in manifest.\r\n4. We can  also add an option to let users decide whether to split large files","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772200752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772215412","html_url":"https://github.com/apache/iceberg/pull/2193#issuecomment-772215412","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2193","id":772215412,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjIxNTQxMg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T04:24:20Z","updated_at":"2021-02-03T04:24:20Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @dilipbiswal @mehtaashish23 @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772215412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772240207","html_url":"https://github.com/apache/iceberg/pull/2196#issuecomment-772240207","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2196","id":772240207,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjI0MDIwNw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T05:26:57Z","updated_at":"2021-02-03T05:26:57Z","author_association":"CONTRIBUTOR","body":"> 2. When the split target size is set to such as 256M, rewriting large files after splitting will not significantly increase the load of hdfs.\r\n\r\nyes,I thought wrong\r\n\r\n> 3. After splitting into small files, it is convenient for  filtering by  file metadata in manifest.\r\n\r\nit sounds make sense\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772240207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772291807","html_url":"https://github.com/apache/iceberg/issues/2195#issuecomment-772291807","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2195","id":772291807,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjI5MTgwNw==","user":{"login":"Stephen-Robin","id":77377842,"node_id":"MDQ6VXNlcjc3Mzc3ODQy","avatar_url":"https://avatars.githubusercontent.com/u/77377842?v=4","gravatar_id":"","url":"https://api.github.com/users/Stephen-Robin","html_url":"https://github.com/Stephen-Robin","followers_url":"https://api.github.com/users/Stephen-Robin/followers","following_url":"https://api.github.com/users/Stephen-Robin/following{/other_user}","gists_url":"https://api.github.com/users/Stephen-Robin/gists{/gist_id}","starred_url":"https://api.github.com/users/Stephen-Robin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stephen-Robin/subscriptions","organizations_url":"https://api.github.com/users/Stephen-Robin/orgs","repos_url":"https://api.github.com/users/Stephen-Robin/repos","events_url":"https://api.github.com/users/Stephen-Robin/events{/privacy}","received_events_url":"https://api.github.com/users/Stephen-Robin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T07:16:21Z","updated_at":"2021-02-03T07:16:21Z","author_association":"CONTRIBUTOR","body":"> I tried a slightly different fix were we just check in the filter command whether there is more than 1 file OR if there is a single file but it is a partial scan, Scan Length < File sizeInBytes and that seems to work as well without building up the fileName set which may be an issue with very large numbers of files.\r\n\r\nGreat, I will resubmit it with reference to your changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772291807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772315140","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-772315140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":772315140,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MjMxNTE0MA==","user":{"login":"txdong-sz","id":5066512,"node_id":"MDQ6VXNlcjUwNjY1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5066512?v=4","gravatar_id":"","url":"https://api.github.com/users/txdong-sz","html_url":"https://github.com/txdong-sz","followers_url":"https://api.github.com/users/txdong-sz/followers","following_url":"https://api.github.com/users/txdong-sz/following{/other_user}","gists_url":"https://api.github.com/users/txdong-sz/gists{/gist_id}","starred_url":"https://api.github.com/users/txdong-sz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/txdong-sz/subscriptions","organizations_url":"https://api.github.com/users/txdong-sz/orgs","repos_url":"https://api.github.com/users/txdong-sz/repos","events_url":"https://api.github.com/users/txdong-sz/events{/privacy}","received_events_url":"https://api.github.com/users/txdong-sz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-03T08:02:35Z","updated_at":"2021-02-03T08:02:35Z","author_association":"NONE","body":"@zhangjun0x01  thanks very much \r\ni merge into my code and can run very smoothly  and find a bug in flink 1.12 \r\n\r\nhttps://issues.apache.org/jira/browse/FLINK-21247\r\n\r\nhttps://github.com/apache/flink/pull/14845/files\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/772315140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]