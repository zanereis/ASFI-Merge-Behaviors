[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489057773","html_url":"https://github.com/apache/couchdb/issues/2024#issuecomment-489057773","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2024","id":489057773,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTA1Nzc3Mw==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-03T10:53:14Z","updated_at":"2019-05-03T10:53:14Z","author_association":"MEMBER","body":"This custom reduce function doesn't work in 1.6.1 either, you've just had too few documents in your database for couchdb to call you with rereduce=true.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489057773/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489134297","html_url":"https://github.com/apache/couchdb/pull/2007#issuecomment-489134297","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2007","id":489134297,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTEzNDI5Nw==","user":{"login":"jjrodrig","id":1001724,"node_id":"MDQ6VXNlcjEwMDE3MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1001724?v=4","gravatar_id":"","url":"https://api.github.com/users/jjrodrig","html_url":"https://github.com/jjrodrig","followers_url":"https://api.github.com/users/jjrodrig/followers","following_url":"https://api.github.com/users/jjrodrig/following{/other_user}","gists_url":"https://api.github.com/users/jjrodrig/gists{/gist_id}","starred_url":"https://api.github.com/users/jjrodrig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jjrodrig/subscriptions","organizations_url":"https://api.github.com/users/jjrodrig/orgs","repos_url":"https://api.github.com/users/jjrodrig/repos","events_url":"https://api.github.com/users/jjrodrig/events{/privacy}","received_events_url":"https://api.github.com/users/jjrodrig/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-03T15:24:45Z","updated_at":"2019-05-03T15:24:45Z","author_association":"CONTRIBUTOR","body":"@garrensmith I've been working on this trying to identify the source of test inconsistency.\r\n\r\nMost of the problems appears after a request timeout, I've checked the JS test suite and it seems to no define any request timeout but the default request timeout in the Elixir test suite was set to 5 secs. I 've set the default timeout to 20 secs. This increases the success chances but it is still failing in some executions. \r\n\r\nI've also noticed that the most unstable build is the one that uses the 21.2.3 OTP Release. This build requires 40%-50% more time to complete compared to the other two builds. Seems to have some performance degradation that increases the chance of a request timeout. \r\n\r\nI've also modified some test checks to make it more robust, retry, check 202 responses... \r\n\r\nThanks.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489134297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489176635","html_url":"https://github.com/apache/couchdb/issues/1499#issuecomment-489176635","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1499","id":489176635,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTE3NjYzNQ==","user":{"login":"ansarizafar","id":5788284,"node_id":"MDQ6VXNlcjU3ODgyODQ=","avatar_url":"https://avatars.githubusercontent.com/u/5788284?v=4","gravatar_id":"","url":"https://api.github.com/users/ansarizafar","html_url":"https://github.com/ansarizafar","followers_url":"https://api.github.com/users/ansarizafar/followers","following_url":"https://api.github.com/users/ansarizafar/following{/other_user}","gists_url":"https://api.github.com/users/ansarizafar/gists{/gist_id}","starred_url":"https://api.github.com/users/ansarizafar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansarizafar/subscriptions","organizations_url":"https://api.github.com/users/ansarizafar/orgs","repos_url":"https://api.github.com/users/ansarizafar/repos","events_url":"https://api.github.com/users/ansarizafar/events{/privacy}","received_events_url":"https://api.github.com/users/ansarizafar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-03T17:30:41Z","updated_at":"2019-05-03T17:30:41Z","author_association":"NONE","body":"Is there any update about Graphql support?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489176635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489189331","html_url":"https://github.com/apache/couchdb/issues/1499#issuecomment-489189331","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1499","id":489189331,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTE4OTMzMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-03T18:10:22Z","updated_at":"2019-05-03T18:10:22Z","author_association":"MEMBER","body":"@ansarizafar nope. When there is, you'll see it linked here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489189331/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489195927","html_url":"https://github.com/apache/couchdb/issues/1499#issuecomment-489195927","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1499","id":489195927,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTE5NTkyNw==","user":{"login":"ansarizafar","id":5788284,"node_id":"MDQ6VXNlcjU3ODgyODQ=","avatar_url":"https://avatars.githubusercontent.com/u/5788284?v=4","gravatar_id":"","url":"https://api.github.com/users/ansarizafar","html_url":"https://github.com/ansarizafar","followers_url":"https://api.github.com/users/ansarizafar/followers","following_url":"https://api.github.com/users/ansarizafar/following{/other_user}","gists_url":"https://api.github.com/users/ansarizafar/gists{/gist_id}","starred_url":"https://api.github.com/users/ansarizafar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ansarizafar/subscriptions","organizations_url":"https://api.github.com/users/ansarizafar/orgs","repos_url":"https://api.github.com/users/ansarizafar/repos","events_url":"https://api.github.com/users/ansarizafar/events{/privacy}","received_events_url":"https://api.github.com/users/ansarizafar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-03T18:31:31Z","updated_at":"2019-05-03T18:31:31Z","author_association":"NONE","body":"Is there any plan to add support for graphql? Is there any Couch db tutorial for Sql developers? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489195927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489198538","html_url":"https://github.com/apache/couchdb/issues/1499#issuecomment-489198538","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1499","id":489198538,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTE5ODUzOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-03T18:39:57Z","updated_at":"2019-05-03T18:39:57Z","author_association":"MEMBER","body":"@ansarizafar It's on the roadmap. Pull requests welcome.\r\n\r\nWe do have this in the documentation that might help you: https://docs.couchdb.org/en/stable/ddocs/views/nosql.html","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489198538/reactions","total_count":4,"+1":1,"-1":0,"laugh":0,"hooray":3,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489200357","html_url":"https://github.com/apache/couchdb/pull/2023#issuecomment-489200357","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2023","id":489200357,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTIwMDM1Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-03T18:45:22Z","updated_at":"2019-05-03T18:45:22Z","author_association":"MEMBER","body":"Going to merge since no one ever seems to review my Jenkins changes anyway.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489200357/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489643910","html_url":"https://github.com/apache/couchdb/pull/2007#issuecomment-489643910","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2007","id":489643910,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTY0MzkxMA==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-06T14:35:39Z","updated_at":"2019-05-06T14:35:39Z","author_association":"MEMBER","body":"Thanks for trying @jjrodrig I'll try and take a look later this week.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/489643910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490062229","html_url":"https://github.com/apache/couchdb/issues/2026#issuecomment-490062229","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2026","id":490062229,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDA2MjIyOQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-07T12:40:05Z","updated_at":"2019-05-07T12:40:05Z","author_association":"MEMBER","body":"Only admins can modify security documents. If admin access also had to pass the VDU check we open ourselves up to a situation where a mistake can never be fixed, there'd be no way to remove a broken VDU. We deliberately do not run VDU checks when admins are modifying design documents.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490062229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490062879","html_url":"https://github.com/apache/couchdb/issues/2025#issuecomment-490062879","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2025","id":490062879,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDA2Mjg3OQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-07T12:42:03Z","updated_at":"2019-05-07T12:42:03Z","author_association":"MEMBER","body":"_replicate has to read all changes from the source and apply them to the target, which can take some time. As you're using a doc id filter, this almost certainly means the entire source database is being scanned, which is quite inefficient. It's far easier to apply a single doc update change to both servers. Replication is appropriate when replicating all or the majority of the source documents.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490062879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490071532","html_url":"https://github.com/apache/couchdb/issues/2026#issuecomment-490071532","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2026","id":490071532,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDA3MTUzMg==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-07T13:07:22Z","updated_at":"2019-05-07T13:07:22Z","author_association":"NONE","body":"Thanks\r\nI think I might have missed something out, I am not doing the updates as admin (indeed it does make perfect sense NOT to run VDU as admin)\r\nI am doing the update as a standard user, in his own database (per user db), but he does have some documents shared to him (replicated in his DB) as readonly. Readonly check is accomplished with the VDU for each PerUser db. \r\nBut as far as I can tell the user can delete the VDU in his own DB and from this moment on he can update any documents.\r\n\r\nP.S.\r\nMaybe my confusion is that an user is an admin in his DB? Could this be the case?\r\nIf this is it, are there any alternatives to restrict an user to update certain documents in HIS database?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490071532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490139380","html_url":"https://github.com/apache/couchdb/issues/2026#issuecomment-490139380","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2026","id":490139380,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDEzOTM4MA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-07T15:53:52Z","updated_at":"2019-05-07T15:53:52Z","author_association":"MEMBER","body":"There are two kinds of administrator and I was remiss to conflate the two.\r\n\r\nwhen I said administrator above I specifically mean the kind that appears in the `[admins]` section. These are server admins.\r\n\r\nA Database administrator is a regular user that's named in the 'admins' section of the security object of the database.\r\n\r\nAn administrator of either type can edit design documents without having to pass the VDU's.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490139380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490246729","html_url":"https://github.com/apache/couchdb/pull/2029#issuecomment-490246729","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2029","id":490246729,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDI0NjcyOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-07T20:40:05Z","updated_at":"2019-05-07T20:40:05Z","author_association":"MEMBER","body":"Thanks!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490246729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490266614","html_url":"https://github.com/apache/couchdb/issues/2025#issuecomment-490266614","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2025","id":490266614,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDI2NjYxNA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-07T21:44:43Z","updated_at":"2019-05-08T13:21:09Z","author_association":"CONTRIBUTOR","body":"What @rnewson said. Also another reason could be a random amount of sleep used by replication jobs when they start up. By default it is between 0 and 5000 milliseconds. You can adjust it via the `[replicator] startup_jitter = 5000`  config setting.   Try setting it to 0 and see if you still see the issue.\r\n\r\nThe reason for the jitter is to avoid an initial load spike a node with a larger number of replication jobs is restarted.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490266614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490444127","html_url":"https://github.com/apache/couchdb/issues/2026#issuecomment-490444127","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2026","id":490444127,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDQ0NDEyNw==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-08T11:04:58Z","updated_at":"2019-05-08T11:04:58Z","author_association":"NONE","body":"Great\r\nWe fixed this by removing the user from admins and just keeping it as a member\r\nSo the question / bug is irrelevant but I think it would help if this would be specified in documentation","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490444127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490448864","html_url":"https://github.com/apache/couchdb/issues/2025#issuecomment-490448864","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2025","id":490448864,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDQ0ODg2NA==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-08T11:23:36Z","updated_at":"2019-05-08T11:25:57Z","author_association":"NONE","body":"Thanks for the quick replies.\r\n\r\nIndeed setting the `startup_jitter = 0`  fixed a big part of the problem, but there are still moments when it takes 7-10 seconds. So as @rnewson said it might be because replicate is scanning the source db (even thought I would have thought that by applying the doc_ids filter we would avoid that, because it has already the ids, but anyways).\r\nSo, @rnewson, are you suggesting that instead of using Replicate we should be applying a single doc change to both dbs, but I'm not exactly sure what you mean. \r\nBecause, as far as I know, the update doc mechanism works by retrieving the original document form the db, apply the updates, and then put it back to the db (which generates a new _rev, different from the one from the source db). \r\nSo I'm afraid that by doing this we'll end up with 2 branches (different _rev numbers) for the same document (which we do not want of course).\r\nThe _replicate call is responsible of moving (re-conciliating?) the document (tree) entirely, and also (opposite to interacting with _replicator db, is not storing any documents for every single replication) so it was the perfect choice for us because it is at the core of our document sharing mechanism between different user dbs.\r\nIf you're suggesting that there is a better performing option (which accomplishes the above as well) I'll be forever grateful if you'd point me in the right direction.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490448864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490457121","html_url":"https://github.com/apache/couchdb/issues/2025#issuecomment-490457121","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2025","id":490457121,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDQ1NzEyMQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-08T11:56:37Z","updated_at":"2019-05-08T11:57:07Z","author_association":"MEMBER","body":"replication is reading the _changes feed, which is ordered (roughly) by last update time, the filter is then applied to the changes as they come through. There might be some internal optimization for the doc_ids filter but given the numbers you're showing, it might not always be possible (or it just might not be that big an optimization).\r\n\r\nIf you apply the same changes to a document in two separate couchdb servers, you will get the same _rev value and therefore no conflict when you replicate. This is by design. You obviously have to apply the exact same changes in the exact same order to benefit from this, which you might struggle with in practice.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490457121/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490648028","html_url":"https://github.com/apache/couchdb/issues/2026#issuecomment-490648028","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2026","id":490648028,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDY0ODAyOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-08T20:56:55Z","updated_at":"2019-05-08T20:56:55Z","author_association":"MEMBER","body":"We'd be happy to accept a pull request on the documentation repository :) It should be a quick change, and would earn you the status of CouchDB contributor! :smile: ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490648028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490819137","html_url":"https://github.com/apache/couchdb/issues/2025#issuecomment-490819137","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2025","id":490819137,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDgxOTEzNw==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T08:57:35Z","updated_at":"2019-05-09T08:57:35Z","author_association":"NONE","body":"Thanks\r\nWe have tried it and if initially it seemed to be working (applying same updates in fauxton) in practice we are getting different rev numbers, but indeed, even if it would work ,in practice, in our architecture, is quite hard to benefit from it. \r\nI am still interested about this potential improvement, and maybe at some point we'll give it another try.\r\nEventually please tell me why wouldn't it generate same rev even if we are applying same json (does formatting count?). Because I have compared the docs in various file comparers and the only difference is the updated field, but is still having a different rev no.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490819137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490839888","html_url":"https://github.com/apache/couchdb/issues/2025#issuecomment-490839888","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2025","id":490839888,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDgzOTg4OA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T09:59:01Z","updated_at":"2019-05-09T09:59:01Z","author_association":"MEMBER","body":"meaningless whitespace shouldn't count (that is, outside of JSON string values), but it seems you're saying the 'updated' field is different, and that means you didn't make the same change to the document, which is why the revs are different.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490839888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490840078","html_url":"https://github.com/apache/couchdb/issues/2025#issuecomment-490840078","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2025","id":490840078,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDg0MDA3OA==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T09:59:36Z","updated_at":"2019-05-09T09:59:36Z","author_association":"MEMBER","body":"property ordering would count, though. (within objects and arrays)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490840078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490847489","html_url":"https://github.com/apache/couchdb/issues/1992#issuecomment-490847489","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1992","id":490847489,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDg0NzQ4OQ==","user":{"login":"psycr0w13","id":23707573,"node_id":"MDQ6VXNlcjIzNzA3NTcz","avatar_url":"https://avatars.githubusercontent.com/u/23707573?v=4","gravatar_id":"","url":"https://api.github.com/users/psycr0w13","html_url":"https://github.com/psycr0w13","followers_url":"https://api.github.com/users/psycr0w13/followers","following_url":"https://api.github.com/users/psycr0w13/following{/other_user}","gists_url":"https://api.github.com/users/psycr0w13/gists{/gist_id}","starred_url":"https://api.github.com/users/psycr0w13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psycr0w13/subscriptions","organizations_url":"https://api.github.com/users/psycr0w13/orgs","repos_url":"https://api.github.com/users/psycr0w13/repos","events_url":"https://api.github.com/users/psycr0w13/events{/privacy}","received_events_url":"https://api.github.com/users/psycr0w13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T10:23:41Z","updated_at":"2019-05-09T10:23:41Z","author_association":"NONE","body":"Thanks for looking into this :) I found a workaround in the meantime --> I use the js library bottleneck now to throttle the accesstimes for the container/db. With a concurrency count of 10 and a minimal time bottleneck value of 10 (I think ms) it is working fine. Needs some more time to save the data, but that is ok.\r\nThanks anyway :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490847489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490849210","html_url":"https://github.com/apache/couchdb/issues/2025#issuecomment-490849210","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2025","id":490849210,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDg0OTIxMA==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-09T10:30:07Z","updated_at":"2019-05-09T10:30:39Z","author_association":"NONE","body":"We are doing something like this:\r\nWhen the update is notified in global changes, we take it, the new version of the document, change with the _rev no from the target database, and put the update.\r\nBut I think there must be something wrong we are doing, and even though I appreciate very much your help, continuing this discussion is not in the spirit of the bug.\r\nSo, I'll just close it for now.\r\nCheers!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/490849210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492077185","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-492077185","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":492077185,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjA3NzE4NQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-14T04:47:55Z","updated_at":"2019-05-14T04:47:55Z","author_association":"CONTRIBUTOR","body":"After ignoring the following eunit test cases, the eunit tests in all platform but one (Debian Stretch aarch64) passed[1]. \r\n\r\n- src/mem3/test/mem3_reshard_api_test.erl\r\n  ` individual_job_stop_when_cluster_stopped/1`\r\n   `recover_in_build_indices/1`\r\n\r\n- src/mem3/test/mem3_reshard_changes_feed_test.erl\r\n  `normal_feed_should_work_after_split/1`\r\n  `continuous_feed_should_work_during_split/1`\r\n\r\n[1] https://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/jenkins-fixup-eunittest/8/pipeline/64\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492077185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492077441","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-492077441","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":492077441,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjA3NzQ0MQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-14T04:49:34Z","updated_at":"2019-05-14T04:49:34Z","author_association":"CONTRIBUTOR","body":"In `Debian Stretch aarch64` platform, we got a bunch of timed-out. https://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/jenkins-fixup-eunittest/8/pipeline/64. Will try to extend the duration for timed-out.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492077441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492853531","html_url":"https://github.com/apache/couchdb/issues/2031#issuecomment-492853531","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2031","id":492853531,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjg1MzUzMQ==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-15T22:53:02Z","updated_at":"2019-05-15T22:53:02Z","author_association":"MEMBER","body":"[copied from dev list response from Joan Touzet]\r\n\r\nCouchDB does not rush to release binaries for Debian/Ubuntu/CentOS/RHEL on major x.0 releases.\r\n\r\nIt is unlikely we will publish any buster package until after its official promotion to stable. No release date has been set yet for buster, though we're aware it is in freeze status. After release, we will then add buster to our CI matrix and ensure regression tests pass properly before releasing. If history serves, you can expect the package roughly a month after the buster release.\r\n\r\nIf you need it running on buster sooner, you are always welcome to compile from scratch. Bug reports and pull requests against our CI or packaging repos from issues you find are always welcome.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492853531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492941958","html_url":"https://github.com/apache/couchdb/issues/2032#issuecomment-492941958","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2032","id":492941958,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjk0MTk1OA==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T06:53:11Z","updated_at":"2019-05-16T06:53:11Z","author_association":"MEMBER","body":"@ceremcem making a query request to your views should rebuild the indexes","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492941958/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492942777","html_url":"https://github.com/apache/couchdb/issues/2032#issuecomment-492942777","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2032","id":492942777,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjk0Mjc3Nw==","user":{"login":"ceremcem","id":6639874,"node_id":"MDQ6VXNlcjY2Mzk4NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/6639874?v=4","gravatar_id":"","url":"https://api.github.com/users/ceremcem","html_url":"https://github.com/ceremcem","followers_url":"https://api.github.com/users/ceremcem/followers","following_url":"https://api.github.com/users/ceremcem/following{/other_user}","gists_url":"https://api.github.com/users/ceremcem/gists{/gist_id}","starred_url":"https://api.github.com/users/ceremcem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ceremcem/subscriptions","organizations_url":"https://api.github.com/users/ceremcem/orgs","repos_url":"https://api.github.com/users/ceremcem/repos","events_url":"https://api.github.com/users/ceremcem/events{/privacy}","received_events_url":"https://api.github.com/users/ceremcem/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T06:56:19Z","updated_at":"2019-05-16T06:56:19Z","author_association":"CONTRIBUTOR","body":"@garrensmith Thanks. Should I trigger a query request for *each view* or can I determine which view is related with that unreadable `.shard` file?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492942777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492944736","html_url":"https://github.com/apache/couchdb/issues/2032#issuecomment-492944736","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2032","id":492944736,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjk0NDczNg==","user":{"login":"ceremcem","id":6639874,"node_id":"MDQ6VXNlcjY2Mzk4NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/6639874?v=4","gravatar_id":"","url":"https://api.github.com/users/ceremcem","html_url":"https://github.com/ceremcem","followers_url":"https://api.github.com/users/ceremcem/followers","following_url":"https://api.github.com/users/ceremcem/following{/other_user}","gists_url":"https://api.github.com/users/ceremcem/gists{/gist_id}","starred_url":"https://api.github.com/users/ceremcem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ceremcem/subscriptions","organizations_url":"https://api.github.com/users/ceremcem/orgs","repos_url":"https://api.github.com/users/ceremcem/repos","events_url":"https://api.github.com/users/ceremcem/events{/privacy}","received_events_url":"https://api.github.com/users/ceremcem/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T07:03:33Z","updated_at":"2019-05-16T07:03:33Z","author_association":"CONTRIBUTOR","body":"Update: It wasn't so hard to open the Fauxton interface and click every view in the database. This should trigger the desired query request. However, despite the successful query requests, the file still seems unreadable. \r\n\r\nIs it okay to delete this file and trigger all views again? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492944736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492971711","html_url":"https://github.com/apache/couchdb/issues/2032#issuecomment-492971711","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2032","id":492971711,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Mjk3MTcxMQ==","user":{"login":"ceremcem","id":6639874,"node_id":"MDQ6VXNlcjY2Mzk4NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/6639874?v=4","gravatar_id":"","url":"https://api.github.com/users/ceremcem","html_url":"https://github.com/ceremcem","followers_url":"https://api.github.com/users/ceremcem/followers","following_url":"https://api.github.com/users/ceremcem/following{/other_user}","gists_url":"https://api.github.com/users/ceremcem/gists{/gist_id}","starred_url":"https://api.github.com/users/ceremcem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ceremcem/subscriptions","organizations_url":"https://api.github.com/users/ceremcem/orgs","repos_url":"https://api.github.com/users/ceremcem/repos","events_url":"https://api.github.com/users/ceremcem/events{/privacy}","received_events_url":"https://api.github.com/users/ceremcem/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T08:29:35Z","updated_at":"2019-05-16T08:29:35Z","author_association":"CONTRIBUTOR","body":"I backed up the erroneous file and triggered all views in the database `bar2`. That file is restored and everything seems to work correctly. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/492971711/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493132868","html_url":"https://github.com/apache/couchdb/issues/1651#issuecomment-493132868","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1651","id":493132868,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzEzMjg2OA==","user":{"login":"ketan86","id":5973097,"node_id":"MDQ6VXNlcjU5NzMwOTc=","avatar_url":"https://avatars.githubusercontent.com/u/5973097?v=4","gravatar_id":"","url":"https://api.github.com/users/ketan86","html_url":"https://github.com/ketan86","followers_url":"https://api.github.com/users/ketan86/followers","following_url":"https://api.github.com/users/ketan86/following{/other_user}","gists_url":"https://api.github.com/users/ketan86/gists{/gist_id}","starred_url":"https://api.github.com/users/ketan86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ketan86/subscriptions","organizations_url":"https://api.github.com/users/ketan86/orgs","repos_url":"https://api.github.com/users/ketan86/repos","events_url":"https://api.github.com/users/ketan86/events{/privacy}","received_events_url":"https://api.github.com/users/ketan86/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T16:11:30Z","updated_at":"2019-05-16T16:14:13Z","author_association":"NONE","body":"Any update on this issue ? I am hitting the same problem. The referenced issue https://github.com/cloudant/couchbackup/issues/253 does not help.\r\n\r\nIt happens with other db too.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493132868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493182987","html_url":"https://github.com/apache/couchdb/issues/1651#issuecomment-493182987","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1651","id":493182987,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzE4Mjk4Nw==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-16T18:33:56Z","updated_at":"2019-05-16T18:33:56Z","author_association":"MEMBER","body":"The documentation for _bulk_get is here: https://docs.couchdb.org/en/stable/api/database/bulk-api.html#db-bulk-get\r\n\r\nThe doc body is not of format {\"docs\":[\"doc-1\"]}. \r\n\r\nAdmittedly the error handling is crappy, but if you supply what the docs say you should send, it works;\r\n\r\n{\"docs\":[{\"id\":\"doc-1\"}]}","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493182987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493538459","html_url":"https://github.com/apache/couchdb/issues/2033#issuecomment-493538459","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2033","id":493538459,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzUzODQ1OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-17T17:40:58Z","updated_at":"2019-05-17T17:40:58Z","author_association":"MEMBER","body":"I previously talked to Bertrand about this and don't think CouchDB needs \nto change here. Other projects, especially older ones, have their own \n\"bylaws\" and aren't expected to change. This is mostly advice going \nforwards. I worry that if we change the name people will think it \nweakens our resolve to follow these rules we've set out for ourselves, \nwhich is absolutely not true.\n\nLet me have a 1:1 with him and I'll get back to you. Next week earliest.\n\n-Joan\n\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493538459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493684097","html_url":"https://github.com/apache/couchdb/issues/2033#issuecomment-493684097","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2033","id":493684097,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzY4NDA5Nw==","user":{"login":"nomicode","id":23469,"node_id":"MDQ6VXNlcjIzNDY5","avatar_url":"https://avatars.githubusercontent.com/u/23469?v=4","gravatar_id":"","url":"https://api.github.com/users/nomicode","html_url":"https://github.com/nomicode","followers_url":"https://api.github.com/users/nomicode/followers","following_url":"https://api.github.com/users/nomicode/following{/other_user}","gists_url":"https://api.github.com/users/nomicode/gists{/gist_id}","starred_url":"https://api.github.com/users/nomicode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nomicode/subscriptions","organizations_url":"https://api.github.com/users/nomicode/orgs","repos_url":"https://api.github.com/users/nomicode/repos","events_url":"https://api.github.com/users/nomicode/events{/privacy}","received_events_url":"https://api.github.com/users/nomicode/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-18T15:09:35Z","updated_at":"2019-05-18T15:09:35Z","author_association":"CONTRIBUTOR","body":"understood. thx!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493684097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493701024","html_url":"https://github.com/apache/couchdb/issues/1651#issuecomment-493701024","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1651","id":493701024,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MzcwMTAyNA==","user":{"login":"ketan86","id":5973097,"node_id":"MDQ6VXNlcjU5NzMwOTc=","avatar_url":"https://avatars.githubusercontent.com/u/5973097?v=4","gravatar_id":"","url":"https://api.github.com/users/ketan86","html_url":"https://github.com/ketan86","followers_url":"https://api.github.com/users/ketan86/followers","following_url":"https://api.github.com/users/ketan86/following{/other_user}","gists_url":"https://api.github.com/users/ketan86/gists{/gist_id}","starred_url":"https://api.github.com/users/ketan86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ketan86/subscriptions","organizations_url":"https://api.github.com/users/ketan86/orgs","repos_url":"https://api.github.com/users/ketan86/repos","events_url":"https://api.github.com/users/ketan86/events{/privacy}","received_events_url":"https://api.github.com/users/ketan86/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-18T19:23:46Z","updated_at":"2019-05-18T19:23:46Z","author_association":"NONE","body":"Thanks","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/493701024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494077169","html_url":"https://github.com/apache/couchdb/issues/1959#issuecomment-494077169","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1959","id":494077169,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDA3NzE2OQ==","user":{"login":"zhicong","id":6629493,"node_id":"MDQ6VXNlcjY2Mjk0OTM=","avatar_url":"https://avatars.githubusercontent.com/u/6629493?v=4","gravatar_id":"","url":"https://api.github.com/users/zhicong","html_url":"https://github.com/zhicong","followers_url":"https://api.github.com/users/zhicong/followers","following_url":"https://api.github.com/users/zhicong/following{/other_user}","gists_url":"https://api.github.com/users/zhicong/gists{/gist_id}","starred_url":"https://api.github.com/users/zhicong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhicong/subscriptions","organizations_url":"https://api.github.com/users/zhicong/orgs","repos_url":"https://api.github.com/users/zhicong/repos","events_url":"https://api.github.com/users/zhicong/events{/privacy}","received_events_url":"https://api.github.com/users/zhicong/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-20T17:21:47Z","updated_at":"2019-05-20T17:21:47Z","author_association":"NONE","body":"Additional data point: I noticed this user in my _users database as well after I opened up my Google Cloud deployment to external IPs. It kept reappearing even after I deleted it, but I thought it might be just an artifact. I left it alone but realized that my CPU utilization always spiked literally from 0 to 100% some time after server restarts, which led me to this thread.\r\n\r\nAfter implementing some basic user validation and deleting the user, my CPU utilization has dropped back down. Definitely some crypto mining going on.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494077169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494742964","html_url":"https://github.com/apache/couchdb/issues/2035#issuecomment-494742964","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2035","id":494742964,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDc0Mjk2NA==","user":{"login":"ceremcem","id":6639874,"node_id":"MDQ6VXNlcjY2Mzk4NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/6639874?v=4","gravatar_id":"","url":"https://api.github.com/users/ceremcem","html_url":"https://github.com/ceremcem","followers_url":"https://api.github.com/users/ceremcem/followers","following_url":"https://api.github.com/users/ceremcem/following{/other_user}","gists_url":"https://api.github.com/users/ceremcem/gists{/gist_id}","starred_url":"https://api.github.com/users/ceremcem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ceremcem/subscriptions","organizations_url":"https://api.github.com/users/ceremcem/orgs","repos_url":"https://api.github.com/users/ceremcem/repos","events_url":"https://api.github.com/users/ceremcem/events{/privacy}","received_events_url":"https://api.github.com/users/ceremcem/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-22T10:17:36Z","updated_at":"2019-05-22T10:17:36Z","author_association":"CONTRIBUTOR","body":"FYI: My use case is exactly the same (I'm reverse proxying CouchDB with Nginx in a subdirectory) with the following configuration: \r\n\r\n```\r\n    location ^~ /db2/ {\r\n        proxy_pass http://10.0.8.19:5984/;\r\n        proxy_redirect off;\r\n        proxy_buffering off;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n    }\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494742964/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494882209","html_url":"https://github.com/apache/couchdb/issues/2035#issuecomment-494882209","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2035","id":494882209,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDg4MjIwOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-22T16:43:43Z","updated_at":"2019-05-22T16:43:43Z","author_association":"MEMBER","body":"The documentation was only written to ensure CouchDB functions at the `/` (top level).\r\n\r\nA pull request against the *documentation* for hosting CouchDB at a subdirectory is welcome.\r\n\r\nMoving this issue to that repository now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494882209/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494920531","html_url":"https://github.com/apache/couchdb/pull/2036#issuecomment-494920531","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2036","id":494920531,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDkyMDUzMQ==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-22T18:49:39Z","updated_at":"2019-05-22T18:49:39Z","author_association":"CONTRIBUTOR","body":"Adding reference to ML discussion for posterity https://lists.apache.org/list.html?dev@couchdb.apache.org:2019-5","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494920531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494952721","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-494952721","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":494952721,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDk1MjcyMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-22T20:11:32Z","updated_at":"2019-05-22T20:11:32Z","author_association":"MEMBER","body":"Hi @jiangphcn , any luck on extending the timeouts?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/494952721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495106370","html_url":"https://github.com/apache/couchdb/issues/1600#issuecomment-495106370","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1600","id":495106370,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTEwNjM3MA==","user":{"login":"m1cka","id":5598270,"node_id":"MDQ6VXNlcjU1OTgyNzA=","avatar_url":"https://avatars.githubusercontent.com/u/5598270?v=4","gravatar_id":"","url":"https://api.github.com/users/m1cka","html_url":"https://github.com/m1cka","followers_url":"https://api.github.com/users/m1cka/followers","following_url":"https://api.github.com/users/m1cka/following{/other_user}","gists_url":"https://api.github.com/users/m1cka/gists{/gist_id}","starred_url":"https://api.github.com/users/m1cka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/m1cka/subscriptions","organizations_url":"https://api.github.com/users/m1cka/orgs","repos_url":"https://api.github.com/users/m1cka/repos","events_url":"https://api.github.com/users/m1cka/events{/privacy}","received_events_url":"https://api.github.com/users/m1cka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T07:46:42Z","updated_at":"2019-05-23T07:46:42Z","author_association":"NONE","body":"Same problem:\r\nUbuntu 18.04.2 LTS (on SSD)\r\nDocker-ce 18.09.6\r\nimage: \"apache/couchdb:2.3.1\"","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495106370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495180233","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495180233","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495180233,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTE4MDIzMw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T11:31:09Z","updated_at":"2019-05-23T11:31:09Z","author_association":"CONTRIBUTOR","body":"Possible workaround is to set `trace: true` in the config [here](https://github.com/apache/couchdb/blob/master/test/elixir/test/test_helper.exs#L9). This should work because it causes ExUnit to use infinity as a timeout (see https://github.com/elixir-lang/elixir/blob/master/lib/ex_unit/lib/ex_unit/runner.ex#L410). \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495180233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495280224","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495280224","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495280224,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTI4MDIyNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T15:59:53Z","updated_at":"2019-05-23T15:59:53Z","author_association":"MEMBER","body":"@iilyak But we're talking also about EUnit here, not ExUnit.\r\n\r\nThoughts?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495280224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495294060","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495294060","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495294060,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTI5NDA2MA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T16:38:45Z","updated_at":"2019-05-23T16:38:45Z","author_association":"MEMBER","body":"Is this about individual tests or global eunit's timeout? Individual tests' timeout could be changed with `{timeout, Time::number(), Tests}` wrapper, with a caveat that this timeout also includes setup and teardown. For global timeout that's tricky. Eunit's `? DEFAULT_TEST_TIMEOUT` is 5 sec and tbh I don't think there is an option to override this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495294060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495295523","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495295523","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495295523,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTI5NTUyMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T16:42:55Z","updated_at":"2019-05-23T16:42:55Z","author_association":"MEMBER","body":"@eiri Global. In the case of cross-running on another architecture, or a very low end architecture (like a Raspberry Pi) these tests simply can't run that slow. It'd be fantastic to up that globally.\r\n\r\nCould we patch eunit?\r\nCould we specify per-testfile or util based overrides and add a new `{timeout...}` wrapper to every file that references a global value?\r\n\r\nOtherwise you're talking about hand-upping timeouts on hundreds and hundreds of unit tests that currently fail on `aarch64` and will soon start failing on `ppc64le`, `s390x`, etc.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495295523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495301858","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495301858","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495301858,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTMwMTg1OA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T17:01:06Z","updated_at":"2019-05-23T17:01:06Z","author_association":"MEMBER","body":"I think there are two potential venue to approach: 1) using `parse_transform` to modify all the  tests to add that `{timeout...} or 2) modify rebar's rest runner to catch timeout and either re-run the test suite or treat it as exit 'ok'. Honestly don't know how feasible or how much work either of this could be.\r\n\r\nI once tried to write custom eunit runner to skip rebar all together, it was doable and fwiw the tests ran faster, but it wasn't finished solution and it was getting hairy pretty quick.\r\n\r\n@iilyak I wonder if it's possible to use that `ExUnit` to run eunit tests instead of rebar's eunit? Maybe this could be a perspective solution. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495301858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495347800","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495347800","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495347800,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTM0NzgwMA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T19:11:50Z","updated_at":"2019-05-23T19:11:50Z","author_association":"CONTRIBUTOR","body":"We could also try patching rebar. We can try to change [this function](https://github.com/rebar/rebar/blob/master/src/rebar_eunit.erl#L468:L469) \r\n\r\nfrom \r\n```\r\neunit_primitive(Type, M, F) ->\r\n   {Type, M, F}.\r\n```\r\n\r\nto \r\n```\r\neunit_primitive({timeout, _, _} = Type, M, F) ->\r\n   {Type, M, F};\r\neunit_primitive(Type, M, F) ->\r\n   {timeout, 999999999999999999, [{Type, M, F}]}.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495347800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495392134","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495392134","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495392134,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTM5MjEzNA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T21:29:32Z","updated_at":"2019-05-23T21:29:32Z","author_association":"MEMBER","body":"This is actually a pretty good idea. I thought about rebar plugin, but this might be the fastest and simplest solution. Want to give it a try? I think a bump to 5 mins should be enough, we probably don't want to completely block pipeline on genuine deadlocks ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495392134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495409608","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495409608","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495409608,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTQwOTYwOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-23T22:37:39Z","updated_at":"2019-05-23T22:37:39Z","author_association":"MEMBER","body":"What happens when we move to rebar3?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495409608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495600938","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495600938","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495600938,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTYwMDkzOA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-24T12:20:06Z","updated_at":"2019-05-24T12:20:06Z","author_association":"CONTRIBUTOR","body":"hey @wohali,\r\n\r\nIt is helpful to extend timeout. The tricky thing is about eunit test on `Debian Stretch aarch64`. I have seen a lot of failures in https://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/jenkins-fixup-eunittest/8/pipeline/64, so didn't add it one by one. \r\n\r\n```\r\n[2019-05-14T03:34:10.023Z] module 'couch_btree'\r\n\r\n[2019-05-14T03:34:10.023Z]   module 'couch_btree_tests'\r\n\r\n[2019-05-14T03:34:10.023Z]     couch_btree_tests:80: btree_open_test_ (Ensure that created btree is really a btree record)...ok\r\n\r\n[2019-05-14T03:34:10.023Z]     BTree with sorted keys\r\n\r\n[2019-05-14T03:34:12.306Z]       couch_btree_tests:179: should_set_fd_correctly...ok\r\n\r\n[2019-05-14T03:34:12.307Z]       couch_btree_tests:182: should_set_root_correctly...ok\r\n\r\n[2019-05-14T03:34:12.307Z]       couch_btree_tests:185: should_create_zero_sized_btree...ok\r\n\r\n[2019-05-14T03:34:12.307Z]       couch_btree_tests:190: should_set_reduce_option...ok\r\n\r\n[2019-05-14T03:34:12.307Z]       couch_btree_tests:194: should_fold_over_empty_btree...ok\r\n\r\n[2019-05-14T03:34:17.636Z]       couch_btree_tests:207: should_return_complete_btree_on_adding_all_keys...*timed out*\r\n\r\n[2019-05-14T03:34:17.636Z]       undefined\r\n\r\n[2019-05-14T03:34:24.062Z]     Should continuously add key-values to btree\r\n\r\n[2019-05-14T03:34:29.286Z]       couch_btree_tests:442: should_produce_valid_btree...*timed out*\r\n\r\n[2019-05-14T03:34:34.510Z]     Should continuously remove keys from btree\r\n\r\n[2019-05-14T03:34:34.510Z]       couch_btree_tests:442: should_produce_valid_btree...ok\r\n\r\n[2019-05-14T03:34:34.510Z]       couch_btree_tests:445: should_be_empty...ok\r\n\r\n[2019-05-14T03:34:34.510Z]       [done in 0.020 s]\r\n\r\n[2019-05-14T03:34:45.084Z]     couch_btree_tests:442: should_produce_valid_btree...*timed out*\r\n\r\n[2019-05-14T03:34:45.084Z]     undefined\r\n\r\n[2019-05-14T03:34:50.307Z]   couch_btree_tests:279: should_add_every_odd_key_remove_every_even...*timed out*\r\n\r\n[2019-05-14T03:34:50.307Z]   undefined\r\n\r\n[2019-05-14T03:34:55.531Z] couch_btree_tests:289: should_add_every_even_key_remove_every_old...*timed out*\r\n\r\n[2019-05-14T03:34:55.531Z] undefined\r\n```\r\n\r\nThanks to @iilyak and @eiri for their tips. I applied https://github.com/apache/couchdb/issues/2030#issuecomment-495347800 in https://github.com/apache/couchdb/compare/jenkins-fixup-eunittest?expand=1#diff-e2d5a00791bce9a01f99bc6fd613a39dR220.\r\n\r\nFrom recent build, looks that it helps a lot. https://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/jenkins-fixup-eunittest/12/pipeline/64\r\n\r\nHowever, still see one failure on `Debian Stretch aarch64` for now. (maybe there are more, but stop here)\r\n```\r\n[2019-05-24T09:20:58.376Z] module 'chttpd_handlers'\r\n\r\n[2019-05-24T09:20:58.376Z]   chttpd_handlers: select_override_test...ok\r\n\r\n[2019-05-24T09:20:58.376Z]   chttpd_handlers: select_default_override_test...ok\r\n\r\n[2019-05-24T09:20:58.376Z]   module 'chttpd_handlers_tests'\r\n\r\n[2019-05-24T09:20:58.376Z]     _replicate\r\n\r\n[2019-05-24T09:21:03.251Z]       chttpd_handlers_tests:48: should_escape_dbname_on_replicate...getsockopt level=41 optname=67 not yet supported\r\n\r\n[2019-05-24T09:21:03.962Z] *timed out*\r\n\r\n[2019-05-24T09:21:03.962Z]       undefined\r\n```\r\n\r\nI will comment out this test so that more eunit test can run on this platform. And see how much are left.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495600938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495605177","html_url":"https://github.com/apache/couchdb/issues/2030#issuecomment-495605177","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2030","id":495605177,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTYwNTE3Nw==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-24T12:31:40Z","updated_at":"2019-05-24T12:31:40Z","author_association":"CONTRIBUTOR","body":"> @wohali : What happens when we move to rebar3?\r\n\r\nMy personal opinion is we shouldn't move to rebar3. There might be better options out there. I agree with your concern though if we update rebar plugin it would make migration harder. \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495605177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495940304","html_url":"https://github.com/apache/couchdb/pull/2037#issuecomment-495940304","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2037","id":495940304,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTk0MDMwNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-25T18:48:44Z","updated_at":"2019-05-25T18:48:44Z","author_association":"MEMBER","body":"Will this cause all CI runs or `make check` to fail unless Clouseau is present? If so, please don't merge until this is addressed.\r\n\r\nOne possibility is to comment out all tests until a solution can be determined.\r\n\r\nAs a reminder, it is very challenging to get Java <=7 into [Debian](https://packages.debian.org/search?keywords=openjdk-7&searchon=names&suite=all&section=all) and [Ubuntu](https://packages.ubuntu.com/search?keywords=openjdk-7&searchon=names&suite=all&section=all) now technically, and there are issues with Java <=7 [potentially legally](https://www.infoworld.com/article/3269332/oracle-sets-date-for-end-of-java-8-updates.html) for our users.\r\n\r\nDo you intend to bring Clouseau into the ASF as well, or is the intent to stay with independent binary releases of Clouseau (i.e., direct from IBM)?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495940304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495950684","html_url":"https://github.com/apache/couchdb/pull/2037#issuecomment-495950684","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2037","id":495950684,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTk1MDY4NA==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-25T21:41:46Z","updated_at":"2019-05-25T21:41:46Z","author_association":"MEMBER","body":"`make check` succeeds without Clouseau.\r\n\r\nI’m happy to solicit input from the community, but my initial thought is to provide Clouseau builds directly from IBM. It’s a low-traffic project and not one we’re actively trying to build a developer community around, in part because the FoundationDB work will require a ~complete rewrite of it.\r\n\r\nMy understanding Clouseau is running fine and passing all tests on Java 8 in our dev environments. It just can’t be built using that JDK.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/495950684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496038762","html_url":"https://github.com/apache/couchdb/pull/2037#issuecomment-496038762","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2037","id":496038762,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjAzODc2Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-26T23:11:31Z","updated_at":"2019-05-26T23:11:31Z","author_association":"MEMBER","body":"@kocolosk Two more things occurred to me in the shower:\r\n\r\n1. This will let users create `index` secondary indexes even if Clouseau isn't running. What sort of feedback could  Couch-With-Dreyfus-Without-Clouseau give when it's never able to build that index - either at create or query time? Or, is this feature hide-able behind a feature flag that is disabled by default?\r\n\r\n2. We need docs :smile: ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496038762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496040573","html_url":"https://github.com/apache/couchdb/pull/2037#issuecomment-496040573","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2037","id":496040573,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjA0MDU3Mw==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-26T23:41:22Z","updated_at":"2019-05-26T23:41:22Z","author_association":"MEMBER","body":"Agree on both of those. The Cloudant Search docs are a good start; I’m going to see if we have any tooling that helps translate from the IBM Cloud format to the Apache CouchDB one.\r\n\r\nI do think some “Clouseau isn’t running” feedback would be very useful; currently I think Dreyfus just times out with a generic error message if it fails to connect in 30 seconds. Do you think that improvement needs to happen before the merge?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496040573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496046213","html_url":"https://github.com/apache/couchdb/pull/2037#issuecomment-496046213","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2037","id":496046213,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjA0NjIxMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-27T00:56:33Z","updated_at":"2019-05-27T00:56:33Z","author_association":"MEMBER","body":"I'd prefer a feature flag that defaults to disabled. If it could auto-enable if it sees Clouseau in the cluster, that'd be amazing, but over and above the call of duty.\r\n\r\nEnvisioned user install experience would be something like:\r\n1. Install CouchDB\r\n1. Install Clouseau and daemonize it\r\n1. (if not automatic) Turn on feature flag\r\n\r\nor\r\n1. Install CouchDB - nothing different from today if you don't have Clouseau installed, no \"surprises\"","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496046213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496252854","html_url":"https://github.com/apache/couchdb/issues/2038#issuecomment-496252854","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2038","id":496252854,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjI1Mjg1NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-27T15:49:57Z","updated_at":"2019-05-27T15:49:57Z","author_association":"MEMBER","body":"Hi @priyabratap ,\r\n\r\n```\r\nstate: {os_proc,\"bash /tmp/baby\"\r\n```\r\n\r\nThere must be an entry in your CouchDB's `local.ini` that is trying to launch this program, and failing.\r\n\r\nThis was probably triggered by someone trying to use your machine as a Bitcoin miner or similar through one of the known exploitable holes in CouchDB 2.2.0. These are summarized here: http://docs.couchdb.org/en/stable/cve/index.html\r\n\r\n1. Upgrade to CouchDB 2.3.0 or 2.3.1 as soon as possible.\r\n2. Remove the line that references `bash /tmp/baby` in your `local.ini` file.\r\n3. Restart CouchDB.\r\n\r\nDoes the problem still occur?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496252854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496384566","html_url":"https://github.com/apache/couchdb/issues/2038#issuecomment-496384566","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2038","id":496384566,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjM4NDU2Ng==","user":{"login":"priyabratap","id":6428176,"node_id":"MDQ6VXNlcjY0MjgxNzY=","avatar_url":"https://avatars.githubusercontent.com/u/6428176?v=4","gravatar_id":"","url":"https://api.github.com/users/priyabratap","html_url":"https://github.com/priyabratap","followers_url":"https://api.github.com/users/priyabratap/followers","following_url":"https://api.github.com/users/priyabratap/following{/other_user}","gists_url":"https://api.github.com/users/priyabratap/gists{/gist_id}","starred_url":"https://api.github.com/users/priyabratap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyabratap/subscriptions","organizations_url":"https://api.github.com/users/priyabratap/orgs","repos_url":"https://api.github.com/users/priyabratap/repos","events_url":"https://api.github.com/users/priyabratap/events{/privacy}","received_events_url":"https://api.github.com/users/priyabratap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-28T06:38:17Z","updated_at":"2019-05-28T06:38:17Z","author_association":"NONE","body":"Hi @wohali ,\r\nThanks for your response.\r\n\r\nWithout upgrading CouchDB, I checked the line `bash /tmp/baby` in `local.ini` / `default.ini` and it's not there. Then I checked below file and uncomment and restarted, but facing the same issue.\r\n```\r\n/opt/couchdb/etc/local.d/10-admins.ini\r\n[update_notification]\r\nindex-updater = bash /tmp/baby\r\n```\r\nIt didn't help.\r\n\r\nCould you please let me know \"How can I upgrade to CouchDB 2.3.0 or 2.3.1 without current CouchDB Data loss\"?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496384566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496386289","html_url":"https://github.com/apache/couchdb/issues/2038#issuecomment-496386289","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2038","id":496386289,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjM4NjI4OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-28T06:45:27Z","updated_at":"2019-05-28T06:45:27Z","author_association":"MEMBER","body":"Yes, that would be the line. Remove the `index-updater = bash /tmp/baby` line.\r\n\r\nCan you share a new `couch.log` after removal of this line?\r\n\r\nIf you installed via Debian/Ubuntu/RedHat/Centos package, you can simply upgrade using those package tools. There are also docker containers. Updating from 2.2.0 to 2.3.1 will not cause data loss, but you always want to take backups first, yes? :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496386289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496389908","html_url":"https://github.com/apache/couchdb/issues/2038#issuecomment-496389908","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2038","id":496389908,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjM4OTkwOA==","user":{"login":"priyabratap","id":6428176,"node_id":"MDQ6VXNlcjY0MjgxNzY=","avatar_url":"https://avatars.githubusercontent.com/u/6428176?v=4","gravatar_id":"","url":"https://api.github.com/users/priyabratap","html_url":"https://github.com/priyabratap","followers_url":"https://api.github.com/users/priyabratap/followers","following_url":"https://api.github.com/users/priyabratap/following{/other_user}","gists_url":"https://api.github.com/users/priyabratap/gists{/gist_id}","starred_url":"https://api.github.com/users/priyabratap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyabratap/subscriptions","organizations_url":"https://api.github.com/users/priyabratap/orgs","repos_url":"https://api.github.com/users/priyabratap/repos","events_url":"https://api.github.com/users/priyabratap/events{/privacy}","received_events_url":"https://api.github.com/users/priyabratap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-28T06:59:49Z","updated_at":"2019-05-28T06:59:49Z","author_association":"NONE","body":"Please find the new log\r\n\r\n```\r\n state: {os_proc,\"bash /tmp/baby\",#Port<0.7484>,#Fun<couch_os_process.writejson.2>,#Fun<couch_os_process.readjson.1>,5000,300000}\r\n[error] 2019-05-28T06:59:01.005147Z couchdb@127.0.0.1 <0.1248.0> -------- Update notificatio process <0.1249.0> died: {exit_status,127}\r\n[error] 2019-05-28T06:59:01.005339Z couchdb@127.0.0.1 <0.1249.0> -------- CRASH REPORT Process  (<0.1249.0>) with 0 neighbors exited with reason: {exit_status,127} at gen_server:terminate/7(line:826) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_os_process,init,['Argument__1']}, ancestors: [<0.1248.0>,couch_event_os_sup,couch_event_sup2,...], messages: [], links: [<0.1248.0>], dictionary: [], trap_exit: false, status: running, heap_size: 987, stack_size: 27, reductions: 804\r\n[error] 2019-05-28T06:59:01.006039Z couchdb@127.0.0.1 <0.1096.0> -------- Supervisor couch_event_os_sup had child \"# index-updater\" started with couch_event_os_listener:start_link(\"bash /tmp/baby\") at <0.1248.0> exit with reason normal in context child_terminated\r\n[error] 2019-05-28T06:59:01.006474Z couchdb@127.0.0.1 <0.1096.0> -------- Supervisor couch_event_os_sup had child \"# index-updater\" started with couch_event_os_listener:start_link(\"bash /tmp/baby\") at <0.1248.0> exit with reason reached_max_restart_intensity in context shutdown\r\n[error] 2019-05-28T06:59:01.006736Z couchdb@127.0.0.1 <0.181.0> -------- Supervisor couch_event_sup2 had child couch_event_os_sup started with couch_event_os_sup:start_link() at <0.1096.0> exit with reason shutdown in context child_terminated\r\n[error] 2019-05-28T06:59:01.006883Z couchdb@127.0.0.1 <0.181.0> -------- Supervisor couch_event_sup2 had child couch_event_os_sup started with couch_event_os_sup:start_link() at <0.1096.0> exit with reason reached_max_restart_intensity in context shutdown\r\n[info] 2019-05-28T06:59:01.010217Z couchdb@127.0.0.1 <0.7.0> -------- Application couch_event exited with reason: shutdown\r\n[error] 2019-05-28T06:59:01.022612Z couchdb@127.0.0.1 <0.346.0> -------- gen_server <0.346.0> terminated with reason: killed\r\n  last msg: {'EXIT',<0.343.0>,killed}\r\n     state: {st,<0.343.0>,couch_mrview_index,undefined}\r\n[error] 2019-05-28T06:59:01.022731Z couchdb@127.0.0.1 <0.346.0> -------- CRASH REPORT Process  (<0.346.0>) with 0 neighbors exited with reason: killed at gen_server:terminate/7(line:826) <= proc_lib:init_p_do_apply/3(line:240); initial_call: {couch_index_compactor,init,['Argument__1']}, ancestors: [<0.343.0>,<0.342.0>], messages: [], links: [], dictionary: [], trap_exit: true, status: running, heap_size: 376, stack_size: 27, reductions: 126\r\n[error] 2019-05-28T06:59:01.023148Z couchdb@127.0.0.1 <0.345.0> -------- gen_server <0.345.0> terminated with reason: killed\r\n  last msg: {'EXIT',<0.343.0>,killed}\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496389908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496390123","html_url":"https://github.com/apache/couchdb/issues/2038#issuecomment-496390123","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2038","id":496390123,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjM5MDEyMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-28T07:00:33Z","updated_at":"2019-05-28T07:00:33Z","author_association":"MEMBER","body":"You can't comment the line out with `#`.\r\n\r\nCompletely remove the line and try again.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496390123/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496390679","html_url":"https://github.com/apache/couchdb/issues/2038#issuecomment-496390679","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2038","id":496390679,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjM5MDY3OQ==","user":{"login":"priyabratap","id":6428176,"node_id":"MDQ6VXNlcjY0MjgxNzY=","avatar_url":"https://avatars.githubusercontent.com/u/6428176?v=4","gravatar_id":"","url":"https://api.github.com/users/priyabratap","html_url":"https://github.com/priyabratap","followers_url":"https://api.github.com/users/priyabratap/followers","following_url":"https://api.github.com/users/priyabratap/following{/other_user}","gists_url":"https://api.github.com/users/priyabratap/gists{/gist_id}","starred_url":"https://api.github.com/users/priyabratap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyabratap/subscriptions","organizations_url":"https://api.github.com/users/priyabratap/orgs","repos_url":"https://api.github.com/users/priyabratap/repos","events_url":"https://api.github.com/users/priyabratap/events{/privacy}","received_events_url":"https://api.github.com/users/priyabratap/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-28T07:02:23Z","updated_at":"2019-05-28T07:02:23Z","author_association":"NONE","body":"Now It's working. Thanks for your help.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496390679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496488908","html_url":"https://github.com/apache/couchdb/pull/2036#issuecomment-496488908","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2036","id":496488908,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjQ4ODkwOA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-28T12:07:11Z","updated_at":"2019-05-28T12:07:11Z","author_association":"CONTRIBUTOR","body":"Closing in favor of https://github.com/apache/couchdb/pull/2039","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/496488908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497028233","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497028233","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497028233,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzAyODIzMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-29T17:14:52Z","updated_at":"2019-05-29T17:14:52Z","author_association":"MEMBER","body":"In 1.x, if you purge more than a single document at a time, your views must all rebuild entirely from scratch. The recommended approach in 1.x is to purge a single document, then GET a view from each design document, then repeat until all documents are purged. The GET process is what heals the view from that single purge, and only a single purge can be handled by this mechanism.\r\n\r\nNot sure if this is what you mean by \"touch\" a design document or not.\r\n\r\nI don't remember anything about the purge sequences, sorry.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497028233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497177338","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497177338","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497177338,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzE3NzMzOA==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T02:25:41Z","updated_at":"2019-05-30T02:40:31Z","author_association":"NONE","body":"> In 1.x, if you purge more than a single document at a time, your views must all rebuild entirely from scratch. The recommended approach in 1.x is to purge a single document, then GET a view from each design document, then repeat until all documents are purged. The GET process is what heals the view from that single purge, and only a single purge can be handled by this mechanism.\r\n> \r\n> Not sure if this is what you mean by \"touch\" a design document or not.\r\n> \r\n> I don't remember anything about the purge sequences, sorry.\r\n\r\nWe definitely purge more than a single document at a time. The upper bound is 20,000 documents (purged in batches) for a purge but on average it is around 100 - 1000 documents during a single purge window.\r\n\r\nAnd yes that is what I meant by \"touching\" the design documents after a purge. So are you saying if we purge multiple documents, a simple GET call is not going to do a re-index or will it rebuild an entirely new index from scratch?\r\n\r\nI do think it's the latter since the purge implementation has been in production for over 2 years and for the most part, has worked without any problems. I am also concerned if frequent use of the **_purge** endpoint could cause data corruptions which in turn would cause the view indexing to fail. (Reference: https://github.com/apache/couchdb/issues/758)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497177338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497182322","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497182322","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497182322,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzE4MjMyMg==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T02:52:53Z","updated_at":"2019-05-30T02:52:53Z","author_association":"CONTRIBUTOR","body":"As @wohali mentioned \"In 1.x, if you purge more than a single document at a time, your views must all rebuild entirely from scratch.\". In order to prevent from rebuilding index, you have to purge documents one by one by \r\n- Stop mem3_sync on all nodes\r\n- Run the purge for each copy of the shard\r\n- Restart mem3_sync across the cluster","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497182322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497183218","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497183218","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497183218,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzE4MzIxOA==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T02:57:33Z","updated_at":"2019-05-30T02:57:33Z","author_association":"NONE","body":"> As @wohali mentioned \"In 1.x, if you purge more than a single document at a time, your views must all rebuild entirely from scratch.\". In order to prevent from rebuilding index, you have to purge documents one by one by\r\n> \r\n> * Stop mem3_sync on all nodes\r\n> * Run the purge for each copy of the shard\r\n> * Restart mem3_sync across the cluster\r\n\r\nI understood that. My question is if multiple documents are purged at a time, will a GET perform this said rebuild from scratch?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497183218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497185289","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497185289","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497185289,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzE4NTI4OQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T03:09:09Z","updated_at":"2019-05-30T03:09:09Z","author_association":"CONTRIBUTOR","body":"> My question is if multiple documents are purged at a time, will a GET perform this said rebuild from scratch?\r\n\r\nmy understanding is that the rebuilding of index depends on the condition here https://github.com/apache/couchdb-couch-index/blob/master/src/couch_index_updater.erl#L204. i.e. the value of `DbPurgeSeq` and `IdxPurgeSeq` when GET is performed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497185289/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497203646","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497203646","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497203646,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzIwMzY0Ng==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T05:03:52Z","updated_at":"2019-05-30T05:24:18Z","author_association":"NONE","body":"> > My question is if multiple documents are purged at a time, will a GET perform this said rebuild from scratch?\r\n> \r\n> my understanding is that the rebuilding of index depends on the condition here https://github.com/apache/couchdb-couch-index/blob/master/src/couch_index_updater.erl#L204. i.e. the value of `DbPurgeSeq` and `IdxPurgeSeq` when GET is performed.\r\n\r\nBased on the **purge_index(Db, Mod, IdxState)** function logic (forgive me if I am wrong, I am not familiar with Erlang syntax), it looks like if the purge sequence diff is greater than 1, a complete reset of the view indexes is done. \r\n\r\nThis would mean that even if multiple documents are purged, the views should be rebuilt from scratch which would ideally get rid of any stale data. This is consistent with our production behavior except when this issue happens.\r\n\r\nIs my understanding correct and based on that do you think the bulk purging of documents could cause issues with a complete rebuild of view indexes?\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497203646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497213595","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497213595","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497213595,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzIxMzU5NQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T05:57:55Z","updated_at":"2019-05-30T05:57:55Z","author_association":"CONTRIBUTOR","body":"> Is my understanding correct and based on that do you think the bulk purging of documents could cause issues with a complete rebuild of view indexes?\r\n\r\nIf multiple documents are purged and it causes that purge-seq diff is greater than 1, it will cause rebuilding of index..","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497213595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497214436","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497214436","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497214436,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzIxNDQzNg==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T06:01:51Z","updated_at":"2019-05-30T06:01:51Z","author_association":"NONE","body":"> > Is my understanding correct and based on that do you think the bulk purging of documents could cause issues with a complete rebuild of view indexes?\r\n> \r\n> If multiple documents are purged and it causes that purge-seq diff is greater than 1, it will cause rebuilding of index..\r\n\r\nThank you. And this will ideally get rid of purged documents from the index as well right?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497214436/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497215742","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497215742","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497215742,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzIxNTc0Mg==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T06:07:58Z","updated_at":"2019-05-30T06:07:58Z","author_association":"CONTRIBUTOR","body":"> Thank you. And this will ideally get rid of purged documents from the index as well right?\r\n\r\nYes, if there is no mem3-sync happened during this phase. So this is why I mentioned early to stop mem3. \r\nBTW: in recent version of couchdb, we ship clustered purge which can prevent from rebuilding of index when multiple documents are purged.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497215742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497217811","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497217811","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497217811,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzIxNzgxMQ==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T06:17:18Z","updated_at":"2019-05-30T06:17:18Z","author_association":"NONE","body":"> mem3-sync\r\n\r\nSorry I am not familiar with mem3-sync. We use CouchDB 1.6.1 and our production setup for a given operator has a local CouchDB on a device which syncs with a cloud CouchDB through replication. Is this still applicable for our scenario?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497217811/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497218425","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497218425","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497218425,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzIxODQyNQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T06:20:12Z","updated_at":"2019-05-30T06:20:12Z","author_association":"CONTRIBUTOR","body":"It is about sync among nodes in one cluster, and different from replication from local couchdb to remote couchdb. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497218425/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497226567","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497226567","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497226567,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzIyNjU2Nw==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T06:56:03Z","updated_at":"2019-05-30T07:01:59Z","author_association":"NONE","body":"Appreciate your input on this matter. So it looks like our production setup should ideally work as expected. I am inclined towards some form of view/data corruption due to the bulk purging of documents that are performed daily (Reference: https://github.com/apache/couchdb/issues/758 another issue that we have faced), which in turn could cause the index rebuilding to fail. \r\n\r\nStill not sure how I can get to the bottom of this, unfortunately. \r\n\r\nApologies for the excessive questioning, but would an error during an index rebuild get thrown in the Couch log files or is it possible that a view re-index can silently fail without any indications? /var/log/couchdb/couch.log did not show any related errors when this happened.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497226567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497262405","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497262405","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497262405,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzI2MjQwNQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T09:11:10Z","updated_at":"2019-05-30T09:11:10Z","author_association":"CONTRIBUTOR","body":"Why we expect the failure of rebuilding of index? I am afraid that some rebuilding of index is not triggered in some occasional case and this caused stale data. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497262405/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497270145","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497270145","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497270145,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzI3MDE0NQ==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T09:38:43Z","updated_at":"2019-05-30T09:38:59Z","author_association":"NONE","body":"> Why we expect the failure of rebuilding of index?\r\n\r\nBecause as far as I can see there is no other explanation for the stale views since after the purge, a GET is performed on the views to trigger a re-indexing which (based on what we have discussed) rebuilds the indexes from scratch.\r\n\r\n> I am afraid that some rebuilding of index is not triggered in some occasional case and this caused stale data.\r\n\r\nIs there a way I could track if this is what's actually happened or even recreate it in a local setup?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497270145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497271358","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497271358","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497271358,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzI3MTM1OA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-30T09:43:12Z","updated_at":"2019-05-30T09:43:12Z","author_association":"CONTRIBUTOR","body":"Using recon_trace(https://ferd.github.io/recon/recon_trace.html), we can see the underlying thing.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497271358/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497592628","html_url":"https://github.com/apache/couchdb/issues/2040#issuecomment-497592628","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2040","id":497592628,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzU5MjYyOA==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-31T06:30:17Z","updated_at":"2019-05-31T06:30:17Z","author_association":"NONE","body":"@wohali do you have any further input regarding this? Would appreciate some directions to get to the bottom of this.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497592628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497664161","html_url":"https://github.com/apache/couchdb/issues/2041#issuecomment-497664161","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2041","id":497664161,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzY2NDE2MQ==","user":{"login":"vincnetas","id":472357,"node_id":"MDQ6VXNlcjQ3MjM1Nw==","avatar_url":"https://avatars.githubusercontent.com/u/472357?v=4","gravatar_id":"","url":"https://api.github.com/users/vincnetas","html_url":"https://github.com/vincnetas","followers_url":"https://api.github.com/users/vincnetas/followers","following_url":"https://api.github.com/users/vincnetas/following{/other_user}","gists_url":"https://api.github.com/users/vincnetas/gists{/gist_id}","starred_url":"https://api.github.com/users/vincnetas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vincnetas/subscriptions","organizations_url":"https://api.github.com/users/vincnetas/orgs","repos_url":"https://api.github.com/users/vincnetas/repos","events_url":"https://api.github.com/users/vincnetas/events{/privacy}","received_events_url":"https://api.github.com/users/vincnetas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-31T10:40:26Z","updated_at":"2019-05-31T10:40:26Z","author_association":"NONE","body":"Identical issue was closed as wont implement here (for older version) : https://issues.apache.org/jira/browse/COUCHDB-3161\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497664161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497699154","html_url":"https://github.com/apache/couchdb/issues/1550#issuecomment-497699154","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1550","id":497699154,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzY5OTE1NA==","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-05-31T12:58:06Z","updated_at":"2019-05-31T12:58:06Z","author_association":"NONE","body":"Has this been fixed in 2.3? Seem to still have this issue @wohali ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/497699154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498330929","html_url":"https://github.com/apache/couchdb/issues/1479#issuecomment-498330929","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1479","id":498330929,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODMzMDkyOQ==","user":{"login":"andrewborell","id":12565131,"node_id":"MDQ6VXNlcjEyNTY1MTMx","avatar_url":"https://avatars.githubusercontent.com/u/12565131?v=4","gravatar_id":"","url":"https://api.github.com/users/andrewborell","html_url":"https://github.com/andrewborell","followers_url":"https://api.github.com/users/andrewborell/followers","following_url":"https://api.github.com/users/andrewborell/following{/other_user}","gists_url":"https://api.github.com/users/andrewborell/gists{/gist_id}","starred_url":"https://api.github.com/users/andrewborell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrewborell/subscriptions","organizations_url":"https://api.github.com/users/andrewborell/orgs","repos_url":"https://api.github.com/users/andrewborell/repos","events_url":"https://api.github.com/users/andrewborell/events{/privacy}","received_events_url":"https://api.github.com/users/andrewborell/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-03T16:32:38Z","updated_at":"2019-06-03T16:35:26Z","author_association":"NONE","body":"I just observed this behavior in the same version with a POST request by dumping an unexpected key in the JSON body. The response returns every record in the database!!!  I'm not sure what is more insane: This issue hasnt received any attention, or that it exists in the first place.  \r\n\r\n**WHEN A QUERY IS MADE WITH AN INVALID SELECTOR OR FILTERING PARAMS THE REQUEST SHOULD GET DROPPED WITH A 400 BAD REQUEST MESSAGE.**  \r\n\r\nIt is one thing if the values do not exist but when the keys are unexpected and the request returns the entire database, that is a MAJOR problem. \r\n\r\nGiven the severity of this issue I am very concerned that no one has responded to this matter in almost a year.  Should we be abandoning couchdb for business purposes or development is silently addressing the issue? I cannot think of a practical application where this issue would not be a major concern.  ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498330929/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498632137","html_url":"https://github.com/apache/couchdb/issues/2042#issuecomment-498632137","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2042","id":498632137,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODYzMjEzNw==","user":{"login":"ceremcem","id":6639874,"node_id":"MDQ6VXNlcjY2Mzk4NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/6639874?v=4","gravatar_id":"","url":"https://api.github.com/users/ceremcem","html_url":"https://github.com/ceremcem","followers_url":"https://api.github.com/users/ceremcem/followers","following_url":"https://api.github.com/users/ceremcem/following{/other_user}","gists_url":"https://api.github.com/users/ceremcem/gists{/gist_id}","starred_url":"https://api.github.com/users/ceremcem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ceremcem/subscriptions","organizations_url":"https://api.github.com/users/ceremcem/orgs","repos_url":"https://api.github.com/users/ceremcem/repos","events_url":"https://api.github.com/users/ceremcem/events{/privacy}","received_events_url":"https://api.github.com/users/ceremcem/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-04T11:27:28Z","updated_at":"2019-06-04T11:27:28Z","author_association":"CONTRIBUTOR","body":"@sudhir-naico Would you mind explaining how this bug is resolved? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498632137/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498671497","html_url":"https://github.com/apache/couchdb/issues/2033#issuecomment-498671497","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2033","id":498671497,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODY3MTQ5Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-04T13:28:11Z","updated_at":"2019-06-04T13:28:11Z","author_association":"MEMBER","body":"Chatted again with Bertrand and it doesn't sound like we need to do anything here. Closing it out.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498671497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498700770","html_url":"https://github.com/apache/couchdb/issues/2043#issuecomment-498700770","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2043","id":498700770,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODcwMDc3MA==","user":{"login":"MatteoGuadrini","id":29921418,"node_id":"MDQ6VXNlcjI5OTIxNDE4","avatar_url":"https://avatars.githubusercontent.com/u/29921418?v=4","gravatar_id":"","url":"https://api.github.com/users/MatteoGuadrini","html_url":"https://github.com/MatteoGuadrini","followers_url":"https://api.github.com/users/MatteoGuadrini/followers","following_url":"https://api.github.com/users/MatteoGuadrini/following{/other_user}","gists_url":"https://api.github.com/users/MatteoGuadrini/gists{/gist_id}","starred_url":"https://api.github.com/users/MatteoGuadrini/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MatteoGuadrini/subscriptions","organizations_url":"https://api.github.com/users/MatteoGuadrini/orgs","repos_url":"https://api.github.com/users/MatteoGuadrini/repos","events_url":"https://api.github.com/users/MatteoGuadrini/events{/privacy}","received_events_url":"https://api.github.com/users/MatteoGuadrini/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-04T14:39:38Z","updated_at":"2019-06-04T14:39:38Z","author_association":"NONE","body":"Ok, I understand how it works: `PUT http://localhost:5984/test2/test?rev=3-23d3302b961ffa526aaf5a998a08a1f5&new_edits=false`\r\nYou must specify before the parameter which revision you want to overwrite.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498700770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498955275","html_url":"https://github.com/apache/couchdb/issues/2042#issuecomment-498955275","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2042","id":498955275,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODk1NTI3NQ==","user":{"login":"sudhir-naico","id":33647716,"node_id":"MDQ6VXNlcjMzNjQ3NzE2","avatar_url":"https://avatars.githubusercontent.com/u/33647716?v=4","gravatar_id":"","url":"https://api.github.com/users/sudhir-naico","html_url":"https://github.com/sudhir-naico","followers_url":"https://api.github.com/users/sudhir-naico/followers","following_url":"https://api.github.com/users/sudhir-naico/following{/other_user}","gists_url":"https://api.github.com/users/sudhir-naico/gists{/gist_id}","starred_url":"https://api.github.com/users/sudhir-naico/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sudhir-naico/subscriptions","organizations_url":"https://api.github.com/users/sudhir-naico/orgs","repos_url":"https://api.github.com/users/sudhir-naico/repos","events_url":"https://api.github.com/users/sudhir-naico/events{/privacy}","received_events_url":"https://api.github.com/users/sudhir-naico/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-05T06:26:53Z","updated_at":"2019-06-05T06:26:53Z","author_association":"NONE","body":"@ceremcem , This is related to azure portal issue. I have already added a rule to allow the port 5984 to the required public IP address in VM Networking section. But it was somehow not working. I modified the rule to allow the port 5984 to all public IP Address by setting source and destination to 'Any'. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498955275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498993741","html_url":"https://github.com/apache/couchdb/issues/2042#issuecomment-498993741","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2042","id":498993741,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODk5Mzc0MQ==","user":{"login":"ceremcem","id":6639874,"node_id":"MDQ6VXNlcjY2Mzk4NzQ=","avatar_url":"https://avatars.githubusercontent.com/u/6639874?v=4","gravatar_id":"","url":"https://api.github.com/users/ceremcem","html_url":"https://github.com/ceremcem","followers_url":"https://api.github.com/users/ceremcem/followers","following_url":"https://api.github.com/users/ceremcem/following{/other_user}","gists_url":"https://api.github.com/users/ceremcem/gists{/gist_id}","starred_url":"https://api.github.com/users/ceremcem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ceremcem/subscriptions","organizations_url":"https://api.github.com/users/ceremcem/orgs","repos_url":"https://api.github.com/users/ceremcem/repos","events_url":"https://api.github.com/users/ceremcem/events{/privacy}","received_events_url":"https://api.github.com/users/ceremcem/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-05T08:41:57Z","updated_at":"2019-06-05T08:41:57Z","author_association":"CONTRIBUTOR","body":"Thanks for the explanation. So there is nothing to worry about. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/498993741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499051830","html_url":"https://github.com/apache/couchdb/issues/2044#issuecomment-499051830","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2044","id":499051830,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTA1MTgzMA==","user":{"login":"sarveshtamba","id":37213716,"node_id":"MDQ6VXNlcjM3MjEzNzE2","avatar_url":"https://avatars.githubusercontent.com/u/37213716?v=4","gravatar_id":"","url":"https://api.github.com/users/sarveshtamba","html_url":"https://github.com/sarveshtamba","followers_url":"https://api.github.com/users/sarveshtamba/followers","following_url":"https://api.github.com/users/sarveshtamba/following{/other_user}","gists_url":"https://api.github.com/users/sarveshtamba/gists{/gist_id}","starred_url":"https://api.github.com/users/sarveshtamba/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sarveshtamba/subscriptions","organizations_url":"https://api.github.com/users/sarveshtamba/orgs","repos_url":"https://api.github.com/users/sarveshtamba/repos","events_url":"https://api.github.com/users/sarveshtamba/events{/privacy}","received_events_url":"https://api.github.com/users/sarveshtamba/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-05T11:53:16Z","updated_at":"2019-06-05T11:53:16Z","author_association":"CONTRIBUTOR","body":"Please note, I was able to configure and build couchdb using non-root user though with disable-docs option.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499051830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499059649","html_url":"https://github.com/apache/couchdb/issues/2044#issuecomment-499059649","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2044","id":499059649,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTA1OTY0OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-05T12:20:22Z","updated_at":"2019-06-05T12:20:22Z","author_association":"MEMBER","body":"Thanks @sarveshtamba .\r\n\r\nWe don't support Erlang 18 anymore. Explicitly, newer versions of CouchDB than 2.3.1 will require Erlang 19+ (or maybe newer). We will not go back to supporting lower versions of Erlang, so you'll need to compile and install Erlang from scratch. \r\n\r\nYou probably need Python 3 at this point for the documentation build; our build machines no longer run Sphinx with Python 2. I'd give that a try.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499059649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499157754","html_url":"https://github.com/apache/couchdb/issues/2045#issuecomment-499157754","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2045","id":499157754,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTE1Nzc1NA==","user":{"login":"sansato","id":46877906,"node_id":"MDQ6VXNlcjQ2ODc3OTA2","avatar_url":"https://avatars.githubusercontent.com/u/46877906?v=4","gravatar_id":"","url":"https://api.github.com/users/sansato","html_url":"https://github.com/sansato","followers_url":"https://api.github.com/users/sansato/followers","following_url":"https://api.github.com/users/sansato/following{/other_user}","gists_url":"https://api.github.com/users/sansato/gists{/gist_id}","starred_url":"https://api.github.com/users/sansato/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sansato/subscriptions","organizations_url":"https://api.github.com/users/sansato/orgs","repos_url":"https://api.github.com/users/sansato/repos","events_url":"https://api.github.com/users/sansato/events{/privacy}","received_events_url":"https://api.github.com/users/sansato/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-05T16:28:55Z","updated_at":"2019-06-05T16:28:55Z","author_association":"NONE","body":"The context in this ticket is overly complicated.  As described in the mailing list, small reproducer is 1) purge more than one document and 2) query the index.\r\n\r\nThe workaround is 1) purge one document and 2) query the index immediately after the purge.  Repeat if additional documents need to be purged.  \r\n\r\nThis is a known issue in the 1.x series.  Did you try the scenario with current 2.x version?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499157754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499205757","html_url":"https://github.com/apache/couchdb/issues/2045#issuecomment-499205757","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2045","id":499205757,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTIwNTc1Nw==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-05T18:40:30Z","updated_at":"2019-06-05T18:40:30Z","author_association":"NONE","body":"Thank you for the response! What do you mean by mailing list?\r\n\r\nI was of the impression that if the diff between the database and view purge sequences is greater than 1, a complete rebuilding of the indexes will take place which would ideally update the indexes properly.\r\n\r\nThis piece of code reflects the same: https://github.com/apache/couchdb-couch-index/blob/master/src/couch_index_updater.erl#L204\r\n\r\nI am not sure how purging a conflicting revision tree could change this though. Haven't tested this on 2.x I will do that and update the results here.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499205757/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499212134","html_url":"https://github.com/apache/couchdb/issues/2046#issuecomment-499212134","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2046","id":499212134,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTIxMjEzNA==","user":{"login":"natevw","id":265902,"node_id":"MDQ6VXNlcjI2NTkwMg==","avatar_url":"https://avatars.githubusercontent.com/u/265902?v=4","gravatar_id":"","url":"https://api.github.com/users/natevw","html_url":"https://github.com/natevw","followers_url":"https://api.github.com/users/natevw/followers","following_url":"https://api.github.com/users/natevw/following{/other_user}","gists_url":"https://api.github.com/users/natevw/gists{/gist_id}","starred_url":"https://api.github.com/users/natevw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/natevw/subscriptions","organizations_url":"https://api.github.com/users/natevw/orgs","repos_url":"https://api.github.com/users/natevw/repos","events_url":"https://api.github.com/users/natevw/events{/privacy}","received_events_url":"https://api.github.com/users/natevw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-05T18:58:13Z","updated_at":"2019-06-05T18:58:13Z","author_association":"NONE","body":"Closing this since the I'm realizing the DB server here is still a 1.x build, and am not seeing this offhand with 2.x.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499212134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499326164","html_url":"https://github.com/apache/couchdb/issues/2045#issuecomment-499326164","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2045","id":499326164,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTMyNjE2NA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-06T02:38:15Z","updated_at":"2019-06-06T02:38:15Z","author_association":"CONTRIBUTOR","body":"hey @priyath if we didn't purge all leaf revisions, the document still exists and it makes sense that it can be visible to view. \r\n\r\nIn clustered purge, we can specify all leaf revisions in one POST requests, documents will be purged totally. Of course, we can select to purge all but one, thus the expected revision will be left. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499326164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499334850","html_url":"https://github.com/apache/couchdb/issues/2045#issuecomment-499334850","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2045","id":499334850,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTMzNDg1MA==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-06T03:30:15Z","updated_at":"2019-06-06T03:30:15Z","author_association":"NONE","body":"> hey @priyath if we didn't purge all leaf revisions, the document still exists and it makes sense that it can be visible to view.\r\n\r\nAgreed. But when the reverted leaf revision is purged again as in this scenario, the document is completely removed as expected but the ID still remains in the index resulting in a stale view.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499334850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499336304","html_url":"https://github.com/apache/couchdb/issues/2045#issuecomment-499336304","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2045","id":499336304,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTMzNjMwNA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-06T03:39:22Z","updated_at":"2019-06-06T03:39:22Z","author_association":"CONTRIBUTOR","body":"I see, and then my assumption is that the reverted leaf revision doesn't trigger update of update-seq, and thus view update doesn't happen to update index. Clustered purge should not have such behavior. You can have a try on clustered purge if feasible.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499336304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499359132","html_url":"https://github.com/apache/couchdb/issues/2045#issuecomment-499359132","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2045","id":499359132,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTM1OTEzMg==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-06T05:56:27Z","updated_at":"2019-06-06T06:10:51Z","author_association":"NONE","body":"> I see, and then my assumption is that the reverted leaf revision doesn't trigger an update of update-seq\r\n\r\nI see. But why wouldn't a complete rebuild of the index after the next purge fix the indexes?  \r\n\r\nI ask this because the only way to get the views to return the correct data is by deleting all the *.view files from the system.\r\n\r\nedit: I checked the database update_seq after the purge of the conflicted revision. It had incremented by one","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499359132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499385431","html_url":"https://github.com/apache/couchdb/issues/2045#issuecomment-499385431","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2045","id":499385431,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTM4NTQzMQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-06T07:41:12Z","updated_at":"2019-06-06T07:41:12Z","author_association":"CONTRIBUTOR","body":"could you also check the IdxPurgeSeq of shard database before running query to trigger index update so that we can see which branch of codes https://github.com/apache/couchdb-couch-index/blob/master/src/couch_index_updater.erl#L204 was executed?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499385431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499392185","html_url":"https://github.com/apache/couchdb/issues/2045#issuecomment-499392185","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2045","id":499392185,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTM5MjE4NQ==","user":{"login":"priyath","id":10166923,"node_id":"MDQ6VXNlcjEwMTY2OTIz","avatar_url":"https://avatars.githubusercontent.com/u/10166923?v=4","gravatar_id":"","url":"https://api.github.com/users/priyath","html_url":"https://github.com/priyath","followers_url":"https://api.github.com/users/priyath/followers","following_url":"https://api.github.com/users/priyath/following{/other_user}","gists_url":"https://api.github.com/users/priyath/gists{/gist_id}","starred_url":"https://api.github.com/users/priyath/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/priyath/subscriptions","organizations_url":"https://api.github.com/users/priyath/orgs","repos_url":"https://api.github.com/users/priyath/repos","events_url":"https://api.github.com/users/priyath/events{/privacy}","received_events_url":"https://api.github.com/users/priyath/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-06T08:03:57Z","updated_at":"2019-06-06T08:03:57Z","author_association":"NONE","body":"> could you also check the IdxPurgeSeq\r\n\r\nIs this the same value that is found in the purge_seq attribute returned from the _design/ddoc/_info endpoint? Or is there another way to obtain the IdxPurgeSeq value.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499392185/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499397565","html_url":"https://github.com/apache/couchdb/issues/2045#issuecomment-499397565","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2045","id":499397565,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTM5NzU2NQ==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-06T08:21:10Z","updated_at":"2019-06-06T08:21:10Z","author_association":"CONTRIBUTOR","body":"Not sure whether you are familiar with `remsh` and we can use https://github.com/apache/couchdb-couch/blob/21c8d37ac6ee1a7fed1de1f54f95a4d3cd9f5248/src/couch_db.erl#L304","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499397565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499422265","html_url":"https://github.com/apache/couchdb/issues/2047#issuecomment-499422265","issue_url":"https://api.github.com/repos/apache/couchdb/issues/2047","id":499422265,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTQyMjI2NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-06T09:33:10Z","updated_at":"2019-06-06T09:33:10Z","author_association":"MEMBER","body":"The release notes\r\n\r\nhttp://docs.couchdb.org/en/stable/whatsnew/2.3.html\r\n\r\nsay:\r\n\r\n#1875: Refuse building with known bad versions of Erlang.\r\n\r\nThe number is actually wrong, it should be #1857 which was fixed after release. T\r\n\r\nWe unfortunately had to blacklist specific versions of Erlang for known issues, which includes versions of 20.x prior to 20.3.8.11 or higher.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/499422265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]