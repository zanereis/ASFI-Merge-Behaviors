[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102474177","html_url":"https://github.com/apache/iceberg/pull/4534#issuecomment-1102474177","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4534","id":1102474177,"node_id":"IC_kwDOCW7NX85BtmvB","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T10:21:39Z","updated_at":"2022-04-19T10:21:39Z","author_association":"MEMBER","body":"AC\r\n\r\nAll comments applied or answered to.\r\nDo you want me to mark them as resolved?\r\n\r\n@RussellSpitzer @kbendick do you mind to take another look and let me know what else I could change here?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102474177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102578232","html_url":"https://github.com/apache/iceberg/pull/4561#issuecomment-1102578232","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4561","id":1102578232,"node_id":"IC_kwDOCW7NX85BuAI4","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T12:21:57Z","updated_at":"2022-04-19T12:21:57Z","author_association":"MEMBER","body":"I think it's reasonable to add the new unit test based on the original unit tests. So I'm okay to skip the credit for the old PR.  Thanks all for the reviewing !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102578232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102581835","html_url":"https://github.com/apache/iceberg/pull/4553#issuecomment-1102581835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4553","id":1102581835,"node_id":"IC_kwDOCW7NX85BuBBL","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T12:26:08Z","updated_at":"2022-04-19T12:26:08Z","author_association":"MEMBER","body":"@kbendick I think we've just merged few iceberg PRs for the old flink 1.14, would you mind to update this PR to include those latest changes to flink 1.15 ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102581835/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102809317","html_url":"https://github.com/apache/iceberg/issues/4583#issuecomment-1102809317","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4583","id":1102809317,"node_id":"IC_kwDOCW7NX85Bu4jl","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T15:44:42Z","updated_at":"2022-04-19T15:44:42Z","author_association":"CONTRIBUTOR","body":"@singhpk234 Thanks for sharing. Yes, I think this PR will provide some help to my user-case to certain extent, but can not fully fulfill my goal.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102809317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102818720","html_url":"https://github.com/apache/iceberg/pull/4561#issuecomment-1102818720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4561","id":1102818720,"node_id":"IC_kwDOCW7NX85Bu62g","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T15:53:47Z","updated_at":"2022-04-19T15:53:47Z","author_association":"CONTRIBUTOR","body":"@wuwenchi, thanks for clarifying how the test was written! Since this was mostly a copy of an existing test then I can see why it looks so similar to the one in the other PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102818720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102819242","html_url":"https://github.com/apache/iceberg/pull/3614#issuecomment-1102819242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3614","id":1102819242,"node_id":"IC_kwDOCW7NX85Bu6-q","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T15:54:15Z","updated_at":"2022-04-19T15:54:15Z","author_association":"CONTRIBUTOR","body":"This was fixed in #4561","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102819242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102823657","html_url":"https://github.com/apache/iceberg/pull/4585#issuecomment-1102823657","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4585","id":1102823657,"node_id":"IC_kwDOCW7NX85Bu8Dp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T15:58:37Z","updated_at":"2022-04-19T15:58:37Z","author_association":"CONTRIBUTOR","body":"Thanks, @singhpk234! Looks mostly good, but I think we should use just one `stripTrailingSlash` method.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102823657/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102830037","html_url":"https://github.com/apache/iceberg/issues/4587#issuecomment-1102830037","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4587","id":1102830037,"node_id":"IC_kwDOCW7NX85Bu9nV","user":{"login":"davidjdiebold","id":10064055,"node_id":"MDQ6VXNlcjEwMDY0MDU1","avatar_url":"https://avatars.githubusercontent.com/u/10064055?v=4","gravatar_id":"","url":"https://api.github.com/users/davidjdiebold","html_url":"https://github.com/davidjdiebold","followers_url":"https://api.github.com/users/davidjdiebold/followers","following_url":"https://api.github.com/users/davidjdiebold/following{/other_user}","gists_url":"https://api.github.com/users/davidjdiebold/gists{/gist_id}","starred_url":"https://api.github.com/users/davidjdiebold/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidjdiebold/subscriptions","organizations_url":"https://api.github.com/users/davidjdiebold/orgs","repos_url":"https://api.github.com/users/davidjdiebold/repos","events_url":"https://api.github.com/users/davidjdiebold/events{/privacy}","received_events_url":"https://api.github.com/users/davidjdiebold/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T16:05:08Z","updated_at":"2022-04-19T16:05:08Z","author_association":"NONE","body":"Found the error, I was not downloading the jar correctly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102830037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102843550","html_url":"https://github.com/apache/iceberg/pull/4560#issuecomment-1102843550","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4560","id":1102843550,"node_id":"IC_kwDOCW7NX85BvA6e","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T16:19:01Z","updated_at":"2022-04-19T16:19:01Z","author_association":"CONTRIBUTOR","body":"Thanks for catching this @szehon-ho, this change looks good to me, just added a nit comment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102843550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102877437","html_url":"https://github.com/apache/iceberg/issues/4565#issuecomment-1102877437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4565","id":1102877437,"node_id":"IC_kwDOCW7NX85BvJL9","user":{"login":"nreich","id":960205,"node_id":"MDQ6VXNlcjk2MDIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/960205?v=4","gravatar_id":"","url":"https://api.github.com/users/nreich","html_url":"https://github.com/nreich","followers_url":"https://api.github.com/users/nreich/followers","following_url":"https://api.github.com/users/nreich/following{/other_user}","gists_url":"https://api.github.com/users/nreich/gists{/gist_id}","starred_url":"https://api.github.com/users/nreich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nreich/subscriptions","organizations_url":"https://api.github.com/users/nreich/orgs","repos_url":"https://api.github.com/users/nreich/repos","events_url":"https://api.github.com/users/nreich/events{/privacy}","received_events_url":"https://api.github.com/users/nreich/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T16:55:48Z","updated_at":"2022-04-19T16:55:48Z","author_association":"NONE","body":"I have been able to use the latest master to successfully conduct snapshot expiration on the table and can confirm that this issue will be resolved when #3411 is released.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102877437/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102930672","html_url":"https://github.com/apache/iceberg/pull/4491#issuecomment-1102930672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4491","id":1102930672,"node_id":"IC_kwDOCW7NX85BvWLw","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T17:56:24Z","updated_at":"2022-04-19T17:56:24Z","author_association":"MEMBER","body":"@nastra Merged! Thanks for the PR and I hope to see that Nessie Trino Support soon!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102930672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102969266","html_url":"https://github.com/apache/iceberg/issues/4346#issuecomment-1102969266","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4346","id":1102969266,"node_id":"IC_kwDOCW7NX85Bvfmy","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T18:41:38Z","updated_at":"2022-04-19T18:41:38Z","author_association":"CONTRIBUTOR","body":"> @aokolnychyi, that plan sounds great to me. I think that covers all the cases we need to.\r\n\r\nYeah this all sounds good to me as well.\r\n\r\nThe nuances / different configurations brought up between the two should be sorted out, but from a high level what's been proposed covers all issues that I have as well as various concerns that I've heard brought up in the community.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1102969266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103136490","html_url":"https://github.com/apache/iceberg/pull/4580#issuecomment-1103136490","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4580","id":1103136490,"node_id":"IC_kwDOCW7NX85BwIbq","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T20:43:14Z","updated_at":"2022-04-19T20:44:16Z","author_association":"CONTRIBUTOR","body":"Thanks @stevenzwu for the PR. I’m OK with the change, but I doubt if CDC can use the the interface IncrementalTableScan. Basically CDC requires much finer control of planning, check my CDC PR(https://github.com/apache/iceberg/pull/4539) for more details. We can keep evolving on the interface IncrementalTableScan to make it suitable for cdc in the future. It is hard to connect them at this moment. We may focus on the incremental scan itself in this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103136490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103245098","html_url":"https://github.com/apache/iceberg/pull/4580#issuecomment-1103245098","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4580","id":1103245098,"node_id":"IC_kwDOCW7NX85Bwi8q","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-19T23:04:11Z","updated_at":"2022-04-19T23:51:41Z","author_association":"CONTRIBUTOR","body":"@flyrain This is just a starting point. I am sure the current `IncrementalScan` interface is NOT good for the CDC read today, which needs more complex planning control. That was also part of the motivation when Ryan suggested.  Can CDC read leverage this `IncrementalScan` interface in the future once enhanced? Will this direction work for CDC read?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103245098/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103448541","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1103448541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1103448541,"node_id":"IC_kwDOCW7NX85BxUnd","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T04:04:35Z","updated_at":"2022-04-20T04:04:35Z","author_association":"CONTRIBUTOR","body":"@kbendick do you have any further feedback on this?\r\n@RussellSpitzer I have implemented your suggestion for a custom metric for how many delete rows are applied in a scan. I decided to open a new PR for that: #4588.\r\nI think both the number of file splits read as well as number of delete rows applied are useful metrics to show. More custom metrics can be added in future but they can be in new PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103448541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103471729","html_url":"https://github.com/apache/iceberg/issues/3941#issuecomment-1103471729","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3941","id":1103471729,"node_id":"IC_kwDOCW7NX85BxaRx","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T04:57:40Z","updated_at":"2022-04-20T04:57:40Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi great write-up on the algorithm. I think the per-snapshot algorithm is a good starting point that should cover a lot of use cases. \r\n\r\n> Build a predicate to use when looking for data records removed by position deletes.\r\n\r\nis this needed? position deletes are already applied when building insert records.\r\n\r\n> In the future, we may consider exposing an option to include equality deletes as-is without finding actually deleted records. If set to false, a delete record will only contain whatever values are in the delete file. Outputting equality deletes as-is may be enough in many cases.\r\n\r\nWhy don't we start/default to this simpler behavior of emitting equality delete as it is? Do we need to join and emit the full deleted rows? \r\n\r\n> Regarding more complex types like pre/post images, I am wondering if Iceberg CDC is the right source.\r\n\r\nLet's discuss two scenarios\r\n1. Iceberg table is populated by a streaming writer which may read from an upstream CDC stream, which has rich context of insert, delete, update (pre/post). Then we don't need to use Iceberg as CDC source\r\n2. Iceberg table is populated by periodical batch writers (like Spark). there is no upstream CDC source. In this case, since there is no pre/post update concept in Iceberg, this is not relevant here.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103471729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103535683","html_url":"https://github.com/apache/iceberg/issues/4565#issuecomment-1103535683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4565","id":1103535683,"node_id":"IC_kwDOCW7NX85Bxp5D","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T06:55:21Z","updated_at":"2022-04-20T06:55:21Z","author_association":"MEMBER","body":"@nreich : Thanks for verifying. \r\n\r\nI think we can close this issue as the fix is already present in the master branch.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103535683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103566387","html_url":"https://github.com/apache/iceberg/issues/3105#issuecomment-1103566387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3105","id":1103566387,"node_id":"IC_kwDOCW7NX85BxxYz","user":{"login":"Kshitiz-Mhto","id":102871719,"node_id":"U_kgDOBiGypw","avatar_url":"https://avatars.githubusercontent.com/u/102871719?v=4","gravatar_id":"","url":"https://api.github.com/users/Kshitiz-Mhto","html_url":"https://github.com/Kshitiz-Mhto","followers_url":"https://api.github.com/users/Kshitiz-Mhto/followers","following_url":"https://api.github.com/users/Kshitiz-Mhto/following{/other_user}","gists_url":"https://api.github.com/users/Kshitiz-Mhto/gists{/gist_id}","starred_url":"https://api.github.com/users/Kshitiz-Mhto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kshitiz-Mhto/subscriptions","organizations_url":"https://api.github.com/users/Kshitiz-Mhto/orgs","repos_url":"https://api.github.com/users/Kshitiz-Mhto/repos","events_url":"https://api.github.com/users/Kshitiz-Mhto/events{/privacy}","received_events_url":"https://api.github.com/users/Kshitiz-Mhto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T07:33:48Z","updated_at":"2022-04-20T07:33:48Z","author_association":"NONE","body":"@adiroy05  if you busy doing some other work, can i work in place of you in this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103566387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103574205","html_url":"https://github.com/apache/iceberg/issues/3105#issuecomment-1103574205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3105","id":1103574205,"node_id":"IC_kwDOCW7NX85BxzS9","user":{"login":"Kshitiz-Mhto","id":102871719,"node_id":"U_kgDOBiGypw","avatar_url":"https://avatars.githubusercontent.com/u/102871719?v=4","gravatar_id":"","url":"https://api.github.com/users/Kshitiz-Mhto","html_url":"https://github.com/Kshitiz-Mhto","followers_url":"https://api.github.com/users/Kshitiz-Mhto/followers","following_url":"https://api.github.com/users/Kshitiz-Mhto/following{/other_user}","gists_url":"https://api.github.com/users/Kshitiz-Mhto/gists{/gist_id}","starred_url":"https://api.github.com/users/Kshitiz-Mhto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kshitiz-Mhto/subscriptions","organizations_url":"https://api.github.com/users/Kshitiz-Mhto/orgs","repos_url":"https://api.github.com/users/Kshitiz-Mhto/repos","events_url":"https://api.github.com/users/Kshitiz-Mhto/events{/privacy}","received_events_url":"https://api.github.com/users/Kshitiz-Mhto/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T07:43:22Z","updated_at":"2022-04-20T07:43:22Z","author_association":"NONE","body":"i am a newbie to open source so can you provide some helps. \r\nwhere should i includes those change in \r\niceberg/docs/flink/flink-connector.md\r\nor \r\niceberg/docs/flink/flink-getting-started.md\r\nor u want something different?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103574205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103596042","html_url":"https://github.com/apache/iceberg/issues/3105#issuecomment-1103596042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3105","id":1103596042,"node_id":"IC_kwDOCW7NX85Bx4oK","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T08:08:26Z","updated_at":"2022-04-20T08:08:26Z","author_association":"CONTRIBUTOR","body":"@Kshitiz-Mhto Thank you very much for your interest. There are currently two PR's related to this, for reference:\r\nhttps://github.com/apache/iceberg/pull/3827\r\nhttps://github.com/apache/iceberg/pull/3823\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103596042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103627545","html_url":"https://github.com/apache/iceberg/pull/4463#issuecomment-1103627545","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4463","id":1103627545,"node_id":"IC_kwDOCW7NX85ByAUZ","user":{"login":"polaris6","id":29967142,"node_id":"MDQ6VXNlcjI5OTY3MTQy","avatar_url":"https://avatars.githubusercontent.com/u/29967142?v=4","gravatar_id":"","url":"https://api.github.com/users/polaris6","html_url":"https://github.com/polaris6","followers_url":"https://api.github.com/users/polaris6/followers","following_url":"https://api.github.com/users/polaris6/following{/other_user}","gists_url":"https://api.github.com/users/polaris6/gists{/gist_id}","starred_url":"https://api.github.com/users/polaris6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polaris6/subscriptions","organizations_url":"https://api.github.com/users/polaris6/orgs","repos_url":"https://api.github.com/users/polaris6/repos","events_url":"https://api.github.com/users/polaris6/events{/privacy}","received_events_url":"https://api.github.com/users/polaris6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T08:40:31Z","updated_at":"2022-04-20T08:40:31Z","author_association":"CONTRIBUTOR","body":"Hello @openinx @rdblue @RussellSpitzer, I’m sorry to bother you, this PR has been around for a long time, could somebody please help me to review and merge it, thank you very much!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103627545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103685983","html_url":"https://github.com/apache/iceberg/pull/4534#issuecomment-1103685983","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4534","id":1103685983,"node_id":"IC_kwDOCW7NX85ByOlf","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T09:21:24Z","updated_at":"2022-04-20T09:21:24Z","author_association":"MEMBER","body":"@RussellSpitzer @rdblue can you please give me more advice here?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103685983/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103691539","html_url":"https://github.com/apache/iceberg/pull/4537#issuecomment-1103691539","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4537","id":1103691539,"node_id":"IC_kwDOCW7NX85ByP8T","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T09:25:23Z","updated_at":"2022-04-20T09:25:23Z","author_association":"MEMBER","body":"( squashed and rebased on top of current version of https://github.com/apache/iceberg/pull/4534, no other changes in this push )","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103691539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103732854","html_url":"https://github.com/apache/iceberg/pull/4537#issuecomment-1103732854","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4537","id":1103732854,"node_id":"IC_kwDOCW7NX85ByaB2","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T09:54:53Z","updated_at":"2022-04-20T09:54:53Z","author_association":"MEMBER","body":"AC \r\n@rdblue  @singhpk234 thanks for your review, let me know what else I can change.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103732854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103742759","html_url":"https://github.com/apache/iceberg/issues/4095#issuecomment-1103742759","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4095","id":1103742759,"node_id":"IC_kwDOCW7NX85Byccn","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T10:01:42Z","updated_at":"2022-04-20T10:01:42Z","author_association":"CONTRIBUTOR","body":"hi @RussellSpitzer, I have tried and found it's hard to widen the result view below the search input, so I put it on the right side\r\n\r\n## when only one result\r\n![image](https://user-images.githubusercontent.com/10529123/164202923-d1723f1a-1aeb-4485-b935-34e426e9879f.png)\r\n\r\n\r\n## when more results\r\n<img width=\"1178\" alt=\"image\" src=\"https://user-images.githubusercontent.com/10529123/164202598-b1662886-f709-4ab6-a04b-58e598b16541.png\">","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103742759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103864270","html_url":"https://github.com/apache/iceberg/pull/4463#issuecomment-1103864270","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4463","id":1103864270,"node_id":"IC_kwDOCW7NX85By6HO","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T12:16:52Z","updated_at":"2022-04-20T12:23:28Z","author_association":"MEMBER","body":"~~I think there is a misconception here between data layout sort orders and the ordering of the data in a query. The orders documented by iceberg dictate how the data is physically stored in files on the disc and happens based on distribution and ordering requirements in the DSV2 api. The functions mentioned here and their sql only effect Spark on read and cause shuffles to order output for the reader but do not effect the on disc layout.~~\r\n\r\n~~The file based ordering is to make pruning of files during scan planning more efficient while the ordering during read is to satisfy user query requirements.~~","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103864270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103867821","html_url":"https://github.com/apache/iceberg/pull/4463#issuecomment-1103867821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4463","id":1103867821,"node_id":"IC_kwDOCW7NX85By6-t","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T12:20:54Z","updated_at":"2022-04-20T12:20:54Z","author_association":"MEMBER","body":"Ah never mind I think I misred this wrong this is about manually imposing sort orders for writes without using table sort orders. I think for that this is correct","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103867821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103925718","html_url":"https://github.com/apache/iceberg/issues/4353#issuecomment-1103925718","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4353","id":1103925718,"node_id":"IC_kwDOCW7NX85BzJHW","user":{"login":"BiuBiu2323","id":32856649,"node_id":"MDQ6VXNlcjMyODU2NjQ5","avatar_url":"https://avatars.githubusercontent.com/u/32856649?v=4","gravatar_id":"","url":"https://api.github.com/users/BiuBiu2323","html_url":"https://github.com/BiuBiu2323","followers_url":"https://api.github.com/users/BiuBiu2323/followers","following_url":"https://api.github.com/users/BiuBiu2323/following{/other_user}","gists_url":"https://api.github.com/users/BiuBiu2323/gists{/gist_id}","starred_url":"https://api.github.com/users/BiuBiu2323/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BiuBiu2323/subscriptions","organizations_url":"https://api.github.com/users/BiuBiu2323/orgs","repos_url":"https://api.github.com/users/BiuBiu2323/repos","events_url":"https://api.github.com/users/BiuBiu2323/events{/privacy}","received_events_url":"https://api.github.com/users/BiuBiu2323/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T13:21:40Z","updated_at":"2022-04-20T13:21:40Z","author_association":"NONE","body":"thanks！","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103925718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103929829","html_url":"https://github.com/apache/iceberg/issues/3854#issuecomment-1103929829","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3854","id":1103929829,"node_id":"IC_kwDOCW7NX85BzKHl","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T13:25:32Z","updated_at":"2022-04-20T13:25:32Z","author_association":"CONTRIBUTOR","body":"@samredai here is what u like: \r\n[https://iceberg.apache.org/docs/latest/spark-ddl/#create-table--as-select](https://iceberg.apache.org/docs/latest/spark-ddl/#create-table--as-select)\r\n\r\nseems like u can close this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103929829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103961989","html_url":"https://github.com/apache/iceberg/issues/3846#issuecomment-1103961989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3846","id":1103961989,"node_id":"IC_kwDOCW7NX85BzR-F","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T13:54:39Z","updated_at":"2022-04-20T13:54:39Z","author_association":"CONTRIBUTOR","body":"@zhaobangcai iceberg is designed for slow-changing data, [refrence from](https://iceberg.apache.org/spec/)\r\n\r\n<img width=\"962\" alt=\"image\" src=\"https://user-images.githubusercontent.com/10529123/164245635-e0a3d5e5-18fa-480f-a036-5dc1b0601bd8.png\">","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103961989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103975004","html_url":"https://github.com/apache/iceberg/issues/3825#issuecomment-1103975004","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3825","id":1103975004,"node_id":"IC_kwDOCW7NX85BzVJc","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T14:05:47Z","updated_at":"2022-04-20T14:05:47Z","author_association":"CONTRIBUTOR","body":"@zeromsi Is your problem solved, need help anymore ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1103975004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104052371","html_url":"https://github.com/apache/iceberg/issues/3825#issuecomment-1104052371","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3825","id":1104052371,"node_id":"IC_kwDOCW7NX85BzoCT","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T15:14:52Z","updated_at":"2022-04-20T15:14:52Z","author_association":"MEMBER","body":"@zeromsi all the artifacts are https://mvnrepository.com/artifact/org.apache.iceberg/iceberg-core/0.13.1\r\nSorry I didn't see the reply back then. Depending on what you want to use you may need other modules as well but they are all there","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104052371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104065930","html_url":"https://github.com/apache/iceberg/issues/3854#issuecomment-1104065930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3854","id":1104065930,"node_id":"IC_kwDOCW7NX85BzrWK","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T15:26:52Z","updated_at":"2022-04-20T15:26:52Z","author_association":"CONTRIBUTOR","body":"I see an example of using PARTITIONED BY in an RTAS but not a CTAS. It can be inferred that it works for CTAS too but I feel it's worth an explicit example.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104065930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104076104","html_url":"https://github.com/apache/iceberg/pull/4585#issuecomment-1104076104","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4585","id":1104076104,"node_id":"IC_kwDOCW7NX85Bzt1I","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T15:36:05Z","updated_at":"2022-04-20T15:36:05Z","author_association":"CONTRIBUTOR","body":"Thanks, @singhpk234!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104076104/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104163383","html_url":"https://github.com/apache/iceberg/pull/4598#issuecomment-1104163383","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4598","id":1104163383,"node_id":"IC_kwDOCW7NX85B0DI3","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T16:45:35Z","updated_at":"2022-04-20T16:45:35Z","author_association":"CONTRIBUTOR","body":"cc: @CircArgs @dramaticlly @jun-he ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104163383/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104234389","html_url":"https://github.com/apache/iceberg/pull/4588#issuecomment-1104234389","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4588","id":1104234389,"node_id":"IC_kwDOCW7NX85B0UeV","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T17:43:30Z","updated_at":"2022-04-20T17:43:30Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer would you please review?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104234389/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104338336","html_url":"https://github.com/apache/iceberg/issues/3466#issuecomment-1104338336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3466","id":1104338336,"node_id":"IC_kwDOCW7NX85B0t2g","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T18:51:27Z","updated_at":"2022-04-20T18:51:27Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104338336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104350142","html_url":"https://github.com/apache/iceberg/pull/4242#issuecomment-1104350142","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4242","id":1104350142,"node_id":"IC_kwDOCW7NX85B0wu-","user":{"login":"funcheetah","id":52840691,"node_id":"MDQ6VXNlcjUyODQwNjkx","avatar_url":"https://avatars.githubusercontent.com/u/52840691?v=4","gravatar_id":"","url":"https://api.github.com/users/funcheetah","html_url":"https://github.com/funcheetah","followers_url":"https://api.github.com/users/funcheetah/followers","following_url":"https://api.github.com/users/funcheetah/following{/other_user}","gists_url":"https://api.github.com/users/funcheetah/gists{/gist_id}","starred_url":"https://api.github.com/users/funcheetah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/funcheetah/subscriptions","organizations_url":"https://api.github.com/users/funcheetah/orgs","repos_url":"https://api.github.com/users/funcheetah/repos","events_url":"https://api.github.com/users/funcheetah/events{/privacy}","received_events_url":"https://api.github.com/users/funcheetah/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T19:03:32Z","updated_at":"2022-04-20T19:03:32Z","author_association":"NONE","body":"> Thanks @funcheetah for the work here! Being able to represent unions as a struct really helps seamlessly migrate the Hive tables in our ecosystem to Iceberg without having to restate all historical data.\r\n> \r\n> I think this PR is a good starting step towards the goal. However for ease of reviewing, can we split the PR into two? Avro and ORC. I think we can work on finishing up the Avro side before moving on to ORC. I have made a preliminary pass on the Avro changes below.\r\n> \r\n> There are a couple of TODOs mentioned in the PR description. But I think there may be more things required for completeness and consistency.\r\n> \r\n> 1. Support in non-Spark environments (e.g. iceberg-data, flink, hive, etc.)\r\n> 2. Support for schema pruning within a complex union\r\n> \r\n> These can be added in gradually, but they should be noted in the PR. And we should create separate issues for these.\r\n> \r\n> @RussellSpitzer @rdblue Should we create a new Project in Github to track this effort? There will be multiple PRs required to complete this work.\r\n\r\nThanks a lot for the reviewing @shardulm94 ! We can focus on reviewing for Avro in this PR and open another PR for ORC. \r\n\r\nRegarding tracking of followup PRs, what is the best way for us to do so? Creating a project?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104350142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104351340","html_url":"https://github.com/apache/iceberg/pull/4503#issuecomment-1104351340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4503","id":1104351340,"node_id":"IC_kwDOCW7NX85B0xBs","user":{"login":"bijanhoule","id":7012524,"node_id":"MDQ6VXNlcjcwMTI1MjQ=","avatar_url":"https://avatars.githubusercontent.com/u/7012524?v=4","gravatar_id":"","url":"https://api.github.com/users/bijanhoule","html_url":"https://github.com/bijanhoule","followers_url":"https://api.github.com/users/bijanhoule/followers","following_url":"https://api.github.com/users/bijanhoule/following{/other_user}","gists_url":"https://api.github.com/users/bijanhoule/gists{/gist_id}","starred_url":"https://api.github.com/users/bijanhoule/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bijanhoule/subscriptions","organizations_url":"https://api.github.com/users/bijanhoule/orgs","repos_url":"https://api.github.com/users/bijanhoule/repos","events_url":"https://api.github.com/users/bijanhoule/events{/privacy}","received_events_url":"https://api.github.com/users/bijanhoule/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T19:04:47Z","updated_at":"2022-04-20T19:04:47Z","author_association":"CONTRIBUTOR","body":"FYI, updated this PR based on feedback above:\r\n- action: rename `actualFilesTable` -> `compareWithFileList`\r\n- procedure: `rename actual_files_table` -> `file_list_view`\r\n- interface change:  remove from `DeleteOrphanFiles`, add to `BaseDeleteOrphanFilesSparkAction`\r\n- apply location and last_modified filtering to compareWithFileList\r\n- refactor test cases","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104351340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104397619","html_url":"https://github.com/apache/iceberg/pull/4514#issuecomment-1104397619","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4514","id":1104397619,"node_id":"IC_kwDOCW7NX85B08Uz","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T19:52:02Z","updated_at":"2022-04-20T19:52:02Z","author_association":"CONTRIBUTOR","body":"Thanks for fixing this, @vanliu-tx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104397619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104404998","html_url":"https://github.com/apache/iceberg/issues/3466#issuecomment-1104404998","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3466","id":1104404998,"node_id":"IC_kwDOCW7NX85B0-IG","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T20:00:59Z","updated_at":"2022-04-20T20:00:59Z","author_association":"MEMBER","body":"We were just discussing this today, the message is a bit confusing but is the correct response. I think we should probably change it to something like\r\n\r\n\"Cannot apply RewriteManifests result since manifests being replaced have already been removed in the current snapshot\"\r\n\r\nbecause what is happening actually the same as an other validation error we do during the commit phase. For example, say we run two optimize metadata operations simultaneously\r\n \r\n```\r\nOptimize 1: Rewrites Manfiests A and B into C'      : Manifests Deleted [A, B], Manifests Added [C']\r\nOptimize 2: Rewrites Manifests A and B into C''    : Manifests Deleted [A, B], Manifests Added [C'']\r\n```\r\n\r\nIf 1 finishes first the state of our table is\r\n```\r\nManifests [C']\r\n```\r\n\r\nIf we try to apply Optimize 2 we see that [A and B] are already deleted and not present, if we added [C''] our table would look like\r\n\r\n```\r\nManifests [C', C'']\r\n```\r\nAnd end up with duplicate records! So the correct response is to cancel the 2nd optimize oepration","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104404998/reactions","total_count":5,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104406030","html_url":"https://github.com/apache/iceberg/issues/3466#issuecomment-1104406030","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3466","id":1104406030,"node_id":"IC_kwDOCW7NX85B0-YO","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T20:02:14Z","updated_at":"2022-04-20T20:02:14Z","author_association":"MEMBER","body":"Adding the label Beginner if anyone wants to take a crack at improving the error message","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104406030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104476170","html_url":"https://github.com/apache/iceberg/pull/3983#issuecomment-1104476170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3983","id":1104476170,"node_id":"IC_kwDOCW7NX85B1PgK","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T21:35:12Z","updated_at":"2022-04-20T21:35:12Z","author_association":"MEMBER","body":"OK I think after tests pass we are good to go. After this we can start working on more tests and further optimizations to the algorithm but I believe this is enough for folks to start getting their hands dirty.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104476170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104562302","html_url":"https://github.com/apache/iceberg/pull/4497#issuecomment-1104562302","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4497","id":1104562302,"node_id":"IC_kwDOCW7NX85B1kh-","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T23:57:13Z","updated_at":"2022-04-20T23:57:13Z","author_association":"COLLABORATOR","body":"Thanks @kbendick for change, @singhpk234 for review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104562302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104562388","html_url":"https://github.com/apache/iceberg/pull/4496#issuecomment-1104562388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4496","id":1104562388,"node_id":"IC_kwDOCW7NX85B1kjU","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-20T23:57:25Z","updated_at":"2022-04-20T23:57:25Z","author_association":"COLLABORATOR","body":"Thanks @kbendick for change, @singhpk234 for review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104562388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104563820","html_url":"https://github.com/apache/iceberg/pull/4560#issuecomment-1104563820","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4560","id":1104563820,"node_id":"IC_kwDOCW7NX85B1k5s","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T00:00:50Z","updated_at":"2022-04-21T00:00:50Z","author_association":"COLLABORATOR","body":"@RussellSpitzer added additional cache of field positional mapping per spec-id as suggested , it's changed a bit, let me know if you can take another look","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104563820/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104612351","html_url":"https://github.com/apache/iceberg/issues/3854#issuecomment-1104612351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3854","id":1104612351,"node_id":"IC_kwDOCW7NX85B1wv_","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T01:20:12Z","updated_at":"2022-04-21T01:20:12Z","author_association":"CONTRIBUTOR","body":"hi @samredai , I guess you didn't see the latest page, we already got an explicit example of CATS now.\r\n\r\n![image](https://user-images.githubusercontent.com/10529123/164352332-e86ca3dd-7025-441b-b4f3-d01141cf742c.png)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104612351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104674053","html_url":"https://github.com/apache/iceberg/issues/4600#issuecomment-1104674053","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4600","id":1104674053,"node_id":"IC_kwDOCW7NX85B1_0F","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T03:38:24Z","updated_at":"2022-04-21T03:38:24Z","author_association":"CONTRIBUTOR","body":"Hi, can you please report the Iceberg version being used?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104674053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104682505","html_url":"https://github.com/apache/iceberg/pull/4522#issuecomment-1104682505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4522","id":1104682505,"node_id":"IC_kwDOCW7NX85B2B4J","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T03:59:25Z","updated_at":"2022-04-21T03:59:25Z","author_association":"COLLABORATOR","body":"@openinx For the spark side, we could set the binpack option `delete-file-threshold` to 1 to rewrite the deletes. Is this for merge delete and data file but not for binpacking? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104682505/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104682588","html_url":"https://github.com/apache/iceberg/issues/4600#issuecomment-1104682588","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4600","id":1104682588,"node_id":"IC_kwDOCW7NX85B2B5c","user":{"login":"agoswami0915","id":38989589,"node_id":"MDQ6VXNlcjM4OTg5NTg5","avatar_url":"https://avatars.githubusercontent.com/u/38989589?v=4","gravatar_id":"","url":"https://api.github.com/users/agoswami0915","html_url":"https://github.com/agoswami0915","followers_url":"https://api.github.com/users/agoswami0915/followers","following_url":"https://api.github.com/users/agoswami0915/following{/other_user}","gists_url":"https://api.github.com/users/agoswami0915/gists{/gist_id}","starred_url":"https://api.github.com/users/agoswami0915/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agoswami0915/subscriptions","organizations_url":"https://api.github.com/users/agoswami0915/orgs","repos_url":"https://api.github.com/users/agoswami0915/repos","events_url":"https://api.github.com/users/agoswami0915/events{/privacy}","received_events_url":"https://api.github.com/users/agoswami0915/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T03:59:39Z","updated_at":"2022-04-21T03:59:39Z","author_association":"NONE","body":"> \r\n\r\n\r\n\r\nIceberg 0.12.0 part of EMR 6.5.0 with Spark 3.1.2","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104682588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104691256","html_url":"https://github.com/apache/iceberg/issues/4600#issuecomment-1104691256","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4600","id":1104691256,"node_id":"IC_kwDOCW7NX85B2EA4","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T04:18:52Z","updated_at":"2022-04-21T04:19:40Z","author_association":"CONTRIBUTOR","body":"This would be happening because `write.object-storage.path` not being set, as when you enable `write.object-storage.enabled` this conf would be used.\r\n\r\n```\r\n else if (PropertyUtil.propertyAsBoolean(properties,\r\n        TableProperties.OBJECT_STORE_ENABLED,\r\n        TableProperties.OBJECT_STORE_ENABLED_DEFAULT)) {\r\n      return new ObjectStoreLocationProvider(location, properties);\r\n```\r\n\r\nLocationProviders.stripTrailingSlash doesn't handle the case when the path being stripped slash from is null (it will do now from next release), which would be now since this `write.object-storage.path` is not set.\r\n\r\nsetting this property `write.object-storage.path` should solve this issue.\r\n\r\nThe storageLocation would be now : this.storageLocation = stripTrailingSlash(properties.get(OBJECT_STORE_PATH));\r\n` return String.format(\"%s/%08x/%s/%s\", storageLocation, hash, context, filename);`\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104691256/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104691672","html_url":"https://github.com/apache/iceberg/issues/4600#issuecomment-1104691672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4600","id":1104691672,"node_id":"IC_kwDOCW7NX85B2EHY","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T04:19:47Z","updated_at":"2022-04-21T04:19:47Z","author_association":"CONTRIBUTOR","body":"Can you try setting `write.object-storage.path`? Reference from Iceberg 0.12: https://github.com/apache/iceberg/blob/ded95a5435f18db9b6367e7aa4d1c666c77cfaed/core/src/main/java/org/apache/iceberg/LocationProviders.java#L99\r\n\r\n\r\nThe behaviour is different since 0.13 where we fallback to different table properties to find the data location: \r\nhttps://github.com/apache/iceberg/blob/b521f40d9f897ffc0d3d30511cfdff35797b5894/core/src/main/java/org/apache/iceberg/LocationProviders.java#L105-L122","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104691672/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104695992","html_url":"https://github.com/apache/iceberg/issues/4597#issuecomment-1104695992","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4597","id":1104695992,"node_id":"IC_kwDOCW7NX85B2FK4","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T04:29:16Z","updated_at":"2022-04-21T04:29:16Z","author_association":"MEMBER","body":"The apache iceberg dell module was introduced in the latest master branch,  and we still don't have an official release for this branch.  I think the next official release will be iceberg 0.14.0 release. \r\n\r\nIf you want to access those iceberg-dell modules, you may need to use the official apache snapshots maven repository : https://repository.apache.org/content/repositories/snapshots/org/apache/iceberg/iceberg-dell/","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104695992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104698607","html_url":"https://github.com/apache/iceberg/issues/3846#issuecomment-1104698607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3846","id":1104698607,"node_id":"IC_kwDOCW7NX85B2Fzv","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T04:35:13Z","updated_at":"2022-04-21T04:35:13Z","author_association":"MEMBER","body":"I agree with @Initial-neko and @flyrain , in real production case,  we won't commit iceberg transaction in ms,  the ideal checkpoint interval for a flink job will be minutes or hours.\r\n\r\nAccording to the above discussion, I will prefer to close this issue now.   Feel free to reopen it if there is any other question. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104698607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104708586","html_url":"https://github.com/apache/iceberg/pull/4586#issuecomment-1104708586","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4586","id":1104708586,"node_id":"IC_kwDOCW7NX85B2IPq","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T04:57:04Z","updated_at":"2022-04-21T04:59:39Z","author_association":"CONTRIBUTOR","body":"For operations like creating and dropping branches and tags I was thinking it may make more sense to have a DDL syntax instead of a call procedure (which I think we can leverage for other operations):\r\n\r\nFor example:\r\n\r\n```\r\nCREATE TAG [IF NOT EXISTS] AT _snapshotId_ [RETAIN _interval_ {SECONDS | MINUTES | HOURS | DAYS | etc}]\r\n```\r\n\r\nFor another reference here is what Nessie supports currently: https://projectnessie.org/tools/sql/#creating-branchestags ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104708586/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104735599","html_url":"https://github.com/apache/iceberg/issues/4600#issuecomment-1104735599","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4600","id":1104735599,"node_id":"IC_kwDOCW7NX85B2O1v","user":{"login":"agoswami0915","id":38989589,"node_id":"MDQ6VXNlcjM4OTg5NTg5","avatar_url":"https://avatars.githubusercontent.com/u/38989589?v=4","gravatar_id":"","url":"https://api.github.com/users/agoswami0915","html_url":"https://github.com/agoswami0915","followers_url":"https://api.github.com/users/agoswami0915/followers","following_url":"https://api.github.com/users/agoswami0915/following{/other_user}","gists_url":"https://api.github.com/users/agoswami0915/gists{/gist_id}","starred_url":"https://api.github.com/users/agoswami0915/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agoswami0915/subscriptions","organizations_url":"https://api.github.com/users/agoswami0915/orgs","repos_url":"https://api.github.com/users/agoswami0915/repos","events_url":"https://api.github.com/users/agoswami0915/events{/privacy}","received_events_url":"https://api.github.com/users/agoswami0915/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T05:39:06Z","updated_at":"2022-04-21T05:39:06Z","author_association":"NONE","body":"Thanks @rajarshisarkar !! It worked","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1104735599/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105100066","html_url":"https://github.com/apache/iceberg/pull/4602#issuecomment-1105100066","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4602","id":1105100066,"node_id":"IC_kwDOCW7NX85B3n0i","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T11:43:38Z","updated_at":"2022-04-21T11:43:38Z","author_association":"CONTRIBUTOR","body":"cc: @rdblue @findepi","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105100066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105109427","html_url":"https://github.com/apache/iceberg/pull/4584#issuecomment-1105109427","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4584","id":1105109427,"node_id":"IC_kwDOCW7NX85B3qGz","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T11:55:31Z","updated_at":"2022-04-21T11:55:31Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer can you take a look again, thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105109427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105152105","html_url":"https://github.com/apache/iceberg/pull/4586#issuecomment-1105152105","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4586","id":1105152105,"node_id":"IC_kwDOCW7NX85B30hp","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T12:31:59Z","updated_at":"2022-04-21T12:31:59Z","author_association":"CONTRIBUTOR","body":"Thanks for the inputs, @amogh-jahagirdar! \r\n\r\nI am carrying forward the call procedure approach from the [existing snapshot management APIs](https://iceberg.apache.org/docs/latest/spark-procedures/#snapshot-management): `rollback_to_snapshot`, `rollback_to_timestamp`, `set_current_snapshot`, `cherrypick_snapshot`. However, the SQL approach looks really interesting to me.\r\n\r\nHere are my thoughts:\r\n(1) Introduce call procedures for all the branching & tagging APIs as effectively they are snapshot management APIs and we already have [some existing procedural calls for the same](https://iceberg.apache.org/docs/latest/spark-procedures/#snapshot-management). The procedural calls could be API specific or generic enough to cater different use cases via named/positional arguments.\r\n(2) Introduce new SQL Syntax specific to branching and tagging - make changes in `IcebergSparkSessionExtensions` (and also in parser, analyzer, planner to understand the new syntax). The Syntax could be something similar to what Amogh suggested and can be proposed/reviewed in the community.\r\n\r\nI don't have a strong opinion on (1) or (2) - would like to just use Spark to create/modify/remove a branch/tag. I would also like to list/view details of the available branches/tags using Spark.\r\n\r\n@rdblue @jackye1995 Please let me know your thoughts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105152105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105153611","html_url":"https://github.com/apache/iceberg/pull/4602#issuecomment-1105153611","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4602","id":1105153611,"node_id":"IC_kwDOCW7NX85B305L","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T12:33:39Z","updated_at":"2022-04-21T12:33:39Z","author_association":"MEMBER","body":"cc @alexjo2144 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105153611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105190926","html_url":"https://github.com/apache/iceberg/issues/4597#issuecomment-1105190926","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4597","id":1105190926,"node_id":"IC_kwDOCW7NX85B3-AO","user":{"login":"BiuBiu2323","id":32856649,"node_id":"MDQ6VXNlcjMyODU2NjQ5","avatar_url":"https://avatars.githubusercontent.com/u/32856649?v=4","gravatar_id":"","url":"https://api.github.com/users/BiuBiu2323","html_url":"https://github.com/BiuBiu2323","followers_url":"https://api.github.com/users/BiuBiu2323/followers","following_url":"https://api.github.com/users/BiuBiu2323/following{/other_user}","gists_url":"https://api.github.com/users/BiuBiu2323/gists{/gist_id}","starred_url":"https://api.github.com/users/BiuBiu2323/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BiuBiu2323/subscriptions","organizations_url":"https://api.github.com/users/BiuBiu2323/orgs","repos_url":"https://api.github.com/users/BiuBiu2323/repos","events_url":"https://api.github.com/users/BiuBiu2323/events{/privacy}","received_events_url":"https://api.github.com/users/BiuBiu2323/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T13:13:45Z","updated_at":"2022-04-21T13:13:45Z","author_association":"NONE","body":"> apache iceberg dell 模块是在最新的 master 分支中引入的，我们仍然没有这个分支的正式发布。我认为下一个正式版本将是 iceberg 0.14.0 版本。\r\n> \r\n> 如果您想访问那些 iceberg-dell 模块，您可能需要使用官方 apache 快照 maven 存储库：[https ://repository.apache.org/content/repositories/snapshots/org/apache/iceberg/iceberg-dell/](https://repository.apache.org/content/repositories/snapshots/org/apache/iceberg/iceberg-dell/)\r\n\r\nThanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105190926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105206172","html_url":"https://github.com/apache/iceberg/issues/3854#issuecomment-1105206172","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3854","id":1105206172,"node_id":"IC_kwDOCW7NX85B4Buc","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T13:28:21Z","updated_at":"2022-04-21T13:28:21Z","author_association":"CONTRIBUTOR","body":"I'm specifically referring to one that includes PARTITIONED BY. The reason I opened this issue is because someone told me they weren't aware they could add a partition spec as part of their CTAS statement.\n\nWe can either add a sentence there or include PARTITIONED BY (similar to the RTAS statement right below it).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105206172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105232502","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105232502","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105232502,"node_id":"IC_kwDOCW7NX85B4IJ2","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T13:47:38Z","updated_at":"2022-04-21T13:47:38Z","author_association":"CONTRIBUTOR","body":"cc: @kbendick","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105232502/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105292545","html_url":"https://github.com/apache/iceberg/issues/3854#issuecomment-1105292545","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3854","id":1105292545,"node_id":"IC_kwDOCW7NX85B4W0B","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T14:28:27Z","updated_at":"2022-04-21T14:28:27Z","author_association":"CONTRIBUTOR","body":"> I'm specifically referring to one that includes PARTITIONED BY. The reason I opened this issue is because someone told me they weren't aware they could add a partition spec as part of their CTAS statement.\r\n> \r\n> We can either add a sentence there or include PARTITIONED BY (similar to the RTAS statement right below it).\r\n\r\ngot u","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105292545/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105327552","html_url":"https://github.com/apache/iceberg/pull/3983#issuecomment-1105327552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3983","id":1105327552,"node_id":"IC_kwDOCW7NX85B4fXA","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T14:51:47Z","updated_at":"2022-04-21T14:51:47Z","author_association":"MEMBER","body":"Thanks @szehon-ho , @rdblue , @ulysses-you, @jackye1995  and @emkornfield For all your insightful comments and review. Let's be sure to continue optimizing and finding ways to make Iceberg's optimizations more performant!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105327552/reactions","total_count":7,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":4,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105389677","html_url":"https://github.com/apache/iceberg/pull/4606#issuecomment-1105389677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4606","id":1105389677,"node_id":"IC_kwDOCW7NX85B4uht","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T15:35:15Z","updated_at":"2022-04-21T15:35:15Z","author_association":"CONTRIBUTOR","body":"LGTM, thanks @kyle-cx !!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105389677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105397690","html_url":"https://github.com/apache/iceberg/issues/4490#issuecomment-1105397690","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4490","id":1105397690,"node_id":"IC_kwDOCW7NX85B4we6","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T15:42:52Z","updated_at":"2022-04-21T16:15:45Z","author_association":"CONTRIBUTOR","body":"@polaris6 if you're still up to tackle this, it would be helpful to split the flink section into what's purely reference type documentation (such as things that need to be versioned with Iceberg releases) and pure getting started/quickstart material. We can carve out anything that feels like \"quickstart\" material and put it in a `flink-quickstart.md` file in the iceberg-docs repo's landing-page ([this](https://github.com/apache/iceberg-docs/tree/main/landing-page/content/common) directory).\r\n\r\nThen the Flink item at the top of the landing-page could go to that quickstart, and the quickstart could link to the versioned docs site Flink section which can be exclusively configuration material, reference material, and a detailed list of feature items. Let me know what you think and feel free to message me on slack or we can jump on a call to brainstorm more on this.\r\n\r\nI made an issue we can work out of: https://github.com/apache/iceberg/issues/4607","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105397690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105405341","html_url":"https://github.com/apache/iceberg/pull/4602#issuecomment-1105405341","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4602","id":1105405341,"node_id":"IC_kwDOCW7NX85B4yWd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T15:50:34Z","updated_at":"2022-04-21T15:50:34Z","author_association":"CONTRIBUTOR","body":"@felixYyu can you please add some information about your approach to the PR description?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105405341/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105427034","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1105427034","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1105427034,"node_id":"IC_kwDOCW7NX85B43pa","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T16:11:40Z","updated_at":"2022-04-21T16:11:40Z","author_association":"MEMBER","body":"I left a bunch of comments here that would also apply to the other PR. I'll do another pass on the custom metric pr for just file splits in a bit, but please take a look at my comments here in the mean time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105427034/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105434189","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1105434189","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1105434189,"node_id":"IC_kwDOCW7NX85B45ZN","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T16:18:33Z","updated_at":"2022-04-21T16:18:33Z","author_association":"MEMBER","body":"One other thing, how are we going to test this? I'm not sure of any ways to get to this new metric programmatically but we should definitely investigate that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105434189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105468390","html_url":"https://github.com/apache/iceberg/pull/4588#issuecomment-1105468390","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4588","id":1105468390,"node_id":"IC_kwDOCW7NX85B5Bvm","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T16:55:38Z","updated_at":"2022-04-21T16:55:38Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer thank you for reviewing!\r\nThis PR is on top of #4395, but since that is not merged, all its changes are here.\r\nI'll clean up the logging. It is true that their original purpose was for debugging/testing, but I think some of them are still potentially helpful.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105468390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105479689","html_url":"https://github.com/apache/iceberg/pull/4395#issuecomment-1105479689","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4395","id":1105479689,"node_id":"IC_kwDOCW7NX85B5EgJ","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T17:09:01Z","updated_at":"2022-04-21T17:11:09Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer thank you for reviewing again!\r\nThe changes to the descriptions were discussed in an earlier review comment, and my understanding was that reviewers were in favor of the changes. They affect the Spark UI. That said, if you prefer, I will remove them and put them in a separate PR.\r\nI have tested this manually. My take is this: In Spark, there are unit tests for testing consumption of custom metrics by the SQLAppStatusListener. Here we are just plugging into the API. On the Iceberg side, how is the metric we are adding computed? It is simply scanTask.files().size() as you point out. Scan planning is presumably tested, so there is really nothing essentially new that needs to be tested. In #4588, on the other hand, there are extensive changes needed to compute the metric being added, so I test that computation.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105479689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105674664","html_url":"https://github.com/apache/iceberg/pull/4608#issuecomment-1105674664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4608","id":1105674664,"node_id":"IC_kwDOCW7NX85B50Go","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T19:33:15Z","updated_at":"2022-04-21T19:33:15Z","author_association":"CONTRIBUTOR","body":"@electrum I just an FYI, this adds the range based read and simplifies this path significantly as compared to AWS SDK v1 since much of the stream copy logic is handled by SDK v2.  This possibly save an array copy as well. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105674664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105692103","html_url":"https://github.com/apache/iceberg/pull/4534#issuecomment-1105692103","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4534","id":1105692103,"node_id":"IC_kwDOCW7NX85B54XH","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T19:52:09Z","updated_at":"2022-04-21T19:52:09Z","author_association":"MEMBER","body":"Thanks @findepi for the contribution and @kbendick and @rdblue for review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105692103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105742448","html_url":"https://github.com/apache/iceberg/pull/4553#issuecomment-1105742448","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4553","id":1105742448,"node_id":"IC_kwDOCW7NX85B6Epw","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T20:46:13Z","updated_at":"2022-04-21T20:46:13Z","author_association":"CONTRIBUTOR","body":"> @kbendick I think we've just merged few iceberg PRs for the old flink 1.14, would you mind to update this PR to include those latest changes to flink 1.15 ?\r\n\r\nYeah good catch @openinx. I will keep the two in sync. I have merged the changes from 1.14 into 1.15.\r\n\r\nHere's the diff between the two\r\n```bash\r\n$ diff -qr v1.14/ v1.15/\r\nFiles v1.14/build.gradle and v1.15/build.gradle differ\r\nFiles v1.14/flink/src/main/java/org/apache/iceberg/flink/IcebergTableSink.java and v1.15/flink/src/main/java/org/apache/iceberg/flink/IcebergTableSink.java differ\r\nFiles v1.14/flink/src/main/java/org/apache/iceberg/flink/IcebergTableSource.java and v1.15/flink/src/main/java/org/apache/iceberg/flink/IcebergTableSource.java differ\r\nFiles v1.14/flink/src/test/java/org/apache/iceberg/flink/TestChangeLogTable.java and v1.15/flink/src/test/java/org/apache/iceberg/flink/TestChangeLogTable.java differ\r\nFiles v1.14/flink/src/test/java/org/apache/iceberg/flink/TestIcebergConnector.java and v1.15/flink/src/test/java/org/apache/iceberg/flink/TestIcebergConnector.java differ\r\nFiles v1.14/flink/src/test/java/org/apache/iceberg/flink/source/BoundedTableFactory.java and v1.15/flink/src/test/java/org/apache/iceberg/flink/source/BoundedTableFactory.java differ\r\n```\r\n\r\nI checked those files individually and the diff seems correct. I will post the full diff as well before we merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105742448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105753643","html_url":"https://github.com/apache/iceberg/pull/4553#issuecomment-1105753643","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4553","id":1105753643,"node_id":"IC_kwDOCW7NX85B6HYr","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T20:59:10Z","updated_at":"2022-04-21T21:02:21Z","author_association":"CONTRIBUTOR","body":"This gist contains the difference between the 1.14 and 1.15 Flink directories as of right now: https://gist.github.com/kbendick/e6634fd3010322914d4b49927d2e7d30\r\n\r\nGenerated by running `git diff --no-index ./flink/v1.14 ./flink/v1.15 >> flink_115_diff_20220421.txt`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105753643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105795552","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105795552","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105795552,"node_id":"IC_kwDOCW7NX85B6Rng","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T21:50:44Z","updated_at":"2022-04-21T21:50:44Z","author_association":"CONTRIBUTOR","body":"Does this work without the comments @felixYyu?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105795552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105800583","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105800583","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105800583,"node_id":"IC_kwDOCW7NX85B6S2H","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T21:57:36Z","updated_at":"2022-04-21T21:57:36Z","author_association":"CONTRIBUTOR","body":"Oh. Actually, I believe that you can't have multiple Iceberg DDL statements in one call to `spark.sql`.\r\n\r\nI think that's true for normal spark sql as well (e.g. without using Iceberg in it at all). Like you couldn't do something like the following:\r\n```scala\r\nspark.sql(\r\n    s\"\"\"\r\n      | CREATE TABLE tbl(id bigint, data string) using parquet;\r\n      | INSERT INTO tbl VALUES (0, 'kyle');\r\n      |\"\"\".stripMargin\r\n)\r\n```\r\n\r\nIf you try to do the above and it works, let me know. Otherwise, I think the issue is that you need to have only executed statement in each call to `spark.sql`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105800583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105811945","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105811945","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105811945,"node_id":"IC_kwDOCW7NX85B6Vnp","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T22:12:44Z","updated_at":"2022-04-21T22:23:31Z","author_association":"CONTRIBUTOR","body":"So while it's true that only one statement should exist in the `spark.sql` call, I think that your multiline string is winding up with a leading `\"` character which is causing problems.\r\n\r\nIt should have the first line without `|` and then all following lines should have that.\r\n\r\nCompare when placing the first text on the first line when using strip-margin\r\n```scala\r\nscala> :paste\r\n// Entering paste mode (ctrl-D to finish)\r\n\r\nval speech =\r\ns\"\"\"Four score and\r\n     |seven years ago\"\"\".stripMargin\r\n\r\n\r\n// Exiting paste mode, now interpreting.\r\n\r\nspeech: String =\r\nFour score and\r\nseven years ago\r\n```\r\n\r\nvs\r\n```scala\r\nscala> :paste\r\n// Entering paste mode (ctrl-D to finish)\r\n\r\nval speech =\r\ns\"\"\"\r\n    |Four score and\r\n    |seven years ago\"\"\".stripMargin\r\n\r\n\r\n// Exiting paste mode, now interpreting.\r\n\r\nspeech: String =\r\n\"\r\nFour score and\r\nseven years ago\"\r\n```\r\n\r\nNotice that the second one has an additional leading `\"`. I think that's what's causing problems in your multiline string.\r\n\r\nCan you try evaluating the multiline string in a shell and seeing what it comes out to? I think that's the problem (the text needs to start on the first line for multiline strings in Scala).\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105811945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105817050","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105817050","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105817050,"node_id":"IC_kwDOCW7NX85B6W3a","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T22:18:19Z","updated_at":"2022-04-21T22:22:46Z","author_association":"CONTRIBUTOR","body":"I tested with your multiline string and it does result in SQL that has a leading `\"`, which would cause the `isIcebergCommand` function to fail as it just checks the text starts with `call` or `alter table` after removing comments and new lines.\r\n\r\nThat's also why your stack trace doesn't have the Iceberg spark session extension stuff in it too, as the Iceberg specific parser is just delegating to Spark's parser because it doesn't consider this Iceberg-specific DML with the leading `\"`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105817050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105820871","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105820871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105820871,"node_id":"IC_kwDOCW7NX85B6XzH","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T22:24:32Z","updated_at":"2022-04-21T22:24:32Z","author_association":"CONTRIBUTOR","body":"Check out this multi-line string Scala example, which yours should look more like (no leading `|`): https://www.oreilly.com/library/view/scala-cookbook/9781449340292/ch01s03.html","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105820871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105833288","html_url":"https://github.com/apache/iceberg/pull/4601#issuecomment-1105833288","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4601","id":1105833288,"node_id":"IC_kwDOCW7NX85B6a1I","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T22:48:50Z","updated_at":"2022-04-21T22:48:50Z","author_association":"CONTRIBUTOR","body":"Thanks! Looks like a great start.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105833288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105850875","html_url":"https://github.com/apache/iceberg/pull/4522#issuecomment-1105850875","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4522","id":1105850875,"node_id":"IC_kwDOCW7NX85B6fH7","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T23:23:22Z","updated_at":"2022-04-21T23:23:22Z","author_association":"CONTRIBUTOR","body":"@openinx, can you add a bit more description about what this is doing? What does this cover and how are rewrites performed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105850875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105856568","html_url":"https://github.com/apache/iceberg/pull/4590#issuecomment-1105856568","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4590","id":1105856568,"node_id":"IC_kwDOCW7NX85B6gg4","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T23:34:26Z","updated_at":"2022-04-21T23:34:26Z","author_association":"CONTRIBUTOR","body":"@samredai added hash and moved `partitioning` to the `table` module, if you could take another look :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105856568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105866438","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105866438","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105866438,"node_id":"IC_kwDOCW7NX85B6i7G","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-21T23:57:14Z","updated_at":"2022-04-21T23:57:14Z","author_association":"CONTRIBUTOR","body":"thanks @kbendick for detail description. I just want not to write multiple spark sql commands during single step debugging.\r\n\r\nlike the following is ok\r\n```\r\nspark.sql(\r\n      s\"\"\"\r\n         |\r\n         |/*INSERT INTO hadoop_prod.default.test_evolution5 VALUES (1, 11, 21)*/\r\n         |--ALTER TABLE hadoop_prod.default.test_evolution5 ADD PARTITION FIELD col2\r\n         |INSERT INTO hadoop_prod.default.test_evolution5 VALUES (2, 12, 22)\r\n         |\r\n         |--ALTER TABLE hadoop_prod.default.test_evolution5 DROP PARTITION FIELD col2\r\n         |--INSERT INTO hadoop_prod.default.test_evolution5 VALUES (3, 13, 23)\r\n         |--ALTER TABLE hadoop_prod.default.test_evolution5 DROP COLUMN col2\r\n         |\"\"\".stripMargin)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105866438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105869035","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105869035","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105869035,"node_id":"IC_kwDOCW7NX85B6jjr","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T00:03:14Z","updated_at":"2022-04-22T00:03:14Z","author_association":"CONTRIBUTOR","body":"the following also don't work, exception log is:\r\n```\r\nspark.sql(\r\n      s\"\"\"\r\n         | CREATE TABLE tbl(id bigint, data string) using parquet;\r\n         | INSERT INTO tbl VALUES (0, 'kyle');\r\n         |\"\"\".stripMargin\r\n```\r\n\r\n```\r\nException in thread \"main\" org.apache.spark.sql.catalyst.parser.ParseException: \r\nextraneous input 'INSERT' expecting {<EOF>, ';'}(line 3, pos 1)\r\n\r\n== SQL ==\r\n\r\n CREATE TABLE tbl(id bigint, data string) using parquet;\r\n INSERT INTO tbl VALUES (0, 'kyle');\r\n-^^^\r\n\r\n\tat org.apache.spark.sql.catalyst.parser.ParseException.withCommand(ParseDriver.scala:266)\r\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parse(ParseDriver.scala:127)\r\n\tat org.apache.spark.sql.execution.SparkSqlParser.parse(SparkSqlParser.scala:51)\r\n\tat org.apache.spark.sql.catalyst.parser.AbstractSqlParser.parsePlan(ParseDriver.scala:77)\r\n\tat org.apache.spark.sql.catalyst.parser.extensions.IcebergSparkSqlExtensionsParser.parsePlan(IcebergSparkSqlExtensionsParser.scala:123)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$2(SparkSession.scala:616)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:616)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:613)\r\n\tat com.jiuye.data.lake.api.modle.DDLPartitionSQL$.testStep(DDLPartitionSQL.scala:188)\r\n\tat com.jiuye.data.lake.api.modle.DDLPartitionSQL$.main(DDLPartitionSQL.scala:44)\r\n\tat com.jiuye.data.lake.api.modle.DDLPartitionSQL.main(DDLPartitionSQL.scala)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105869035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105869243","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105869243","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105869243,"node_id":"IC_kwDOCW7NX85B6jm7","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T00:03:35Z","updated_at":"2022-04-22T00:03:35Z","author_association":"CONTRIBUTOR","body":"So if you took the original multiline SQL you had, but put the first statement on the first line with no leading `|`, does that work? I suspect it will.\r\n\r\nI’m just trying to clarify as I don’t think the issue has anything to do with the comment stripping. It would have happened before that.\r\n\r\nEven try just\r\n\r\n```\r\nspark.sql(\r\n      s\"\"\"\r\n         |\r\n         |ALTER TABLE hadoop_prod.default.test_evolution5 ADD PARTITION FIELD col2\r\n         |/*INSERT INTO hadoop_prod.default.test_evolution5 VALUES (1, 11, 21)*/\r\n         |--ALTER TABLE hadoop_prod.default.test_evolution5 ADD PARTITION FIELD col2\r\n         |--INSERT INTO hadoop_prod.default.test_evolution5 VALUES (2, 12, 22)\r\n         |\r\n         |--ALTER TABLE hadoop_prod.default.test_evolution5 DROP PARTITION FIELD col2\r\n         |--INSERT INTO hadoop_prod.default.test_evolution5 VALUES (3, 13, 23)\r\n         |--ALTER TABLE hadoop_prod.default.test_evolution5 DROP COLUMN col2\r\n         |\"\"\".stripMargin)\r\n```\r\n\r\nI know why it’s failing but I want to verify that before going on a deep explanation.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105869243/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105875533","html_url":"https://github.com/apache/iceberg/issues/4603#issuecomment-1105875533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4603","id":1105875533,"node_id":"IC_kwDOCW7NX85B6lJN","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T00:15:50Z","updated_at":"2022-04-22T00:16:23Z","author_association":"CONTRIBUTOR","body":"> put the first statement on the first line with no leading |, does that work? I suspect it will.\r\n\r\nReally, thanks. then I'll close this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105875533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105901469","html_url":"https://github.com/apache/iceberg/pull/4602#issuecomment-1105901469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4602","id":1105901469,"node_id":"IC_kwDOCW7NX85B6red","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T01:01:54Z","updated_at":"2022-04-22T01:01:54Z","author_association":"CONTRIBUTOR","body":"updated the PR description, Please check whether it is OK? @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105901469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105912113","html_url":"https://github.com/apache/iceberg/pull/4566#issuecomment-1105912113","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4566","id":1105912113,"node_id":"IC_kwDOCW7NX85B6uEx","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T01:24:15Z","updated_at":"2022-04-22T01:24:15Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @szehon-ho @flyrain @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1105912113/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106029475","html_url":"https://github.com/apache/iceberg/pull/4522#issuecomment-1106029475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4522","id":1106029475,"node_id":"IC_kwDOCW7NX85B7Kuj","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T05:38:13Z","updated_at":"2022-04-22T05:38:13Z","author_association":"MEMBER","body":"a. Can we separate Flink and spark changes ?\r\nb. Spark already supports merging the v2 delete files to data files in `rewriteDataFiles` action. If we are supporting compacting the v2 delete files to a big delete file in this PR, I think it can be a separate action.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106029475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106050354","html_url":"https://github.com/apache/iceberg/issues/4490#issuecomment-1106050354","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4490","id":1106050354,"node_id":"IC_kwDOCW7NX85B7P0y","user":{"login":"polaris6","id":29967142,"node_id":"MDQ6VXNlcjI5OTY3MTQy","avatar_url":"https://avatars.githubusercontent.com/u/29967142?v=4","gravatar_id":"","url":"https://api.github.com/users/polaris6","html_url":"https://github.com/polaris6","followers_url":"https://api.github.com/users/polaris6/followers","following_url":"https://api.github.com/users/polaris6/following{/other_user}","gists_url":"https://api.github.com/users/polaris6/gists{/gist_id}","starred_url":"https://api.github.com/users/polaris6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polaris6/subscriptions","organizations_url":"https://api.github.com/users/polaris6/orgs","repos_url":"https://api.github.com/users/polaris6/repos","events_url":"https://api.github.com/users/polaris6/events{/privacy}","received_events_url":"https://api.github.com/users/polaris6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T06:18:27Z","updated_at":"2022-04-22T06:18:27Z","author_association":"CONTRIBUTOR","body":"@samredai This is a great job and will be very fulfilling, I will look at your proposal and take the time to think about it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106050354/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106109201","html_url":"https://github.com/apache/iceberg/pull/4534#issuecomment-1106109201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4534","id":1106109201,"node_id":"IC_kwDOCW7NX85B7eMR","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T07:33:24Z","updated_at":"2022-04-22T07:33:24Z","author_association":"MEMBER","body":"thank you for the merge!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106109201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106115284","html_url":"https://github.com/apache/iceberg/pull/4537#issuecomment-1106115284","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4537","id":1106115284,"node_id":"IC_kwDOCW7NX85B7frU","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T07:41:18Z","updated_at":"2022-04-22T07:41:18Z","author_association":"MEMBER","body":"AC & rebased after https://github.com/apache/iceberg/pull/4534 merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106115284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106178031","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1106178031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1106178031,"node_id":"IC_kwDOCW7NX85B7u_v","user":{"login":"uncleGen","id":7402327,"node_id":"MDQ6VXNlcjc0MDIzMjc=","avatar_url":"https://avatars.githubusercontent.com/u/7402327?v=4","gravatar_id":"","url":"https://api.github.com/users/uncleGen","html_url":"https://github.com/uncleGen","followers_url":"https://api.github.com/users/uncleGen/followers","following_url":"https://api.github.com/users/uncleGen/following{/other_user}","gists_url":"https://api.github.com/users/uncleGen/gists{/gist_id}","starred_url":"https://api.github.com/users/uncleGen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uncleGen/subscriptions","organizations_url":"https://api.github.com/users/uncleGen/orgs","repos_url":"https://api.github.com/users/uncleGen/repos","events_url":"https://api.github.com/users/uncleGen/events{/privacy}","received_events_url":"https://api.github.com/users/uncleGen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T08:21:13Z","updated_at":"2022-04-22T08:21:31Z","author_association":"CONTRIBUTOR","body":"Let me be clear. In my scene, my machine has 96 cores, when `iceberg.scan.plan-in-worker-pool` is enabled, the `iceberg.worker.num-threads` will be number of available processors in default, i.e. 96. So the input speed of queue is far greater than outpu speed of queue. Then OOM occurs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106178031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106229367","html_url":"https://github.com/apache/iceberg/issues/3466#issuecomment-1106229367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3466","id":1106229367,"node_id":"IC_kwDOCW7NX85B77h3","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T09:18:05Z","updated_at":"2022-04-22T09:18:05Z","author_association":"CONTRIBUTOR","body":"I think put the current-snapshot-id into the error message would make it easier for the user to figure out what happened.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106229367/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106302279","html_url":"https://github.com/apache/iceberg/issues/3371#issuecomment-1106302279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3371","id":1106302279,"node_id":"IC_kwDOCW7NX85B8NVH","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T09:56:41Z","updated_at":"2022-04-22T09:56:41Z","author_association":"CONTRIBUTOR","body":"interesting, and seems a little hard to reproduce this, how often dose this happen ?\r\ncan u provide the minimal steps to reproduce? @alexkingli ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106302279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106556601","html_url":"https://github.com/apache/iceberg/pull/4611#issuecomment-1106556601","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4611","id":1106556601,"node_id":"IC_kwDOCW7NX85B9La5","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T14:11:07Z","updated_at":"2022-04-22T14:11:07Z","author_association":"MEMBER","body":"> Looks good to me, is this something we have in our Static Analysis rules?\r\n\r\ni don't think so. That's something reviewers point out during review process.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106556601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106558695","html_url":"https://github.com/apache/iceberg/pull/4611#issuecomment-1106558695","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4611","id":1106558695,"node_id":"IC_kwDOCW7NX85B9L7n","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T14:13:16Z","updated_at":"2022-04-22T14:14:15Z","author_association":"MEMBER","body":"> > Looks good to me, is this something we have in our Static Analysis rules?\r\n> \r\n> i don't think so. That's something reviewers point out during review process.\r\n\r\nWe should probably add that as well then, we can have checkstyle automatically fail any code which adds it like we do with usages of unshaded guava.\r\n\r\nhttps://github.com/apache/iceberg/blob/master/.baseline/checkstyle/checkstyle.xml#L62-L65","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106558695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106559523","html_url":"https://github.com/apache/iceberg/pull/4611#issuecomment-1106559523","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4611","id":1106559523,"node_id":"IC_kwDOCW7NX85B9MIj","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-22T14:14:08Z","updated_at":"2022-04-22T14:14:08Z","author_association":"MEMBER","body":"Good idea, let's do this. I don't plan on doing this within this PR though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1106559523/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]