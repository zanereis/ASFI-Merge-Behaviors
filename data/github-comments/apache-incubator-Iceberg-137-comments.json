[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998378035","html_url":"https://github.com/apache/iceberg/pull/3732#issuecomment-998378035","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3732","id":998378035,"node_id":"IC_kwDOCW7NX847ggoz","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T00:48:28Z","updated_at":"2021-12-21T00:48:28Z","author_association":"CONTRIBUTOR","body":"I think this needs a note about the behavior. Once that's in I can merge.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998378035/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998381030","html_url":"https://github.com/apache/iceberg/pull/3778#issuecomment-998381030","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3778","id":998381030,"node_id":"IC_kwDOCW7NX847ghXm","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T00:55:53Z","updated_at":"2021-12-21T00:55:53Z","author_association":"CONTRIBUTOR","body":"Looks good to me other than the minor comments. Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998381030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998408677","html_url":"https://github.com/apache/iceberg/pull/3777#issuecomment-998408677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3777","id":998408677,"node_id":"IC_kwDOCW7NX847goHl","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T02:05:54Z","updated_at":"2021-12-21T02:05:54Z","author_association":"CONTRIBUTOR","body":"> This is only called from test code, so I think the motivation was to speculative since other classes had similar updates. I don't think that we should move forward with this since it isn't actually used.\r\n\r\nI didn't notice that this is only used in test, and no, I am not speculating. If you read this [issue](https://github.com/apache/iceberg/issues/3604) and this [pr](https://github.com/apache/iceberg/pull/3605), you can find that I found the problem of ApplyNameMapping change custom parquet schema before another merged pr, I checked other classes extend ParquetTypeVisitor and found RemoveIds has the same problem. I fixed both in this [pr](https://github.com/apache/iceberg/pull/3605), but no one reviewed. Yesterday I found the issue of ApplyNameMapping is solved in another pr and already merged, so I closed my last pr and extracted the part of RemoveIds here. That's my  motivation.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998408677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998462433","html_url":"https://github.com/apache/iceberg/pull/3104#issuecomment-998462433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3104","id":998462433,"node_id":"IC_kwDOCW7NX847g1Ph","user":{"login":"hameizi","id":18445460,"node_id":"MDQ6VXNlcjE4NDQ1NDYw","avatar_url":"https://avatars.githubusercontent.com/u/18445460?v=4","gravatar_id":"","url":"https://api.github.com/users/hameizi","html_url":"https://github.com/hameizi","followers_url":"https://api.github.com/users/hameizi/followers","following_url":"https://api.github.com/users/hameizi/following{/other_user}","gists_url":"https://api.github.com/users/hameizi/gists{/gist_id}","starred_url":"https://api.github.com/users/hameizi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hameizi/subscriptions","organizations_url":"https://api.github.com/users/hameizi/orgs","repos_url":"https://api.github.com/users/hameizi/repos","events_url":"https://api.github.com/users/hameizi/events{/privacy}","received_events_url":"https://api.github.com/users/hameizi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T04:27:29Z","updated_at":"2021-12-21T04:27:29Z","author_association":"CONTRIBUTOR","body":"@rdblue Is there any more concern about this PR?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998462433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998476814","html_url":"https://github.com/apache/iceberg/pull/3775#issuecomment-998476814","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3775","id":998476814,"node_id":"IC_kwDOCW7NX847g4wO","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T05:09:43Z","updated_at":"2021-12-21T05:09:43Z","author_association":"MEMBER","body":"@Me Reminder to back port test changes","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998476814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998502908","html_url":"https://github.com/apache/iceberg/issues/3776#issuecomment-998502908","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3776","id":998502908,"node_id":"IC_kwDOCW7NX847g_H8","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T06:13:52Z","updated_at":"2021-12-21T06:17:47Z","author_association":"CONTRIBUTOR","body":"After some digging, i find the direct cause is [that](https://github.com/apache/iceberg/blob/5009949ba4377ac5a8572ff7ae70e886c9e33bec/core/src/main/java/org/apache/iceberg/ManifestReader.java?#L100-L102):\r\nwhen we build a `AvroIterable`, we didn't set the class loader, then the default Thread#getContextClassLoader will be used.\r\n\r\nThe task is running in a persist shared [thread pool](https://github.com/apache/iceberg/blob/5009949ba4377ac5a8572ff7ae70e886c9e33bec/core/src/main/java/org/apache/iceberg/util/ThreadPools.java?#L60-L62),  whose context class loader will be closed in Flink TaskManager, after being used for the first time.\r\n\r\nHowever just setting the class loader manually is not enough, because others code may still use the context class loader, which can not be avoided.\r\nAn example exception stack like following, which is caused by ServiceLoader#load in JDK, \r\n<details>\r\n\r\n<summary>at javax.xml.parsers.FactoryFinder.findServiceProvider</summary>\r\n\r\n```\r\njava.lang.IllegalStateException: Trying to access closed classloader. Please check if you store classloaders directly or indirectly in static fields. If the stacktrace suggests that the leak occurs\r\nin a third party library and cannot be fixed immediately, you can disable this check with the configuration 'classloader.check-leaked-classloader'.\r\n        at org.apache.flink.runtime.execution.librarycache.FlinkUserCodeClassLoaders$SafetyNetWrapperClassLoader.ensureInner(FlinkUserCodeClassLoaders.java:159)\r\n        at org.apache.flink.runtime.execution.librarycache.FlinkUserCodeClassLoaders$SafetyNetWrapperClassLoader.getResources(FlinkUserCodeClassLoaders.java:188)\r\n        at java.util.ServiceLoader$LazyClassPathLookupIterator.nextProviderClass(ServiceLoader.java:1196)\r\n        at java.util.ServiceLoader$LazyClassPathLookupIterator.hasNextService(ServiceLoader.java:1221)\r\n        at java.util.ServiceLoader$LazyClassPathLookupIterator.hasNext(ServiceLoader.java:1265)\r\n        at java.util.ServiceLoader$2.hasNext(ServiceLoader.java:1300)\r\n        at java.util.ServiceLoader$3.hasNext(ServiceLoader.java:1385)\r\n        at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:287)\r\n        at java.security.AccessController.doPrivileged(Native Method)\r\n        at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:283)\r\n        at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:261)\r\n        at javax.xml.parsers.SAXParserFactory.newInstance(SAXParserFactory.java:147)\r\n        at org.jdom.input.JAXPParserFactory.createParser(JAXPParserFactory.java:125)\r\n        at jdk.internal.reflect.GeneratedMethodAccessor26.invoke(Unknown Source)\r\n        at jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.lang.reflect.Method.invoke(Method.java:566)\r\n        at org.jdom.input.SAXBuilder.createParser(SAXBuilder.java:585)\r\n        at org.jdom.input.SAXBuilder.build(SAXBuilder.java:460)\r\n        at org.jdom.input.SAXBuilder.build(SAXBuilder.java:807)\r\n        at com.aliyun.oss.internal.ResponseParsers.getXmlRootElement(ResponseParsers.java:1015)\r\n        at com.aliyun.oss.internal.ResponseParsers.parseListObjects(ResponseParsers.java:1028)\r\n        at com.aliyun.oss.internal.ResponseParsers$ListObjectsReponseParser.parse(ResponseParsers.java:562)\r\n        at com.aliyun.oss.internal.ResponseParsers$ListObjectsReponseParser.parse(ResponseParsers.java:556)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:152)\r\n        at com.aliyun.oss.internal.OSSOperation.doOperation(OSSOperation.java:113)\r\n        at com.aliyun.oss.internal.OSSBucketOperation.listObjects(OSSBucketOperation.java:421)\r\n        at com.aliyun.oss.OSSClient.listObjects(OSSClient.java:445)\r\n        at org.apache.hadoop.fs.aliyun.oss.AliyunOSSFileSystemStore.listObjects(AliyunOSSFileSystemStore.java:434)\r\n        at org.apache.hadoop.fs.aliyun.oss.AliyunOSSFileSystem.getFileStatus(AliyunOSSFileSystem.java:273)\r\n        at org.apache.hadoop.fs.aliyun.oss.AliyunOSSFileSystem.create(AliyunOSSFileSystem.java:115)\r\n        at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1118)\r\n        at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1098)\r\n        at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:987)\r\n        at org.apache.iceberg.hadoop.HadoopOutputFile.createOrOverwrite(HadoopOutputFile.java:85)\r\n        at org.apache.iceberg.avro.AvroFileAppender.<init>(AvroFileAppender.java:51)\r\n        at org.apache.iceberg.avro.Avro$WriteBuilder.build(Avro.java:198)\r\n        at org.apache.iceberg.ManifestWriter$V1Writer.newAppender(ManifestWriter.java:277)\r\n        at org.apache.iceberg.ManifestWriter.<init>(ManifestWriter.java:58)\r\n        at org.apache.iceberg.ManifestWriter.<init>(ManifestWriter.java:34)\r\n        at org.apache.iceberg.ManifestWriter$V1Writer.<init>(ManifestWriter.java:256)\r\n        at org.apache.iceberg.ManifestFiles.write(ManifestFiles.java:117)\r\n        at org.apache.iceberg.SnapshotProducer.newManifestWriter(SnapshotProducer.java:370)\r\n        at org.apache.iceberg.MergingSnapshotProducer$DataFileFilterManager.newManifestWriter(MergingSnapshotProducer.java:711)\r\n        at org.apache.iceberg.ManifestFilterManager.filterManifestWithDeletedFiles(ManifestFilterManager.java:383)\r\n        at org.apache.iceberg.ManifestFilterManager.filterManifest(ManifestFilterManager.java:308)\r\n        at org.apache.iceberg.ManifestFilterManager.lambda$filterManifests$0(ManifestFilterManager.java:186)\r\n        at org.apache.iceberg.util.Tasks$Builder.runTaskWithRetry(Tasks.java:405)\r\n        at org.apache.iceberg.util.Tasks$Builder.access$300(Tasks.java:71)\r\n        at org.apache.iceberg.util.Tasks$Builder$1.run(Tasks.java:311)\r\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n        at java.lang.Thread.run(Thread.java:829)\r\n```\r\n</details>\r\n\r\n\r\nSo looks like we should avoid using shared thread pool across different job.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998502908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998507583","html_url":"https://github.com/apache/iceberg/pull/3780#issuecomment-998507583","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3780","id":998507583,"node_id":"IC_kwDOCW7NX847hAQ_","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T06:24:16Z","updated_at":"2021-12-21T06:24:16Z","author_association":"CONTRIBUTOR","body":"> This is an update to #3293 that implements the `FileAppender` contract more closely to avoid test failures.\r\n>\r\n> This renames `writer` to `ensureWriterInitialized` and updates previous calls to `writer()` that would initialize the writer -- even if the appender was closed -- with null checks. `ensureWriterInitialized` is called when flushing a row group from the column write store to the file.\r\n\r\nI like this idea. My analysis on the former approach was the same as yours. There are also some fields that are built based off of the writer and associated factories that need to also be adjusted for lazy initialization (I believe). \r\n\r\nI'd be happy to also put a pair of eyes on this PR as well as it's an important part of the code.\r\n\r\nA large thank you to @NeQuissimus for the GCP-HDFS library concern. ðŸ‘ \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998507583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998581099","html_url":"https://github.com/apache/iceberg/pull/3645#issuecomment-998581099","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3645","id":998581099,"node_id":"IC_kwDOCW7NX847hSNr","user":{"login":"hbgstc123","id":8900183,"node_id":"MDQ6VXNlcjg5MDAxODM=","avatar_url":"https://avatars.githubusercontent.com/u/8900183?v=4","gravatar_id":"","url":"https://api.github.com/users/hbgstc123","html_url":"https://github.com/hbgstc123","followers_url":"https://api.github.com/users/hbgstc123/followers","following_url":"https://api.github.com/users/hbgstc123/following{/other_user}","gists_url":"https://api.github.com/users/hbgstc123/gists{/gist_id}","starred_url":"https://api.github.com/users/hbgstc123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbgstc123/subscriptions","organizations_url":"https://api.github.com/users/hbgstc123/orgs","repos_url":"https://api.github.com/users/hbgstc123/repos","events_url":"https://api.github.com/users/hbgstc123/events{/privacy}","received_events_url":"https://api.github.com/users/hbgstc123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T08:43:21Z","updated_at":"2021-12-21T08:43:21Z","author_association":"CONTRIBUTOR","body":"Thanks a lot for your time.\r\n@kbendick I have rebase off of master and merge the UT file(TestEvaluator).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998581099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998735019","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-998735019","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":998735019,"node_id":"IC_kwDOCW7NX847h3yr","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T12:22:12Z","updated_at":"2021-12-21T12:22:12Z","author_association":"MEMBER","body":"I think the table properties are stored in table metadata file [https://iceberg.apache.org/#spec/#table-metadata-fields] and only reference pointer (location) of table metadata is stored in hive metastore.\r\n\r\ncan you explain what is the problem you are facing because of this ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998735019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998805767","html_url":"https://github.com/apache/iceberg/issues/3105#issuecomment-998805767","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3105","id":998805767,"node_id":"IC_kwDOCW7NX847iJEH","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T14:04:34Z","updated_at":"2021-12-21T14:04:34Z","author_association":"CONTRIBUTOR","body":"> hey i would like to work on this issue...assign to me\r\n\r\n don't have to be assigned. feel free to go on. :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998805767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998851872","html_url":"https://github.com/apache/iceberg/pull/3780#issuecomment-998851872","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3780","id":998851872,"node_id":"IC_kwDOCW7NX847iUUg","user":{"login":"NeQuissimus","id":628342,"node_id":"MDQ6VXNlcjYyODM0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/628342?v=4","gravatar_id":"","url":"https://api.github.com/users/NeQuissimus","html_url":"https://github.com/NeQuissimus","followers_url":"https://api.github.com/users/NeQuissimus/followers","following_url":"https://api.github.com/users/NeQuissimus/following{/other_user}","gists_url":"https://api.github.com/users/NeQuissimus/gists{/gist_id}","starred_url":"https://api.github.com/users/NeQuissimus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NeQuissimus/subscriptions","organizations_url":"https://api.github.com/users/NeQuissimus/orgs","repos_url":"https://api.github.com/users/NeQuissimus/repos","events_url":"https://api.github.com/users/NeQuissimus/events{/privacy}","received_events_url":"https://api.github.com/users/NeQuissimus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T15:04:40Z","updated_at":"2021-12-21T15:04:40Z","author_association":"CONTRIBUTOR","body":"This is looking good! Thank you for taking the time to address the concerns","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998851872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998919853","html_url":"https://github.com/apache/iceberg/pull/3780#issuecomment-998919853","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3780","id":998919853,"node_id":"IC_kwDOCW7NX847ik6t","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T16:26:42Z","updated_at":"2021-12-21T16:26:42Z","author_association":"CONTRIBUTOR","body":"Looks like this is now causing rolling file writer tests to fail. We'll have to take a look at that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998919853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998922481","html_url":"https://github.com/apache/iceberg/pull/3645#issuecomment-998922481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3645","id":998922481,"node_id":"IC_kwDOCW7NX847iljx","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T16:30:23Z","updated_at":"2021-12-21T16:30:23Z","author_association":"CONTRIBUTOR","body":"Running CI.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998922481/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998924329","html_url":"https://github.com/apache/iceberg/pull/3782#issuecomment-998924329","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3782","id":998924329,"node_id":"IC_kwDOCW7NX847imAp","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T16:32:58Z","updated_at":"2021-12-21T16:32:58Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998924329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998930276","html_url":"https://github.com/apache/iceberg/pull/3779#issuecomment-998930276","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3779","id":998930276,"node_id":"IC_kwDOCW7NX847indk","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T16:41:28Z","updated_at":"2021-12-21T16:41:28Z","author_association":"CONTRIBUTOR","body":"Thanks, @williamhyun!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998930276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998937281","html_url":"https://github.com/apache/iceberg/pull/3778#issuecomment-998937281","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3778","id":998937281,"node_id":"IC_kwDOCW7NX847ipLB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T16:50:59Z","updated_at":"2021-12-21T16:50:59Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998937281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998963867","html_url":"https://github.com/apache/iceberg/pull/3763#issuecomment-998963867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3763","id":998963867,"node_id":"IC_kwDOCW7NX847ivqb","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T17:28:13Z","updated_at":"2021-12-21T17:28:13Z","author_association":"CONTRIBUTOR","body":"This needs another round or two. I am switching to copy-on-write MERGE for now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/998963867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999005484","html_url":"https://github.com/apache/iceberg/issues/3131#issuecomment-999005484","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3131","id":999005484,"node_id":"IC_kwDOCW7NX847i50s","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T18:35:40Z","updated_at":"2021-12-21T18:35:40Z","author_association":"CONTRIBUTOR","body":"> The security token included in the request is invalid\r\n\r\nThis does not seem Iceberg related, looks like you have a misconfiguration of your AWS credentials, e.g. you did not set your session token.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999005484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999015655","html_url":"https://github.com/apache/iceberg/pull/3718#issuecomment-999015655","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3718","id":999015655,"node_id":"IC_kwDOCW7NX847i8Tn","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T18:52:12Z","updated_at":"2021-12-21T18:52:12Z","author_association":"CONTRIBUTOR","body":"> Since SQL is the \"easy\" first use api I would try to hide features which may cause undesired effects.\r\n\r\n+1, especially as we are adding branching feature, expiring a specific snapshot by ID should be strongly discouraged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999015655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999018478","html_url":"https://github.com/apache/iceberg/issues/3678#issuecomment-999018478","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3678","id":999018478,"node_id":"IC_kwDOCW7NX847i8_u","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T18:57:14Z","updated_at":"2021-12-21T18:57:14Z","author_association":"CONTRIBUTOR","body":"thanks, assigned!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999018478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999073301","html_url":"https://github.com/apache/iceberg/pull/3787#issuecomment-999073301","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3787","id":999073301,"node_id":"IC_kwDOCW7NX847jKYV","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T20:28:33Z","updated_at":"2021-12-21T20:28:33Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @nastra @samredai @jackye1995 @RussellSpitzer added some documentation for `cache.expiration-interval-ms`.\r\n\r\nI still need to plumb it through Flink, which I'm working on today and will update the Flink docs afterwards.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999073301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999073673","html_url":"https://github.com/apache/iceberg/pull/3787#issuecomment-999073673","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3787","id":999073673,"node_id":"IC_kwDOCW7NX847jKeJ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T20:29:14Z","updated_at":"2021-12-21T23:27:54Z","author_association":"CONTRIBUTOR","body":"![image](https://user-images.githubusercontent.com/9833362/147010643-a6103b00-9074-4dae-a261-3123be673abb.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999073673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999172690","html_url":"https://github.com/apache/iceberg/pull/3787#issuecomment-999172690","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3787","id":999172690,"node_id":"IC_kwDOCW7NX847jipS","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-21T23:55:15Z","updated_at":"2021-12-21T23:55:15Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999172690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999175673","html_url":"https://github.com/apache/iceberg/pull/3770#issuecomment-999175673","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3770","id":999175673,"node_id":"IC_kwDOCW7NX847jjX5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T00:02:43Z","updated_at":"2021-12-22T00:02:43Z","author_association":"CONTRIBUTOR","body":"I'm +1 for committing this. I think it's a great start on the REST catalog spec and that the namespace basics are ready to go.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999175673/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999252754","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-999252754","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":999252754,"node_id":"IC_kwDOCW7NX847j2MS","user":{"login":"liangyouze","id":41617983,"node_id":"MDQ6VXNlcjQxNjE3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/41617983?v=4","gravatar_id":"","url":"https://api.github.com/users/liangyouze","html_url":"https://github.com/liangyouze","followers_url":"https://api.github.com/users/liangyouze/followers","following_url":"https://api.github.com/users/liangyouze/following{/other_user}","gists_url":"https://api.github.com/users/liangyouze/gists{/gist_id}","starred_url":"https://api.github.com/users/liangyouze/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liangyouze/subscriptions","organizations_url":"https://api.github.com/users/liangyouze/orgs","repos_url":"https://api.github.com/users/liangyouze/repos","events_url":"https://api.github.com/users/liangyouze/events{/privacy}","received_events_url":"https://api.github.com/users/liangyouze/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T03:15:17Z","updated_at":"2021-12-22T03:15:17Z","author_association":"NONE","body":"In our custom hive-metastore, we have made some routing rules for metadata according to tblproperties","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999252754/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999280508","html_url":"https://github.com/apache/iceberg/pull/3757#issuecomment-999280508","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3757","id":999280508,"node_id":"IC_kwDOCW7NX847j898","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T04:36:05Z","updated_at":"2021-12-22T04:36:05Z","author_association":"MEMBER","body":"> looks good to me, thanks for working on this! @ajantha-bhat please let me know if you would like to have also add fixes in the other version in this PR, or have separated PRs, up to you.\r\n\r\nI think separated is better as we are following for spark PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999280508/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999282213","html_url":"https://github.com/apache/iceberg/pull/3718#issuecomment-999282213","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3718","id":999282213,"node_id":"IC_kwDOCW7NX847j9Yl","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T04:41:54Z","updated_at":"2021-12-22T04:41:54Z","author_association":"MEMBER","body":"@jackye1995 , @RussellSpitzer , @rdblue : Thanks for your inputs. As majority of you (I think all of you) are not in favour of it, So, I am closing this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999282213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999285522","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-999285522","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":999285522,"node_id":"IC_kwDOCW7NX847j-MS","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T04:53:33Z","updated_at":"2021-12-22T04:53:33Z","author_association":"MEMBER","body":"Interesting use case. I think it should be possible to support storing table properties in hive metastore aswell. Let's see what others think. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999285522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999365892","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-999365892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":999365892,"node_id":"IC_kwDOCW7NX847kR0E","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T08:04:59Z","updated_at":"2021-12-22T08:04:59Z","author_association":"CONTRIBUTOR","body":"When creating a table we synchronise the iceberg table properties with the HMS table properties.\r\nSee:\r\nhttps://github.com/apache/iceberg/blob/7fcc71da65a47ca3c9f6eb6e862a238389b8bdc5/hive-metastore/src/main/java/org/apache/iceberg/hive/HiveTableOperations.java#L354-L397\r\n\r\nIn Hive 2 and Hive 3 there is no way to synchronise the Hive changes back to the Iceberg tables, but we have an upstream Hive patch for synchronising the changes in the other direction too (Hive->Iceberg): [HIVE-25065](https://issues.apache.org/jira/browse/HIVE-25065).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999365892/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999410029","html_url":"https://github.com/apache/iceberg/issues/3783#issuecomment-999410029","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3783","id":999410029,"node_id":"IC_kwDOCW7NX847kclt","user":{"login":"liangyouze","id":41617983,"node_id":"MDQ6VXNlcjQxNjE3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/41617983?v=4","gravatar_id":"","url":"https://api.github.com/users/liangyouze","html_url":"https://github.com/liangyouze","followers_url":"https://api.github.com/users/liangyouze/followers","following_url":"https://api.github.com/users/liangyouze/following{/other_user}","gists_url":"https://api.github.com/users/liangyouze/gists{/gist_id}","starred_url":"https://api.github.com/users/liangyouze/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liangyouze/subscriptions","organizations_url":"https://api.github.com/users/liangyouze/orgs","repos_url":"https://api.github.com/users/liangyouze/repos","events_url":"https://api.github.com/users/liangyouze/events{/privacy}","received_events_url":"https://api.github.com/users/liangyouze/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T09:09:57Z","updated_at":"2021-12-22T09:09:57Z","author_association":"NONE","body":"oh,it looks good, thanks. we used version 0.11.x, and this feature is not yet available. maybe we can update our version to 0.12","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999410029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999427065","html_url":"https://github.com/apache/iceberg/issues/3776#issuecomment-999427065","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3776","id":999427065,"node_id":"IC_kwDOCW7NX847kgv5","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T09:34:35Z","updated_at":"2021-12-22T09:51:44Z","author_association":"CONTRIBUTOR","body":"To be clear, i encountered this issue by putting the iceberg Flink runtime jar into the lib directory as [Flink suggested](https://nightlies.apache.org/flink/flink-docs-release-1.14/docs/ops/debugging/debugging_classloading/#avoiding-dynamic-classloading-for-user-code).\r\n\r\nSo i tested another scenario next, submit the iceberg jar as user code.\r\nAs expected, it can work well for the first several jobs, then the followed job will fail on meta space OOM\r\n```\r\njava.lang.OutOfMemoryError: Metaspace. The metaspace out-of-memory error has occurred. This can mean two things: either the job requires a larger size of JVM metaspace to load classes or there is a class loading leak. In the first case 'taskmanager.memory.jvm-metaspace.size' configuration option should be increased. If the error persists (usually in cluster after several job (re-)submissions) then there is probably a class loading leak in user code or some of its dependencies which has to be investigated and fixed. The task executor has to be shutdown...\r\n```\r\nYou can also see many `iceberg-worker-pool-0` threads because the worker pool can not be released along with the loaded user classes.\r\n\r\nSo either we need pass a ExecutorService to the tasks from the Flink context, ~or provide a mechanism to release these threads after job complete, like making use of `RuntimeContext#registerUserCodeClassLoaderReleaseHookIfAbsent`.~\r\n\r\n> release a shared pool may be not a good choice.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999427065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999473988","html_url":"https://github.com/apache/iceberg/pull/3752#issuecomment-999473988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3752","id":999473988,"node_id":"IC_kwDOCW7NX847ksNE","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T10:45:06Z","updated_at":"2021-12-22T10:45:06Z","author_association":"COLLABORATOR","body":"Thanks for the reviews @jackye1995 , @rdblue and @pvary! \r\nLet me know if you have additional thoughts or now this looks good for merging.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999473988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999569279","html_url":"https://github.com/apache/iceberg/pull/3708#issuecomment-999569279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3708","id":999569279,"node_id":"IC_kwDOCW7NX847lDd_","user":{"login":"xiaotianzhang01","id":17720945,"node_id":"MDQ6VXNlcjE3NzIwOTQ1","avatar_url":"https://avatars.githubusercontent.com/u/17720945?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaotianzhang01","html_url":"https://github.com/xiaotianzhang01","followers_url":"https://api.github.com/users/xiaotianzhang01/followers","following_url":"https://api.github.com/users/xiaotianzhang01/following{/other_user}","gists_url":"https://api.github.com/users/xiaotianzhang01/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaotianzhang01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaotianzhang01/subscriptions","organizations_url":"https://api.github.com/users/xiaotianzhang01/orgs","repos_url":"https://api.github.com/users/xiaotianzhang01/repos","events_url":"https://api.github.com/users/xiaotianzhang01/events{/privacy}","received_events_url":"https://api.github.com/users/xiaotianzhang01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T13:15:58Z","updated_at":"2021-12-22T13:15:58Z","author_association":"CONTRIBUTOR","body":"@rdblue Thank you for your comment. Sorry, the reply is a bit late, I have updated the pr and successfully ran ut locally\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999569279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999571704","html_url":"https://github.com/apache/iceberg/pull/3790#issuecomment-999571704","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3790","id":999571704,"node_id":"IC_kwDOCW7NX847lED4","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T13:19:41Z","updated_at":"2021-12-22T13:19:41Z","author_association":"CONTRIBUTOR","body":"@lirui-apache: Thanks for the PR. Did a quick cursory look, but sadly did not have time to a full review, as I have plenty to do and will be out on PTO till the end of the year.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999571704/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999759477","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-999759477","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":999759477,"node_id":"IC_kwDOCW7NX847lx51","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T17:50:35Z","updated_at":"2021-12-22T17:50:35Z","author_association":"CONTRIBUTOR","body":"I investigated this a little, and found that in 9c3e340c we added `MetadataTableInvalidatingCacheWriter`. From my understanding, I think it introduces additional writes to the cache in the `tableCache.get` trace called by `loadTable`. This probably violates an assumption made by caffeine's `Cache` class (that `get` calls do not change additional entries) - see javadoc (https://github.com/ben-manes/caffeine/blob/v2.8.4/caffeine/src/main/java/com/github/benmanes/caffeine/cache/Cache.java#L55-L68)\r\n\r\nThis causes the a deadlock between 2 threads: the procedure call thread (`HiveServer2-Background-Pool: Thread-1682` in the trace) trying to invalidate cache entries while caffeine's `PerformCleanupTask` (`ForkJoinPool.commonPool-worker-13` in the trace) is trying to cleanup the cache due to ttl expiration.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999759477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999762004","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-999762004","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":999762004,"node_id":"IC_kwDOCW7NX847lyhU","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T17:54:39Z","updated_at":"2021-12-22T17:54:39Z","author_association":"CONTRIBUTOR","body":"cc @kbendick could you take a look at this and tell me if it makes sense? \r\n\r\nThis is probably related to the cache expiration option we introduced recently","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999762004/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999764213","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-999764213","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":999764213,"node_id":"IC_kwDOCW7NX847lzD1","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T17:58:31Z","updated_at":"2021-12-22T17:58:31Z","author_association":"CONTRIBUTOR","body":"also cc @igorcalabria who helped me investigate this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999764213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999786184","html_url":"https://github.com/apache/iceberg/pull/3779#issuecomment-999786184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3779","id":999786184,"node_id":"IC_kwDOCW7NX847l4bI","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T18:39:09Z","updated_at":"2021-12-22T18:39:09Z","author_association":"MEMBER","body":"+1, LGTM. Thank you, @williamhyun and all!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999786184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999795888","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-999795888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":999795888,"node_id":"IC_kwDOCW7NX847l6yw","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T18:57:37Z","updated_at":"2021-12-22T18:57:37Z","author_association":"CONTRIBUTOR","body":"> cc @kbendick could you take a look at this and tell me if it makes sense?\r\n> \r\n> This is probably related to the cache expiration option we introduced recently\r\n\r\nThanks for the detailed report. I will take a look more closely at this this afternoon. The procedures make heavy use of the metadata tables.\r\n\r\nFor now, if you set `cache.expiration-interval-ms` to -1 on the catalogâ€™s configuration, youâ€™ll get the old behavior if youâ€™d like to continue using the SNAPSHOT to investigate other things.\r\n\r\nIf youâ€™d like to investigate further, as it might take me a day or two to get a reliable reproduction, you can try raising the value of `cache.expiration-interval-ms` to see if that reduces the likelihood of hitting the issue.\r\n\r\nThough it sounds like in your case it might be better to leave expiration off when calling the procedures.\r\n\r\nThanks again for the detailed report.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999795888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999796449","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-999796449","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":999796449,"node_id":"IC_kwDOCW7NX847l67h","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T18:58:44Z","updated_at":"2021-12-22T18:58:44Z","author_association":"CONTRIBUTOR","body":"Question: weâ€™re you running those procedures sequentially on one table, or on multiple tables?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999796449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999797600","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-999797600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":999797600,"node_id":"IC_kwDOCW7NX847l7Ng","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T19:00:56Z","updated_at":"2021-12-22T19:00:56Z","author_association":"CONTRIBUTOR","body":"> Question: weâ€™re you running those procedures sequentially on one table, or on multiple tables?\n\nMultiple tables (4 of them) ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999797600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999819976","html_url":"https://github.com/apache/iceberg/pull/3663#issuecomment-999819976","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3663","id":999819976,"node_id":"IC_kwDOCW7NX847mArI","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T19:41:33Z","updated_at":"2021-12-22T19:41:33Z","author_association":"CONTRIBUTOR","body":"Regarding the `@apiNote` tag issue, found this:\r\n\r\n> These tags are enabled by use of the -tag feature on the javadoc tool command line. They are not proposed as standard javadoc tags and may be implemented differently in future Java releases.\r\n\r\nSince this is not standard, let's just remove `@apiNote` tag and use plain sentence instead.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999819976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999840375","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-999840375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":999840375,"node_id":"IC_kwDOCW7NX847mFp3","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T20:21:08Z","updated_at":"2021-12-22T20:21:08Z","author_association":"CONTRIBUTOR","body":"Ok. And can you describe the tables (are they partitioned, how big are they) and also, how youv'e configured the procedure calls (do they have a filter, do they group commits or do they use the default behavior of committing all at the end)?\r\n\r\nI think this can be solved. I've just started researching more, and I am still working on a reproduction case. If you have one you can send or create a gist for, that would be awesome.\r\n\r\nBut I'm seeing a few options. We can pass a `scheduler` in to [make the expiration more synchronous](https://github.com/ben-manes/caffeine/wiki/Compute#synchronous-listeners), and then alternatively we can also consider trying to set both `refreshAfter` and `expireAfter`, as `refreshAfter` will mark the entry for removal, and then on the next round, it will return the [old value and then evict the entry (so the next get will return right away)](https://github.com/ben-manes/caffeine/issues/204#issuecomment-345312109).\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999840375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999897025","html_url":"https://github.com/apache/iceberg/pull/3774#issuecomment-999897025","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3774","id":999897025,"node_id":"IC_kwDOCW7NX847mTfB","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T21:40:35Z","updated_at":"2021-12-22T21:40:35Z","author_association":"CONTRIBUTOR","body":"3773 is merged, could you rebase?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999897025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999899745","html_url":"https://github.com/apache/iceberg/pull/3757#issuecomment-999899745","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3757","id":999899745,"node_id":"IC_kwDOCW7NX847mUJh","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-22T21:45:26Z","updated_at":"2021-12-22T21:45:26Z","author_association":"CONTRIBUTOR","body":"merged, thanks @ajantha-bhat for the fix, and thanks @RussellSpitzer and @rdblue for reviews!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/999899745/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000053831","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-1000053831","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":1000053831,"node_id":"IC_kwDOCW7NX847m5xH","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T05:28:42Z","updated_at":"2021-12-23T05:28:42Z","author_association":"NONE","body":"Java's ConcurrentHashMap does not allow for computations to modify the hash map. This may livelock, deadlock, or may throw an exception (Java 9+).\r\n\r\nA `CacheWriter` performs its actions under a map computation to be atomic. This has since been deprecated and removed in 3.0. Your use-case of responding to evictions is either served by an `evictionListener` (atomic; notified within the `computeIfPresent` removing the entry) or `removalListener` (async; notified after the computation). Since your callback is removing more entries, it looks like an async removal listener might work better here.\r\n\r\nThe `refreshAfterWrite` feature will proactively reload an entry if accessed after the threshold period. This can combined with expiration so that active content is kept fresh and inactive fades away. If only expiration is used then one may periodically see a latency spike when a popular item expires and the callers block waiting for it to be loaded. If both expiration and refresh are set to the same threshold then the entry is discarded, as one setting says it stale and the other that it is unusable. \r\n\r\nThe scheduler is helpful when application logic relies on timely removal of an expired entry. For example to close a websocket after the client times out due to inactivity. As the cache itself does not start any background threads, by default it relies on other activity (reads, writes) to trigger a maintenance cycle when it will sweep away expired entries.\r\n\r\nAs an aside, I would recommend against using soft references as they have long been a problematic Java feature. The usual reason is a lack of knowledge of a good maximum size, but delegating to the GC can cause high pause times and churn. Instead improving instrumentation and setting a size threshold allows for more predictable latencies, avoids GC death spirals / OOME, and allows for use of a better eviction algorithm.\r\n\r\nhope that helps a little.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000053831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000117806","html_url":"https://github.com/apache/iceberg/issues/3776#issuecomment-1000117806","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3776","id":1000117806,"node_id":"IC_kwDOCW7NX847nJYu","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T08:05:59Z","updated_at":"2021-12-23T08:05:59Z","author_association":"CONTRIBUTOR","body":"How about fixes this issue simply as #3797 ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000117806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000124516","html_url":"https://github.com/apache/iceberg/pull/3740#issuecomment-1000124516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3740","id":1000124516,"node_id":"IC_kwDOCW7NX847nLBk","user":{"login":"chenzihao5","id":38340392,"node_id":"MDQ6VXNlcjM4MzQwMzky","avatar_url":"https://avatars.githubusercontent.com/u/38340392?v=4","gravatar_id":"","url":"https://api.github.com/users/chenzihao5","html_url":"https://github.com/chenzihao5","followers_url":"https://api.github.com/users/chenzihao5/followers","following_url":"https://api.github.com/users/chenzihao5/following{/other_user}","gists_url":"https://api.github.com/users/chenzihao5/gists{/gist_id}","starred_url":"https://api.github.com/users/chenzihao5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenzihao5/subscriptions","organizations_url":"https://api.github.com/users/chenzihao5/orgs","repos_url":"https://api.github.com/users/chenzihao5/repos","events_url":"https://api.github.com/users/chenzihao5/events{/privacy}","received_events_url":"https://api.github.com/users/chenzihao5/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T08:18:11Z","updated_at":"2021-12-23T08:18:11Z","author_association":"CONTRIBUTOR","body":"@rdblue I have updated test into existing test suite for Avro writer and reformat code style. Please help to review it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000124516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000151988","html_url":"https://github.com/apache/iceberg/pull/3728#issuecomment-1000151988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3728","id":1000151988,"node_id":"IC_kwDOCW7NX847nRu0","user":{"login":"xiaotianzhang01","id":17720945,"node_id":"MDQ6VXNlcjE3NzIwOTQ1","avatar_url":"https://avatars.githubusercontent.com/u/17720945?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaotianzhang01","html_url":"https://github.com/xiaotianzhang01","followers_url":"https://api.github.com/users/xiaotianzhang01/followers","following_url":"https://api.github.com/users/xiaotianzhang01/following{/other_user}","gists_url":"https://api.github.com/users/xiaotianzhang01/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaotianzhang01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaotianzhang01/subscriptions","organizations_url":"https://api.github.com/users/xiaotianzhang01/orgs","repos_url":"https://api.github.com/users/xiaotianzhang01/repos","events_url":"https://api.github.com/users/xiaotianzhang01/events{/privacy}","received_events_url":"https://api.github.com/users/xiaotianzhang01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T09:08:31Z","updated_at":"2021-12-23T09:08:31Z","author_association":"CONTRIBUTOR","body":"@rdblue @kbendick Please take a look at it again.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000151988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000298714","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-1000298714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":1000298714,"node_id":"IC_kwDOCW7NX847n1ja","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T13:17:32Z","updated_at":"2021-12-23T13:17:32Z","author_association":"CONTRIBUTOR","body":"Thanks for the detailed explanation @ben-manes! This helps a lot.\r\n\r\n> I think this can be solved. I've just started researching more, and I am still working on a reproduction case. If you have one you can send or create a gist for, that would be awesome.\r\n\r\nI can try to create a failing test reproducing the two threads. It's quite difficult to reproduce this (as it normally is with deadlocks).\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000298714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000300842","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-1000300842","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":1000300842,"node_id":"IC_kwDOCW7NX847n2Eq","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T13:21:11Z","updated_at":"2021-12-23T13:21:11Z","author_association":"CONTRIBUTOR","body":"> Ok. And can you describe the tables (are they partitioned, how big are they) and also, how youv'e configured the procedure calls (do they have a filter, do they group commits or do they use the default behavior of committing all at the end)?\r\n\r\nThe tables are quite small (~500MB). They are not partitioned.\r\nThe procedures are just using the default behavior (except for the file size in `rewrite_data_files`):\r\n```sql\r\nCALL prod.system.expire_snapshots(table => 'my_db.table');\r\nCALL prod.system.rewrite_data_files(table => 'my_db.table', options => map('target-file-size-bytes','26214400')); --25MB\r\nCALL prod.system.rewrite_manifests(table => 'my_db.table');\r\nCALL prod.system.remove_orphan_files(table => 'my_db.table');\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000300842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000330564","html_url":"https://github.com/apache/iceberg/pull/3293#issuecomment-1000330564","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3293","id":1000330564,"node_id":"IC_kwDOCW7NX847n9VE","user":{"login":"NeQuissimus","id":628342,"node_id":"MDQ6VXNlcjYyODM0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/628342?v=4","gravatar_id":"","url":"https://api.github.com/users/NeQuissimus","html_url":"https://github.com/NeQuissimus","followers_url":"https://api.github.com/users/NeQuissimus/followers","following_url":"https://api.github.com/users/NeQuissimus/following{/other_user}","gists_url":"https://api.github.com/users/NeQuissimus/gists{/gist_id}","starred_url":"https://api.github.com/users/NeQuissimus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NeQuissimus/subscriptions","organizations_url":"https://api.github.com/users/NeQuissimus/orgs","repos_url":"https://api.github.com/users/NeQuissimus/repos","events_url":"https://api.github.com/users/NeQuissimus/events{/privacy}","received_events_url":"https://api.github.com/users/NeQuissimus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T14:10:24Z","updated_at":"2021-12-23T14:10:24Z","author_association":"CONTRIBUTOR","body":"Superseded by #3780","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000330564/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000342248","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-1000342248","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":1000342248,"node_id":"IC_kwDOCW7NX847oALo","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T14:30:01Z","updated_at":"2021-12-23T14:30:01Z","author_association":"CONTRIBUTOR","body":"I have a failing test and a fix. I will open the PRs soon","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000342248/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000411576","html_url":"https://github.com/apache/iceberg/issues/3791#issuecomment-1000411576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3791","id":1000411576,"node_id":"IC_kwDOCW7NX847oRG4","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T16:31:24Z","updated_at":"2021-12-23T16:31:24Z","author_association":"CONTRIBUTOR","body":"Opened #3798 (failing test) and #3801 (fix)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000411576/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000441720","html_url":"https://github.com/apache/iceberg/pull/3740#issuecomment-1000441720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3740","id":1000441720,"node_id":"IC_kwDOCW7NX847oYd4","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T17:33:31Z","updated_at":"2021-12-23T17:33:31Z","author_association":"CONTRIBUTOR","body":"Thanks, @chenzihao5! Looks good to me now. I'm running CI and will merge when it passes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000441720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000443538","html_url":"https://github.com/apache/iceberg/pull/3647#issuecomment-1000443538","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3647","id":1000443538,"node_id":"IC_kwDOCW7NX847oY6S","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T17:37:54Z","updated_at":"2021-12-23T17:37:54Z","author_association":"CONTRIBUTOR","body":"@stevenzwu can you make a recommendation on the best way to fix this issue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000443538/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000445717","html_url":"https://github.com/apache/iceberg/pull/3552#issuecomment-1000445717","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3552","id":1000445717,"node_id":"IC_kwDOCW7NX847oZcV","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T17:43:04Z","updated_at":"2021-12-23T17:43:04Z","author_association":"CONTRIBUTOR","body":"Thanks, @Reo-LEI! I don't think that we necessarily need to reproduce the issue in an integration test. It is reasonable to make these serializable, but we do need tests to verify that the implementations are serializable. If you don't mind adding those, I'll merge this.\r\n\r\nIt would also be great to post the stack trace that you saw in production from Kryo. Those are always helpful when people search for errors they're seeing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000445717/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000499351","html_url":"https://github.com/apache/iceberg/pull/3800#issuecomment-1000499351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3800","id":1000499351,"node_id":"IC_kwDOCW7NX847omiX","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T19:57:58Z","updated_at":"2021-12-23T19:57:58Z","author_association":"CONTRIBUTOR","body":"Thanks, @sanyud24! Great to have this written up.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000499351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000514567","html_url":"https://github.com/apache/iceberg/pull/3740#issuecomment-1000514567","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3740","id":1000514567,"node_id":"IC_kwDOCW7NX847oqQH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T20:39:11Z","updated_at":"2021-12-23T20:39:11Z","author_association":"CONTRIBUTOR","body":"Thanks, @chenzihao5! I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000514567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000514653","html_url":"https://github.com/apache/iceberg/issues/3738#issuecomment-1000514653","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3738","id":1000514653,"node_id":"IC_kwDOCW7NX847oqRd","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T20:39:28Z","updated_at":"2021-12-23T20:39:28Z","author_association":"CONTRIBUTOR","body":"Fixed by #3740.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000514653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000556478","html_url":"https://github.com/apache/iceberg/issues/3558#issuecomment-1000556478","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3558","id":1000556478,"node_id":"IC_kwDOCW7NX847o0e-","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-23T23:04:53Z","updated_at":"2021-12-23T23:04:53Z","author_association":"CONTRIBUTOR","body":"Hi Russellï¼ŒI test flowï¼š\r\n```\r\n1.public class SparkCatalog extends BaseCatalog implements SupportsPartitionManagement\r\n2.in TestPartitionedWrites's junit\r\n@Test\r\n  public void testAddPartition() {\r\n    sql(\"ALTER TABLE %s ADD IF NOT EXISTS PARTITION (data='1')\", tableName);\r\n    spark.table(tableName).printSchema();\r\n  }\r\n\r\n  @Test\r\n  public void testDropPartition() {\r\n    sql(\"ALTER TABLE %s DROP IF EXISTS PARTITION (data_bucket=3)\", tableName);\r\n  }\r\n3.error log\r\n\r\norg.apache.iceberg.spark.sql.TestPartitionedWrites > testAddPartition[catalogName = testhive, implementation = org.apache.iceberg.spark.SparkCatalog, config = {type=hive, default-namespace=default}] FAILED\r\n    org.apache.spark.sql.AnalysisException: Table testhive.default.table does not support partition management.;\r\n    'AddPartitions [unresolvedpartitionspec((data,1), None)], true\r\n    +- ResolvedTable org.apache.iceberg.spark.SparkCatalog@1a4564a2, default.table, testhive.default.table, [id#9L, data#10]\r\n        at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.failAnalysis(CheckAnalysis.scala:51)\r\n        at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.failAnalysis$(CheckAnalysis.scala:50)\r\n        at org.apache.spark.sql.catalyst.analysis.Analyzer.failAnalysis(Analyzer.scala:172)\r\n        at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1(CheckAnalysis.scala:151)\r\n        at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.$anonfun$checkAnalysis$1$adapted(CheckAnalysis.scala:94)\r\n        at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:263)\r\n        at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis(CheckAnalysis.scala:94)\r\n        at org.apache.spark.sql.catalyst.analysis.CheckAnalysis.checkAnalysis$(CheckAnalysis.scala:91)\r\n        at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:172)\r\n        at org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:195)\r\n        at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:330)\r\n        at org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:192)\r\n        at org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:88)\r\n        at org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:111)\r\n        at org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:196)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n        at org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:196)\r\n        at org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:88)\r\n        at org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:86)\r\n        at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:78)\r\n        at org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:98)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n        at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:96)\r\n        at org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:618)\r\n        at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:775)\r\n        at org.apache.spark.sql.SparkSession.sql(SparkSession.scala:613)\r\n        at org.apache.iceberg.spark.SparkTestBase.sql(SparkTestBase.java:95)\r\n        at org.apache.iceberg.spark.sql.TestPartitionedWrites.testAddPartition(TestPartitionedWrites.java:182)\r\n```\r\nTable testhive.default.table does not support partition management. How support partition management? thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000556478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000599936","html_url":"https://github.com/apache/iceberg/issues/3776#issuecomment-1000599936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3776","id":1000599936,"node_id":"IC_kwDOCW7NX847o_GA","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T01:31:28Z","updated_at":"2021-12-24T01:31:28Z","author_association":"CONTRIBUTOR","body":"@rdblue Would you help to check this issue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000599936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000637247","html_url":"https://github.com/apache/iceberg/pull/3803#issuecomment-1000637247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3803","id":1000637247,"node_id":"IC_kwDOCW7NX847pIM_","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T03:53:44Z","updated_at":"2021-12-24T03:57:41Z","author_association":"CONTRIBUTOR","body":"Some of the relevant fixes for us might include:\r\n\r\nFrom 2.8.5:\r\n- Fixed expiration delay for scheduled cleanup [#431](https://github.com/ben-manes/caffeine/issues/431), which might have helped out with the potential deadlock reported by @racevedoo, as the reported issue is very similar to #3791 (though I think we should still use the fix that they provided for now if it's been verified against the tables that they can consistently see the deadlock on).\r\n\r\nFrom 2.9.0:\r\n- Added Caffeine.evictionListener which is notified within the atomic operation when an entry is automatically removed. (This method was how I was originally going to attempt to fix #3791 until @racevedoo graciously supplied a fix in #3801)\r\n- Added triggering cache maintenance if an iterator observes an expired entry for more aggressive eviction","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000637247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000637444","html_url":"https://github.com/apache/iceberg/pull/3803#issuecomment-1000637444","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3803","id":1000637444,"node_id":"IC_kwDOCW7NX847pIQE","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T03:54:36Z","updated_at":"2021-12-24T03:54:36Z","author_association":"CONTRIBUTOR","body":"Here's the incompatibilities between 2.x and 3.x (which are mostly due to the need to support people who use this cache in place of Guava or similar libraries). It's a rather small list.\r\n\r\n```\r\nIncompatible changes\r\nVarExpiration time-based puts now return the old value instead of a boolean result\r\nRemoved jandex resource as no longer utilized by Quarkus\r\nSplit Policy.Expiration into fixed and refresh interfaces\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000637444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000680057","html_url":"https://github.com/apache/iceberg/pull/3803#issuecomment-1000680057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3803","id":1000680057,"node_id":"IC_kwDOCW7NX847pSp5","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T06:31:02Z","updated_at":"2021-12-24T06:32:17Z","author_association":"CONTRIBUTOR","body":"I'm going to wait until #3801 is merged in and then follow up on this. This should be considered a draft, but I can't convert it to draft now AFAIK.\r\n\r\nCaffeine is very nuanced, and there's a change required in #3801 (for tests only) that's not required by upgrading to 2.8.5 from 2.8.4.\r\n\r\nGiven the complexity of `Caffeine` and the time I've spent looking into it, I'm going to help keep our eyes on keeping this dependency up to date etc. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000680057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000688746","html_url":"https://github.com/apache/iceberg/pull/2925#issuecomment-1000688746","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2925","id":1000688746,"node_id":"IC_kwDOCW7NX847pUxq","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T07:02:43Z","updated_at":"2022-01-04T20:04:16Z","author_association":"COLLABORATOR","body":"This change now adds validation for conflicting delta files.  \r\n\r\nImplementation note:  One option was to convert PartitionSet => Expression to re-use existing validation methods that take Expression.  But as per earlier comment, we go with new version of validateAddedFiles that takes in PartitionSet, we also now add new version of validateNoNewDeletesForDataFiles that takes PartitionSet.\r\n\r\nOn UX side, user enables it by setting following Spark write conf: validate-from-snapshot, as I understood from comment:  https://github.com/apache/iceberg/pull/3069#discussion_r711803863. This then triggers validation if dynamic.overwrite.isolation.level is serializable (the new default), else there is no validation.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000688746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000693127","html_url":"https://github.com/apache/iceberg/pull/3800#issuecomment-1000693127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3800","id":1000693127,"node_id":"IC_kwDOCW7NX847pV2H","user":{"login":"sanyud24","id":57134307,"node_id":"MDQ6VXNlcjU3MTM0MzA3","avatar_url":"https://avatars.githubusercontent.com/u/57134307?v=4","gravatar_id":"","url":"https://api.github.com/users/sanyud24","html_url":"https://github.com/sanyud24","followers_url":"https://api.github.com/users/sanyud24/followers","following_url":"https://api.github.com/users/sanyud24/following{/other_user}","gists_url":"https://api.github.com/users/sanyud24/gists{/gist_id}","starred_url":"https://api.github.com/users/sanyud24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanyud24/subscriptions","organizations_url":"https://api.github.com/users/sanyud24/orgs","repos_url":"https://api.github.com/users/sanyud24/repos","events_url":"https://api.github.com/users/sanyud24/events{/privacy}","received_events_url":"https://api.github.com/users/sanyud24/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T07:15:34Z","updated_at":"2021-12-24T07:15:34Z","author_association":"CONTRIBUTOR","body":"> Thanks, @sanyud24! Great to have this written up.\r\n\r\nYou're welcomeðŸ˜Š","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000693127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000699960","html_url":"https://github.com/apache/iceberg/pull/3803#issuecomment-1000699960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3803","id":1000699960,"node_id":"IC_kwDOCW7NX847pXg4","user":{"login":"ben-manes","id":378614,"node_id":"MDQ6VXNlcjM3ODYxNA==","avatar_url":"https://avatars.githubusercontent.com/u/378614?v=4","gravatar_id":"","url":"https://api.github.com/users/ben-manes","html_url":"https://github.com/ben-manes","followers_url":"https://api.github.com/users/ben-manes/followers","following_url":"https://api.github.com/users/ben-manes/following{/other_user}","gists_url":"https://api.github.com/users/ben-manes/gists{/gist_id}","starred_url":"https://api.github.com/users/ben-manes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ben-manes/subscriptions","organizations_url":"https://api.github.com/users/ben-manes/orgs","repos_url":"https://api.github.com/users/ben-manes/repos","events_url":"https://api.github.com/users/ben-manes/events{/privacy}","received_events_url":"https://api.github.com/users/ben-manes/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T07:32:52Z","updated_at":"2021-12-24T07:32:52Z","author_association":"NONE","body":"The main incompatibility was internal by requiring Java 11 so that Unsafe could be replaced by VarHandles. Otherwise it was api cleanups and implementation improvements that warranted waiting for a major release. It is good to keep up to date as it is very complex code so there have unfortunately been bugs despite my best efforts.\r\n\r\nYou might consider using this plugin to help track updates:\r\nhttps://github.com/ben-manes/gradle-versions-plugin","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000699960/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000719048","html_url":"https://github.com/apache/iceberg/pull/3482#issuecomment-1000719048","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3482","id":1000719048,"node_id":"IC_kwDOCW7NX847pcLI","user":{"login":"KnightChess","id":20125927,"node_id":"MDQ6VXNlcjIwMTI1OTI3","avatar_url":"https://avatars.githubusercontent.com/u/20125927?v=4","gravatar_id":"","url":"https://api.github.com/users/KnightChess","html_url":"https://github.com/KnightChess","followers_url":"https://api.github.com/users/KnightChess/followers","following_url":"https://api.github.com/users/KnightChess/following{/other_user}","gists_url":"https://api.github.com/users/KnightChess/gists{/gist_id}","starred_url":"https://api.github.com/users/KnightChess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KnightChess/subscriptions","organizations_url":"https://api.github.com/users/KnightChess/orgs","repos_url":"https://api.github.com/users/KnightChess/repos","events_url":"https://api.github.com/users/KnightChess/events{/privacy}","received_events_url":"https://api.github.com/users/KnightChess/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T08:21:36Z","updated_at":"2021-12-24T08:21:36Z","author_association":"CONTRIBUTOR","body":"update and fix conflict from #3422 , the style for markdown table look good.\r\ncc: @rdblue @samredai ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000719048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000762129","html_url":"https://github.com/apache/iceberg/pull/3801#issuecomment-1000762129","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3801","id":1000762129,"node_id":"IC_kwDOCW7NX847pmsR","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T09:56:30Z","updated_at":"2021-12-24T09:57:18Z","author_association":"CONTRIBUTOR","body":"Oops, I missed some of the comments/edits.\r\n\r\n@kbendick from my perspective, the proper fix is indeed upgrading to caffeine 2.9.x and using `evictionListener`. This would get us rid of awaitility and the `cleanUp` calls. I still have to check if the test in #3798 passes though\r\n\r\nI'll try to work on this today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000762129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000829379","html_url":"https://github.com/apache/iceberg/pull/3790#issuecomment-1000829379","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3790","id":1000829379,"node_id":"IC_kwDOCW7NX847p3HD","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T12:57:21Z","updated_at":"2021-12-24T12:57:21Z","author_association":"CONTRIBUTOR","body":"The latest patch deletes the temp folder between test class, so the test failures are reproduced. I'll update to clear more static fields.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000829379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000843016","html_url":"https://github.com/apache/iceberg/pull/3801#issuecomment-1000843016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3801","id":1000843016,"node_id":"IC_kwDOCW7NX847p6cI","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T13:37:43Z","updated_at":"2021-12-24T13:37:43Z","author_association":"CONTRIBUTOR","body":"Actually `evictionListener` seems to be called only within the `cleanUp` task. I'm not sure if I understood correctly, but I guess we should move forward with the upgrade to caffeine 2.8.5 and keep the `cleanUp` in `cache()` until we investigate this in more detail","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000843016/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000844385","html_url":"https://github.com/apache/iceberg/pull/3801#issuecomment-1000844385","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3801","id":1000844385,"node_id":"IC_kwDOCW7NX847p6xh","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T13:43:28Z","updated_at":"2021-12-24T13:43:28Z","author_association":"CONTRIBUTOR","body":"Caffeine upgraded to 2.8.5\r\n\r\n> I've been out of office due to the holidays. In addition to the unit test, have you verified that this change actually fixes the issue that you reported (e.g. compile it and use the jar from your local build)? That would be the best form of verification, but given the reproduction test case in #3798, that's not required.\r\n\r\nI'm out of office too, so I haven't verified if this change fixes the issue, but I guess the unit test is good enough","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000844385/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000852750","html_url":"https://github.com/apache/iceberg/pull/3801#issuecomment-1000852750","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3801","id":1000852750,"node_id":"IC_kwDOCW7NX847p80O","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T14:10:55Z","updated_at":"2021-12-24T14:10:55Z","author_association":"CONTRIBUTOR","body":"Guys, sorry for the lots of force-pushes. The main changes/discoveries from the previous state are:\r\n- Upgraded to caffeine 2.9.x\r\n- Added the test present in #3798 (I guess we can close that PR if the test is fine)\r\n- Kept using `removalListener` since `evictionListener` is synchronous and also causes the deadlock (the test fails)\r\n- Kept awaitility since removalListener is async","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000852750/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000937447","html_url":"https://github.com/apache/iceberg/pull/3801#issuecomment-1000937447","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3801","id":1000937447,"node_id":"IC_kwDOCW7NX847qRfn","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-24T21:52:01Z","updated_at":"2021-12-24T21:52:01Z","author_association":"CONTRIBUTOR","body":"Thanks for the follow up @racevedoo! No worries on the force pushes, just be sure to rebase off of master when needed. \r\n\r\nAlso, @racevedoo and I are syncing up offline about some of the changes in the tests. Will comment here with more detail later. ðŸ™‚","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000937447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000950819","html_url":"https://github.com/apache/iceberg/pull/3803#issuecomment-1000950819","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3803","id":1000950819,"node_id":"IC_kwDOCW7NX847qUwj","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-25T00:20:29Z","updated_at":"2021-12-25T00:20:29Z","author_association":"CONTRIBUTOR","body":"> The main incompatibility was internal by requiring Java 11 so that Unsafe could be replaced by VarHandles. Otherwise it was api cleanups and implementation improvements that warranted waiting for a major release. It is good to keep up to date as it is very complex code so there have unfortunately been bugs despite my best efforts.\r\n> \r\n> You might consider using this plugin to help track updates: https://github.com/ben-manes/gradle-versions-plugin\r\n\r\nAnything that complex is likely to see some bugs now and again. But itâ€™s worth the complexity as itâ€™s quite efficient!\r\n\r\nSo the 3.x line requires Java 11? I missed that. Thanks for the clarification. Due to Hive compatibility and compatibility with the various engines we integrate with, we currently build for / with Java 8.\r\n\r\nThanks for the info!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000950819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000969099","html_url":"https://github.com/apache/iceberg/pull/3645#issuecomment-1000969099","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3645","id":1000969099,"node_id":"IC_kwDOCW7NX847qZOL","user":{"login":"hbgstc123","id":8900183,"node_id":"MDQ6VXNlcjg5MDAxODM=","avatar_url":"https://avatars.githubusercontent.com/u/8900183?v=4","gravatar_id":"","url":"https://api.github.com/users/hbgstc123","html_url":"https://github.com/hbgstc123","followers_url":"https://api.github.com/users/hbgstc123/followers","following_url":"https://api.github.com/users/hbgstc123/following{/other_user}","gists_url":"https://api.github.com/users/hbgstc123/gists{/gist_id}","starred_url":"https://api.github.com/users/hbgstc123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbgstc123/subscriptions","organizations_url":"https://api.github.com/users/hbgstc123/orgs","repos_url":"https://api.github.com/users/hbgstc123/repos","events_url":"https://api.github.com/users/hbgstc123/events{/privacy}","received_events_url":"https://api.github.com/users/hbgstc123/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-25T03:59:38Z","updated_at":"2021-12-25T03:59:38Z","author_association":"CONTRIBUTOR","body":"@kbendick @rdblue CI have passed, is this pr ready to merge?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1000969099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001102221","html_url":"https://github.com/apache/iceberg/issues/3805#issuecomment-1001102221","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3805","id":1001102221,"node_id":"IC_kwDOCW7NX847q5uN","user":{"login":"lipusheng","id":57984409,"node_id":"MDQ6VXNlcjU3OTg0NDA5","avatar_url":"https://avatars.githubusercontent.com/u/57984409?v=4","gravatar_id":"","url":"https://api.github.com/users/lipusheng","html_url":"https://github.com/lipusheng","followers_url":"https://api.github.com/users/lipusheng/followers","following_url":"https://api.github.com/users/lipusheng/following{/other_user}","gists_url":"https://api.github.com/users/lipusheng/gists{/gist_id}","starred_url":"https://api.github.com/users/lipusheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lipusheng/subscriptions","organizations_url":"https://api.github.com/users/lipusheng/orgs","repos_url":"https://api.github.com/users/lipusheng/repos","events_url":"https://api.github.com/users/lipusheng/events{/privacy}","received_events_url":"https://api.github.com/users/lipusheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-26T03:40:16Z","updated_at":"2021-12-26T03:40:16Z","author_association":"NONE","body":"This is the pr https://github.com/apache/iceberg/pull/3806","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001102221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001197451","html_url":"https://github.com/apache/iceberg/pull/3798#issuecomment-1001197451","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3798","id":1001197451,"node_id":"IC_kwDOCW7NX847rQ-L","user":{"login":"racevedoo","id":5193063,"node_id":"MDQ6VXNlcjUxOTMwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/5193063?v=4","gravatar_id":"","url":"https://api.github.com/users/racevedoo","html_url":"https://github.com/racevedoo","followers_url":"https://api.github.com/users/racevedoo/followers","following_url":"https://api.github.com/users/racevedoo/following{/other_user}","gists_url":"https://api.github.com/users/racevedoo/gists{/gist_id}","starred_url":"https://api.github.com/users/racevedoo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/racevedoo/subscriptions","organizations_url":"https://api.github.com/users/racevedoo/orgs","repos_url":"https://api.github.com/users/racevedoo/repos","events_url":"https://api.github.com/users/racevedoo/events{/privacy}","received_events_url":"https://api.github.com/users/racevedoo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-26T15:04:09Z","updated_at":"2021-12-26T15:04:09Z","author_association":"CONTRIBUTOR","body":"Superseeded by #3801 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001197451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001283776","html_url":"https://github.com/apache/iceberg/issues/3558#issuecomment-1001283776","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3558","id":1001283776,"node_id":"IC_kwDOCW7NX847rmDA","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T01:40:28Z","updated_at":"2021-12-27T01:40:28Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001283776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001438614","html_url":"https://github.com/apache/iceberg/issues/2976#issuecomment-1001438614","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2976","id":1001438614,"node_id":"IC_kwDOCW7NX847sL2W","user":{"login":"dev-lpq","id":43336508,"node_id":"MDQ6VXNlcjQzMzM2NTA4","avatar_url":"https://avatars.githubusercontent.com/u/43336508?v=4","gravatar_id":"","url":"https://api.github.com/users/dev-lpq","html_url":"https://github.com/dev-lpq","followers_url":"https://api.github.com/users/dev-lpq/followers","following_url":"https://api.github.com/users/dev-lpq/following{/other_user}","gists_url":"https://api.github.com/users/dev-lpq/gists{/gist_id}","starred_url":"https://api.github.com/users/dev-lpq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dev-lpq/subscriptions","organizations_url":"https://api.github.com/users/dev-lpq/orgs","repos_url":"https://api.github.com/users/dev-lpq/repos","events_url":"https://api.github.com/users/dev-lpq/events{/privacy}","received_events_url":"https://api.github.com/users/dev-lpq/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T08:46:56Z","updated_at":"2021-12-27T08:46:56Z","author_association":"NONE","body":" \bWe have the same issue. ClassCastException is seen with Spark 3.1.x on a wide table. The error occurs in iceberg overwritePartitions. I checked the table schemas is right. I  retry Spark 3.0.x, and work failed. Not all tables have the issue, only a few tables have problems. Please help check the issue, thanks.\r\n\r\n `\r\n java.lang.ClassCastException: org.apache.spark.sql.catalyst.expressions.GenericInternalRow cannot be cast to org.apache.spark.sql.catalyst.expressions.UnsafeRow\r\n\tat org.apache.spark.sql.execution.UnsafeExternalRowSorter.sort(UnsafeExternalRowSorter.java:226)\r\n\tat org.apache.spark.sql.execution.SortExec.$anonfun$doExecute$1(SortExec.scala:119)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:898)\r\n\tat org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:898)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)\r\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:373)\r\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:337)\r\n\tat org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)\r\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)\r\n\tat org.apache.spark.scheduler.Task.run(Task.scala:131)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:497)\r\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1439)\r\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:500)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n`\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001438614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001452720","html_url":"https://github.com/apache/iceberg/issues/3585#issuecomment-1001452720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3585","id":1001452720,"node_id":"IC_kwDOCW7NX847sPSw","user":{"login":"Narcasserun","id":39329477,"node_id":"MDQ6VXNlcjM5MzI5NDc3","avatar_url":"https://avatars.githubusercontent.com/u/39329477?v=4","gravatar_id":"","url":"https://api.github.com/users/Narcasserun","html_url":"https://github.com/Narcasserun","followers_url":"https://api.github.com/users/Narcasserun/followers","following_url":"https://api.github.com/users/Narcasserun/following{/other_user}","gists_url":"https://api.github.com/users/Narcasserun/gists{/gist_id}","starred_url":"https://api.github.com/users/Narcasserun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Narcasserun/subscriptions","organizations_url":"https://api.github.com/users/Narcasserun/orgs","repos_url":"https://api.github.com/users/Narcasserun/repos","events_url":"https://api.github.com/users/Narcasserun/events{/privacy}","received_events_url":"https://api.github.com/users/Narcasserun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T09:10:49Z","updated_at":"2021-12-27T09:10:49Z","author_association":"NONE","body":"+1 ï¼ŒI have the same problem","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001452720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001463617","html_url":"https://github.com/apache/iceberg/pull/3804#issuecomment-1001463617","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3804","id":1001463617,"node_id":"IC_kwDOCW7NX847sR9B","user":{"login":"Narcasserun","id":39329477,"node_id":"MDQ6VXNlcjM5MzI5NDc3","avatar_url":"https://avatars.githubusercontent.com/u/39329477?v=4","gravatar_id":"","url":"https://api.github.com/users/Narcasserun","html_url":"https://github.com/Narcasserun","followers_url":"https://api.github.com/users/Narcasserun/followers","following_url":"https://api.github.com/users/Narcasserun/following{/other_user}","gists_url":"https://api.github.com/users/Narcasserun/gists{/gist_id}","starred_url":"https://api.github.com/users/Narcasserun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Narcasserun/subscriptions","organizations_url":"https://api.github.com/users/Narcasserun/orgs","repos_url":"https://api.github.com/users/Narcasserun/repos","events_url":"https://api.github.com/users/Narcasserun/events{/privacy}","received_events_url":"https://api.github.com/users/Narcasserun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T09:25:40Z","updated_at":"2021-12-27T09:26:05Z","author_association":"NONE","body":"Great","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001463617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001560391","html_url":"https://github.com/apache/iceberg/pull/3810#issuecomment-1001560391","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3810","id":1001560391,"node_id":"IC_kwDOCW7NX847splH","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T13:06:13Z","updated_at":"2021-12-27T13:06:13Z","author_association":"CONTRIBUTOR","body":"reopen rerun CI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001560391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001701634","html_url":"https://github.com/apache/iceberg/pull/3811#issuecomment-1001701634","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3811","id":1001701634,"node_id":"IC_kwDOCW7NX847tMEC","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T19:00:02Z","updated_at":"2021-12-27T19:00:02Z","author_association":"CONTRIBUTOR","body":"But you can already set that through `iceberg.worker.num-threads` right? I think it's conservative by default in purpose because setting the value to be higher than `Runtime.getRuntime().availableProcessors()` might benefit some systems, but might also cause issues in other systems.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001701634/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001707607","html_url":"https://github.com/apache/iceberg/pull/3811#issuecomment-1001707607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3811","id":1001707607,"node_id":"IC_kwDOCW7NX847tNhX","user":{"login":"bryanck","id":5475421,"node_id":"MDQ6VXNlcjU0NzU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5475421?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanck","html_url":"https://github.com/bryanck","followers_url":"https://api.github.com/users/bryanck/followers","following_url":"https://api.github.com/users/bryanck/following{/other_user}","gists_url":"https://api.github.com/users/bryanck/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanck/subscriptions","organizations_url":"https://api.github.com/users/bryanck/orgs","repos_url":"https://api.github.com/users/bryanck/repos","events_url":"https://api.github.com/users/bryanck/events{/privacy}","received_events_url":"https://api.github.com/users/bryanck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T19:14:06Z","updated_at":"2021-12-27T19:14:06Z","author_association":"CONTRIBUTOR","body":"Yes, you can set it, this PR is meant to set what I feel is a more sensible default for the common case where Spark driver cores is left at 1 core and the system property isn't set, for those who maybe aren't as familiar with Iceberg tuning parameters.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001707607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001713401","html_url":"https://github.com/apache/iceberg/pull/3808#issuecomment-1001713401","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3808","id":1001713401,"node_id":"IC_kwDOCW7NX847tO75","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T19:32:21Z","updated_at":"2021-12-27T19:32:21Z","author_association":"CONTRIBUTOR","body":"how would this be used by upstream? Could you describe in more details?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001713401/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001715201","html_url":"https://github.com/apache/iceberg/pull/3807#issuecomment-1001715201","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3807","id":1001715201,"node_id":"IC_kwDOCW7NX847tPYB","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T19:38:43Z","updated_at":"2021-12-27T19:38:43Z","author_association":"CONTRIBUTOR","body":"Nice catch! Thanks for the fix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001715201/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001716648","html_url":"https://github.com/apache/iceberg/pull/3811#issuecomment-1001716648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3811","id":1001716648,"node_id":"IC_kwDOCW7NX847tPuo","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T19:44:00Z","updated_at":"2021-12-27T19:44:00Z","author_association":"CONTRIBUTOR","body":"> Yes, you can set it, this PR is meant to set what I feel is a more sensible default for the common case where Spark driver cores is left at 1 core and the system property isn't set\r\n\r\nYes totally agree this looks beneficial, I am just not optimistic if it is a better default for everyone while introducing a change of behavior. I will leave it to other people to comment.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001716648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001741535","html_url":"https://github.com/apache/iceberg/pull/3752#issuecomment-1001741535","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3752","id":1001741535,"node_id":"IC_kwDOCW7NX847tVzf","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T20:29:09Z","updated_at":"2021-12-27T20:29:09Z","author_association":"CONTRIBUTOR","body":"We have 2 approvals. I will wait for one more day in case Ryan is back online and can take another look. Otherwise I think it's good to be merged, thanks for the work!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001741535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001789340","html_url":"https://github.com/apache/iceberg/pull/3812#issuecomment-1001789340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3812","id":1001789340,"node_id":"IC_kwDOCW7NX847thec","user":{"login":"bryanck","id":5475421,"node_id":"MDQ6VXNlcjU0NzU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5475421?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanck","html_url":"https://github.com/bryanck","followers_url":"https://api.github.com/users/bryanck/followers","following_url":"https://api.github.com/users/bryanck/following{/other_user}","gists_url":"https://api.github.com/users/bryanck/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanck/subscriptions","organizations_url":"https://api.github.com/users/bryanck/orgs","repos_url":"https://api.github.com/users/bryanck/repos","events_url":"https://api.github.com/users/bryanck/events{/privacy}","received_events_url":"https://api.github.com/users/bryanck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T22:54:53Z","updated_at":"2021-12-27T22:54:53Z","author_association":"CONTRIBUTOR","body":"To give a little bit more detail, the SnapshotsTableScan and HistoryTableScan inherit from StaticTableScan to bypass the null snapshot check. However, during planning, `newRefinedSearch()` is called, which creates a StaticTableScan that does not override the null check. So this PR inherits `newRefinedSearch()` in the subclasses so they will instantiate the subclass (and bypass the null check).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001789340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001801130","html_url":"https://github.com/apache/iceberg/pull/3811#issuecomment-1001801130","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3811","id":1001801130,"node_id":"IC_kwDOCW7NX847tkWq","user":{"login":"bryanck","id":5475421,"node_id":"MDQ6VXNlcjU0NzU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5475421?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanck","html_url":"https://github.com/bryanck","followers_url":"https://api.github.com/users/bryanck/followers","following_url":"https://api.github.com/users/bryanck/following{/other_user}","gists_url":"https://api.github.com/users/bryanck/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanck/subscriptions","organizations_url":"https://api.github.com/users/bryanck/orgs","repos_url":"https://api.github.com/users/bryanck/repos","events_url":"https://api.github.com/users/bryanck/events{/privacy}","received_events_url":"https://api.github.com/users/bryanck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T23:43:52Z","updated_at":"2021-12-27T23:43:52Z","author_association":"CONTRIBUTOR","body":"Sure thanks for taking a look. FWIW I noticed Spark does something similar [here](https://github.com/apache/spark/blob/f4d6a0f27b002c0ca8726cb46530267f04254897/core/src/main/scala/org/apache/spark/rpc/netty/MessageLoop.scala#L114).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001801130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001802696","html_url":"https://github.com/apache/iceberg/pull/3811#issuecomment-1001802696","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3811","id":1001802696,"node_id":"IC_kwDOCW7NX847tkvI","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-27T23:53:06Z","updated_at":"2021-12-27T23:53:06Z","author_association":"CONTRIBUTOR","body":"> ...setting the value to be higher than Runtime.getRuntime().availableProcessors() might benefit some systems, but might also cause issues in other systems.\r\n\r\nHow common is a system where this would cause an issue? If not very common, a default that provides a noticeable performance boost may be worth it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001802696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001824498","html_url":"https://github.com/apache/iceberg/pull/3808#issuecomment-1001824498","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3808","id":1001824498,"node_id":"IC_kwDOCW7NX847tqDy","user":{"login":"zhengxingmao","id":40750002,"node_id":"MDQ6VXNlcjQwNzUwMDAy","avatar_url":"https://avatars.githubusercontent.com/u/40750002?v=4","gravatar_id":"","url":"https://api.github.com/users/zhengxingmao","html_url":"https://github.com/zhengxingmao","followers_url":"https://api.github.com/users/zhengxingmao/followers","following_url":"https://api.github.com/users/zhengxingmao/following{/other_user}","gists_url":"https://api.github.com/users/zhengxingmao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhengxingmao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhengxingmao/subscriptions","organizations_url":"https://api.github.com/users/zhengxingmao/orgs","repos_url":"https://api.github.com/users/zhengxingmao/repos","events_url":"https://api.github.com/users/zhengxingmao/events{/privacy}","received_events_url":"https://api.github.com/users/zhengxingmao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T01:37:00Z","updated_at":"2021-12-28T02:16:48Z","author_association":"NONE","body":"> how would this be used by upstream? Could you describe in more details?\r\n\r\nTake the iceberg connector of Presto / Trino as an example, if Orc is not added ORC_ BLOOM_ FILTER_Columns and orc_ BLOOM_ FILTER_ FPP table attribute, Presto / Trino cannot specify bloom filter column when creating iceberg table.\r\nHere is create table example by Trino:\r\n CREATE TABLE iceberg.bloomfilter.b (      \r\n    a integer,                             \r\n    b varchar,                             \r\n    c varchar                              \r\n )                                         \r\n WITH (                                    \r\n    format = 'ORC',                        \r\n    orc_bloom_filter_columns = ARRAY['a'], \r\n    orc_bloom_filter_fpp = 5E-3            \r\n )\r\nThe Trino related code will be submitted to the Trino community.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001824498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001831880","html_url":"https://github.com/apache/iceberg/pull/3774#issuecomment-1001831880","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3774","id":1001831880,"node_id":"IC_kwDOCW7NX847tr3I","user":{"login":"SinghAsDev","id":4915557,"node_id":"MDQ6VXNlcjQ5MTU1NTc=","avatar_url":"https://avatars.githubusercontent.com/u/4915557?v=4","gravatar_id":"","url":"https://api.github.com/users/SinghAsDev","html_url":"https://github.com/SinghAsDev","followers_url":"https://api.github.com/users/SinghAsDev/followers","following_url":"https://api.github.com/users/SinghAsDev/following{/other_user}","gists_url":"https://api.github.com/users/SinghAsDev/gists{/gist_id}","starred_url":"https://api.github.com/users/SinghAsDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SinghAsDev/subscriptions","organizations_url":"https://api.github.com/users/SinghAsDev/orgs","repos_url":"https://api.github.com/users/SinghAsDev/repos","events_url":"https://api.github.com/users/SinghAsDev/events{/privacy}","received_events_url":"https://api.github.com/users/SinghAsDev/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T02:09:01Z","updated_at":"2021-12-28T02:09:01Z","author_association":"CONTRIBUTOR","body":"> 3773 is merged, could you rebase?\r\n\r\n@jackye1995 done","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001831880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001855663","html_url":"https://github.com/apache/iceberg/pull/3790#issuecomment-1001855663","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3790","id":1001855663,"node_id":"IC_kwDOCW7NX847txqv","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T03:57:22Z","updated_at":"2021-12-28T03:57:22Z","author_association":"CONTRIBUTOR","body":"Hey @pvary , please have another look when you have time. Basically I just identify some suspicious static fields and clear/close them.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001855663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001904464","html_url":"https://github.com/apache/iceberg/pull/3641#issuecomment-1001904464","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3641","id":1001904464,"node_id":"IC_kwDOCW7NX847t9lQ","user":{"login":"Yanam","id":1295108,"node_id":"MDQ6VXNlcjEyOTUxMDg=","avatar_url":"https://avatars.githubusercontent.com/u/1295108?v=4","gravatar_id":"","url":"https://api.github.com/users/Yanam","html_url":"https://github.com/Yanam","followers_url":"https://api.github.com/users/Yanam/followers","following_url":"https://api.github.com/users/Yanam/following{/other_user}","gists_url":"https://api.github.com/users/Yanam/gists{/gist_id}","starred_url":"https://api.github.com/users/Yanam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Yanam/subscriptions","organizations_url":"https://api.github.com/users/Yanam/orgs","repos_url":"https://api.github.com/users/Yanam/repos","events_url":"https://api.github.com/users/Yanam/events{/privacy}","received_events_url":"https://api.github.com/users/Yanam/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T07:10:12Z","updated_at":"2021-12-28T07:10:12Z","author_association":"NONE","body":"> Can you elaborate more on your use case?\r\n> \r\n> This would be a large refactor, and we tend to prefer making the FileIO composable (see `ResolvingFileIO`).\r\n> \r\n> It would help if you could elaborate why such a large proposed change would be beneficial. Possibly there's an existing way to handle what you need - or one that would require significantly less change within Iceberg.\r\n\r\nMy way of dealing with it is not very good. This one you provided will solve my problem. Thank you","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001904464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001917591","html_url":"https://github.com/apache/iceberg/pull/3801#issuecomment-1001917591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3801","id":1001917591,"node_id":"IC_kwDOCW7NX847uAyX","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T07:39:52Z","updated_at":"2021-12-28T07:41:19Z","author_association":"CONTRIBUTOR","body":"> Had a few questions, but in general this looks good to me. I'll need some time after break to really dig into the Caffine library but invalidating cache in the removal listener seems to make more sense to me\r\n\r\nAgreed on digging into Caffeine. I've begun doing that as well and plan to upgrade our version after this PR. It is ubiquitous in the rest of our stack too so it's worth knowing well.\r\n\r\nBut given that the snapshot currently can deadlock under common usage patterns, I'd prefer to ship this and then revisit it if need be. If the deadlock doesn't happen anymore with the snapshot, that will be great.\r\n\r\nThen we'll just need to revisit with more knowledge the choice of executor service (possibly making it optionally not synchronous or something). But the deadlock seems important to fix as soon as possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001917591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001974725","html_url":"https://github.com/apache/iceberg/issues/2490#issuecomment-1001974725","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2490","id":1001974725,"node_id":"IC_kwDOCW7NX847uOvF","user":{"login":"shay1bz","id":35406867,"node_id":"MDQ6VXNlcjM1NDA2ODY3","avatar_url":"https://avatars.githubusercontent.com/u/35406867?v=4","gravatar_id":"","url":"https://api.github.com/users/shay1bz","html_url":"https://github.com/shay1bz","followers_url":"https://api.github.com/users/shay1bz/followers","following_url":"https://api.github.com/users/shay1bz/following{/other_user}","gists_url":"https://api.github.com/users/shay1bz/gists{/gist_id}","starred_url":"https://api.github.com/users/shay1bz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shay1bz/subscriptions","organizations_url":"https://api.github.com/users/shay1bz/orgs","repos_url":"https://api.github.com/users/shay1bz/repos","events_url":"https://api.github.com/users/shay1bz/events{/privacy}","received_events_url":"https://api.github.com/users/shay1bz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T09:54:58Z","updated_at":"2021-12-28T09:54:58Z","author_association":"NONE","body":"Any update on this? \r\nWould a PR for Spark rewrite action be any good or are you looking for a more holistic solution?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1001974725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002139816","html_url":"https://github.com/apache/iceberg/issues/2490#issuecomment-1002139816","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2490","id":1002139816,"node_id":"IC_kwDOCW7NX847u3Co","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-12-28T14:47:25Z","updated_at":"2021-12-28T14:49:49Z","author_association":"MEMBER","body":"> Any update on this? Would a PR for Spark rewrite action be any good or are you looking for a more holistic solution?\r\n\r\nThe Spark rewrite action already uses SortOrder. The SparkWrite code needed the distribution and ordering changes in Spark 3.2, I think the current snapshot already has this implemented. So it should be done\r\n\r\nhttps://github.com/apache/iceberg/blob/master/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/source/SparkWrite.java#L132-L140\r\n\r\nhttps://github.com/apache/iceberg/blob/master/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/source/SparkWriteBuilder.java#L140-L156","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1002139816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]