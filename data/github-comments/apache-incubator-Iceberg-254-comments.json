[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551773059","html_url":"https://github.com/apache/iceberg/pull/7626#issuecomment-1551773059","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7626","id":1551773059,"node_id":"IC_kwDOCW7NX85cfi2D","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T17:07:58Z","updated_at":"2023-05-17T17:07:58Z","author_association":"CONTRIBUTOR","body":"Thanks @huaxingao for the quick fix! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551773059/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551780147","html_url":"https://github.com/apache/iceberg/pull/7607#issuecomment-1551780147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7607","id":1551780147,"node_id":"IC_kwDOCW7NX85cfkkz","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T17:13:35Z","updated_at":"2023-05-17T17:15:33Z","author_association":"MEMBER","body":"First high level comment, I think we really need an underlying Java API as well. I think there should be a first class static class in java that can be used similar to the extension here. Basically I don't want to have the word \"apply\" in that invocation if we can help it. Other than that I think the API looks good at first glance, I assume it is matching the Delta api?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551780147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551813429","html_url":"https://github.com/apache/iceberg/pull/7607#issuecomment-1551813429","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7607","id":1551813429,"node_id":"IC_kwDOCW7NX85cfss1","user":{"login":"giucris","id":9114810,"node_id":"MDQ6VXNlcjkxMTQ4MTA=","avatar_url":"https://avatars.githubusercontent.com/u/9114810?v=4","gravatar_id":"","url":"https://api.github.com/users/giucris","html_url":"https://github.com/giucris","followers_url":"https://api.github.com/users/giucris/followers","following_url":"https://api.github.com/users/giucris/following{/other_user}","gists_url":"https://api.github.com/users/giucris/gists{/gist_id}","starred_url":"https://api.github.com/users/giucris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giucris/subscriptions","organizations_url":"https://api.github.com/users/giucris/orgs","repos_url":"https://api.github.com/users/giucris/repos","events_url":"https://api.github.com/users/giucris/events{/privacy}","received_events_url":"https://api.github.com/users/giucris/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T17:42:08Z","updated_at":"2023-05-17T17:42:08Z","author_association":"NONE","body":"Hi @RussellSpitzer \r\n\r\nThe API is inspired by the delta ones to avoid confusion in those switching from one table format to another. \r\n\r\nI think a Java Class with a static method that under calls the same builder might be enough to solve the \"apply\" problem and make everything look more \"java\" oriented. \r\n\r\nI will try to add it\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551813429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551861178","html_url":"https://github.com/apache/iceberg/pull/7576#issuecomment-1551861178","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7576","id":1551861178,"node_id":"IC_kwDOCW7NX85cf4W6","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T18:20:59Z","updated_at":"2023-05-17T18:21:25Z","author_association":"CONTRIBUTOR","body":"Thanks @ajantha-bhat , this looks related to https://github.com/apache/iceberg/issues/4159\r\n\r\nSo my take is that tables own their metadata files and that `gc.enabled` should not actually be part of the determination to delete the files or not. But my definition is based on `gc.enabled` really being tied to being used as a mechanism to prevent dangerous actions such as cleaning up files which are not a part of the table. \r\n\r\nRight now `CatalogUtil` will only cleanup data files iff gc is enabled.  Metadata files are cleaned up regardless.`ExpireSnapshots` can only be run if gc is enabled and it it doesn't even delete metadata files. \r\n\r\nYou mentioned \r\n\r\n```\r\nThis behaviour should be unified with the other Iceberg metadata file deletion (that is honouring the gc.enabled property)\r\n```\r\n\r\nCurious where are you seeing this?\r\n\r\nInterested in knowing what others think though!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551861178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551892992","html_url":"https://github.com/apache/iceberg/issues/7540#issuecomment-1551892992","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7540","id":1551892992,"node_id":"IC_kwDOCW7NX85cgAIA","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T18:48:08Z","updated_at":"2023-05-17T18:48:08Z","author_association":"CONTRIBUTOR","body":"yes / no, there are some cases where it can dropped, Here is a proposal for removing dangling delete files https://docs.google.com/document/d/11d-cIUR_89kRsMmWnEoxXGZCvp7L4TUmPJqUC60zB5M/edit. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1551892992/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552162099","html_url":"https://github.com/apache/iceberg/pull/7585#issuecomment-1552162099","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7585","id":1552162099,"node_id":"IC_kwDOCW7NX85chB0z","user":{"login":"dpaani","id":5696806,"node_id":"MDQ6VXNlcjU2OTY4MDY=","avatar_url":"https://avatars.githubusercontent.com/u/5696806?v=4","gravatar_id":"","url":"https://api.github.com/users/dpaani","html_url":"https://github.com/dpaani","followers_url":"https://api.github.com/users/dpaani/followers","following_url":"https://api.github.com/users/dpaani/following{/other_user}","gists_url":"https://api.github.com/users/dpaani/gists{/gist_id}","starred_url":"https://api.github.com/users/dpaani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dpaani/subscriptions","organizations_url":"https://api.github.com/users/dpaani/orgs","repos_url":"https://api.github.com/users/dpaani/repos","events_url":"https://api.github.com/users/dpaani/events{/privacy}","received_events_url":"https://api.github.com/users/dpaani/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-17T22:21:31Z","updated_at":"2023-05-17T22:21:31Z","author_association":"CONTRIBUTOR","body":"hi @RussellSpitzer Could you please re-check this PR. I have addressed your earlier review comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552162099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552237892","html_url":"https://github.com/apache/iceberg/issues/6215#issuecomment-1552237892","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6215","id":1552237892,"node_id":"IC_kwDOCW7NX85chUVE","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T00:11:15Z","updated_at":"2023-05-18T00:11:15Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552237892/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552237935","html_url":"https://github.com/apache/iceberg/issues/6125#issuecomment-1552237935","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6125","id":1552237935,"node_id":"IC_kwDOCW7NX85chUVv","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T00:11:19Z","updated_at":"2023-05-18T00:11:19Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552237935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552255265","html_url":"https://github.com/apache/iceberg/pull/7636#issuecomment-1552255265","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7636","id":1552255265,"node_id":"IC_kwDOCW7NX85chYkh","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T00:41:39Z","updated_at":"2023-05-18T00:41:39Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi @RussellSpitzer \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552255265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552255731","html_url":"https://github.com/apache/iceberg/pull/7636#issuecomment-1552255731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7636","id":1552255731,"node_id":"IC_kwDOCW7NX85chYrz","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T00:42:31Z","updated_at":"2023-05-18T00:42:31Z","author_association":"CONTRIBUTOR","body":"also cc @amogh-jahagirdar @singhpk234 @nastra @ChristinaTech ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552255731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552293691","html_url":"https://github.com/apache/iceberg/issues/7311#issuecomment-1552293691","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7311","id":1552293691,"node_id":"IC_kwDOCW7NX85chh87","user":{"login":"luoyuxia","id":20389154,"node_id":"MDQ6VXNlcjIwMzg5MTU0","avatar_url":"https://avatars.githubusercontent.com/u/20389154?v=4","gravatar_id":"","url":"https://api.github.com/users/luoyuxia","html_url":"https://github.com/luoyuxia","followers_url":"https://api.github.com/users/luoyuxia/followers","following_url":"https://api.github.com/users/luoyuxia/following{/other_user}","gists_url":"https://api.github.com/users/luoyuxia/gists{/gist_id}","starred_url":"https://api.github.com/users/luoyuxia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luoyuxia/subscriptions","organizations_url":"https://api.github.com/users/luoyuxia/orgs","repos_url":"https://api.github.com/users/luoyuxia/repos","events_url":"https://api.github.com/users/luoyuxia/events{/privacy}","received_events_url":"https://api.github.com/users/luoyuxia/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T01:45:39Z","updated_at":"2023-05-18T01:47:14Z","author_association":"NONE","body":"Hi, just for reference, Pamion has integrated [UPDATE](https://github.com/apache/incubator-paimon/pull/1010) & [DELETE](https://github.com/apache/incubator-paimon/issues/786) for flink-1.17.\r\nAlso in previous investagtion,  IIUC, to implement DELETE & UPDATE for iceberg, we may need to finish #7110  first since Iceberg will use the metadata columns, file_path, file_pos to delete data.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552293691/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552469489","html_url":"https://github.com/apache/iceberg/pull/7576#issuecomment-1552469489","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7576","id":1552469489,"node_id":"IC_kwDOCW7NX85ciM3x","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T06:00:32Z","updated_at":"2023-05-18T06:00:32Z","author_association":"MEMBER","body":"> But my definition is based on gc.enabled really being tied to being used as a mechanism to prevent dangerous actions such as cleaning up files which are not a part of the table.\r\n\r\nFirst of all there is no clarity on this table property in the docs. \r\nIf we consider expire snapshots action, expired metadata clean up is also controlled by gc_enabled property. So, I think table metadata clean up also should obey this property. \r\n\r\nDeleting the table metadata files can also be a dangerous activity for some catalog like Nessie (as it can be referenced by other branches). So, I expect if the gc is disabled, no metadata or data file should get cleaned. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552469489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552484576","html_url":"https://github.com/apache/iceberg/pull/7576#issuecomment-1552484576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7576","id":1552484576,"node_id":"IC_kwDOCW7NX85ciQjg","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T06:08:24Z","updated_at":"2023-05-18T06:08:46Z","author_association":"MEMBER","body":"Well I thought gc enabled was explicitly because we didn't want snapshots tables to be able to delete data files of their host table. I never considered sharing metadata files. I guess we could do that but I think that may just be asking for trouble, unlike data files I think most metadata files are relatively short lived anyway by default what with optimize metadata and merge manifests:","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552484576/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552514449","html_url":"https://github.com/apache/iceberg/pull/7412#issuecomment-1552514449","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7412","id":1552514449,"node_id":"IC_kwDOCW7NX85ciX2R","user":{"login":"coufon","id":11655397,"node_id":"MDQ6VXNlcjExNjU1Mzk3","avatar_url":"https://avatars.githubusercontent.com/u/11655397?v=4","gravatar_id":"","url":"https://api.github.com/users/coufon","html_url":"https://github.com/coufon","followers_url":"https://api.github.com/users/coufon/followers","following_url":"https://api.github.com/users/coufon/following{/other_user}","gists_url":"https://api.github.com/users/coufon/gists{/gist_id}","starred_url":"https://api.github.com/users/coufon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coufon/subscriptions","organizations_url":"https://api.github.com/users/coufon/orgs","repos_url":"https://api.github.com/users/coufon/repos","events_url":"https://api.github.com/users/coufon/events{/privacy}","received_events_url":"https://api.github.com/users/coufon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T06:25:24Z","updated_at":"2023-05-18T06:25:24Z","author_association":"NONE","body":"> Just wanted to say that I am really happy to see this! We are looking at using BigLake Metastore and having direct integration in Spark would be a big plus.\r\n> \r\n> One question: what is needed to allow PyIceberg to interface with BigLake Metastore iceberg catalog? I.e., does PyIceberg need a special catalog implementation too? It seems like perhaps it would for writing to the catalog, but if I understand correctly it might be able to read the catalog as if it were a Hive Metastore?\r\n\r\nThanks Matt for your interest. PyIceberg needs an integration here (https://github.com/apache/iceberg/tree/master/python/pyiceberg/catalog) using BigLake Python client (https://cloud.google.com/python/docs/reference/biglake/latest). It has a low priority now. Please send a feature request to biglake-help@google.com to bump its priority up on our end.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552514449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552792541","html_url":"https://github.com/apache/iceberg/issues/6255#issuecomment-1552792541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6255","id":1552792541,"node_id":"IC_kwDOCW7NX85cjbvd","user":{"login":"languageoflove","id":25071830,"node_id":"MDQ6VXNlcjI1MDcxODMw","avatar_url":"https://avatars.githubusercontent.com/u/25071830?v=4","gravatar_id":"","url":"https://api.github.com/users/languageoflove","html_url":"https://github.com/languageoflove","followers_url":"https://api.github.com/users/languageoflove/followers","following_url":"https://api.github.com/users/languageoflove/following{/other_user}","gists_url":"https://api.github.com/users/languageoflove/gists{/gist_id}","starred_url":"https://api.github.com/users/languageoflove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/languageoflove/subscriptions","organizations_url":"https://api.github.com/users/languageoflove/orgs","repos_url":"https://api.github.com/users/languageoflove/repos","events_url":"https://api.github.com/users/languageoflove/events{/privacy}","received_events_url":"https://api.github.com/users/languageoflove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T09:33:40Z","updated_at":"2023-05-18T09:33:40Z","author_association":"NONE","body":"Hello, I also encountered the same problem, how did you finally solve?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552792541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552794427","html_url":"https://github.com/apache/iceberg/pull/7641#issuecomment-1552794427","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7641","id":1552794427,"node_id":"IC_kwDOCW7NX85cjcM7","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T09:35:31Z","updated_at":"2023-05-18T09:35:31Z","author_association":"MEMBER","body":"cc: @nastra, @snazy, @dimas-b \r\n\r\nSince https://github.com/apache/iceberg/pull/7576 may take more time to conclude (or may not get merged). I have opened a catalog-specific PR targeted for the 1.3.0 release to avoid facing this problem for the users.   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552794427/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552795086","html_url":"https://github.com/apache/iceberg/pull/7576#issuecomment-1552795086","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7576","id":1552795086,"node_id":"IC_kwDOCW7NX85cjcXO","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T09:36:04Z","updated_at":"2023-05-18T09:36:04Z","author_association":"MEMBER","body":"Hmm, I think this may take a while to conclude. I have raised a nessie catalog-specific PR to always disable `write.metadata.delete-after-commit.enabled` for 1.3.0 release. \r\n\r\nhttps://github.com/apache/iceberg/pull/7641","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1552795086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553026533","html_url":"https://github.com/apache/iceberg/issues/7311#issuecomment-1553026533","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7311","id":1553026533,"node_id":"IC_kwDOCW7NX85ckU3l","user":{"login":"xiaochen-zhou","id":27844885,"node_id":"MDQ6VXNlcjI3ODQ0ODg1","avatar_url":"https://avatars.githubusercontent.com/u/27844885?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaochen-zhou","html_url":"https://github.com/xiaochen-zhou","followers_url":"https://api.github.com/users/xiaochen-zhou/followers","following_url":"https://api.github.com/users/xiaochen-zhou/following{/other_user}","gists_url":"https://api.github.com/users/xiaochen-zhou/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaochen-zhou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaochen-zhou/subscriptions","organizations_url":"https://api.github.com/users/xiaochen-zhou/orgs","repos_url":"https://api.github.com/users/xiaochen-zhou/repos","events_url":"https://api.github.com/users/xiaochen-zhou/events{/privacy}","received_events_url":"https://api.github.com/users/xiaochen-zhou/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T13:04:47Z","updated_at":"2023-05-18T13:04:47Z","author_association":"NONE","body":"> Hi, just for reference, Pamion has integrated [UPDATE](https://github.com/apache/incubator-paimon/pull/1010) & [DELETE](https://github.com/apache/incubator-paimon/issues/786) for flink-1.17. Also in previous investagtion, IIUC, to implement DELETE & UPDATE for iceberg, we may need to finish #7110 first since Iceberg will use the metadata columns, file_path, file_pos to delete data.\r\n\r\ni see, thank you very much for your guidance.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553026533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553073273","html_url":"https://github.com/apache/iceberg/issues/5800#issuecomment-1553073273","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5800","id":1553073273,"node_id":"IC_kwDOCW7NX85ckgR5","user":{"login":"grobgl","id":4349127,"node_id":"MDQ6VXNlcjQzNDkxMjc=","avatar_url":"https://avatars.githubusercontent.com/u/4349127?v=4","gravatar_id":"","url":"https://api.github.com/users/grobgl","html_url":"https://github.com/grobgl","followers_url":"https://api.github.com/users/grobgl/followers","following_url":"https://api.github.com/users/grobgl/following{/other_user}","gists_url":"https://api.github.com/users/grobgl/gists{/gist_id}","starred_url":"https://api.github.com/users/grobgl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grobgl/subscriptions","organizations_url":"https://api.github.com/users/grobgl/orgs","repos_url":"https://api.github.com/users/grobgl/repos","events_url":"https://api.github.com/users/grobgl/events{/privacy}","received_events_url":"https://api.github.com/users/grobgl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T13:39:27Z","updated_at":"2023-05-18T13:39:27Z","author_association":"CONTRIBUTOR","body":"I'm keen to push this forward. @TomAugspurger's implementation works in single-threaded mode but fails in a distributed scenario due to current lack of pickle support (I raised a separate issue #7644).\r\n\r\nExtending Tom's approach, this is a solution which utilises Dask's `from_map` and `DataFramIOFunction` which allows us to pass projected columns to the Parquet reader:\r\n```python\r\nclass IcebergFunctionWrapper(DataFrameIOFunction):\r\n    def __init__(\r\n        self,\r\n        fs: FileSystem,\r\n        bound_row_filter: BooleanExpression,\r\n        projected_schema: Schema,\r\n        case_sensitive: bool,\r\n    ):\r\n        self._fs = fs\r\n        self._bound_row_filter = bound_row_filter\r\n        self._projected_schema = projected_schema\r\n        self._case_sensitive = case_sensitive\r\n        self._projected_field_ids = {\r\n            id for id in projected_schema.field_ids\r\n            if not isinstance(projected_schema.find_type(id), (MapType, ListType))\r\n        }.union(extract_field_ids(bound_row_filter))\r\n        super().__init__()\r\n    \r\n    @property\r\n    def columns(self) -> List[str]:\r\n        self._projected_schema.column_names\r\n\r\n    @property\r\n    def empty_table(self) -> pd.DataFrame:\r\n        return schema_to_pyarrow(self._projected_schema).empty_table().to_pandas(date_as_object=False)\r\n\r\n    def project_columns(self, columns: Sequence[str]) -> 'IcebergFunctionWrapper':\r\n        if list(columns) == self.columns:\r\n            return self\r\n\r\n        return IcebergFunctionWrapper(\r\n            self._fs,\r\n            self._bound_row_filter,\r\n            self._projected_schema.select(*columns),\r\n            self._case_sensitive,\r\n        )\r\n\r\n    def __call__(self, task: FileScanTask) -> pd.DataFrame:\r\n        table = _file_to_table(\r\n            self._fs,\r\n            task,\r\n            self._bound_row_filter,\r\n            self._projected_schema,\r\n            self._projected_field_ids,\r\n            self._case_sensitive,\r\n            0,  # no limit support yet\r\n        )\r\n\r\n        if table is None:\r\n            return self.empty_table\r\n\r\n        return table.to_pandas(date_as_object=False)\r\n\r\n\r\ndef to_dask_dataframe(scan: DataScan) -> dd.DataFrame:\r\n    tasks = scan.plan_files()\r\n    table = scan.table\r\n    row_filter = scan.row_filter\r\n    projected_schema = scan.projection()\r\n    case_sensitive = scan.case_sensitive\r\n\r\n    scheme, _ = PyArrowFileIO.parse_location(table.location())\r\n    if isinstance(table.io, PyArrowFileIO):\r\n        fs = table.io.get_fs(scheme)\r\n    else:\r\n        try:\r\n            from pyiceberg.io.fsspec import FsspecFileIO\r\n\r\n            if isinstance(table.io, FsspecFileIO):\r\n                fs = PyFileSystem(FSSpecHandler(table.io.get_fs(scheme)))\r\n            else:\r\n                raise ValueError(f\"Expected PyArrowFileIO or FsspecFileIO, got: {table.io}\")\r\n        except ModuleNotFoundError as e:\r\n            # When FsSpec is not installed\r\n            raise ValueError(f\"Expected PyArrowFileIO or FsspecFileIO, got: {table.io}\") from e\r\n\r\n    bound_row_filter = bind(table.schema(), row_filter, case_sensitive=case_sensitive)\r\n\r\n    io_func = IcebergFunctionWrapper(fs, bound_row_filter, projected_schema, case_sensitive)\r\n\r\n    return dd.from_map(\r\n        io_func,\r\n        tasks,\r\n        meta=io_func.empty_table,\r\n        enforce_metadata=False,\r\n    )\r\n```\r\nI'm also looking into adding `divisions` support and row-group-level parallelisation to this.\r\n\r\nGenerally, should this be part of the Dask library instead of PyIceberg?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553073273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553079697","html_url":"https://github.com/apache/iceberg/pull/7632#issuecomment-1553079697","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7632","id":1553079697,"node_id":"IC_kwDOCW7NX85ckh2R","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T13:44:33Z","updated_at":"2023-05-18T13:44:33Z","author_association":"CONTRIBUTOR","body":"thanks @pvary for the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553079697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553151862","html_url":"https://github.com/apache/iceberg/issues/5556#issuecomment-1553151862","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5556","id":1553151862,"node_id":"IC_kwDOCW7NX85ckzd2","user":{"login":"jhchee","id":33974196,"node_id":"MDQ6VXNlcjMzOTc0MTk2","avatar_url":"https://avatars.githubusercontent.com/u/33974196?v=4","gravatar_id":"","url":"https://api.github.com/users/jhchee","html_url":"https://github.com/jhchee","followers_url":"https://api.github.com/users/jhchee/followers","following_url":"https://api.github.com/users/jhchee/following{/other_user}","gists_url":"https://api.github.com/users/jhchee/gists{/gist_id}","starred_url":"https://api.github.com/users/jhchee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jhchee/subscriptions","organizations_url":"https://api.github.com/users/jhchee/orgs","repos_url":"https://api.github.com/users/jhchee/repos","events_url":"https://api.github.com/users/jhchee/events{/privacy}","received_events_url":"https://api.github.com/users/jhchee/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T14:29:20Z","updated_at":"2023-05-18T14:29:20Z","author_association":"NONE","body":"Not stale","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553151862/reactions","total_count":4,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":4,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553209962","html_url":"https://github.com/apache/iceberg/pull/7631#issuecomment-1553209962","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7631","id":1553209962,"node_id":"IC_kwDOCW7NX85clBpq","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T15:10:12Z","updated_at":"2023-05-18T15:10:12Z","author_association":"CONTRIBUTOR","body":"thanks @pvary for the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553209962/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553223425","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1553223425","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1553223425,"node_id":"IC_kwDOCW7NX85clE8B","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T15:20:40Z","updated_at":"2023-05-19T01:29:41Z","author_association":"CONTRIBUTOR","body":"@hililiwei I thought PR #6253 is less intrusive than this PR and can achieve similar goals. The approach in this PR introduced a lot of complexities. we had some discussion before in PR #6253. we should probably start some high-level discussions on the direction. Can you listed the pros and cons of these two approaches? maybe create a design doc to describe the problems that we are trying to solve, different approaches, and the pros and cons of the approaches.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553223425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553298609","html_url":"https://github.com/apache/iceberg/pull/7553#issuecomment-1553298609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7553","id":1553298609,"node_id":"IC_kwDOCW7NX85clXSx","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T16:19:38Z","updated_at":"2023-05-18T16:19:38Z","author_association":"CONTRIBUTOR","body":"Did some tests today and it looks good.\r\n\r\n![image](https://github.com/apache/iceberg/assets/1134248/df2513c7-022d-4378-b9f2-94cfcc136366)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553298609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553340015","html_url":"https://github.com/apache/iceberg/issues/7644#issuecomment-1553340015","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7644","id":1553340015,"node_id":"IC_kwDOCW7NX85clhZv","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T16:53:44Z","updated_at":"2023-05-18T16:53:44Z","author_association":"CONTRIBUTOR","body":"I still have to look into your comment in #5800, but I don't want to distribute the planning process. A `DataScan` produces a set of tasks using the `.plan_files()` method. You probably want to fan out those tasks across the workers. The tasks are heavy lifting, see the `project_table` method in `pyarrow.py`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553340015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553350475","html_url":"https://github.com/apache/iceberg/pull/7647#issuecomment-1553350475","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7647","id":1553350475,"node_id":"IC_kwDOCW7NX85clj9L","user":{"login":"rakesh-das08","id":16017562,"node_id":"MDQ6VXNlcjE2MDE3NTYy","avatar_url":"https://avatars.githubusercontent.com/u/16017562?v=4","gravatar_id":"","url":"https://api.github.com/users/rakesh-das08","html_url":"https://github.com/rakesh-das08","followers_url":"https://api.github.com/users/rakesh-das08/followers","following_url":"https://api.github.com/users/rakesh-das08/following{/other_user}","gists_url":"https://api.github.com/users/rakesh-das08/gists{/gist_id}","starred_url":"https://api.github.com/users/rakesh-das08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rakesh-das08/subscriptions","organizations_url":"https://api.github.com/users/rakesh-das08/orgs","repos_url":"https://api.github.com/users/rakesh-das08/repos","events_url":"https://api.github.com/users/rakesh-das08/events{/privacy}","received_events_url":"https://api.github.com/users/rakesh-das08/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T17:02:25Z","updated_at":"2023-05-18T17:02:25Z","author_association":"CONTRIBUTOR","body":"@nastra please check","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553350475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553404140","html_url":"https://github.com/apache/iceberg/pull/7171#issuecomment-1553404140","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7171","id":1553404140,"node_id":"IC_kwDOCW7NX85clxDs","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T17:45:14Z","updated_at":"2023-05-18T17:45:14Z","author_association":"CONTRIBUTOR","body":"thanks @ConeyLiu for the fix and @Reo-LEI and @hililiwei for the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553404140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553478936","html_url":"https://github.com/apache/iceberg/issues/5800#issuecomment-1553478936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5800","id":1553478936,"node_id":"IC_kwDOCW7NX85cmDUY","user":{"login":"TomAugspurger","id":1312546,"node_id":"MDQ6VXNlcjEzMTI1NDY=","avatar_url":"https://avatars.githubusercontent.com/u/1312546?v=4","gravatar_id":"","url":"https://api.github.com/users/TomAugspurger","html_url":"https://github.com/TomAugspurger","followers_url":"https://api.github.com/users/TomAugspurger/followers","following_url":"https://api.github.com/users/TomAugspurger/following{/other_user}","gists_url":"https://api.github.com/users/TomAugspurger/gists{/gist_id}","starred_url":"https://api.github.com/users/TomAugspurger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TomAugspurger/subscriptions","organizations_url":"https://api.github.com/users/TomAugspurger/orgs","repos_url":"https://api.github.com/users/TomAugspurger/repos","events_url":"https://api.github.com/users/TomAugspurger/events{/privacy}","received_events_url":"https://api.github.com/users/TomAugspurger/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T18:41:59Z","updated_at":"2023-05-18T18:41:59Z","author_association":"NONE","body":"> Generally, should this be part of the Dask library instead of PyIceberg?\r\n\r\nI was wondering that too. I think either would be sensible, but I'd lean slightly towards putting the implementation in Dask (and pyiceberg could add a `.to_dask_dataframe` to mirror `to_pandas` if desired).\r\n\r\nThat said, the current implementation does use a private `_file_to_table`. I think pyiceberg would need to add a public method that achieves that before Dask could use it. And given the similarity to `pyiceberg.io.pyarrow`, maybe we could start with some refactoring to add some methods used by both the `pyarrow` and `dask.dataframe` implementations?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553478936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553583473","html_url":"https://github.com/apache/iceberg/pull/7553#issuecomment-1553583473","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7553","id":1553583473,"node_id":"IC_kwDOCW7NX85cmc1x","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T20:05:54Z","updated_at":"2023-05-18T20:05:54Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi @aokolnychyi @pan3793 This one is ready for review! It will throw an exception if the Spark or read/write properties are used.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553583473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553607247","html_url":"https://github.com/apache/iceberg/pull/7648#issuecomment-1553607247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7648","id":1553607247,"node_id":"IC_kwDOCW7NX85cmipP","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T20:28:53Z","updated_at":"2023-05-18T20:28:53Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, could you check this out?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553607247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553608305","html_url":"https://github.com/apache/iceberg/issues/7574#issuecomment-1553608305","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7574","id":1553608305,"node_id":"IC_kwDOCW7NX85cmi5x","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T20:29:59Z","updated_at":"2023-05-18T20:31:36Z","author_association":"CONTRIBUTOR","body":"thank you @Thijsvandepoll for the clarification. I guess in this case the catalog is really identified by its url behind it instead of by the name. So if you point both `hive_catalog` and `other_catalog` to the same hive URL such as localhost:9083, then they are essentially the same from hive point of view (you already see above on how database and table are stored in HMS's relational database)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553608305/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553645851","html_url":"https://github.com/apache/iceberg/pull/7648#issuecomment-1553645851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7648","id":1553645851,"node_id":"IC_kwDOCW7NX85cmsEb","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T21:06:45Z","updated_at":"2023-05-18T21:06:45Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, I am going to use this on the Spark side to write a delta where I want to produce only one data file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553645851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553672655","html_url":"https://github.com/apache/iceberg/pull/7649#issuecomment-1553672655","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7649","id":1553672655,"node_id":"IC_kwDOCW7NX85cmynP","user":{"login":"CodingCat","id":678008,"node_id":"MDQ6VXNlcjY3ODAwOA==","avatar_url":"https://avatars.githubusercontent.com/u/678008?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingCat","html_url":"https://github.com/CodingCat","followers_url":"https://api.github.com/users/CodingCat/followers","following_url":"https://api.github.com/users/CodingCat/following{/other_user}","gists_url":"https://api.github.com/users/CodingCat/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingCat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingCat/subscriptions","organizations_url":"https://api.github.com/users/CodingCat/orgs","repos_url":"https://api.github.com/users/CodingCat/repos","events_url":"https://api.github.com/users/CodingCat/events{/privacy}","received_events_url":"https://api.github.com/users/CodingCat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T21:32:25Z","updated_at":"2023-05-18T21:32:25Z","author_association":"CONTRIBUTOR","body":"cc: @rdblue @RussellSpitzer @flyrain would you mind giving it a review? thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553672655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553732110","html_url":"https://github.com/apache/iceberg/pull/7648#issuecomment-1553732110","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7648","id":1553732110,"node_id":"IC_kwDOCW7NX85cnBIO","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T22:17:12Z","updated_at":"2023-05-18T22:17:12Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @szehon-ho!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553732110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553751415","html_url":"https://github.com/apache/iceberg/pull/7650#issuecomment-1553751415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7650","id":1553751415,"node_id":"IC_kwDOCW7NX85cnF13","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T22:46:14Z","updated_at":"2023-05-18T22:46:14Z","author_association":"CONTRIBUTOR","body":"cc @szehon-ho, one more small PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553751415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553760112","html_url":"https://github.com/apache/iceberg/issues/7599#issuecomment-1553760112","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7599","id":1553760112,"node_id":"IC_kwDOCW7NX85cnH9w","user":{"login":"cgpoh","id":11516015,"node_id":"MDQ6VXNlcjExNTE2MDE1","avatar_url":"https://avatars.githubusercontent.com/u/11516015?v=4","gravatar_id":"","url":"https://api.github.com/users/cgpoh","html_url":"https://github.com/cgpoh","followers_url":"https://api.github.com/users/cgpoh/followers","following_url":"https://api.github.com/users/cgpoh/following{/other_user}","gists_url":"https://api.github.com/users/cgpoh/gists{/gist_id}","starred_url":"https://api.github.com/users/cgpoh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cgpoh/subscriptions","organizations_url":"https://api.github.com/users/cgpoh/orgs","repos_url":"https://api.github.com/users/cgpoh/repos","events_url":"https://api.github.com/users/cgpoh/events{/privacy}","received_events_url":"https://api.github.com/users/cgpoh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T23:00:29Z","updated_at":"2023-05-18T23:00:29Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer I managed to find the solution and is quite trivial. Delete the whole offending directory and the exception is gone when re-running the delete orphan job. Closing this issue for now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553760112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553780683","html_url":"https://github.com/apache/iceberg/issues/7625#issuecomment-1553780683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7625","id":1553780683,"node_id":"IC_kwDOCW7NX85cnM_L","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-18T23:33:30Z","updated_at":"2023-05-18T23:33:30Z","author_association":"CONTRIBUTOR","body":"> I fixed for rewrite data files via #7630. And in the issue summary, `DeleteFilesSparkAction` is mentioned. Which one did you mean `DeleteOrphanFilesSparkAction` or `DeleteReachableFilesSparkAction`?. I didn't find the same pattern for optimization in those actions.\r\n\r\nI think the issue asked to harmonize both `RewriteDataFilesSparkAction` and `Rewrite(Position)DeleteFilesSparkAction` based on feedback given in #7565. Delete Orphan and ReachableFiles shall not be relevant here","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553780683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553827007","html_url":"https://github.com/apache/iceberg/issues/6116#issuecomment-1553827007","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6116","id":1553827007,"node_id":"IC_kwDOCW7NX85cnYS_","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T00:10:52Z","updated_at":"2023-05-19T00:10:52Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553827007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553827040","html_url":"https://github.com/apache/iceberg/issues/6105#issuecomment-1553827040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6105","id":1553827040,"node_id":"IC_kwDOCW7NX85cnYTg","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T00:10:53Z","updated_at":"2023-05-19T00:10:53Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553827040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553834222","html_url":"https://github.com/apache/iceberg/issues/7625#issuecomment-1553834222","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7625","id":1553834222,"node_id":"IC_kwDOCW7NX85cnaDu","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T00:15:03Z","updated_at":"2023-05-19T00:15:03Z","author_association":"COLLABORATOR","body":"Ugh im sorry guys, i made the issue name wrong, should be RewritePositionDeleteFilesSparkAction.  Looked at that word too much this year :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553834222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553860831","html_url":"https://github.com/apache/iceberg/pull/7593#issuecomment-1553860831","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7593","id":1553860831,"node_id":"IC_kwDOCW7NX85cngjf","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T00:55:13Z","updated_at":"2023-05-19T00:55:13Z","author_association":"CONTRIBUTOR","body":"Actually I just realized that we also need to fix for its counterpart in CreateTag, so I ended up just doing it in #7652 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553860831/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553922039","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1553922039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1553922039,"node_id":"IC_kwDOCW7NX85cnvf3","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T02:37:09Z","updated_at":"2023-05-19T02:42:49Z","author_association":"CONTRIBUTOR","body":"@stevenzwu Thank you for taking the time to review. The purpose of this PR is to implement a partition commit policy based on Iceberg tables, which has the following differences and advantages compared to proposal #6253:\r\n\r\n• Proposal #6253 only writes the watermark of the Flink task to the table’s Summary, rather than actually committing partitions. This makes it impossible for downstream application to directly determine which partitions are visible, and they need to calculate it themselves based on the watermark and the each partition time. Moreover, the value of the watermark may decrease due to flink job restart or data replay, making some partitions that were already visible invisible again without this PR, which is unacceptable in a production environment. This PR commits partitions based on the watermark and the event time of the partition, so that downstream application can directly see which partitions are available without extra calculation and judgment. This can improve the query efficiency and experience of downstream application. In scenarios such as BI and ad hoc, it can also avoid the problem of developers forgetting to filter data based on the watermark, and not every developer knows that they need to use the watermark to filter data, this greatly increases the possibility of them getting illegal data.\r\n\r\n• This PR allows users to customize the partition commit policy, which can perform some high-level custom operations when committing partitions. In some scenarios, downstream applications need to not only process newly committed partitions, but also deal with data from old partitions that arrive late, and perform some custom operations on the table, such as remote API calls, event notifications, data deletion, etc., or even file merging. This is very useful for table management and task flow customization. Users can choose the appropriate commit strategy according to their own business needs and scenarios, achieving more flexible and efficient data processing. Our internal business developers have used this feature to develop some custom commit policies, which have brought us a lot of convenience and advantages.\r\n\r\n• This PR maintains high compatibility with the Flink ecosystem. It uses the `_SUCCESS` file as a marker to indicate partition commit (https://nightlies.apache.org/flink/flink-docs-release-1.17/docs/connectors/table/filesystem/#partition-commit), which makes it easy to migrate stream tables from Filesystem/Hive to Iceberg without changing the original logic and process. This can reduce migration costs and risks, and improve migration efficiency and stability.\r\n\r\nThank you again for your review and feedback.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553922039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553950220","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1553950220","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1553950220,"node_id":"IC_kwDOCW7NX85cn2YM","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T03:34:45Z","updated_at":"2023-05-19T04:41:48Z","author_association":"CONTRIBUTOR","body":"> the value of the watermark may decrease due to flink job restart or data replay\r\n\r\nThis can be fixed by checkpointing the watermark written to snapshot summary or during restore the committer can retrieve the latest committed watermark\r\n\r\n> This makes it impossible for downstream application to directly determine which partitions are visible, and they need to calculate it themselves based on the watermark and the each partition time.\r\n\r\nI agree that a little bit of logic is needed to determine which partitions have complete data based on the published watermark in snapshot summary.\r\n\r\n> This PR maintains high compatibility with the Flink ecosystem. It uses the _SUCCESS file as a marker to indicate partition commit (https://nightlies.apache.org/flink/flink-docs-release-1.17/docs/connectors/table/filesystem/#partition-commit),\r\n\r\nI am not sure this is a fair comparison. Flink filesystem connector is storing files on distributed file system (like S3) directly. there is no table format abstraction. hence success file is the only option.\r\n\r\nCan you also explain what does \"partition commit\" mean exactly?\r\n\r\n> sink.partition-commit.success-file.name\r\n\r\nwhere are those success files stored? How do downstream consumers find them? \r\n\r\nHow does work with entropy enabled?\r\nhttps://iceberg.apache.org/docs/latest/aws/#object-store-file-layout\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553950220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553986022","html_url":"https://github.com/apache/iceberg/pull/5378#issuecomment-1553986022","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5378","id":1553986022,"node_id":"IC_kwDOCW7NX85cn_Hm","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T04:41:03Z","updated_at":"2023-05-19T04:41:03Z","author_association":"CONTRIBUTOR","body":"#6698 and #7441 have merged. We don't need this any more. Close it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553986022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553995909","html_url":"https://github.com/apache/iceberg/pull/7171#issuecomment-1553995909","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7171","id":1553995909,"node_id":"IC_kwDOCW7NX85coBiF","user":{"login":"ConeyLiu","id":12733256,"node_id":"MDQ6VXNlcjEyNzMzMjU2","avatar_url":"https://avatars.githubusercontent.com/u/12733256?v=4","gravatar_id":"","url":"https://api.github.com/users/ConeyLiu","html_url":"https://github.com/ConeyLiu","followers_url":"https://api.github.com/users/ConeyLiu/followers","following_url":"https://api.github.com/users/ConeyLiu/following{/other_user}","gists_url":"https://api.github.com/users/ConeyLiu/gists{/gist_id}","starred_url":"https://api.github.com/users/ConeyLiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ConeyLiu/subscriptions","organizations_url":"https://api.github.com/users/ConeyLiu/orgs","repos_url":"https://api.github.com/users/ConeyLiu/repos","events_url":"https://api.github.com/users/ConeyLiu/events{/privacy}","received_events_url":"https://api.github.com/users/ConeyLiu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T05:00:34Z","updated_at":"2023-05-19T05:00:34Z","author_association":"CONTRIBUTOR","body":"Thanks all. Will submit backport PRs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1553995909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554005738","html_url":"https://github.com/apache/iceberg/issues/7568#issuecomment-1554005738","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7568","id":1554005738,"node_id":"IC_kwDOCW7NX85coD7q","user":{"login":"BsoBird","id":30249475,"node_id":"MDQ6VXNlcjMwMjQ5NDc1","avatar_url":"https://avatars.githubusercontent.com/u/30249475?v=4","gravatar_id":"","url":"https://api.github.com/users/BsoBird","html_url":"https://github.com/BsoBird","followers_url":"https://api.github.com/users/BsoBird/followers","following_url":"https://api.github.com/users/BsoBird/following{/other_user}","gists_url":"https://api.github.com/users/BsoBird/gists{/gist_id}","starred_url":"https://api.github.com/users/BsoBird/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BsoBird/subscriptions","organizations_url":"https://api.github.com/users/BsoBird/orgs","repos_url":"https://api.github.com/users/BsoBird/repos","events_url":"https://api.github.com/users/BsoBird/events{/privacy}","received_events_url":"https://api.github.com/users/BsoBird/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T05:16:41Z","updated_at":"2023-05-19T05:20:42Z","author_association":"NONE","body":"@geonyeongkim \r\n\r\nHi.\r\n1.If your source table does not have a large amount of data, I recommend not using CDC access. Using CDC to access a table with a small amount of data is definitely a bad idea. In this case, I would prefer to use the jdbc connector table for bulk loading. This is because it is the easiest to do and the iceberg table has the best query performance.\r\n2.If your source table has a lot of data, then I recommend that you partition the iceberg table as much as possible and use some way to monitor which partitions have too many small files. The information collected will be sent to a unified service that triggers a rewrite of a partition of the mor table.\r\nBut this scenario means that you are unlikely to be able to do a large batch write to this table, and if you do, your Spark task will fail very quickly. You can only rebuild the table as a streaming write, but this is time consuming.\r\n\r\nIn fact, from the design implementation point of view, there is still a lot of room for optimizing the stream writing of mor tables, e.g. LSM. But currently iceberg does not do the design implementation of these solutions. And there are still some bugs in the MOR table that have not been solved.\r\nIn summary, the iceberg mor table is currently difficult to use.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554005738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554016183","html_url":"https://github.com/apache/iceberg/issues/7574#issuecomment-1554016183","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7574","id":1554016183,"node_id":"IC_kwDOCW7NX85coGe3","user":{"login":"Thijsvandepoll","id":43474152,"node_id":"MDQ6VXNlcjQzNDc0MTUy","avatar_url":"https://avatars.githubusercontent.com/u/43474152?v=4","gravatar_id":"","url":"https://api.github.com/users/Thijsvandepoll","html_url":"https://github.com/Thijsvandepoll","followers_url":"https://api.github.com/users/Thijsvandepoll/followers","following_url":"https://api.github.com/users/Thijsvandepoll/following{/other_user}","gists_url":"https://api.github.com/users/Thijsvandepoll/gists{/gist_id}","starred_url":"https://api.github.com/users/Thijsvandepoll/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Thijsvandepoll/subscriptions","organizations_url":"https://api.github.com/users/Thijsvandepoll/orgs","repos_url":"https://api.github.com/users/Thijsvandepoll/repos","events_url":"https://api.github.com/users/Thijsvandepoll/events{/privacy}","received_events_url":"https://api.github.com/users/Thijsvandepoll/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T05:29:57Z","updated_at":"2023-05-19T05:29:57Z","author_association":"NONE","body":"Yeah it looks like that!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554016183/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554056633","html_url":"https://github.com/apache/iceberg/pull/7654#issuecomment-1554056633","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7654","id":1554056633,"node_id":"IC_kwDOCW7NX85coQW5","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T06:06:51Z","updated_at":"2023-05-19T06:06:51Z","author_association":"MEMBER","body":"cc: @aokolnychyi, @nastra, @Fokko   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554056633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554057424","html_url":"https://github.com/apache/iceberg/pull/7196#issuecomment-1554057424","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7196","id":1554057424,"node_id":"IC_kwDOCW7NX85coQjQ","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T06:07:43Z","updated_at":"2023-05-19T06:07:43Z","author_association":"MEMBER","body":"If no further comments, I think this can be merged. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554057424/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554110654","html_url":"https://github.com/apache/iceberg/pull/7653#issuecomment-1554110654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7653","id":1554110654,"node_id":"IC_kwDOCW7NX85codi-","user":{"login":"manuzhang","id":1191767,"node_id":"MDQ6VXNlcjExOTE3Njc=","avatar_url":"https://avatars.githubusercontent.com/u/1191767?v=4","gravatar_id":"","url":"https://api.github.com/users/manuzhang","html_url":"https://github.com/manuzhang","followers_url":"https://api.github.com/users/manuzhang/followers","following_url":"https://api.github.com/users/manuzhang/following{/other_user}","gists_url":"https://api.github.com/users/manuzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/manuzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuzhang/subscriptions","organizations_url":"https://api.github.com/users/manuzhang/orgs","repos_url":"https://api.github.com/users/manuzhang/repos","events_url":"https://api.github.com/users/manuzhang/events{/privacy}","received_events_url":"https://api.github.com/users/manuzhang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T07:01:32Z","updated_at":"2023-05-22T05:50:36Z","author_association":"COLLABORATOR","body":"@aokolnychyi @karuppayya Please help review the back-port. I think it's critical for Spark 3.1 users as the prefix mismatch (`viewfs` vs `hdfs` in our case) has been blocking maintenance jobs (e.g. ExpireSnapshots) in our cluster.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554110654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554134712","html_url":"https://github.com/apache/iceberg/issues/7420#issuecomment-1554134712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7420","id":1554134712,"node_id":"IC_kwDOCW7NX85coja4","user":{"login":"akshayjain3450","id":39643112,"node_id":"MDQ6VXNlcjM5NjQzMTEy","avatar_url":"https://avatars.githubusercontent.com/u/39643112?v=4","gravatar_id":"","url":"https://api.github.com/users/akshayjain3450","html_url":"https://github.com/akshayjain3450","followers_url":"https://api.github.com/users/akshayjain3450/followers","following_url":"https://api.github.com/users/akshayjain3450/following{/other_user}","gists_url":"https://api.github.com/users/akshayjain3450/gists{/gist_id}","starred_url":"https://api.github.com/users/akshayjain3450/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akshayjain3450/subscriptions","organizations_url":"https://api.github.com/users/akshayjain3450/orgs","repos_url":"https://api.github.com/users/akshayjain3450/repos","events_url":"https://api.github.com/users/akshayjain3450/events{/privacy}","received_events_url":"https://api.github.com/users/akshayjain3450/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T07:14:01Z","updated_at":"2023-05-19T07:14:01Z","author_association":"NONE","body":"Hi, I am still waiting for a reply on this issue. @rdblue @RussellSpitzer @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554134712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554321996","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1554321996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1554321996,"node_id":"IC_kwDOCW7NX85cpRJM","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T09:52:41Z","updated_at":"2023-05-19T10:18:47Z","author_association":"CONTRIBUTOR","body":">Can you also explain what does \"partition commit\" mean exactly?\r\n\r\nPartition commit means that in the current task, we consider that the data of a partition is ready and can be opened to downstream applications. Here we can define what actions to perform when committing partitions. Is it to submit the partition  to the metadata, create a marker file, or perform some other custom operations.\r\n\r\nFor example, there is a table partitioned by hour, when the watermark based on event time reaches 02:00:00 we think that the data of the `01` hour partition is complete and can be used by downstream applications, so we commit this partition to the metadata (This means that we need to commit the data of this partition to the Iceberg table, create a new snapshot). In this case, we can make a remote API call to notify the task flow that it can start the spark batch step for  `01` hour partition.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554321996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554335242","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1554335242","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1554335242,"node_id":"IC_kwDOCW7NX85cpUYK","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T10:03:36Z","updated_at":"2023-05-19T10:13:52Z","author_association":"CONTRIBUTOR","body":"> This can be fixed by checkpointing the watermark written to snapshot summary or during restore the committer can retrieve the latest committed watermark\r\n\r\n>  I agree that a little bit of logic is needed to determine which partitions have complete data based on the published watermark in snapshot summary.\r\n\r\nOf course, we can store the watermark, but this does not fundamentally solve the data visibility problem. Writing watermark to Iceberg table is simple, but it increases the complexity of the whole task chain. And in many scenarios, downstream does not have a suitable place to implement this set of processing logic. For example, ad hoc query, OLAP query.\r\n\r\n'determine which partitions have complete data', isn’t this exactly what Flink(with watermark) is better at and should do? When the data of a partition is complete, flink submit this partition and make it visible to the downstream.\r\n\r\n\r\n>I am not sure this is a fair comparison. Flink filesystem connector is storing files on distributed file system (like S3) directly. there is no table format abstraction. hence success file is the only option.\r\n\r\nRegarding `SUCCESS`, it is just an built-in partition commit policy. And not only Filesystem, Hive also supports this, see :https://nightlies.apache.org/flink/flink-docs-master/docs/connectors/table/hive/hive_read_write/#writing\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554335242/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554342314","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1554342314","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1554342314,"node_id":"IC_kwDOCW7NX85cpWGq","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T10:09:08Z","updated_at":"2023-05-19T10:09:08Z","author_association":"CONTRIBUTOR","body":"> I am not sure this is a fair comparison. Flink filesystem connector is storing files on distributed file system (like S3) directly. there is no table format abstraction. hence success file is the only option.\r\n\r\nWhen we process data, we often have not only streaming jobs, but also many Spark batch jobs behind the streaming jobs. Flink+Hive+Spark is a very common combination. Similarly, when we switch Hive to Iceberg, we need the streaming job to tell the scheduling system when to start the Spark task. We use FileSystem very rarely.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554342314/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554378252","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1554378252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1554378252,"node_id":"IC_kwDOCW7NX85cpe4M","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T10:41:09Z","updated_at":"2023-05-19T10:41:09Z","author_association":"CONTRIBUTOR","body":"> where are those success files stored? How do downstream consumers find them?\r\n\r\nThis file is stored under the partition directory, such as /path/iceberg_table/data/dt=20220101/_SUCCESS\r\n\r\n>How does work with entropy enabled?\r\nhttps://iceberg.apache.org/docs/latest/aws/#object-store-file-layout\r\n\r\nThe same way as HDFS, We use the following method to create this file:\r\n```\r\n    String successFileCommitPath =\r\n        table.locationProvider().newDataLocation(table.spec(), partitionKey, successFileName);\r\n\r\n    try (FileIO io = table.io()) {\r\n      io.newOutputFile(successFileCommitPath).createOrOverwrite().close();\r\n    } catch (IOException e) {\r\n      throw new RuntimeException(e);\r\n    }\r\n```\r\nI may not have fully understood what you mean.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554378252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554402597","html_url":"https://github.com/apache/iceberg/pull/7642#issuecomment-1554402597","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7642","id":1554402597,"node_id":"IC_kwDOCW7NX85cpk0l","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T11:00:28Z","updated_at":"2023-05-19T11:00:28Z","author_association":"MEMBER","body":"cc: @snazy, @dimas-b, @nastra   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554402597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554603272","html_url":"https://github.com/apache/iceberg/issues/7657#issuecomment-1554603272","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7657","id":1554603272,"node_id":"IC_kwDOCW7NX85cqV0I","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T13:49:36Z","updated_at":"2023-05-19T13:49:36Z","author_association":"MEMBER","body":"The `rewrite-datafiles` is almost certainly a red herring. It shouldn't have any effect on the table if it failed since it is transactional like all Iceberg operations. It may be that this is coincidental or perhaps the system has just run out of some resource like disk space.\r\n\r\n> Spark will attempt to load and sort the entire table before inserting the new batch even though we are partitioning by loaded_at which should never need more than one partition.\r\n\r\nThis is quite confusing to me. An \"append\" should never require reading anything from the target table. The source though will have a shuffle applied to it based on the `write.distribution-mode` of the table. We recently did change the default to hash which would request that the incoming data be shuffled by the partition of the destination table. If you are confident it does not need to be shuffled you can always set the mode to `none`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554603272/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554654166","html_url":"https://github.com/apache/iceberg/pull/7652#issuecomment-1554654166","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7652","id":1554654166,"node_id":"IC_kwDOCW7NX85cqiPW","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T14:15:12Z","updated_at":"2023-05-19T14:15:12Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar Would be great to get this into 1.3.0 as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554654166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554741515","html_url":"https://github.com/apache/iceberg/issues/7657#issuecomment-1554741515","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7657","id":1554741515,"node_id":"IC_kwDOCW7NX85cq3kL","user":{"login":"LucasRoesler","id":891889,"node_id":"MDQ6VXNlcjg5MTg4OQ==","avatar_url":"https://avatars.githubusercontent.com/u/891889?v=4","gravatar_id":"","url":"https://api.github.com/users/LucasRoesler","html_url":"https://github.com/LucasRoesler","followers_url":"https://api.github.com/users/LucasRoesler/followers","following_url":"https://api.github.com/users/LucasRoesler/following{/other_user}","gists_url":"https://api.github.com/users/LucasRoesler/gists{/gist_id}","starred_url":"https://api.github.com/users/LucasRoesler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LucasRoesler/subscriptions","organizations_url":"https://api.github.com/users/LucasRoesler/orgs","repos_url":"https://api.github.com/users/LucasRoesler/repos","events_url":"https://api.github.com/users/LucasRoesler/events{/privacy}","received_events_url":"https://api.github.com/users/LucasRoesler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T15:16:30Z","updated_at":"2023-05-19T15:16:30Z","author_association":"NONE","body":"We suspected the `rewrite-datafiles` because it is the only change that we know happened around the time that we stopped loading data. \r\n\r\nRegarding \r\n>  If you are confident it does not need to be shuffled you can always set the mode to none.\r\n\r\nWe are currently just grabbing a batch of message from kafka and then we set the loaded time to the current timestamp. I suspect we don't need a suffle here, all of the data should just go to the end of the current partition. I am not 100% sure though,\r\n\r\n\r\nRegarding the version, we did update the iceberg version while testing various fixes for this, from 1.2.0 to 1.2.1. But it had been running 1.2.0 for a couple weeks or longer. If I read the changelog correctly, 1.2.0 already had this change to the `write.distribution-mode`.\r\n\r\n\r\n\r\nPart of the reason we suspected that it was trying to sort the full table is because it is the only thing that has as much data as it was claiming to have loaded, at one point it had sorted through 69 million rows. The kafka topic simply didn't have that much data in it for the time period specified \r\n\r\nFor example, this is one of the screenshots I can find in our slack \r\n<details>\r\n\r\n![image](https://github.com/apache/iceberg/assets/891889/79fc2e95-843b-4713-a358-3135d05d5080)\r\n\r\n</details>\r\n\r\nCompared to the same screen for the currently running stream, i can't find any that show more rows loaded\r\n<details>\r\n\r\n![image](https://github.com/apache/iceberg/assets/891889/41a3d4da-1019-40cd-a011-fc5282db17ea)\r\n\r\n</details>\r\n\r\n\r\nAdditionally, a single partition doesn't really have enough data to account for the same of that `ExistingRDD`\r\n\r\nThis is the metadata for the last handful of partitions in the new table \r\n<details>\r\n\r\n![image](https://github.com/apache/iceberg/assets/891889/b43f679d-7157-4aca-8bc2-b662727c41df)\r\n\r\n</details>\r\n\r\nFor comparison, the same partition data for the original table\r\n\r\n<details>\r\n\r\n![image](https://github.com/apache/iceberg/assets/891889/84a56164-fd03-4bd7-a377-024475b32f2a)\r\n\r\n</details>","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554741515/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554742996","html_url":"https://github.com/apache/iceberg/pull/7593#issuecomment-1554742996","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7593","id":1554742996,"node_id":"IC_kwDOCW7NX85cq37U","user":{"login":"zhangbutao","id":9760681,"node_id":"MDQ6VXNlcjk3NjA2ODE=","avatar_url":"https://avatars.githubusercontent.com/u/9760681?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangbutao","html_url":"https://github.com/zhangbutao","followers_url":"https://api.github.com/users/zhangbutao/followers","following_url":"https://api.github.com/users/zhangbutao/following{/other_user}","gists_url":"https://api.github.com/users/zhangbutao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangbutao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangbutao/subscriptions","organizations_url":"https://api.github.com/users/zhangbutao/orgs","repos_url":"https://api.github.com/users/zhangbutao/repos","events_url":"https://api.github.com/users/zhangbutao/events{/privacy}","received_events_url":"https://api.github.com/users/zhangbutao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T15:17:48Z","updated_at":"2023-05-19T15:17:48Z","author_association":"CONTRIBUTOR","body":"> Actually I just realized that we also need to fix for its counterpart in CreateTag, so I ended up just doing it in #7652\r\n\r\n@dramaticlly Thanks for the fix. I am ok to close this PR if your change is merged. :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554742996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554757626","html_url":"https://github.com/apache/iceberg/issues/7657#issuecomment-1554757626","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7657","id":1554757626,"node_id":"IC_kwDOCW7NX85cq7f6","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T15:30:27Z","updated_at":"2023-05-19T15:30:27Z","author_association":"MEMBER","body":"You can just look at the plan details to see what \"existingRDD\" is being generated from. Although this should be in your code. Again, and I can't emphasize this enough, there is no way an \"Insert\" can read the data already in your table. Only an Update, Merge or Delete can do that.\r\n\r\nYou really should share the actual code you are using (or sql) for insert because comparing things based on their approximate size is probably not going to get us very far.\r\n\r\nAnd again on the coincidence of rewrite_data_files, the operation can only do 1 thing to modify the table for future readers, and that is to change the metadata.json pointed to in the catalog. All Iceberg transactions function on this basic principal. If that pointer did not change, there is no way the command can influence future readers. The command may leave garbage files behind though if it failed, hence my thoughts about resource issues. Any of the other things I could imagine, like removing existing metadata or data files accidentally (which rewrite data files does not do but there are mysteries everywhere) would result in abrupt errors. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554757626/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554792856","html_url":"https://github.com/apache/iceberg/issues/7657#issuecomment-1554792856","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7657","id":1554792856,"node_id":"IC_kwDOCW7NX85crEGY","user":{"login":"LucasRoesler","id":891889,"node_id":"MDQ6VXNlcjg5MTg4OQ==","avatar_url":"https://avatars.githubusercontent.com/u/891889?v=4","gravatar_id":"","url":"https://api.github.com/users/LucasRoesler","html_url":"https://github.com/LucasRoesler","followers_url":"https://api.github.com/users/LucasRoesler/followers","following_url":"https://api.github.com/users/LucasRoesler/following{/other_user}","gists_url":"https://api.github.com/users/LucasRoesler/gists{/gist_id}","starred_url":"https://api.github.com/users/LucasRoesler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LucasRoesler/subscriptions","organizations_url":"https://api.github.com/users/LucasRoesler/orgs","repos_url":"https://api.github.com/users/LucasRoesler/repos","events_url":"https://api.github.com/users/LucasRoesler/events{/privacy}","received_events_url":"https://api.github.com/users/LucasRoesler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T16:02:12Z","updated_at":"2023-05-19T16:02:12Z","author_association":"NONE","body":"Sorry about not including the code snippet earlier. We are using PySpark.\r\n\r\nWe are using `foreachBatch` and then just appending the batch dataframe to the table like this\r\n\r\n```py\r\n df.writeTo(table_identifier)\r\n  .using(\"iceberg\")\r\n  .option(\"fanout-enabled\", True)\r\n  .append()\r\n```\r\n\r\nThe full loader code is here, lightly modified to remove some comments and in-lining a few config values, etc:\r\n\r\n<details>\r\n\r\n```py\r\nLOADING_ZONE_TABLE = \"loading_zone_b\"\r\n\r\n\r\ndef process_batch(spark: SparkSession, opts: Options):\r\n    def process(df: DataFrame, id: int):\r\n        if df.isEmpty():\r\n            return\r\n        \r\n        df = df.withColumns(\r\n            {\r\n                \"loaded_at\": F.lit(F.current_timestamp()),\r\n                \"loader_metadata\": F.struct(\r\n                    F.lit(__version__).alias(\"version\"),\r\n                    F.lit(__tag__).alias(\"tag\"),\r\n                    F.lit(loader_additional).alias(\"additional\"),\r\n                ),\r\n            }\r\n        )\r\n\r\n\r\n        df = df.drop(\"processed\").withColumnRenamed(\"processing_error\", \"loader_error\")\r\n\r\n        cfg = opts.iceberg\r\n        table_identifier = cfg.table_identifier(LOADING_ZONE_TABLE)\r\n\r\n        (\r\n            df.writeTo(table_identifier)\r\n            .using(\"iceberg\")\r\n            .option(\"fanout-enabled\", True)\r\n            .append()\r\n        )\r\n\r\n    return process\r\n\r\ndef loader(spark: SparkSession, opts: Options):\r\n\r\n    df = (\r\n        spark.readStream.format(\"kafka\")\r\n        .options(**opts.kafka.to_dict())\r\n        .option(\"subscribe\", opts.kafka.topic)\r\n        .load()\r\n    )\r\n\r\n    df = df.withColumn(\r\n        \"topic\", \r\n        F.col(\"topic\").cast(\"string\")\r\n    ).withColumn(\r\n        \"value\", \r\n        F.col(\"value\").cast(\"string\")\r\n    )\r\n\r\n\r\n    stream = (\r\n        df.select(\r\n            F.col(\"topic\").alias(\"kafka_topic\"),\r\n            F.col(\"timestamp\").alias(\"kafka_received_at\"),\r\n            F.col(\"timestamp\").alias(\"kafka_timestamp\"),\r\n            parser(\r\n                F.lit(opts.hashing.id_hash_password.get_secret_value()),\r\n                F.col(\"value\"),\r\n            ).alias(\"event_data\"),\r\n        )\r\n        .select(\r\n            F.col(\"kafka_topic\"),\r\n            F.col(\"kafka_received_at\"),\r\n            F.col(\"event_data.*\"),\r\n        )\r\n        .writeStream.queryName(\"loader\")\r\n        .trigger(processingTime=opts.iceberg.processing_time)\r\n        .option(\"checkpointLocation\", opts.kafka.checkpointLocation)\r\n        .foreachBatch(process_batch(spark, opts))\r\n        .start()\r\n    )\r\n\r\n    stream.awaitTermination()\r\n```\r\n\r\n</details>\r\n\r\nYou mention that the plan should give details about where the ExistingRDD is coming from but since I am still somewhat new to Spark, I just don't realize it when I am looking at it\r\n\r\n```txt\r\n== Physical Plan ==\r\nAppendData (5)\r\n+- Sort (4)\r\n   +- Exchange (3)\r\n      +- Project (2)\r\n         +- * Scan ExistingRDD (1)\r\n\r\n\r\n(1) Scan ExistingRDD [codegen id : 1]\r\nOutput [17]: [kafka_topic#440073, kafka_received_at#440074, processed#440075, processing_error#440076, source#440077, source_event_id#440078, recorded_at#440079, recorded_by#440080, token#440081, event_type#440082, event_name#440083, event_type_version#440084, person_id#440085, ids#440086, collector#440087, event#440088, raw#440089]\r\nArguments: [kafka_topic#440073, kafka_received_at#440074, processed#440075, processing_error#440076, source#440077, source_event_id#440078, recorded_at#440079, recorded_by#440080, token#440081, event_type#440082, event_name#440083, event_type_version#440084, person_id#440085, ids#440086, collector#440087, event#440088, raw#440089], SQLExecutionRDD[35818] at start at <unknown>:0, ExistingRDD, UnknownPartitioning(0)\r\n\r\n(2) Project\r\nOutput [18]: [kafka_topic#440073, kafka_received_at#440074, source#440077, source_event_id#440078, recorded_at#440079, recorded_by#440080, token#440081, event_type#440082, event_name#440083, event_type_version#440084, person_id#440085, transform(ids#440086, lambdafunction(if (isnull(lambda x#440204)) null else named_struct(id, lambda x#440204.id, id_type, lambda x#440204.id_type), lambda x#440204, false)) AS ids#440211, if (isnull(collector#440087)) null else named_struct(id, collector#440087.id, received_at, collector#440087.received_at, hash, collector#440087.hash) AS collector#440218, event#440088, raw#440089, 2023-05-19 15:53:01.001032 AS loaded_at#440110, processing_error#440076 AS loader_error#440149, [3.18.4,v3.18.4,{}] AS loader_metadata#440225]\r\nInput [17]: [kafka_topic#440073, kafka_received_at#440074, processed#440075, processing_error#440076, source#440077, source_event_id#440078, recorded_at#440079, recorded_by#440080, token#440081, event_type#440082, event_name#440083, event_type_version#440084, person_id#440085, ids#440086, collector#440087, event#440088, raw#440089]\r\n\r\n(3) Exchange\r\nInput [18]: [kafka_topic#440073, kafka_received_at#440074, source#440077, source_event_id#440078, recorded_at#440079, recorded_by#440080, token#440081, event_type#440082, event_name#440083, event_type_version#440084, person_id#440085, ids#440211, collector#440218, event#440088, raw#440089, loaded_at#440110, loader_error#440149, loader_metadata#440225]\r\nArguments: hashpartitioning(iceberghourtransform(loaded_at#440110), 200), REPARTITION_BY_NUM, [plan_id=199587]\r\n\r\n(4) Sort\r\nInput [18]: [kafka_topic#440073, kafka_received_at#440074, source#440077, source_event_id#440078, recorded_at#440079, recorded_by#440080, token#440081, event_type#440082, event_name#440083, event_type_version#440084, person_id#440085, ids#440211, collector#440218, event#440088, raw#440089, loaded_at#440110, loader_error#440149, loader_metadata#440225]\r\nArguments: [iceberghourtransform(loaded_at#440110) ASC NULLS FIRST], false, 0\r\n\r\n(5) AppendData\r\nInput [18]: [kafka_topic#440073, kafka_received_at#440074, source#440077, source_event_id#440078, recorded_at#440079, recorded_by#440080, token#440081, event_type#440082, event_name#440083, event_type_version#440084, person_id#440085, ids#440211, collector#440218, event#440088, raw#440089, loaded_at#440110, loader_error#440149, loader_metadata#440225]\r\nArguments: org.apache.spark.sql.execution.datasources.v2.DataSourceV2Strategy$$Lambda$5479/0x0000000841df1c40@a4ed326, IcebergWrite(table=glue.dwh.loading_zone_b, format=PARQUET)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554792856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554800037","html_url":"https://github.com/apache/iceberg/issues/7657#issuecomment-1554800037","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7657","id":1554800037,"node_id":"IC_kwDOCW7NX85crF2l","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T16:08:04Z","updated_at":"2023-05-19T16:08:04Z","author_association":"MEMBER","body":"Looks like a standard read from Kafka there, shuffle is there because of the write hash distribution. Nothing in that plan about reading from an Iceberg relation. Although there might be something in the Stream Code i'm missing.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554800037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554812215","html_url":"https://github.com/apache/iceberg/issues/7657#issuecomment-1554812215","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7657","id":1554812215,"node_id":"IC_kwDOCW7NX85crI03","user":{"login":"LucasRoesler","id":891889,"node_id":"MDQ6VXNlcjg5MTg4OQ==","avatar_url":"https://avatars.githubusercontent.com/u/891889?v=4","gravatar_id":"","url":"https://api.github.com/users/LucasRoesler","html_url":"https://github.com/LucasRoesler","followers_url":"https://api.github.com/users/LucasRoesler/followers","following_url":"https://api.github.com/users/LucasRoesler/following{/other_user}","gists_url":"https://api.github.com/users/LucasRoesler/gists{/gist_id}","starred_url":"https://api.github.com/users/LucasRoesler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LucasRoesler/subscriptions","organizations_url":"https://api.github.com/users/LucasRoesler/orgs","repos_url":"https://api.github.com/users/LucasRoesler/repos","events_url":"https://api.github.com/users/LucasRoesler/events{/privacy}","received_events_url":"https://api.github.com/users/LucasRoesler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T16:19:54Z","updated_at":"2023-05-19T16:19:54Z","author_association":"NONE","body":"It is most likely that my assessment and initial ideas about the issue are wrong, but the only thing I changed to fix the loader was changing the target to a new empty table, it started working immediately. None of kafka or stream configuration changes had any impact. \r\n\r\nIf there are other commands or configs I should adjust and then report back, it is still possible for me to revert back to the previous configuration and investigate it continuing the old stream into the old table. I just don't know where to start in terms of next steps. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554812215/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554986999","html_url":"https://github.com/apache/iceberg/pull/7326#issuecomment-1554986999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7326","id":1554986999,"node_id":"IC_kwDOCW7NX85crzf3","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T17:14:01Z","updated_at":"2023-05-19T17:14:01Z","author_association":"CONTRIBUTOR","body":"Thanks @RussellSpitzer @amogh-jahagirdar @anigos @aokolnychyi  for the review. This is ready for another look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1554986999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555121127","html_url":"https://github.com/apache/iceberg/issues/7635#issuecomment-1555121127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7635","id":1555121127,"node_id":"IC_kwDOCW7NX85csUPn","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T19:15:23Z","updated_at":"2023-05-19T19:15:23Z","author_association":"CONTRIBUTOR","body":"Will take a look when I get some time, thanks for reporting this issue @edgarRd !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555121127/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555128265","html_url":"https://github.com/apache/iceberg/pull/7659#issuecomment-1555128265","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7659","id":1555128265,"node_id":"IC_kwDOCW7NX85csV_J","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T19:21:39Z","updated_at":"2023-05-19T19:21:39Z","author_association":"CONTRIBUTOR","body":"CI seem to failed due to memory issue in https://github.com/apache/iceberg/actions/runs/5027176975/jobs/9016350188?pr=7659#step:6:232. close and reopen to retry it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555128265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555144865","html_url":"https://github.com/apache/iceberg/pull/7660#issuecomment-1555144865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7660","id":1555144865,"node_id":"IC_kwDOCW7NX85csaCh","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T19:38:50Z","updated_at":"2023-05-19T19:38:50Z","author_association":"CONTRIBUTOR","body":"Actually, after I split updates into delete and insert, this only gives small improvements. I am going to close this for now and come back after the release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555144865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555209171","html_url":"https://github.com/apache/iceberg/pull/7646#issuecomment-1555209171","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7646","id":1555209171,"node_id":"IC_kwDOCW7NX85cspvT","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T20:34:43Z","updated_at":"2023-05-19T20:34:43Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555209171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555250580","html_url":"https://github.com/apache/iceberg/pull/7301#issuecomment-1555250580","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7301","id":1555250580,"node_id":"IC_kwDOCW7NX85csz2U","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T21:06:36Z","updated_at":"2023-05-19T21:06:36Z","author_association":"CONTRIBUTOR","body":"Thanks @singhpk234 for picking this up, and @amogh-jahagirdar for the review!\r\n\r\n@bryanck do you want the honor of reverting https://github.com/apache/iceberg/pull/5681?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555250580/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555339375","html_url":"https://github.com/apache/iceberg/pull/7430#issuecomment-1555339375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7430","id":1555339375,"node_id":"IC_kwDOCW7NX85ctJhv","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T22:32:04Z","updated_at":"2023-05-19T22:32:04Z","author_association":"CONTRIBUTOR","body":"@puchengy, we have discussed this during the sync (it is unfortunate we missed you). The consensus was to invest into an algorithm to pick the split size automatically. We also converged that just offering a single SQL property to override the split is probably not a good idea as we plan to pick the split size automatically.\r\n\r\nThat said, we should discuss whether offering a generic way to override a table property via SQL would make sense. In my view, this is the most reasonable short-term solution for this problem. The only concern I have is how to handle special characters.\r\n\r\n@rdblue @RussellSpitzer @danielcweeks, could you share your thoughts? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555339375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555339630","html_url":"https://github.com/apache/iceberg/pull/7430#issuecomment-1555339630","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7430","id":1555339630,"node_id":"IC_kwDOCW7NX85ctJlu","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T22:32:27Z","updated_at":"2023-05-19T22:32:27Z","author_association":"CONTRIBUTOR","body":"I am going to drop this PR from the 1.3.0 as it, probably, needs a bit of discussion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555339630/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555346282","html_url":"https://github.com/apache/iceberg/pull/7301#issuecomment-1555346282","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7301","id":1555346282,"node_id":"IC_kwDOCW7NX85ctLNq","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T22:42:30Z","updated_at":"2023-05-19T23:02:18Z","author_association":"CONTRIBUTOR","body":"I guess there were a few oversights here that we want to address before release, I was thinking that it would make sense for certain use cases to disable dictionary encoding if they wanted to use bloom filters (controlling the space tradeoff). But this probably isn't that valuable if I think about it. \r\n\r\nDictionary encoding is useful for low cardinality columns, so the space difference between the two is negligible, with the tradeoff being deterministic lookups vs False positives from the bloom filter. \r\n\r\nSo if it's about the test, I suppose we can see about adding a package private method for disabling dictionary encoding to the builder? or some alternative configuration\r\n\r\nSo we should conclude\r\n\r\n1.) Do we really want a table property for controlling dictionary encoding? Curious to know other's opinions. cc: @Fokko @rdblue @singhpk234 @aokolnychyi \r\n\r\n2.) If the answer is yes for 1 let's go back and correct the naming in the properties and docs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555346282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555353655","html_url":"https://github.com/apache/iceberg/pull/7430#issuecomment-1555353655","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7430","id":1555353655,"node_id":"IC_kwDOCW7NX85ctNA3","user":{"login":"puchengy","id":8072956,"node_id":"MDQ6VXNlcjgwNzI5NTY=","avatar_url":"https://avatars.githubusercontent.com/u/8072956?v=4","gravatar_id":"","url":"https://api.github.com/users/puchengy","html_url":"https://github.com/puchengy","followers_url":"https://api.github.com/users/puchengy/followers","following_url":"https://api.github.com/users/puchengy/following{/other_user}","gists_url":"https://api.github.com/users/puchengy/gists{/gist_id}","starred_url":"https://api.github.com/users/puchengy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puchengy/subscriptions","organizations_url":"https://api.github.com/users/puchengy/orgs","repos_url":"https://api.github.com/users/puchengy/repos","events_url":"https://api.github.com/users/puchengy/events{/privacy}","received_events_url":"https://api.github.com/users/puchengy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T22:56:29Z","updated_at":"2023-05-19T22:56:58Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi Thanks for sharing this. I would to love to go for the generic way to override a table property via SQL approach and I would love to offer the implementation, If you and @rdblue @RussellSpitzer @danielcweeks thinks this is something that community can adopt. Otherwise, we can continue the discussion for other solutions.\r\n\r\nIf we are fine with the approach, then my next question is I don't know a good implementation to this, so if you know, please let me know. Otherwise I can investigate and propose one.\r\n\r\nThanks all for participating this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555353655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555360092","html_url":"https://github.com/apache/iceberg/issues/7663#issuecomment-1555360092","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7663","id":1555360092,"node_id":"IC_kwDOCW7NX85ctOlc","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T23:06:04Z","updated_at":"2023-05-19T23:06:04Z","author_association":"CONTRIBUTOR","body":"Commented on https://github.com/apache/iceberg/pull/7301#issuecomment-1555346282 , we may want to see if we even want a table property in the first place, curious to know others thoughts @singhpk234 @Fokko @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555360092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555362415","html_url":"https://github.com/apache/iceberg/pull/7630#issuecomment-1555362415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7630","id":1555362415,"node_id":"IC_kwDOCW7NX85ctPJv","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T23:10:17Z","updated_at":"2023-05-19T23:10:17Z","author_association":"COLLABORATOR","body":"Merged, thanks @ajantha-bhat ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555362415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555364990","html_url":"https://github.com/apache/iceberg/pull/7301#issuecomment-1555364990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7301","id":1555364990,"node_id":"IC_kwDOCW7NX85ctPx-","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T23:15:48Z","updated_at":"2023-05-19T23:15:48Z","author_association":"CONTRIBUTOR","body":"I agree with @amogh-jahagirdar. It is probably not worth adding an extra table property for the sake of the test. I doubt anyone would ever configure it. Can we fix the test?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555364990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555376685","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1555376685","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1555376685,"node_id":"IC_kwDOCW7NX85ctSot","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T23:43:51Z","updated_at":"2023-05-19T23:43:51Z","author_association":"CONTRIBUTOR","body":"@hililiwei can you put everything in a quip doc? then we can send an email to dev@ and seek broader feedback. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555376685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555378922","html_url":"https://github.com/apache/iceberg/issues/7663#issuecomment-1555378922","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7663","id":1555378922,"node_id":"IC_kwDOCW7NX85ctTLq","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T23:50:03Z","updated_at":"2023-05-19T23:50:03Z","author_association":"CONTRIBUTOR","body":"I agree with @amogh-jahagirdar.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555378922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555379210","html_url":"https://github.com/apache/iceberg/pull/7664#issuecomment-1555379210","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7664","id":1555379210,"node_id":"IC_kwDOCW7NX85ctTQK","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-19T23:50:56Z","updated_at":"2023-05-19T23:50:56Z","author_association":"CONTRIBUTOR","body":"Do we have a benchmark to prove the underlying issue has been fixed?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555379210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555384896","html_url":"https://github.com/apache/iceberg/pull/7664#issuecomment-1555384896","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7664","id":1555384896,"node_id":"IC_kwDOCW7NX85ctUpA","user":{"login":"bryanck","id":5475421,"node_id":"MDQ6VXNlcjU0NzU0MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5475421?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanck","html_url":"https://github.com/bryanck","followers_url":"https://api.github.com/users/bryanck/followers","following_url":"https://api.github.com/users/bryanck/following{/other_user}","gists_url":"https://api.github.com/users/bryanck/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanck/subscriptions","organizations_url":"https://api.github.com/users/bryanck/orgs","repos_url":"https://api.github.com/users/bryanck/repos","events_url":"https://api.github.com/users/bryanck/events{/privacy}","received_events_url":"https://api.github.com/users/bryanck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T00:04:03Z","updated_at":"2023-05-20T00:12:07Z","author_association":"CONTRIBUTOR","body":"I'll close this for now, I won't have time to do an analysis any time soon, which I agree should be part of this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555384896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555388387","html_url":"https://github.com/apache/iceberg/issues/6060#issuecomment-1555388387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6060","id":1555388387,"node_id":"IC_kwDOCW7NX85ctVfj","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T00:10:41Z","updated_at":"2023-05-20T00:10:41Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555388387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555396614","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1555396614","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1555396614,"node_id":"IC_kwDOCW7NX85ctXgG","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T00:29:37Z","updated_at":"2023-05-20T00:29:37Z","author_association":"COLLABORATOR","body":"Merged, thanks @ludlows ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555396614/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555398680","html_url":"https://github.com/apache/iceberg/pull/7630#issuecomment-1555398680","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7630","id":1555398680,"node_id":"IC_kwDOCW7NX85ctYAY","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T00:36:44Z","updated_at":"2023-05-20T00:36:44Z","author_association":"MEMBER","body":"@szehon-ho: Thanks for the review. I will backport to other spark versions later today.  \r\n\r\nAlso, I can see that new changes like `RewritePositionDeleteFilesSparkAction.java` is not backported. Do we need to handle this before 1.3 release? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555398680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555443664","html_url":"https://github.com/apache/iceberg/pull/7665#issuecomment-1555443664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7665","id":1555443664,"node_id":"IC_kwDOCW7NX85cti_Q","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T02:54:17Z","updated_at":"2023-05-20T02:54:17Z","author_association":"CONTRIBUTOR","body":"Thanks @amogh-jahagirdar for picking this up, apologies for my oversight in the previous pr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555443664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555456742","html_url":"https://github.com/apache/iceberg/pull/7665#issuecomment-1555456742","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7665","id":1555456742,"node_id":"IC_kwDOCW7NX85ctmLm","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T03:46:06Z","updated_at":"2023-05-20T03:46:06Z","author_association":"CONTRIBUTOR","body":"Thanks for review @singhpk234 ! I updated. No worries, was an oversight on my part during review. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555456742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555465280","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1555465280","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1555465280,"node_id":"IC_kwDOCW7NX85ctoRA","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T04:08:10Z","updated_at":"2023-05-20T04:08:10Z","author_association":"COLLABORATOR","body":"I concur with @stevenzwu on the necessity for a design document that delves into the issue and potential solutions. The stream-to-batch use case is prevalent among data lake users, and it warrants exploring diverse approaches. We can foster community consensus on the most suitable solution, paving the way for the subsequent coding phase.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555465280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555860100","html_url":"https://github.com/apache/iceberg/pull/7651#issuecomment-1555860100","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7651","id":1555860100,"node_id":"IC_kwDOCW7NX85cvIqE","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T08:17:00Z","updated_at":"2023-05-20T08:17:00Z","author_association":"COLLABORATOR","body":"Test fail looks unrelated","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555860100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555872635","html_url":"https://github.com/apache/iceberg/issues/7663#issuecomment-1555872635","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7663","id":1555872635,"node_id":"IC_kwDOCW7NX85cvLt7","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T09:27:47Z","updated_at":"2023-05-20T09:27:47Z","author_association":"CONTRIBUTOR","body":"> Dictionary encoding is useful for low cardinality columns, so the space difference between the two is negligible, with the tradeoff being deterministic lookups vs False positives from the bloom filter.\r\n\r\nIf it is low cardinality, the likelihood of having false positives is also low (assuming a fixed size bit for the bloom filter). I'm not sure if the dictionary is used for skipping data for example, but I don't think that should influence or impact this decision. Because if that's not the case, then we should fix that :)\r\n\r\nI'm not super strong on this, but in the end, I think less configuration is better. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555872635/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555875247","html_url":"https://github.com/apache/iceberg/pull/7665#issuecomment-1555875247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7665","id":1555875247,"node_id":"IC_kwDOCW7NX85cvMWv","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T09:44:24Z","updated_at":"2023-05-20T09:44:24Z","author_association":"CONTRIBUTOR","body":"Thanks for picking this up @amogh-jahagirdar and @singhpk234. I also missed it 🥴 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555875247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555928594","html_url":"https://github.com/apache/iceberg/pull/7666#issuecomment-1555928594","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7666","id":1555928594,"node_id":"IC_kwDOCW7NX85cvZYS","user":{"login":"rakesh-das08","id":16017562,"node_id":"MDQ6VXNlcjE2MDE3NTYy","avatar_url":"https://avatars.githubusercontent.com/u/16017562?v=4","gravatar_id":"","url":"https://api.github.com/users/rakesh-das08","html_url":"https://github.com/rakesh-das08","followers_url":"https://api.github.com/users/rakesh-das08/followers","following_url":"https://api.github.com/users/rakesh-das08/following{/other_user}","gists_url":"https://api.github.com/users/rakesh-das08/gists{/gist_id}","starred_url":"https://api.github.com/users/rakesh-das08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rakesh-das08/subscriptions","organizations_url":"https://api.github.com/users/rakesh-das08/orgs","repos_url":"https://api.github.com/users/rakesh-das08/repos","events_url":"https://api.github.com/users/rakesh-das08/events{/privacy}","received_events_url":"https://api.github.com/users/rakesh-das08/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T14:50:02Z","updated_at":"2023-05-24T04:16:55Z","author_association":"CONTRIBUTOR","body":"@nastra please review when you get some time :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555928594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555951638","html_url":"https://github.com/apache/iceberg/issues/7658#issuecomment-1555951638","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7658","id":1555951638,"node_id":"IC_kwDOCW7NX85cvfAW","user":{"login":"hrishisd","id":3607022,"node_id":"MDQ6VXNlcjM2MDcwMjI=","avatar_url":"https://avatars.githubusercontent.com/u/3607022?v=4","gravatar_id":"","url":"https://api.github.com/users/hrishisd","html_url":"https://github.com/hrishisd","followers_url":"https://api.github.com/users/hrishisd/followers","following_url":"https://api.github.com/users/hrishisd/following{/other_user}","gists_url":"https://api.github.com/users/hrishisd/gists{/gist_id}","starred_url":"https://api.github.com/users/hrishisd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hrishisd/subscriptions","organizations_url":"https://api.github.com/users/hrishisd/orgs","repos_url":"https://api.github.com/users/hrishisd/repos","events_url":"https://api.github.com/users/hrishisd/events{/privacy}","received_events_url":"https://api.github.com/users/hrishisd/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T16:56:25Z","updated_at":"2023-05-20T16:56:25Z","author_association":"CONTRIBUTOR","body":"Hi Fokko,\r\n\r\nIs the goal of this issue to remove all uses of apache.commons.io?\r\n```java\r\n$rg 'import org.apache.commons'\r\n\r\nspark/v3.2/spark/src/main/java/org/apache/iceberg/spark/procedures/ProcedureInput.java\r\n24:import org.apache.commons.lang3.StringUtils;\r\n\r\nspark/v3.2/spark/src/test/java/org/apache/iceberg/spark/actions/TestCreateActions.java\r\n31:import org.apache.commons.io.FileUtils;\r\n32:import org.apache.commons.io.filefilter.TrueFileFilter;\r\n...\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555951638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555967776","html_url":"https://github.com/apache/iceberg/pull/7662#issuecomment-1555967776","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7662","id":1555967776,"node_id":"IC_kwDOCW7NX85cvi8g","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T18:30:20Z","updated_at":"2023-05-20T18:30:20Z","author_association":"CONTRIBUTOR","body":"Since this is a clean backport to 3.2, I'm merging","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555967776/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555973667","html_url":"https://github.com/apache/iceberg/pull/7659#issuecomment-1555973667","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7659","id":1555973667,"node_id":"IC_kwDOCW7NX85cvkYj","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T19:05:36Z","updated_at":"2023-05-20T19:05:36Z","author_association":"CONTRIBUTOR","body":"Merging since this is a clean backport","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1555973667/reactions","total_count":1,"+1":0,"-1":0,"laugh":1,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556023878","html_url":"https://github.com/apache/iceberg/pull/7638#issuecomment-1556023878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7638","id":1556023878,"node_id":"IC_kwDOCW7NX85cvwpG","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-20T21:58:47Z","updated_at":"2023-05-20T21:59:28Z","author_association":"CONTRIBUTOR","body":">  s3://my-table-data-bucket/my_ns.db/my_table/data/dt=20220101/_SUCCESS\r\n\r\nwith entropy enabled, the file path will look like. see the random prefix `2d3905f8` in the path.\r\nhttps://iceberg.apache.org/docs/latest/aws/#object-store-file-layout\r\n\r\n```\r\ns3://my-table-data-bucket/2d3905f8/my_ns.db/my_table/data/dt=20220101/_SUCCESS\r\n```\r\n\r\nThe success file pattern assumes a well known / predefined path, which may not be true with S3 object store.\r\n\r\nHive is not much different with distributed file system (like HDFS), since it assumes file layout following folder pattern.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556023878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556047969","html_url":"https://github.com/apache/iceberg/issues/6138#issuecomment-1556047969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6138","id":1556047969,"node_id":"IC_kwDOCW7NX85cv2hh","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-05-21T00:12:28Z","updated_at":"2023-05-21T00:12:28Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556047969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556047979","html_url":"https://github.com/apache/iceberg/issues/6050#issuecomment-1556047979","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6050","id":1556047979,"node_id":"IC_kwDOCW7NX85cv2hr","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-05-21T00:12:30Z","updated_at":"2023-05-21T00:12:30Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556047979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556074209","html_url":"https://github.com/apache/iceberg/pull/7652#issuecomment-1556074209","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7652","id":1556074209,"node_id":"IC_kwDOCW7NX85cv87h","user":{"login":"zhangbutao","id":9760681,"node_id":"MDQ6VXNlcjk3NjA2ODE=","avatar_url":"https://avatars.githubusercontent.com/u/9760681?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangbutao","html_url":"https://github.com/zhangbutao","followers_url":"https://api.github.com/users/zhangbutao/followers","following_url":"https://api.github.com/users/zhangbutao/following{/other_user}","gists_url":"https://api.github.com/users/zhangbutao/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangbutao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangbutao/subscriptions","organizations_url":"https://api.github.com/users/zhangbutao/orgs","repos_url":"https://api.github.com/users/zhangbutao/repos","events_url":"https://api.github.com/users/zhangbutao/events{/privacy}","received_events_url":"https://api.github.com/users/zhangbutao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-21T03:38:20Z","updated_at":"2023-05-21T03:47:26Z","author_association":"CONTRIBUTOR","body":"I think this fix is the same idea I had before https://github.com/apache/iceberg/pull/7593. But it doesn't matter, I am glad to see it was fixed. Thanks. closing my previous pr.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556074209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556083344","html_url":"https://github.com/apache/iceberg/pull/7410#issuecomment-1556083344","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7410","id":1556083344,"node_id":"IC_kwDOCW7NX85cv_KQ","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-05-21T04:58:29Z","updated_at":"2023-05-21T04:58:29Z","author_association":"CONTRIBUTOR","body":"Superseded by #7667.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556083344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556084920","html_url":"https://github.com/apache/iceberg/pull/7589#issuecomment-1556084920","issue_url":"https://api.github.com/repos/apache/iceberg/issues/7589","id":1556084920,"node_id":"IC_kwDOCW7NX85cv_i4","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-05-21T05:08:39Z","updated_at":"2023-05-21T05:08:39Z","author_association":"COLLABORATOR","body":"Thanks @flyrain  for detailed review!  We can improve these docs in later prs","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1556084920/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]