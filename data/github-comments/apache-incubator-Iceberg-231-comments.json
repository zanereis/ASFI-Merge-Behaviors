[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428806091","html_url":"https://github.com/apache/iceberg/issues/6172#issuecomment-1428806091","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6172","id":1428806091,"node_id":"IC_kwDOCW7NX85VKdnL","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T22:45:34Z","updated_at":"2023-02-13T22:45:34Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer it worked after I specified `default_iceberg` catalog:\r\n\r\n```\r\n.config(s\"spark.sql.catalog.default_iceberg\", \"org.apache.iceberg.spark.SparkCatalog\")\r\n .config(s\"spark.sql.catalog.default_iceberg.type\", \"hive\")\r\n .config(s\"spark.sql.catalog.default_iceberg.uri\", conf.metastore)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428806091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428815806","html_url":"https://github.com/apache/iceberg/issues/6172#issuecomment-1428815806","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6172","id":1428815806,"node_id":"IC_kwDOCW7NX85VKf--","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-13T22:54:50Z","updated_at":"2023-02-13T22:55:08Z","author_association":"MEMBER","body":"@dmgcodevil That would be a sign of what i'm talking about being broken. That catalog (default_iceberg) is always made by default. See\r\n\r\nhttps://github.com/apache/iceberg/blob/c07f2aabc0a1d02f068ecf1514d2479c0fbdd3b0/spark/v3.3/spark/src/main/java/org/apache/iceberg/spark/source/IcebergSource.java#L216-L231\r\n\r\nSo your configuration would change the active session but the rewriteDatafiles is still relying on the catalog being setup by default.\r\n\r\nIf you could give me more info about your env I'd like to see if there is a common thread, espeically if you could check the SQLConf like I mentioned.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428815806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428897724","html_url":"https://github.com/apache/iceberg/issues/5560#issuecomment-1428897724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5560","id":1428897724,"node_id":"IC_kwDOCW7NX85VKz-8","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T00:12:43Z","updated_at":"2023-02-14T00:12:43Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428897724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428897845","html_url":"https://github.com/apache/iceberg/issues/5400#issuecomment-1428897845","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5400","id":1428897845,"node_id":"IC_kwDOCW7NX85VK0A1","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T00:12:51Z","updated_at":"2023-02-14T00:12:51Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428897845/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428913668","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1428913668","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1428913668,"node_id":"IC_kwDOCW7NX85VK34E","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T00:26:31Z","updated_at":"2023-02-14T00:28:46Z","author_association":"CONTRIBUTOR","body":"> I raised some more tests to @namrathamyske branch [namrathamyske#26](https://github.com/namrathamyske/iceberg/pull/26) please take a look. A couple points I want to raise:\r\n> \r\n> 1.) We won't be able to really write tests for the SparkPositionDeltaWrite until the SQL conf change is in because this PR just focuses on data frame write options. Currently (as far as I can tell) there aren't any row level operations that can be done through dataframes. So here we have 2 options, a.) either just leave the code in SparkPositionDeltaWrite as is, and address the tests in the SQL conf PR or b.) we just table the change for SparkPositionDelta for the SQL PR. My thinking is favoring option b, we shouldn't be merging any changes without test coverage there. Then this PR just focuses on coverage of all the dataframe write operations, which my PR above does address the remainder.\r\n> \r\n> 2.) Behavior of createOrReplaceTable when the branch write option is passed in. Say for example a user does the following:\r\n> \r\n> ```\r\n> data.writeTo(\"prod.db.table\")\r\n>     .tableProperty(\"write.format.default\", \"orc\")\r\n>     .partitionedBy($\"level\", days($\"ts\"))\r\n>    .writeOption(SparkWriteOption.BRANCH, \"branch\")\r\n>     .createOrReplace()\r\n> ```\r\n> \r\n> What should the desired behavior be? Currently what happens is the write will be performed on branch and then if it's a replace the main table state will stay the same. So the `replace` loses its meaning. Another possible desired behavior is the branch is written to and replace will actually perform a replace branch to replace the head of main with the head of the target branch. This is what makes sense to me but I think it'll be hard to achieve this based on catalog/planner abstractions.\r\n> \r\n> My thinking for this is we ideally prevent create/replace when there's a write option present just to avoid any confusion. If this isn't achievable then we should document it as a caveat on the behavior of the write option.\r\n> \r\n> Thoughts @namrathamyske @jackye1995 @aokolnychyi @rdblue ?\r\n\r\nMy suggestion would be to document this as a behavior as preventing createOrReplace() when options are passed is going to be tricky. Preventing would not make sense as creating a new table and writing to a new ref must be allowed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428913668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428923240","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1428923240","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1428923240,"node_id":"IC_kwDOCW7NX85VK6No","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T00:39:19Z","updated_at":"2023-02-14T00:46:47Z","author_association":"CONTRIBUTOR","body":"Sure if it's difficult we can just document the caveat until we have a good path forward but my point is specifically on `replace` not `create` (whatever behavior we want would have to be in the `createOrReplace` path). @namrathamyske we can take up what are your thoughts on what the desired behavior of `replace` + specifying a branch option in a separate issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428923240/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428952593","html_url":"https://github.com/apache/iceberg/pull/6599#issuecomment-1428952593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6599","id":1428952593,"node_id":"IC_kwDOCW7NX85VLBYR","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T01:12:54Z","updated_at":"2023-02-14T01:12:54Z","author_association":"CONTRIBUTOR","body":"@rdblue, could you rebase? I can review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428952593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428958060","html_url":"https://github.com/apache/iceberg/pull/6818#issuecomment-1428958060","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6818","id":1428958060,"node_id":"IC_kwDOCW7NX85VLCts","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T01:18:30Z","updated_at":"2023-02-14T01:18:50Z","author_association":"CONTRIBUTOR","body":"The fix seems correct to me. Nothing to add to Russell's comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1428958060/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429060343","html_url":"https://github.com/apache/iceberg/issues/6809#issuecomment-1429060343","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6809","id":1429060343,"node_id":"IC_kwDOCW7NX85VLbr3","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T03:31:00Z","updated_at":"2023-02-14T03:31:00Z","author_association":"CONTRIBUTOR","body":"If this PR was added, I think it would be better to declare it to tell users that all added paths should follow POSIX compliant paths? Even though we have normalized it internally.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429060343/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429097423","html_url":"https://github.com/apache/iceberg/pull/6823#issuecomment-1429097423","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6823","id":1429097423,"node_id":"IC_kwDOCW7NX85VLkvP","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T04:26:29Z","updated_at":"2023-02-14T04:26:29Z","author_association":"CONTRIBUTOR","body":"Could you add an integration test about this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429097423/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429128924","html_url":"https://github.com/apache/iceberg/pull/6660#issuecomment-1429128924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6660","id":1429128924,"node_id":"IC_kwDOCW7NX85VLsbc","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T05:10:35Z","updated_at":"2023-02-14T05:10:35Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews! @stevenzwu @jackye1995   @hililiwei","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429128924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429166827","html_url":"https://github.com/apache/iceberg/pull/6622#issuecomment-1429166827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6622","id":1429166827,"node_id":"IC_kwDOCW7NX85VL1rr","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T06:01:44Z","updated_at":"2023-02-14T06:01:55Z","author_association":"CONTRIBUTOR","body":"I'll take another look by the end of Wed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429166827/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429377303","html_url":"https://github.com/apache/iceberg/pull/6834#issuecomment-1429377303","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6834","id":1429377303,"node_id":"IC_kwDOCW7NX85VMpEX","user":{"login":"hunter-cloud09","id":53144338,"node_id":"MDQ6VXNlcjUzMTQ0MzM4","avatar_url":"https://avatars.githubusercontent.com/u/53144338?v=4","gravatar_id":"","url":"https://api.github.com/users/hunter-cloud09","html_url":"https://github.com/hunter-cloud09","followers_url":"https://api.github.com/users/hunter-cloud09/followers","following_url":"https://api.github.com/users/hunter-cloud09/following{/other_user}","gists_url":"https://api.github.com/users/hunter-cloud09/gists{/gist_id}","starred_url":"https://api.github.com/users/hunter-cloud09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hunter-cloud09/subscriptions","organizations_url":"https://api.github.com/users/hunter-cloud09/orgs","repos_url":"https://api.github.com/users/hunter-cloud09/repos","events_url":"https://api.github.com/users/hunter-cloud09/events{/privacy}","received_events_url":"https://api.github.com/users/hunter-cloud09/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T09:11:48Z","updated_at":"2023-02-14T09:11:48Z","author_association":"CONTRIBUTOR","body":"@nastra @Fokko thx for your review, This problem is only encountered when I use it. I will check the features of TableScan later, and then add it to IcebergGenerics.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429377303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429458376","html_url":"https://github.com/apache/iceberg/issues/4996#issuecomment-1429458376","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4996","id":1429458376,"node_id":"IC_kwDOCW7NX85VM83I","user":{"login":"humengyu2012","id":45056332,"node_id":"MDQ6VXNlcjQ1MDU2MzMy","avatar_url":"https://avatars.githubusercontent.com/u/45056332?v=4","gravatar_id":"","url":"https://api.github.com/users/humengyu2012","html_url":"https://github.com/humengyu2012","followers_url":"https://api.github.com/users/humengyu2012/followers","following_url":"https://api.github.com/users/humengyu2012/following{/other_user}","gists_url":"https://api.github.com/users/humengyu2012/gists{/gist_id}","starred_url":"https://api.github.com/users/humengyu2012/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/humengyu2012/subscriptions","organizations_url":"https://api.github.com/users/humengyu2012/orgs","repos_url":"https://api.github.com/users/humengyu2012/repos","events_url":"https://api.github.com/users/humengyu2012/events{/privacy}","received_events_url":"https://api.github.com/users/humengyu2012/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T10:05:25Z","updated_at":"2023-02-14T10:05:25Z","author_association":"NONE","body":"Is there any recent progress on this issue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429458376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429660556","html_url":"https://github.com/apache/iceberg/pull/6823#issuecomment-1429660556","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6823","id":1429660556,"node_id":"IC_kwDOCW7NX85VNuOM","user":{"login":"munendrasn","id":9696252,"node_id":"MDQ6VXNlcjk2OTYyNTI=","avatar_url":"https://avatars.githubusercontent.com/u/9696252?v=4","gravatar_id":"","url":"https://api.github.com/users/munendrasn","html_url":"https://github.com/munendrasn","followers_url":"https://api.github.com/users/munendrasn/followers","following_url":"https://api.github.com/users/munendrasn/following{/other_user}","gists_url":"https://api.github.com/users/munendrasn/gists{/gist_id}","starred_url":"https://api.github.com/users/munendrasn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/munendrasn/subscriptions","organizations_url":"https://api.github.com/users/munendrasn/orgs","repos_url":"https://api.github.com/users/munendrasn/repos","events_url":"https://api.github.com/users/munendrasn/events{/privacy}","received_events_url":"https://api.github.com/users/munendrasn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T12:20:31Z","updated_at":"2023-02-14T12:21:28Z","author_association":"CONTRIBUTOR","body":"I thought of updating this [test](https://github.com/apache/iceberg/blob/ef7e20e12eae2638015ff91b3356eb2f32f601cc/aws/src/integration/java/org/apache/iceberg/aws/dynamodb/TestDynamoDbCatalog.java#L213) to create more tables, and validate the change.\r\n\r\nAs DynamoDb Query reads max 1MB of data (when limit is not specified), need to create large number of tables (~10K with current setup) to reproduce the issue. Please let me know if I should go ahead update  number of tables to higher number in the tests, or please suggest if there are any alternatives ways to test it\r\n\r\nLocally,  I could verify the fix by adding `limit` parameter to the query request and then calling listTables on DynamoDb with & w/o the fix","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429660556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429959380","html_url":"https://github.com/apache/iceberg/pull/5029#issuecomment-1429959380","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5029","id":1429959380,"node_id":"IC_kwDOCW7NX85VO3LU","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T15:44:37Z","updated_at":"2023-02-14T15:44:37Z","author_association":"CONTRIBUTOR","body":"Looks like all comments are addressed and we have enough votes, thanks for the work @hililiwei , and thanks for the review @stevenzwu and @amogh-jahagirdar !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1429959380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430039299","html_url":"https://github.com/apache/iceberg/pull/6807#issuecomment-1430039299","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6807","id":1430039299,"node_id":"IC_kwDOCW7NX85VPKsD","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T16:34:27Z","updated_at":"2023-02-14T16:34:27Z","author_association":"CONTRIBUTOR","body":"Restart CI","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430039299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430196960","html_url":"https://github.com/apache/iceberg/pull/6797#issuecomment-1430196960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6797","id":1430196960,"node_id":"IC_kwDOCW7NX85VPxLg","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T18:34:22Z","updated_at":"2023-02-14T18:34:22Z","author_association":"COLLABORATOR","body":"I think offline, @dramaticlly found that this value being set correctly on snapshot depends on flag : snapshotIdInheritanceEnabled being false. \r\n\r\nI guess we should doc this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430196960/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430204345","html_url":"https://github.com/apache/iceberg/pull/6797#issuecomment-1430204345","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6797","id":1430204345,"node_id":"IC_kwDOCW7NX85VPy-5","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T18:38:14Z","updated_at":"2023-02-14T18:38:14Z","author_association":"CONTRIBUTOR","body":"> I think offline, @dramaticlly found that this value being set correctly on snapshot depends on flag : snapshotIdInheritanceEnabled being false.\r\n> \r\n> I guess we should doc this.\r\n\r\nThank you @szehon-ho to bring this up. Shall we update the docs inline or somewhere on public facing documents such as https://github.com/apache/iceberg/blob/694bc3038bcf2c8e5c4053fc31a5c784c9366da3/docs/spark-procedures.md#add_files?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430204345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430209452","html_url":"https://github.com/apache/iceberg/pull/6797#issuecomment-1430209452","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6797","id":1430209452,"node_id":"IC_kwDOCW7NX85VP0Os","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T18:42:15Z","updated_at":"2023-02-14T18:42:15Z","author_association":"COLLABORATOR","body":"I was initially thinking, we could have had SparkTableUtil.importPartitions return the number of changed partitions (and number added data files for that matter).  But then we'd have to change the public API for return type, which means add a new one, and is ugly.  Not sure its worth it for now.\r\n\r\n> Shall we update the docs inline or somewhere on public facing documents such as https://github.com/apache/iceberg/blob/694bc3038bcf2c8e5c4053fc31a5c784c9366da3/docs/spark-procedures.md#add_files?\r\n\r\nI think we can put it in the public docs in separate pr.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430209452/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430227520","html_url":"https://github.com/apache/iceberg/pull/6797#issuecomment-1430227520","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6797","id":1430227520,"node_id":"IC_kwDOCW7NX85VP4pA","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T18:53:56Z","updated_at":"2023-02-14T18:53:56Z","author_association":"MEMBER","body":"For the statics you need to call them out specifically in our checkstyle","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430227520/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430230556","html_url":"https://github.com/apache/iceberg/pull/6797#issuecomment-1430230556","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6797","id":1430230556,"node_id":"IC_kwDOCW7NX85VP5Yc","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T18:56:44Z","updated_at":"2023-02-14T18:56:44Z","author_association":"CONTRIBUTOR","body":"> For the statics you need to call them out specifically in our checkstyle\r\n\r\nyou will not hate me if I move to temp var instead, right? 😛 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430230556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430231968","html_url":"https://github.com/apache/iceberg/pull/6735#issuecomment-1430231968","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6735","id":1430231968,"node_id":"IC_kwDOCW7NX85VP5ug","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T18:57:50Z","updated_at":"2023-02-14T18:57:50Z","author_association":"CONTRIBUTOR","body":"Thanks for the work, and thanks for the review @yyanyy !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430231968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430239347","html_url":"https://github.com/apache/iceberg/pull/6823#issuecomment-1430239347","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6823","id":1430239347,"node_id":"IC_kwDOCW7NX85VP7hz","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T19:03:26Z","updated_at":"2023-02-14T19:03:26Z","author_association":"CONTRIBUTOR","body":"+1 for adding some more AWS integration tests specifically focused on scale testing ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430239347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430283445","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1430283445","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1430283445,"node_id":"IC_kwDOCW7NX85VQGS1","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T19:41:57Z","updated_at":"2023-02-14T19:41:57Z","author_association":"COLLABORATOR","body":"Hi @ludlows , im not too familiar with Spark side , but wondering , doesnt the RewriteDataFiles procedure already do a check to skip if there are no matching data files?  Ref:  https://github.com/apache/iceberg/blob/master/spark/v3.3/spark/src/main/java/org/apache/iceberg/spark/actions/RewriteDataFilesSparkAction.java#L177   Not sure if we have a huge savings?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430283445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430346733","html_url":"https://github.com/apache/iceberg/pull/6797#issuecomment-1430346733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6797","id":1430346733,"node_id":"IC_kwDOCW7NX85VQVvt","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T20:41:02Z","updated_at":"2023-02-14T20:41:02Z","author_association":"CONTRIBUTOR","body":"Cannot seem to figure out why java CI failed me on checkstyle in https://github.com/apache/iceberg/actions/runs/4177103910/jobs/7234259536. My local gradle run suggested checkstyle is ok. So I am rebase from latest remote, merge 3 commits into 1 and force push to trigger another CI execution","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430346733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430347268","html_url":"https://github.com/apache/iceberg/pull/6672#issuecomment-1430347268","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6672","id":1430347268,"node_id":"IC_kwDOCW7NX85VQV4E","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T20:41:36Z","updated_at":"2023-02-14T20:41:36Z","author_association":"MEMBER","body":"I still think, that a OpenAPI specification, if it exists, should technically match the implementation and vice versa. But that's actually not the case at the moment and code generation is not possible (commented [here](https://github.com/apache/iceberg/pull/6701#issuecomment-1414201166)).\r\n\r\nThere is no good JAX-RS Java code generator out there, but the ones available for node and python seem to work reasonably well.\r\n\r\nBasically all projects that have an OpenAPI spec do publish it at least along with their published artifacts and/or via platforms like swagger-hub, from which others can take it or inspect it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430347268/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430363718","html_url":"https://github.com/apache/iceberg/issues/6798#issuecomment-1430363718","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6798","id":1430363718,"node_id":"IC_kwDOCW7NX85VQZ5G","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T20:54:52Z","updated_at":"2023-02-14T20:54:52Z","author_association":"CONTRIBUTOR","body":"@haizhou-zhao Thanks again for the elaborate response.\r\n\r\nI don't think the open-API spec is incorrect, but the generated code isn't smart enough to handle the complexity of the spec. We validate the spec in the CI when it is changed in a PR, so it is technically correct, but the issue here is that the code was written first, and then it was encapsulated in the spec.\r\n\r\n> Finally, since we talked about potentially correct the OpenAPI spec, I'd like to learn more about the \"endeavor\" we need to take to update it.\r\n\r\nLet me give an example. The open-API spec also describes the Iceberg schema, and here we have the issue of the primitive (`\"string\"`), and complex types (`{\"type\": \"list\", \"element-id\": 3, \"element-required\": true, \"element\": \"string\"}`). To make use of the generated code, would need to change the type to always be a dictionary instead of a plain string (at least this was one of the issues I bumped into with PyIceberg). These schemas live everywhere, for example, they are encoded in the metadata and the parquet metadata. If we would change this in an incompatible way then older readers won't be able to read newer files (because they don't understand `{\"type\": \"string\"}`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430363718/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430437688","html_url":"https://github.com/apache/iceberg/pull/6807#issuecomment-1430437688","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6807","id":1430437688,"node_id":"IC_kwDOCW7NX85VQr84","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T22:06:09Z","updated_at":"2023-02-14T22:06:09Z","author_association":"CONTRIBUTOR","body":"Looks like we have all comments addressed, I will go ahead to merge the PR. Thanks for the contribution @hililiwei , and thanks for everyone's review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430437688/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430547146","html_url":"https://github.com/apache/iceberg/pull/6797#issuecomment-1430547146","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6797","id":1430547146,"node_id":"IC_kwDOCW7NX85VRGrK","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-14T23:56:20Z","updated_at":"2023-02-14T23:56:20Z","author_association":"MEMBER","body":"Thanks @dramaticlly ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430547146/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430563888","html_url":"https://github.com/apache/iceberg/issues/5556#issuecomment-1430563888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5556","id":1430563888,"node_id":"IC_kwDOCW7NX85VRKww","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T00:13:03Z","updated_at":"2023-02-15T00:13:03Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430563888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430563973","html_url":"https://github.com/apache/iceberg/issues/5397#issuecomment-1430563973","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5397","id":1430563973,"node_id":"IC_kwDOCW7NX85VRKyF","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T00:13:10Z","updated_at":"2023-02-15T00:13:10Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430563973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430592821","html_url":"https://github.com/apache/iceberg/pull/6839#issuecomment-1430592821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6839","id":1430592821,"node_id":"IC_kwDOCW7NX85VRR01","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T00:47:46Z","updated_at":"2023-02-15T00:47:46Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi  @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430592821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430593707","html_url":"https://github.com/apache/iceberg/issues/6798#issuecomment-1430593707","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6798","id":1430593707,"node_id":"IC_kwDOCW7NX85VRSCr","user":{"login":"haizhou-zhao","id":6187287,"node_id":"MDQ6VXNlcjYxODcyODc=","avatar_url":"https://avatars.githubusercontent.com/u/6187287?v=4","gravatar_id":"","url":"https://api.github.com/users/haizhou-zhao","html_url":"https://github.com/haizhou-zhao","followers_url":"https://api.github.com/users/haizhou-zhao/followers","following_url":"https://api.github.com/users/haizhou-zhao/following{/other_user}","gists_url":"https://api.github.com/users/haizhou-zhao/gists{/gist_id}","starred_url":"https://api.github.com/users/haizhou-zhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haizhou-zhao/subscriptions","organizations_url":"https://api.github.com/users/haizhou-zhao/orgs","repos_url":"https://api.github.com/users/haizhou-zhao/repos","events_url":"https://api.github.com/users/haizhou-zhao/events{/privacy}","received_events_url":"https://api.github.com/users/haizhou-zhao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T00:49:11Z","updated_at":"2023-02-15T00:49:11Z","author_association":"CONTRIBUTOR","body":"@Fokko thanks for the explanation and your patience. I might be asking many rudimental questions as I'm new to this section of the code base. I see what you meant by the existing OpenAPI spec is just not complex enough to handle all the scenarios. I apologize if I talk too much from the perspective of java, as I haven't played around too much with Iceberg's python or other language APIs.\r\n\r\nPerhaps taking a step back, my initial question was out of the assumption that currently there're **two sets of models co-existing**:\r\n1. the set of models that were written in pure Java inside the iceberg-core library - e.g. [Schema](https://github.com/apache/iceberg/blob/master/api/src/main/java/org/apache/iceberg/Schema.java)\r\n2. the set of models that could be generated from OpenAPI definition - e.g. [Schema](https://github.com/apache/iceberg/blob/master/open-api/rest-catalog-open-api.yaml#L1075)\r\n\r\nI believe the first set of models are used by [Iceberg Catalog](https://github.com/apache/iceberg/blob/master/api/src/main/java/org/apache/iceberg/catalog/Catalog.java), and the second set of models are used by the \"Rest Catalog Services\" (who implements the open API spec).\r\n\r\nLet me know if my assumption is correct so far, cause my later statements/questions are based on them.\r\n\r\nNow, I summarize my questions on rest service models and spec into these **2 questions**:\r\n\r\n1. Is there any existing (model) converter/adapter to convert the Rest Service's model, for example, \"`LoadTableResponse`\" (of generated model, set 2 ^) to \"Table\" (of the existing pure java code based model, set 1 ^), in a [\"getTable\"](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/rest/RESTCatalog.java#L93) call initiated by RestCatalog?\r\n2. Is there any future plan to converge the two sets of models?\r\n--------------------------\r\nSome investigation and thoughts I had on the questions above:\r\nOn Q1: I found this part of [RESTSessionCatalog](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/rest/RESTSessionCatalog.java#L269) might be related to \"converting/adapting\" RestService's LoadTableResponse. To my reading, it looks like the code here is assuming that the rest service will return an object of [`LoadTableResponse.class`](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/rest/responses/LoadTableResponse.java)? But shouldn't the rest service return an object named [`LoadTableResponse`](https://github.com/apache/iceberg/blob/master/open-api/rest-catalog-open-api.yaml#L2310) as defined by OpenAPI? To me, it doesn't look like the two different `LoadTableResponse`s have the same layout, and can be directly de/serialized into one another.\r\n\r\n\r\nOn Q2: I understand your point that there needs to be two sets of model so that we could maintain backward compatibility for the existing Tables (metadata, snapshots, etc.)? Conceptually, if we technically have a way to merge these two sets of models (which are conceptually for the same purpose), then would it make things easier by eliminating the need of an \"converter/adapter\" between the 2?\r\n\r\nAgain, thx for your patience reading through my insanely long post.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430593707/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430636016","html_url":"https://github.com/apache/iceberg/issues/6708#issuecomment-1430636016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6708","id":1430636016,"node_id":"IC_kwDOCW7NX85VRcXw","user":{"login":"zhangjiuyang1993","id":23301932,"node_id":"MDQ6VXNlcjIzMzAxOTMy","avatar_url":"https://avatars.githubusercontent.com/u/23301932?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjiuyang1993","html_url":"https://github.com/zhangjiuyang1993","followers_url":"https://api.github.com/users/zhangjiuyang1993/followers","following_url":"https://api.github.com/users/zhangjiuyang1993/following{/other_user}","gists_url":"https://api.github.com/users/zhangjiuyang1993/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjiuyang1993/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjiuyang1993/subscriptions","organizations_url":"https://api.github.com/users/zhangjiuyang1993/orgs","repos_url":"https://api.github.com/users/zhangjiuyang1993/repos","events_url":"https://api.github.com/users/zhangjiuyang1993/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjiuyang1993/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T01:47:35Z","updated_at":"2023-02-15T01:47:35Z","author_association":"NONE","body":"It works. Thanks a lot.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430636016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430815671","html_url":"https://github.com/apache/iceberg/pull/6807#issuecomment-1430815671","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6807","id":1430815671,"node_id":"IC_kwDOCW7NX85VSIO3","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T06:24:32Z","updated_at":"2023-02-15T06:24:32Z","author_association":"CONTRIBUTOR","body":"Thank you all for review 😄 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430815671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430817430","html_url":"https://github.com/apache/iceberg/pull/5029#issuecomment-1430817430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5029","id":1430817430,"node_id":"IC_kwDOCW7NX85VSIqW","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T06:25:40Z","updated_at":"2023-02-15T06:25:40Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @jackye1995 @stevenzwu @amogh-jahagirdar ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430817430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430853338","html_url":"https://github.com/apache/iceberg/pull/6834#issuecomment-1430853338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6834","id":1430853338,"node_id":"IC_kwDOCW7NX85VSRba","user":{"login":"hunter-cloud09","id":53144338,"node_id":"MDQ6VXNlcjUzMTQ0MzM4","avatar_url":"https://avatars.githubusercontent.com/u/53144338?v=4","gravatar_id":"","url":"https://api.github.com/users/hunter-cloud09","html_url":"https://github.com/hunter-cloud09","followers_url":"https://api.github.com/users/hunter-cloud09/followers","following_url":"https://api.github.com/users/hunter-cloud09/following{/other_user}","gists_url":"https://api.github.com/users/hunter-cloud09/gists{/gist_id}","starred_url":"https://api.github.com/users/hunter-cloud09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hunter-cloud09/subscriptions","organizations_url":"https://api.github.com/users/hunter-cloud09/orgs","repos_url":"https://api.github.com/users/hunter-cloud09/repos","events_url":"https://api.github.com/users/hunter-cloud09/events{/privacy}","received_events_url":"https://api.github.com/users/hunter-cloud09/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T07:03:33Z","updated_at":"2023-02-15T07:03:33Z","author_association":"CONTRIBUTOR","body":"> LGTM.\r\n> \r\n> PR title can be \"Data: Add a select interface with collections for IcebergGenerics\"\r\n\r\nGet It!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430853338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430868859","html_url":"https://github.com/apache/iceberg/issues/6708#issuecomment-1430868859","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6708","id":1430868859,"node_id":"IC_kwDOCW7NX85VSVN7","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T07:21:52Z","updated_at":"2023-02-15T07:21:52Z","author_association":"CONTRIBUTOR","body":"@zhangjiuyang1993 glad it works for you now. I'm going to close this then.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430868859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430896517","html_url":"https://github.com/apache/iceberg/pull/6837#issuecomment-1430896517","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6837","id":1430896517,"node_id":"IC_kwDOCW7NX85VSb-F","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T07:54:34Z","updated_at":"2023-02-15T07:54:34Z","author_association":"CONTRIBUTOR","body":"/cc @bryanck ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1430896517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431013416","html_url":"https://github.com/apache/iceberg/pull/6646#issuecomment-1431013416","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6646","id":1431013416,"node_id":"IC_kwDOCW7NX85VS4go","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T09:32:00Z","updated_at":"2023-02-15T09:32:00Z","author_association":"CONTRIBUTOR","body":"Merging this, thanks for the awesome work @arminnajafi! And thanks @jackye1995 @JonasJ-ap for the reviews, much appreciated!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431013416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431047119","html_url":"https://github.com/apache/iceberg/pull/6834#issuecomment-1431047119","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6834","id":1431047119,"node_id":"IC_kwDOCW7NX85VTAvP","user":{"login":"hunter-cloud09","id":53144338,"node_id":"MDQ6VXNlcjUzMTQ0MzM4","avatar_url":"https://avatars.githubusercontent.com/u/53144338?v=4","gravatar_id":"","url":"https://api.github.com/users/hunter-cloud09","html_url":"https://github.com/hunter-cloud09","followers_url":"https://api.github.com/users/hunter-cloud09/followers","following_url":"https://api.github.com/users/hunter-cloud09/following{/other_user}","gists_url":"https://api.github.com/users/hunter-cloud09/gists{/gist_id}","starred_url":"https://api.github.com/users/hunter-cloud09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hunter-cloud09/subscriptions","organizations_url":"https://api.github.com/users/hunter-cloud09/orgs","repos_url":"https://api.github.com/users/hunter-cloud09/repos","events_url":"https://api.github.com/users/hunter-cloud09/events{/privacy}","received_events_url":"https://api.github.com/users/hunter-cloud09/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T09:58:19Z","updated_at":"2023-02-15T09:58:19Z","author_association":"CONTRIBUTOR","body":"@ajantha-bhat Is there anything else I need to do before merging?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431047119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431202106","html_url":"https://github.com/apache/iceberg/pull/6826#issuecomment-1431202106","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6826","id":1431202106,"node_id":"IC_kwDOCW7NX85VTmk6","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T11:22:39Z","updated_at":"2023-02-15T11:22:39Z","author_association":"MEMBER","body":"Rebased to resolve conflict","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431202106/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431247665","html_url":"https://github.com/apache/iceberg/issues/6798#issuecomment-1431247665","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6798","id":1431247665,"node_id":"IC_kwDOCW7NX85VTxsx","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T11:52:22Z","updated_at":"2023-02-15T11:52:22Z","author_association":"CONTRIBUTOR","body":"Feel free to ask any question, even the rudimental ones :)\r\n\r\n> Let me know if my assumption is correct so far, cause my later statements/questions are based on them.\r\n\r\nThis assumption is correct. The Java code is the implementation of the [Iceberg table specification](https://iceberg.apache.org/spec/). And, coincidentally they are the same. I think this is the main reason that changing is difficult we don't want them to diverge.\r\n\r\nThe `RESTSerializers.java` use the TableMetadata (de)serializer from core: https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/rest/RESTSerializers.java#L108-L123\r\n\r\n> Q1: But shouldn't the rest service return an object named [LoadTableResponse](https://github.com/apache/iceberg/blob/master/open-api/rest-catalog-open-api.yaml#L2310) as defined by OpenAPI?\r\n\r\nYou mean `LoadTableResult`? Looking at the spec, I think the author wasn't super consistent with `Response` and `Result`. I think renaming `LoadTableResult` to `LoadTableResponse` in the Open API Spec makes sense to avoid confusion.\r\n\r\n> Q2: On Q2: I understand your point that there needs to be two sets of model so that we could maintain backward compatibility for the existing Tables (metadata, snapshots, etc.)? Conceptually, if we technically have a way to merge these two sets of models (which are conceptually for the same purpose), then would it make things easier by eliminating the need of an \"converter/adapter\" between the 2?\r\n\r\nThe models overlap, but we should probably make this more clear in the docs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431247665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431307623","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1431307623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1431307623,"node_id":"IC_kwDOCW7NX85VUAVn","user":{"login":"ludlows","id":6441333,"node_id":"MDQ6VXNlcjY0NDEzMzM=","avatar_url":"https://avatars.githubusercontent.com/u/6441333?v=4","gravatar_id":"","url":"https://api.github.com/users/ludlows","html_url":"https://github.com/ludlows","followers_url":"https://api.github.com/users/ludlows/followers","following_url":"https://api.github.com/users/ludlows/following{/other_user}","gists_url":"https://api.github.com/users/ludlows/gists{/gist_id}","starred_url":"https://api.github.com/users/ludlows/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ludlows/subscriptions","organizations_url":"https://api.github.com/users/ludlows/orgs","repos_url":"https://api.github.com/users/ludlows/repos","events_url":"https://api.github.com/users/ludlows/events{/privacy}","received_events_url":"https://api.github.com/users/ludlows/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T12:40:56Z","updated_at":"2023-02-15T12:40:56Z","author_association":"CONTRIBUTOR","body":"Hi @szehon-ho , thanks for your comments.\r\nI notice that the procedure `rewrite_data_files` first runs the function `checkAndApplyFilter` just before the `action.execute()`  https://github.com/apache/iceberg/blob/18d45b42b6504c03c71467a91ac5e67c9528f068/spark/v3.3/spark/src/main/java/org/apache/iceberg/spark/procedures/RewriteDataFilesProcedure.java#L120  \r\n\r\nHowever, if the where condition is always false like \r\n`\r\nwhere=>'0=1'\r\n`\r\nthe function `checkAndApplyFilter` will raise an IllegalArgumentException in line below.\r\nhttps://github.com/apache/iceberg/blob/18d45b42b6504c03c71467a91ac5e67c9528f068/spark/v3.3/spark/src/main/java/org/apache/iceberg/spark/procedures/RewriteDataFilesProcedure.java#L136\r\n\r\nto make the sql like `call catalog.system.rewrite_data_files(table=>'hive.tbl', where=>'0=1')` exit without exceptions, I proposed this PR. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431307623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431475158","html_url":"https://github.com/apache/iceberg/pull/4479#issuecomment-1431475158","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4479","id":1431475158,"node_id":"IC_kwDOCW7NX85VUpPW","user":{"login":"cccs-eric","id":56447460,"node_id":"MDQ6VXNlcjU2NDQ3NDYw","avatar_url":"https://avatars.githubusercontent.com/u/56447460?v=4","gravatar_id":"","url":"https://api.github.com/users/cccs-eric","html_url":"https://github.com/cccs-eric","followers_url":"https://api.github.com/users/cccs-eric/followers","following_url":"https://api.github.com/users/cccs-eric/following{/other_user}","gists_url":"https://api.github.com/users/cccs-eric/gists{/gist_id}","starred_url":"https://api.github.com/users/cccs-eric/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cccs-eric/subscriptions","organizations_url":"https://api.github.com/users/cccs-eric/orgs","repos_url":"https://api.github.com/users/cccs-eric/repos","events_url":"https://api.github.com/users/cccs-eric/events{/privacy}","received_events_url":"https://api.github.com/users/cccs-eric/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T14:40:00Z","updated_at":"2023-02-15T14:40:00Z","author_association":"CONTRIBUTOR","body":"@singhpk234 This would be a very useful feature for us, thanks for the contribution!  Do you have any plan on finishing the work and addressing @jackye1995 's comments?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431475158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431518741","html_url":"https://github.com/apache/iceberg/issues/6800#issuecomment-1431518741","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6800","id":1431518741,"node_id":"IC_kwDOCW7NX85VUz4V","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T15:08:09Z","updated_at":"2023-02-15T15:08:09Z","author_association":"CONTRIBUTOR","body":"Sorry for the late reply @xuzhiwen1255 but yes if any file is no longer tracked by the current Iceberg metadata tree it will be considered as an orphan file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431518741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431588400","html_url":"https://github.com/apache/iceberg/pull/6831#issuecomment-1431588400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6831","id":1431588400,"node_id":"IC_kwDOCW7NX85VVE4w","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T15:52:38Z","updated_at":"2023-02-15T15:52:38Z","author_association":"CONTRIBUTOR","body":"@Fokko could you review this one please and also kick off CI?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431588400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431592916","html_url":"https://github.com/apache/iceberg/issues/5608#issuecomment-1431592916","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5608","id":1431592916,"node_id":"IC_kwDOCW7NX85VVF_U","user":{"login":"majidazimi","id":4539660,"node_id":"MDQ6VXNlcjQ1Mzk2NjA=","avatar_url":"https://avatars.githubusercontent.com/u/4539660?v=4","gravatar_id":"","url":"https://api.github.com/users/majidazimi","html_url":"https://github.com/majidazimi","followers_url":"https://api.github.com/users/majidazimi/followers","following_url":"https://api.github.com/users/majidazimi/following{/other_user}","gists_url":"https://api.github.com/users/majidazimi/gists{/gist_id}","starred_url":"https://api.github.com/users/majidazimi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/majidazimi/subscriptions","organizations_url":"https://api.github.com/users/majidazimi/orgs","repos_url":"https://api.github.com/users/majidazimi/repos","events_url":"https://api.github.com/users/majidazimi/events{/privacy}","received_events_url":"https://api.github.com/users/majidazimi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T15:55:45Z","updated_at":"2023-02-15T15:55:45Z","author_association":"NONE","body":"@chajath Did you manage to configure this work with instance profile based credentials (like IRSA on k8s)? The only way for me is to implement `AwsClientFactory` and provide custom client factory. I don't find any solution to configure Glue client to use IRSA.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431592916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431641802","html_url":"https://github.com/apache/iceberg/issues/6840#issuecomment-1431641802","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6840","id":1431641802,"node_id":"IC_kwDOCW7NX85VVR7K","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T16:27:44Z","updated_at":"2023-02-15T16:27:44Z","author_association":"MEMBER","body":"We will.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431641802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431685336","html_url":"https://github.com/apache/iceberg/pull/6842#issuecomment-1431685336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6842","id":1431685336,"node_id":"IC_kwDOCW7NX85VVcjY","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T16:58:22Z","updated_at":"2023-02-15T16:58:22Z","author_association":"CONTRIBUTOR","body":"Thanks for the review @jackye1995 @arminnajafi and @singhpk234 👍🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431685336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431807889","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1431807889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1431807889,"node_id":"IC_kwDOCW7NX85VV6eR","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T18:16:16Z","updated_at":"2023-02-15T18:16:16Z","author_association":"COLLABORATOR","body":"Thanks for explanation, problem now makes sense to me.  To me, maybe modifying the original method to return a Option will be cleaner ?\r\n\r\nBut I think it will be nice for  @aokolnychyi , @rdblue to take a look as well, as they are more familiar with Spark side","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431807889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431825613","html_url":"https://github.com/apache/iceberg/pull/6818#issuecomment-1431825613","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6818","id":1431825613,"node_id":"IC_kwDOCW7NX85VV-zN","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T18:30:28Z","updated_at":"2023-02-15T18:30:28Z","author_association":"CONTRIBUTOR","body":"thank you @RussellSpitzer , I didn't realize it was also related to when `SNAPSHOT_ID_INHERITANCE_ENABLED` is set to true, where manifests didn't get rewritten with explicit snapshot ids  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431825613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431831930","html_url":"https://github.com/apache/iceberg/pull/6818#issuecomment-1431831930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6818","id":1431831930,"node_id":"IC_kwDOCW7NX85VWAV6","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T18:35:54Z","updated_at":"2023-02-15T18:35:54Z","author_association":"CONTRIBUTOR","body":"> thank you @RussellSpitzer , I didn't realize it was also related to when `SNAPSHOT_ID_INHERITANCE_ENABLED` is set to true, where manifests didn't get rewritten with explicit snapshot ids\r\n\r\n@dramaticlly \r\nyes, it only affects when the flag is true. Its mentioned in the reproduce steps in https://github.com/apache/iceberg/issues/6817","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431831930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431836609","html_url":"https://github.com/apache/iceberg/pull/3249#issuecomment-1431836609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3249","id":1431836609,"node_id":"IC_kwDOCW7NX85VWBfB","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T18:39:39Z","updated_at":"2023-02-15T18:39:39Z","author_association":"CONTRIBUTOR","body":"This PR has been open for quite a long time, I will take a look today to keep this going.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431836609/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431837930","html_url":"https://github.com/apache/iceberg/pull/6818#issuecomment-1431837930","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6818","id":1431837930,"node_id":"IC_kwDOCW7NX85VWBzq","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T18:40:46Z","updated_at":"2023-02-15T18:40:46Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer  Thanks, I removed the spark 3.2 changes. will create a separate pr","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431837930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431875415","html_url":"https://github.com/apache/iceberg/pull/6846#issuecomment-1431875415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6846","id":1431875415,"node_id":"IC_kwDOCW7NX85VWK9X","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T19:08:36Z","updated_at":"2023-02-15T19:08:36Z","author_association":"CONTRIBUTOR","body":"For backport do you want to put everything together in single PR? I guess #6845 and #6846 can merge into one since they are almost identical ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431875415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431881063","html_url":"https://github.com/apache/iceberg/pull/6847#issuecomment-1431881063","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6847","id":1431881063,"node_id":"IC_kwDOCW7NX85VWMVn","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T19:13:08Z","updated_at":"2023-02-15T19:13:08Z","author_association":"CONTRIBUTOR","body":"@dramaticlly That will work as well 👍🏻 If the region isn't given explicitly, it will look for the config file and the environment variables as expected.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431881063/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431885827","html_url":"https://github.com/apache/iceberg/pull/6846#issuecomment-1431885827","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6846","id":1431885827,"node_id":"IC_kwDOCW7NX85VWNgD","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T19:15:39Z","updated_at":"2023-02-15T19:17:49Z","author_association":"CONTRIBUTOR","body":"@dramaticlly  I want to leave them separate as they are already created and I think its cleaner to have a pr per spark version","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431885827/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431888867","html_url":"https://github.com/apache/iceberg/pull/6846#issuecomment-1431888867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6846","id":1431888867,"node_id":"IC_kwDOCW7NX85VWOPj","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T19:18:06Z","updated_at":"2023-02-15T19:18:06Z","author_association":"CONTRIBUTOR","body":"> @dramaticlly I want to leave them separate as they are already created.\r\n\r\nI do see some [3.1 change](https://github.com/apache/iceberg/pull/6845/files#diff-af2bc22256d817e0027ad2ef2a3fc73cd25bc94083a0da3c1bad0039ed2170af) in 3.2 PR #6845 . I feel like we shall close this and move all to that and maybe update the title to be more self-explanatory. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431888867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431890064","html_url":"https://github.com/apache/iceberg/pull/6846#issuecomment-1431890064","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6846","id":1431890064,"node_id":"IC_kwDOCW7NX85VWOiQ","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T19:19:03Z","updated_at":"2023-02-15T19:19:03Z","author_association":"CONTRIBUTOR","body":"3.1 change was not intended in that pr, I cleaned it up","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431890064/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431916013","html_url":"https://github.com/apache/iceberg/pull/4479#issuecomment-1431916013","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4479","id":1431916013,"node_id":"IC_kwDOCW7NX85VWU3t","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T19:39:46Z","updated_at":"2023-02-15T19:39:46Z","author_association":"CONTRIBUTOR","body":"> Do you have any plan on finishing the work and addressing @jackye1995 's comments?\r\n\r\n@cccs-eric, definitely will address @jackye1995 's feedback by this week for sure.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1431916013/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432081428","html_url":"https://github.com/apache/iceberg/pull/6801#issuecomment-1432081428","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6801","id":1432081428,"node_id":"IC_kwDOCW7NX85VW9QU","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T21:47:14Z","updated_at":"2023-02-15T21:47:14Z","author_association":"MEMBER","body":"Thanks for the PR @nastra and for help with review @Fokko !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432081428/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432120227","html_url":"https://github.com/apache/iceberg/pull/6838#issuecomment-1432120227","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6838","id":1432120227,"node_id":"IC_kwDOCW7NX85VXGuj","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T22:17:01Z","updated_at":"2023-02-15T22:17:01Z","author_association":"CONTRIBUTOR","body":"Will review today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432120227/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432166680","html_url":"https://github.com/apache/iceberg/pull/6799#issuecomment-1432166680","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6799","id":1432166680,"node_id":"IC_kwDOCW7NX85VXSEY","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-15T22:40:41Z","updated_at":"2023-02-15T22:40:41Z","author_association":"CONTRIBUTOR","body":"@nastra, thank you for your reviews. I have addressed all your feedback. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432166680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432267292","html_url":"https://github.com/apache/iceberg/issues/5567#issuecomment-1432267292","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5567","id":1432267292,"node_id":"IC_kwDOCW7NX85VXqoc","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T00:12:41Z","updated_at":"2023-02-16T00:12:41Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432267292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432267470","html_url":"https://github.com/apache/iceberg/issues/5557#issuecomment-1432267470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5557","id":1432267470,"node_id":"IC_kwDOCW7NX85VXqrO","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T00:12:45Z","updated_at":"2023-02-16T00:12:45Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432267470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432320417","html_url":"https://github.com/apache/iceberg/pull/6851#issuecomment-1432320417","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6851","id":1432320417,"node_id":"IC_kwDOCW7NX85VX3mh","user":{"login":"pritampan","id":28836358,"node_id":"MDQ6VXNlcjI4ODM2MzU4","avatar_url":"https://avatars.githubusercontent.com/u/28836358?v=4","gravatar_id":"","url":"https://api.github.com/users/pritampan","html_url":"https://github.com/pritampan","followers_url":"https://api.github.com/users/pritampan/followers","following_url":"https://api.github.com/users/pritampan/following{/other_user}","gists_url":"https://api.github.com/users/pritampan/gists{/gist_id}","starred_url":"https://api.github.com/users/pritampan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pritampan/subscriptions","organizations_url":"https://api.github.com/users/pritampan/orgs","repos_url":"https://api.github.com/users/pritampan/repos","events_url":"https://api.github.com/users/pritampan/events{/privacy}","received_events_url":"https://api.github.com/users/pritampan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T01:13:55Z","updated_at":"2023-02-16T01:13:55Z","author_association":"CONTRIBUTOR","body":"> Thanks for opening this PR, and I think this is a great addition. Could you rebase against the latest master? Today we had a failing master.\r\n\r\nThanks for reviewing, I have rebased this branch and addressed the comments. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432320417/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432331839","html_url":"https://github.com/apache/iceberg/pull/6742#issuecomment-1432331839","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6742","id":1432331839,"node_id":"IC_kwDOCW7NX85VX6Y_","user":{"login":"theoxu31","id":124402024,"node_id":"U_kgDOB2o5aA","avatar_url":"https://avatars.githubusercontent.com/u/124402024?v=4","gravatar_id":"","url":"https://api.github.com/users/theoxu31","html_url":"https://github.com/theoxu31","followers_url":"https://api.github.com/users/theoxu31/followers","following_url":"https://api.github.com/users/theoxu31/following{/other_user}","gists_url":"https://api.github.com/users/theoxu31/gists{/gist_id}","starred_url":"https://api.github.com/users/theoxu31/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/theoxu31/subscriptions","organizations_url":"https://api.github.com/users/theoxu31/orgs","repos_url":"https://api.github.com/users/theoxu31/repos","events_url":"https://api.github.com/users/theoxu31/events{/privacy}","received_events_url":"https://api.github.com/users/theoxu31/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T01:28:38Z","updated_at":"2023-02-16T01:28:38Z","author_association":"NONE","body":"Resolved comments, pinging people for review @jackye1995 @yabola @amogh-jahagirdar @singhpk234 @rajarshisarkar @aajisaka @JonasJ-ap","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432331839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432517878","html_url":"https://github.com/apache/iceberg/pull/6818#issuecomment-1432517878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6818","id":1432517878,"node_id":"IC_kwDOCW7NX85VYnz2","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T05:05:17Z","updated_at":"2023-02-16T05:05:17Z","author_association":"CONTRIBUTOR","body":"Thanks, @abmo-x! Thanks for reviewing, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432517878/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432520336","html_url":"https://github.com/apache/iceberg/pull/6846#issuecomment-1432520336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6846","id":1432520336,"node_id":"IC_kwDOCW7NX85VYoaQ","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T05:08:36Z","updated_at":"2023-02-16T05:09:02Z","author_association":"CONTRIBUTOR","body":"I see some test failures in 3.1. @abmo-x, could you check if those are related?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432520336/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432521685","html_url":"https://github.com/apache/iceberg/pull/6828#issuecomment-1432521685","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6828","id":1432521685,"node_id":"IC_kwDOCW7NX85VYovV","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T05:10:30Z","updated_at":"2023-02-16T05:10:30Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @RussellSpitzer @jackye1995 @dramaticlly!\r\nLet me cherry-pick this to 3.2.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432521685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432522831","html_url":"https://github.com/apache/iceberg/pull/6838#issuecomment-1432522831","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6838","id":1432522831,"node_id":"IC_kwDOCW7NX85VYpBP","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T05:12:12Z","updated_at":"2023-02-16T05:12:12Z","author_association":"CONTRIBUTOR","body":"@dramaticlly, this one can be rebased now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432522831/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432599230","html_url":"https://github.com/apache/iceberg/issues/6800#issuecomment-1432599230","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6800","id":1432599230,"node_id":"IC_kwDOCW7NX85VY7q-","user":{"login":"xuzhiwen1255","id":105710753,"node_id":"U_kgDOBk0EoQ","avatar_url":"https://avatars.githubusercontent.com/u/105710753?v=4","gravatar_id":"","url":"https://api.github.com/users/xuzhiwen1255","html_url":"https://github.com/xuzhiwen1255","followers_url":"https://api.github.com/users/xuzhiwen1255/followers","following_url":"https://api.github.com/users/xuzhiwen1255/following{/other_user}","gists_url":"https://api.github.com/users/xuzhiwen1255/gists{/gist_id}","starred_url":"https://api.github.com/users/xuzhiwen1255/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xuzhiwen1255/subscriptions","organizations_url":"https://api.github.com/users/xuzhiwen1255/orgs","repos_url":"https://api.github.com/users/xuzhiwen1255/repos","events_url":"https://api.github.com/users/xuzhiwen1255/events{/privacy}","received_events_url":"https://api.github.com/users/xuzhiwen1255/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T06:39:12Z","updated_at":"2023-02-16T06:39:12Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar  thanks, got it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432599230/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432645724","html_url":"https://github.com/apache/iceberg/pull/6834#issuecomment-1432645724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6834","id":1432645724,"node_id":"IC_kwDOCW7NX85VZHBc","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T07:34:47Z","updated_at":"2023-02-16T07:34:47Z","author_association":"CONTRIBUTOR","body":"Thanks @hunter-cloud09 for adding this, and @ajantha-bhat @nastra for the review! 👏🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432645724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432647042","html_url":"https://github.com/apache/iceberg/issues/6832#issuecomment-1432647042","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6832","id":1432647042,"node_id":"IC_kwDOCW7NX85VZHWC","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T07:36:16Z","updated_at":"2023-02-16T07:36:16Z","author_association":"CONTRIBUTOR","body":"Fixed in https://github.com/apache/iceberg/pull/6834","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432647042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432649535","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1432649535","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1432649535,"node_id":"IC_kwDOCW7NX85VZH8_","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T07:39:12Z","updated_at":"2023-02-16T07:39:12Z","author_association":"CONTRIBUTOR","body":"Thanks for raising this @Saranviveka. Could you open up a PR in the Trino Github? Since I think it is more Trino related","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432649535/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432655205","html_url":"https://github.com/apache/iceberg/pull/6854#issuecomment-1432655205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6854","id":1432655205,"node_id":"IC_kwDOCW7NX85VZJVl","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T07:46:05Z","updated_at":"2023-02-16T07:46:05Z","author_association":"CONTRIBUTOR","body":"Thanks @dependabot ! 👏🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432655205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432656125","html_url":"https://github.com/apache/iceberg/pull/6843#issuecomment-1432656125","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6843","id":1432656125,"node_id":"IC_kwDOCW7NX85VZJj9","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T07:47:10Z","updated_at":"2023-02-16T07:47:10Z","author_association":"CONTRIBUTOR","body":"@pritampan keep in mind that the Python Legacy won't be released.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432656125/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432676459","html_url":"https://github.com/apache/iceberg/pull/6851#issuecomment-1432676459","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6851","id":1432676459,"node_id":"IC_kwDOCW7NX85VZOhr","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T08:05:27Z","updated_at":"2023-02-16T08:05:27Z","author_association":"CONTRIBUTOR","body":"Thanks @pritampan for opening this PR and @puchengy for the review! 👏🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432676459/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432867679","html_url":"https://github.com/apache/iceberg/pull/6687#issuecomment-1432867679","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6687","id":1432867679,"node_id":"IC_kwDOCW7NX85VZ9Nf","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T10:31:44Z","updated_at":"2023-02-16T10:31:44Z","author_association":"CONTRIBUTOR","body":"@dependabot rebase","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432867679/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432901683","html_url":"https://github.com/apache/iceberg/pull/6696#issuecomment-1432901683","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6696","id":1432901683,"node_id":"IC_kwDOCW7NX85VaFgz","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T10:58:41Z","updated_at":"2023-02-16T10:58:41Z","author_association":"CONTRIBUTOR","body":"Thanks @ajantha-bhat for bumping Arrow and running the benchmarks. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1432901683/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433095111","html_url":"https://github.com/apache/iceberg/issues/6858#issuecomment-1433095111","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6858","id":1433095111,"node_id":"IC_kwDOCW7NX85Va0vH","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T13:32:59Z","updated_at":"2023-02-16T13:32:59Z","author_association":"CONTRIBUTOR","body":"Hey @fivetran-tusharkumar thanks for reaching out.\r\n\r\nIceberg is designed to do lazy changes. So if you add a column, this will be added to the table schema, but not to all the files. Once you read the files, the new column (that is missing from the Parquet file), will be added and this will be null. Once you rewrite a file, the file that replaces the file will have the new column. The Iceberg schema is optionally stored (some writers, do not write this unfortunately) in the [Parquet metadata](https://parquet.apache.org/docs/file-format/metadata/). Otherwise, you need to reconstruct the Iceberg schema from the Parquet schema that contains the FieldIDs that match with the Iceberg schema.\r\n\r\nFor example, in Iceberg if you rename a column. The old files that are already part of the table won't get rewritten right away but can be rewritten at some point eventually. Using the FieldIDs the columns are looked up, the old files are read with their original column name and then renamed to the new column name.\r\n\r\nTLDR: You need to read the footer of each parquet file to determine the schema.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433095111/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433176701","html_url":"https://github.com/apache/iceberg/pull/6804#issuecomment-1433176701","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6804","id":1433176701,"node_id":"IC_kwDOCW7NX85VbIp9","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T14:30:49Z","updated_at":"2023-02-16T14:30:49Z","author_association":"CONTRIBUTOR","body":"@jrcamp Could you run `./gradlew :iceberg-parquet:spotlessApply` to fix the Spotless violations? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433176701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433226878","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433226878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433226878,"node_id":"IC_kwDOCW7NX85VbU5-","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T15:03:00Z","updated_at":"2023-02-16T15:05:19Z","author_association":"CONTRIBUTOR","body":"I took the time to look into this since it is quite a serious issue, and it seems that Spark has the same issue:\r\n\r\n![image](https://user-images.githubusercontent.com/1134248/219401758-711c0644-6839-4b59-bfcc-fe72abd28957.png)\r\n\r\nThis is also the case when we don't run the additional `ADD PARTITION FIELD` statements. They don't make a lot of sense since it is already partitioned on the `DATE(trans_ts)` which includes the year and month already.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433226878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433336470","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433336470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433336470,"node_id":"IC_kwDOCW7NX85VbvqW","user":{"login":"Saranviveka","id":15131550,"node_id":"MDQ6VXNlcjE1MTMxNTUw","avatar_url":"https://avatars.githubusercontent.com/u/15131550?v=4","gravatar_id":"","url":"https://api.github.com/users/Saranviveka","html_url":"https://github.com/Saranviveka","followers_url":"https://api.github.com/users/Saranviveka/followers","following_url":"https://api.github.com/users/Saranviveka/following{/other_user}","gists_url":"https://api.github.com/users/Saranviveka/gists{/gist_id}","starred_url":"https://api.github.com/users/Saranviveka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Saranviveka/subscriptions","organizations_url":"https://api.github.com/users/Saranviveka/orgs","repos_url":"https://api.github.com/users/Saranviveka/repos","events_url":"https://api.github.com/users/Saranviveka/events{/privacy}","received_events_url":"https://api.github.com/users/Saranviveka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T16:11:13Z","updated_at":"2023-02-16T16:11:13Z","author_association":"NONE","body":"In that case, is it iceberg that has to look in to the issue or the engines ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433336470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433343008","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433343008","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433343008,"node_id":"IC_kwDOCW7NX85VbxQg","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T16:15:39Z","updated_at":"2023-02-16T16:15:39Z","author_association":"CONTRIBUTOR","body":"I think it is Iceberg. I'm wrapping up a project, and then I'm planning to look into this. I suspect that we skip the file somewhere when we evaluate against the statistics and then decide to skip the file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433343008/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433453414","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433453414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433453414,"node_id":"IC_kwDOCW7NX85VcMNm","user":{"login":"Saranviveka","id":15131550,"node_id":"MDQ6VXNlcjE1MTMxNTUw","avatar_url":"https://avatars.githubusercontent.com/u/15131550?v=4","gravatar_id":"","url":"https://api.github.com/users/Saranviveka","html_url":"https://github.com/Saranviveka","followers_url":"https://api.github.com/users/Saranviveka/followers","following_url":"https://api.github.com/users/Saranviveka/following{/other_user}","gists_url":"https://api.github.com/users/Saranviveka/gists{/gist_id}","starred_url":"https://api.github.com/users/Saranviveka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Saranviveka/subscriptions","organizations_url":"https://api.github.com/users/Saranviveka/orgs","repos_url":"https://api.github.com/users/Saranviveka/repos","events_url":"https://api.github.com/users/Saranviveka/events{/privacy}","received_events_url":"https://api.github.com/users/Saranviveka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T17:28:42Z","updated_at":"2023-02-16T17:28:42Z","author_association":"NONE","body":"in addition, though we could create partitions on year, month how exactly do we query it from Trino or Athena. \r\nIn Trino we have to cast it to either date or timestamp. No casting available for year or month or day in those cases what's the point of having those type of partition functions ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433453414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433483721","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433483721","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433483721,"node_id":"IC_kwDOCW7NX85VcTnJ","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T17:52:15Z","updated_at":"2023-02-16T17:52:15Z","author_association":"CONTRIBUTOR","body":"Is this a problem? I think it is correct, although not necessarily intuitive.\r\n\r\nThe filter is `trans_ts=date'2019-06-13'` but the only `trans_ts` in the table is `2019-06-13 17:22:30.000000 UTC`, which is NOT equal to `2019-06-13 00:00:00.000000`.\r\n\r\nI can see how this would be unexpected, because you thought that the timestamp would be converted to a date but instead the date is converted to a timestamp, and then the equals check runs.\r\n\r\nI think this is the same in both Trino and Spark because they both cast values to the wider type. In this case, timestamp rather than date.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433483721/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433490369","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433490369","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433490369,"node_id":"IC_kwDOCW7NX85VcVPB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T17:57:21Z","updated_at":"2023-02-16T17:57:21Z","author_association":"CONTRIBUTOR","body":"@Saranviveka, the partition functions specify the granularity of partitions, not actual values. Partitioning by years breaks data up into year-sized divisions, months into month-sized divisions, etc. You only need the most granular division, which in your case is hours.\r\n\r\nAlso, you don't interact with those values directly. When you filter on your timestamp column, the needed partitions are automatically selected by Iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433490369/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433512431","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433512431","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433512431,"node_id":"IC_kwDOCW7NX85Vcanv","user":{"login":"Saranviveka","id":15131550,"node_id":"MDQ6VXNlcjE1MTMxNTUw","avatar_url":"https://avatars.githubusercontent.com/u/15131550?v=4","gravatar_id":"","url":"https://api.github.com/users/Saranviveka","html_url":"https://github.com/Saranviveka","followers_url":"https://api.github.com/users/Saranviveka/followers","following_url":"https://api.github.com/users/Saranviveka/following{/other_user}","gists_url":"https://api.github.com/users/Saranviveka/gists{/gist_id}","starred_url":"https://api.github.com/users/Saranviveka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Saranviveka/subscriptions","organizations_url":"https://api.github.com/users/Saranviveka/orgs","repos_url":"https://api.github.com/users/Saranviveka/repos","events_url":"https://api.github.com/users/Saranviveka/events{/privacy}","received_events_url":"https://api.github.com/users/Saranviveka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T18:14:13Z","updated_at":"2023-02-16T18:17:22Z","author_association":"NONE","body":"@rdblue  The idea of creating multi level partitions is that when a user queries he or she doesnt need to know how it has been partitioned. Since a partition was created on date based on timestamp, the expectation is that it should match the exact date value without having any timestamps. Consider a business case that I buy a product at 11:05am today dated '2023-02-16' its timestamp would be say for example '2023-02-06 11:05:45'. Even though it is not '2023-02-06 00:00:00' when an analyst tries to query who are and all brought products on '2023-02-06' my record should be displayed if not then its a bug!  \r\n\r\nIdea of creating/specifying date based partition on timestamp is that when a corresponding date is provided without time, end user should get the result. If not then its a flaw. \r\n\r\nI am not expecting that providing a wrong timestamp on the equality should match! But providing a correct date should match. If its not then how it casts and compares has to be rectified and not the business expectation","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433512431/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433573967","html_url":"https://github.com/apache/iceberg/pull/6823#issuecomment-1433573967","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6823","id":1433573967,"node_id":"IC_kwDOCW7NX85VcppP","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T19:00:03Z","updated_at":"2023-02-16T19:00:03Z","author_association":"CONTRIBUTOR","body":"Thanks for the fix! @munendrasn ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433573967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433588781","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433588781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433588781,"node_id":"IC_kwDOCW7NX85VctQt","user":{"login":"Saranviveka","id":15131550,"node_id":"MDQ6VXNlcjE1MTMxNTUw","avatar_url":"https://avatars.githubusercontent.com/u/15131550?v=4","gravatar_id":"","url":"https://api.github.com/users/Saranviveka","html_url":"https://github.com/Saranviveka","followers_url":"https://api.github.com/users/Saranviveka/followers","following_url":"https://api.github.com/users/Saranviveka/following{/other_user}","gists_url":"https://api.github.com/users/Saranviveka/gists{/gist_id}","starred_url":"https://api.github.com/users/Saranviveka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Saranviveka/subscriptions","organizations_url":"https://api.github.com/users/Saranviveka/orgs","repos_url":"https://api.github.com/users/Saranviveka/repos","events_url":"https://api.github.com/users/Saranviveka/events{/privacy}","received_events_url":"https://api.github.com/users/Saranviveka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T19:14:06Z","updated_at":"2023-02-16T20:38:39Z","author_association":"NONE","body":"When we created partitions on date, year and month. on spark we are able to operate on year value and month. But it has to be used in range.\r\n\r\n```\r\nscala> spark.sql(\"\"\"select * from iceberg.catbdsql_glue_catalog.iceberg_table where trans_ts= '2019'  \"\"\").show(false)\r\n+--------+-----------+------------+--------+--------+\r\n|order_id|customer_id|order_amount|category|trans_ts|\r\n+--------+-----------+------------+--------+--------+\r\n+--------+-----------+------------+--------+--------+\r\n\r\nscala> spark.sql(\"\"\"select * from iceberg.catbdsql_glue_catalog.iceberg_table where trans_ts >= '2019' and trans_ts < '2020'  \"\"\").show(false)\r\n+--------+-----------+------------+--------+-------------------+\r\n|order_id|customer_id|order_amount|category|trans_ts           |\r\n+--------+-----------+------------+--------+-------------------+\r\n|10001   |1          |6.17        |soap    |2019-06-13 13:22:30|\r\n+--------+-----------+------------+--------+-------------------+\r\n\r\nscala> spark.sql(\"\"\"select * from iceberg.catbdsql_glue_catalog.iceberg_table where trans_ts >= '2019-06' and trans_ts < '2019-07'  \"\"\").show(false)\r\n+--------+-----------+------------+--------+-------------------+\r\n|order_id|customer_id|order_amount|category|trans_ts           |\r\n+--------+-----------+------------+--------+-------------------+\r\n|10001   |1          |6.17        |soap    |2019-06-13 13:22:30|\r\n+--------+-----------+------------+--------+-------------------+\r\n```\r\n\r\nWhereas on other query engines the same is not possible. As those values are validated against the data type of the field on which we are applying the filter criteria. In addition, some engines require explicit casting upfront for date and timestamp of the values. For those cases, we cant just provide yyyy or yyyy-mm as engine throws errors!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433588781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433594980","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433594980","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433594980,"node_id":"IC_kwDOCW7NX85Vcuxk","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T19:20:13Z","updated_at":"2023-02-16T19:20:25Z","author_association":"CONTRIBUTOR","body":"@Saranviveka I agree that this might be confusing, but I see @rdblue's point. Querying the table can be done using equality using `cast(trans_ts as date) = date '2019-01-13'`, then the widening will be avoided. Keep in mind that this is up to the query engine how to implement this, and Spark and Trino chose to handle it the same way.\r\n\r\n> Idea of creating/specifying date based partition on timestamp is that when a corresponding date is provided without time, end user should get the result.\r\n\r\n[Iceberg Partitions](https://iceberg.apache.org/docs/latest/partitioning/) differ from your traditional Hive partitions. If you do an `hour(trans_ts)` partition then `2019-06-13 13:22:30` will be truncated into `2019-06-13 13:00:00`, and therefore you already have partitioning on a day, month, and year level.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433594980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433602928","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433602928","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433602928,"node_id":"IC_kwDOCW7NX85Vcwtw","user":{"login":"Saranviveka","id":15131550,"node_id":"MDQ6VXNlcjE1MTMxNTUw","avatar_url":"https://avatars.githubusercontent.com/u/15131550?v=4","gravatar_id":"","url":"https://api.github.com/users/Saranviveka","html_url":"https://github.com/Saranviveka","followers_url":"https://api.github.com/users/Saranviveka/followers","following_url":"https://api.github.com/users/Saranviveka/following{/other_user}","gists_url":"https://api.github.com/users/Saranviveka/gists{/gist_id}","starred_url":"https://api.github.com/users/Saranviveka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Saranviveka/subscriptions","organizations_url":"https://api.github.com/users/Saranviveka/orgs","repos_url":"https://api.github.com/users/Saranviveka/repos","events_url":"https://api.github.com/users/Saranviveka/events{/privacy}","received_events_url":"https://api.github.com/users/Saranviveka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T19:27:44Z","updated_at":"2023-02-16T19:27:44Z","author_association":"NONE","body":"@Fokko I agree with you that we can cast the source column to date while casting the filter value. But wouldnt be a costly operation to cast the source column and as well as we have to explicitly let the end user know about these which dissolves the advantage that end user doesnt need to know anything about partitioning.  \r\n\r\nMy question is, Iceberg creates those partition folders with exact value of date when we specify a date partition. In that case how hard for the framework to handle it gracefully rather than expecting the enduser to cast it on the source column ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433602928/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433701127","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433701127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433701127,"node_id":"IC_kwDOCW7NX85VdIsH","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T20:54:08Z","updated_at":"2023-02-16T20:54:08Z","author_association":"CONTRIBUTOR","body":"> But wouldnt be a costly operation to cast the source column and as well as we have to explicitly let the end user know about these which dissolves the advantage that end user doesnt need to know anything about partitioning.\r\n\r\nIceberg should be able to handle this for you but is currently not the case.\r\n\r\n<img width=\"1289\" alt=\"image\" src=\"https://user-images.githubusercontent.com/1134248/219471680-947c1055-40c7-41b0-aa6d-04c5e2afb0c7.png\">\r\n\r\nWe have two rows, in two distinct partitions:\r\n\r\n<img width=\"1289\" alt=\"image\" src=\"https://user-images.githubusercontent.com/1134248/219471881-48554aa8-70e8-4acd-937c-d89d408e49a8.png\">\r\n\r\nWhen I fire up the tracing, we can see that it queries both of the files:\r\n\r\n```\r\n2023-02-16T19:50:59.520 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/metadata/00002-b153fc69-e69b-489d-aff3-49ffede57be9.metadata.json 172.18.0.3        1.45ms       ↑ 169 B ↓ 3.4 KiB\r\n2023-02-16T19:50:59.552 [200 OK] s3.HeadObject minio:9000/warehouse/wh/default/iceberg_table/metadata/snap-8884861716966779118-1-a38366f2-1636-497f-bbaf-d7a81b27d026.avro 172.18.0.5        486µs       ↑ 133 B ↓ 0 B\r\n2023-02-16T19:50:59.556 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/metadata/snap-8884861716966779118-1-a38366f2-1636-497f-bbaf-d7a81b27d026.avro 172.18.0.5        900µs       ↑ 148 B ↓ 4.2 KiB\r\n2023-02-16T19:50:59.565 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/metadata/a38366f2-1636-497f-bbaf-d7a81b27d026-m0.avro 172.18.0.5        895µs       ↑ 148 B ↓ 7.0 KiB\r\n2023-02-16T19:50:59.570 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/metadata/a8e7390e-d67e-42bb-accf-dfe2f8df9885-m0.avro 172.18.0.5        1.241ms      ↑ 148 B ↓ 7.0 KiB\r\n2023-02-16T19:50:59.643 [200 OK] s3.HeadObject minio:9000/warehouse/wh/default/iceberg_table/data/trans_ts_hour%3D2019-06-13-13/00000-0-f46a696b-d858-49cd-bb18-c4d39b3578ab-00001.parquet 172.18.0.5        413µs       ↑ 133 B ↓ 0 B\r\n2023-02-16T19:50:59.646 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/data/trans_ts_hour%3D2019-06-13-13/00000-0-f46a696b-d858-49cd-bb18-c4d39b3578ab-00001.parquet 172.18.0.5        662µs       ↑ 148 B ↓ 8 B\r\n2023-02-16T19:50:59.649 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/data/trans_ts_hour%3D2019-06-13-13/00000-0-f46a696b-d858-49cd-bb18-c4d39b3578ab-00001.parquet 172.18.0.5        1.309ms      ↑ 148 B ↓ 1.1 KiB\r\n2023-02-16T19:50:59.654 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/data/trans_ts_hour%3D2019-06-13-13/00000-0-f46a696b-d858-49cd-bb18-c4d39b3578ab-00001.parquet 172.18.0.5        1.074ms      ↑ 148 B ↓ 1.5 KiB\r\n2023-02-16T19:50:59.684 [200 OK] s3.HeadObject minio:9000/warehouse/wh/default/iceberg_table/data/trans_ts_hour%3D2019-06-14-13/00000-1-07373866-4c83-4e5a-8577-e9aa24acbfc4-00001.parquet 172.18.0.5        552µs       ↑ 133 B ↓ 0 B\r\n2023-02-16T19:50:59.687 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/data/trans_ts_hour%3D2019-06-14-13/00000-1-07373866-4c83-4e5a-8577-e9aa24acbfc4-00001.parquet 172.18.0.5        648µs       ↑ 148 B ↓ 8 B\r\n2023-02-16T19:50:59.690 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/data/trans_ts_hour%3D2019-06-14-13/00000-1-07373866-4c83-4e5a-8577-e9aa24acbfc4-00001.parquet 172.18.0.5        750µs       ↑ 148 B ↓ 1.1 KiB\r\n2023-02-16T19:50:59.694 [206 Partial Content] s3.GetObject minio:9000/warehouse/wh/default/iceberg_table/data/trans_ts_hour%3D2019-06-14-13/00000-1-07373866-4c83-4e5a-8577-e9aa24acbfc4-00001.parquet 172.18.0.5        756µs       ↑ 148 B ↓ 1.5 KiB\r\n```\r\n\r\n> My question is, Iceberg creates those partition folders with exact value of date when we specify a date partition. In that case how hard for the framework to handle it gracefully rather than expecting the enduser to cast it on the source column?\r\n\r\nAgain, this is not up to Iceberg, but up to Spark/Trino/etc on how to do the comparison. See below where the behavior is the same against a plain Spark table. If you want to change this behavior, you should discuss this in the Trino/Spark community.\r\n\r\n<img width=\"1289\" alt=\"image\" src=\"https://user-images.githubusercontent.com/1134248/219484147-20a06e45-3787-41f8-882a-8f1278192ecf.png\">\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433701127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433705057","html_url":"https://github.com/apache/iceberg/pull/6808#issuecomment-1433705057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6808","id":1433705057,"node_id":"IC_kwDOCW7NX85VdJph","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T20:57:37Z","updated_at":"2023-02-16T20:57:37Z","author_association":"CONTRIBUTOR","body":"thanks @hililiwei for reviewing. mergin.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433705057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433718015","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433718015","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433718015,"node_id":"IC_kwDOCW7NX85VdMz_","user":{"login":"Saranviveka","id":15131550,"node_id":"MDQ6VXNlcjE1MTMxNTUw","avatar_url":"https://avatars.githubusercontent.com/u/15131550?v=4","gravatar_id":"","url":"https://api.github.com/users/Saranviveka","html_url":"https://github.com/Saranviveka","followers_url":"https://api.github.com/users/Saranviveka/followers","following_url":"https://api.github.com/users/Saranviveka/following{/other_user}","gists_url":"https://api.github.com/users/Saranviveka/gists{/gist_id}","starred_url":"https://api.github.com/users/Saranviveka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Saranviveka/subscriptions","organizations_url":"https://api.github.com/users/Saranviveka/orgs","repos_url":"https://api.github.com/users/Saranviveka/repos","events_url":"https://api.github.com/users/Saranviveka/events{/privacy}","received_events_url":"https://api.github.com/users/Saranviveka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T21:09:54Z","updated_at":"2023-02-16T21:11:12Z","author_association":"NONE","body":"@Fokko the idea of defining partitions is to reduce our I/O and now based on your inference if it ends up in scanning all the files , then we don't have to lean on creating partitions and directly scan the whole table.\r\n\r\nThis is how the file path looks like\r\niceberg_table/data/order_id_bucket=3/trans_ts_day=2019-06-13/trans_ts_year=2019/trans_ts_month=2019-06/trans_ts_hour=2019-06-13-17/category=soap/00000-0-848b50e9-2f4d-42f0-baf6-fe543a2a4e88-00001.parquet\r\n\r\nIt is evident that the date value is exactly used on the folder hierarchy in that case why it has to be converted to timestamp even when I am casting the value field as date while doing a equality check. Is this specific to query engines or the iceberg ?\r\n\r\ntrino>select * from iceberg.glue_catalog.iceberg_table where trans_ts=date'2019-06-13';\r\n order_id | customer_id | order_amount | category | trans_ts\r\n----------+-------------+--------------+----------+----------\r\n(0 rows)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433718015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433743603","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1433743603","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1433743603,"node_id":"IC_kwDOCW7NX85VdTDz","user":{"login":"Saranviveka","id":15131550,"node_id":"MDQ6VXNlcjE1MTMxNTUw","avatar_url":"https://avatars.githubusercontent.com/u/15131550?v=4","gravatar_id":"","url":"https://api.github.com/users/Saranviveka","html_url":"https://github.com/Saranviveka","followers_url":"https://api.github.com/users/Saranviveka/followers","following_url":"https://api.github.com/users/Saranviveka/following{/other_user}","gists_url":"https://api.github.com/users/Saranviveka/gists{/gist_id}","starred_url":"https://api.github.com/users/Saranviveka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Saranviveka/subscriptions","organizations_url":"https://api.github.com/users/Saranviveka/orgs","repos_url":"https://api.github.com/users/Saranviveka/repos","events_url":"https://api.github.com/users/Saranviveka/events{/privacy}","received_events_url":"https://api.github.com/users/Saranviveka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T21:35:10Z","updated_at":"2023-02-16T21:35:10Z","author_association":"NONE","body":"scala> spark.sql(\"\"\"CREATE TABLE iceberg.glue_catalog.iceberg_table1 ( order_id bigint,\r\n     | customer_id bigint, order_amount DECIMAL(10,2), category string, trans_dt date)\r\n     | USING iceberg\r\n     | location 's3://xxx/glue_catalog/iceberg_table1'\r\n     | PARTITIONED BY (bucket(5, order_id), trans_dt, years(trans_dt))\r\n     | TBLPROPERTIES ('format-version' = '2') \"\"\")\r\n     \r\n scala> spark.sql(\"\"\"ALTER TABLE iceberg.glue_catalog.iceberg_table1 ADD PARTITION FIELD months(trans_dt)  \"\"\")\r\nres29: org.apache.spark.sql.DataFrame = []\r\n\r\nscala> spark.sql(\"\"\"ALTER TABLE iceberg.glue_catalog.iceberg_table1 ADD PARTITION FIELD category \"\"\")\r\nres30: org.apache.spark.sql.DataFrame = []\r\n\r\nscala> spark.sql(\"\"\"\r\n     | INSERT INTO iceberg.glue_catalog.iceberg_table1\r\n     | VALUES\r\n     | ( 10001, 001, 06.17, 'soap', cast('2019-06-13' as date) )\r\n     | \"\"\")\r\nres31: org.apache.spark.sql.DataFrame = []\r\n\r\n\r\n\r\nIf we check the above example, i have defined the trans_dt as a date field and enabled partition on trans_dt, years(trans_dt), months(trans_dt)\r\n\r\nThis is how the file path looks like\r\nglue_catalog/iceberg_table1/data/order_id_bucket=3/trans_dt=2019-06-13/trans_dt_year=2019/trans_dt_month=2019-06/category=soap/00000-6-b4c62154-526d-4782-b9d3-9bd093b550ff-00001.parquet\r\n\r\n\r\nscala> spark.sql(\"\"\"select * from iceberg.glue_catalog.iceberg_table1 where trans_dt= '2019'  \"\"\").show(false)\r\n+--------+-----------+------------+--------+--------+\r\n|order_id|customer_id|order_amount|category|trans_dt|\r\n+--------+-----------+------------+--------+--------+\r\n+--------+-----------+------------+--------+--------+\r\n\r\n\r\nscala> spark.sql(\"\"\"select * from iceberg.glue_catalog.iceberg_table1 where trans_dt >= '2019' and trans_dt < '2020'  \"\"\").show(false)\r\n+--------+-----------+------------+--------+----------+\r\n|order_id|customer_id|order_amount|category|trans_dt  |\r\n+--------+-----------+------------+--------+----------+\r\n|10001   |1          |6.17        |soap    |2019-06-13|\r\n+--------+-----------+------------+--------+----------+\r\n\r\nMy question is; if we couldn't make use of year or month values directly while querying, then whats the point of creating partitions on those segments?   Honestly would like to know, when and how it would be leveraged/actually used.\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433743603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433774991","html_url":"https://github.com/apache/iceberg/pull/6864#issuecomment-1433774991","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6864","id":1433774991,"node_id":"IC_kwDOCW7NX85VdauP","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T22:00:40Z","updated_at":"2023-02-16T22:00:40Z","author_association":"CONTRIBUTOR","body":"Thanks, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433774991/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]