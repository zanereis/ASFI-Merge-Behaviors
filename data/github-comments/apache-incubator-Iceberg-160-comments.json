[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088082256","html_url":"https://github.com/apache/iceberg/pull/4186#issuecomment-1088082256","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4186","id":1088082256,"node_id":"IC_kwDOCW7NX85A2tFQ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-04T22:41:30Z","updated_at":"2022-04-04T22:41:30Z","author_association":"CONTRIBUTOR","body":"Here's the output config example when putting this into editor.swagger.io \r\n\r\n![image](https://user-images.githubusercontent.com/9833362/161643663-b1083408-8b53-4be3-b5dc-b0261d36ffd6.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088082256/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088085169","html_url":"https://github.com/apache/iceberg/pull/4451#issuecomment-1088085169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4451","id":1088085169,"node_id":"IC_kwDOCW7NX85A2tyx","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-04T22:47:10Z","updated_at":"2022-04-04T22:47:10Z","author_association":"CONTRIBUTOR","body":"Is there a use case when the list of orphan files does not fit into the driver memory?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088085169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088087151","html_url":"https://github.com/apache/iceberg/pull/4494#issuecomment-1088087151","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4494","id":1088087151,"node_id":"IC_kwDOCW7NX85A2uRv","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-04T22:51:15Z","updated_at":"2022-04-04T22:51:15Z","author_association":"CONTRIBUTOR","body":"Thanks, @RussellSpitzer!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088087151/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088109752","html_url":"https://github.com/apache/iceberg/pull/4382#issuecomment-1088109752","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4382","id":1088109752,"node_id":"IC_kwDOCW7NX85A2zy4","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-04T23:22:18Z","updated_at":"2022-04-04T23:22:18Z","author_association":"COLLABORATOR","body":"@aokolnychyi addressed as many comments as I could, can you check when you have time, if its any clearer?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088109752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088175726","html_url":"https://github.com/apache/iceberg/pull/4438#issuecomment-1088175726","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4438","id":1088175726,"node_id":"IC_kwDOCW7NX85A3D5u","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T01:20:43Z","updated_at":"2022-04-05T01:24:13Z","author_association":"CONTRIBUTOR","body":"thanks @RussellSpitzer @rdblue for these suggestions very much, Help me to impove my skills. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088175726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088186025","html_url":"https://github.com/apache/iceberg/pull/4496#issuecomment-1088186025","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4496","id":1088186025,"node_id":"IC_kwDOCW7NX85A3Gap","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T01:43:17Z","updated_at":"2022-04-05T01:43:17Z","author_association":"CONTRIBUTOR","body":"This fixes this issue https://github.com/apache/iceberg/issues/4289 in Spark 3.1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088186025/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088187938","html_url":"https://github.com/apache/iceberg/pull/4497#issuecomment-1088187938","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4497","id":1088187938,"node_id":"IC_kwDOCW7NX85A3G4i","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T01:48:44Z","updated_at":"2022-04-05T01:48:44Z","author_association":"CONTRIBUTOR","body":"This fixes this issue https://github.com/apache/iceberg/issues/4289 in Spark 3.0.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088187938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088188373","html_url":"https://github.com/apache/iceberg/issues/4289#issuecomment-1088188373","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4289","id":1088188373,"node_id":"IC_kwDOCW7NX85A3G_V","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T01:49:55Z","updated_at":"2022-04-05T01:50:43Z","author_association":"CONTRIBUTOR","body":"This has been merged in for Spark 3.2. There are open PRs for Spark 3.0 and 3.1 as well. I'm going to close this issue now.\r\n\r\nThis should be released as part of Iceberg 0.14.0 (or the next non-patch release).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088188373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088188937","html_url":"https://github.com/apache/iceberg/issues/4289#issuecomment-1088188937","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4289","id":1088188937,"node_id":"IC_kwDOCW7NX85A3HIJ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T01:51:22Z","updated_at":"2022-04-05T01:51:22Z","author_association":"CONTRIBUTOR","body":"@cccs-jc Please open a new issue if there are still problems, and reference this issue (also feel free to ping me in case I miss it) 👍 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088188937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088205793","html_url":"https://github.com/apache/iceberg/issues/4498#issuecomment-1088205793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4498","id":1088205793,"node_id":"IC_kwDOCW7NX85A3LPh","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T02:29:59Z","updated_at":"2022-04-05T02:29:59Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @RussellSpitzer @jackye1995 @aokolnychyi @kbendick @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088205793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088209350","html_url":"https://github.com/apache/iceberg/pull/4458#issuecomment-1088209350","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4458","id":1088209350,"node_id":"IC_kwDOCW7NX85A3MHG","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T02:38:23Z","updated_at":"2022-04-05T02:38:23Z","author_association":"CONTRIBUTOR","body":"@rdblue we do: I opened a hotfix PR to the `0.13.1` branch [here](https://github.com/apache/iceberg-docs/pull/70) and to the `latest` branch [here](https://github.com/apache/iceberg-docs/pull/71).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088209350/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088210857","html_url":"https://github.com/apache/iceberg/issues/4498#issuecomment-1088210857","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4498","id":1088210857,"node_id":"IC_kwDOCW7NX85A3Mep","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T02:42:19Z","updated_at":"2022-04-05T02:42:19Z","author_association":"MEMBER","body":"I'm not sure what you mean","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088210857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088227496","html_url":"https://github.com/apache/iceberg/issues/4498#issuecomment-1088227496","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4498","id":1088227496,"node_id":"IC_kwDOCW7NX85A3Qio","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T03:23:30Z","updated_at":"2022-04-05T03:23:44Z","author_association":"CONTRIBUTOR","body":"```\r\nprivate static final String REWRITE_MANIFESTS = \"REWRITE-MANIFESTS\";\r\n\r\npublic RewriteManifests.Result execute() {\r\n    String desc = String.format(\"Rewriting manifests (staging location=%s) of %s\", stagingLocation, table.name());\r\n    // I think static var should instead, Other code should also be used as a constraint\r\n    //JobGroupInfo info = newJobGroupInfo(\"REWRITE-MANIFESTS\", desc);\r\n    JobGroupInfo info = newJobGroupInfo(REWRITE_MANIFESTS, desc);\r\n    return withJobGroupInfo(info, this::doExecute);\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088227496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088268055","html_url":"https://github.com/apache/iceberg/pull/4465#issuecomment-1088268055","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4465","id":1088268055,"node_id":"IC_kwDOCW7NX85A3acX","user":{"login":"sumeetgajjar","id":7351922,"node_id":"MDQ6VXNlcjczNTE5MjI=","avatar_url":"https://avatars.githubusercontent.com/u/7351922?v=4","gravatar_id":"","url":"https://api.github.com/users/sumeetgajjar","html_url":"https://github.com/sumeetgajjar","followers_url":"https://api.github.com/users/sumeetgajjar/followers","following_url":"https://api.github.com/users/sumeetgajjar/following{/other_user}","gists_url":"https://api.github.com/users/sumeetgajjar/gists{/gist_id}","starred_url":"https://api.github.com/users/sumeetgajjar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sumeetgajjar/subscriptions","organizations_url":"https://api.github.com/users/sumeetgajjar/orgs","repos_url":"https://api.github.com/users/sumeetgajjar/repos","events_url":"https://api.github.com/users/sumeetgajjar/events{/privacy}","received_events_url":"https://api.github.com/users/sumeetgajjar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T04:57:23Z","updated_at":"2022-04-05T04:57:23Z","author_association":"CONTRIBUTOR","body":"@rdblue thanks for the review and your comments. \r\nI have addressed all of your requested changes in the latest commit, please review those at your convenience. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088268055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088463190","html_url":"https://github.com/apache/iceberg/issues/2532#issuecomment-1088463190","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2532","id":1088463190,"node_id":"IC_kwDOCW7NX85A4KFW","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T09:13:42Z","updated_at":"2022-04-05T09:13:42Z","author_association":"CONTRIBUTOR","body":"hey guys:\r\n       I spent some time on this issue, I need some help in order to move forward, could u please give me some guidance, thx. \r\n@RussellSpitzer @yyanyy \r\n\r\nhere is my questions\r\n\r\n> I was planning to do the test work in iceberg-core, but I think didn't find a complete impl of metadata tables of which I can read out metadata record, but I can only get some FileScanTask, just like TestIcebergSourceTablesBase.java shows.\r\n  Should I do this testing at a higher abstraction, or am I misunderstanding these metadata tables and iceberg-core provides an implementation that can read metadata records, how do I call it?\r\n\r\n> in #2521#issue comment-827897536 , @yyanyy  said \"we create v1 and v2 normal table, write data to them, and then query the manifest table and ensure output meets expected\", what does the expectation mean, the number of records or fields ? \r\n\r\n> in #2521#issue-comment-828793923, @yyanyy said \"I think a way of achieving it could be to add resource files ...\",My understanding of this is that we need to put the historical version, include 0.9.X/0.10.X/0.11.X/0.12.X/0.13.X, of the tables' file into the resources directory, when doing the test ,we load these files as tables and read the metadata of them. is my understanding correct?\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088463190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088766835","html_url":"https://github.com/apache/iceberg/pull/4479#issuecomment-1088766835","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4479","id":1088766835,"node_id":"IC_kwDOCW7NX85A5UNz","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T14:20:54Z","updated_at":"2022-04-05T16:59:59Z","author_association":"CONTRIBUTOR","body":"Hi all members, \r\n\r\nI am attempting this feature of supporting rate-limiting when stream read iceberg table. I have put out an initial PR for the same, would appreciate your thoughts on same :) !!!\r\n\r\n\r\ncc @rdblue, @aokolnychyi, @RussellSpitzer, @kbendick, @jackye1995, @rajarshisarkar ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088766835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088883356","html_url":"https://github.com/apache/iceberg/pull/4502#issuecomment-1088883356","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4502","id":1088883356,"node_id":"IC_kwDOCW7NX85A5wqc","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T15:38:05Z","updated_at":"2022-04-05T15:38:05Z","author_association":"CONTRIBUTOR","body":"Thanks, @rajarshisarkar!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088883356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088886009","html_url":"https://github.com/apache/iceberg/pull/4499#issuecomment-1088886009","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4499","id":1088886009,"node_id":"IC_kwDOCW7NX85A5xT5","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T15:39:43Z","updated_at":"2022-04-05T15:39:43Z","author_association":"CONTRIBUTOR","body":"Good catch, @kbendick! Thanks for fixing this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088886009/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088924541","html_url":"https://github.com/apache/iceberg/pull/4386#issuecomment-1088924541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4386","id":1088924541,"node_id":"IC_kwDOCW7NX85A56t9","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T15:59:08Z","updated_at":"2022-04-05T15:59:08Z","author_association":"CONTRIBUTOR","body":"There is a test failure that seems unrelated to this PR. cc @kbendick \r\n\r\n```\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyFieldsAtBeginningOfSchema[catalogName=testhadoop, baseNamespace=default, format=PARQUET, isStreaming=true] FAILED\r\n    java.lang.AssertionError: \r\n    Expecting:\r\n      [+I[bbb, 2022-03-01, 3], +I[aaa, 2022-03-01, 1]]\r\n    to contain exactly in any order:\r\n      [+I[aaa, 2022-03-01, 2], +I[bbb, 2022-03-01, 3]]\r\n    elements not found:\r\n      [+I[aaa, 2022-03-01, 2]]\r\n    and elements not expected:\r\n      [+I[aaa, 2022-03-01, 1]]\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:137)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyFieldsAtBeginningOfSchema(TestFlinkUpsert.java:[219](https://github.com/apache/iceberg/runs/5834902185?check_suite_focus=true#step:6:219))\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1088924541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089057323","html_url":"https://github.com/apache/iceberg/pull/3188#issuecomment-1089057323","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3188","id":1089057323,"node_id":"IC_kwDOCW7NX85A6bIr","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T17:07:10Z","updated_at":"2022-04-05T17:07:10Z","author_association":"MEMBER","body":"Thanks @rdblue !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089057323/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089060690","html_url":"https://github.com/apache/iceberg/pull/3188#issuecomment-1089060690","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3188","id":1089060690,"node_id":"IC_kwDOCW7NX85A6b9S","user":{"login":"jzhuge","id":1883812,"node_id":"MDQ6VXNlcjE4ODM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/1883812?v=4","gravatar_id":"","url":"https://api.github.com/users/jzhuge","html_url":"https://github.com/jzhuge","followers_url":"https://api.github.com/users/jzhuge/followers","following_url":"https://api.github.com/users/jzhuge/following{/other_user}","gists_url":"https://api.github.com/users/jzhuge/gists{/gist_id}","starred_url":"https://api.github.com/users/jzhuge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jzhuge/subscriptions","organizations_url":"https://api.github.com/users/jzhuge/orgs","repos_url":"https://api.github.com/users/jzhuge/repos","events_url":"https://api.github.com/users/jzhuge/events{/privacy}","received_events_url":"https://api.github.com/users/jzhuge/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T17:08:52Z","updated_at":"2022-04-05T17:09:27Z","author_association":"MEMBER","body":"Should I go ahead to create an PR for view implementation based on a subset of Netflix code","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089060690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089112084","html_url":"https://github.com/apache/iceberg/pull/4464#issuecomment-1089112084","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4464","id":1089112084,"node_id":"IC_kwDOCW7NX85A6ogU","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T17:49:19Z","updated_at":"2022-04-05T17:49:19Z","author_association":"MEMBER","body":"> I think the test case is good, but I would fix this slightly differently.\r\n\r\n@rdblue: Thanks for the review. Fixed as per suggestion.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089112084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089133575","html_url":"https://github.com/apache/iceberg/pull/3188#issuecomment-1089133575","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3188","id":1089133575,"node_id":"IC_kwDOCW7NX85A6twH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T18:07:50Z","updated_at":"2022-04-05T18:07:50Z","author_association":"CONTRIBUTOR","body":"Yes, please do!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089133575/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089134675","html_url":"https://github.com/apache/iceberg/issues/4490#issuecomment-1089134675","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4490","id":1089134675,"node_id":"IC_kwDOCW7NX85A6uBT","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T18:08:48Z","updated_at":"2022-04-05T18:08:48Z","author_association":"CONTRIBUTOR","body":"@polaris6 we've been thinking a lot lately about re-organizing the docs to flow more logically with how different personas would navigate. I'm currently working on a proposal for a new structure that we can discuss in the next community sync. That's a good time to add how you'd organize the Flink section!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089134675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089239112","html_url":"https://github.com/apache/iceberg/pull/2638#issuecomment-1089239112","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2638","id":1089239112,"node_id":"IC_kwDOCW7NX85A7HhI","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T19:35:31Z","updated_at":"2022-04-05T19:35:31Z","author_association":"MEMBER","body":"@shangxinli Do you have any remaining issues?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089239112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089377044","html_url":"https://github.com/apache/iceberg/pull/2638#issuecomment-1089377044","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2638","id":1089377044,"node_id":"IC_kwDOCW7NX85A7pMU","user":{"login":"shangxinli","id":31421745,"node_id":"MDQ6VXNlcjMxNDIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31421745?v=4","gravatar_id":"","url":"https://api.github.com/users/shangxinli","html_url":"https://github.com/shangxinli","followers_url":"https://api.github.com/users/shangxinli/followers","following_url":"https://api.github.com/users/shangxinli/following{/other_user}","gists_url":"https://api.github.com/users/shangxinli/gists{/gist_id}","starred_url":"https://api.github.com/users/shangxinli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shangxinli/subscriptions","organizations_url":"https://api.github.com/users/shangxinli/orgs","repos_url":"https://api.github.com/users/shangxinli/repos","events_url":"https://api.github.com/users/shangxinli/events{/privacy}","received_events_url":"https://api.github.com/users/shangxinli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T21:28:38Z","updated_at":"2022-04-05T21:28:38Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089377044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089379259","html_url":"https://github.com/apache/iceberg/issues/4292#issuecomment-1089379259","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4292","id":1089379259,"node_id":"IC_kwDOCW7NX85A7pu7","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T21:30:32Z","updated_at":"2022-04-05T21:30:32Z","author_association":"CONTRIBUTOR","body":"@szlta, would you be interested to work on the steps above? If you don't have time, I may ask someone on our team to do this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089379259/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089435400","html_url":"https://github.com/apache/iceberg/pull/4503#issuecomment-1089435400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4503","id":1089435400,"node_id":"IC_kwDOCW7NX85A73cI","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T22:18:06Z","updated_at":"2022-04-05T22:18:06Z","author_association":"CONTRIBUTOR","body":"Thanks, @bijanhoule! This looks close to being ready, but I think we should make a few minor modifications to make the actions API a bit more intuitive. I would expect that to accept a `Dataset` rather than requiring temp table registration.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089435400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089533968","html_url":"https://github.com/apache/iceberg/pull/4468#issuecomment-1089533968","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4468","id":1089533968,"node_id":"IC_kwDOCW7NX85A8PgQ","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-05T23:45:35Z","updated_at":"2022-04-05T23:45:35Z","author_association":"CONTRIBUTOR","body":"moved `operations` into `base.py` and leave the unit test coverage for operations unchanged.\r\n\r\n@rdblue  and @samredai  appreciate another look ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089533968/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089625329","html_url":"https://github.com/apache/iceberg/pull/4505#issuecomment-1089625329","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4505","id":1089625329,"node_id":"IC_kwDOCW7NX85A8lzx","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T01:27:51Z","updated_at":"2022-04-06T01:27:51Z","author_association":"CONTRIBUTOR","body":"cc: @dramaticlly @rdblue @jun-he @CircArgs ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089625329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089656375","html_url":"https://github.com/apache/iceberg/issues/4490#issuecomment-1089656375","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4490","id":1089656375,"node_id":"IC_kwDOCW7NX85A8tY3","user":{"login":"polaris6","id":29967142,"node_id":"MDQ6VXNlcjI5OTY3MTQy","avatar_url":"https://avatars.githubusercontent.com/u/29967142?v=4","gravatar_id":"","url":"https://api.github.com/users/polaris6","html_url":"https://github.com/polaris6","followers_url":"https://api.github.com/users/polaris6/followers","following_url":"https://api.github.com/users/polaris6/following{/other_user}","gists_url":"https://api.github.com/users/polaris6/gists{/gist_id}","starred_url":"https://api.github.com/users/polaris6/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polaris6/subscriptions","organizations_url":"https://api.github.com/users/polaris6/orgs","repos_url":"https://api.github.com/users/polaris6/repos","events_url":"https://api.github.com/users/polaris6/events{/privacy}","received_events_url":"https://api.github.com/users/polaris6/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T01:57:39Z","updated_at":"2022-04-06T01:57:39Z","author_association":"CONTRIBUTOR","body":"@samredai Thank you for your reply, I am very interested in doing these work, you can call me anytime if you need it!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089656375/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089671513","html_url":"https://github.com/apache/iceberg/pull/4427#issuecomment-1089671513","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4427","id":1089671513,"node_id":"IC_kwDOCW7NX85A8xFZ","user":{"login":"xloya","id":26177232,"node_id":"MDQ6VXNlcjI2MTc3MjMy","avatar_url":"https://avatars.githubusercontent.com/u/26177232?v=4","gravatar_id":"","url":"https://api.github.com/users/xloya","html_url":"https://github.com/xloya","followers_url":"https://api.github.com/users/xloya/followers","following_url":"https://api.github.com/users/xloya/following{/other_user}","gists_url":"https://api.github.com/users/xloya/gists{/gist_id}","starred_url":"https://api.github.com/users/xloya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xloya/subscriptions","organizations_url":"https://api.github.com/users/xloya/orgs","repos_url":"https://api.github.com/users/xloya/repos","events_url":"https://api.github.com/users/xloya/events{/privacy}","received_events_url":"https://api.github.com/users/xloya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T02:13:00Z","updated_at":"2022-04-06T02:13:00Z","author_association":"CONTRIBUTOR","body":"@rdblue Sorry for the late reply as I just finished my vacation, I'll look at the comments later, thanks again for your help reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089671513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089690102","html_url":"https://github.com/apache/iceberg/pull/4468#issuecomment-1089690102","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4468","id":1089690102,"node_id":"IC_kwDOCW7NX85A81n2","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T02:32:52Z","updated_at":"2022-04-06T02:33:12Z","author_association":"CONTRIBUTOR","body":"Thank you @samredai  for your quick review, I renamed\r\n- test_expressions_base.py\r\n- test_io_base.py\r\n\r\nas suggested!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089690102/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089734326","html_url":"https://github.com/apache/iceberg/pull/4507#issuecomment-1089734326","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4507","id":1089734326,"node_id":"IC_kwDOCW7NX85A9Aa2","user":{"login":"southernriver","id":20614350,"node_id":"MDQ6VXNlcjIwNjE0MzUw","avatar_url":"https://avatars.githubusercontent.com/u/20614350?v=4","gravatar_id":"","url":"https://api.github.com/users/southernriver","html_url":"https://github.com/southernriver","followers_url":"https://api.github.com/users/southernriver/followers","following_url":"https://api.github.com/users/southernriver/following{/other_user}","gists_url":"https://api.github.com/users/southernriver/gists{/gist_id}","starred_url":"https://api.github.com/users/southernriver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/southernriver/subscriptions","organizations_url":"https://api.github.com/users/southernriver/orgs","repos_url":"https://api.github.com/users/southernriver/repos","events_url":"https://api.github.com/users/southernriver/events{/privacy}","received_events_url":"https://api.github.com/users/southernriver/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T03:18:19Z","updated_at":"2022-04-06T03:26:26Z","author_association":"CONTRIBUTOR","body":"@rdblue  @openinx  Could you please have a look at this, it looks like a serious bug.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089734326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089735153","html_url":"https://github.com/apache/iceberg/issues/4506#issuecomment-1089735153","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4506","id":1089735153,"node_id":"IC_kwDOCW7NX85A9Anx","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T03:19:08Z","updated_at":"2022-04-06T03:20:06Z","author_association":"CONTRIBUTOR","body":"e.g. \r\n\r\n```\r\n  private CreateSnapshotEvent currentEvent;\r\n\r\n  public TestCreateSnapshotEvent(int formatVersion) {\r\n    super(formatVersion);\r\n    Listeners.register(new MyListener(), CreateSnapshotEvent.class);\r\n  }\r\n\r\nclass MyListener implements Listener<CreateSnapshotEvent> {\r\n    @Override\r\n    public void notify(CreateSnapshotEvent event) {\r\n      currentEvent = event;\r\n    }\r\n  }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089735153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089817910","html_url":"https://github.com/apache/iceberg/issues/4508#issuecomment-1089817910","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4508","id":1089817910,"node_id":"IC_kwDOCW7NX85A9U02","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T04:52:30Z","updated_at":"2022-04-06T04:52:30Z","author_association":"CONTRIBUTOR","body":"> It is often expensive, especially if it involve remote reads through network. Certain stream operation such as backward seek and small reads characteristics by Avro library can have high latency depending on the target file system / cloud connector.\r\n\r\nThanks, for bringing this up. We also recently noticed this while using S3 as the target file system. The use case was for high throughput streaming jobs with a lot of snapshots.\r\n\r\nDo let me know if you would like to collaborate on this work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089817910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089821891","html_url":"https://github.com/apache/iceberg/pull/4386#issuecomment-1089821891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4386","id":1089821891,"node_id":"IC_kwDOCW7NX85A9VzD","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T05:00:09Z","updated_at":"2022-04-07T07:23:05Z","author_association":"CONTRIBUTOR","body":"Thanks @stevenzwu .\r\n\r\n*And shall we open an issue to track this fragile test case*, @kbendick .\r\n#4515 is exactly this issue\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089821891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089854144","html_url":"https://github.com/apache/iceberg/pull/4509#issuecomment-1089854144","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4509","id":1089854144,"node_id":"IC_kwDOCW7NX85A9drA","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T06:01:10Z","updated_at":"2022-04-06T06:01:10Z","author_association":"MEMBER","body":"cc: @nastra , @snazy, @rdblue , @openinx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089854144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089878109","html_url":"https://github.com/apache/iceberg/issues/4506#issuecomment-1089878109","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4506","id":1089878109,"node_id":"IC_kwDOCW7NX85A9jhd","user":{"login":"idealspark","id":13582038,"node_id":"MDQ6VXNlcjEzNTgyMDM4","avatar_url":"https://avatars.githubusercontent.com/u/13582038?v=4","gravatar_id":"","url":"https://api.github.com/users/idealspark","html_url":"https://github.com/idealspark","followers_url":"https://api.github.com/users/idealspark/followers","following_url":"https://api.github.com/users/idealspark/following{/other_user}","gists_url":"https://api.github.com/users/idealspark/gists{/gist_id}","starred_url":"https://api.github.com/users/idealspark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/idealspark/subscriptions","organizations_url":"https://api.github.com/users/idealspark/orgs","repos_url":"https://api.github.com/users/idealspark/repos","events_url":"https://api.github.com/users/idealspark/events{/privacy}","received_events_url":"https://api.github.com/users/idealspark/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T06:38:42Z","updated_at":"2022-04-06T06:38:42Z","author_association":"NONE","body":"> e.g.\r\n> \r\n> ```\r\n>   private CreateSnapshotEvent currentEvent;\r\n> \r\n>   public TestCreateSnapshotEvent(int formatVersion) {\r\n>     super(formatVersion);\r\n>     Listeners.register(new MyListener(), CreateSnapshotEvent.class);\r\n>   }\r\n> \r\n> class MyListener implements Listener<CreateSnapshotEvent> {\r\n>     @Override\r\n>     public void notify(CreateSnapshotEvent event) {\r\n>       currentEvent = event;\r\n>     }\r\n>   }\r\n> ```\r\n\r\nthank you for reply.\r\nI resolved this by spark listener, after later i will give a example\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089878109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089889646","html_url":"https://github.com/apache/iceberg/pull/3827#issuecomment-1089889646","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3827","id":1089889646,"node_id":"IC_kwDOCW7NX85A9mVu","user":{"login":"linfan","id":1113435,"node_id":"MDQ6VXNlcjExMTM0MzU=","avatar_url":"https://avatars.githubusercontent.com/u/1113435?v=4","gravatar_id":"","url":"https://api.github.com/users/linfan","html_url":"https://github.com/linfan","followers_url":"https://api.github.com/users/linfan/followers","following_url":"https://api.github.com/users/linfan/following{/other_user}","gists_url":"https://api.github.com/users/linfan/gists{/gist_id}","starred_url":"https://api.github.com/users/linfan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/linfan/subscriptions","organizations_url":"https://api.github.com/users/linfan/orgs","repos_url":"https://api.github.com/users/linfan/repos","events_url":"https://api.github.com/users/linfan/events{/privacy}","received_events_url":"https://api.github.com/users/linfan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T06:54:25Z","updated_at":"2022-04-06T06:54:25Z","author_association":"NONE","body":"Why this PR still laying here ? I think someone should resolve and merge it...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089889646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089893796","html_url":"https://github.com/apache/iceberg/pull/3827#issuecomment-1089893796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3827","id":1089893796,"node_id":"IC_kwDOCW7NX85A9nWk","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T06:59:18Z","updated_at":"2022-04-06T06:59:18Z","author_association":"MEMBER","body":"Sorry, I think I've missed this PR before.  @xiaotianzhang01 , would you mind to fix those conflicts ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089893796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089950324","html_url":"https://github.com/apache/iceberg/pull/4489#issuecomment-1089950324","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4489","id":1089950324,"node_id":"IC_kwDOCW7NX85A91J0","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T07:54:29Z","updated_at":"2022-04-06T07:54:29Z","author_association":"MEMBER","body":"Merged ! Thanks all for reviewing, and thanks @rajarshisarkar for the contribution ! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1089950324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090002370","html_url":"https://github.com/apache/iceberg/issues/4059#issuecomment-1090002370","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4059","id":1090002370,"node_id":"IC_kwDOCW7NX85A-B3C","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T08:35:55Z","updated_at":"2022-04-06T08:35:55Z","author_association":"CONTRIBUTOR","body":"@zjffdu  I think here is what u like, and u can close this\r\n\r\n![image](https://user-images.githubusercontent.com/10529123/161932210-5916eaa0-842f-4a64-9138-ca157501e4df.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090002370/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090014442","html_url":"https://github.com/apache/iceberg/pull/4071#issuecomment-1090014442","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4071","id":1090014442,"node_id":"IC_kwDOCW7NX85A-Ezq","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T08:47:14Z","updated_at":"2022-04-06T08:47:14Z","author_association":"CONTRIBUTOR","body":"Rest Catalog tests are failing due to my changes, I'll need to investigate","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090014442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090024276","html_url":"https://github.com/apache/iceberg/issues/1949#issuecomment-1090024276","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1949","id":1090024276,"node_id":"IC_kwDOCW7NX85A-HNU","user":{"login":"vamen","id":12099000,"node_id":"MDQ6VXNlcjEyMDk5MDAw","avatar_url":"https://avatars.githubusercontent.com/u/12099000?v=4","gravatar_id":"","url":"https://api.github.com/users/vamen","html_url":"https://github.com/vamen","followers_url":"https://api.github.com/users/vamen/followers","following_url":"https://api.github.com/users/vamen/following{/other_user}","gists_url":"https://api.github.com/users/vamen/gists{/gist_id}","starred_url":"https://api.github.com/users/vamen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vamen/subscriptions","organizations_url":"https://api.github.com/users/vamen/orgs","repos_url":"https://api.github.com/users/vamen/repos","events_url":"https://api.github.com/users/vamen/events{/privacy}","received_events_url":"https://api.github.com/users/vamen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T08:56:50Z","updated_at":"2022-04-06T08:56:50Z","author_association":"NONE","body":"Is there any updates on this ?\r\nWould be glad contribute to this feature.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090024276/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090040631","html_url":"https://github.com/apache/iceberg/issues/4292#issuecomment-1090040631","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4292","id":1090040631,"node_id":"IC_kwDOCW7NX85A-LM3","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T09:13:08Z","updated_at":"2022-04-06T09:13:08Z","author_association":"CONTRIBUTOR","body":"Hi @aokolnychyi sorry for the longer pause here, I was on paternity leave ;)\r\nBefore I left, I was looking into how proposal 2 in https://github.com/apache/iceberg/pull/3411#discussion_r823692312 could be implemented in Iceberg. It seemed to be quite tricky, so first I'd jump onto the smaller fixes of the above proposed list.\r\nI'd be happy to take this up and work on a PR that should fix these two points:\r\n\r\n- Use Partitioning$partitionType in all metadata tables.\r\n- Consider adding partition_spec_id to metadata tables where this is missing (I think it's only the partitions meta table).\r\n\r\nThese two relate strongly, so I think they are worth handling in the same change request. I'll start working on this PR today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090040631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090049772","html_url":"https://github.com/apache/iceberg/issues/4510#issuecomment-1090049772","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4510","id":1090049772,"node_id":"IC_kwDOCW7NX85A-Nbs","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T09:22:17Z","updated_at":"2022-04-06T09:22:17Z","author_association":"CONTRIBUTOR","body":"I can't find the table being altered to introduce the new partition field `some_date_2`. Am I missing something?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090049772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090067804","html_url":"https://github.com/apache/iceberg/issues/4059#issuecomment-1090067804","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4059","id":1090067804,"node_id":"IC_kwDOCW7NX85A-R1c","user":{"login":"zjffdu","id":164491,"node_id":"MDQ6VXNlcjE2NDQ5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/164491?v=4","gravatar_id":"","url":"https://api.github.com/users/zjffdu","html_url":"https://github.com/zjffdu","followers_url":"https://api.github.com/users/zjffdu/followers","following_url":"https://api.github.com/users/zjffdu/following{/other_user}","gists_url":"https://api.github.com/users/zjffdu/gists{/gist_id}","starred_url":"https://api.github.com/users/zjffdu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zjffdu/subscriptions","organizations_url":"https://api.github.com/users/zjffdu/orgs","repos_url":"https://api.github.com/users/zjffdu/repos","events_url":"https://api.github.com/users/zjffdu/events{/privacy}","received_events_url":"https://api.github.com/users/zjffdu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T09:41:13Z","updated_at":"2022-04-06T09:41:13Z","author_association":"NONE","body":"Thanks @kyle-cx ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090067804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090067882","html_url":"https://github.com/apache/iceberg/issues/4510#issuecomment-1090067882","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4510","id":1090067882,"node_id":"IC_kwDOCW7NX85A-R2q","user":{"login":"itaise","id":64745584,"node_id":"MDQ6VXNlcjY0NzQ1NTg0","avatar_url":"https://avatars.githubusercontent.com/u/64745584?v=4","gravatar_id":"","url":"https://api.github.com/users/itaise","html_url":"https://github.com/itaise","followers_url":"https://api.github.com/users/itaise/followers","following_url":"https://api.github.com/users/itaise/following{/other_user}","gists_url":"https://api.github.com/users/itaise/gists{/gist_id}","starred_url":"https://api.github.com/users/itaise/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/itaise/subscriptions","organizations_url":"https://api.github.com/users/itaise/orgs","repos_url":"https://api.github.com/users/itaise/repos","events_url":"https://api.github.com/users/itaise/events{/privacy}","received_events_url":"https://api.github.com/users/itaise/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T09:41:19Z","updated_at":"2022-04-06T09:41:19Z","author_association":"NONE","body":"@rajarshisarkar  the first part is creating the first version, and the second part tries to overwrite it. \r\nMaybe you should change the catalog name to your catalog?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090067882/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090428372","html_url":"https://github.com/apache/iceberg/pull/4466#issuecomment-1090428372","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4466","id":1090428372,"node_id":"IC_kwDOCW7NX85A_p3U","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T15:50:20Z","updated_at":"2022-04-06T15:50:20Z","author_association":"CONTRIBUTOR","body":"@rdblue I think I've made the changes you suggested and also referred to the link for some further modifications. I have some CI issues to work out, but if I'm on the right or wrong track with these changes please let me know","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090428372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090507108","html_url":"https://github.com/apache/iceberg/pull/2638#issuecomment-1090507108","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2638","id":1090507108,"node_id":"IC_kwDOCW7NX85A_9Fk","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T17:10:49Z","updated_at":"2022-04-06T17:10:49Z","author_association":"MEMBER","body":"Thanks @ggershinsky ! Good to get this first step in! \r\n\r\nThanks for review @jackye1995 , @shangxinli , and @flyrain !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090507108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090536659","html_url":"https://github.com/apache/iceberg/pull/4456#issuecomment-1090536659","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4456","id":1090536659,"node_id":"IC_kwDOCW7NX85BAETT","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T17:35:49Z","updated_at":"2022-04-06T17:35:49Z","author_association":"CONTRIBUTOR","body":"> I had a few minor comments, but @szehon-ho is the Hive expert so when he is +1 I think this is good to merge\r\n\r\nThanks for the review. Let me address some comments before the merge.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090536659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090799714","html_url":"https://github.com/apache/iceberg/issues/4144#issuecomment-1090799714","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4144","id":1090799714,"node_id":"IC_kwDOCW7NX85BBEhi","user":{"login":"jpugliesi","id":2141170,"node_id":"MDQ6VXNlcjIxNDExNzA=","avatar_url":"https://avatars.githubusercontent.com/u/2141170?v=4","gravatar_id":"","url":"https://api.github.com/users/jpugliesi","html_url":"https://github.com/jpugliesi","followers_url":"https://api.github.com/users/jpugliesi/followers","following_url":"https://api.github.com/users/jpugliesi/following{/other_user}","gists_url":"https://api.github.com/users/jpugliesi/gists{/gist_id}","starred_url":"https://api.github.com/users/jpugliesi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpugliesi/subscriptions","organizations_url":"https://api.github.com/users/jpugliesi/orgs","repos_url":"https://api.github.com/users/jpugliesi/repos","events_url":"https://api.github.com/users/jpugliesi/events{/privacy}","received_events_url":"https://api.github.com/users/jpugliesi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T21:00:26Z","updated_at":"2022-04-06T21:00:26Z","author_association":"CONTRIBUTOR","body":"@wypoon thank you for the explanation - is there any known workaround for this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090799714/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090808573","html_url":"https://github.com/apache/iceberg/pull/4418#issuecomment-1090808573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4418","id":1090808573,"node_id":"IC_kwDOCW7NX85BBGr9","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T21:07:41Z","updated_at":"2022-04-06T21:07:41Z","author_association":"CONTRIBUTOR","body":"Opened a PR to simply throw `UnsupportedOperationException` in `FlinkSink` if it's determined that the program is running in `upsert` mode: https://github.com/apache/iceberg/pull/4519","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090808573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090818107","html_url":"https://github.com/apache/iceberg/issues/4508#issuecomment-1090818107","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4508","id":1090818107,"node_id":"IC_kwDOCW7NX85BBJA7","user":{"login":"rizaon","id":6033430,"node_id":"MDQ6VXNlcjYwMzM0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/6033430?v=4","gravatar_id":"","url":"https://api.github.com/users/rizaon","html_url":"https://github.com/rizaon","followers_url":"https://api.github.com/users/rizaon/followers","following_url":"https://api.github.com/users/rizaon/following{/other_user}","gists_url":"https://api.github.com/users/rizaon/gists{/gist_id}","starred_url":"https://api.github.com/users/rizaon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rizaon/subscriptions","organizations_url":"https://api.github.com/users/rizaon/orgs","repos_url":"https://api.github.com/users/rizaon/repos","events_url":"https://api.github.com/users/rizaon/events{/privacy}","received_events_url":"https://api.github.com/users/rizaon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T21:18:34Z","updated_at":"2022-04-06T21:18:34Z","author_association":"CONTRIBUTOR","body":"Hello @rajarshisarkar , thanks for your interest!\r\nI'm happy to collaborate. I filed PR #4518 as a draft for this improvement idea.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090818107/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090875863","html_url":"https://github.com/apache/iceberg/pull/4503#issuecomment-1090875863","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4503","id":1090875863,"node_id":"IC_kwDOCW7NX85BBXHX","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T22:30:11Z","updated_at":"2022-04-06T22:30:11Z","author_association":"CONTRIBUTOR","body":"I'd be curious to take a look as well tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090875863/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090922821","html_url":"https://github.com/apache/iceberg/pull/4466#issuecomment-1090922821","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4466","id":1090922821,"node_id":"IC_kwDOCW7NX85BBilF","user":{"login":"CircArgs","id":35903677,"node_id":"MDQ6VXNlcjM1OTAzNjc3","avatar_url":"https://avatars.githubusercontent.com/u/35903677?v=4","gravatar_id":"","url":"https://api.github.com/users/CircArgs","html_url":"https://github.com/CircArgs","followers_url":"https://api.github.com/users/CircArgs/followers","following_url":"https://api.github.com/users/CircArgs/following{/other_user}","gists_url":"https://api.github.com/users/CircArgs/gists{/gist_id}","starred_url":"https://api.github.com/users/CircArgs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CircArgs/subscriptions","organizations_url":"https://api.github.com/users/CircArgs/orgs","repos_url":"https://api.github.com/users/CircArgs/repos","events_url":"https://api.github.com/users/CircArgs/events{/privacy}","received_events_url":"https://api.github.com/users/CircArgs/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T23:29:41Z","updated_at":"2022-04-06T23:29:41Z","author_association":"CONTRIBUTOR","body":"Fixed my failing tox checks. Had a few logical errors and a mistakenly overwritten file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090922821/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090934783","html_url":"https://github.com/apache/iceberg/issues/4144#issuecomment-1090934783","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4144","id":1090934783,"node_id":"IC_kwDOCW7NX85BBlf_","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T23:51:03Z","updated_at":"2022-04-06T23:51:03Z","author_association":"CONTRIBUTOR","body":"@jpugliesi there is no workaround for this. However, I believe a 0.13.2 release is planned soon, which will have the fix for this. If you need the fix sooner, you can build Iceberg from the 0.13.x branch yourself.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090934783/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090938643","html_url":"https://github.com/apache/iceberg/issues/4144#issuecomment-1090938643","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4144","id":1090938643,"node_id":"IC_kwDOCW7NX85BBmcT","user":{"login":"wypoon","id":3925490,"node_id":"MDQ6VXNlcjM5MjU0OTA=","avatar_url":"https://avatars.githubusercontent.com/u/3925490?v=4","gravatar_id":"","url":"https://api.github.com/users/wypoon","html_url":"https://github.com/wypoon","followers_url":"https://api.github.com/users/wypoon/followers","following_url":"https://api.github.com/users/wypoon/following{/other_user}","gists_url":"https://api.github.com/users/wypoon/gists{/gist_id}","starred_url":"https://api.github.com/users/wypoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wypoon/subscriptions","organizations_url":"https://api.github.com/users/wypoon/orgs","repos_url":"https://api.github.com/users/wypoon/repos","events_url":"https://api.github.com/users/wypoon/events{/privacy}","received_events_url":"https://api.github.com/users/wypoon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-06T23:58:51Z","updated_at":"2022-04-06T23:58:51Z","author_association":"CONTRIBUTOR","body":"I suppose if you do need to rollback to a snapshot (and the rollback fails because of this bug), you can create a new table by selecting from the original table as of the snapshot you want, and switch to using the new table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090938643/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090983050","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1090983050","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1090983050,"node_id":"IC_kwDOCW7NX85BBxSK","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T01:25:29Z","updated_at":"2022-04-07T01:25:29Z","author_association":"CONTRIBUTOR","body":"Would love to hear other's perspective on this, but Nessie supports other formats such as Delta Lake. There is an ongoing PR for enabling the ability for cross table transactions. https://github.com/apache/iceberg/pull/1849 . As for accomplishing cross-trable txns via branching, similar to what Nessie does if I am not mistaken, I'm not sure that's something needed to be in Iceberg native. Nessie operates at a higher level abstraction and has rich functionality in this area. In my view, I think the goal with Iceberg native branching and tagging would be to give some of these capabilities to Iceberg users without requiring a full Nessie setup.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090983050/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090987942","html_url":"https://github.com/apache/iceberg/pull/4464#issuecomment-1090987942","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4464","id":1090987942,"node_id":"IC_kwDOCW7NX85BByem","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T01:36:16Z","updated_at":"2022-04-07T01:36:16Z","author_association":"MEMBER","body":"@rdblue : Can you please help in merging this? Thanks. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090987942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090988129","html_url":"https://github.com/apache/iceberg/pull/4509#issuecomment-1090988129","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4509","id":1090988129,"node_id":"IC_kwDOCW7NX85BByhh","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T01:36:40Z","updated_at":"2022-04-07T01:36:40Z","author_association":"MEMBER","body":"@szehon-ho / @openinx : Can you please help in merging this ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090988129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090998127","html_url":"https://github.com/apache/iceberg/pull/4507#issuecomment-1090998127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4507","id":1090998127,"node_id":"IC_kwDOCW7NX85BB09v","user":{"login":"southernriver","id":20614350,"node_id":"MDQ6VXNlcjIwNjE0MzUw","avatar_url":"https://avatars.githubusercontent.com/u/20614350?v=4","gravatar_id":"","url":"https://api.github.com/users/southernriver","html_url":"https://github.com/southernriver","followers_url":"https://api.github.com/users/southernriver/followers","following_url":"https://api.github.com/users/southernriver/following{/other_user}","gists_url":"https://api.github.com/users/southernriver/gists{/gist_id}","starred_url":"https://api.github.com/users/southernriver/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/southernriver/subscriptions","organizations_url":"https://api.github.com/users/southernriver/orgs","repos_url":"https://api.github.com/users/southernriver/repos","events_url":"https://api.github.com/users/southernriver/events{/privacy}","received_events_url":"https://api.github.com/users/southernriver/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T01:59:22Z","updated_at":"2022-04-07T01:59:22Z","author_association":"CONTRIBUTOR","body":"@kbendick  Thank you. Manifest clean-up operation could throw `OutOfMemoryError` , For Spark-Side,  Job  callback to  SparkWrite.abort:\r\n\r\n```\r\n  private void abort(WriterCommitMessage[] messages) {\r\n    Map<String, String> props = table.properties();\r\n    Tasks.foreach(files(messages))\r\n        .retry(PropertyUtil.propertyAsInt(props, COMMIT_NUM_RETRIES, COMMIT_NUM_RETRIES_DEFAULT))\r\n        .exponentialBackoff(\r\n            PropertyUtil.propertyAsInt(props, COMMIT_MIN_RETRY_WAIT_MS, COMMIT_MIN_RETRY_WAIT_MS_DEFAULT),\r\n            PropertyUtil.propertyAsInt(props, COMMIT_MAX_RETRY_WAIT_MS, COMMIT_MAX_RETRY_WAIT_MS_DEFAULT),\r\n            PropertyUtil.propertyAsInt(props, COMMIT_TOTAL_RETRY_TIME_MS, COMMIT_TOTAL_RETRY_TIME_MS_DEFAULT),\r\n            2.0 /* exponential */)\r\n        .throwFailureWhenFinished()\r\n        .run(file -> {\r\n          table.io().deleteFile(file.path().toString());\r\n        });\r\n  }\r\n\r\n```\r\nIt would delete datafile. And then if we read from current snapshot,  `java.io.FileNotFoundException` would be thrown:\r\n<img width=\"1554\" alt=\"image\" src=\"https://user-images.githubusercontent.com/20614350/162104740-fb1339db-2f74-4394-802d-dbc443447a4d.png\">\r\n\r\nit's easy to reproduce this problem, you can  just throw `OutOfMemoryError` in try block.\r\n`      throw  new OutOfMemoryError(\"oom\");\r\n`\r\n\r\n\r\nBTW, I think clean-up is not necessary after committed success, and we can catch all exception or error. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1090998127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091003296","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091003296","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091003296,"node_id":"IC_kwDOCW7NX85BB2Og","user":{"login":"melin","id":1145830,"node_id":"MDQ6VXNlcjExNDU4MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1145830?v=4","gravatar_id":"","url":"https://api.github.com/users/melin","html_url":"https://github.com/melin","followers_url":"https://api.github.com/users/melin/followers","following_url":"https://api.github.com/users/melin/following{/other_user}","gists_url":"https://api.github.com/users/melin/gists{/gist_id}","starred_url":"https://api.github.com/users/melin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melin/subscriptions","organizations_url":"https://api.github.com/users/melin/orgs","repos_url":"https://api.github.com/users/melin/repos","events_url":"https://api.github.com/users/melin/events{/privacy}","received_events_url":"https://api.github.com/users/melin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T02:07:55Z","updated_at":"2022-04-07T09:04:47Z","author_association":"NONE","body":"1. nessie branch is catalog level，Unlike traditional databases, a multi-table transaction can contain multiple tables, and a nessie transaction contains multiple commit. Seems like the transaction is at the catalog level?\r\n2. Iceberg branch is catalog level. catalog level branching supported?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091003296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091004054","html_url":"https://github.com/apache/iceberg/pull/1849#issuecomment-1091004054","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1849","id":1091004054,"node_id":"IC_kwDOCW7NX85BB2aW","user":{"login":"melin","id":1145830,"node_id":"MDQ6VXNlcjExNDU4MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1145830?v=4","gravatar_id":"","url":"https://api.github.com/users/melin","html_url":"https://github.com/melin","followers_url":"https://api.github.com/users/melin/followers","following_url":"https://api.github.com/users/melin/following{/other_user}","gists_url":"https://api.github.com/users/melin/gists{/gist_id}","starred_url":"https://api.github.com/users/melin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melin/subscriptions","organizations_url":"https://api.github.com/users/melin/orgs","repos_url":"https://api.github.com/users/melin/repos","events_url":"https://api.github.com/users/melin/events{/privacy}","received_events_url":"https://api.github.com/users/melin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T02:09:26Z","updated_at":"2022-04-07T02:09:26Z","author_association":"NONE","body":"@jacques-n  pr continue?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091004054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091007559","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091007559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091007559,"node_id":"IC_kwDOCW7NX85BB3RH","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T02:15:56Z","updated_at":"2022-04-07T02:15:56Z","author_association":"CONTRIBUTOR","body":"1.) Yes, Nessie branching is at the catalog level. Nessie catalog implementations implement the transactional capabilities for themselves so yes to that as well (if I'm not mistaken ).\r\n\r\n2.) Iceberg branching is at the table level","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091007559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091015654","html_url":"https://github.com/apache/iceberg/issues/4515#issuecomment-1091015654","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4515","id":1091015654,"node_id":"IC_kwDOCW7NX85BB5Pm","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T02:32:11Z","updated_at":"2022-04-07T02:32:11Z","author_association":"MEMBER","body":"Yes,  seems I can reproduce this failing parquet & streaming test cases sometimes in my host: \r\n\r\n![image](https://user-images.githubusercontent.com/5028729/162108684-ab3dbffc-152a-4940-898e-23b5dde0536d.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091015654/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091032661","html_url":"https://github.com/apache/iceberg/issues/4515#issuecomment-1091032661","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4515","id":1091032661,"node_id":"IC_kwDOCW7NX85BB9ZV","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T03:10:58Z","updated_at":"2022-04-07T03:10:58Z","author_association":"MEMBER","body":"I opened a debug to verify those files, and I can see the files are laying like the following: \r\n\r\n```bash\r\n➜  default find . \r\n.\r\n./default\r\n./a.txt\r\n./db\r\n./db/upsert_on_pk_at_schema_end\r\n./db/upsert_on_pk_at_schema_end/data\r\n./db/upsert_on_pk_at_schema_end/data/data=aaa\r\n./db/upsert_on_pk_at_schema_end/data/data=aaa/.00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00002.parquet.crc\r\n./db/upsert_on_pk_at_schema_end/data/data=aaa/00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00002.parquet\r\n./db/upsert_on_pk_at_schema_end/data/data=aaa/.00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00001.parquet.crc\r\n./db/upsert_on_pk_at_schema_end/data/data=aaa/00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00001.parquet\r\n./db/upsert_on_pk_at_schema_end/data/data=aaa/00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00005.parquet\r\n./db/upsert_on_pk_at_schema_end/data/data=aaa/.00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00005.parquet.crc\r\n./db/upsert_on_pk_at_schema_end/data/data=bbb\r\n./db/upsert_on_pk_at_schema_end/data/data=bbb/00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00003.parquet\r\n./db/upsert_on_pk_at_schema_end/data/data=bbb/.00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00004.parquet.crc\r\n./db/upsert_on_pk_at_schema_end/data/data=bbb/00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00004.parquet\r\n./db/upsert_on_pk_at_schema_end/data/data=bbb/.00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00003.parquet.crc\r\n./db/upsert_on_pk_at_schema_end/metadata\r\n./db/upsert_on_pk_at_schema_end/metadata/version-hint.text\r\n./db/upsert_on_pk_at_schema_end/metadata/.version-hint.text.crc\r\n./db/upsert_on_pk_at_schema_end/metadata/e21484e0-cea6-4001-b4af-3e34c9249a88-m0.avro\r\n./db/upsert_on_pk_at_schema_end/metadata/snap-3867050424845709517-1-e21484e0-cea6-4001-b4af-3e34c9249a88.avro\r\n./db/upsert_on_pk_at_schema_end/metadata/e21484e0-cea6-4001-b4af-3e34c9249a88-m1.avro\r\n./db/upsert_on_pk_at_schema_end/metadata/.v2.metadata.json.crc\r\n./db/upsert_on_pk_at_schema_end/metadata/v2.metadata.json\r\n./db/upsert_on_pk_at_schema_end/metadata/.v1.metadata.json.crc\r\n./db/upsert_on_pk_at_schema_end/metadata/.snap-3867050424845709517-1-e21484e0-cea6-4001-b4af-3e34c9249a88.avro.crc\r\n./db/upsert_on_pk_at_schema_end/metadata/.e21484e0-cea6-4001-b4af-3e34c9249a88-m1.avro.crc\r\n./db/upsert_on_pk_at_schema_end/metadata/.e21484e0-cea6-4001-b4af-3e34c9249a88-m0.avro.crc\r\n./db/upsert_on_pk_at_schema_end/metadata/v1.metadata.json\r\n```\r\n\r\nThat means there is only one checkpoint to commit those three records, while in the partition `data=aaa`, those records are: \r\n\r\n```bash\r\n#  The equality delete file.\r\n➜  default parquet cat ./db/upsert_on_pk_at_schema_end/data/data=aaa/00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00002.parquet \r\n{\"data\": \"aaa\", \"dt\": 19052}\r\n\r\n# The insert data file.\r\n➜  default parquet cat ./db/upsert_on_pk_at_schema_end/data/data=aaa/00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00001.parquet \r\n{\"id\": 2, \"data\": \"aaa\", \"dt\": 19052}\r\n{\"id\": 1, \"data\": \"aaa\", \"dt\": 19052}\r\n\r\n# The positional delete file.\r\n➜  default parquet cat ./db/upsert_on_pk_at_schema_end/data/data=aaa/00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00005.parquet\r\n{\"file_path\": \"file:/var/folders/fg/kbb4swcd0gl_3s0wlhhk9bch0000gp/T/junit3828094481211623109/default/db/upsert_on_pk_at_schema_end/data/data=aaa/00000-0-f9269f62-299b-4689-8b9f-ad59d7fb539d-00001.parquet\", \"pos\": 0}\r\n```\r\n\r\nThe tricky thing is:  the `record (2, 'aaa', '2022-03-1')` was written before `record(1, 'aaa', '2022-03-01')`,  that' why we encountered the failure case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091032661/reactions","total_count":3,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":2},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091033241","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091033241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091033241,"node_id":"IC_kwDOCW7NX85BB9iZ","user":{"login":"melin","id":1145830,"node_id":"MDQ6VXNlcjExNDU4MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1145830?v=4","gravatar_id":"","url":"https://api.github.com/users/melin","html_url":"https://github.com/melin","followers_url":"https://api.github.com/users/melin/followers","following_url":"https://api.github.com/users/melin/following{/other_user}","gists_url":"https://api.github.com/users/melin/gists{/gist_id}","starred_url":"https://api.github.com/users/melin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melin/subscriptions","organizations_url":"https://api.github.com/users/melin/orgs","repos_url":"https://api.github.com/users/melin/repos","events_url":"https://api.github.com/users/melin/events{/privacy}","received_events_url":"https://api.github.com/users/melin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T03:12:11Z","updated_at":"2022-04-07T03:12:11Z","author_association":"NONE","body":"@amogh-jahagirdar  iceberg branch considering supporting catalog level?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091033241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091054373","html_url":"https://github.com/apache/iceberg/pull/4514#issuecomment-1091054373","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4514","id":1091054373,"node_id":"IC_kwDOCW7NX85BCCsl","user":{"login":"vanliu-tx","id":64360028,"node_id":"MDQ6VXNlcjY0MzYwMDI4","avatar_url":"https://avatars.githubusercontent.com/u/64360028?v=4","gravatar_id":"","url":"https://api.github.com/users/vanliu-tx","html_url":"https://github.com/vanliu-tx","followers_url":"https://api.github.com/users/vanliu-tx/followers","following_url":"https://api.github.com/users/vanliu-tx/following{/other_user}","gists_url":"https://api.github.com/users/vanliu-tx/gists{/gist_id}","starred_url":"https://api.github.com/users/vanliu-tx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanliu-tx/subscriptions","organizations_url":"https://api.github.com/users/vanliu-tx/orgs","repos_url":"https://api.github.com/users/vanliu-tx/repos","events_url":"https://api.github.com/users/vanliu-tx/events{/privacy}","received_events_url":"https://api.github.com/users/vanliu-tx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T04:00:38Z","updated_at":"2022-04-07T04:00:38Z","author_association":"CONTRIBUTOR","body":"> Thank you for this contribution @vanliu-tx! This is a great find.\r\n> \r\n> The test is quite extensive. I left a few nits, but mostly I'm wondering if there's any kind of simpler way to test for this, like checking the sequence number of planned files after applying a delete.\r\n> \r\n> It might not be something that can be made much simpler though without refactoring the code more.\r\n> \r\n> cc @rdblue @RussellSpitzer @szehon-ho @jackye1995 you'll likely be interested in this.\r\n\r\nadded some verification for manifest sequence number and min sequence number.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091054373/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091148289","html_url":"https://github.com/apache/iceberg/issues/4457#issuecomment-1091148289","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4457","id":1091148289,"node_id":"IC_kwDOCW7NX85BCZoB","user":{"login":"yeshvantbhavnasi","id":20260478,"node_id":"MDQ6VXNlcjIwMjYwNDc4","avatar_url":"https://avatars.githubusercontent.com/u/20260478?v=4","gravatar_id":"","url":"https://api.github.com/users/yeshvantbhavnasi","html_url":"https://github.com/yeshvantbhavnasi","followers_url":"https://api.github.com/users/yeshvantbhavnasi/followers","following_url":"https://api.github.com/users/yeshvantbhavnasi/following{/other_user}","gists_url":"https://api.github.com/users/yeshvantbhavnasi/gists{/gist_id}","starred_url":"https://api.github.com/users/yeshvantbhavnasi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeshvantbhavnasi/subscriptions","organizations_url":"https://api.github.com/users/yeshvantbhavnasi/orgs","repos_url":"https://api.github.com/users/yeshvantbhavnasi/repos","events_url":"https://api.github.com/users/yeshvantbhavnasi/events{/privacy}","received_events_url":"https://api.github.com/users/yeshvantbhavnasi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T06:57:54Z","updated_at":"2022-04-07T06:57:54Z","author_association":"NONE","body":"I guess this is becuase of hadoop s3 connector not trying to reconnect. \r\nThis is on a simple IcebergRead causing an exception","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091148289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091164680","html_url":"https://github.com/apache/iceberg/pull/4521#issuecomment-1091164680","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4521","id":1091164680,"node_id":"IC_kwDOCW7NX85BCdoI","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T07:17:26Z","updated_at":"2022-04-07T07:17:26Z","author_association":"MEMBER","body":"The failure case is : \r\n\r\n```\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyFieldsAtEndOfTableSchema[catalogName=testhadoop, baseNamespace=default, format=PARQUET, isStreaming=true] FAILED\r\n    java.lang.AssertionError: \r\n    Expecting:\r\n      [+I[3, bbb, 2022-03-01], +I[1, aaa, 2022-03-01]]\r\n    to contain exactly in any order:\r\n      [+I[2, aaa, 2022-03-01], +I[3, bbb, 2022-03-01]]\r\n    elements not found:\r\n      [+I[2, aaa, 2022-03-01]]\r\n    and elements not expected:\r\n      [+I[1, aaa, 2022-03-01]]\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:137)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyFieldsAtEndOfTableSchema(TestFlinkUpsert.java:262)\r\n```\r\n\r\nLet's discuss there : https://github.com/apache/iceberg/issues/4515 . \r\n\r\nThis PR looks good to me overall.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091164680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091167403","html_url":"https://github.com/apache/iceberg/pull/4521#issuecomment-1091167403","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4521","id":1091167403,"node_id":"IC_kwDOCW7NX85BCeSr","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T07:20:44Z","updated_at":"2022-04-07T07:20:44Z","author_association":"CONTRIBUTOR","body":"Thanks @openinx.\r\n\r\nI touched this failure case twice recently.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091167403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091173725","html_url":"https://github.com/apache/iceberg/issues/4515#issuecomment-1091173725","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4515","id":1091173725,"node_id":"IC_kwDOCW7NX85BCf1d","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T07:24:11Z","updated_at":"2022-04-07T07:25:42Z","author_association":"CONTRIBUTOR","body":"[Another case](https://github.com/apache/iceberg/runs/5834902185?check_suite_focus=true) failed in `testPrimaryKeyFieldsAtBeginningOfSchema`\r\n\r\n```\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyFieldsAtBeginningOfSchema[catalogName=testhadoop, baseNamespace=default, format=PARQUET, isStreaming=true] FAILED\r\n    java.lang.AssertionError: \r\n    Expecting:\r\n      [+I[bbb, 2022-03-01, 3], +I[aaa, 2022-03-01, 1]]\r\n    to contain exactly in any order:\r\n      [+I[aaa, 2022-03-01, 2], +I[bbb, 2022-03-01, 3]]\r\n    elements not found:\r\n      [+I[aaa, 2022-03-01, 2]]\r\n    and elements not expected:\r\n      [+I[aaa, 2022-03-01, 1]]\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:137)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyFieldsAtBeginningOfSchema(TestFlinkUpsert.java:[219](https://github.com/apache/iceberg/runs/5834902185?check_suite_focus=true#step:6:219))\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091173725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091193076","html_url":"https://github.com/apache/iceberg/pull/4509#issuecomment-1091193076","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4509","id":1091193076,"node_id":"IC_kwDOCW7NX85BCkj0","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T07:34:34Z","updated_at":"2022-04-07T07:34:34Z","author_association":"MEMBER","body":"@openinx : Thanks for merging.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091193076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091229904","html_url":"https://github.com/apache/iceberg/issues/4515#issuecomment-1091229904","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4515","id":1091229904,"node_id":"IC_kwDOCW7NX85BCtjQ","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T07:53:40Z","updated_at":"2022-04-07T07:55:21Z","author_association":"CONTRIBUTOR","body":"After some investigate, i found the Values is not really one operator node with tuple list, instead it derived three parallel Calc nodes due to some cast.\r\nSo the order can not be guaranteed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091229904/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091233585","html_url":"https://github.com/apache/iceberg/issues/4515#issuecomment-1091233585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4515","id":1091233585,"node_id":"IC_kwDOCW7NX85BCucx","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T07:55:32Z","updated_at":"2022-04-07T07:55:32Z","author_association":"CONTRIBUTOR","body":"So let's split it to two statements if we still use the same way for creating data.\r\n\r\nWDYT, @openinx","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091233585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091262450","html_url":"https://github.com/apache/iceberg/pull/4517#issuecomment-1091262450","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4517","id":1091262450,"node_id":"IC_kwDOCW7NX85BC1fy","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T08:10:14Z","updated_at":"2022-04-07T08:27:01Z","author_association":"CONTRIBUTOR","body":"Thanks @SreeramGarlapati !!! for sharing the https://github.com/apache/iceberg/pull/2660#discussion_r650154461 thread, it really helps. Glad to know it was already considered while the implementation. \r\n\r\nIt looks like we were on the fence to establish the reliability of this metric and hence decided to re-visit it in future, refering this comment https://github.com/apache/iceberg/pull/2660#discussion_r650322788\r\n\r\n > SnapshotSummary is a free form dictionary & ADDED_FILES_PROP as a key in this dictionary - is NOT added to [Iceberg Spec](https://iceberg.apache.org/spec/#snapshots)\r\n\r\nAgree with you on this.\r\n\r\n> is not NOT populated by all engines yet\r\n\r\nAs per my understanding engines don't own the responsibility of calculating / updating the snapshot summary stats, IIUC it's done entirely by core library. The flow for ex : [commit() [from engine]](https://github.com/apache/iceberg/blob/master/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/source/SparkPositionDeltaWrite.java#L251) -> [apply() in SnapshotProducer (core)](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/SnapshotProducer.java#L296) -> [Summary calculation (core)](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/SnapshotProducer.java#L202-L210).\r\nAm I missing something here ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091262450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091306649","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091306649","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091306649,"node_id":"IC_kwDOCW7NX85BDASZ","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T08:29:44Z","updated_at":"2022-04-07T08:29:44Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar gave a pretty good high-level summary of Nessie vs Iceberg (thanks for that). @melin is that sufficient for you at this point to understand the differences or would you like me to get into more details?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091306649/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091318828","html_url":"https://github.com/apache/iceberg/issues/4523#issuecomment-1091318828","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4523","id":1091318828,"node_id":"IC_kwDOCW7NX85BDDQs","user":{"login":"kyle-cx91","id":10529123,"node_id":"MDQ6VXNlcjEwNTI5MTIz","avatar_url":"https://avatars.githubusercontent.com/u/10529123?v=4","gravatar_id":"","url":"https://api.github.com/users/kyle-cx91","html_url":"https://github.com/kyle-cx91","followers_url":"https://api.github.com/users/kyle-cx91/followers","following_url":"https://api.github.com/users/kyle-cx91/following{/other_user}","gists_url":"https://api.github.com/users/kyle-cx91/gists{/gist_id}","starred_url":"https://api.github.com/users/kyle-cx91/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kyle-cx91/subscriptions","organizations_url":"https://api.github.com/users/kyle-cx91/orgs","repos_url":"https://api.github.com/users/kyle-cx91/repos","events_url":"https://api.github.com/users/kyle-cx91/events{/privacy}","received_events_url":"https://api.github.com/users/kyle-cx91/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T08:35:24Z","updated_at":"2022-04-24T01:46:21Z","author_association":"CONTRIBUTOR","body":"Is this a bug or the api is not available for metadata tables. if this API just not available for metadata tables, do we have a Java API to query metadata table records?\r\n\r\ncc: @RussellSpitzer @samredai ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091318828/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091383641","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091383641","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091383641,"node_id":"IC_kwDOCW7NX85BDTFZ","user":{"login":"melin","id":1145830,"node_id":"MDQ6VXNlcjExNDU4MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1145830?v=4","gravatar_id":"","url":"https://api.github.com/users/melin","html_url":"https://github.com/melin","followers_url":"https://api.github.com/users/melin/followers","following_url":"https://api.github.com/users/melin/following{/other_user}","gists_url":"https://api.github.com/users/melin/gists{/gist_id}","starred_url":"https://api.github.com/users/melin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melin/subscriptions","organizations_url":"https://api.github.com/users/melin/orgs","repos_url":"https://api.github.com/users/melin/repos","events_url":"https://api.github.com/users/melin/events{/privacy}","received_events_url":"https://api.github.com/users/melin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T09:06:59Z","updated_at":"2022-04-07T09:06:59Z","author_association":"NONE","body":"> @amogh-jahagirdar gave a pretty good high-level summary of Nessie vs Iceberg (thanks for that). @melin is that sufficient for you at this point to understand the differences or would you like me to get into more details?\r\n\r\nCatalog branch is too large, table branch is too small, database branch is supported?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091383641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091399011","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091399011","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091399011,"node_id":"IC_kwDOCW7NX85BDW1j","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T09:15:19Z","updated_at":"2022-04-07T09:15:19Z","author_association":"CONTRIBUTOR","body":"do you mean whether branching at the database level is supported? Maybe you could describe the use case you have in mind, so that I can better understand your requirements.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091399011/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091422796","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1091422796","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1091422796,"node_id":"IC_kwDOCW7NX85BDcpM","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T09:29:08Z","updated_at":"2022-04-07T09:29:08Z","author_association":"CONTRIBUTOR","body":"@rbalamohan:\r\nDo I understand correctly that the maximum size of `expr` is the same as the `residuals`, and it could be smaller if the partition values would prevent specific parts of the expression to change the results of the expression? Like if the `residuals` would say `date<2022 Jan 15` and the file contains `year(date)=2021`?\r\n\r\nIs there any edge case when the `expr` is bigger than the `residuals`?\r\n\r\nWhat is the CPU cost of calculating the `expr`? @rdblue: Are there any places in the Iceberg code where we create the filter but do not call the `residuals()` method?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091422796/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091427998","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091427998","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091427998,"node_id":"IC_kwDOCW7NX85BDd6e","user":{"login":"melin","id":1145830,"node_id":"MDQ6VXNlcjExNDU4MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1145830?v=4","gravatar_id":"","url":"https://api.github.com/users/melin","html_url":"https://github.com/melin","followers_url":"https://api.github.com/users/melin/followers","following_url":"https://api.github.com/users/melin/following{/other_user}","gists_url":"https://api.github.com/users/melin/gists{/gist_id}","starred_url":"https://api.github.com/users/melin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melin/subscriptions","organizations_url":"https://api.github.com/users/melin/orgs","repos_url":"https://api.github.com/users/melin/repos","events_url":"https://api.github.com/users/melin/events{/privacy}","received_events_url":"https://api.github.com/users/melin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T09:33:40Z","updated_at":"2022-04-07T09:35:39Z","author_association":"NONE","body":"In many cases, there is only one catalog. Generally, each department or team is assigned a database. It is difficult to require all teams to switch to the same branch. The cost of collaboration is too high, and it is even difficult to implement. The granularity of the database branch is more appropriate.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091427998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091437858","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091437858","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091437858,"node_id":"IC_kwDOCW7NX85BDgUi","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T09:42:28Z","updated_at":"2022-04-07T09:42:28Z","author_association":"CONTRIBUTOR","body":"In such a scenario, all teams would eventually merge their work into the main line (`main` branch), but each team could work on their own branch? Or is each database completely isolated from one another? If so, then each team could have their own nessie repository","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091437858/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091439223","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091439223","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091439223,"node_id":"IC_kwDOCW7NX85BDgp3","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T09:43:49Z","updated_at":"2022-04-07T09:43:49Z","author_association":"CONTRIBUTOR","body":"@melin also feel free to ping me on Slack to talk about details/approaches to your use case","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091439223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091698122","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-1091698122","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":1091698122,"node_id":"IC_kwDOCW7NX85BEf3K","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T12:52:27Z","updated_at":"2022-04-07T12:52:27Z","author_association":"COLLABORATOR","body":"@flyrain @jackye1995  In our scenario, the speed of major compaction for equality delete cannot catch up with the production speed.  So I think this is necessary for some CDC cases. I can rebase this and update if you guys are interested in this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091698122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091765832","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1091765832","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1091765832,"node_id":"IC_kwDOCW7NX85BEwZI","user":{"login":"rbalamohan","id":7969713,"node_id":"MDQ6VXNlcjc5Njk3MTM=","avatar_url":"https://avatars.githubusercontent.com/u/7969713?v=4","gravatar_id":"","url":"https://api.github.com/users/rbalamohan","html_url":"https://github.com/rbalamohan","followers_url":"https://api.github.com/users/rbalamohan/followers","following_url":"https://api.github.com/users/rbalamohan/following{/other_user}","gists_url":"https://api.github.com/users/rbalamohan/gists{/gist_id}","starred_url":"https://api.github.com/users/rbalamohan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rbalamohan/subscriptions","organizations_url":"https://api.github.com/users/rbalamohan/orgs","repos_url":"https://api.github.com/users/rbalamohan/repos","events_url":"https://api.github.com/users/rbalamohan/events{/privacy}","received_events_url":"https://api.github.com/users/rbalamohan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T13:50:52Z","updated_at":"2022-04-07T13:50:52Z","author_association":"CONTRIBUTOR","body":"Residuals are evaluated earlier to create the \"expression\" upfront. Computed expression (string) is much smaller than residual memory as it need not retain the literals. \r\n\r\nIn the case I mentioned earlier, it retained 79000 LongLiterals which caused memory spikes as this was serialized in every split in Hive. With this change, expression is computed upfront and residuals need not be carried forward and thus reduces memory pressure. In the case you mentioned, expression gets evaluated to \"true/false\" upfront and thus reduces memory pressure. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091765832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091834780","html_url":"https://github.com/apache/iceberg/pull/2372#issuecomment-1091834780","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2372","id":1091834780,"node_id":"IC_kwDOCW7NX85BFBOc","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T14:48:24Z","updated_at":"2022-04-07T14:48:58Z","author_association":"COLLABORATOR","body":"Hmm, Looks like the change data feed may need to read deleted rows as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091834780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091923091","html_url":"https://github.com/apache/iceberg/issues/4476#issuecomment-1091923091","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4476","id":1091923091,"node_id":"IC_kwDOCW7NX85BFWyT","user":{"login":"melin","id":1145830,"node_id":"MDQ6VXNlcjExNDU4MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1145830?v=4","gravatar_id":"","url":"https://api.github.com/users/melin","html_url":"https://github.com/melin","followers_url":"https://api.github.com/users/melin/followers","following_url":"https://api.github.com/users/melin/following{/other_user}","gists_url":"https://api.github.com/users/melin/gists{/gist_id}","starred_url":"https://api.github.com/users/melin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melin/subscriptions","organizations_url":"https://api.github.com/users/melin/orgs","repos_url":"https://api.github.com/users/melin/repos","events_url":"https://api.github.com/users/melin/events{/privacy}","received_events_url":"https://api.github.com/users/melin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T16:07:00Z","updated_at":"2022-04-07T16:07:00Z","author_association":"NONE","body":"Git features may not be needed by all teams, and may be used more often by warehouse teams, which are more flexible if they support Database Branch","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091923091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091936456","html_url":"https://github.com/apache/iceberg/pull/4512#issuecomment-1091936456","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4512","id":1091936456,"node_id":"IC_kwDOCW7NX85BFaDI","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T16:13:10Z","updated_at":"2022-04-07T16:13:10Z","author_association":"CONTRIBUTOR","body":"Thanks @rbalamohan, this is very promising!\r\n\r\n@rdblue: Any concerns?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091936456/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091995702","html_url":"https://github.com/apache/iceberg/pull/4520#issuecomment-1091995702","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4520","id":1091995702,"node_id":"IC_kwDOCW7NX85BFog2","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T17:12:16Z","updated_at":"2022-04-07T17:12:16Z","author_association":"COLLABORATOR","body":"Thanks to @aokolnychyi for finding it in https://github.com/apache/iceberg/pull/4382#issuecomment-1087866951 and before.\r\n\r\nFYI @RussellSpitzer @rdblue seems its bad issue for tables with changed partitions specs, as files table may return less results with a filter.  It's present in 0.12 and 0.13 release, and I think a good candidate for 0.13.2 release.  Sorry I did not check this case initially.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1091995702/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092005839","html_url":"https://github.com/apache/iceberg/pull/4456#issuecomment-1092005839","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4456","id":1092005839,"node_id":"IC_kwDOCW7NX85BFq_P","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T17:24:29Z","updated_at":"2022-04-07T17:25:00Z","author_association":"CONTRIBUTOR","body":"Talked to @szehon-ho offline. We will give a default value for the HIVE_TABLE_PROPERTY_SIZE, while allowing user to configure it with different number due to a variety of HMS backends.\r\n> Oracle DB's varchar2 supports 32767 bytes now, by setting the configuration parameter MAX_STRING_SIZE to EXTENDED. ([source](http://docs.oracle.com/database/121/SQLRF/sql_elements001.htm#SQLRF55623))\r\n> Postgres supports a max of 1GB for character datatype. ([source](http://www.postgresql.org/docs/8.3/static/datatype-character.html))\r\n> MySQL can support upto 65535 bytes for the entire row. So long as the PARAM_KEY value + PARAM_VALUE is less than 65535, we should be good. ([source](http://dev.mysql.com/doc/refman/5.0/en/char.html))\r\n> SQL Server's varchar max length is 8000 and can go beyond using \"varchar(max)\" with the same limitation as MySQL being 65535 bytes for the entire row. ([source](http://dev.mysql.com/doc/refman/5.0/en/char.html))\r\n> Derby's varchar can be upto 32672 bytes. ([source](https://db.apache.org/derby/docs/10.7/ref/rrefsqlj41207.html))\r\n\r\nhttps://issues.apache.org/jira/browse/HIVE-12274","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092005839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092128396","html_url":"https://github.com/apache/iceberg/pull/4518#issuecomment-1092128396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4518","id":1092128396,"node_id":"IC_kwDOCW7NX85BGI6M","user":{"login":"rizaon","id":6033430,"node_id":"MDQ6VXNlcjYwMzM0MzA=","avatar_url":"https://avatars.githubusercontent.com/u/6033430?v=4","gravatar_id":"","url":"https://api.github.com/users/rizaon","html_url":"https://github.com/rizaon","followers_url":"https://api.github.com/users/rizaon/followers","following_url":"https://api.github.com/users/rizaon/following{/other_user}","gists_url":"https://api.github.com/users/rizaon/gists{/gist_id}","starred_url":"https://api.github.com/users/rizaon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rizaon/subscriptions","organizations_url":"https://api.github.com/users/rizaon/orgs","repos_url":"https://api.github.com/users/rizaon/repos","events_url":"https://api.github.com/users/rizaon/events{/privacy}","received_events_url":"https://api.github.com/users/rizaon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T19:37:05Z","updated_at":"2022-04-07T19:37:05Z","author_association":"CONTRIBUTOR","body":"[485e2ab](https://github.com/apache/iceberg/pull/4518/commits/485e2abf4bb3c67f7ab0db2e5cf2e78397bf25db) Switch ManifestCache class to use Guava Cache instead. This is easier to do in iceberg-api since we can simply include the Guava cache classes into the shadow jar of iceberg-bundled-guava.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092128396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092277916","html_url":"https://github.com/apache/iceberg/pull/4456#issuecomment-1092277916","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4456","id":1092277916,"node_id":"IC_kwDOCW7NX85BGtac","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-07T22:46:41Z","updated_at":"2022-04-07T22:46:41Z","author_association":"CONTRIBUTOR","body":"The failed test should not be related.\r\n```\r\norg.apache.iceberg.flink.TestFlinkUpsert > testPrimaryKeyFieldsAtEndOfTableSchema[catalogName=testhadoop, baseNamespace=default, format=PARQUET, isStreaming=true] FAILED\r\n    java.lang.AssertionError: \r\n    Expecting:\r\n      [+I[3, bbb, 2022-03-01], +I[1, aaa, 2022-03-01]]\r\n    to contain exactly in any order:\r\n      [+I[2, aaa, 2022-03-01], +I[3, bbb, 2022-03-01]]\r\n    elements not found:\r\n      [+I[2, aaa, 2022-03-01]]\r\n    and elements not expected:\r\n      [+I[1, aaa, 2022-03-01]]\r\n        at org.apache.iceberg.flink.TestHelpers.assertRows(TestHelpers.java:137)\r\n        at org.apache.iceberg.flink.TestFlinkUpsert.testPrimaryKeyFieldsAtEndOfTableSchema(TestFlinkUpsert.java:262)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092277916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092382394","html_url":"https://github.com/apache/iceberg/pull/4524#issuecomment-1092382394","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4524","id":1092382394,"node_id":"IC_kwDOCW7NX85BHG66","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T02:29:25Z","updated_at":"2022-04-08T02:29:25Z","author_association":"MEMBER","body":"Got this merged, thanks all for reviewing !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092382394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092385581","html_url":"https://github.com/apache/iceberg/pull/4526#issuecomment-1092385581","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4526","id":1092385581,"node_id":"IC_kwDOCW7NX85BHHst","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T02:37:39Z","updated_at":"2022-04-08T02:37:39Z","author_association":"MEMBER","body":"Thanks @chenjunjiedada for the contribution!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092385581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092390516","html_url":"https://github.com/apache/iceberg/pull/4519#issuecomment-1092390516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4519","id":1092390516,"node_id":"IC_kwDOCW7NX85BHI50","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T02:50:32Z","updated_at":"2022-04-08T02:50:32Z","author_association":"MEMBER","body":"> Because Flink 1.12 has been deprecated, it was decided that we should disable upsert mode in Flink 1.12 for the upcoming patch release, Iceberg 0.13.2.\r\n\r\nWill it be better to remove the flink 1.12 in the next iceberg release 0.14.0 ?  As iceberg 0.13.2 is a bugfix release for the 0.13.x,  Clearing the support for flink 1.12 does not sounds reasonable for me.  I would like to port the #4418 into the flink 1.12,  and once we decided to remove this we just need to remove the whole flink/v1.12 directory.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092390516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092396568","html_url":"https://github.com/apache/iceberg/issues/4515#issuecomment-1092396568","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4515","id":1092396568,"node_id":"IC_kwDOCW7NX85BHKYY","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T03:05:38Z","updated_at":"2022-04-08T03:05:38Z","author_association":"MEMBER","body":"> After some investigate, i found the Values is not really one operator node with tuple list, instead it derived three parallel Calc nodes due to some cast.\r\n\r\nCould you please provide the flink code reference where we dispatched the values into multiple parallelism ? Actually,  I don't find the place...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092396568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092509800","html_url":"https://github.com/apache/iceberg/pull/4511#issuecomment-1092509800","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4511","id":1092509800,"node_id":"IC_kwDOCW7NX85BHmBo","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-04-08T07:03:19Z","updated_at":"2022-04-08T07:03:19Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer @openinx Can you please help in merging this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1092509800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]