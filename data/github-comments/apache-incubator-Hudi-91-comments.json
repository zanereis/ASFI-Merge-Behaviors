[{"url":"https://api.github.com/repos/apache/hudi/issues/comments/732519135","html_url":"https://github.com/apache/hudi/issues/2273#issuecomment-732519135","issue_url":"https://api.github.com/repos/apache/hudi/issues/2273","id":732519135,"node_id":"MDEyOklzc3VlQ29tbWVudDczMjUxOTEzNQ==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T01:15:06Z","updated_at":"2020-11-24T01:15:06Z","author_association":"NONE","body":"thanks @bvaradar. I have worked out the format","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/732519135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/732520632","html_url":"https://github.com/apache/hudi/issues/2270#issuecomment-732520632","issue_url":"https://api.github.com/repos/apache/hudi/issues/2270","id":732520632,"node_id":"MDEyOklzc3VlQ29tbWVudDczMjUyMDYzMg==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T01:19:50Z","updated_at":"2020-11-24T01:19:50Z","author_association":"NONE","body":"Sure, thanks @bvaradar. I am closing the issue.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/732520632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/732657229","html_url":"https://github.com/apache/hudi/issues/2258#issuecomment-732657229","issue_url":"https://api.github.com/repos/apache/hudi/issues/2258","id":732657229,"node_id":"MDEyOklzc3VlQ29tbWVudDczMjY1NzIyOQ==","user":{"login":"bhushanamk","id":73978482,"node_id":"MDQ6VXNlcjczOTc4NDgy","avatar_url":"https://avatars.githubusercontent.com/u/73978482?v=4","gravatar_id":"","url":"https://api.github.com/users/bhushanamk","html_url":"https://github.com/bhushanamk","followers_url":"https://api.github.com/users/bhushanamk/followers","following_url":"https://api.github.com/users/bhushanamk/following{/other_user}","gists_url":"https://api.github.com/users/bhushanamk/gists{/gist_id}","starred_url":"https://api.github.com/users/bhushanamk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhushanamk/subscriptions","organizations_url":"https://api.github.com/users/bhushanamk/orgs","repos_url":"https://api.github.com/users/bhushanamk/repos","events_url":"https://api.github.com/users/bhushanamk/events{/privacy}","received_events_url":"https://api.github.com/users/bhushanamk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T05:11:20Z","updated_at":"2020-11-24T05:11:42Z","author_association":"NONE","body":"@bhasudha ,using Presto 0.238.3 which came along with  the  emr emr-5.31.0","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/732657229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/732670918","html_url":"https://github.com/apache/hudi/pull/2243#issuecomment-732670918","issue_url":"https://api.github.com/repos/apache/hudi/issues/2243","id":732670918,"node_id":"MDEyOklzc3VlQ29tbWVudDczMjY3MDkxOA==","user":{"login":"yui2010","id":3294003,"node_id":"MDQ6VXNlcjMyOTQwMDM=","avatar_url":"https://avatars.githubusercontent.com/u/3294003?v=4","gravatar_id":"","url":"https://api.github.com/users/yui2010","html_url":"https://github.com/yui2010","followers_url":"https://api.github.com/users/yui2010/followers","following_url":"https://api.github.com/users/yui2010/following{/other_user}","gists_url":"https://api.github.com/users/yui2010/gists{/gist_id}","starred_url":"https://api.github.com/users/yui2010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yui2010/subscriptions","organizations_url":"https://api.github.com/users/yui2010/orgs","repos_url":"https://api.github.com/users/yui2010/repos","events_url":"https://api.github.com/users/yui2010/events{/privacy}","received_events_url":"https://api.github.com/users/yui2010/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T05:55:05Z","updated_at":"2020-11-24T05:55:05Z","author_association":"CONTRIBUTOR","body":"\r\nhi, garyli1019 \r\n\r\n    i try to describe it clearly\r\n\r\n        set hoodie.datasource.write.hive_style_partitioning->true\r\n        spark.read().format(\"org.apache.hudi\").option(\"mergeSchema\", true).option(\"basePath\",tablePath).load(tablePath + (nonPartitionedTable ? \"/\" : \"/\")).createOrReplaceTempView(hudiTable);\r\n        spark.sql(\"select * from hudiTable where date>'20200807'\").explain();\r\n\r\nstep 1. spark  read datasource  (https://github.com/apache/spark/blob/v2.4.4/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/DataSource.scala L 317)\r\n\r\n          case (dataSource: RelationProvider, None) => dataSource.createRelation(sparkSession.sqlContext, caseInsensitiveOptions)  //**caseInsensitiveOptions CaseInsensitiveMap type**\r\n\r\nstep 2. hudi  create relation\r\n         org.apache.hudi.DefaultSource#createRelation(sqlContext: SQLContext,optParams: Map[String, String],schema: StructType): BaseRelation = {\r\n\r\n         // the type optParams is CaseInsensitiveMap. and **parameters type will be converted to Map thought Map ++**\r\n         val parameters = Map(QUERY_TYPE_OPT_KEY -> DEFAULT_QUERY_TYPE_OPT_VAL) ++ translateViewTypesToQueryTypes(optParams)\r\n\r\nstep 3. hudi  transform to parquet relation if we query table(cow type) data \r\n         then it will call getBaseFileOnlyView(sqlContext, parameters, schema, readPaths, isBootstrappedTable, globPaths, metaClient)\r\n\r\nit will create new Datasource and relation instance with : DataSource.apply(sparkSession = sqlContext.sparkSession,paths = extraReadPaths,userSpecifiedSchema = Option(schema),className = \"parquet\",options = optParams).resolveRelation()\r\n\r\nstep 4. spark fetch basePath for infer partition info (https://github.com/apache/spark/blob/v2.4.4/sql/core/src/main/scala/org/apache/spark/sql/execution/datasources/PartitioningAwareFileIndex.scala L196)\r\n           //the parameters come from DataSource #options (map type)\r\n          parameters.get(BASE_PATH_PARAM) \r\n          so parameters.get(BASE_PATH_PARAM) will call Map#get not CaseInsensitiveMap#get. and parameters stored “bathpath” . get “bathPath” will return None\r\n\r\nthis is a spark bug (fixed at 3.0.1 version https://issues.apache.org/jira/browse/SPARK-32368) hudi current used spark v2.4.4 .\r\nin order to avoid this spark issure  a simple solution is we can not convert the input optParams type(spark already make it  CaseInsensitiveMap type) in org.apache.hudi.DefaultSource#createRelation(sqlContext: SQLContext,optParams: Map[String, String]…\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/732670918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733020702","html_url":"https://github.com/apache/hudi/pull/2278#issuecomment-733020702","issue_url":"https://api.github.com/repos/apache/hudi/issues/2278","id":733020702,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzAyMDcwMg==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T14:47:18Z","updated_at":"2020-12-05T07:02:53Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2278?src=pr&el=h1) Report\n> Merging [#2278](https://codecov.io/gh/apache/hudi/pull/2278?src=pr&el=desc) (2d1275f) into [master](https://codecov.io/gh/apache/hudi/commit/62b392b49c13455199e0372204dedf8a371b452c?el=desc) (62b392b) will **decrease** coverage by `0.01%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2278/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2278?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2278      +/-   ##\n============================================\n- Coverage     53.50%   53.49%   -0.02%     \n  Complexity     2788     2788              \n============================================\n  Files           355      355              \n  Lines         16169    16169              \n  Branches       1650     1650              \n============================================\n- Hits           8651     8649       -2     \n- Misses         6818     6819       +1     \n- Partials        700      701       +1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `38.50% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `55.08% <ø> (-0.03%)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `32.94% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudispark | `66.01% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `65.30% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `70.10% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2278?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2278/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `77.11% <0.00%> (-1.70%)` | `23.00% <0.00%> (ø%)` | |\n| [...n/scala/org/apache/hudi/HoodieSparkSqlWriter.scala](https://codecov.io/gh/apache/hudi/pull/2278/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL2h1ZGkvSG9vZGllU3BhcmtTcWxXcml0ZXIuc2NhbGE=) | `52.07% <0.00%> (ø)` | `0.00% <0.00%> (ø%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733020702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733022202","html_url":"https://github.com/apache/hudi/pull/2278#issuecomment-733022202","issue_url":"https://api.github.com/repos/apache/hudi/issues/2278","id":733022202,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzAyMjIwMg==","user":{"login":"wangxianghu","id":49835526,"node_id":"MDQ6VXNlcjQ5ODM1NTI2","avatar_url":"https://avatars.githubusercontent.com/u/49835526?v=4","gravatar_id":"","url":"https://api.github.com/users/wangxianghu","html_url":"https://github.com/wangxianghu","followers_url":"https://api.github.com/users/wangxianghu/followers","following_url":"https://api.github.com/users/wangxianghu/following{/other_user}","gists_url":"https://api.github.com/users/wangxianghu/gists{/gist_id}","starred_url":"https://api.github.com/users/wangxianghu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangxianghu/subscriptions","organizations_url":"https://api.github.com/users/wangxianghu/orgs","repos_url":"https://api.github.com/users/wangxianghu/repos","events_url":"https://api.github.com/users/wangxianghu/events{/privacy}","received_events_url":"https://api.github.com/users/wangxianghu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T14:49:36Z","updated_at":"2020-11-24T14:49:36Z","author_association":"CONTRIBUTOR","body":"@yanghua please take a look when free","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733022202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733026404","html_url":"https://github.com/apache/hudi/pull/2271#issuecomment-733026404","issue_url":"https://api.github.com/repos/apache/hudi/issues/2271","id":733026404,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzAyNjQwNA==","user":{"login":"wangxianghu","id":49835526,"node_id":"MDQ6VXNlcjQ5ODM1NTI2","avatar_url":"https://avatars.githubusercontent.com/u/49835526?v=4","gravatar_id":"","url":"https://api.github.com/users/wangxianghu","html_url":"https://github.com/wangxianghu","followers_url":"https://api.github.com/users/wangxianghu/followers","following_url":"https://api.github.com/users/wangxianghu/following{/other_user}","gists_url":"https://api.github.com/users/wangxianghu/gists{/gist_id}","starred_url":"https://api.github.com/users/wangxianghu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangxianghu/subscriptions","organizations_url":"https://api.github.com/users/wangxianghu/orgs","repos_url":"https://api.github.com/users/wangxianghu/repos","events_url":"https://api.github.com/users/wangxianghu/events{/privacy}","received_events_url":"https://api.github.com/users/wangxianghu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T14:55:57Z","updated_at":"2020-11-24T14:55:57Z","author_association":"CONTRIBUTOR","body":"blocked by https://github.com/apache/hudi/pull/2278","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733026404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733174238","html_url":"https://github.com/apache/hudi/issues/2269#issuecomment-733174238","issue_url":"https://api.github.com/repos/apache/hudi/issues/2269","id":733174238,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzE3NDIzOA==","user":{"login":"asharma4-lucid","id":64492084,"node_id":"MDQ6VXNlcjY0NDkyMDg0","avatar_url":"https://avatars.githubusercontent.com/u/64492084?v=4","gravatar_id":"","url":"https://api.github.com/users/asharma4-lucid","html_url":"https://github.com/asharma4-lucid","followers_url":"https://api.github.com/users/asharma4-lucid/followers","following_url":"https://api.github.com/users/asharma4-lucid/following{/other_user}","gists_url":"https://api.github.com/users/asharma4-lucid/gists{/gist_id}","starred_url":"https://api.github.com/users/asharma4-lucid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asharma4-lucid/subscriptions","organizations_url":"https://api.github.com/users/asharma4-lucid/orgs","repos_url":"https://api.github.com/users/asharma4-lucid/repos","events_url":"https://api.github.com/users/asharma4-lucid/events{/privacy}","received_events_url":"https://api.github.com/users/asharma4-lucid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T19:03:43Z","updated_at":"2020-11-24T19:03:43Z","author_association":"NONE","body":"Thanks @bvaradar. I tried to insert just 5 records to the existing table with ~300K partitions and it took close to ~5 hrs. If I insert ~5 records in a new table it takes less than 2 mins. Is this extra time of ~5 hrs all because of cleaner and compaction processes? For our use case, we mostly get inserts. With that in mind, would it be beneficial for us if we switch to MOR from COW and do async compaction (I am most likely making an incorrect assumption that this huge extra processing time is only because of compaction) ? And also, since our data does not have frequent record level updates, would switching to MOR make any difference?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733174238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733204015","html_url":"https://github.com/apache/hudi/pull/2208#issuecomment-733204015","issue_url":"https://api.github.com/repos/apache/hudi/issues/2208","id":733204015,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzIwNDAxNQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T20:04:46Z","updated_at":"2020-11-24T20:04:46Z","author_association":"MEMBER","body":"@giaosudau that seems like JVM crash. Not sure what in this PR could crash that.\r\nDo you have more diagnostic info? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733204015/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733299492","html_url":"https://github.com/apache/hudi/issues/2269#issuecomment-733299492","issue_url":"https://api.github.com/repos/apache/hudi/issues/2269","id":733299492,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzI5OTQ5Mg==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T23:43:54Z","updated_at":"2020-11-24T23:43:54Z","author_association":"CONTRIBUTOR","body":"@asharma4-lucid : ~5hrs is way too much. Can you disable cleaning using the config hoodie.clean.automatic=false and try. Is this a COW table ?\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733299492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733304908","html_url":"https://github.com/apache/hudi/issues/2276#issuecomment-733304908","issue_url":"https://api.github.com/repos/apache/hudi/issues/2276","id":733304908,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzMwNDkwOA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T23:47:48Z","updated_at":"2020-11-24T23:47:48Z","author_association":"CONTRIBUTOR","body":"You can use hudi-cli and use \"compactions show all\" to list compactions and find the timestamp of one that is pending. \r\nAnother option is to list .hoodie folder and find all the files <ts>.compaction.requested where there is no corresponding <ts>.commit file present. These are the pending compactions which you can use to run compaction.\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733304908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733305873","html_url":"https://github.com/apache/hudi/issues/2277#issuecomment-733305873","issue_url":"https://api.github.com/repos/apache/hudi/issues/2277","id":733305873,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzMwNTg3Mw==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-24T23:48:30Z","updated_at":"2020-11-24T23:48:30Z","author_association":"CONTRIBUTOR","body":"@umehrot2 : Can you please take a look at this ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733305873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733323629","html_url":"https://github.com/apache/hudi/issues/2269#issuecomment-733323629","issue_url":"https://api.github.com/repos/apache/hudi/issues/2269","id":733323629,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzMyMzYyOQ==","user":{"login":"asharma4-lucid","id":64492084,"node_id":"MDQ6VXNlcjY0NDkyMDg0","avatar_url":"https://avatars.githubusercontent.com/u/64492084?v=4","gravatar_id":"","url":"https://api.github.com/users/asharma4-lucid","html_url":"https://github.com/asharma4-lucid","followers_url":"https://api.github.com/users/asharma4-lucid/followers","following_url":"https://api.github.com/users/asharma4-lucid/following{/other_user}","gists_url":"https://api.github.com/users/asharma4-lucid/gists{/gist_id}","starred_url":"https://api.github.com/users/asharma4-lucid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asharma4-lucid/subscriptions","organizations_url":"https://api.github.com/users/asharma4-lucid/orgs","repos_url":"https://api.github.com/users/asharma4-lucid/repos","events_url":"https://api.github.com/users/asharma4-lucid/events{/privacy}","received_events_url":"https://api.github.com/users/asharma4-lucid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T00:01:38Z","updated_at":"2020-11-25T00:01:38Z","author_association":"NONE","body":"Yes this is a COW table.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733323629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733426822","html_url":"https://github.com/apache/hudi/pull/2111#issuecomment-733426822","issue_url":"https://api.github.com/repos/apache/hudi/issues/2111","id":733426822,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzQyNjgyMg==","user":{"login":"SteNicholas","id":10048174,"node_id":"MDQ6VXNlcjEwMDQ4MTc0","avatar_url":"https://avatars.githubusercontent.com/u/10048174?v=4","gravatar_id":"","url":"https://api.github.com/users/SteNicholas","html_url":"https://github.com/SteNicholas","followers_url":"https://api.github.com/users/SteNicholas/followers","following_url":"https://api.github.com/users/SteNicholas/following{/other_user}","gists_url":"https://api.github.com/users/SteNicholas/gists{/gist_id}","starred_url":"https://api.github.com/users/SteNicholas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SteNicholas/subscriptions","organizations_url":"https://api.github.com/users/SteNicholas/orgs","repos_url":"https://api.github.com/users/SteNicholas/repos","events_url":"https://api.github.com/users/SteNicholas/events{/privacy}","received_events_url":"https://api.github.com/users/SteNicholas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T02:43:22Z","updated_at":"2020-11-25T02:43:22Z","author_association":"MEMBER","body":"> @SteNicholas still interested in driving this forward?\r\n\r\n@vinothchandar , yes, I have discussed with @leesf offline. This week would be completed.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733426822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733439132","html_url":"https://github.com/apache/hudi/issues/2276#issuecomment-733439132","issue_url":"https://api.github.com/repos/apache/hudi/issues/2276","id":733439132,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzQzOTEzMg==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T03:25:25Z","updated_at":"2020-11-25T03:25:25Z","author_association":"NONE","body":"Thanks @bvaradar , The files on hdfs are：\r\n\r\n```\r\n     0 2020-11-22 10:00 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/.aux\r\n     0 2020-11-22 10:01 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/.temp\r\n  1596 2020-11-22 10:00 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/20201122100045.deltacommit\r\n   979 2020-11-22 10:00 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/20201122100045.deltacommit.inflight\r\n     0 2020-11-22 10:00 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/20201122100045.deltacommit.requested\r\n  1646 2020-11-22 10:01 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/20201122100057.deltacommit\r\n  1639 2020-11-22 10:00 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/20201122100057.deltacommit.inflight\r\n     0 2020-11-22 10:00 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/20201122100057.deltacommit.requested\r\n  1647 2020-11-22 10:01 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/20201122100101.deltacommit\r\n  1639 2020-11-22 10:01 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/20201122100101.deltacommit.inflight\r\n     0 2020-11-22 10:01 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/20201122100101.deltacommit.requested\r\n     0 2020-11-22 10:00 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/archived\r\n   339 2020-11-22 10:00 /data/hudi_demo/hudi_hive_read_write_mor_5/.hoodie/hoodie.properties\r\n```\r\n\r\nWhen I run any of the commits time(20201122100045 20201122100057 20201122100101 ), all complains that: No Compaction request available","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733439132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733441100","html_url":"https://github.com/apache/hudi/issues/2276#issuecomment-733441100","issue_url":"https://api.github.com/repos/apache/hudi/issues/2276","id":733441100,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzQ0MTEwMA==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T03:32:17Z","updated_at":"2020-11-25T03:32:47Z","author_association":"NONE","body":"The code that create/upsert the table is as follows, I have explicitly specified the following two lines to disable compaction.\r\n\r\n```\r\n      .option(HoodieCompactionConfig.INLINE_COMPACT_PROP, \"false\")\r\n.option(DataSourceWriteOptions.ASYNC_COMPACT_ENABLE_OPT_KEY, \"false\")\r\n```\r\n\r\nNot sure how I could be able to exercise the compaction feature with code..Could you please help? @bvaradar ,Thanks!\r\n\r\n\r\n\r\n\r\n\r\n\r\n```\r\npackage org.example.hudi\r\n\r\nimport org.apache.hudi.DataSourceWriteOptions\r\nimport org.apache.hudi.config.{HoodieCompactionConfig, HoodieIndexConfig, HoodieWriteConfig}\r\nimport org.apache.hudi.index.HoodieIndex\r\nimport org.apache.spark.sql.{SaveMode, SparkSession}\r\n\r\ncase class MyOrder(\r\n                    name: String,\r\n                    price: String,\r\n                    creation_date: String,\r\n                    dt: String)\r\n\r\nobject MORWorkTest {\r\n\r\n  val overwrite1Data = Seq(\r\n    MyOrder(\"A\", \"1\", \"2020-11-18 14:43:32\", \"2020-11-19\"),\r\n    MyOrder(\"B\", \"1\", \"2020-11-18 14:42:21\", \"2020-11-19\"),\r\n    MyOrder(\"C\", \"1\", \"2020-11-18 14:47:19\", \"2020-11-19\"),\r\n    MyOrder(\"D\", \"1\", \"2020-11-18 14:46:50\", \"2020-11-19\")\r\n  )\r\n\r\n  val insertUpdate1Data = Seq(\r\n    MyOrder(\"A\", \"2\", \"2020-11-18 14:50:32\", \"2020-11-19\"),\r\n    MyOrder(\"B\", \"2\", \"2020-11-18 14:50:21\", \"2020-11-19\"),\r\n    MyOrder(\"C\", \"2\", \"2020-11-18 14:50:19\", \"2020-11-19\"),\r\n    MyOrder(\"D\", \"2\", \"2020-11-18 14:50:50\", \"2020-11-19\")\r\n  )\r\n\r\n  val insertUpdate2Data = Seq(\r\n    MyOrder(\"A\", \"3\", \"2020-11-18 14:53:32\", \"2020-11-19\"),\r\n    MyOrder(\"B\", \"3\", \"2020-11-18 14:52:21\", \"2020-11-19\"),\r\n    MyOrder(\"C\", \"3\", \"2020-11-18 14:57:19\", \"2020-11-19\"),\r\n    MyOrder(\"D\", \"3\", \"2020-11-18 14:56:50\", \"2020-11-19\")\r\n  )\r\n\r\n  val spark = SparkSession.builder.appName(\"MORTest\")\r\n    .config(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\")\r\n    .config(\"spark.sql.warehouse.dir\", \"hdfs:///user/hive/warehouse\")\r\n    .enableHiveSupport().getOrCreate()\r\n\r\n  val hudi_table = \"hudi_hive_read_write_mor_5\"\r\n\r\n  val base_path = s\"/data/hudi_demo/$hudi_table\"\r\n\r\n  def run(op: Int) = {\r\n    val (data, saveMode) = op match {\r\n      case 1 => (overwrite1Data, SaveMode.Overwrite)\r\n      case 2 => (insertUpdate1Data, SaveMode.Append)\r\n      case 3 => (insertUpdate2Data, SaveMode.Append)\r\n    }\r\n    import spark.implicits._\r\n    val insertData = spark.createDataset(data)\r\n    insertData.write.format(\"hudi\")\r\n      .option(DataSourceWriteOptions.RECORDKEY_FIELD_OPT_KEY, \"name\")\r\n      .option(DataSourceWriteOptions.PRECOMBINE_FIELD_OPT_KEY, \"creation_date\")\r\n      .option(DataSourceWriteOptions.HIVE_DATABASE_OPT_KEY, \"xyz\")\r\n      .option(DataSourceWriteOptions.HIVE_TABLE_OPT_KEY, hudi_table)\r\n      .option(DataSourceWriteOptions.HIVE_SYNC_ENABLED_OPT_KEY, \"true\")\r\n      .option(HoodieIndexConfig.BLOOM_INDEX_UPDATE_PARTITION_PATH, \"true\")\r\n      .option(DataSourceWriteOptions.PARTITIONPATH_FIELD_OPT_KEY, \"dt\")\r\n\r\n      //table type: MOR\r\n      .option(DataSourceWriteOptions.TABLE_TYPE_OPT_KEY, DataSourceWriteOptions.MOR_TABLE_TYPE_OPT_VAL)\r\n\r\n      //disable async compact\r\n      .option(DataSourceWriteOptions.ASYNC_COMPACT_ENABLE_OPT_KEY, \"false\")\r\n      .option(HoodieCompactionConfig.INLINE_COMPACT_NUM_DELTA_COMMITS_PROP, 100)\r\n      //disable inline compact\r\n      .option(HoodieCompactionConfig.INLINE_COMPACT_PROP, \"false\")\r\n\r\n\r\n      .option(DataSourceWriteOptions.HIVE_URL_OPT_KEY, \"jdbc:hive2://10.41.90.208:10000\")\r\n      .option(HoodieWriteConfig.TABLE_NAME, hudi_table)\r\n      .option(DataSourceWriteOptions.HIVE_PARTITION_EXTRACTOR_CLASS_OPT_KEY, \"org.apache.hudi.hive.MultiPartKeysValueExtractor\")\r\n      .option(HoodieIndexConfig.INDEX_TYPE_PROP, HoodieIndex.IndexType.GLOBAL_BLOOM.name())\r\n      .option(DataSourceWriteOptions.HIVE_PARTITION_FIELDS_OPT_KEY, \"dt\")\r\n      .option(\"hoodie.insert.shuffle.parallelism\", \"2\")\r\n      .option(\"hoodie.upsert.shuffle.parallelism\", \"2\")\r\n      .mode(saveMode)\r\n      .save(base_path);\r\n  }\r\n\r\n\r\n  def main(args: Array[String]): Unit = {\r\n    //do overwrite\r\n    run(1)\r\n\r\n    //do upsert\r\n    run(2)\r\n\r\n    //do upsert\r\n    run(3)\r\n\r\n    println(\"===MOR is done=====\")\r\n  }\r\n\r\n}\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733441100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733445977","html_url":"https://github.com/apache/hudi/pull/2243#issuecomment-733445977","issue_url":"https://api.github.com/repos/apache/hudi/issues/2243","id":733445977,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzQ0NTk3Nw==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T03:50:55Z","updated_at":"2020-11-25T03:50:55Z","author_association":"MEMBER","body":"@yui2010 merging. Please assign the Jira ticket to yourself and close it. If you don't have contributor access yet, please send an email with your Jira ID to the dev mailing list and someone will add you to the project. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733445977/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733449190","html_url":"https://github.com/apache/hudi/pull/2222#issuecomment-733449190","issue_url":"https://api.github.com/repos/apache/hudi/issues/2222","id":733449190,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzQ0OTE5MA==","user":{"login":"shenh062326","id":9527867,"node_id":"MDQ6VXNlcjk1Mjc4Njc=","avatar_url":"https://avatars.githubusercontent.com/u/9527867?v=4","gravatar_id":"","url":"https://api.github.com/users/shenh062326","html_url":"https://github.com/shenh062326","followers_url":"https://api.github.com/users/shenh062326/followers","following_url":"https://api.github.com/users/shenh062326/following{/other_user}","gists_url":"https://api.github.com/users/shenh062326/gists{/gist_id}","starred_url":"https://api.github.com/users/shenh062326/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shenh062326/subscriptions","organizations_url":"https://api.github.com/users/shenh062326/orgs","repos_url":"https://api.github.com/users/shenh062326/repos","events_url":"https://api.github.com/users/shenh062326/events{/privacy}","received_events_url":"https://api.github.com/users/shenh062326/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T04:03:15Z","updated_at":"2020-11-25T04:03:15Z","author_association":"CONTRIBUTOR","body":"> @shenh062326 are you planning to follow on with a full impl of a java based client? Changes LGTM.\r\n\r\nYes, I will add a full impl of a java based client.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733449190/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733643079","html_url":"https://github.com/apache/hudi/issues/2265#issuecomment-733643079","issue_url":"https://api.github.com/repos/apache/hudi/issues/2265","id":733643079,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzY0MzA3OQ==","user":{"login":"konradwudkowski","id":11072914,"node_id":"MDQ6VXNlcjExMDcyOTE0","avatar_url":"https://avatars.githubusercontent.com/u/11072914?v=4","gravatar_id":"","url":"https://api.github.com/users/konradwudkowski","html_url":"https://github.com/konradwudkowski","followers_url":"https://api.github.com/users/konradwudkowski/followers","following_url":"https://api.github.com/users/konradwudkowski/following{/other_user}","gists_url":"https://api.github.com/users/konradwudkowski/gists{/gist_id}","starred_url":"https://api.github.com/users/konradwudkowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/konradwudkowski/subscriptions","organizations_url":"https://api.github.com/users/konradwudkowski/orgs","repos_url":"https://api.github.com/users/konradwudkowski/repos","events_url":"https://api.github.com/users/konradwudkowski/events{/privacy}","received_events_url":"https://api.github.com/users/konradwudkowski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T11:14:55Z","updated_at":"2020-11-25T11:14:55Z","author_association":"NONE","body":"Small update:\r\n\r\nIn the post above I described a \"bonus problem\" where I removed the row with `[ null ]`, wrote it to s3 with hudi,  succeeded to load it back with hudi but failed to load the parquet file with `pyarrow`. That's still true but I noticed it's the presence of the empty array in one of the rows that is causing this. It may be `pyarrow` problem, I can't tell but `pyarrow` will read the parquet file just fine if created with spark without hudi.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733643079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733676830","html_url":"https://github.com/apache/hudi/pull/2279#issuecomment-733676830","issue_url":"https://api.github.com/repos/apache/hudi/issues/2279","id":733676830,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzY3NjgzMA==","user":{"login":"wangxianghu","id":49835526,"node_id":"MDQ6VXNlcjQ5ODM1NTI2","avatar_url":"https://avatars.githubusercontent.com/u/49835526?v=4","gravatar_id":"","url":"https://api.github.com/users/wangxianghu","html_url":"https://github.com/wangxianghu","followers_url":"https://api.github.com/users/wangxianghu/followers","following_url":"https://api.github.com/users/wangxianghu/following{/other_user}","gists_url":"https://api.github.com/users/wangxianghu/gists{/gist_id}","starred_url":"https://api.github.com/users/wangxianghu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangxianghu/subscriptions","organizations_url":"https://api.github.com/users/wangxianghu/orgs","repos_url":"https://api.github.com/users/wangxianghu/repos","events_url":"https://api.github.com/users/wangxianghu/events{/privacy}","received_events_url":"https://api.github.com/users/wangxianghu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T12:26:57Z","updated_at":"2020-11-25T12:26:57Z","author_association":"CONTRIBUTOR","body":"@yanghua please take a look when free","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733676830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733747785","html_url":"https://github.com/apache/hudi/pull/2208#issuecomment-733747785","issue_url":"https://api.github.com/repos/apache/hudi/issues/2208","id":733747785,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzc0Nzc4NQ==","user":{"login":"giaosudau","id":539238,"node_id":"MDQ6VXNlcjUzOTIzOA==","avatar_url":"https://avatars.githubusercontent.com/u/539238?v=4","gravatar_id":"","url":"https://api.github.com/users/giaosudau","html_url":"https://github.com/giaosudau","followers_url":"https://api.github.com/users/giaosudau/followers","following_url":"https://api.github.com/users/giaosudau/following{/other_user}","gists_url":"https://api.github.com/users/giaosudau/gists{/gist_id}","starred_url":"https://api.github.com/users/giaosudau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giaosudau/subscriptions","organizations_url":"https://api.github.com/users/giaosudau/orgs","repos_url":"https://api.github.com/users/giaosudau/repos","events_url":"https://api.github.com/users/giaosudau/events{/privacy}","received_events_url":"https://api.github.com/users/giaosudau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T14:41:50Z","updated_at":"2020-11-25T14:41:50Z","author_association":"CONTRIBUTOR","body":"@vinothchandar \r\n```\r\n#\r\n# A fatal error has been detected by the Java Runtime Environment:\r\n#\r\n#  SIGBUS (0xa) at pc=0x00000001090cbad0, pid=32045, tid=0x0000000000013d03\r\n#\r\n# JRE version: OpenJDK Runtime Environment (8.0_265-b01) (build 1.8.0_265-b01)\r\n# Java VM: OpenJDK 64-Bit Server VM (25.265-b01 mixed mode bsd-amd64 compressed oops)\r\n# Problematic frame:\r\n# V  [libjvm.dylib+0xcbad0]  acl_CopyRight+0x29\r\n#\r\n# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try \"ulimit -c unlimited\" before starting Java again\r\n#\r\n# If you would like to submit a bug report, please visit:\r\n#   http://bugreport.java.com/bugreport/crash.jsp\r\n#\r\n\r\n---------------  T H R E A D  ---------------\r\n\r\nCurrent thread (0x00007ff8d78b4800):  JavaThread \"Executor task launch worker for task 1\" daemon [_thread_in_vm, id=81155, stack(0x00007000124e0000,0x00007000125e0000)]\r\n\r\nsiginfo: si_signo: 10 (SIGBUS), si_code: 2 (BUS_ADRERR), si_addr: 0x00000007fb74b220\r\n\r\nRegisters:\r\nRAX=0x00000007fb84b218, RBX=0x00000007fb74b220, RCX=0x0000000742648aa8, RDX=0xfffffffffffe0004\r\nRSP=0x00007000125de5a8, RBP=0x00007000125de5f0, RSI=0x0000000742548ab0, RDI=0x00000007fb74b220\r\nR8 =0x00007000125de620, R9 =0x0000000000000010, R10=0x000000010e547c67, R11=0x000000010e547c18\r\nR12=0x00000000653849e8, R13=0x00007000125de620, R14=0x0000000742548aa0, R15=0x00000007963c6838\r\nRIP=0x00000001090cbad0, EFLAGS=0x0000000000010282, ERR=0x0000000000000004\r\n  TRAPNO=0x000000000000000e\r\n\r\nTop of Stack: (sp=0x00007000125de5a8)\r\n0x00007000125de5a8:   0000000109573643 00007ff8d78b4800\r\n0x00007000125de5b8:   00007ff8d78b4800 0000000000000010\r\n0x00007000125de5c8:   000000010a97fdb8 0000000000000000\r\n0x00007000125de5d8:   00007000125de660 00007000125de740\r\n0x00007000125de5e8:   00007ff8d78b4800 00007000125de640\r\n0x00007000125de5f8:   000000010e547ce1 0000000000100000\r\n0x00007000125de608:   0000000740023378 00000007963c6838\r\n0x00007000125de618:   0000000000000000 0000000742548aa0\r\n0x00007000125de628:   0000000000000000 0000000000000000\r\n0x00007000125de638:   0000000000000000 00007000125de6e8\r\n0x00007000125de648:   000000010e07dffd 0000000000000009\r\n0x00007000125de658:   000000010e07dffd 0000000000100000\r\n0x00007000125de668:   00007ff8d78b4800 0000000000000010\r\n0x00007000125de678:   000000010e07db10 0000000742548aa0\r\n0x00007000125de688:   00000000653849e8 0000000124168f98\r\n0x00007000125de698:   00000007963c6838 0000000740023378\r\n0x00007000125de6a8:   00007000125de6a8 000000010ddb7fc2\r\n0x00007000125de6b8:   00007000125de740 000000010dde9028\r\n0x00007000125de6c8:   0000000125c73fe0 000000010ddb8088\r\n0x00007000125de6d8:   00007000125de660 00007000125de750\r\n0x00007000125de6e8:   00007000125de890 000000010f4e2cdc\r\n0x00007000125de6f8:   0000000000100000 0000000000000000\r\n0x00007000125de708:   000000004f636670 000000010ddb8088\r\n0x00007000125de718:   0000000000000010 0000000742548aa0\r\n0x00007000125de728:   0000000742548aa0 00000000653849e8\r\n0x00007000125de738:   0000000000000202 00000007963c6838\r\n0x00007000125de748:   000000010f4e2cdc 00000007c09086c8\r\n0x00007000125de758:   00000007c09086c8 0000000124168f98\r\n0x00007000125de768:   00007ff8d78b4800 0000000124168f98\r\n0x00007000125de778:   00007ff8d78b4800 0000000200000000\r\n0x00007000125de788:   0000000000000000 0000000000000000\r\n0x00007000125de798:   0000000742548aa0 00007000125de810 \r\n\r\nInstructions: (pc=0x00000001090cbad0)\r\n0x00000001090cbab0:   45 48 8b 74 d0 08 48 89 74 d1 08 48 83 c2 01 75\r\n0x00000001090cbac0:   f0 c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00\r\n0x00000001090cbad0:   48 8b 74 d0 e8 48 89 74 d1 e8 48 8b 74 d0 f0 48\r\n0x00000001090cbae0:   89 74 d1 f0 48 8b 74 d0 f8 48 89 74 d1 f8 48 8b \r\n\r\nRegister to memory mapping:\r\n\r\nRAX=0x00000007fb84b218 is an unknown value\r\nRBX=0x00000007fb74b220 is an unknown value\r\nRCX=0x0000000742648aa8 is pointing into object: 0x0000000742548aa0\r\n[B \r\n - klass: {type array byte}\r\n - length: 1331914352\r\nRDX=0xfffffffffffe0004 is an unknown value\r\nRSP=0x00007000125de5a8 is pointing into the stack for thread: 0x00007ff8d78b4800\r\nRBP=0x00007000125de5f0 is pointing into the stack for thread: 0x00007ff8d78b4800\r\nRSI=0x0000000742548ab0 is pointing into object: 0x0000000742548aa0\r\n[B \r\n - klass: {type array byte}\r\n - length: 1331914352\r\nRDI=0x00000007fb74b220 is an unknown value\r\nR8 =0x00007000125de620 is pointing into the stack for thread: 0x00007ff8d78b4800\r\nR9 =0x0000000000000010 is an unknown value\r\nR10=0x000000010e547c67 is at entry_point+103 in (nmethod*)0x000000010e547a90\r\nR11=0x000000010e547c18 is at entry_point+24 in (nmethod*)0x000000010e547a90\r\nR12=0x00000000653849e8 is an unknown value\r\nR13=0x00007000125de620 is pointing into the stack for thread: 0x00007ff8d78b4800\r\nR14=0x0000000742548aa0 is an oop\r\n[B \r\n - klass: {type array byte}\r\n - length: 1331914352\r\nR15=0x00000007963c6838 is an oop\r\n[B \r\n - klass: {type array byte}\r\n - length: 1088\r\n\r\n\r\nStack: [0x00007000124e0000,0x00007000125e0000],  sp=0x00007000125de5a8,  free space=1017k\r\nNative frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)\r\nV  [libjvm.dylib+0xcbad0]  acl_CopyRight+0x29\r\nJ 4313  sun.misc.Unsafe.copyMemory(Ljava/lang/Object;JLjava/lang/Object;JJ)V (0 bytes) @ 0x000000010e547ce1 [0x000000010e547c00+0xe1]\r\nj  org.apache.spark.unsafe.Platform.copyMemory(Ljava/lang/Object;JLjava/lang/Object;JJ)V+34\r\nJ 6963 C1 org.apache.spark.unsafe.types.UTF8String.getBytes()[B (81 bytes) @ 0x000000010f4e2cdc [0x000000010f4e2920+0x3bc]\r\nJ 6962 C1 org.apache.spark.unsafe.types.UTF8String.toString()Ljava/lang/String; (15 bytes) @ 0x000000010f4e2464 [0x000000010f4e2320+0x144]\r\nj  org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificSafeProjection.If_3$(Lorg/apache/spark/sql/catalyst/expressions/GeneratedClass$SpecificSafeProjection;Lorg/apache/spark/sql/catalyst/InternalRow;)Ljava/lang/String;+205\r\nj  org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificSafeProjection.createExternalRow_0_0$(Lorg/apache/spark/sql/catalyst/expressions/GeneratedClass$SpecificSafeProjection;Lorg/apache/spark/sql/catalyst/InternalRow;[Ljava/lang/Object;)V+87\r\nj  org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificSafeProjection.createExternalRow_3_0$(Lorg/apache/spark/sql/catalyst/expressions/GeneratedClass$SpecificSafeProjection;Lorg/apache/spark/sql/catalyst/InternalRow;[Ljava/lang/Object;)V+57\r\nj  org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificSafeProjection.apply(Ljava/lang/Object;)Ljava/lang/Object;+14\r\nj  org.apache.spark.sql.catalyst.encoders.ExpressionEncoder$Deserializer.apply(Lorg/apache/spark/sql/catalyst/InternalRow;)Ljava/lang/Object;+29\r\nj  org.apache.hudi.Spark3RowDeserializer.deserializeRow(Lorg/apache/spark/sql/catalyst/InternalRow;)Lorg/apache/spark/sql/Row;+5\r\nj  org.apache.hudi.HoodieSparkUtils$.$anonfun$createRdd$1(Lorg/apache/hudi/client/utils/SparkRowDeserializer;Lorg/apache/spark/sql/catalyst/InternalRow;)Lorg/apache/spark/sql/Row;+2\r\nj  org.apache.hudi.HoodieSparkUtils$$$Lambda$2342.apply(Ljava/lang/Object;)Ljava/lang/Object;+8\r\nJ 6454 C1 scala.collection.Iterator$$anon$10.next()Ljava/lang/Object; (19 bytes) @ 0x000000010f3b3424 [0x000000010f3b3260+0x1c4]\r\nJ 6454 C1 scala.collection.Iterator$$anon$10.next()Ljava/lang/Object; (19 bytes) @ 0x000000010f3b3374 [0x000000010f3b3260+0x114]\r\nJ 9244 C1 scala.collection.Iterator$SliceIterator.next()Ljava/lang/Object; (70 bytes) @ 0x000000010fcfad54 [0x000000010fcfa620+0x734]\r\nJ 9438 C2 scala.collection.AbstractIterator.foreach(Lscala/Function1;)V (6 bytes) @ 0x000000010fd98904 [0x000000010fd988a0+0x64]\r\nJ 6854 C2 scala.collection.generic.Growable.$plus$plus$eq(Lscala/collection/TraversableOnce;)Lscala/collection/generic/Growable; (34 bytes) @ 0x000000010f4b01f8 [0x000000010f4b0000+0x1f8]\r\nJ 6505 C1 scala.collection.mutable.ArrayBuffer.$plus$plus$eq(Lscala/collection/TraversableOnce;)Lscala/collection/mutable/ArrayBuffer; (74 bytes) @ 0x000000010f3cb754 [0x000000010f3cae80+0x8d4]\r\nJ 6812 C1 scala.collection.mutable.ArrayBuffer.$plus$plus$eq(Lscala/collection/TraversableOnce;)Lscala/collection/generic/Growable; (6 bytes) @ 0x000000010f4930f4 [0x000000010f493000+0xf4]\r\nj  scala.collection.TraversableOnce.to(Lscala/collection/generic/CanBuildFrom;)Ljava/lang/Object;+14\r\nj  scala.collection.TraversableOnce.to$(Lscala/collection/TraversableOnce;Lscala/collection/generic/CanBuildFrom;)Ljava/lang/Object;+2\r\nj  scala.collection.AbstractIterator.to(Lscala/collection/generic/CanBuildFrom;)Ljava/lang/Object;+2\r\nj  scala.collection.TraversableOnce.toBuffer()Lscala/collection/mutable/Buffer;+7\r\nj  scala.collection.TraversableOnce.toBuffer$(Lscala/collection/TraversableOnce;)Lscala/collection/mutable/Buffer;+1\r\nj  scala.collection.AbstractIterator.toBuffer()Lscala/collection/mutable/Buffer;+1\r\nj  scala.collection.TraversableOnce.toArray(Lscala/reflect/ClassTag;)Ljava/lang/Object;+33\r\nj  scala.collection.TraversableOnce.toArray$(Lscala/collection/TraversableOnce;Lscala/reflect/ClassTag;)Ljava/lang/Object;+2\r\nj  scala.collection.AbstractIterator.toArray(Lscala/reflect/ClassTag;)Ljava/lang/Object;+2\r\nj  org.apache.spark.rdd.RDD.$anonfun$take$2(Lorg/apache/spark/rdd/RDD;ILscala/collection/Iterator;)Ljava/lang/Object;+11\r\nj  org.apache.spark.rdd.RDD$$Lambda$1378.apply(Ljava/lang/Object;)Ljava/lang/Object;+12\r\nj  org.apache.spark.SparkContext.$anonfun$runJob$5(Lscala/Function1;Lorg/apache/spark/TaskContext;Lscala/collection/Iterator;)Ljava/lang/Object;+2\r\nj  org.apache.spark.SparkContext$$Lambda$1379.apply(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;+12\r\nj  org.apache.spark.scheduler.ResultTask.runTask(Lorg/apache/spark/TaskContext;)Ljava/lang/Object;+206\r\nj  org.apache.spark.scheduler.Task.run(JILorg/apache/spark/metrics/MetricsSystem;Lscala/collection/immutable/Map;)Ljava/lang/Object;+215\r\nj  org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Lorg/apache/spark/executor/Executor$TaskRunner;Lscala/runtime/BooleanRef;)Ljava/lang/Object;+32\r\nj  org.apache.spark.executor.Executor$TaskRunner$$Lambda$1344.apply()Ljava/lang/Object;+8\r\nj  org.apache.spark.util.Utils$.tryWithSafeFinally(Lscala/Function0;Lscala/Function0;)Ljava/lang/Object;+4\r\nj  org.apache.spark.executor.Executor$TaskRunner.run()V+421\r\nj  java.util.concurrent.ThreadPoolExecutor.runWorker(Ljava/util/concurrent/ThreadPoolExecutor$Worker;)V+95\r\nj  java.util.concurrent.ThreadPoolExecutor$Worker.run()V+5\r\nj  java.lang.Thread.run()V+11\r\nv  ~StubRoutines::call_stub\r\nV  [libjvm.dylib+0x2c7e0f]  JavaCalls::call_helper(JavaValue*, methodHandle*, JavaCallArguments*, Thread*)+0x691\r\nV  [libjvm.dylib+0x2c6c5b]  JavaCalls::call_virtual(JavaValue*, KlassHandle, Symbol*, Symbol*, JavaCallArguments*, Thread*)+0x145\r\nV  [libjvm.dylib+0x2c6e37]  JavaCalls::call_virtual(JavaValue*, Handle, KlassHandle, Symbol*, Symbol*, Thread*)+0x57\r\nV  [libjvm.dylib+0x33e001]  thread_entry(JavaThread*, Thread*)+0x78\r\nV  [libjvm.dylib+0x559256]  JavaThread::thread_main_inner()+0x82\r\nV  [libjvm.dylib+0x55911b]  JavaThread::run()+0x169\r\nV  [libjvm.dylib+0x487e8f]  java_start(Thread*)+0xfa\r\nC  [libsystem_pthread.dylib+0x6109]  _pthread_start+0x94\r\nC  [libsystem_pthread.dylib+0x1b8b]  thread_start+0xf\r\nC  0x0000000000000000\r\n\r\nJava frames: (J=compiled Java code, j=interpreted, Vv=VM code)\r\nJ 4313  sun.misc.Unsafe.copyMemory(Ljava/lang/Object;JLjava/lang/Object;JJ)V (0 bytes) @ 0x000000010e547c67 [0x000000010e547c00+0x67]\r\nj  org.apache.spark.unsafe.Platform.copyMemory(Ljava/lang/Object;JLjava/lang/Object;JJ)V+34\r\nJ 6963 C1 org.apache.spark.unsafe.types.UTF8String.getBytes()[B (81 bytes) @ 0x000000010f4e2cdc [0x000000010f4e2920+0x3bc]\r\nJ 6962 C1 org.apache.spark.unsafe.types.UTF8String.toString()Ljava/lang/String; (15 bytes) @ 0x000000010f4e2464 [0x000000010f4e2320+0x144]\r\nj  org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificSafeProjection.If_3$(Lorg/apache/spark/sql/catalyst/expressions/GeneratedClass$SpecificSafeProjection;Lorg/apache/spark/sql/catalyst/InternalRow;)Ljava/lang/String;+205\r\nj  org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificSafeProjection.createExternalRow_0_0$(Lorg/apache/spark/sql/catalyst/expressions/GeneratedClass$SpecificSafeProjection;Lorg/apache/spark/sql/catalyst/InternalRow;[Ljava/lang/Object;)V+87\r\nj  org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificSafeProjection.createExternalRow_3_0$(Lorg/apache/spark/sql/catalyst/expressions/GeneratedClass$SpecificSafeProjection;Lorg/apache/spark/sql/catalyst/InternalRow;[Ljava/lang/Object;)V+57\r\nj  org.apache.spark.sql.catalyst.expressions.GeneratedClass$SpecificSafeProjection.apply(Ljava/lang/Object;)Ljava/lang/Object;+14\r\nj  org.apache.spark.sql.catalyst.encoders.ExpressionEncoder$Deserializer.apply(Lorg/apache/spark/sql/catalyst/InternalRow;)Ljava/lang/Object;+29\r\nj  org.apache.hudi.Spark3RowDeserializer.deserializeRow(Lorg/apache/spark/sql/catalyst/InternalRow;)Lorg/apache/spark/sql/Row;+5\r\nj  org.apache.hudi.HoodieSparkUtils$.$anonfun$createRdd$1(Lorg/apache/hudi/client/utils/SparkRowDeserializer;Lorg/apache/spark/sql/catalyst/InternalRow;)Lorg/apache/spark/sql/Row;+2\r\nj  org.apache.hudi.HoodieSparkUtils$$$Lambda$2342.apply(Ljava/lang/Object;)Ljava/lang/Object;+8\r\nJ 6454 C1 scala.collection.Iterator$$anon$10.next()Ljava/lang/Object; (19 bytes) @ 0x000000010f3b3424 [0x000000010f3b3260+0x1c4]\r\nJ 6454 C1 scala.collection.Iterator$$anon$10.next()Ljava/lang/Object; (19 bytes) @ 0x000000010f3b3374 [0x000000010f3b3260+0x114]\r\nJ 9244 C1 scala.collection.Iterator$SliceIterator.next()Ljava/lang/Object; (70 bytes) @ 0x000000010fcfad54 [0x000000010fcfa620+0x734]\r\nJ 9438 C2 scala.collection.AbstractIterator.foreach(Lscala/Function1;)V (6 bytes) @ 0x000000010fd98904 [0x000000010fd988a0+0x64]\r\nJ 6854 C2 scala.collection.generic.Growable.$plus$plus$eq(Lscala/collection/TraversableOnce;)Lscala/collection/generic/Growable; (34 bytes) @ 0x000000010f4b01f8 [0x000000010f4b0000+0x1f8]\r\nJ 6505 C1 scala.collection.mutable.ArrayBuffer.$plus$plus$eq(Lscala/collection/TraversableOnce;)Lscala/collection/mutable/ArrayBuffer; (74 bytes) @ 0x000000010f3cb754 [0x000000010f3cae80+0x8d4]\r\nJ 6812 C1 scala.collection.mutable.ArrayBuffer.$plus$plus$eq(Lscala/collection/TraversableOnce;)Lscala/collection/generic/Growable; (6 bytes) @ 0x000000010f4930f4 [0x000000010f493000+0xf4]\r\nj  scala.collection.TraversableOnce.to(Lscala/collection/generic/CanBuildFrom;)Ljava/lang/Object;+14\r\nj  scala.collection.TraversableOnce.to$(Lscala/collection/TraversableOnce;Lscala/collection/generic/CanBuildFrom;)Ljava/lang/Object;+2\r\nj  scala.collection.AbstractIterator.to(Lscala/collection/generic/CanBuildFrom;)Ljava/lang/Object;+2\r\nj  scala.collection.TraversableOnce.toBuffer()Lscala/collection/mutable/Buffer;+7\r\nj  scala.collection.TraversableOnce.toBuffer$(Lscala/collection/TraversableOnce;)Lscala/collection/mutable/Buffer;+1\r\nj  scala.collection.AbstractIterator.toBuffer()Lscala/collection/mutable/Buffer;+1\r\nj  scala.collection.TraversableOnce.toArray(Lscala/reflect/ClassTag;)Ljava/lang/Object;+33\r\nj  scala.collection.TraversableOnce.toArray$(Lscala/collection/TraversableOnce;Lscala/reflect/ClassTag;)Ljava/lang/Object;+2\r\nj  scala.collection.AbstractIterator.toArray(Lscala/reflect/ClassTag;)Ljava/lang/Object;+2\r\nj  org.apache.spark.rdd.RDD.$anonfun$take$2(Lorg/apache/spark/rdd/RDD;ILscala/collection/Iterator;)Ljava/lang/Object;+11\r\nj  org.apache.spark.rdd.RDD$$Lambda$1378.apply(Ljava/lang/Object;)Ljava/lang/Object;+12\r\nj  org.apache.spark.SparkContext.$anonfun$runJob$5(Lscala/Function1;Lorg/apache/spark/TaskContext;Lscala/collection/Iterator;)Ljava/lang/Object;+2\r\nj  org.apache.spark.SparkContext$$Lambda$1379.apply(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;+12\r\nj  org.apache.spark.scheduler.ResultTask.runTask(Lorg/apache/spark/TaskContext;)Ljava/lang/Object;+206\r\nj  org.apache.spark.scheduler.Task.run(JILorg/apache/spark/metrics/MetricsSystem;Lscala/collection/immutable/Map;)Ljava/lang/Object;+215\r\nj  org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Lorg/apache/spark/executor/Executor$TaskRunner;Lscala/runtime/BooleanRef;)Ljava/lang/Object;+32\r\nj  org.apache.spark.executor.Executor$TaskRunner$$Lambda$1344.apply()Ljava/lang/Object;+8\r\nj  org.apache.spark.util.Utils$.tryWithSafeFinally(Lscala/Function0;Lscala/Function0;)Ljava/lang/Object;+4\r\nj  org.apache.spark.executor.Executor$TaskRunner.run()V+421\r\nj  java.util.concurrent.ThreadPoolExecutor.runWorker(Ljava/util/concurrent/ThreadPoolExecutor$Worker;)V+95\r\nj  java.util.concurrent.ThreadPoolExecutor$Worker.run()V+5\r\nj  java.lang.Thread.run()V+11\r\nv  ~StubRoutines::call_stub\r\n\r\n---------------  P R O C E S S  ---------------\r\n\r\nJava Threads: ( => current thread )\r\n  0x00007ff9276f6800 JavaThread \"block-manager-ask-thread-pool-1\" daemon [_thread_blocked, id=77827, stack(0x0000700012d23000,0x0000700012e23000)]\r\n  0x00007ff92b7eb000 JavaThread \"block-manager-ask-thread-pool-0\" daemon [_thread_blocked, id=45827, stack(0x0000700012c20000,0x0000700012d20000)]\r\n  0x00007ff92a5cf800 JavaThread \"block-manager-slave-async-thread-pool-2\" daemon [_thread_blocked, id=45571, stack(0x0000700012b1d000,0x0000700012c1d000)]\r\n  0x00007ff92a5d7800 JavaThread \"block-manager-slave-async-thread-pool-1\" daemon [_thread_blocked, id=45315, stack(0x0000700012a1a000,0x0000700012b1a000)]\r\n  0x00007ff9276f2000 JavaThread \"block-manager-slave-async-thread-pool-0\" daemon [_thread_blocked, id=78851, stack(0x0000700012917000,0x0000700012a17000)]\r\n  0x00007ff9276eb800 JavaThread \"task-result-getter-0\" daemon [_thread_blocked, id=79375, stack(0x0000700012814000,0x0000700012914000)]\r\n  0x00007ff8c7008800 JavaThread \"process reaper\" daemon [_thread_blocked, id=79619, stack(0x00007000127e9000,0x0000700012811000)]\r\n  0x00007ff8c7daa800 JavaThread \"rpc-server-4-1\" daemon [_thread_in_native, id=80131, stack(0x00007000126e6000,0x00007000127e6000)]\r\n  0x00007ff92a19a000 JavaThread \"files-client-8-1\" daemon [_thread_in_native, id=80643, stack(0x00007000125e3000,0x00007000126e3000)]\r\n=>0x00007ff8d78b4800 JavaThread \"Executor task launch worker for task 1\" daemon [_thread_in_vm, id=81155, stack(0x00007000124e0000,0x00007000125e0000)]\r\n  0x00007ff927546800 JavaThread \"Keep-Alive-Timer\" daemon [_thread_blocked, id=81667, stack(0x00007000123dd000,0x00007000124dd000)]\r\n  0x00007ff928bda000 JavaThread \"spark-listener-group-shared\" daemon [_thread_blocked, id=82179, stack(0x00007000122da000,0x00007000123da000)]\r\n  0x00007ff92719d000 JavaThread \"element-tracking-store-worker\" daemon [_thread_blocked, id=82691, stack(0x00007000121d7000,0x00007000122d7000)]\r\n  0x00007ff928aa4000 JavaThread \"spark-listener-group-executorManagement\" daemon [_thread_blocked, id=83203, stack(0x00007000120d4000,0x00007000121d4000)]\r\n  0x00007ff92a30b000 JavaThread \"spark-listener-group-appStatus\" daemon [_thread_blocked, id=83715, stack(0x0000700011fd1000,0x00007000120d1000)]\r\n  0x00007ff9271a2800 JavaThread \"context-cleaner-periodic-gc\" daemon [_thread_blocked, id=84227, stack(0x0000700011ece000,0x0000700011fce000)]\r\n  0x00007ff8c703b800 JavaThread \"Spark Context Cleaner\" daemon [_thread_blocked, id=84739, stack(0x0000700011dcb000,0x0000700011ecb000)]\r\n  0x00007ff928aa6800 JavaThread \"shuffle-boss-6-1\" daemon [_thread_in_native, id=44547, stack(0x0000700011cc8000,0x0000700011dc8000)]\r\n  0x00007ff8f0384000 JavaThread \"executor-heartbeater\" daemon [_thread_blocked, id=44035, stack(0x0000700011bc5000,0x0000700011cc5000)]\r\n  0x00007ff92719b800 JavaThread \"driver-heartbeater\" daemon [_thread_blocked, id=43779, stack(0x0000700011ac2000,0x0000700011bc2000)]\r\n  0x00007ff92823e000 JavaThread \"dag-scheduler-event-loop\" daemon [_thread_blocked, id=85763, stack(0x00007000119bf000,0x0000700011abf000)]\r\n  0x00007ff92711d000 JavaThread \"Timer-1\" daemon [_thread_blocked, id=86275, stack(0x00007000118bc000,0x00007000119bc000)]\r\n  0x00007ff928232000 JavaThread \"Timer-0\" daemon [_thread_blocked, id=86787, stack(0x00007000117b9000,0x00007000118b9000)]\r\n  0x00007ff927a66800 JavaThread \"netty-rpc-env-timeout\" daemon [_thread_blocked, id=43523, stack(0x00007000116b6000,0x00007000117b6000)]\r\n  0x00007ff92a1ab800 JavaThread \"heartbeat-receiver-event-loop-thread\" daemon [_thread_blocked, id=31747, stack(0x00007000115b3000,0x00007000116b3000)]\r\n  0x00007ff927118800 JavaThread \"SparkUI-47\" daemon [_thread_blocked, id=32003, stack(0x00007000114b0000,0x00007000115b0000)]\r\n  0x00007ff927a5f800 JavaThread \"SparkUI-46\" daemon [_thread_blocked, id=32259, stack(0x00007000113ad000,0x00007000114ad000)]\r\n  0x00007ff927321000 JavaThread \"SparkUI-45-acceptor-1@39fd7bba-Spark@76672d90{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}\" daemon [_thread_blocked, id=30723, stack(0x00007000112aa000,0x00007000113aa000)]\r\n  0x00007ff927a51800 JavaThread \"SparkUI-44-acceptor-0@7258a703-ServerConnector@76672d90{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}\" daemon [_thread_in_native, id=33027, stack(0x00007000111a7000,0x00007000112a7000)]\r\n  0x00007ff8c7db2000 JavaThread \"SparkUI-43\" daemon [_thread_in_native, id=33539, stack(0x00007000110a4000,0x00007000111a4000)]\r\n  0x00007ff8c7db1000 JavaThread \"SparkUI-42\" daemon [_thread_in_native, id=30467, stack(0x0000700010fa1000,0x00007000110a1000)]\r\n  0x00007ff8c7db0800 JavaThread \"SparkUI-41\" daemon [_thread_in_native, id=30211, stack(0x0000700010e9e000,0x0000700010f9e000)]\r\n  0x00007ff8c7dfb800 JavaThread \"SparkUI-40\" daemon [_thread_in_native, id=29955, stack(0x0000700010d9b000,0x0000700010e9b000)]\r\n  0x00007ff927a3c800 JavaThread \"SparkUI-39\" daemon [_thread_in_native, id=34563, stack(0x0000700010c98000,0x0000700010d98000)]\r\n  0x00007ff927320800 JavaThread \"SparkUI-38\" daemon [_thread_in_native, id=29443, stack(0x0000700010b95000,0x0000700010c95000)]\r\n  0x00007ff92731d000 JavaThread \"SparkUI-37\" daemon [_thread_in_native, id=35075, stack(0x0000700010a92000,0x0000700010b92000)]\r\n  0x00007ff8f0355800 JavaThread \"SparkUI-36\" daemon [_thread_in_native, id=35331, stack(0x000070001098f000,0x0000700010a8f000)]\r\n  0x00007ff927316800 JavaThread \"RemoteBlock-temp-file-clean-thread\" daemon [_thread_blocked, id=35587, stack(0x000070001088c000,0x000070001098c000)]\r\n  0x00007ff928aff800 JavaThread \"dispatcher-BlockManagerEndpoint1\" daemon [_thread_blocked, id=36099, stack(0x0000700010789000,0x0000700010889000)]\r\n  0x00007ff927310000 JavaThread \"dispatcher-BlockManagerMaster\" daemon [_thread_blocked, id=36611, stack(0x0000700010686000,0x0000700010786000)]\r\n  0x00007ff928ae3000 JavaThread \"map-output-dispatcher-7\" daemon [_thread_blocked, id=28419, stack(0x0000700010583000,0x0000700010683000)]\r\n  0x00007ff8c7e1b000 JavaThread \"map-output-dispatcher-6\" daemon [_thread_blocked, id=28163, stack(0x0000700010480000,0x0000700010580000)]\r\n  0x00007ff8c7e1a000 JavaThread \"map-output-dispatcher-5\" daemon [_thread_blocked, id=37379, stack(0x000070001037d000,0x000070001047d000)]\r\n  0x00007ff8c7e19000 JavaThread \"map-output-dispatcher-4\" daemon [_thread_blocked, id=27651, stack(0x000070001027a000,0x000070001037a000)]\r\n  0x00007ff8c7e18000 JavaThread \"map-output-dispatcher-3\" daemon [_thread_blocked, id=27139, stack(0x0000700010177000,0x0000700010277000)]\r\n  0x00007ff8c7e17800 JavaThread \"map-output-dispatcher-2\" daemon [_thread_blocked, id=38147, stack(0x0000700010074000,0x0000700010174000)]\r\n  0x00007ff92730f000 JavaThread \"map-output-dispatcher-1\" daemon [_thread_blocked, id=26883, stack(0x000070000ff71000,0x0000700010071000)]\r\n  0x00007ff927a20800 JavaThread \"map-output-dispatcher-0\" daemon [_thread_blocked, id=38915, stack(0x000070000fe6e000,0x000070000ff6e000)]\r\n  0x00007ff928adf000 JavaThread \"dispatcher-event-loop-1\" daemon [_thread_blocked, id=26627, stack(0x000070000fd6b000,0x000070000fe6b000)]\r\n  0x00007ff8c7e16800 JavaThread \"dispatcher-event-loop-0\" daemon [_thread_blocked, id=39683, stack(0x000070000fc68000,0x000070000fd68000)]\r\n  0x00007ff9272f7000 JavaThread \"rpc-boss-3-1\" daemon [_thread_in_native, id=40195, stack(0x000070000fb65000,0x000070000fc65000)]\r\n  0x00007ff8c7de4800 JavaThread \"org.apache.hadoop.fs.FileSystem$Statistics$StatisticsDataReferenceCleaner\" daemon [_thread_blocked, id=40451, stack(0x000070000fa62000,0x000070000fb62000)]\r\n  0x00007ff92800b800 JavaThread \"Service Thread\" daemon [_thread_blocked, id=40963, stack(0x000070000f85c000,0x000070000f95c000)]\r\n  0x00007ff907008800 JavaThread \"C1 CompilerThread11\" daemon [_thread_blocked, id=41475, stack(0x000070000f759000,0x000070000f859000)]\r\n  0x00007ff927018800 JavaThread \"C1 CompilerThread10\" daemon [_thread_blocked, id=25347, stack(0x000070000f656000,0x000070000f756000)]\r\n  0x00007ff927824800 JavaThread \"C1 CompilerThread9\" daemon [_thread_blocked, id=24835, stack(0x000070000f553000,0x000070000f653000)]\r\n  0x00007ff92b032000 JavaThread \"C1 CompilerThread8\" daemon [_thread_blocked, id=24579, stack(0x000070000f450000,0x000070000f550000)]\r\n  0x00007ff927823800 JavaThread \"C2 CompilerThread7\" daemon [_thread_blocked, id=41987, stack(0x000070000f34d000,0x000070000f44d000)]\r\n  0x00007ff92b029000 JavaThread \"C2 CompilerThread6\" daemon [_thread_blocked, id=23811, stack(0x000070000f24a000,0x000070000f34a000)]\r\n  0x00007ff929888000 JavaThread \"C2 CompilerThread5\" daemon [_thread_blocked, id=42243, stack(0x000070000f147000,0x000070000f247000)]\r\n  0x00007ff92b020000 JavaThread \"C2 CompilerThread4\" daemon [_thread_blocked, id=23043, stack(0x000070000f044000,0x000070000f144000)]\r\n  0x00007ff92b017000 JavaThread \"C2 CompilerThread3\" daemon [_thread_blocked, id=42755, stack(0x000070000ef41000,0x000070000f041000)]\r\n  0x00007ff92780a800 JavaThread \"C2 CompilerThread2\" daemon [_thread_blocked, id=22531, stack(0x000070000ee3e000,0x000070000ef3e000)]\r\n  0x00007ff92b016800 JavaThread \"C2 CompilerThread1\" daemon [_thread_blocked, id=22275, stack(0x000070000ed3b000,0x000070000ee3b000)]\r\n  0x00007ff927809800 JavaThread \"C2 CompilerThread0\" daemon [_thread_blocked, id=43267, stack(0x000070000ec38000,0x000070000ed38000)]\r\n  0x00007ff929887800 JavaThread \"Signal Dispatcher\" daemon [_thread_blocked, id=16387, stack(0x000070000eb35000,0x000070000ec35000)]\r\n  0x00007ff92b012000 JavaThread \"Finalizer\" daemon [_thread_blocked, id=18435, stack(0x000070000e92c000,0x000070000ea2c000)]\r\n  0x00007ff92b00f000 JavaThread \"Reference Handler\" daemon [_thread_blocked, id=18691, stack(0x000070000e829000,0x000070000e929000)]\r\n  0x00007ff92a009800 JavaThread \"main\" [_thread_blocked, id=5635, stack(0x000070000d8fc000,0x000070000d9fc000)]\r\n\r\nOther Threads:\r\n  0x00007ff929857000 VMThread [stack: 0x000070000e726000,0x000070000e826000] [id=19203]\r\n  0x00007ff927825000 WatcherThread [stack: 0x000070000f95f000,0x000070000fa5f000] [id=26115]\r\n\r\nVM state:synchronizing (normal execution)\r\n\r\nVM Mutex/Monitor currently owned by a thread:  ([mutex/lock_event])\r\n[0x00007ff929005e70] Threads_lock - owner thread: 0x00007ff929857000\r\n\r\nheap address: 0x0000000740000000, size: 2048 MB, Compressed Oops mode: Zero based, Oop shift amount: 3\r\nNarrow klass base: 0x0000000000000000, Narrow klass shift: 3\r\nCompressed class space size: 1073741824 Address: 0x00000007c0000000\r\n\r\nHeap:\r\n PSYoungGen      total 317440K, used 95490K [0x0000000795580000, 0x00000007adc00000, 0x00000007c0000000)\r\n  eden space 292352K, 24% used [0x0000000795580000,0x0000000799ad4bf0,0x00000007a7300000)\r\n  from space 25088K, 97% used [0x00000007a7300000,0x00000007a8aebf48,0x00000007a8b80000)\r\n  to   space 28672K, 0% used [0x00000007ac000000,0x00000007ac000000,0x00000007adc00000)\r\n ParOldGen       total 1398272K, used 1338876K [0x0000000740000000, 0x0000000795580000, 0x0000000795580000)\r\n  object space 1398272K, 95% used [0x0000000740000000,0x0000000791b7f120,0x0000000795580000)\r\n Metaspace       used 107502K, capacity 117335K, committed 117504K, reserved 1150976K\r\n  class space    used 14559K, capacity 15503K, committed 15616K, reserved 1048576K\r\n\r\nCard table byte_map: [0x0000000109e2c000,0x000000010a22d000] byte_map_base: 0x000000010642c000\r\n\r\nMarking Bits: (ParMarkBitMap*) 0x000000010970edc8\r\n Begin Bits: [0x000000011d076000, 0x000000011f076000)\r\n End Bits:   [0x000000011f076000, 0x0000000121076000)\r\n\r\nPolling page: 0x0000000106ff6000\r\n\r\nCodeCache: size=245760Kb used=32764Kb max_used=32875Kb free=212995Kb\r\n bounds [0x000000010e076000, 0x0000000110186000, 0x000000011d076000]\r\n total_blobs=9900 nmethods=9013 adapters=795\r\n compilation: enabled\r\n\r\nCompilation events (10 events):\r\nEvent: 8.298 Thread 0x00007ff929888000 nmethod 10204 0x000000010ed06390 code [0x000000010ed06900, 0x000000010ed0a668]\r\nEvent: 8.298 Thread 0x00007ff929888000 10226       4       org.codehaus.janino.Java$Statement::findLocalVariable (22 bytes)\r\nEvent: 8.304 Thread 0x00007ff929888000 nmethod 10226 0x000000010f34a8d0 code [0x000000010f34aa60, 0x000000010f34af58]\r\nEvent: 8.384 Thread 0x00007ff92780a800 nmethod 9976 0x00000001100d7b10 code [0x00000001100d8520, 0x00000001100de0d0]\r\nEvent: 8.469 Thread 0x00007ff92b017000 nmethod 9952 0x00000001100ef210 code [0x00000001100efa60, 0x00000001100f74b0]\r\nEvent: 8.519 Thread 0x00007ff927823800 nmethod 9843 0x0000000110105b10 code [0x00000001101063a0, 0x000000011010d408]\r\nEvent: 8.528 Thread 0x00007ff92b020000 nmethod 10202 0x0000000110121410 code [0x0000000110121da0, 0x0000000110128950]\r\nEvent: 8.530 Thread 0x00007ff927809800 nmethod 9837 0x0000000110134cd0 code [0x0000000110135680, 0x000000011013e8c8]\r\nEvent: 8.570 Thread 0x00007ff92b016800 nmethod 10212 0x000000011014a990 code [0x000000011014b360, 0x0000000110152638]\r\nEvent: 8.749 Thread 0x00007ff92b029000 nmethod 10164 0x00000001101699d0 code [0x000000011016acc0, 0x0000000110175a20]\r\n\r\nGC Heap History (10 events):\r\nEvent: 3.617 GC heap before\r\n{Heap before GC invocations=9 (full 3):\r\n PSYoungGen      total 241152K, used 6841K [0x0000000795580000, 0x00000007a6200000, 0x00000007c0000000)\r\n  eden space 224256K, 0% used [0x0000000795580000,0x0000000795580000,0x00000007a3080000)\r\n  from space 16896K, 40% used [0x00000007a4100000,0x00000007a47ae480,0x00000007a5180000)\r\n  to   space 16896K, 0% used [0x00000007a3080000,0x00000007a3080000,0x00000007a4100000)\r\n ParOldGen       total 409600K, used 9447K [0x0000000740000000, 0x0000000759000000, 0x0000000795580000)\r\n  object space 409600K, 2% used [0x0000000740000000,0x0000000740939eb8,0x0000000759000000)\r\n Metaspace       used 55934K, capacity 59104K, committed 59160K, reserved 1101824K\r\n  class space    used 7429K, capacity 7796K, committed 7808K, reserved 1048576K\r\nEvent: 3.678 GC heap after\r\nHeap after GC invocations=9 (full 3):\r\n PSYoungGen      total 241152K, used 0K [0x0000000795580000, 0x00000007a6200000, 0x00000007c0000000)\r\n  eden space 224256K, 0% used [0x0000000795580000,0x0000000795580000,0x00000007a3080000)\r\n  from space 16896K, 0% used [0x00000007a4100000,0x00000007a4100000,0x00000007a5180000)\r\n  to   space 16896K, 0% used [0x00000007a3080000,0x00000007a3080000,0x00000007a4100000)\r\n ParOldGen       total 567296K, used 13199K [0x0000000740000000, 0x0000000762a00000, 0x0000000795580000)\r\n  object space 567296K, 2% used [0x0000000740000000,0x0000000740ce3fb0,0x0000000762a00000)\r\n Metaspace       used 55932K, capacity 59098K, committed 59160K, reserved 1101824K\r\n  class space    used 7428K, capacity 7795K, committed 7808K, reserved 1048576K\r\n}\r\nEvent: 4.809 GC heap before\r\n{Heap before GC invocations=10 (full 3):\r\n PSYoungGen      total 241152K, used 224256K [0x0000000795580000, 0x00000007a6200000, 0x00000007c0000000)\r\n  eden space 224256K, 100% used [0x0000000795580000,0x00000007a3080000,0x00000007a3080000)\r\n  from space 16896K, 0% used [0x00000007a4100000,0x00000007a4100000,0x00000007a5180000)\r\n  to   space 16896K, 0% used [0x00000007a3080000,0x00000007a3080000,0x00000007a4100000)\r\n ParOldGen       total 567296K, used 13199K [0x0000000740000000, 0x0000000762a00000, 0x0000000795580000)\r\n  object space 567296K, 2% used [0x0000000740000000,0x0000000740ce3fb0,0x0000000762a00000)\r\n Metaspace       used 70624K, capacity 77294K, committed 77440K, reserved 1116160K\r\n  class space    used 9576K, capacity 10350K, committed 10368K, reserved 1048576K\r\nEvent: 4.818 GC heap after\r\nHeap after GC invocations=10 (full 3):\r\n PSYoungGen      total 241152K, used 16067K [0x0000000795580000, 0x00000007a9e00000, 0x00000007c0000000)\r\n  eden space 224256K, 0% used [0x0000000795580000,0x0000000795580000,0x00000007a3080000)\r\n  from space 16896K, 95% used [0x00000007a3080000,0x00000007a4030c68,0x00000007a4100000)\r\n  to   space 18944K, 0% used [0x00000007a8b80000,0x00000007a8b80000,0x00000007a9e00000)\r\n ParOldGen       total 567296K, used 13207K [0x0000000740000000, 0x0000000762a00000, 0x0000000795580000)\r\n  object space 567296K, 2% used [0x0000000740000000,0x0000000740ce5fb0,0x0000000762a00000)\r\n Metaspace       used 70624K, capacity 77294K, committed 77440K, reserved 1116160K\r\n  class space    used 9576K, capacity 10350K, committed 10368K, reserved 1048576K\r\n}\r\nEvent: 5.942 GC heap before\r\n{Heap before GC invocations=11 (full 3):\r\n PSYoungGen      total 241152K, used 180997K [0x0000000795580000, 0x00000007a9e00000, 0x00000007c0000000)\r\n  eden space 224256K, 73% used [0x0000000795580000,0x000000079f6907d0,0x00000007a3080000)\r\n  from space 16896K, 95% used [0x00000007a3080000,0x00000007a4030c68,0x00000007a4100000)\r\n  to   space 18944K, 0% used [0x00000007a8b80000,0x00000007a8b80000,0x00000007a9e00000)\r\n ParOldGen       total 567296K, used 13207K [0x0000000740000000, 0x0000000762a00000, 0x0000000795580000)\r\n  object space 567296K, 2% used [0x0000000740000000,0x0000000740ce5fb0,0x0000000762a00000)\r\n Metaspace       used 90699K, capacity 98443K, committed 98600K, reserved 1134592K\r\n  class space    used 12245K, capacity 13080K, committed 13184K, reserved 1048576K\r\nEvent: 5.956 GC heap after\r\nHeap after GC invocations=11 (full 3):\r\n PSYoungGen      total 311296K, used 18921K [0x0000000795580000, 0x00000007aa880000, 0x00000007c0000000)\r\n  eden space 292352K, 0% used [0x0000000795580000,0x0000000795580000,0x00000007a7300000)\r\n  from space 18944K, 99% used [0x00000007a8b80000,0x00000007a9dfa660,0x00000007a9e00000)\r\n  to   space 25088K, 0% used [0x00000007a7300000,0x00000007a7300000,0x00000007a8b80000)\r\n ParOldGen       total 567296K, used 21464K [0x0000000740000000, 0x0000000762a00000, 0x0000000795580000)\r\n  object space 567296K, 3% used [0x0000000740000000,0x00000007414f60c0,0x0000000762a00000)\r\n Metaspace       used 90699K, capacity 98443K, committed 98600K, reserved 1134592K\r\n  class space    used 12245K, capacity 13080K, committed 13184K, reserved 1048576K\r\n}\r\nEvent: 5.956 GC heap before\r\n{Heap before GC invocations=12 (full 4):\r\n PSYoungGen      total 311296K, used 18921K [0x0000000795580000, 0x00000007aa880000, 0x00000007c0000000)\r\n  eden space 292352K, 0% used [0x0000000795580000,0x0000000795580000,0x00000007a7300000)\r\n  from space 18944K, 99% used [0x00000007a8b80000,0x00000007a9dfa660,0x00000007a9e00000)\r\n  to   space 25088K, 0% used [0x00000007a7300000,0x00000007a7300000,0x00000007a8b80000)\r\n ParOldGen       total 567296K, used 21464K [0x0000000740000000, 0x0000000762a00000, 0x0000000795580000)\r\n  object space 567296K, 3% used [0x0000000740000000,0x00000007414f60c0,0x0000000762a00000)\r\n Metaspace       used 90699K, capacity 98443K, committed 98600K, reserved 1134592K\r\n  class space    used 12245K, capacity 13080K, committed 13184K, reserved 1048576K\r\nEvent: 6.040 GC heap after\r\nHeap after GC invocations=12 (full 4):\r\n PSYoungGen      total 311296K, used 0K [0x0000000795580000, 0x00000007aa880000, 0x00000007c0000000)\r\n  eden space 292352K, 0% used [0x0000000795580000,0x0000000795580000,0x00000007a7300000)\r\n  from space 18944K, 0% used [0x00000007a8b80000,0x00000007a8b80000,0x00000007a9e00000)\r\n  to   space 25088K, 0% used [0x00000007a7300000,0x00000007a7300000,0x00000007a8b80000)\r\n ParOldGen       total 826368K, used 38162K [0x0000000740000000, 0x0000000772700000, 0x0000000795580000)\r\n  object space 826368K, 4% used [0x0000000740000000,0x0000000742544aa0,0x0000000772700000)\r\n Metaspace       used 90699K, capacity 98443K, committed 98600K, reserved 1134592K\r\n  class space    used 12245K, capacity 13080K, committed 13184K, reserved 1048576K\r\n}\r\nEvent: 8.008 GC heap before\r\n{Heap before GC invocations=13 (full 4):\r\n PSYoungGen      total 311296K, used 292352K [0x0000000795580000, 0x00000007aa880000, 0x00000007c0000000)\r\n  eden space 292352K, 100% used [0x0000000795580000,0x00000007a7300000,0x00000007a7300000)\r\n  from space 18944K, 0% used [0x00000007a8b80000,0x00000007a8b80000,0x00000007a9e00000)\r\n  to   space 25088K, 0% used [0x00000007a7300000,0x00000007a7300000,0x00000007a8b80000)\r\n ParOldGen       total 826368K, used 38162K [0x0000000740000000, 0x0000000772700000, 0x0000000795580000)\r\n  object space 826368K, 4% used [0x0000000740000000,0x0000000742544aa0,0x0000000772700000)\r\n Metaspace       used 106999K, capacity 116745K, committed 116864K, reserved 1150976K\r\n  class space    used 14520K, capacity 15488K, committed 15488K, reserved 1048576K\r\nEvent: 8.023 GC heap after\r\nHeap after GC invocations=13 (full 4):\r\n PSYoungGen      total 317440K, used 24495K [0x0000000795580000, 0x00000007adc00000, 0x00000007c0000000)\r\n  eden space 292352K, 0% used [0x0000000795580000,0x0000000795580000,0x00000007a7300000)\r\n  from space 25088K, 97% used [0x00000007a7300000,0x00000007a8aebf48,0x00000007a8b80000)\r\n  to   space 28672K, 0% used [0x00000007ac000000,0x00000007ac000000,0x00000007adc00000)\r\n ParOldGen       total 826368K, used 38178K [0x0000000740000000, 0x0000000772700000, 0x0000000795580000)\r\n  object space 826368K, 4% used [0x0000000740000000,0x0000000742548aa0,0x0000000772700000)\r\n Metaspace       used 106999K, capacity 116745K, committed 116864K, reserved 1150976K\r\n  class space    used 14520K, capacity 15488K, committed 15488K, reserved 1048576K\r\n}\r\n\r\nDeoptimization events (10 events):\r\nEvent: 8.138 Thread 0x00007ff8d78b4800 Uncommon trap: reason=bimorphic action=maybe_recompile pc=0x000000010e4e44f4 method=org.codehaus.janino.IClass.getSuperclass()Lorg/codehaus/janino/IClass; @ 13\r\nEvent: 8.138 Thread 0x00007ff8d78b4800 Uncommon trap: reason=bimorphic action=maybe_recompile pc=0x000000010e5f0aa4 method=org.codehaus.janino.IClass.getInterfaces()[Lorg/codehaus/janino/IClass; @ 13\r\nEvent: 8.139 Thread 0x00007ff8d78b4800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x000000010fc53ab0 method=org.codehaus.janino.UnitCompiler.internalCheckAccessible(Lorg/codehaus/janino/IClass;Lorg/codehaus/janino/Access;Lorg/codehaus/janino/Java$Scope;)Ljava/lang/String; @ 34\r\nEvent: 8.139 Thread 0x00007ff8d78b4800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x000000010fc53ab0 method=org.codehaus.janino.UnitCompiler.internalCheckAccessible(Lorg/codehaus/janino/IClass;Lorg/codehaus/janino/Access;Lorg/codehaus/janino/Java$Scope;)Ljava/lang/String; @ 34\r\nEvent: 8.139 Thread 0x00007ff8d78b4800 Uncommon trap: reason=bimorphic action=maybe_recompile pc=0x000000010e4e44f4 method=org.codehaus.janino.IClass.getSuperclass()Lorg/codehaus/janino/IClass; @ 13\r\nEvent: 8.140 Thread 0x00007ff8d78b4800 Uncommon trap: reason=bimorphic action=maybe_recompile pc=0x000000010e5f0aa4 method=org.codehaus.janino.IClass.getInterfaces()[Lorg/codehaus/janino/IClass; @ 13\r\nEvent: 8.143 Thread 0x00007ff8d78b4800 Uncommon trap: reason=unstable_if action=reinterpret pc=0x000000010ff8ab2c method=org.codehaus.janino.IClass.implementsInterface(Lorg/codehaus/janino/IClass;)Z @ 39\r\nEvent: 8.143 Thread 0x00007ff8d78b4800 Uncommon trap: reason=unstable_if action=reinterpret pc=0x0000000110014090 method=org.codehaus.janino.IClass.isAssignableFrom(Lorg/codehaus/janino/IClass;)Z @ 69\r\nEvent: 8.174 Thread 0x00007ff8d78b4800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x00000001100454c4 method=org.codehaus.janino.UnitCompiler.findLocalClassDeclaration(Lorg/codehaus/janino/Java$Scope;Ljava/lang/String;)Lorg/codehaus/janino/Java$LocalClassDeclaration; @ 70\r\nEvent: 8.174 Thread 0x00007ff8d78b4800 Uncommon trap: reason=class_check action=maybe_recompile pc=0x000000010e9bcac8 method=org.codehaus.janino.UnitCompiler.reclassifyName(Lorg/codehaus/commons/compiler/Location;Lorg/codehaus/janino/Java$Scope;[Ljava/lang/String;I)Lorg/codehaus/janino/Java$At\r\n\r\nClasses redefined (0 events):\r\nNo events\r\n\r\nInternal exceptions (10 events):\r\nEvent: 7.392 Thread 0x00007ff92a009800 Exception <a 'java/lang/NoSuchMethodError': <clinit>> (0x00000007a0187a40) thrown at [/Users/jenkins/workspace/build-scripts/jobs/jdk8u/jdk8u-mac-x64-hotspot/workspace/build/src/hotspot/src/share/vm/prims/jni.cpp, line 1616]\r\nEvent: 7.393 Thread 0x00007ff92a009800 Exception <a 'java/lang/NoSuchMethodError': <clinit>> (0x00000007a01ac580) thrown at [/Users/jenkins/workspace/build-scripts/jobs/jdk8u/jdk8u-mac-x64-hotspot/workspace/build/src/hotspot/src/share/vm/prims/jni.cpp, line 1616]\r\nEvent: 7.397 Thread 0x00007ff92a009800 Exception <a 'java/lang/NoSuchMethodError': <clinit>> (0x00000007a01f43a8) thrown at [/Users/jenkins/workspace/build-scripts/jobs/jdk8u/jdk8u-mac-x64-hotspot/workspace/build/src/hotspot/src/share/vm/prims/jni.cpp, line 1616]\r\nEvent: 7.398 Thread 0x00007ff92a009800 Exception <a 'java/lang/NoSuchMethodError': <clinit>> (0x00000007a021c138) thrown at [/Users/jenkins/workspace/build-scripts/jobs/jdk8u/jdk8u-mac-x64-hotspot/workspace/build/src/hotspot/src/share/vm/prims/jni.cpp, line 1616]\r\nEvent: 7.400 Thread 0x00007ff92a009800 Exception <a 'java/lang/NoSuchMethodError': <clinit>> (0x00000007a0244530) thrown at [/Users/jenkins/workspace/build-scripts/jobs/jdk8u/jdk8u-mac-x64-hotspot/workspace/build/src/hotspot/src/share/vm/prims/jni.cpp, line 1616]\r\nEvent: 7.407 Thread 0x00007ff92a009800 Exception <a 'java/lang/NoSuchMethodError': <clinit>> (0x00000007a04f6bb8) thrown at [/Users/jenkins/workspace/build-scripts/jobs/jdk8u/jdk8u-mac-x64-hotspot/workspace/build/src/hotspot/src/share/vm/prims/jni.cpp, line 1616]\r\nEvent: 7.408 Thread 0x00007ff92a009800 Exception <a 'java/lang/NoSuchMethodError': <clinit>> (0x00000007a0517d30) thrown at [/Users/jenkins/workspace/build-scripts/jobs/jdk8u/jdk8u-mac-x64-hotspot/workspace/build/src/hotspot/src/share/vm/prims/jni.cpp, line 1616]\r\nEvent: 7.409 Thread 0x00007ff92a009800 Exception <a 'java/lang/NoSuchMethodError': <clinit>> (0x00000007a053b238) thrown at [/Users/jenkins/workspace/build-scripts/jobs/jdk8u/jdk8u-mac-x64-hotspot/workspace/build/src/hotspot/src/share/vm/prims/jni.cpp, line 1616]\r\nEvent: 7.521 Thread 0x00007ff8d78b4800 Exception <a 'java/lang/NoSuchMethodError': java.lang.Object.$anonfun$prepareArguments$1(Lorg/apache/spark/sql/catalyst/expressions/codegen/CodegenContext;Lorg/apache/spark/sql/catalyst/expressions/Expression;)Ljava/lang/String;> (0x00000007a1e75410) thro\r\nEvent: 7.521 Thread 0x00007ff8d78b4800 Exception <a 'java/lang/NoSuchMethodError': java.lang.Object.$anonfun$prepareArguments$3(Lorg/apache/spark/sql/catalyst/expressions/codegen/CodegenContext;Lscala/collection/Seq;Lscala/Tuple2;)Ljava/lang/String;> (0x00000007a1e7f888) thrown at [/Users/jenk\r\n\r\nEvents (10 events):\r\nEvent: 8.181 loading class org/apache/spark/sql/catalyst/expressions/MutableLong\r\nEvent: 8.181 loading class org/apache/spark/sql/catalyst/expressions/MutableLong done\r\nEvent: 8.181 loading class org/apache/spark/sql/catalyst/expressions/MutableFloat\r\nEvent: 8.181 loading class org/apache/spark/sql/catalyst/expressions/MutableFloat done\r\nEvent: 8.182 loading class org/apache/spark/sql/catalyst/expressions/MutableDouble\r\nEvent: 8.182 loading class org/apache/spark/sql/catalyst/expressions/MutableDouble done\r\nEvent: 8.182 loading class org/apache/spark/sql/catalyst/expressions/MutableAny\r\nEvent: 8.182 loading class org/apache/spark/sql/catalyst/expressions/MutableAny done\r\nEvent: 8.182 loading class org/apache/spark/sql/catalyst/expressions/GeneratedClass$SpecificSafeProjection\r\nEvent: 8.182 loading class org/apache/spark/sql/catalyst/expressions/GeneratedClass$SpecificSafeProjection done\r\n\r\n\r\nDynamic libraries:\r\n0x00007fff30420000 \t/System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa\r\n0x00007fff3dc19000 \t/System/Library/Frameworks/Security.framework/Versions/A/Security\r\n0x00007fff2f385000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices\r\n0x00007fff6a73d000 \t/usr/lib/libz.1.dylib\r\n0x00007fff68201000 \t/usr/lib/libSystem.B.dylib\r\n0x00007fff312c2000 \t/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation\r\n0x00007fff3397f000 \t/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation\r\n0x00007fff6a061000 \t/usr/lib/libobjc.A.dylib\r\n0x00007fff2e575000 \t/System/Library/Frameworks/AppKit.framework/Versions/C/AppKit\r\n0x00007fff30da4000 \t/System/Library/Frameworks/CoreData.framework/Versions/A/CoreData\r\n0x00007fff62216000 \t/System/Library/PrivateFrameworks/UIFoundation.framework/Versions/A/UIFoundation\r\n0x00007fff5d2aa000 \t/System/Library/PrivateFrameworks/RemoteViewServices.framework/Versions/A/RemoteViewServices\r\n0x00007fff64d71000 \t/System/Library/PrivateFrameworks/XCTTargetBootstrap.framework/Versions/A/XCTTargetBootstrap\r\n0x00007fff3118f000 \t/System/Library/Frameworks/CoreDisplay.framework/Versions/A/CoreDisplay\r\n0x00007fff3683a000 \t/System/Library/Frameworks/Metal.framework/Versions/A/Metal\r\n0x00007fff4b2ad000 \t/System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv\r\n0x00007fff6933c000 \t/usr/lib/liblangid.dylib\r\n0x00007fff4a542000 \t/System/Library/PrivateFrameworks/CoreSVG.framework/Versions/A/CoreSVG\r\n0x00007fff60406000 \t/System/Library/PrivateFrameworks/SkyLight.framework/Versions/A/SkyLight\r\n0x00007fff31743000 \t/System/Library/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics\r\n0x00007fff2cf49000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate\r\n0x00007fff6a62e000 \t/usr/lib/libxml2.2.dylib\r\n0x00007fff56235000 \t/System/Library/PrivateFrameworks/IconServices.framework/Versions/A/IconServices\r\n0x00007fff3415e000 \t/System/Library/Frameworks/IOSurface.framework/Versions/A/IOSurface\r\n0x00007fff67d2b000 \t/usr/lib/libDiagnosticMessagesClient.dylib\r\n0x00007fff4b107000 \t/System/Library/PrivateFrameworks/DFRFoundation.framework/Versions/A/DFRFoundation\r\n0x00007fff690cb000 \t/usr/lib/libicucore.A.dylib\r\n0x00007fff2f6b7000 \t/System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox\r\n0x00007fff2f79a000 \t/System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit\r\n0x00007fff68403000 \t/usr/lib/libauto.dylib\r\n0x00007fff4b1a9000 \t/System/Library/PrivateFrameworks/DataDetectorsCore.framework/Versions/A/DataDetectorsCore\r\n0x00007fff2ff41000 \t/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox\r\n0x00007fff3ce13000 \t/System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore\r\n0x00007fff30280000 \t/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition\r\n0x00007fff4ac1b000 \t/System/Library/PrivateFrameworks/CoreUI.framework/Versions/A/CoreUI\r\n0x00007fff3080f000 \t/System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio\r\n0x00007fff3363e000 \t/System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration\r\n0x00007fff58285000 \t/System/Library/PrivateFrameworks/MultitouchSupport.framework/Versions/A/MultitouchSupport\r\n0x00007fff68f92000 \t/usr/lib/libenergytrace.dylib\r\n0x00007fff340b8000 \t/System/Library/Frameworks/IOKit.framework/Versions/A/IOKit\r\n0x00007fff326aa000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices\r\n0x00007fff5a43d000 \t/System/Library/PrivateFrameworks/PerformanceAnalysis.framework/Versions/A/PerformanceAnalysis\r\n0x00007fff3be46000 \t/System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL\r\n0x00007fff3042e000 \t/System/Library/Frameworks/ColorSync.framework/Versions/A/ColorSync\r\n0x00007fff31dc6000 \t/System/Library/Frameworks/CoreImage.framework/Versions/A/CoreImage\r\n0x00007fff3311d000 \t/System/Library/Frameworks/CoreText.framework/Versions/A/CoreText\r\n0x00007fff341ee000 \t/System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO\r\n0x00007fff684e7000 \t/usr/lib/libc++.1.dylib\r\n0x00007fff68563000 \t/usr/lib/libcompression.dylib\r\n0x00007fff6806f000 \t/usr/lib/libMobileGestalt.dylib\r\n0x00007fff61f80000 \t/System/Library/PrivateFrameworks/TextureIO.framework/Versions/A/TextureIO\r\n0x00007fff68366000 \t/usr/lib/libate.dylib\r\n0x00007fff5643e000 \t/System/Library/PrivateFrameworks/InternationalSupport.framework/Versions/A/InternationalSupport\r\n0x00007fff6affe000 \t/usr/lib/system/libcache.dylib\r\n0x00007fff6b004000 \t/usr/lib/system/libcommonCrypto.dylib\r\n0x00007fff6b010000 \t/usr/lib/system/libcompiler_rt.dylib\r\n0x00007fff6b018000 \t/usr/lib/system/libcopyfile.dylib\r\n0x00007fff6b022000 \t/usr/lib/system/libcorecrypto.dylib\r\n0x00007fff6b1c1000 \t/usr/lib/system/libdispatch.dylib\r\n0x00007fff6b202000 \t/usr/lib/system/libdyld.dylib\r\n0x00007fff6b239000 \t/usr/lib/system/libkeymgr.dylib\r\n0x00007fff6b247000 \t/usr/lib/system/liblaunch.dylib\r\n0x00007fff6b248000 \t/usr/lib/system/libmacho.dylib\r\n0x00007fff6b24e000 \t/usr/lib/system/libquarantine.dylib\r\n0x00007fff6b251000 \t/usr/lib/system/libremovefile.dylib\r\n0x00007fff6b253000 \t/usr/lib/system/libsystem_asl.dylib\r\n0x00007fff6b26b000 \t/usr/lib/system/libsystem_blocks.dylib\r\n0x00007fff6b26c000 \t/usr/lib/system/libsystem_c.dylib\r\n0x00007fff6b2f4000 \t/usr/lib/system/libsystem_configuration.dylib\r\n0x00007fff6b2f8000 \t/usr/lib/system/libsystem_coreservices.dylib\r\n0x00007fff6b2fc000 \t/usr/lib/system/libsystem_darwin.dylib\r\n0x00007fff6b305000 \t/usr/lib/system/libsystem_dnssd.dylib\r\n0x00007fff6b30d000 \t/usr/lib/system/libsystem_featureflags.dylib\r\n0x00007fff6b30f000 \t/usr/lib/system/libsystem_info.dylib\r\n0x00007fff6b38a000 \t/usr/lib/system/libsystem_m.dylib\r\n0x00007fff6b3d2000 \t/usr/lib/system/libsystem_malloc.dylib\r\n0x00007fff6b3fa000 \t/usr/lib/system/libsystem_networkextension.dylib\r\n0x00007fff6b408000 \t/usr/lib/system/libsystem_notify.dylib\r\n0x00007fff6b426000 \t/usr/lib/system/libsystem_sandbox.dylib\r\n0x00007fff6b42b000 \t/usr/lib/system/libsystem_secinit.dylib\r\n0x00007fff6b35d000 \t/usr/lib/system/libsystem_kernel.dylib\r\n0x00007fff6b412000 \t/usr/lib/system/libsystem_platform.dylib\r\n0x00007fff6b41b000 \t/usr/lib/system/libsystem_pthread.dylib\r\n0x00007fff6b42e000 \t/usr/lib/system/libsystem_symptoms.dylib\r\n0x00007fff6b436000 \t/usr/lib/system/libsystem_trace.dylib\r\n0x00007fff6b44e000 \t/usr/lib/system/libunwind.dylib\r\n0x00007fff6b454000 \t/usr/lib/system/libxpc.dylib\r\n0x00007fff6853a000 \t/usr/lib/libc++abi.dylib\r\n0x00007fff6933e000 \t/usr/lib/liblzma.5.dylib\r\n0x00007fff68fb9000 \t/usr/lib/libfakelink.dylib\r\n0x00007fff682f3000 \t/usr/lib/libarchive.2.dylib\r\n0x00007fff3ecca000 \t/System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration\r\n0x00007fff67c5e000 \t/usr/lib/libCRFSuite.dylib\r\n0x00007fff2fb31000 \t/System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork\r\n0x00007fff684c9000 \t/usr/lib/libbsm.0.dylib\r\n0x00007fff6b23a000 \t/usr/lib/system/libkxld.dylib\r\n0x00007fff44a84000 \t/System/Library/PrivateFrameworks/AppleFSCompression.framework/Versions/A/AppleFSCompression\r\n0x00007fff68854000 \t/usr/lib/libcoretls.dylib\r\n0x00007fff6886b000 \t/usr/lib/libcoretls_cfhelpers.dylib\r\n0x00007fff6a0a7000 \t/usr/lib/libpam.2.dylib\r\n0x00007fff6a1dc000 \t/usr/lib/libsqlite3.dylib\r\n0x00007fff6a61b000 \t/usr/lib/libxar.1.dylib\r\n0x00007fff684da000 \t/usr/lib/libbz2.1.0.dylib\r\n0x00007fff68fda000 \t/usr/lib/libiconv.2.dylib\r\n0x00007fff68550000 \t/usr/lib/libcharset.1.dylib\r\n0x00007fff69b44000 \t/usr/lib/libnetwork.dylib\r\n0x00007fff6a0ae000 \t/usr/lib/libpcap.A.dylib\r\n0x00007fff682a8000 \t/usr/lib/libapple_nghttp2.dylib\r\n0x00007fff32a61000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/FSEvents.framework/Versions/A/FSEvents\r\n0x00007fff32731000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore\r\n0x00007fff32ca5000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata\r\n0x00007fff32d3e000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices\r\n0x00007fff32d6c000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit\r\n0x00007fff326ab000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE\r\n0x00007fff32a6a000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices\r\n0x00007fff32a13000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/DictionaryServices.framework/Versions/A/DictionaryServices\r\n0x00007fff32dd4000 \t/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SharedFileList.framework/Versions/A/SharedFileList\r\n0x00007fff37c65000 \t/System/Library/Frameworks/NetFS.framework/Versions/A/NetFS\r\n0x00007fff587b5000 \t/System/Library/PrivateFrameworks/NetAuth.framework/Versions/A/NetAuth\r\n0x00007fff6513e000 \t/System/Library/PrivateFrameworks/login.framework/Versions/A/Frameworks/loginsupport.framework/Versions/A/loginsupport\r\n0x00007fff61a4b000 \t/System/Library/PrivateFrameworks/TCC.framework/Versions/A/TCC\r\n0x00007fff496b5000 \t/System/Library/PrivateFrameworks/CoreNLP.framework/Versions/A/CoreNLP\r\n0x00007fff57cb2000 \t/System/Library/PrivateFrameworks/MetadataUtilities.framework/Versions/A/MetadataUtilities\r\n0x00007fff69416000 \t/usr/lib/libmecabra.dylib\r\n0x00007fff6936e000 \t/usr/lib/libmecab.dylib\r\n0x00007fff68fca000 \t/usr/lib/libgermantok.dylib\r\n0x00007fff6828f000 \t/usr/lib/libThaiTokenizer.dylib\r\n0x00007fff67c95000 \t/usr/lib/libChineseTokenizer.dylib\r\n0x00007fff2cf61000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage\r\n0x00007fff2e3cb000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib\r\n0x00007fff2e308000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib\r\n0x00007fff2e130000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib\r\n0x00007fff2d5b8000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib\r\n0x00007fff2dcf4000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib\r\n0x00007fff2e090000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLinearAlgebra.dylib\r\n0x00007fff2e11d000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libSparseBLAS.dylib\r\n0x00007fff2e0a6000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libQuadrature.dylib\r\n0x00007fff2d820000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBNNS.dylib\r\n0x00007fff2e0ac000 \t/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libSparse.dylib\r\n0x00007fff56826000 \t/System/Library/PrivateFrameworks/LanguageModeling.framework/Versions/A/LanguageModeling\r\n0x00007fff49065000 \t/System/Library/PrivateFrameworks/CoreEmoji.framework/Versions/A/CoreEmoji\r\n0x00007fff56944000 \t/System/Library/PrivateFrameworks/LinguisticData.framework/Versions/A/LinguisticData\r\n0x00007fff568f5000 \t/System/Library/PrivateFrameworks/Lexicon.framework/Versions/A/Lexicon\r\n0x00007fff68551000 \t/usr/lib/libcmph.dylib\r\n0x00007fff3a854000 \t/System/Library/Frameworks/OpenDirectory.framework/Versions/A/Frameworks/CFOpenDirectory.framework/Versions/A/CFOpenDirectory\r\n0x00007fff3a871000 \t/System/Library/Frameworks/OpenDirectory.framework/Versions/A/OpenDirectory\r\n0x00007fff42cb4000 \t/System/Library/PrivateFrameworks/APFS.framework/Versions/A/APFS\r\n0x00007fff3df63000 \t/System/Library/Frameworks/SecurityFoundation.framework/Versions/A/SecurityFoundation\r\n0x00007fff6a617000 \t/usr/lib/libutil.dylib\r\n0x00007fff4a59a000 \t/System/Library/PrivateFrameworks/CoreServicesStore.framework/Versions/A/CoreServicesStore\r\n0x00007fff3e01a000 \t/System/Library/Frameworks/ServiceManagement.framework/Versions/A/ServiceManagement\r\n0x00007fff46254000 \t/System/Library/PrivateFrameworks/BackgroundTaskManagement.framework/Versions/A/BackgroundTaskManagement\r\n0x00007fff6a714000 \t/usr/lib/libxslt.1.dylib\r\n0x00007fff450f7000 \t/System/Library/PrivateFrameworks/AppleSystemInfo.framework/Versions/A/AppleSystemInfo\r\n0x00007fff34409000 \t/System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib\r\n0x00007fff346c8000 \t/System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib\r\n0x00007fff346ab000 \t/System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib\r\n0x00007fff3434b000 \t/System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib\r\n0x00007fff3434f000 \t/System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib\r\n0x00007fff346c6000 \t/System/Library/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib\r\n0x00007fff68f93000 \t/usr/lib/libexpat.1.dylib\r\n0x00007fff44bdf000 \t/System/Library/PrivateFrameworks/AppleJPEG.framework/Versions/A/AppleJPEG\r\n0x00007fff4d89a000 \t/System/Library/PrivateFrameworks/FontServices.framework/libFontParser.dylib\r\n0x00007fff64140000 \t/System/Library/PrivateFrameworks/WatchdogClient.framework/Versions/A/WatchdogClient\r\n0x00007fff55e81000 \t/System/Library/PrivateFrameworks/IOAccelerator.framework/Versions/A/IOAccelerator\r\n0x00007fff36bd5000 \t/System/Library/Frameworks/MetalPerformanceShaders.framework/Versions/A/MetalPerformanceShaders\r\n0x00007fff52617000 \t/System/Library/PrivateFrameworks/GPUWrangler.framework/Versions/A/GPUWrangler\r\n0x00007fff55e96000 \t/System/Library/PrivateFrameworks/IOPresentment.framework/Versions/A/IOPresentment\r\n0x00007fff4b11a000 \t/System/Library/PrivateFrameworks/DSExternalDisplay.framework/Versions/A/DSExternalDisplay\r\n0x00007fff3b1e5000 \t/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreFSCache.dylib\r\n0x00007fff36921000 \t/System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSCore.framework/Versions/A/MPSCore\r\n0x00007fff3695f000 \t/System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSImage.framework/Versions/A/MPSImage\r\n0x00007fff36a26000 \t/System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSNeuralNetwork.framework/Versions/A/MPSNeuralNetwork\r\n0x00007fff369ea000 \t/System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSMatrix.framework/Versions/A/MPSMatrix\r\n0x00007fff36b85000 \t/System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSRayIntersector.framework/Versions/A/MPSRayIntersector\r\n0x00007fff36a10000 \t/System/Library/Frameworks/MetalPerformanceShaders.framework/Frameworks/MPSNDArray.framework/Versions/A/MPSNDArray\r\n0x00007fff57cff000 \t/System/Library/PrivateFrameworks/MetalTools.framework/Versions/A/MetalTools\r\n0x00007fff43e8e000 \t/System/Library/PrivateFrameworks/AggregateDictionary.framework/Versions/A/AggregateDictionary\r\n0x00007fff48aad000 \t/System/Library/PrivateFrameworks/CoreAnalytics.framework/Versions/A/CoreAnalytics\r\n0x00007fff45016000 \t/System/Library/PrivateFrameworks/AppleSauce.framework/Versions/A/AppleSauce\r\n0x00007fff67f51000 \t/usr/lib/libIOReport.dylib\r\n0x00007fff332d5000 \t/System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo\r\n0x00007fff53a90000 \t/System/Library/PrivateFrameworks/GraphVisualizer.framework/Versions/A/GraphVisualizer\r\n0x00007fff4cde0000 \t/System/Library/PrivateFrameworks/FaceCore.framework/Versions/A/FaceCore\r\n0x00007fff3a7fb000 \t/System/Library/Frameworks/OpenCL.framework/Versions/A/OpenCL\r\n0x00007fff67d73000 \t/usr/lib/libFosl_dynamic.dylib\r\n0x00007fff591d5000 \t/System/Library/PrivateFrameworks/OTSVG.framework/Versions/A/OTSVG\r\n0x00007fff2f48a000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/Resources/libFontRegistry.dylib\r\n0x00007fff4da6b000 \t/System/Library/PrivateFrameworks/FontServices.framework/libhvf.dylib\r\n0x00007fff3b1f0000 \t/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGFXShared.dylib\r\n0x00007fff3b3ce000 \t/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib\r\n0x00007fff3b1f9000 \t/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib\r\n0x00007fff3b204000 \t/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib\r\n0x00007fff3b1e2000 \t/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCVMSPluginSupport.dylib\r\n0x00007fff3b1eb000 \t/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libCoreVMClient.dylib\r\n0x00007fff699e5000 \t/usr/lib/libncurses.5.4.dylib\r\n0x00007fff2f386000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS\r\n0x00007fff2f553000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSyncLegacy.framework/Versions/A/ColorSyncLegacy\r\n0x00007fff2f5f1000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices\r\n0x00007fff2f649000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis\r\n0x00007fff2f658000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore\r\n0x00007fff2f69e000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD\r\n0x00007fff2f6a9000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis\r\n0x00007fff2f523000 \t/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATSUI.framework/Versions/A/ATSUI\r\n0x00007fff68e29000 \t/usr/lib/libcups.2.dylib\r\n0x00007fff35c70000 \t/System/Library/Frameworks/Kerberos.framework/Versions/A/Kerberos\r\n0x00007fff33db1000 \t/System/Library/Frameworks/GSS.framework/Versions/A/GSS\r\n0x00007fff6a168000 \t/usr/lib/libresolv.9.dylib\r\n0x00007fff53c3d000 \t/System/Library/PrivateFrameworks/Heimdal.framework/Versions/A/Heimdal\r\n0x00007fff35c83000 \t/System/Library/Frameworks/Kerberos.framework/Versions/A/Libraries/libHeimdalProxy.dylib\r\n0x00007fff68fd0000 \t/usr/lib/libheimdal-asn1.dylib\r\n0x00007fff47f45000 \t/System/Library/PrivateFrameworks/CommonAuth.framework/Versions/A/CommonAuth\r\n0x00007fff45194000 \t/System/Library/PrivateFrameworks/AssertionServices.framework/Versions/A/AssertionServices\r\n0x00007fff45d37000 \t/System/Library/PrivateFrameworks/AudioToolboxCore.framework/Versions/A/AudioToolboxCore\r\n0x00007fff64dee000 \t/System/Library/PrivateFrameworks/caulk.framework/Versions/A/caulk\r\n0x00007fff46300000 \t/System/Library/PrivateFrameworks/BaseBoard.framework/Versions/A/BaseBoard\r\n0x00007fff5d438000 \t/System/Library/PrivateFrameworks/RunningBoardServices.framework/Versions/A/RunningBoardServices\r\n0x00007fff5a449000 \t/System/Library/PrivateFrameworks/PersistentConnection.framework/Versions/A/PersistentConnection\r\n0x00007fff5ce31000 \t/System/Library/PrivateFrameworks/ProtocolBuffer.framework/Versions/A/ProtocolBuffer\r\n0x00007fff47f69000 \t/System/Library/PrivateFrameworks/CommonUtilities.framework/Versions/A/CommonUtilities\r\n0x00007fff4648e000 \t/System/Library/PrivateFrameworks/Bom.framework/Versions/A/Bom\r\n0x00007fff67c24000 \t/usr/lib/libAudioToolboxUtility.dylib\r\n0x00007fff4625e000 \t/System/Library/PrivateFrameworks/Backup.framework/Versions/A/Backup\r\n0x00007fff4b03b000 \t/System/Library/PrivateFrameworks/CrashReporterSupport.framework/Versions/A/CrashReporterSupport\r\n0x00007fff5eeca000 \t/System/Library/PrivateFrameworks/Sharing.framework/Versions/A/Sharing\r\n0x00007fff447a2000 \t/System/Library/PrivateFrameworks/Apple80211.framework/Versions/A/Apple80211\r\n0x00007fff45f7b000 \t/System/Library/PrivateFrameworks/AuthKit.framework/Versions/A/AuthKit\r\n0x00007fff4ad48000 \t/System/Library/PrivateFrameworks/CoreUtils.framework/Versions/A/CoreUtils\r\n0x00007fff3331a000 \t/System/Library/Frameworks/CoreWLAN.framework/Versions/A/CoreWLAN\r\n0x00007fff33f3e000 \t/System/Library/Frameworks/IOBluetooth.framework/Versions/A/IOBluetooth\r\n0x00007fff58004000 \t/System/Library/PrivateFrameworks/MobileKeyBag.framework/Versions/A/MobileKeyBag\r\n0x00007fff49b4d000 \t/System/Library/PrivateFrameworks/CorePhoneNumbers.framework/Versions/A/CorePhoneNumbers\r\n0x00007fff44b92000 \t/System/Library/PrivateFrameworks/AppleIDAuthSupport.framework/Versions/A/AppleIDAuthSupport\r\n0x00007fff37c72000 \t/System/Library/Frameworks/Network.framework/Versions/A/Network\r\n0x00007fff566d2000 \t/System/Library/PrivateFrameworks/KeychainCircle.framework/Versions/A/KeychainCircle\r\n0x00007fff30d6b000 \t/System/Library/Frameworks/CoreBluetooth.framework/Versions/A/CoreBluetooth\r\n0x00007fff60f49000 \t/System/Library/PrivateFrameworks/SpeechRecognitionCore.framework/Versions/A/SpeechRecognitionCore\r\n0x0000000109000000 \t/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/lib/server/libjvm.dylib\r\n0x00000001099db000 \t/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/lib/libverify.dylib\r\n0x00000001099ec000 \t/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/lib/libjava.dylib\r\n0x0000000109a5f000 \t/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/lib/libzip.dylib\r\n0x000000010d16a000 \t/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/lib/libnio.dylib\r\n0x000000010d17c000 \t/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/lib/libnet.dylib\r\n0x000000010dedc000 \t/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/lib/libmanagement.dylib\r\n0x000000010dee9000 \t/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/lib/libjaas_unix.dylib\r\n0x000000010df18000 \t/private/var/folders/ky/3y1zvddj5ns3xks640388thh0000gn/T/liblz4-java-2909128287676442335.dylib\r\n\r\nVM Arguments:\r\njvm_args: -Xmx2g \r\njava_command: org.apache.spark.deploy.SparkSubmit --master local[2] --conf spark.driver.memory=2g --class org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer --packages org.apache.spark:spark-avro_2.12:3.0.1 /Users/username/workspace/hudi/packaging/hudi-utilities-bundle/target/hudi-utilities-bundle_2.12-0.6.1-SNAPSHOT.jar --table-type COPY_ON_WRITE --source-ordering-field ts_ms --schemaprovider-class org.apache.hudi.utilities.schema.SchemaRegistryProvider --source-class org.apache.hudi.utilities.sources.AvroKafkaSource --target-base-path /Users/username/Downloads/roi/debezium/by_test/ --target-table users --props ./hudi_base.properties --transformer-class org.apache.hudi.utilities.transform.SqlQueryBasedTransformer\r\njava_class_path (initial): /Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/conf/:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/okhttp-3.12.6.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/jakarta.xml.bind-api-2.3.2.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/machinist_2.12-0.6.8.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/jackson-jaxrs-base-2.9.5.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/commons-lang3-3.9.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/jaxb-runtime-2.3.2.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/kubernetes-model-4.9.2.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/minlog-1.3.0.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/arrow-vector-0.15.1.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/xz-1.5.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/hive-shims-scheduler-2.3.7.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/javolution-5.5.1.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/spark-repl_2.12-3.0.1.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/hadoop-yarn-server-web-proxy-3.2.0.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/jta-1.1.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/threeten-extra-1.5.0.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/hive-vector-code-gen-2.3.7.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/JTransforms-3.1.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/hive-shims-0.23-2.3.7.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/spark-launcher_2.12-3.0.1.jar:/Users/username/Downloads/spark-3.0.1-bin-hadoop3.2/jars/logging-interceptor-3.12.\r\nLauncher Type: SUN_STANDARD\r\n\r\nEnvironment Variables:\r\nJAVA_HOME=/Users/username/.jenv/versions/1.8\r\nPATH=/usr/local/opt/mysql-client/bin:/usr/local/opt/python@3.7/bin:/usr/local/opt/ncurses/bin:/Users/username/.jenv/shims:/Users/username/.jenv/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\r\nSHELL=/bin/zsh\r\n\r\nSignal Handlers:\r\nSIGSEGV: [libjvm.dylib+0x595d31], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_ONSTACK|SA_RESTART|SA_SIGINFO\r\nSIGBUS: [libjvm.dylib+0x595d31], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_RESTART|SA_SIGINFO\r\nSIGFPE: [libjvm.dylib+0x48a2eb], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_RESTART|SA_SIGINFO\r\nSIGPIPE: [libjvm.dylib+0x48a2eb], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_RESTART|SA_SIGINFO\r\nSIGXFSZ: [libjvm.dylib+0x48a2eb], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_RESTART|SA_SIGINFO\r\nSIGILL: [libjvm.dylib+0x48a2eb], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_RESTART|SA_SIGINFO\r\nSIGUSR1: SIG_DFL, sa_mask[0]=00000000000000000000000000000000, sa_flags=SA_RESTART\r\nSIGUSR2: [libjvm.dylib+0x48abe2], sa_mask[0]=00000000000000000000000000000000, sa_flags=SA_RESTART|SA_SIGINFO\r\nSIGHUP: [libjvm.dylib+0x488de1], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_RESTART|SA_SIGINFO\r\nSIGINT: [libjvm.dylib+0x488de1], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_RESTART|SA_SIGINFO\r\nSIGTERM: [libjvm.dylib+0x488de1], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_RESTART|SA_SIGINFO\r\nSIGQUIT: [libjvm.dylib+0x488de1], sa_mask[0]=11111111011111110111111111111111, sa_flags=SA_RESTART|SA_SIGINFO\r\n\r\n\r\n---------------  S Y S T E M  ---------------\r\n\r\nOS:Bsduname:Darwin 19.6.0 Darwin Kernel Version 19.6.0: Mon Aug 31 22:12:52 PDT 2020; root:xnu-6153.141.2~1/RELEASE_X86_64 x86_64\r\nrlimit: STACK 8192k, CORE 0k, NPROC 5568, NOFILE 10240, AS infinity\r\nload average:2.94 2.90 2.71\r\n\r\nCPU:total 16 (initial active 16) (8 cores per cpu, 2 threads per core) family 6 model 158 stepping 13, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3, sse4.1, sse4.2, popcnt, avx, avx2, aes, clmul, erms, 3dnowpref, lzcnt, ht, tsc, tscinvbit, bmi1, bmi2, adx\r\n\r\nMemory: 4k page, physical 33554432k(30828k free)\r\n\r\n/proc/meminfo:\r\n\r\n\r\nvm_info: OpenJDK 64-Bit Server VM (25.265-b01) for bsd-amd64 JRE (1.8.0_265-b01), built on Jul 28 2020 16:14:07 by \"jenkins\" with gcc 4.2.1 Compatible Apple LLVM 10.0.1 (clang-1001.0.46.4)\r\n\r\ntime: Sun Nov 22 10:03:44 2020\r\ntimezone: +08\r\nelapsed time: 9 seconds (0d 0h 0m 9s)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733747785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733797847","html_url":"https://github.com/apache/hudi/issues/2220#issuecomment-733797847","issue_url":"https://api.github.com/repos/apache/hudi/issues/2220","id":733797847,"node_id":"MDEyOklzc3VlQ29tbWVudDczMzc5Nzg0Nw==","user":{"login":"abhijeetkushe","id":2093096,"node_id":"MDQ6VXNlcjIwOTMwOTY=","avatar_url":"https://avatars.githubusercontent.com/u/2093096?v=4","gravatar_id":"","url":"https://api.github.com/users/abhijeetkushe","html_url":"https://github.com/abhijeetkushe","followers_url":"https://api.github.com/users/abhijeetkushe/followers","following_url":"https://api.github.com/users/abhijeetkushe/following{/other_user}","gists_url":"https://api.github.com/users/abhijeetkushe/gists{/gist_id}","starred_url":"https://api.github.com/users/abhijeetkushe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abhijeetkushe/subscriptions","organizations_url":"https://api.github.com/users/abhijeetkushe/orgs","repos_url":"https://api.github.com/users/abhijeetkushe/repos","events_url":"https://api.github.com/users/abhijeetkushe/events{/privacy}","received_events_url":"https://api.github.com/users/abhijeetkushe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-25T16:02:58Z","updated_at":"2020-11-25T16:02:58Z","author_association":"NONE","body":"Apologies for not responding to this earlier @bvaradar .We made an internal decision to explore EMR in continuous mode.Our frequency of events are very high \r\nWe also are thinking of trying to integrate Hudi with Nifi which is why a non spark based solution could work best.So we might explore both Spark integration with Nifi and the solution you suggested Presto on Spark ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/733797847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734054243","html_url":"https://github.com/apache/hudi/issues/2274#issuecomment-734054243","issue_url":"https://api.github.com/repos/apache/hudi/issues/2274","id":734054243,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDA1NDI0Mw==","user":{"login":"quitozang","id":12569046,"node_id":"MDQ6VXNlcjEyNTY5MDQ2","avatar_url":"https://avatars.githubusercontent.com/u/12569046?v=4","gravatar_id":"","url":"https://api.github.com/users/quitozang","html_url":"https://github.com/quitozang","followers_url":"https://api.github.com/users/quitozang/followers","following_url":"https://api.github.com/users/quitozang/following{/other_user}","gists_url":"https://api.github.com/users/quitozang/gists{/gist_id}","starred_url":"https://api.github.com/users/quitozang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quitozang/subscriptions","organizations_url":"https://api.github.com/users/quitozang/orgs","repos_url":"https://api.github.com/users/quitozang/repos","events_url":"https://api.github.com/users/quitozang/events{/privacy}","received_events_url":"https://api.github.com/users/quitozang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-26T03:36:21Z","updated_at":"2020-11-26T03:36:21Z","author_association":"NONE","body":"Sorry, it is not a problem anymore, I have changed part of the source code in DeltaStreamer. \r\n\r\nAnyway, I have another problem right now. When i use \"NonpartitionedKeyGenerator\" to write hudi data  and I don't specify \"hoodie.datasource.write.partitionpath.field\", it will make an error to execute DeltaStreamer. \r\nThe exception is \"Property hoodie.datasource.write.partitionpath.field not found\". This can be circumvented by specifying any value. However, in my opinion, this operation is a bit redundant because the attribute(hoodie.datasource.write.partitionpath.field) is useless.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734054243/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734137301","html_url":"https://github.com/apache/hudi/pull/2283#issuecomment-734137301","issue_url":"https://api.github.com/repos/apache/hudi/issues/2283","id":734137301,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDEzNzMwMQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-26T07:57:21Z","updated_at":"2021-04-08T13:20:02Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2283?src=pr&el=h1) Report\n> Merging [#2283](https://codecov.io/gh/apache/hudi/pull/2283?src=pr&el=desc) (6b9d680) into [master](https://codecov.io/gh/apache/hudi/commit/8527590772d05b58dcf7db460f743c6a43b78c1b?el=desc) (8527590) will **increase** coverage by `0.40%`.\n> The diff coverage is `71.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2283/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2283?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2283      +/-   ##\n============================================\n+ Coverage     52.27%   52.68%   +0.40%     \n- Complexity     3678     3714      +36     \n============================================\n  Files           484      485       +1     \n  Lines         23080    23227     +147     \n  Branches       2457     2474      +17     \n============================================\n+ Hits          12066    12236     +170     \n+ Misses         9950     9908      -42     \n- Partials       1064     1083      +19     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `40.29% <ø> (+3.35%)` | `0.00 <ø> (ø)` | |\n| hudiclient | `∅ <ø> (∅)` | `0.00 <ø> (ø)` | |\n| hudicommon | `50.67% <ø> (-0.14%)` | `0.00 <ø> (ø)` | |\n| hudiflink | `56.36% <ø> (-0.23%)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.44% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudisparkdatasource | `72.57% <70.45%> (+1.24%)` | `0.00 <0.00> (ø)` | |\n| hudisync | `46.69% <71.42%> (+1.22%)` | `0.00 <8.00> (ø)` | |\n| huditimelineservice | `64.36% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `69.77% <ø> (+0.08%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2283?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...src/main/java/org/apache/hudi/dla/DLASyncTool.java](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1zeW5jL2h1ZGktZGxhLXN5bmMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZGxhL0RMQVN5bmNUb29sLmphdmE=) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...main/java/org/apache/hudi/dla/HoodieDLAClient.java](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1zeW5jL2h1ZGktZGxhLXN5bmMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvZGxhL0hvb2RpZURMQUNsaWVudC5qYXZh) | `0.00% <0.00%> (ø)` | `0.00 <0.00> (ø)` | |\n| [...in/java/org/apache/hudi/hive/HoodieHiveClient.java](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvSG9vZGllSGl2ZUNsaWVudC5qYXZh) | `73.22% <66.66%> (-0.44%)` | `43.00 <2.00> (+2.00)` | :arrow_down: |\n| [...java/org/apache/hudi/hive/util/HiveSchemaUtil.java](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvdXRpbC9IaXZlU2NoZW1hVXRpbC5qYXZh) | `69.34% <70.00%> (+0.03%)` | `45.00 <0.00> (+2.00)` | |\n| [...n/scala/org/apache/hudi/HoodieSparkSqlWriter.scala](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay1kYXRhc291cmNlL2h1ZGktc3Bhcmsvc3JjL21haW4vc2NhbGEvb3JnL2FwYWNoZS9odWRpL0hvb2RpZVNwYXJrU3FsV3JpdGVyLnNjYWxh) | `66.37% <70.45%> (+7.85%)` | `0.00 <0.00> (ø)` | |\n| [...in/java/org/apache/hudi/hive/util/ConfigUtils.java](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvdXRpbC9Db25maWdVdGlscy5qYXZh) | `73.91% <73.91%> (ø)` | `6.00 <6.00> (?)` | |\n| [...main/java/org/apache/hudi/hive/HiveSyncConfig.java](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvSGl2ZVN5bmNDb25maWcuamF2YQ==) | `97.82% <100.00%> (+0.09%)` | `2.00 <0.00> (ø)` | |\n| [...c/main/java/org/apache/hudi/hive/HiveSyncTool.java](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1zeW5jL2h1ZGktaGl2ZS1zeW5jL3NyYy9tYWluL2phdmEvb3JnL2FwYWNoZS9odWRpL2hpdmUvSGl2ZVN5bmNUb29sLmphdmE=) | `71.68% <100.00%> (+1.31%)` | `18.00 <0.00> (+1.00)` | |\n| [.../apache/hudi/sink/compact/CompactionPlanEvent.java](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL2NvbXBhY3QvQ29tcGFjdGlvblBsYW5FdmVudC5qYXZh) | `50.00% <0.00%> (-50.00%)` | `3.00% <0.00%> (ø%)` | |\n| [...pache/hudi/sink/compact/CompactionCommitEvent.java](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree#diff-aHVkaS1mbGluay9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvaHVkaS9zaW5rL2NvbXBhY3QvQ29tcGFjdGlvbkNvbW1pdEV2ZW50LmphdmE=) | `43.75% <0.00%> (-43.75%)` | `3.00% <0.00%> (ø%)` | |\n| ... and [12 more](https://codecov.io/gh/apache/hudi/pull/2283/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734137301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734450744","html_url":"https://github.com/apache/hudi/issues/2269#issuecomment-734450744","issue_url":"https://api.github.com/repos/apache/hudi/issues/2269","id":734450744,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDQ1MDc0NA==","user":{"login":"asharma4-lucid","id":64492084,"node_id":"MDQ6VXNlcjY0NDkyMDg0","avatar_url":"https://avatars.githubusercontent.com/u/64492084?v=4","gravatar_id":"","url":"https://api.github.com/users/asharma4-lucid","html_url":"https://github.com/asharma4-lucid","followers_url":"https://api.github.com/users/asharma4-lucid/followers","following_url":"https://api.github.com/users/asharma4-lucid/following{/other_user}","gists_url":"https://api.github.com/users/asharma4-lucid/gists{/gist_id}","starred_url":"https://api.github.com/users/asharma4-lucid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asharma4-lucid/subscriptions","organizations_url":"https://api.github.com/users/asharma4-lucid/orgs","repos_url":"https://api.github.com/users/asharma4-lucid/repos","events_url":"https://api.github.com/users/asharma4-lucid/events{/privacy}","received_events_url":"https://api.github.com/users/asharma4-lucid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-26T19:21:48Z","updated_at":"2020-11-26T19:21:48Z","author_association":"NONE","body":"Thanks @bvaradar . Setting the value hoodie.clean.automatic=false has helped in reducing the processing time significantly. Now the 5 records got inserted in less than a minute.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734450744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734453893","html_url":"https://github.com/apache/hudi/issues/2269#issuecomment-734453893","issue_url":"https://api.github.com/repos/apache/hudi/issues/2269","id":734453893,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDQ1Mzg5Mw==","user":{"login":"asharma4-lucid","id":64492084,"node_id":"MDQ6VXNlcjY0NDkyMDg0","avatar_url":"https://avatars.githubusercontent.com/u/64492084?v=4","gravatar_id":"","url":"https://api.github.com/users/asharma4-lucid","html_url":"https://github.com/asharma4-lucid","followers_url":"https://api.github.com/users/asharma4-lucid/followers","following_url":"https://api.github.com/users/asharma4-lucid/following{/other_user}","gists_url":"https://api.github.com/users/asharma4-lucid/gists{/gist_id}","starred_url":"https://api.github.com/users/asharma4-lucid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asharma4-lucid/subscriptions","organizations_url":"https://api.github.com/users/asharma4-lucid/orgs","repos_url":"https://api.github.com/users/asharma4-lucid/repos","events_url":"https://api.github.com/users/asharma4-lucid/events{/privacy}","received_events_url":"https://api.github.com/users/asharma4-lucid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-26T19:33:05Z","updated_at":"2020-11-26T19:33:05Z","author_association":"NONE","body":"Is there a downside to keeping hoodie.clean.automatic=false?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734453893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734617776","html_url":"https://github.com/apache/hudi/issues/2285#issuecomment-734617776","issue_url":"https://api.github.com/repos/apache/hudi/issues/2285","id":734617776,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDYxNzc3Ng==","user":{"login":"zherenyu831","id":52404525,"node_id":"MDQ6VXNlcjUyNDA0NTI1","avatar_url":"https://avatars.githubusercontent.com/u/52404525?v=4","gravatar_id":"","url":"https://api.github.com/users/zherenyu831","html_url":"https://github.com/zherenyu831","followers_url":"https://api.github.com/users/zherenyu831/followers","following_url":"https://api.github.com/users/zherenyu831/following{/other_user}","gists_url":"https://api.github.com/users/zherenyu831/gists{/gist_id}","starred_url":"https://api.github.com/users/zherenyu831/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zherenyu831/subscriptions","organizations_url":"https://api.github.com/users/zherenyu831/orgs","repos_url":"https://api.github.com/users/zherenyu831/repos","events_url":"https://api.github.com/users/zherenyu831/events{/privacy}","received_events_url":"https://api.github.com/users/zherenyu831/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-27T03:09:25Z","updated_at":"2020-11-27T03:09:25Z","author_association":"CONTRIBUTOR","body":"<img width=\"1307\" alt=\"スクリーンショット 2020-11-27 11 54 34\" src=\"https://user-images.githubusercontent.com/52404525/100406505-5c3c6400-30a9-11eb-8ba9-18dd7876362c.png\">\r\n<img width=\"1401\" alt=\"スクリーンショット 2020-11-27 11 54 45\" src=\"https://user-images.githubusercontent.com/52404525/100406508-5e9ebe00-30a9-11eb-9e7f-7c2a40ff8fdd.png\">\r\n<img width=\"1396\" alt=\"スクリーンショット 2020-11-27 11 58 13\" src=\"https://user-images.githubusercontent.com/52404525/100406510-60688180-30a9-11eb-875c-095e51f326cf.png\">\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734617776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734619657","html_url":"https://github.com/apache/hudi/issues/2285#issuecomment-734619657","issue_url":"https://api.github.com/repos/apache/hudi/issues/2285","id":734619657,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDYxOTY1Nw==","user":{"login":"zherenyu831","id":52404525,"node_id":"MDQ6VXNlcjUyNDA0NTI1","avatar_url":"https://avatars.githubusercontent.com/u/52404525?v=4","gravatar_id":"","url":"https://api.github.com/users/zherenyu831","html_url":"https://github.com/zherenyu831","followers_url":"https://api.github.com/users/zherenyu831/followers","following_url":"https://api.github.com/users/zherenyu831/following{/other_user}","gists_url":"https://api.github.com/users/zherenyu831/gists{/gist_id}","starred_url":"https://api.github.com/users/zherenyu831/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zherenyu831/subscriptions","organizations_url":"https://api.github.com/users/zherenyu831/orgs","repos_url":"https://api.github.com/users/zherenyu831/repos","events_url":"https://api.github.com/users/zherenyu831/events{/privacy}","received_events_url":"https://api.github.com/users/zherenyu831/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-27T03:10:36Z","updated_at":"2020-11-27T03:10:36Z","author_association":"CONTRIBUTOR","body":"but array doubleDictionaryContent only has 3000 elements, it caused the problem","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734619657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734622537","html_url":"https://github.com/apache/hudi/issues/1908#issuecomment-734622537","issue_url":"https://api.github.com/repos/apache/hudi/issues/1908","id":734622537,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDYyMjUzNw==","user":{"login":"Ares-W","id":12905032,"node_id":"MDQ6VXNlcjEyOTA1MDMy","avatar_url":"https://avatars.githubusercontent.com/u/12905032?v=4","gravatar_id":"","url":"https://api.github.com/users/Ares-W","html_url":"https://github.com/Ares-W","followers_url":"https://api.github.com/users/Ares-W/followers","following_url":"https://api.github.com/users/Ares-W/following{/other_user}","gists_url":"https://api.github.com/users/Ares-W/gists{/gist_id}","starred_url":"https://api.github.com/users/Ares-W/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ares-W/subscriptions","organizations_url":"https://api.github.com/users/Ares-W/orgs","repos_url":"https://api.github.com/users/Ares-W/repos","events_url":"https://api.github.com/users/Ares-W/events{/privacy}","received_events_url":"https://api.github.com/users/Ares-W/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-27T03:12:31Z","updated_at":"2020-11-27T03:12:31Z","author_association":"NONE","body":"> yikes. did you downgrade manually. how did you end up solving this? it will be helpful for others if you can share\r\n\r\njust changed the parquet version from 1.9.0 to 1.8.3","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734622537/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734694792","html_url":"https://github.com/apache/hudi/issues/2276#issuecomment-734694792","issue_url":"https://api.github.com/repos/apache/hudi/issues/2276","id":734694792,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDY5NDc5Mg==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-27T07:45:48Z","updated_at":"2020-11-27T07:45:48Z","author_association":"NONE","body":"@bvaradar please help take a look at the above question， I want to write some code and see compaction takes effect","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734694792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734736989","html_url":"https://github.com/apache/hudi/issues/2276#issuecomment-734736989","issue_url":"https://api.github.com/repos/apache/hudi/issues/2276","id":734736989,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDczNjk4OQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-27T09:26:56Z","updated_at":"2020-11-27T09:26:56Z","author_association":"CONTRIBUTOR","body":"@bithw1 : Compactions need to be scheduled before they can be run. 20201122100045 20201122100057 20201122100101 are all delta-commits that tracks the ingestion that happened.  Compaction will be scheduled automatically by Hoodie at regular intervals. By defaults, Hudi waits for 5 delta-commits before scheduling a compaction. \r\n\r\nTo change this behavior, you can set hoodie.compact.inline.max.delta.commits=1\r\nand redo the experiment. You should see a file <ts>.compaction.requested file in .hoodie folder. You can then run compaction on the <ts>\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734736989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734752099","html_url":"https://github.com/apache/hudi/issues/143#issuecomment-734752099","issue_url":"https://api.github.com/repos/apache/hudi/issues/143","id":734752099,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDc1MjA5OQ==","user":{"login":"sanket-khedikar","id":38488721,"node_id":"MDQ6VXNlcjM4NDg4NzIx","avatar_url":"https://avatars.githubusercontent.com/u/38488721?v=4","gravatar_id":"","url":"https://api.github.com/users/sanket-khedikar","html_url":"https://github.com/sanket-khedikar","followers_url":"https://api.github.com/users/sanket-khedikar/followers","following_url":"https://api.github.com/users/sanket-khedikar/following{/other_user}","gists_url":"https://api.github.com/users/sanket-khedikar/gists{/gist_id}","starred_url":"https://api.github.com/users/sanket-khedikar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanket-khedikar/subscriptions","organizations_url":"https://api.github.com/users/sanket-khedikar/orgs","repos_url":"https://api.github.com/users/sanket-khedikar/repos","events_url":"https://api.github.com/users/sanket-khedikar/events{/privacy}","received_events_url":"https://api.github.com/users/sanket-khedikar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-27T10:00:41Z","updated_at":"2020-11-27T10:00:41Z","author_association":"NONE","body":"Please add me khedikar5@gmail.com\r\nThanks","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734752099/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734762758","html_url":"https://github.com/apache/hudi/issues/2276#issuecomment-734762758","issue_url":"https://api.github.com/repos/apache/hudi/issues/2276","id":734762758,"node_id":"MDEyOklzc3VlQ29tbWVudDczNDc2Mjc1OA==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-27T10:25:06Z","updated_at":"2020-11-27T10:25:06Z","author_association":"NONE","body":"Thanks @bvaradar .  I follow your suggestion and `set hoodie.compact.inline.max.delta.commits=1` and redo the experiment, but I still see the same result as follows, I don't how to work out, but I really want to see the  .compaction.requested file and trigger the compaction by myself,\r\n\r\n\r\n\r\n```\r\n.hoodie/.aux\r\n.hoodie/.temp\r\n.hoodie/20201127181830.deltacommit\r\n.hoodie/20201127181830.deltacommit.inflight\r\n.hoodie/20201127181830.deltacommit.requested\r\n.hoodie/20201127181842.deltacommit\r\n.hoodie/20201127181842.deltacommit.inflight\r\n.hoodie/20201127181842.deltacommit.requested\r\n.hoodie/20201127181847.deltacommit\r\n.hoodie/20201127181847.deltacommit.inflight\r\n.hoodie/20201127181847.deltacommit.requested\r\n.hoodie/archived\r\n.hoodie/hoodie.properties\r\n```\r\n\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/734762758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735227950","html_url":"https://github.com/apache/hudi/pull/2260#issuecomment-735227950","issue_url":"https://api.github.com/repos/apache/hudi/issues/2260","id":735227950,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTIyNzk1MA==","user":{"login":"Karl-WangSK","id":53078090,"node_id":"MDQ6VXNlcjUzMDc4MDkw","avatar_url":"https://avatars.githubusercontent.com/u/53078090?v=4","gravatar_id":"","url":"https://api.github.com/users/Karl-WangSK","html_url":"https://github.com/Karl-WangSK","followers_url":"https://api.github.com/users/Karl-WangSK/followers","following_url":"https://api.github.com/users/Karl-WangSK/following{/other_user}","gists_url":"https://api.github.com/users/Karl-WangSK/gists{/gist_id}","starred_url":"https://api.github.com/users/Karl-WangSK/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Karl-WangSK/subscriptions","organizations_url":"https://api.github.com/users/Karl-WangSK/orgs","repos_url":"https://api.github.com/users/Karl-WangSK/repos","events_url":"https://api.github.com/users/Karl-WangSK/events{/privacy}","received_events_url":"https://api.github.com/users/Karl-WangSK/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-28T12:55:05Z","updated_at":"2020-11-28T12:55:05Z","author_association":"CONTRIBUTOR","body":"@n3nash  @vinothchandar  hi ,can you pls take a look at this pr?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735227950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735232969","html_url":"https://github.com/apache/hudi/pull/2260#issuecomment-735232969","issue_url":"https://api.github.com/repos/apache/hudi/issues/2260","id":735232969,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTIzMjk2OQ==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-28T13:45:41Z","updated_at":"2020-11-28T13:45:41Z","author_association":"CONTRIBUTOR","body":"@wangxianghu Can you review this PR?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735232969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735362200","html_url":"https://github.com/apache/hudi/pull/1929#issuecomment-735362200","issue_url":"https://api.github.com/repos/apache/hudi/issues/1929","id":735362200,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTM2MjIwMA==","user":{"login":"leesf","id":10128888,"node_id":"MDQ6VXNlcjEwMTI4ODg4","avatar_url":"https://avatars.githubusercontent.com/u/10128888?v=4","gravatar_id":"","url":"https://api.github.com/users/leesf","html_url":"https://github.com/leesf","followers_url":"https://api.github.com/users/leesf/followers","following_url":"https://api.github.com/users/leesf/following{/other_user}","gists_url":"https://api.github.com/users/leesf/gists{/gist_id}","starred_url":"https://api.github.com/users/leesf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leesf/subscriptions","organizations_url":"https://api.github.com/users/leesf/orgs","repos_url":"https://api.github.com/users/leesf/repos","events_url":"https://api.github.com/users/leesf/events{/privacy}","received_events_url":"https://api.github.com/users/leesf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-29T08:46:32Z","updated_at":"2020-11-29T08:46:32Z","author_association":"CONTRIBUTOR","body":"> @leesf are you still pursuing this?\r\n\r\nyes, will update the PR when free","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735362200/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735375388","html_url":"https://github.com/apache/hudi/pull/2286#issuecomment-735375388","issue_url":"https://api.github.com/repos/apache/hudi/issues/2286","id":735375388,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTM3NTM4OA==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-29T11:01:10Z","updated_at":"2020-12-12T03:51:16Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2286?src=pr&el=h1) Report\n> Merging [#2286](https://codecov.io/gh/apache/hudi/pull/2286?src=pr&el=desc) (2576ce6) into [master](https://codecov.io/gh/apache/hudi/commit/236d1b0dec409efb9c7a9febd260b1060da6a9c1?el=desc) (236d1b0) will **decrease** coverage by `41.93%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2286/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2286?src=pr&el=tree)\n\n```diff\n@@              Coverage Diff              @@\n##             master    #2286       +/-   ##\n=============================================\n- Coverage     52.34%   10.40%   -41.94%     \n+ Complexity     2631       48     -2583     \n=============================================\n  Files           329       51      -278     \n  Lines         14808     1787    -13021     \n  Branches       1484      213     -1271     \n=============================================\n- Hits           7751      186     -7565     \n+ Misses         6442     1588     -4854     \n+ Partials        615       13      -602     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `?` | `?` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `?` | `?` | |\n| hudihadoopmr | `?` | `?` | |\n| huditimelineservice | `?` | `?` | |\n| hudiutilities | `10.40% <ø> (-59.71%)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2286?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...va/org/apache/hudi/utilities/IdentitySplitter.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL0lkZW50aXR5U3BsaXR0ZXIuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-2.00%)` | |\n| [...va/org/apache/hudi/utilities/schema/SchemaSet.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFTZXQuamF2YQ==) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-3.00%)` | |\n| [...a/org/apache/hudi/utilities/sources/RowSource.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUm93U291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [.../org/apache/hudi/utilities/sources/AvroSource.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQXZyb1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [.../org/apache/hudi/utilities/sources/JsonSource.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvblNvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-1.00%)` | |\n| [...rg/apache/hudi/utilities/sources/CsvDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvQ3N2REZTU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-10.00%)` | |\n| [...g/apache/hudi/utilities/sources/JsonDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkRGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| [...apache/hudi/utilities/sources/JsonKafkaSource.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvSnNvbkthZmthU291cmNlLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-6.00%)` | |\n| [...pache/hudi/utilities/sources/ParquetDFSSource.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NvdXJjZXMvUGFycXVldERGU1NvdXJjZS5qYXZh) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-5.00%)` | |\n| [...lities/schema/SchemaProviderWithPostProcessor.java](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree#diff-aHVkaS11dGlsaXRpZXMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvdXRpbGl0aWVzL3NjaGVtYS9TY2hlbWFQcm92aWRlcldpdGhQb3N0UHJvY2Vzc29yLmphdmE=) | `0.00% <0.00%> (-100.00%)` | `0.00% <0.00%> (-4.00%)` | |\n| ... and [306 more](https://codecov.io/gh/apache/hudi/pull/2286/diff?src=pr&el=tree-more) | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735375388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735409910","html_url":"https://github.com/apache/hudi/pull/2208#issuecomment-735409910","issue_url":"https://api.github.com/repos/apache/hudi/issues/2208","id":735409910,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTQwOTkxMA==","user":{"login":"giaosudau","id":539238,"node_id":"MDQ6VXNlcjUzOTIzOA==","avatar_url":"https://avatars.githubusercontent.com/u/539238?v=4","gravatar_id":"","url":"https://api.github.com/users/giaosudau","html_url":"https://github.com/giaosudau","followers_url":"https://api.github.com/users/giaosudau/followers","following_url":"https://api.github.com/users/giaosudau/following{/other_user}","gists_url":"https://api.github.com/users/giaosudau/gists{/gist_id}","starred_url":"https://api.github.com/users/giaosudau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giaosudau/subscriptions","organizations_url":"https://api.github.com/users/giaosudau/orgs","repos_url":"https://api.github.com/users/giaosudau/repos","events_url":"https://api.github.com/users/giaosudau/events{/privacy}","received_events_url":"https://api.github.com/users/giaosudau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-29T15:17:36Z","updated_at":"2020-11-29T15:41:58Z","author_association":"CONTRIBUTOR","body":"Hey @vinothchandar \r\nI tried to write a custom transformer using dataset api but got the same error \r\nThis class org.apache.hudi.Spark3RowDeserializer.deserializeRow has issue.\r\n\r\n```\r\nj  org.apache.hudi.HoodieSparkUtils$.$anonfun$createRdd$1(Lorg/apache/hudi/client/utils/SparkRowDeserializer;Lorg/apache/spark/sql/catalyst/InternalRow;)Lorg/apache/spark/sql/Row;+2\r\nj  org.apache.hudi.HoodieSparkUtils$.$anonfun$createRdd$1(Lorg/apache/hudi/client/utils/SparkRowDeserializer;Lorg/apache/spark/sql/catalyst/InternalRow;)Lorg/apache/spark/sql/Row;+2","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735409910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735629366","html_url":"https://github.com/apache/hudi/issues/2265#issuecomment-735629366","issue_url":"https://api.github.com/repos/apache/hudi/issues/2265","id":735629366,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTYyOTM2Ng==","user":{"login":"hughfdjackson","id":545689,"node_id":"MDQ6VXNlcjU0NTY4OQ==","avatar_url":"https://avatars.githubusercontent.com/u/545689?v=4","gravatar_id":"","url":"https://api.github.com/users/hughfdjackson","html_url":"https://github.com/hughfdjackson","followers_url":"https://api.github.com/users/hughfdjackson/followers","following_url":"https://api.github.com/users/hughfdjackson/following{/other_user}","gists_url":"https://api.github.com/users/hughfdjackson/gists{/gist_id}","starred_url":"https://api.github.com/users/hughfdjackson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hughfdjackson/subscriptions","organizations_url":"https://api.github.com/users/hughfdjackson/orgs","repos_url":"https://api.github.com/users/hughfdjackson/repos","events_url":"https://api.github.com/users/hughfdjackson/events{/privacy}","received_events_url":"https://api.github.com/users/hughfdjackson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T08:15:34Z","updated_at":"2020-11-30T08:15:34Z","author_association":"NONE","body":"Hi @vingov, @umehrot2 , @zhedoubushishi  - did you find anything that might shed some light on the above issue?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735629366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735805371","html_url":"https://github.com/apache/hudi/pull/2289#issuecomment-735805371","issue_url":"https://api.github.com/repos/apache/hudi/issues/2289","id":735805371,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTgwNTM3MQ==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T14:04:47Z","updated_at":"2020-11-30T14:05:57Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2289?src=pr&el=h1) Report\n> Merging [#2289](https://codecov.io/gh/apache/hudi/pull/2289?src=pr&el=desc) (d4fb269) into [master](https://codecov.io/gh/apache/hudi/commit/3d5e9fee7f42d45f737e170a1937bdf676df9c60?el=desc) (3d5e9fe) will **increase** coverage by `0.01%`.\n> The diff coverage is `0.00%`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2289/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2289?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2289      +/-   ##\n============================================\n+ Coverage     53.55%   53.57%   +0.01%     \n- Complexity     2773     2774       +1     \n============================================\n  Files           348      348              \n  Lines         16117    16118       +1     \n  Branches       1641     1642       +1     \n============================================\n+ Hits           8632     8635       +3     \n+ Misses         6787     6785       -2     \n  Partials        698      698              \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `38.50% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `55.31% <ø> (+0.03%)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `32.94% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudispark | `65.73% <0.00%> (-0.05%)` | `0.00 <0.00> (ø)` | |\n| huditimelineservice | `65.30% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `70.06% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2289?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...n/scala/org/apache/hudi/HoodieSparkSqlWriter.scala](https://codecov.io/gh/apache/hudi/pull/2289/diff?src=pr&el=tree#diff-aHVkaS1zcGFyay9zcmMvbWFpbi9zY2FsYS9vcmcvYXBhY2hlL2h1ZGkvSG9vZGllU3BhcmtTcWxXcml0ZXIuc2NhbGE=) | `51.31% <0.00%> (-0.20%)` | `0.00 <0.00> (ø)` | |\n| [...ache/hudi/common/fs/inline/InMemoryFileSystem.java](https://codecov.io/gh/apache/hudi/pull/2289/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL2lubGluZS9Jbk1lbW9yeUZpbGVTeXN0ZW0uamF2YQ==) | `89.65% <0.00%> (+10.34%)` | `16.00% <0.00%> (+1.00%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735805371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735921130","html_url":"https://github.com/apache/hudi/issues/2269#issuecomment-735921130","issue_url":"https://api.github.com/repos/apache/hudi/issues/2269","id":735921130,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTkyMTEzMA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T17:14:34Z","updated_at":"2020-11-30T17:14:34Z","author_association":"CONTRIBUTOR","body":"@asharma4-lucid : Sorry for the delay in responding due to Thanksgiving weekend. It looks like cleaning is  the one taking long time. Cleaner (in 0.6) runs in incremental mode by default but it could be that you are touching a lot of partitions.  You need to enable this config once in a while (like every n commits) to delete old versions of the files. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735921130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735927848","html_url":"https://github.com/apache/hudi/issues/2280#issuecomment-735927848","issue_url":"https://api.github.com/repos/apache/hudi/issues/2280","id":735927848,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTkyNzg0OA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T17:26:39Z","updated_at":"2020-11-30T17:26:39Z","author_association":"CONTRIBUTOR","body":"@ygordefraga : This could be coming from the increase in the number of partitions.\r\nThis could be related to https://github.com/apache/hudi/issues/2269#issuecomment-733299492 \r\n\r\nAlso, note that since you increased the number of partition with the additional partitioning level, keeping the same number of executors wont be exactly apples-to-apples comparison.\r\n\r\nCan you try 0.6.0 (which has incremental cleaning support) to see if you get better performance.\r\nPlease note that the next version of hudi will come with consolidated metadata which will remove the listing altogether.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735927848/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735934622","html_url":"https://github.com/apache/hudi/issues/2282#issuecomment-735934622","issue_url":"https://api.github.com/repos/apache/hudi/issues/2282","id":735934622,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTkzNDYyMg==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T17:38:50Z","updated_at":"2020-11-30T17:39:32Z","author_association":"CONTRIBUTOR","body":"It looks like the error is happening during loading the data at hdfs://nameservice/data/wdt/sqoop/cow/inc/stockout_order_20201125/837b6714-40b3-4a00-bcf5-97a6f33d2af7.parquet\r\n\r\nCan you check if hdfs://nameservice/data/wdt/sqoop/cow/inc/stockout_order_20201125/ is a hudi table. Do you see hdfs://nameservice/data/wdt/sqoop/cow/inc/stockout_order_20201125/.hoodie folder ?\r\n\r\nCan you list the entire folder hdfs://nameservice/data/wdt/sqoop/cow/inc/stockout_order_20201125 and attach ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735934622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735937171","html_url":"https://github.com/apache/hudi/issues/2284#issuecomment-735937171","issue_url":"https://api.github.com/repos/apache/hudi/issues/2284","id":735937171,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTkzNzE3MQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T17:43:38Z","updated_at":"2020-11-30T17:43:38Z","author_association":"CONTRIBUTOR","body":"Hudi provides custom merging semantics. You can plugin your own payload implementation that instead of overwriting, can have custom merging logic (HoodieRecordPayload.java). Can you explore that and see if it satisfies your requirement.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735937171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735939031","html_url":"https://github.com/apache/hudi/issues/2288#issuecomment-735939031","issue_url":"https://api.github.com/repos/apache/hudi/issues/2288","id":735939031,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTkzOTAzMQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T17:46:56Z","updated_at":"2020-11-30T17:46:56Z","author_association":"CONTRIBUTOR","body":"Yes, these are metadata files used to track the status of operations and is needed to perform rollbacks if needed. Instead of keeping one file, Hudi tracks them in separate files to avoid using rename() operations which are not guaranteed to be atomic across all kinds of storage layers. \r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735939031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735940873","html_url":"https://github.com/apache/hudi/issues/2290#issuecomment-735940873","issue_url":"https://api.github.com/repos/apache/hudi/issues/2290","id":735940873,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTk0MDg3Mw==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T17:50:18Z","updated_at":"2020-11-30T17:50:18Z","author_association":"CONTRIBUTOR","body":"@nsivabalan : Can you take a look at this ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735940873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735945530","html_url":"https://github.com/apache/hudi/issues/2280#issuecomment-735945530","issue_url":"https://api.github.com/repos/apache/hudi/issues/2280","id":735945530,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTk0NTUzMA==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T17:58:59Z","updated_at":"2020-11-30T17:58:59Z","author_association":"MEMBER","body":"Looks like balaji did beat me to it.  :) ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735945530/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735950933","html_url":"https://github.com/apache/hudi/pull/2216#issuecomment-735950933","issue_url":"https://api.github.com/repos/apache/hudi/issues/2216","id":735950933,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTk1MDkzMw==","user":{"login":"prashantwason","id":58448203,"node_id":"MDQ6VXNlcjU4NDQ4MjAz","avatar_url":"https://avatars.githubusercontent.com/u/58448203?v=4","gravatar_id":"","url":"https://api.github.com/users/prashantwason","html_url":"https://github.com/prashantwason","followers_url":"https://api.github.com/users/prashantwason/followers","following_url":"https://api.github.com/users/prashantwason/following{/other_user}","gists_url":"https://api.github.com/users/prashantwason/gists{/gist_id}","starred_url":"https://api.github.com/users/prashantwason/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prashantwason/subscriptions","organizations_url":"https://api.github.com/users/prashantwason/orgs","repos_url":"https://api.github.com/users/prashantwason/repos","events_url":"https://api.github.com/users/prashantwason/events{/privacy}","received_events_url":"https://api.github.com/users/prashantwason/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T18:09:01Z","updated_at":"2020-11-30T18:09:01Z","author_association":"MEMBER","body":"@vinothchandar I have removed the oldNumWrites field.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735950933/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735989890","html_url":"https://github.com/apache/hudi/pull/2263#issuecomment-735989890","issue_url":"https://api.github.com/repos/apache/hudi/issues/2263","id":735989890,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTk4OTg5MA==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-30T19:22:48Z","updated_at":"2020-11-30T19:22:48Z","author_association":"MEMBER","body":"@n3nash Please take another look.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/735989890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736173244","html_url":"https://github.com/apache/hudi/issues/2290#issuecomment-736173244","issue_url":"https://api.github.com/repos/apache/hudi/issues/2290","id":736173244,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjE3MzI0NA==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T02:21:29Z","updated_at":"2020-12-01T02:21:29Z","author_association":"NONE","body":"@nsivabalan please help take a look,thanks!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736173244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736180816","html_url":"https://github.com/apache/hudi/issues/2290#issuecomment-736180816","issue_url":"https://api.github.com/repos/apache/hudi/issues/2290","id":736180816,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjE4MDgxNg==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T02:45:43Z","updated_at":"2020-12-01T02:45:43Z","author_association":"CONTRIBUTOR","body":"yes, just set the operation type to \"UPSERT\". hudi is capable of differentiating updates and deletes. I guess you are using AWSDmsAvroPayload as payload class. It should work. Let us know if it does not work. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736180816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736181454","html_url":"https://github.com/apache/hudi/issues/2288#issuecomment-736181454","issue_url":"https://api.github.com/repos/apache/hudi/issues/2288","id":736181454,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjE4MTQ1NA==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T02:47:45Z","updated_at":"2020-12-01T02:47:45Z","author_association":"NONE","body":"Thanks @bvaradar  for the good explanation.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736181454/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736192199","html_url":"https://github.com/apache/hudi/issues/2290#issuecomment-736192199","issue_url":"https://api.github.com/repos/apache/hudi/issues/2290","id":736192199,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjE5MjE5OQ==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T03:23:29Z","updated_at":"2020-12-01T03:23:29Z","author_association":"NONE","body":"Thanks @nsivabalan. All I am using is apache open sourced, such as spark, hive, hudi etc. Is open sourced hudi capable of differentiating updates and deletes? If yes, what should I do to tell hudi which is meant upsert and which is delete. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736192199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736206669","html_url":"https://github.com/apache/hudi/pull/2275#issuecomment-736206669","issue_url":"https://api.github.com/repos/apache/hudi/issues/2275","id":736206669,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjIwNjY2OQ==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T04:16:27Z","updated_at":"2020-12-01T04:16:27Z","author_association":"MEMBER","body":"@satishkotha weirdly I still cannot assign this to you. :/ \r\n\r\nCould you help review this? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736206669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736540781","html_url":"https://github.com/apache/hudi/issues/1679#issuecomment-736540781","issue_url":"https://api.github.com/repos/apache/hudi/issues/1679","id":736540781,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjU0MDc4MQ==","user":{"login":"ruztbucket","id":36550295,"node_id":"MDQ6VXNlcjM2NTUwMjk1","avatar_url":"https://avatars.githubusercontent.com/u/36550295?v=4","gravatar_id":"","url":"https://api.github.com/users/ruztbucket","html_url":"https://github.com/ruztbucket","followers_url":"https://api.github.com/users/ruztbucket/followers","following_url":"https://api.github.com/users/ruztbucket/following{/other_user}","gists_url":"https://api.github.com/users/ruztbucket/gists{/gist_id}","starred_url":"https://api.github.com/users/ruztbucket/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ruztbucket/subscriptions","organizations_url":"https://api.github.com/users/ruztbucket/orgs","repos_url":"https://api.github.com/users/ruztbucket/repos","events_url":"https://api.github.com/users/ruztbucket/events{/privacy}","received_events_url":"https://api.github.com/users/ruztbucket/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T13:08:48Z","updated_at":"2020-12-01T13:08:48Z","author_association":"NONE","body":"Hi, i'm facing the same issue when trying to sync to hive with hoodie.datasource.hive_sync.use_jdbc=false.\r\n\r\nThis is the complete stacktrace -\r\n\r\n```\r\n20/12/01 11:47:07 INFO Client: Application report for application_1606814313006_0010 (state: RUNNING)\r\n20/12/01 11:47:08 INFO Client: Application report for application_1606814313006_0010 (state: FINISHED)\r\n20/12/01 11:47:08 INFO Client: \r\n\t client token: N/A\r\n\t diagnostics: User class threw exception: java.lang.NoClassDefFoundError: org/json/JSONException\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeCreateTable(SemanticAnalyzer.java:10847)\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genResolvedParseTree(SemanticAnalyzer.java:10047)\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:10128)\r\n\tat org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:209)\r\n\tat org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:227)\r\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:424)\r\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:308)\r\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1122)\r\n\tat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1170)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1059)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1049)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLs(HoodieHiveClient.java:384)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLUsingHiveDriver(HoodieHiveClient.java:367)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQL(HoodieHiveClient.java:357)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.createTable(HoodieHiveClient.java:262)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncSchema(HiveSyncTool.java:176)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:130)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:94)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.org$apache$hudi$HoodieSparkSqlWriter$$syncHive(HoodieSparkSqlWriter.scala:321)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$$anonfun$metaSync$2.apply(HoodieSparkSqlWriter.scala:363)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$$anonfun$metaSync$2.apply(HoodieSparkSqlWriter.scala:359)\r\n\tat scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.metaSync(HoodieSparkSqlWriter.scala:359)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:417)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:205)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:125)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:173)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:169)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:197)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:194)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:169)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:114)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:112)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:677)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:677)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.org$apache$spark$sql$execution$SQLExecution$$executeQuery$1(SQLExecution.scala:83)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1$$anonfun$apply$1.apply(SQLExecution.scala:94)\r\n\tat org.apache.spark.sql.execution.QueryExecutionMetrics$.withMetrics(QueryExecutionMetrics.scala:141)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.org$apache$spark$sql$execution$SQLExecution$$withMetrics(SQLExecution.scala:178)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:93)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:200)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:92)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:677)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:286)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:272)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:230)\r\n\tat com.amazon.smt.wes.r2.SimpleJob$.main(SimpleJob.scala:54)\r\n\tat com.amazon.smt.wes.r2.SimpleJob.main(SimpleJob.scala)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\r\nCaused by: java.lang.ClassNotFoundException: org.json.JSONException\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:382)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:418)\r\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:351)\r\n\t... 58 more\r\n\r\n\t ApplicationMaster host: ip-10-0-1-32.ec2.internal\r\n\t ApplicationMaster RPC port: 35829\r\n\t queue: default\r\n\t start time: 1606822996408\r\n\t final status: FAILED\r\n\t tracking URL: http://ip-10-0-1-75.ec2.internal:20888/proxy/application_1606814313006_0010/\r\n\t user: hadoop\r\n20/12/01 11:47:08 ERROR Client: Application diagnostics message: User class threw exception: java.lang.NoClassDefFoundError: org/json/JSONException\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeCreateTable(SemanticAnalyzer.java:10847)\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genResolvedParseTree(SemanticAnalyzer.java:10047)\r\n\tat org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:10128)\r\n\tat org.apache.hadoop.hive.ql.parse.CalcitePlanner.analyzeInternal(CalcitePlanner.java:209)\r\n\tat org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:227)\r\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:424)\r\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:308)\r\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1122)\r\n\tat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1170)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1059)\r\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1049)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLs(HoodieHiveClient.java:384)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQLUsingHiveDriver(HoodieHiveClient.java:367)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.updateHiveSQL(HoodieHiveClient.java:357)\r\n\tat org.apache.hudi.hive.HoodieHiveClient.createTable(HoodieHiveClient.java:262)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncSchema(HiveSyncTool.java:176)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:130)\r\n\tat org.apache.hudi.hive.HiveSyncTool.syncHoodieTable(HiveSyncTool.java:94)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.org$apache$hudi$HoodieSparkSqlWriter$$syncHive(HoodieSparkSqlWriter.scala:321)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$$anonfun$metaSync$2.apply(HoodieSparkSqlWriter.scala:363)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$$anonfun$metaSync$2.apply(HoodieSparkSqlWriter.scala:359)\r\n\tat scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.metaSync(HoodieSparkSqlWriter.scala:359)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.commitAndPerformPostOperations(HoodieSparkSqlWriter.scala:417)\r\n\tat org.apache.hudi.HoodieSparkSqlWriter$.write(HoodieSparkSqlWriter.scala:205)\r\n\tat org.apache.hudi.DefaultSource.createRelation(DefaultSource.scala:125)\r\n\tat org.apache.spark.sql.execution.datasources.SaveIntoDataSourceCommand.run(SaveIntoDataSourceCommand.scala:45)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:70)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:68)\r\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:173)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:169)\r\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:197)\r\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\r\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:194)\r\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:169)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:114)\r\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:112)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:677)\r\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:677)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.org$apache$spark$sql$execution$SQLExecution$$executeQuery$1(SQLExecution.scala:83)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1$$anonfun$apply$1.apply(SQLExecution.scala:94)\r\n\tat org.apache.spark.sql.execution.QueryExecutionMetrics$.withMetrics(QueryExecutionMetrics.scala:141)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.org$apache$spark$sql$execution$SQLExecution$$withMetrics(SQLExecution.scala:178)\r\n\tat org.apache.spark.sql.execution.SQLExecution$$anonfun$withNewExecutionId$1.apply(SQLExecution.scala:93)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:200)\r\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:92)\r\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:677)\r\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:286)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:272)\r\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:230)\r\n\tat com.amazon.smt.wes.r2.SimpleJob$.main(SimpleJob.scala:54)\r\n\tat com.amazon.smt.wes.r2.SimpleJob.main(SimpleJob.scala)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:685)\r\nCaused by: java.lang.ClassNotFoundException: org.json.JSONException\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:382)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:418)\r\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352)\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:351)\r\n\t... 58 more\r\n\r\nException in thread \"main\" org.apache.spark.SparkException: Application application_1606814313006_0010 finished with failed status\r\n\tat org.apache.spark.deploy.yarn.Client.run(Client.scala:1149)\r\n\tat org.apache.spark.deploy.yarn.YarnClusterApplication.start(Client.scala:1529)\r\n\tat org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:853)\r\n\tat org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)\r\n\tat org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)\r\n\tat org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)\r\n\tat org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:928)\r\n\tat org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:937)\r\n\tat org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\r\n20/12/01 11:47:08 INFO ShutdownHookManager: Shutdown hook called","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736540781/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736580869","html_url":"https://github.com/apache/hudi/issues/2280#issuecomment-736580869","issue_url":"https://api.github.com/repos/apache/hudi/issues/2280","id":736580869,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjU4MDg2OQ==","user":{"login":"ygordefraga","id":20543207,"node_id":"MDQ6VXNlcjIwNTQzMjA3","avatar_url":"https://avatars.githubusercontent.com/u/20543207?v=4","gravatar_id":"","url":"https://api.github.com/users/ygordefraga","html_url":"https://github.com/ygordefraga","followers_url":"https://api.github.com/users/ygordefraga/followers","following_url":"https://api.github.com/users/ygordefraga/following{/other_user}","gists_url":"https://api.github.com/users/ygordefraga/gists{/gist_id}","starred_url":"https://api.github.com/users/ygordefraga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ygordefraga/subscriptions","organizations_url":"https://api.github.com/users/ygordefraga/orgs","repos_url":"https://api.github.com/users/ygordefraga/repos","events_url":"https://api.github.com/users/ygordefraga/events{/privacy}","received_events_url":"https://api.github.com/users/ygordefraga/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T14:19:49Z","updated_at":"2020-12-01T14:19:49Z","author_association":"NONE","body":"> @ygordefraga : This could be coming from the increase in the number of partitions.\r\n> This could be related to [#2269 (comment)](https://github.com/apache/hudi/issues/2269#issuecomment-733299492)\r\n> \r\n> Also, note that since you increased the number of partition with the additional partitioning level, keeping the same number of executors wont be exactly apples-to-apples comparison.\r\n> \r\n> Can you try 0.6.0 (which has incremental cleaning support) to see if you get better performance.\r\n> Please note that the next version of hudi will come with consolidated metadata which will remove the listing altogether.\r\n\r\nDoes \"hoodie.clean.automatic\" available on hudi 0.5.2? And does clean make sense for COW tables when there is no upsert? (my case)? What cleaning does in this situation?\r\n\r\nI tried Hudi 0.6, but I faced this [issue](https://issues.apache.org/jira/browse/HUDI-1117) and could not solve it. Any suggestion about that?\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736580869/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736665788","html_url":"https://github.com/apache/hudi/pull/2168#issuecomment-736665788","issue_url":"https://api.github.com/repos/apache/hudi/issues/2168","id":736665788,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjY2NTc4OA==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T16:32:00Z","updated_at":"2020-12-01T16:33:31Z","author_association":"CONTRIBUTOR","body":"@n3nash : the patch is good to be reviewed. would appreciate if you can take some time to close this out.\r\n\r\nand a question on DFSHoodieDatasetInputReader. I see when we try to read lesser no of records than total records in one file slice, the reader returns entire contents from one file slice. Is that intentional or is it a bug ? \r\n\r\nFor eg: if I insert 1500 records \r\nand next node is upsert of 200. this will actually update all 1500 records and not 200(assuming all 1500 is in one file slice). \r\n\r\nI ran into this issue while testing out deletes with this patch. I thot there was some issue w/ deletes, since I saw all records were getting deleted ;) and after investigation, found its the reader thats doing this. \r\n\r\n```\r\nif (!numFiles.isPresent() || numFiles.get() == 0) {\r\n      // If num files are not passed, find the number of files to update based on total records to update and records\r\n      // per file\r\n      numFilesToUpdate = (int) Math.ceil((double) numRecordsToUpdate.get() / recordsInSingleFile);\r\n      // recordsInSingleFile is not average so we still need to account for bias is records distribution\r\n      // in the files. Limit to the maximum number of files available.\r\n      int totalExistingFilesCount = partitionToFileIdCountMap.values().stream().reduce((a, b) -> a + b).get();\r\n      numFilesToUpdate = Math.min(numFilesToUpdate, totalExistingFilesCount);\r\n      log.warn(\"aaa Files to update {}, numRecords toUpdate {}, records in Single file {} \", numFilesToUpdate, numRecordsToUpdate, recordsInSingleFile);\r\n      numRecordsToUpdatePerFile = recordsInSingleFile;\r\n    }\r\n```","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736665788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736666780","html_url":"https://github.com/apache/hudi/issues/2280#issuecomment-736666780","issue_url":"https://api.github.com/repos/apache/hudi/issues/2280","id":736666780,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjY2Njc4MA==","user":{"login":"ygordefraga","id":20543207,"node_id":"MDQ6VXNlcjIwNTQzMjA3","avatar_url":"https://avatars.githubusercontent.com/u/20543207?v=4","gravatar_id":"","url":"https://api.github.com/users/ygordefraga","html_url":"https://github.com/ygordefraga","followers_url":"https://api.github.com/users/ygordefraga/followers","following_url":"https://api.github.com/users/ygordefraga/following{/other_user}","gists_url":"https://api.github.com/users/ygordefraga/gists{/gist_id}","starred_url":"https://api.github.com/users/ygordefraga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ygordefraga/subscriptions","organizations_url":"https://api.github.com/users/ygordefraga/orgs","repos_url":"https://api.github.com/users/ygordefraga/repos","events_url":"https://api.github.com/users/ygordefraga/events{/privacy}","received_events_url":"https://api.github.com/users/ygordefraga/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T16:33:32Z","updated_at":"2020-12-01T16:33:32Z","author_association":"NONE","body":"> Please note that the next version of hudi will come with consolidated metadata which will remove the listing altogether.\r\n\r\nWhat do you mean with that?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736666780/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736673567","html_url":"https://github.com/apache/hudi/issues/2290#issuecomment-736673567","issue_url":"https://api.github.com/repos/apache/hudi/issues/2290","id":736673567,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjY3MzU2Nw==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T16:44:48Z","updated_at":"2020-12-01T16:48:22Z","author_association":"CONTRIBUTOR","body":"@bithw1 : thats the beauty. you don't need to tell explicitly. If you are using AWSDmsAvroPayload as payload class(\"hoodie.datasource.write.payload.class\"), then value of \"Op\" field will be used to differentiate inserts, updates and deletes. you can check out [this](https://cwiki.apache.org/confluence/display/HUDI/2020/01/15/Delete+support+in+Hudi) blog for details on diff ways to issue deletes with hudi. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736673567/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736689026","html_url":"https://github.com/apache/hudi/pull/2206#issuecomment-736689026","issue_url":"https://api.github.com/repos/apache/hudi/issues/2206","id":736689026,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjY4OTAyNg==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T17:07:35Z","updated_at":"2020-12-01T17:07:35Z","author_association":"CONTRIBUTOR","body":"@bvaradar @vinothchandar : patch is ready for review","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736689026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736697195","html_url":"https://github.com/apache/hudi/issues/2276#issuecomment-736697195","issue_url":"https://api.github.com/repos/apache/hudi/issues/2276","id":736697195,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjY5NzE5NQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T17:20:03Z","updated_at":"2020-12-01T17:20:03Z","author_association":"CONTRIBUTOR","body":"@bithw1 : Were you able to resolve this ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736697195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736709407","html_url":"https://github.com/apache/hudi/issues/2284#issuecomment-736709407","issue_url":"https://api.github.com/repos/apache/hudi/issues/2284","id":736709407,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjcwOTQwNw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T17:40:04Z","updated_at":"2020-12-01T17:40:04Z","author_association":"MEMBER","body":">But it seems Hudi doesn't provide SCD2 functionality yet.\r\n\r\n@sanket-khedikar Hudi does let you control retention of older versions of files using the cleaner configuration.\r\nhttps://hudi.apache.org/docs/configurations.html#retainCommits ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736709407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736750785","html_url":"https://github.com/apache/hudi/issues/2280#issuecomment-736750785","issue_url":"https://api.github.com/repos/apache/hudi/issues/2280","id":736750785,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjc1MDc4NQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T18:55:42Z","updated_at":"2020-12-01T18:55:42Z","author_association":"CONTRIBUTOR","body":"> > Please note that the next version of hudi will come with consolidated metadata which will remove the listing altogether.\r\n> \r\n> What do you mean with that?\r\n\r\nThe File listing improvements as mentioned in https://cwiki.apache.org/confluence/display/HUDI/RFC+-+15%3A+HUDI+File+Listing+and+Query+Planning+Improvements will be available in 0.7 release.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736750785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736752118","html_url":"https://github.com/apache/hudi/issues/2280#issuecomment-736752118","issue_url":"https://api.github.com/repos/apache/hudi/issues/2280","id":736752118,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjc1MjExOA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T18:58:06Z","updated_at":"2020-12-01T18:58:06Z","author_association":"CONTRIBUTOR","body":"Regarding the bundle issue, the workaround posted should have worked. Another option is to try 0.5.3 which has the support too. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736752118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736754961","html_url":"https://github.com/apache/hudi/issues/2285#issuecomment-736754961","issue_url":"https://api.github.com/repos/apache/hudi/issues/2285","id":736754961,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjc1NDk2MQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T19:03:00Z","updated_at":"2020-12-01T19:03:00Z","author_association":"CONTRIBUTOR","body":"Wondering if parquet version has anything to do here. Can you check if the hadoop installation has 1.10.1 parquet bundles ? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736754961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736806224","html_url":"https://github.com/apache/hudi/issues/2280#issuecomment-736806224","issue_url":"https://api.github.com/repos/apache/hudi/issues/2280","id":736806224,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjgwNjIyNA==","user":{"login":"ygordefraga","id":20543207,"node_id":"MDQ6VXNlcjIwNTQzMjA3","avatar_url":"https://avatars.githubusercontent.com/u/20543207?v=4","gravatar_id":"","url":"https://api.github.com/users/ygordefraga","html_url":"https://github.com/ygordefraga","followers_url":"https://api.github.com/users/ygordefraga/followers","following_url":"https://api.github.com/users/ygordefraga/following{/other_user}","gists_url":"https://api.github.com/users/ygordefraga/gists{/gist_id}","starred_url":"https://api.github.com/users/ygordefraga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ygordefraga/subscriptions","organizations_url":"https://api.github.com/users/ygordefraga/orgs","repos_url":"https://api.github.com/users/ygordefraga/repos","events_url":"https://api.github.com/users/ygordefraga/events{/privacy}","received_events_url":"https://api.github.com/users/ygordefraga/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T20:39:44Z","updated_at":"2020-12-01T20:39:44Z","author_association":"NONE","body":"> Regarding the bundle issue, the workaround posted should have worked. Another option is to try 0.5.3 which has the support too.\r\n\r\nI'll try it again.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736806224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736807941","html_url":"https://github.com/apache/hudi/issues/2280#issuecomment-736807941","issue_url":"https://api.github.com/repos/apache/hudi/issues/2280","id":736807941,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjgwNzk0MQ==","user":{"login":"ygordefraga","id":20543207,"node_id":"MDQ6VXNlcjIwNTQzMjA3","avatar_url":"https://avatars.githubusercontent.com/u/20543207?v=4","gravatar_id":"","url":"https://api.github.com/users/ygordefraga","html_url":"https://github.com/ygordefraga","followers_url":"https://api.github.com/users/ygordefraga/followers","following_url":"https://api.github.com/users/ygordefraga/following{/other_user}","gists_url":"https://api.github.com/users/ygordefraga/gists{/gist_id}","starred_url":"https://api.github.com/users/ygordefraga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ygordefraga/subscriptions","organizations_url":"https://api.github.com/users/ygordefraga/orgs","repos_url":"https://api.github.com/users/ygordefraga/repos","events_url":"https://api.github.com/users/ygordefraga/events{/privacy}","received_events_url":"https://api.github.com/users/ygordefraga/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T20:42:58Z","updated_at":"2020-12-01T20:42:58Z","author_association":"NONE","body":"Writing got better after setting the `hoodie.clean.automatic=false` . I'll try hudi 0.6 (or 0.5.3), compare and post it here.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736807941/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736838816","html_url":"https://github.com/apache/hudi/pull/2208#issuecomment-736838816","issue_url":"https://api.github.com/repos/apache/hudi/issues/2208","id":736838816,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjgzODgxNg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T21:42:34Z","updated_at":"2020-12-01T21:42:34Z","author_association":"MEMBER","body":"@zhedoubushishi let me take a pass at this again. thanks for updating. \r\n\r\n@giaosudau Need to reproduce this myself to comment further. Does the crash happen deterministically when you try to write? @zhedoubushishi any thoughts? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736838816/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736849418","html_url":"https://github.com/apache/hudi/issues/2123#issuecomment-736849418","issue_url":"https://api.github.com/repos/apache/hudi/issues/2123","id":736849418,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjg0OTQxOA==","user":{"login":"kimberlyamandalu","id":25435575,"node_id":"MDQ6VXNlcjI1NDM1NTc1","avatar_url":"https://avatars.githubusercontent.com/u/25435575?v=4","gravatar_id":"","url":"https://api.github.com/users/kimberlyamandalu","html_url":"https://github.com/kimberlyamandalu","followers_url":"https://api.github.com/users/kimberlyamandalu/followers","following_url":"https://api.github.com/users/kimberlyamandalu/following{/other_user}","gists_url":"https://api.github.com/users/kimberlyamandalu/gists{/gist_id}","starred_url":"https://api.github.com/users/kimberlyamandalu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimberlyamandalu/subscriptions","organizations_url":"https://api.github.com/users/kimberlyamandalu/orgs","repos_url":"https://api.github.com/users/kimberlyamandalu/repos","events_url":"https://api.github.com/users/kimberlyamandalu/events{/privacy}","received_events_url":"https://api.github.com/users/kimberlyamandalu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T22:04:45Z","updated_at":"2020-12-01T22:04:45Z","author_association":"NONE","body":"Hello,\r\nI am also encountering this issue when querying Hudi dataset with Athena.\r\nIs there anythingI can do to get it to show correctly? Sorry if the question is a repeat but the workaround is not very clear to me.\r\n\r\nThanks.\r\n\r\nKim","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736849418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736866170","html_url":"https://github.com/apache/hudi/issues/2123#issuecomment-736866170","issue_url":"https://api.github.com/repos/apache/hudi/issues/2123","id":736866170,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjg2NjE3MA==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-01T22:41:18Z","updated_at":"2020-12-01T22:41:38Z","author_association":"MEMBER","body":"@kimberlyamandalu This requires a change in Athena service. You can contact their support to apply patch similar to [presto](https://github.com/prestodb/presto/pull/15074/files)","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736866170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736919832","html_url":"https://github.com/apache/hudi/issues/2276#issuecomment-736919832","issue_url":"https://api.github.com/repos/apache/hudi/issues/2276","id":736919832,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjkxOTgzMg==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T01:05:42Z","updated_at":"2020-12-02T01:05:42Z","author_association":"NONE","body":"Thanks @bvaradar. I think I could resolve this. I need \r\n1.  schedule the compaction\r\n2.  run the compaction\r\n\r\nIt looks to me that only using `hudi-cli` could do this experiment. I really want to write code to excerise schedule and run compaction, but I haven't figured out how to write the code.\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736919832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736932283","html_url":"https://github.com/apache/hudi/issues/2123#issuecomment-736932283","issue_url":"https://api.github.com/repos/apache/hudi/issues/2123","id":736932283,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjkzMjI4Mw==","user":{"login":"kimberlyamandalu","id":25435575,"node_id":"MDQ6VXNlcjI1NDM1NTc1","avatar_url":"https://avatars.githubusercontent.com/u/25435575?v=4","gravatar_id":"","url":"https://api.github.com/users/kimberlyamandalu","html_url":"https://github.com/kimberlyamandalu","followers_url":"https://api.github.com/users/kimberlyamandalu/followers","following_url":"https://api.github.com/users/kimberlyamandalu/following{/other_user}","gists_url":"https://api.github.com/users/kimberlyamandalu/gists{/gist_id}","starred_url":"https://api.github.com/users/kimberlyamandalu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimberlyamandalu/subscriptions","organizations_url":"https://api.github.com/users/kimberlyamandalu/orgs","repos_url":"https://api.github.com/users/kimberlyamandalu/repos","events_url":"https://api.github.com/users/kimberlyamandalu/events{/privacy}","received_events_url":"https://api.github.com/users/kimberlyamandalu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T01:44:45Z","updated_at":"2020-12-02T01:44:45Z","author_association":"NONE","body":"@satishkotha Thanks for your response. I understand. And just to confirm, the Presto version in Athena is 0.217.\r\nWhich version is the fix in? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736932283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736959346","html_url":"https://github.com/apache/hudi/pull/2286#issuecomment-736959346","issue_url":"https://api.github.com/repos/apache/hudi/issues/2286","id":736959346,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjk1OTM0Ng==","user":{"login":"garyli1019","id":23007841,"node_id":"MDQ6VXNlcjIzMDA3ODQx","avatar_url":"https://avatars.githubusercontent.com/u/23007841?v=4","gravatar_id":"","url":"https://api.github.com/users/garyli1019","html_url":"https://github.com/garyli1019","followers_url":"https://api.github.com/users/garyli1019/followers","following_url":"https://api.github.com/users/garyli1019/following{/other_user}","gists_url":"https://api.github.com/users/garyli1019/gists{/gist_id}","starred_url":"https://api.github.com/users/garyli1019/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garyli1019/subscriptions","organizations_url":"https://api.github.com/users/garyli1019/orgs","repos_url":"https://api.github.com/users/garyli1019/repos","events_url":"https://api.github.com/users/garyli1019/events{/privacy}","received_events_url":"https://api.github.com/users/garyli1019/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T03:09:23Z","updated_at":"2020-12-02T03:09:23Z","author_association":"MEMBER","body":"Hi @wangxianghu , if you have time, would you please review this PR as well? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736959346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736959967","html_url":"https://github.com/apache/hudi/pull/2286#issuecomment-736959967","issue_url":"https://api.github.com/repos/apache/hudi/issues/2286","id":736959967,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjk1OTk2Nw==","user":{"login":"wangxianghu","id":49835526,"node_id":"MDQ6VXNlcjQ5ODM1NTI2","avatar_url":"https://avatars.githubusercontent.com/u/49835526?v=4","gravatar_id":"","url":"https://api.github.com/users/wangxianghu","html_url":"https://github.com/wangxianghu","followers_url":"https://api.github.com/users/wangxianghu/followers","following_url":"https://api.github.com/users/wangxianghu/following{/other_user}","gists_url":"https://api.github.com/users/wangxianghu/gists{/gist_id}","starred_url":"https://api.github.com/users/wangxianghu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangxianghu/subscriptions","organizations_url":"https://api.github.com/users/wangxianghu/orgs","repos_url":"https://api.github.com/users/wangxianghu/repos","events_url":"https://api.github.com/users/wangxianghu/events{/privacy}","received_events_url":"https://api.github.com/users/wangxianghu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T03:11:27Z","updated_at":"2020-12-02T03:12:18Z","author_association":"CONTRIBUTOR","body":"> Hi @wangxianghu , if you have time, would you please review this PR as well?\r\nSure, will review this weekend, kind of busy these days","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736959967/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736969008","html_url":"https://github.com/apache/hudi/pull/2208#issuecomment-736969008","issue_url":"https://api.github.com/repos/apache/hudi/issues/2208","id":736969008,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjk2OTAwOA==","user":{"login":"giaosudau","id":539238,"node_id":"MDQ6VXNlcjUzOTIzOA==","avatar_url":"https://avatars.githubusercontent.com/u/539238?v=4","gravatar_id":"","url":"https://api.github.com/users/giaosudau","html_url":"https://github.com/giaosudau","followers_url":"https://api.github.com/users/giaosudau/followers","following_url":"https://api.github.com/users/giaosudau/following{/other_user}","gists_url":"https://api.github.com/users/giaosudau/gists{/gist_id}","starred_url":"https://api.github.com/users/giaosudau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giaosudau/subscriptions","organizations_url":"https://api.github.com/users/giaosudau/orgs","repos_url":"https://api.github.com/users/giaosudau/repos","events_url":"https://api.github.com/users/giaosudau/events{/privacy}","received_events_url":"https://api.github.com/users/giaosudau/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T03:38:22Z","updated_at":"2020-12-02T03:38:22Z","author_association":"CONTRIBUTOR","body":"> @zhedoubushishi let me take a pass at this again. thanks for updating.\r\n> \r\n> @giaosudau Need to reproduce this myself to comment further. Does the crash happen deterministically when you try to write? @zhedoubushishi any thoughts?\r\n\r\nSorry for noise - it due to decode of Debezium Schema.\r\nI need to customize it instead of using Schema Registry.\r\nAfter I customized it it is working fine. \r\nI removed my comment. Please go head for other issues.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736969008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736972492","html_url":"https://github.com/apache/hudi/pull/2188#issuecomment-736972492","issue_url":"https://api.github.com/repos/apache/hudi/issues/2188","id":736972492,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjk3MjQ5Mg==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T03:51:30Z","updated_at":"2020-12-02T03:51:30Z","author_association":"MEMBER","body":"@n3nash @v3nkatesh could you please review this again? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736972492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736996338","html_url":"https://github.com/apache/hudi/issues/2251#issuecomment-736996338","issue_url":"https://api.github.com/repos/apache/hudi/issues/2251","id":736996338,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjk5NjMzOA==","user":{"login":"BalaMahesh","id":25053668,"node_id":"MDQ6VXNlcjI1MDUzNjY4","avatar_url":"https://avatars.githubusercontent.com/u/25053668?v=4","gravatar_id":"","url":"https://api.github.com/users/BalaMahesh","html_url":"https://github.com/BalaMahesh","followers_url":"https://api.github.com/users/BalaMahesh/followers","following_url":"https://api.github.com/users/BalaMahesh/following{/other_user}","gists_url":"https://api.github.com/users/BalaMahesh/gists{/gist_id}","starred_url":"https://api.github.com/users/BalaMahesh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BalaMahesh/subscriptions","organizations_url":"https://api.github.com/users/BalaMahesh/orgs","repos_url":"https://api.github.com/users/BalaMahesh/repos","events_url":"https://api.github.com/users/BalaMahesh/events{/privacy}","received_events_url":"https://api.github.com/users/BalaMahesh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T05:16:51Z","updated_at":"2020-12-02T05:16:51Z","author_association":"NONE","body":"As I mentioned in the update 1, describe formatted tbl_name partition (dt='') is showing the path upto partition directory not base files. But Interestingly the queries are running from beeline without any issue and failing from hive cli in the same installation and cluster.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736996338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736998571","html_url":"https://github.com/apache/hudi/issues/2269#issuecomment-736998571","issue_url":"https://api.github.com/repos/apache/hudi/issues/2269","id":736998571,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjk5ODU3MQ==","user":{"login":"asharma4-lucid","id":64492084,"node_id":"MDQ6VXNlcjY0NDkyMDg0","avatar_url":"https://avatars.githubusercontent.com/u/64492084?v=4","gravatar_id":"","url":"https://api.github.com/users/asharma4-lucid","html_url":"https://github.com/asharma4-lucid","followers_url":"https://api.github.com/users/asharma4-lucid/followers","following_url":"https://api.github.com/users/asharma4-lucid/following{/other_user}","gists_url":"https://api.github.com/users/asharma4-lucid/gists{/gist_id}","starred_url":"https://api.github.com/users/asharma4-lucid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asharma4-lucid/subscriptions","organizations_url":"https://api.github.com/users/asharma4-lucid/orgs","repos_url":"https://api.github.com/users/asharma4-lucid/repos","events_url":"https://api.github.com/users/asharma4-lucid/events{/privacy}","received_events_url":"https://api.github.com/users/asharma4-lucid/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T05:23:43Z","updated_at":"2020-12-02T05:23:43Z","author_association":"NONE","body":"Thanks @bvaradar. Would you know when 0.7.0 is slated for release as the S3 listing time will continue to grow for us as we add more partitions even with cleaning turned off? Also, since we are using a COW table and mostly inserts, would new versions of files still be created and hence would old versions be required to be cleaned up?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/736998571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737056877","html_url":"https://github.com/apache/hudi/issues/2258#issuecomment-737056877","issue_url":"https://api.github.com/repos/apache/hudi/issues/2258","id":737056877,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzA1Njg3Nw==","user":{"login":"bhasudha","id":2179254,"node_id":"MDQ6VXNlcjIxNzkyNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/2179254?v=4","gravatar_id":"","url":"https://api.github.com/users/bhasudha","html_url":"https://github.com/bhasudha","followers_url":"https://api.github.com/users/bhasudha/followers","following_url":"https://api.github.com/users/bhasudha/following{/other_user}","gists_url":"https://api.github.com/users/bhasudha/gists{/gist_id}","starred_url":"https://api.github.com/users/bhasudha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhasudha/subscriptions","organizations_url":"https://api.github.com/users/bhasudha/orgs","repos_url":"https://api.github.com/users/bhasudha/repos","events_url":"https://api.github.com/users/bhasudha/events{/privacy}","received_events_url":"https://api.github.com/users/bhasudha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T07:48:47Z","updated_at":"2020-12-02T07:48:47Z","author_association":"CONTRIBUTOR","body":"@bhushanamk  Are you able to select other fields except the decimal ones? @bvaradar  I believe this is to do with decimal type support.  Need to dig further.\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737056877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737066216","html_url":"https://github.com/apache/hudi/pull/2292#issuecomment-737066216","issue_url":"https://api.github.com/repos/apache/hudi/issues/2292","id":737066216,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzA2NjIxNg==","user":{"login":"codecov-io","id":8655789,"node_id":"MDQ6VXNlcjg2NTU3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/8655789?v=4","gravatar_id":"","url":"https://api.github.com/users/codecov-io","html_url":"https://github.com/codecov-io","followers_url":"https://api.github.com/users/codecov-io/followers","following_url":"https://api.github.com/users/codecov-io/following{/other_user}","gists_url":"https://api.github.com/users/codecov-io/gists{/gist_id}","starred_url":"https://api.github.com/users/codecov-io/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codecov-io/subscriptions","organizations_url":"https://api.github.com/users/codecov-io/orgs","repos_url":"https://api.github.com/users/codecov-io/repos","events_url":"https://api.github.com/users/codecov-io/events{/privacy}","received_events_url":"https://api.github.com/users/codecov-io/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T08:10:01Z","updated_at":"2020-12-13T04:48:57Z","author_association":"NONE","body":"# [Codecov](https://codecov.io/gh/apache/hudi/pull/2292?src=pr&el=h1) Report\n> Merging [#2292](https://codecov.io/gh/apache/hudi/pull/2292?src=pr&el=desc) (33a7383) into [master](https://codecov.io/gh/apache/hudi/commit/236d1b0dec409efb9c7a9febd260b1060da6a9c1?el=desc) (236d1b0) will **increase** coverage by `0.04%`.\n> The diff coverage is `n/a`.\n\n[![Impacted file tree graph](https://codecov.io/gh/apache/hudi/pull/2292/graphs/tree.svg?width=650&height=150&src=pr&token=VTTXabwbs2)](https://codecov.io/gh/apache/hudi/pull/2292?src=pr&el=tree)\n\n```diff\n@@             Coverage Diff              @@\n##             master    #2292      +/-   ##\n============================================\n+ Coverage     52.34%   52.38%   +0.04%     \n- Complexity     2631     2632       +1     \n============================================\n  Files           329      329              \n  Lines         14808    14808              \n  Branches       1484     1484              \n============================================\n+ Hits           7751     7757       +6     \n+ Misses         6442     6437       -5     \n+ Partials        615      614       -1     \n```\n\n| Flag | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| hudicli | `38.83% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiclient | `100.00% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudicommon | `55.12% <ø> (+0.06%)` | `0.00 <ø> (ø)` | |\n| hudihadoopmr | `33.29% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| huditimelineservice | `65.30% <ø> (ø)` | `0.00 <ø> (ø)` | |\n| hudiutilities | `70.11% <ø> (ø)` | `0.00 <ø> (ø)` | |\n\nFlags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags#carryforward-flags-in-the-pull-request-comment) to find out more.\n\n| [Impacted Files](https://codecov.io/gh/apache/hudi/pull/2292?src=pr&el=tree) | Coverage Δ | Complexity Δ | |\n|---|---|---|---|\n| [...e/hudi/common/table/log/HoodieLogFormatWriter.java](https://codecov.io/gh/apache/hudi/pull/2292/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL3RhYmxlL2xvZy9Ib29kaWVMb2dGb3JtYXRXcml0ZXIuamF2YQ==) | `78.81% <0.00%> (+2.54%)` | `23.00% <0.00%> (ø%)` | |\n| [...ache/hudi/common/fs/inline/InMemoryFileSystem.java](https://codecov.io/gh/apache/hudi/pull/2292/diff?src=pr&el=tree#diff-aHVkaS1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2h1ZGkvY29tbW9uL2ZzL2lubGluZS9Jbk1lbW9yeUZpbGVTeXN0ZW0uamF2YQ==) | `89.65% <0.00%> (+10.34%)` | `16.00% <0.00%> (+1.00%)` | |\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737066216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737136631","html_url":"https://github.com/apache/hudi/issues/2277#issuecomment-737136631","issue_url":"https://api.github.com/repos/apache/hudi/issues/2277","id":737136631,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzEzNjYzMQ==","user":{"login":"umehrot2","id":8647012,"node_id":"MDQ6VXNlcjg2NDcwMTI=","avatar_url":"https://avatars.githubusercontent.com/u/8647012?v=4","gravatar_id":"","url":"https://api.github.com/users/umehrot2","html_url":"https://github.com/umehrot2","followers_url":"https://api.github.com/users/umehrot2/followers","following_url":"https://api.github.com/users/umehrot2/following{/other_user}","gists_url":"https://api.github.com/users/umehrot2/gists{/gist_id}","starred_url":"https://api.github.com/users/umehrot2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umehrot2/subscriptions","organizations_url":"https://api.github.com/users/umehrot2/orgs","repos_url":"https://api.github.com/users/umehrot2/repos","events_url":"https://api.github.com/users/umehrot2/events{/privacy}","received_events_url":"https://api.github.com/users/umehrot2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T10:22:44Z","updated_at":"2020-12-02T10:22:44Z","author_association":"CONTRIBUTOR","body":"This seems like you are not able to do a basic upsert. I doubt it has anything to do with the fact that you are using glue. Each record is uniquely recognized by **record key + partition key**. You may want to debug, by printing out the particular row you receive when you do:\r\n```\r\nupdateDF = hudiDF.limit(1).withColumn('sequence', lit('new_value')).withColumn('upd_ind', lit(1))\r\n```\r\n\r\nOR\r\n\r\n```\r\nupdateDF = hudiDF.filter(col('ID_key')==64777).withColumn('sequence', lit('new_value')).withColumn('upd_ind', lit(1))\r\n```\r\n\r\nJust verify once that it indeed does have the record key, partition key and pre-combine column in it. That particular record should get updated. I don't particularly see anything wrong that stands out based on your description.\r\n\r\nWhich version of Hudi are you using ?\r\n\r\nA couple of things that stand out:\r\n- You are using `org.apache.hudi.keygen.ComplexKeyGenerator` which just by looking at your example doesn't seem like you need because you have only one column for record key and one columns for partition key. So you may want to skip it and let it use `SimpleKeyGenerator` which is the default.\r\n- Another thing to give a shot may be that once you have the `updateDF` drop the hoodie metadata columns from it i.e. that columns that begin with name `_hoodie`. I have sometimes noticed weird issues happening if the update data frame has metadata columns in it. Most likely this may not be the issue in your case, but I would like to rule it out before we proceed.\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737136631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737163257","html_url":"https://github.com/apache/hudi/issues/2258#issuecomment-737163257","issue_url":"https://api.github.com/repos/apache/hudi/issues/2258","id":737163257,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzE2MzI1Nw==","user":{"login":"bhushanamk","id":73978482,"node_id":"MDQ6VXNlcjczOTc4NDgy","avatar_url":"https://avatars.githubusercontent.com/u/73978482?v=4","gravatar_id":"","url":"https://api.github.com/users/bhushanamk","html_url":"https://github.com/bhushanamk","followers_url":"https://api.github.com/users/bhushanamk/followers","following_url":"https://api.github.com/users/bhushanamk/following{/other_user}","gists_url":"https://api.github.com/users/bhushanamk/gists{/gist_id}","starred_url":"https://api.github.com/users/bhushanamk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhushanamk/subscriptions","organizations_url":"https://api.github.com/users/bhushanamk/orgs","repos_url":"https://api.github.com/users/bhushanamk/repos","events_url":"https://api.github.com/users/bhushanamk/events{/privacy}","received_events_url":"https://api.github.com/users/bhushanamk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T11:12:05Z","updated_at":"2020-12-02T11:12:05Z","author_association":"NONE","body":"I switched to new cluster and  I am able to query the data now Thanks @bhasudha ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737163257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737319592","html_url":"https://github.com/apache/hudi/pull/2196#issuecomment-737319592","issue_url":"https://api.github.com/repos/apache/hudi/issues/2196","id":737319592,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzMxOTU5Mg==","user":{"login":"lw309637554","id":8501994,"node_id":"MDQ6VXNlcjg1MDE5OTQ=","avatar_url":"https://avatars.githubusercontent.com/u/8501994?v=4","gravatar_id":"","url":"https://api.github.com/users/lw309637554","html_url":"https://github.com/lw309637554","followers_url":"https://api.github.com/users/lw309637554/followers","following_url":"https://api.github.com/users/lw309637554/following{/other_user}","gists_url":"https://api.github.com/users/lw309637554/gists{/gist_id}","starred_url":"https://api.github.com/users/lw309637554/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lw309637554/subscriptions","organizations_url":"https://api.github.com/users/lw309637554/orgs","repos_url":"https://api.github.com/users/lw309637554/repos","events_url":"https://api.github.com/users/lw309637554/events{/privacy}","received_events_url":"https://api.github.com/users/lw309637554/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T15:53:58Z","updated_at":"2020-12-02T15:53:58Z","author_association":"CONTRIBUTOR","body":"@satishkotha   have resolved comment of n3nash, and squash the commits. can you help to merged ? cc @n3nash ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737319592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737415489","html_url":"https://github.com/apache/hudi/issues/2269#issuecomment-737415489","issue_url":"https://api.github.com/repos/apache/hudi/issues/2269","id":737415489,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzQxNTQ4OQ==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T18:33:34Z","updated_at":"2020-12-02T18:33:34Z","author_association":"CONTRIBUTOR","body":"There is an email thread around 0.7.0 release in users@ mailing list. It is expected to be by end of this month. \r\n\r\nRegarding inserts, Hudi takes care of automatically growing small files which indeed creates multiple versions of the files : https://cwiki.apache.org/confluence/display/HUDI/FAQ#FAQ-HowdoItoavoidcreatingtonsofsmallfiles\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737415489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737416280","html_url":"https://github.com/apache/hudi/issues/2251#issuecomment-737416280","issue_url":"https://api.github.com/repos/apache/hudi/issues/2251","id":737416280,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzQxNjI4MA==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T18:35:04Z","updated_at":"2020-12-02T18:35:04Z","author_association":"CONTRIBUTOR","body":"Can you enable debug logs in hive cli and post the logs here ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737416280/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737427777","html_url":"https://github.com/apache/hudi/pull/2208#issuecomment-737427777","issue_url":"https://api.github.com/repos/apache/hudi/issues/2208","id":737427777,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzQyNzc3Nw==","user":{"login":"vinothchandar","id":1179324,"node_id":"MDQ6VXNlcjExNzkzMjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1179324?v=4","gravatar_id":"","url":"https://api.github.com/users/vinothchandar","html_url":"https://github.com/vinothchandar","followers_url":"https://api.github.com/users/vinothchandar/followers","following_url":"https://api.github.com/users/vinothchandar/following{/other_user}","gists_url":"https://api.github.com/users/vinothchandar/gists{/gist_id}","starred_url":"https://api.github.com/users/vinothchandar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vinothchandar/subscriptions","organizations_url":"https://api.github.com/users/vinothchandar/orgs","repos_url":"https://api.github.com/users/vinothchandar/repos","events_url":"https://api.github.com/users/vinothchandar/events{/privacy}","received_events_url":"https://api.github.com/users/vinothchandar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-02T18:54:29Z","updated_at":"2020-12-02T18:54:29Z","author_association":"MEMBER","body":"@giaosudau No problem at all.  Glad it got resolved\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737427777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737602824","html_url":"https://github.com/apache/hudi/issues/2290#issuecomment-737602824","issue_url":"https://api.github.com/repos/apache/hudi/issues/2290","id":737602824,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzYwMjgyNA==","user":{"login":"bithw1","id":24691083,"node_id":"MDQ6VXNlcjI0NjkxMDgz","avatar_url":"https://avatars.githubusercontent.com/u/24691083?v=4","gravatar_id":"","url":"https://api.github.com/users/bithw1","html_url":"https://github.com/bithw1","followers_url":"https://api.github.com/users/bithw1/followers","following_url":"https://api.github.com/users/bithw1/following{/other_user}","gists_url":"https://api.github.com/users/bithw1/gists{/gist_id}","starred_url":"https://api.github.com/users/bithw1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bithw1/subscriptions","organizations_url":"https://api.github.com/users/bithw1/orgs","repos_url":"https://api.github.com/users/bithw1/repos","events_url":"https://api.github.com/users/bithw1/events{/privacy}","received_events_url":"https://api.github.com/users/bithw1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-03T01:39:17Z","updated_at":"2020-12-03T01:39:17Z","author_association":"NONE","body":"Thanks @nsivabalan, I tried it and it works well with U/I/D, thanks!\r\n\r\nAlso, in my experiment,If I specify the `Op` as empty strring(\"\") ,then if the record key has already existed, it will do update, and if the record key doesn't exit, then it will do insert, which is very good behavior. @nsivabalan I would ask if this behavior works as designed for the empty Op field.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737602824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737794951","html_url":"https://github.com/apache/hudi/issues/1971#issuecomment-737794951","issue_url":"https://api.github.com/repos/apache/hudi/issues/1971","id":737794951,"node_id":"MDEyOklzc3VlQ29tbWVudDczNzc5NDk1MQ==","user":{"login":"jingweiz2017","id":26279097,"node_id":"MDQ6VXNlcjI2Mjc5MDk3","avatar_url":"https://avatars.githubusercontent.com/u/26279097?v=4","gravatar_id":"","url":"https://api.github.com/users/jingweiz2017","html_url":"https://github.com/jingweiz2017","followers_url":"https://api.github.com/users/jingweiz2017/followers","following_url":"https://api.github.com/users/jingweiz2017/following{/other_user}","gists_url":"https://api.github.com/users/jingweiz2017/gists{/gist_id}","starred_url":"https://api.github.com/users/jingweiz2017/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jingweiz2017/subscriptions","organizations_url":"https://api.github.com/users/jingweiz2017/orgs","repos_url":"https://api.github.com/users/jingweiz2017/repos","events_url":"https://api.github.com/users/jingweiz2017/events{/privacy}","received_events_url":"https://api.github.com/users/jingweiz2017/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-03T09:44:44Z","updated_at":"2020-12-03T09:44:44Z","author_association":"NONE","body":"hello, [#1972 ](https://github.com/apache/hudi/issues/1972) brought me here. Since, that one has been closed, I want to bring up my question here. Hope someone could help to answer. It seems the conclusion for #1972's solution is to support schema evolution. But, to me, #1972 is more about for the symbol \"union\" where should the \"null\" to be presented if any. As for avro 1.9.2, it requires null to be the first schema in union for nullability. Would it be better for the spark team to upgrade their support to avro 1.9.2 ? and then in turn they would change method: toAvroType in SchemaConverters to put nullSchema at the front while creating union? To me, this looks more like a rule breaking rather than schema evolution. ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/737794951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738011563","html_url":"https://github.com/apache/hudi/issues/2280#issuecomment-738011563","issue_url":"https://api.github.com/repos/apache/hudi/issues/2280","id":738011563,"node_id":"MDEyOklzc3VlQ29tbWVudDczODAxMTU2Mw==","user":{"login":"ygordefraga","id":20543207,"node_id":"MDQ6VXNlcjIwNTQzMjA3","avatar_url":"https://avatars.githubusercontent.com/u/20543207?v=4","gravatar_id":"","url":"https://api.github.com/users/ygordefraga","html_url":"https://github.com/ygordefraga","followers_url":"https://api.github.com/users/ygordefraga/followers","following_url":"https://api.github.com/users/ygordefraga/following{/other_user}","gists_url":"https://api.github.com/users/ygordefraga/gists{/gist_id}","starred_url":"https://api.github.com/users/ygordefraga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ygordefraga/subscriptions","organizations_url":"https://api.github.com/users/ygordefraga/orgs","repos_url":"https://api.github.com/users/ygordefraga/repos","events_url":"https://api.github.com/users/ygordefraga/events{/privacy}","received_events_url":"https://api.github.com/users/ygordefraga/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-03T13:59:59Z","updated_at":"2020-12-03T13:59:59Z","author_association":"NONE","body":"I used Hudi 0.5.3 and the results were really good.\r\n\r\n![Screenshot from 2020-12-03 10-19-52](https://user-images.githubusercontent.com/20543207/101027340-aa90ad80-3556-11eb-8565-8ac134eee182.png)\r\n\r\nThank you, guys!","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738011563/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738209420","html_url":"https://github.com/apache/hudi/pull/2208#issuecomment-738209420","issue_url":"https://api.github.com/repos/apache/hudi/issues/2208","id":738209420,"node_id":"MDEyOklzc3VlQ29tbWVudDczODIwOTQyMA==","user":{"login":"zhedoubushishi","id":31263084,"node_id":"MDQ6VXNlcjMxMjYzMDg0","avatar_url":"https://avatars.githubusercontent.com/u/31263084?v=4","gravatar_id":"","url":"https://api.github.com/users/zhedoubushishi","html_url":"https://github.com/zhedoubushishi","followers_url":"https://api.github.com/users/zhedoubushishi/followers","following_url":"https://api.github.com/users/zhedoubushishi/following{/other_user}","gists_url":"https://api.github.com/users/zhedoubushishi/gists{/gist_id}","starred_url":"https://api.github.com/users/zhedoubushishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhedoubushishi/subscriptions","organizations_url":"https://api.github.com/users/zhedoubushishi/orgs","repos_url":"https://api.github.com/users/zhedoubushishi/repos","events_url":"https://api.github.com/users/zhedoubushishi/events{/privacy}","received_events_url":"https://api.github.com/users/zhedoubushishi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-03T18:38:49Z","updated_at":"2020-12-03T19:01:46Z","author_association":"CONTRIBUTOR","body":"@vinothchandar thanks for the review! Just pushed a minor change related to README. Yea for the ```hudi-spark-common``` issue, created a JIRA for it: https://issues.apache.org/jira/browse/HUDI-1432","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738209420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738211160","html_url":"https://github.com/apache/hudi/issues/2252#issuecomment-738211160","issue_url":"https://api.github.com/repos/apache/hudi/issues/2252","id":738211160,"node_id":"MDEyOklzc3VlQ29tbWVudDczODIxMTE2MA==","user":{"login":"yanzhanc","id":17971906,"node_id":"MDQ6VXNlcjE3OTcxOTA2","avatar_url":"https://avatars.githubusercontent.com/u/17971906?v=4","gravatar_id":"","url":"https://api.github.com/users/yanzhanc","html_url":"https://github.com/yanzhanc","followers_url":"https://api.github.com/users/yanzhanc/followers","following_url":"https://api.github.com/users/yanzhanc/following{/other_user}","gists_url":"https://api.github.com/users/yanzhanc/gists{/gist_id}","starred_url":"https://api.github.com/users/yanzhanc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanzhanc/subscriptions","organizations_url":"https://api.github.com/users/yanzhanc/orgs","repos_url":"https://api.github.com/users/yanzhanc/repos","events_url":"https://api.github.com/users/yanzhanc/events{/privacy}","received_events_url":"https://api.github.com/users/yanzhanc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-03T18:42:13Z","updated_at":"2020-12-03T18:42:13Z","author_association":"NONE","body":"there is no failure or cleaning kicking during the process. and we do not see any  .rollback or .clean files. But the http head request is very high from our observation. and when set partition key to be empty string, the number of request will be slightly smaller. \r\nand we have one more question. From our observation, the same data write by hudi will be smaller in size than parquet. we have 76 GB data as parquet but 38GB data as hudi when written to s3. To my understanding hudi should be bigger because it contains more meta data but yet it is not. Do you have an explanation for this? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738211160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738447791","html_url":"https://github.com/apache/hudi/pull/2263#issuecomment-738447791","issue_url":"https://api.github.com/repos/apache/hudi/issues/2263","id":738447791,"node_id":"MDEyOklzc3VlQ29tbWVudDczODQ0Nzc5MQ==","user":{"login":"satishkotha","id":2992755,"node_id":"MDQ6VXNlcjI5OTI3NTU=","avatar_url":"https://avatars.githubusercontent.com/u/2992755?v=4","gravatar_id":"","url":"https://api.github.com/users/satishkotha","html_url":"https://github.com/satishkotha","followers_url":"https://api.github.com/users/satishkotha/followers","following_url":"https://api.github.com/users/satishkotha/following{/other_user}","gists_url":"https://api.github.com/users/satishkotha/gists{/gist_id}","starred_url":"https://api.github.com/users/satishkotha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/satishkotha/subscriptions","organizations_url":"https://api.github.com/users/satishkotha/orgs","repos_url":"https://api.github.com/users/satishkotha/repos","events_url":"https://api.github.com/users/satishkotha/events{/privacy}","received_events_url":"https://api.github.com/users/satishkotha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-03T23:22:55Z","updated_at":"2020-12-03T23:22:55Z","author_association":"MEMBER","body":"> @satishkotha high level 2 outstanding questions\r\n> a) Moving sortKey into HoodieRecord is needed only if we see performance degradation in conversion, if not we can keep it that way\r\n> b) Keep the old way of reading file slice with and without log files as long as no memory overhead for without log files\r\n\r\n@n3nash Both of these are performance related. My guess is this takes 3-4 weeks to test out with proper setup at scale (there are some issues because of separate branches etc). I think I addressed all of your other comments and fixed few issues I found with small scale.\r\n\r\n Let me know if you have any other feedback.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738447791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738451443","html_url":"https://github.com/apache/hudi/pull/2263#issuecomment-738451443","issue_url":"https://api.github.com/repos/apache/hudi/issues/2263","id":738451443,"node_id":"MDEyOklzc3VlQ29tbWVudDczODQ1MTQ0Mw==","user":{"login":"n3nash","id":2722167,"node_id":"MDQ6VXNlcjI3MjIxNjc=","avatar_url":"https://avatars.githubusercontent.com/u/2722167?v=4","gravatar_id":"","url":"https://api.github.com/users/n3nash","html_url":"https://github.com/n3nash","followers_url":"https://api.github.com/users/n3nash/followers","following_url":"https://api.github.com/users/n3nash/following{/other_user}","gists_url":"https://api.github.com/users/n3nash/gists{/gist_id}","starred_url":"https://api.github.com/users/n3nash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/n3nash/subscriptions","organizations_url":"https://api.github.com/users/n3nash/orgs","repos_url":"https://api.github.com/users/n3nash/repos","events_url":"https://api.github.com/users/n3nash/events{/privacy}","received_events_url":"https://api.github.com/users/n3nash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-03T23:33:29Z","updated_at":"2020-12-03T23:33:29Z","author_association":"CONTRIBUTOR","body":"@satishkotha Left 1 more comment around FileSliceReader. For the 2 performance related comments, can you please create those tickets so we can track that and improve as we do scale testing. Once these are done, I can approve the diff.","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738451443/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738531609","html_url":"https://github.com/apache/hudi/pull/2192#issuecomment-738531609","issue_url":"https://api.github.com/repos/apache/hudi/issues/2192","id":738531609,"node_id":"MDEyOklzc3VlQ29tbWVudDczODUzMTYwOQ==","user":{"login":"liujinhui1994","id":25769285,"node_id":"MDQ6VXNlcjI1NzY5Mjg1","avatar_url":"https://avatars.githubusercontent.com/u/25769285?v=4","gravatar_id":"","url":"https://api.github.com/users/liujinhui1994","html_url":"https://github.com/liujinhui1994","followers_url":"https://api.github.com/users/liujinhui1994/followers","following_url":"https://api.github.com/users/liujinhui1994/following{/other_user}","gists_url":"https://api.github.com/users/liujinhui1994/gists{/gist_id}","starred_url":"https://api.github.com/users/liujinhui1994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liujinhui1994/subscriptions","organizations_url":"https://api.github.com/users/liujinhui1994/orgs","repos_url":"https://api.github.com/users/liujinhui1994/repos","events_url":"https://api.github.com/users/liujinhui1994/events{/privacy}","received_events_url":"https://api.github.com/users/liujinhui1994/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-04T03:01:06Z","updated_at":"2020-12-04T03:01:06Z","author_association":"CONTRIBUTOR","body":"@yanghua  Can you help pass","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738531609/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738533973","html_url":"https://github.com/apache/hudi/issues/2252#issuecomment-738533973","issue_url":"https://api.github.com/repos/apache/hudi/issues/2252","id":738533973,"node_id":"MDEyOklzc3VlQ29tbWVudDczODUzMzk3Mw==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-04T03:06:57Z","updated_at":"2020-12-04T03:06:57Z","author_association":"CONTRIBUTOR","body":"Regarding the file sizes, As long as you are able to see the same rows, it is good :)\r\nThe difference could be coming from compression. By default Hudi uses gzip compression whereas Spark is using snappy.  Gzip is expected to give better compression ratio.\r\n\r\nRegarding head requests, I think it is likely coming from defensive checks done to ensure partitions are created. Is it possible to observe the HEAD requests payload and see the which path is being queried ?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738533973/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738534926","html_url":"https://github.com/apache/hudi/issues/2294#issuecomment-738534926","issue_url":"https://api.github.com/repos/apache/hudi/issues/2294","id":738534926,"node_id":"MDEyOklzc3VlQ29tbWVudDczODUzNDkyNg==","user":{"login":"bvaradar","id":3021376,"node_id":"MDQ6VXNlcjMwMjEzNzY=","avatar_url":"https://avatars.githubusercontent.com/u/3021376?v=4","gravatar_id":"","url":"https://api.github.com/users/bvaradar","html_url":"https://github.com/bvaradar","followers_url":"https://api.github.com/users/bvaradar/followers","following_url":"https://api.github.com/users/bvaradar/following{/other_user}","gists_url":"https://api.github.com/users/bvaradar/gists{/gist_id}","starred_url":"https://api.github.com/users/bvaradar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvaradar/subscriptions","organizations_url":"https://api.github.com/users/bvaradar/orgs","repos_url":"https://api.github.com/users/bvaradar/repos","events_url":"https://api.github.com/users/bvaradar/events{/privacy}","received_events_url":"https://api.github.com/users/bvaradar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-04T03:09:18Z","updated_at":"2020-12-04T03:09:18Z","author_association":"CONTRIBUTOR","body":"@bhushanamk : Can you add all the the configurations you are passing to the command ? ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738534926/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738542767","html_url":"https://github.com/apache/hudi/issues/2294#issuecomment-738542767","issue_url":"https://api.github.com/repos/apache/hudi/issues/2294","id":738542767,"node_id":"MDEyOklzc3VlQ29tbWVudDczODU0Mjc2Nw==","user":{"login":"bhushanamk","id":73978482,"node_id":"MDQ6VXNlcjczOTc4NDgy","avatar_url":"https://avatars.githubusercontent.com/u/73978482?v=4","gravatar_id":"","url":"https://api.github.com/users/bhushanamk","html_url":"https://github.com/bhushanamk","followers_url":"https://api.github.com/users/bhushanamk/followers","following_url":"https://api.github.com/users/bhushanamk/following{/other_user}","gists_url":"https://api.github.com/users/bhushanamk/gists{/gist_id}","starred_url":"https://api.github.com/users/bhushanamk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhushanamk/subscriptions","organizations_url":"https://api.github.com/users/bhushanamk/orgs","repos_url":"https://api.github.com/users/bhushanamk/repos","events_url":"https://api.github.com/users/bhushanamk/events{/privacy}","received_events_url":"https://api.github.com/users/bhushanamk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-04T03:30:08Z","updated_at":"2020-12-04T17:17:46Z","author_association":"NONE","body":"@bvaradar \r\nbelow are the submit configs\r\nprops file :\r\nhoodie.datasource.write.recordkey.field=id\r\nhoodie.datasource.write.partitionpath.field= \r\nhoodie.deltastreamer.source.dfs.root=s3://XXX-4-rawzone/mysql/marketplace/spree_variants\r\nhoodie.datasource.hive_sync.enable=true \r\nhoodie.datasource.hive_sync.database=marketplace \r\nhoodie.datasource.hive_sync.table=spree_variants \r\nhoodie.datasource.hive_sync.username=\r\nhoodie.datasource.hive_sync.password= \r\nhoodie.datasource.hive_sync.jdbcurl=jdbc:hive2://localhost:10000\r\nhoodie.datasource.hive_sync.partition_extractor_class=org.apache.hudi.hive.NonPartitionedExtractor\r\nhoodie.datasource.write.keygenerator.class=org.apache.hudi.keygen.NonpartitionedKeyGenerator\r\nhoodie.upsert.shuffle.parallelism=3\r\nhoodie.consistency.check.enabled=true\r\nhoodie.copyonwrite.record.size.estimate=100000\r\n#hoodie.compact.inline= false\r\nhoodie.parquet.max.file.size=128MB\r\nhoodie.parquet.small.file.limit=100MB\r\n\r\n\r\n\r\n\r\nSpark submit: \r\n\r\nspark-submit --num-executors 1 --executor-memory 2g --driver-memory 2g --conf spark.executor.memoryOverhead=1000 --conf spark.driver.memoryOverhead=1000 --conf spark.dynamicAllocation.enabled=false --conf spark.yarn.submit.waitAppCompletion=false --conf spark.task.cpus=1 --conf spark.executor.cores=1 --conf spark.task.maxFailures=10 --conf spark.memory.fraction=0.4 --conf spark.rdd.compress=true --conf spark.kryoserializer.buffer.max=512m --conf spark.serializer=org.apache.spark.serializer.KryoSerializer --conf spark.sql.hive.convertMetastoreParquet=false --jars /home/hadoop/hudi-spark-bundle_2.11-0.6.0.jar,/usr/lib/spark/external/lib/spark-avro.jar,/home/hadoop/locuz-module-1.0.jar --deploy-mode client --class org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer /home/hadoop//hudi-utilities-bundle_2.11-0.6.0.jar --table-type COPY_ON_WRITE --source-ordering-field cdc_ts --source-class org.apache.hudi.utilities.sources.ParquetDFSSource --target-base-path s3://xxxx-dataplatform-4/prod/mysql/marketplace/spree_variants --target-table spree_variants --enable-hive-sync --props s3://shopx-dataplatform-4/properties/spree_variants.properties --transformer-class org.apache.hudi.utilities.transform.AWSDmsTransformer --payload-class org.apache.hudi.payload.AWSDmsAvroPayload --source-limit 1073741824 --min-sync-interval-seconds 300 --continuous","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738542767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738543101","html_url":"https://github.com/apache/hudi/pull/2192#issuecomment-738543101","issue_url":"https://api.github.com/repos/apache/hudi/issues/2192","id":738543101,"node_id":"MDEyOklzc3VlQ29tbWVudDczODU0MzEwMQ==","user":{"login":"yanghua","id":2283778,"node_id":"MDQ6VXNlcjIyODM3Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/2283778?v=4","gravatar_id":"","url":"https://api.github.com/users/yanghua","html_url":"https://github.com/yanghua","followers_url":"https://api.github.com/users/yanghua/followers","following_url":"https://api.github.com/users/yanghua/following{/other_user}","gists_url":"https://api.github.com/users/yanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/yanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yanghua/subscriptions","organizations_url":"https://api.github.com/users/yanghua/orgs","repos_url":"https://api.github.com/users/yanghua/repos","events_url":"https://api.github.com/users/yanghua/events{/privacy}","received_events_url":"https://api.github.com/users/yanghua/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-04T03:31:10Z","updated_at":"2020-12-04T03:31:10Z","author_association":"CONTRIBUTOR","body":"Sorry for the conflict with @bvaradar , @liujinhui1994 can you consider using a refactoring PR to solve the problem I raised?","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738543101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738545864","html_url":"https://github.com/apache/hudi/issues/2285#issuecomment-738545864","issue_url":"https://api.github.com/repos/apache/hudi/issues/2285","id":738545864,"node_id":"MDEyOklzc3VlQ29tbWVudDczODU0NTg2NA==","user":{"login":"zherenyu831","id":52404525,"node_id":"MDQ6VXNlcjUyNDA0NTI1","avatar_url":"https://avatars.githubusercontent.com/u/52404525?v=4","gravatar_id":"","url":"https://api.github.com/users/zherenyu831","html_url":"https://github.com/zherenyu831","followers_url":"https://api.github.com/users/zherenyu831/followers","following_url":"https://api.github.com/users/zherenyu831/following{/other_user}","gists_url":"https://api.github.com/users/zherenyu831/gists{/gist_id}","starred_url":"https://api.github.com/users/zherenyu831/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zherenyu831/subscriptions","organizations_url":"https://api.github.com/users/zherenyu831/orgs","repos_url":"https://api.github.com/users/zherenyu831/repos","events_url":"https://api.github.com/users/zherenyu831/events{/privacy}","received_events_url":"https://api.github.com/users/zherenyu831/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-04T03:41:07Z","updated_at":"2020-12-04T03:41:07Z","author_association":"CONTRIBUTOR","body":"@bvaradar \r\nhere is the all parquet on my emr cluster,\r\n```\r\n/usr/lib/spark/jars/parquet-column-1.10.1-spark-amzn-1.jar\r\n/usr/lib/spark/jars/parquet-common-1.10.1-spark-amzn-1.jar\r\n/usr/lib/spark/jars/parquet-encoding-1.10.1-spark-amzn-1.jar\r\n/usr/lib/spark/jars/parquet-format-2.4.0.jar\r\n/usr/lib/spark/jars/parquet-hadoop-1.10.1-spark-amzn-1.jar\r\n/usr/lib/spark/jars/parquet-hadoop-bundle-1.6.0.jar\r\n/usr/lib/spark/jars/parquet-jackson-1.10.1-spark-amzn-1.jar\r\n```\r\nwe also tried to see if there is any difference with official jar on these amazon built jars\r\nseems fine...\r\n\r\nJYI: by using read optimized query, we can have all values ","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738545864/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738561925","html_url":"https://github.com/apache/hudi/pull/1704#issuecomment-738561925","issue_url":"https://api.github.com/repos/apache/hudi/issues/1704","id":738561925,"node_id":"MDEyOklzc3VlQ29tbWVudDczODU2MTkyNQ==","user":{"login":"nsivabalan","id":513218,"node_id":"MDQ6VXNlcjUxMzIxOA==","avatar_url":"https://avatars.githubusercontent.com/u/513218?v=4","gravatar_id":"","url":"https://api.github.com/users/nsivabalan","html_url":"https://github.com/nsivabalan","followers_url":"https://api.github.com/users/nsivabalan/followers","following_url":"https://api.github.com/users/nsivabalan/following{/other_user}","gists_url":"https://api.github.com/users/nsivabalan/gists{/gist_id}","starred_url":"https://api.github.com/users/nsivabalan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nsivabalan/subscriptions","organizations_url":"https://api.github.com/users/nsivabalan/orgs","repos_url":"https://api.github.com/users/nsivabalan/repos","events_url":"https://api.github.com/users/nsivabalan/events{/privacy}","received_events_url":"https://api.github.com/users/nsivabalan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-04T04:46:23Z","updated_at":"2020-12-04T04:46:23Z","author_association":"CONTRIBUTOR","body":"@vinothchandar : may I know whats the consensus here. Let me take a stab, but do confirm the same. \r\nIntroduce a new class for payload class that supports this specific ordering. This payload class will have the following api\r\n\r\n```\r\nOption<IndexedRecord> combineAndGetUpdateValue(IndexedRecord currentValue, Schema schema, Map<String, String> props) throws IOException;\r\n```\r\nWill this extend from existing HoodieRecordPayload? bcoz, this the interface used everywhere right? \r\n\r\nOr did you intend a class as follows\r\n```\r\nclass HoodieRecordOrderingPayload implements HoodieRecordPayload{\r\n String orderingField; // value passed in via constructor. \r\n \r\n Option<IndexedRecord> combineAndGetUpdateValue(IndexedRecord currentValue, Schema schema) throws IOException{\r\n    // honor ordering value and return\r\n }\r\n.\r\n.\r\n}","reactions":{"url":"https://api.github.com/repos/apache/hudi/issues/comments/738561925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]