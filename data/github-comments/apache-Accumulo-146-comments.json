[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543953581","html_url":"https://github.com/apache/accumulo/issues/5014#issuecomment-2543953581","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5014","id":2543953581,"node_id":"IC_kwDOACaFSM6Xoaat","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-15T17:13:17Z","updated_at":"2024-12-15T17:41:08Z","author_association":"CONTRIBUTOR","body":"My plan is to break this into multiple PRs, I'm thinking 3 parts for now:\r\n\r\n1. The [first](https://github.com/apache/accumulo/issues/5187) PR will be to add a new Mergeability column to the metadata table and to have Accumulo start populating it based on system splits vs user created splits. Pre split tables like Fate will be marked to not merge. Some basic inital tests will be added.\r\n2. The next PR will handle the API changes which will allow setting the Mergeability of a table/tablet at table creation time or when creating/updating splits later. There will also be API updates to allow viewing the values. These changes will make it easier to add a lot more tests.\r\n3. The last PR will implement the automatic merge feature to handle finding tablets that need merging and handling that. I'm envisioning this will be done with FATE and set up very similar to how splits work now. There will be a new property as well for the merge threshold, like splits. This last PR could be broken done even further into more than one PR if the scope becomes too large.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543953581/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543976040","html_url":"https://github.com/apache/accumulo/issues/5186#issuecomment-2543976040","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5186","id":2543976040,"node_id":"IC_kwDOACaFSM6Xof5o","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-15T17:50:21Z","updated_at":"2024-12-15T17:50:21Z","author_association":"CONTRIBUTOR","body":"How do you envision computing the memory for the compaction job? Caffeine has a nice [Weigher](https://www.javadoc.io/doc/com.github.ben-manes.caffeine/caffeine/latest/com.github.benmanes.caffeine/com/github/benmanes/caffeine/cache/Weigher.html) API for computing the weight of an entry to control max size based on memory instead of total count if the memory footprint for each entry can vary so maybe we can do something similar here.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543976040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543985086","html_url":"https://github.com/apache/accumulo/issues/5186#issuecomment-2543985086","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5186","id":2543985086,"node_id":"IC_kwDOACaFSM6XoiG-","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-15T18:12:22Z","updated_at":"2024-12-15T18:12:22Z","author_association":"CONTRIBUTOR","body":"> How do you envision computing the memory for the compaction job? Caffeine has a nice [Weigher](https://www.javadoc.io/doc/com.github.ben-manes.caffeine/caffeine/latest/com.github.benmanes.caffeine/com/github/benmanes/caffeine/cache/Weigher.html) API for computing the weight of an entry to control max size based on memory instead of total count if the memory footprint for each entry can vary so maybe we can do something similar here.\r\n\r\nWould write some custom code to compute a data size estimate of the object similar to what would be done in the implementation of a Weigher","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2543985086/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2545817212","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2545817212","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2545817212,"node_id":"IC_kwDOACaFSM6XvhZ8","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T14:45:04Z","updated_at":"2024-12-16T14:45:04Z","author_association":"MEMBER","body":"> The current fate code creates two thread pools one for meta and one for user. Both thread pools give threads the same name in jstack. Would be nice if work around this gave any new threads pools different names in jstack.\r\n\r\nYeah, I noticed that as well. I plan to change it here","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2545817212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2545961896","html_url":"https://github.com/apache/accumulo/pull/5171#issuecomment-2545961896","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5171","id":2545961896,"node_id":"IC_kwDOACaFSM6XwEuo","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T15:39:34Z","updated_at":"2024-12-16T15:39:34Z","author_association":"MEMBER","body":"I'll just merge this now since I am already merging something else from 2.1 through main. I'll make myself a note about the test","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2545961896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546197989","html_url":"https://github.com/apache/accumulo/pull/5183#issuecomment-2546197989","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5183","id":2546197989,"node_id":"IC_kwDOACaFSM6Xw-Xl","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T17:16:51Z","updated_at":"2024-12-16T17:16:51Z","author_association":"CONTRIBUTOR","body":"> Given how much this conflicts with #4809 and #5124, I'd like to hold off on some of these, and would prefer to go with a much more narrow change that just reuses the existing ZooCache on the context. \r\n\r\nRe-using the ZooCache on the context is actually the larger change code-wise. Modifying ZooCache to use the persistent recursive watchers is pretty much self contained within ZooCache except for some tests.\r\n\r\n> The prerequisite branch I made to help @meatballspaghetti get started on the chroot stuff for #4809 and the work I have already nearly wrapped up for #5124 are heavily conflicted with these changes, and I'd prefer to get those in first.\r\n> \r\n\r\nI have no issue with waiting for #4809 and #5124 to be merged first, assuming they are done relatively soon.\r\n\r\n> Additionally, this PR seems to be broken on its reliance on a newer ZooKeeper version, newer than the one we have been testing as a supported. Do you know which ZK version introduced these features? If the versions required to support this change are too narrow, it might really limit the deployment options for users, if that range of versions is buggy in some way. In the past, we've generally supported a pretty large range of ZooKeeper versions, allowing quite a lot of flexibility for users when making upgrade decisions. I'd like to not narrow the versions of ZK we support too much, if this was only introduced in 3.9 or maybe even 3.8. But if this was introduced in 3.6 or 3.7, it's probably fine.\r\n\r\nPersistent Recursive Watchers were added in 3.6.0, so it's a very minor bump in the minimum required version.\r\n \r\n> I also have questions about how these new watchers work, and whether it'd actually perform better. It seems there were some open questions about that.\r\n\r\nI agree, which is why I targeted this for 4.0, to give us time to test it.\r\n\r\n> Right now, I don't think we have an excessive number of watchers like we've had in the past, so it's not much of a problem\r\n\r\nI don't know what excessive means in this context. The WatchTheWatchCountIT is failing due to the increased watchers added in a recent PR for caching the non-existent nodes in ZooCache.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546197989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546337696","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2546337696","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2546337696,"node_id":"IC_kwDOACaFSM6Xxgeg","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T18:23:11Z","updated_at":"2024-12-16T18:23:11Z","author_association":"CONTRIBUTOR","body":"@ctubbsii found two issues when testing changes in 4.0. \r\nThey are pretty minor so I created a PR against your branch so they would get pulled in.\r\nhttps://github.com/ctubbsii/accumulo/pull/22 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546337696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546352628","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2546352628","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2546352628,"node_id":"IC_kwDOACaFSM6XxkH0","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T18:31:01Z","updated_at":"2024-12-16T18:31:01Z","author_association":"MEMBER","body":"> @ctubbsii found two issues when testing changes in 4.0. They are pretty minor so I created a PR against your branch so they would get pulled in. [ctubbsii#22](https://github.com/ctubbsii/accumulo/pull/22)\r\n\r\nI'm not sure what you mean by \"testing changes in 4.0\". These changes are the backport of what's in the main/4.0 branch. Are you saying those changes are things that are also problems in the main branch, and should be fixed here, so they get merged up into main/4.0?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546352628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546373523","html_url":"https://github.com/apache/accumulo/issues/5162#issuecomment-2546373523","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5162","id":2546373523,"node_id":"IC_kwDOACaFSM6XxpOT","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T18:41:53Z","updated_at":"2024-12-16T18:41:53Z","author_association":"CONTRIBUTOR","body":"Another way to approach this would be to remove the tablet servers ZooKeeper entry on a normal shutdown. I believe that the tserver did not do this in earlier (< 4.0) versions because the configuration when using cluster.yaml because the deployment was meant to be static.\r\n\r\nIn fact, this is a larger issue when a users uses something like Kubernetes. It's possible that old server paths might linger for all the server processes. We may want to consider removing the server paths from ZooKeeper for all server types when performing a normal shutdown.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546373523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546389109","html_url":"https://github.com/apache/accumulo/pull/5183#issuecomment-2546389109","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5183","id":2546389109,"node_id":"IC_kwDOACaFSM6XxtB1","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T18:50:31Z","updated_at":"2024-12-16T18:50:31Z","author_association":"MEMBER","body":"> I don't know what excessive means in this context.\r\n\r\nIn the past, we had watchers scale as `numTablesEverCreated * numProperties * numTServers`. WatchTheWatchCountIT was made to keep an eye on that. Now we scale to `numCurrentTables * numTServers` (not counting the new stuff you're referring to, which I think is probably still not quite the same scale as what we saw before, but we definitely need to address since the caching of non-existence was added).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546389109/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546414465","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2546414465","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2546414465,"node_id":"IC_kwDOACaFSM6XxzOB","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T19:04:18Z","updated_at":"2024-12-16T19:04:18Z","author_association":"CONTRIBUTOR","body":"> > @ctubbsii found two issues when testing changes in 4.0. They are pretty minor so I created a PR against your branch so they would get pulled in. [ctubbsii#22](https://github.com/ctubbsii/accumulo/pull/22)\r\n> \r\n> I'm not sure what you mean by \"testing changes in 4.0\". These changes are the backport of what's in the main/4.0 branch. Are you saying those changes are things that are also problems in the main branch, and should be fixed here, so they get merged up into main/4.0?\r\n\r\nYes that's exactly what I am saying. :+1: \r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546414465/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546440304","html_url":"https://github.com/apache/accumulo/issues/5034#issuecomment-2546440304","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5034","id":2546440304,"node_id":"IC_kwDOACaFSM6Xx5hw","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-16T19:18:30Z","updated_at":"2024-12-16T19:18:30Z","author_association":"MEMBER","body":"Completed from #5073 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2546440304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2548184205","html_url":"https://github.com/apache/accumulo/pull/5192#issuecomment-2548184205","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5192","id":2548184205,"node_id":"IC_kwDOACaFSM6X4jSN","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-17T11:16:02Z","updated_at":"2024-12-17T11:16:02Z","author_association":"MEMBER","body":"This is still somewhat of a work in progress, but it would close #2298 and #2299","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2548184205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2548715445","html_url":"https://github.com/apache/accumulo/issues/5045#issuecomment-2548715445","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5045","id":2548715445,"node_id":"IC_kwDOACaFSM6X6k-1","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-17T15:12:42Z","updated_at":"2024-12-17T15:12:42Z","author_association":"CONTRIBUTOR","body":"I can take a look at this\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2548715445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2549421704","html_url":"https://github.com/apache/accumulo/pull/5190#issuecomment-2549421704","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5190","id":2549421704,"node_id":"IC_kwDOACaFSM6X9RaI","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-17T19:27:36Z","updated_at":"2024-12-17T19:27:36Z","author_association":"MEMBER","body":"I started up an instance on this branch and everything looks like its working well with no related warnings or errors in the dev console.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2549421704/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2549628483","html_url":"https://github.com/apache/accumulo/pull/5193#issuecomment-2549628483","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5193","id":2549628483,"node_id":"IC_kwDOACaFSM6X-D5D","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-17T21:05:33Z","updated_at":"2024-12-17T21:05:33Z","author_association":"CONTRIBUTOR","body":"Marked as draft because I want to do some more testing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2549628483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2549849296","html_url":"https://github.com/apache/accumulo/pull/5195#issuecomment-2549849296","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5195","id":2549849296,"node_id":"IC_kwDOACaFSM6X-5zQ","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-17T23:10:12Z","updated_at":"2024-12-17T23:10:12Z","author_association":"CONTRIBUTOR","body":"Have not tested these changes.  Made similar changes in 4.0 and manually tested them.   We probably need an IT that test balancing the metadata table if there is not one.   In 4.0 this issue was preventing the metadata table from balancing across multiple tablet servers.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2549849296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2550223617","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2550223617","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2550223617,"node_id":"IC_kwDOACaFSM6YAVMB","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T03:18:00Z","updated_at":"2024-12-18T03:18:00Z","author_association":"MEMBER","body":"@dlmarion and @ddanielr anything else before I merge? I think I've addressed all the things (but not sure if it's to everybody's satisfaction)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2550223617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2550251312","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2550251312","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2550251312,"node_id":"IC_kwDOACaFSM6YAb8w","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T03:42:58Z","updated_at":"2024-12-18T03:42:58Z","author_association":"CONTRIBUTOR","body":"Yeah, I think you're good to merge","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2550251312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2550291432","html_url":"https://github.com/apache/accumulo/pull/5094#issuecomment-2550291432","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5094","id":2550291432,"node_id":"IC_kwDOACaFSM6YAlvo","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T04:12:13Z","updated_at":"2024-12-18T04:12:13Z","author_association":"CONTRIBUTOR","body":"Closing in favor of #5174 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2550291432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551208007","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2551208007","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2551208007,"node_id":"IC_kwDOACaFSM6YEFhH","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T12:33:24Z","updated_at":"2024-12-18T12:33:24Z","author_association":"CONTRIBUTOR","body":"@ctubbsii  - no issues with you merging. @ddanielr and I discussed these changes yesterday, and although I didn't get a chance to test them out I know that he did.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551208007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551282972","html_url":"https://github.com/apache/accumulo/pull/5193#issuecomment-2551282972","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5193","id":2551282972,"node_id":"IC_kwDOACaFSM6YEX0c","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T13:09:19Z","updated_at":"2024-12-18T13:09:19Z","author_association":"CONTRIBUTOR","body":"> A smarter person than me (I don't remember their name, but they were introduced to me as an expert on robust systems) once suggested that it's often not worth the complexity to introduce graceful shutdowns if you already have to handle ungraceful ones. It's better to spend time making sure the ungraceful ones are handled robustly, and if they are, there's no harm in making ungraceful shutdowns (SIGKILL) the normal shutdown and not worth the effort to even bother to code graceful shutdowns... especially for a server process that you expect to stay running for long periods of time as part of your backend architecture where shutdowns are abnormal anyway. I wouldn't take that as an absolute rule (because nothing is), of course, but I'm reminded of that opinion every once in awhile, because I think there's some truth to it that's worth thinking about it whenever we try to add some complexity to handle some edge case for starting/stopping/upgrading/etc.\r\n\r\nAccumulo is very good at handling ungraceful shutdowns of server processes. However, there exists a case where a user may want to inform the server process to finish what it's doing, then shut down. A good example of this is a long running compaction in progress, but the user wants to scale things differently. The user might want to let the Compactor process finish what it's doing, then shut down, with the alternative that if it takes too long they can always kill it.\r\n\r\n \r\n> It's also not clear to me that shutdown hooks are always triggered by a SIGTERM or similar. It seems they also run when System.exit, and or maybe even when the main method is finished normally... and possibly if the main method throws an Exception or even an Error. We'll have to make sure that whatever we do to handle the shutdown request is suitable for all such cases, whatever they happen to be.\r\n\r\n  * [Runtime.addShutdownHook](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Runtime.html#addShutdownHook(java.lang.Thread)) says that \"When the virtual machine begins its shutdown sequence it will start all registered shutdown hooks in some unspecified order and let them run concurrently\" and defines the shutdown sequence being initiated when `System.exit` is called, the program exits normally, or in response to an interrupt. \r\n  * [This table](https://docs.oracle.com/en/java/javase/11/troubleshoot/handle-signals-and-exceptions.html#GUID-57C048F6-0D4B-43BD-B27C-06A613435360__CIHBHCFE) says that SIGTERM, SIGINT, and SIGHUP will execute the shutdown hooks.\r\n  * [Runtime.halt](https://javadoc.scijava.org/Java11/java.base/java/lang/Runtime.html#halt(int)) does not start shutdown hooks\r\n  * I didn't see anything regarding the shutdown hooks running on Exception or Error that terminates the VM, I'm assuming that they won't run.\r\n  * Shutdown hooks won't be executed on SIGKILL. \r\n \r\n> There are also other considerations to be made, like how uncaught exceptions are expected to be handled in the shutdown hook themselves, and we need to be very careful to shut down quickly. There can be no guarantees that these will even run, as the OS may determine a process is taking too long to stop and could just kill it at any time. So it's possible any complexity added to do this may not even be worth it.\r\n\r\nUncaught exceptions in shutdown hooks is addressed in the javadoc for Runtime.addShutdownHook. \r\n\r\n> \r\n> Overall, I kind of like the idea, as long as it shuts down very quickly, doesn't add too much complexity, doesn't add risk by slowing down our emergency Halt measures, and is likely to be worth the effort by getting used. I would strongly prefer we avoid the Hadoop API, though. We've been slowly decoupling/disentangling ourselves from a strict dependency on Hadoop over the years, and we should avoid further mandatory entanglements.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551282972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551306908","html_url":"https://github.com/apache/accumulo/pull/5193#issuecomment-2551306908","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5193","id":2551306908,"node_id":"IC_kwDOACaFSM6YEdqc","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T13:20:31Z","updated_at":"2024-12-18T13:20:31Z","author_association":"CONTRIBUTOR","body":"@ctubbsii - Thanks for the comments. In answering them, I realized that we need a different way to signal normal shutdown and **not** use SIGTERM. The reason being that we would need to ensure that our shutdown hook thread does not return until the main thread has exited so that the FileSystem does not get closed out from underneath of us. This long running shutdown hook thread is likely something that we don't want to do.\r\n\r\nI was trying **not** to create a Thrift shutdown endpoint for all of the server processes and use SIGTERM instead, but at this point I think that's what I'm going to have to do. The idea that was discussed already was to create a Thrift RPC endpoint that can be used to signal graceful shutdown and create a Java application (KeywordExecutable) that calls the RPC method given a host/port. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551306908/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551588822","html_url":"https://github.com/apache/accumulo/pull/5197#issuecomment-2551588822","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5197","id":2551588822,"node_id":"IC_kwDOACaFSM6YFifW","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T15:15:50Z","updated_at":"2024-12-18T15:15:50Z","author_association":"CONTRIBUTOR","body":"Recommend adding a test for this iterator that provides an out of order input and an ordered input to verify the validation functionality.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551588822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551607582","html_url":"https://github.com/apache/accumulo/pull/5190#issuecomment-2551607582","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5190","id":2551607582,"node_id":"IC_kwDOACaFSM6YFnEe","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T15:23:33Z","updated_at":"2024-12-18T15:23:33Z","author_association":"MEMBER","body":"> But, if jQuery has documented the longer style as deprecated, I'm fine with switching it to standardize on the preferred syntax.\r\n\r\nYea that is the case.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551607582/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551740534","html_url":"https://github.com/apache/accumulo/issues/5196#issuecomment-2551740534","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5196","id":2551740534,"node_id":"IC_kwDOACaFSM6YGHh2","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T16:15:17Z","updated_at":"2024-12-18T16:15:17Z","author_association":"CONTRIBUTOR","body":"I believe the new getopt parsing in #5174 will fix this. \r\nCan test and verify once that PR is merged in.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551740534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551769122","html_url":"https://github.com/apache/accumulo/issues/5198#issuecomment-2551769122","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5198","id":2551769122,"node_id":"IC_kwDOACaFSM6YGOgi","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T16:27:58Z","updated_at":"2024-12-18T16:27:58Z","author_association":"CONTRIBUTOR","body":"A solution to this may be adding a `--force` or `--skip-validation` flag to zoo-prop-editor to allow any property value to be set. \r\n\r\nUnsure if it should skip propertyType validation as well. Need to see what validation is performed for classpath contexts.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2551769122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552088430","html_url":"https://github.com/apache/accumulo/pull/5195#issuecomment-2552088430","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5195","id":2552088430,"node_id":"IC_kwDOACaFSM6YHcdu","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T19:16:36Z","updated_at":"2024-12-18T19:16:36Z","author_association":"CONTRIBUTOR","body":"Working on adding an IT for metadata table balancing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552088430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552089740","html_url":"https://github.com/apache/accumulo/issues/5196#issuecomment-2552089740","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5196","id":2552089740,"node_id":"IC_kwDOACaFSM6YHcyM","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T19:17:19Z","updated_at":"2024-12-18T19:17:19Z","author_association":"CONTRIBUTOR","body":"Tested on the current branch for #5174. \r\nIt does not catch the issue as we currently support passing extra args at the end of accumulo-cluster. \r\n\r\nWe have at least three different ways to handle the situation.\r\n\r\nThe first is to support a mis-typing of start here or stop here and fix it around line 586. \r\nProbably should also add a check to do if $@ is equal to 1. \r\n```\r\n# Handle missing hyphens\r\nif [[ \"$1\" == \"here\" ]]; then\r\n   cmd=\"$cmd-$1\"\r\n   shift\r\nfi\r\n```\r\n\r\nThe second would be to dis-allow it entirely in by checking if \"$@\" is greater than zero at the end of parse_args and not supporting additional values at all when calling `accumulo-cluster`. \r\n\r\nThat would solve the error cases of missing the hyphen and also misspelling the word. `stop heer` or `stop hre`. \r\n\r\nThe third would be to not support a default case of `stop` or `start` and always require at least one argument flag to be set i.e `start --all`  `stop --all`. or `start --local` `stop --local`\r\n\r\nOption 1 seems extremely limited in scope and wouldn't prevent other error conditions. \r\nOption 2 would prevent error conditions but would also remove a current ability we support.\r\nOption 3 pushes users to be more direct in their commands, but would cause a breakage for any current SOPs for starting/stopping accumulo. \r\n\r\n@ctubbsii What do you think of the current options and can you think of any other code-based alternatives? ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552089740/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552317597","html_url":"https://github.com/apache/accumulo/pull/5193#issuecomment-2552317597","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5193","id":2552317597,"node_id":"IC_kwDOACaFSM6YIUad","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T21:40:43Z","updated_at":"2024-12-18T21:40:43Z","author_association":"CONTRIBUTOR","body":"I removed the shutdown hook in aec6d47 and replaced with a Thrift RPC mechanism","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552317597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552376475","html_url":"https://github.com/apache/accumulo/pull/5012#issuecomment-2552376475","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5012","id":2552376475,"node_id":"IC_kwDOACaFSM6YIiyb","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T22:18:37Z","updated_at":"2024-12-18T22:18:37Z","author_association":"CONTRIBUTOR","body":"If #5193 is merged into 2.1 and up to main before this is merged in, then I can just add the new Thrift metrics endpoint to the process.thrift file added in #5193 and reduce the changes in this PR.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552376475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552452665","html_url":"https://github.com/apache/accumulo/pull/5195#issuecomment-2552452665","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5195","id":2552452665,"node_id":"IC_kwDOACaFSM6YI1Y5","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-18T23:22:43Z","updated_at":"2024-12-18T23:22:43Z","author_association":"CONTRIBUTOR","body":"Wrote a test and found some additional issues and made fixes to get the test to pass.  Converted this PR to draft because I want to go review the changes I made to get the test to pass.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2552452665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2553303358","html_url":"https://github.com/apache/accumulo/issues/5196#issuecomment-2553303358","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5196","id":2553303358,"node_id":"IC_kwDOACaFSM6YMFE-","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T10:04:58Z","updated_at":"2024-12-19T10:04:58Z","author_association":"MEMBER","body":"@ddanielr wrote:\r\n> What do you think of the current options ... ?\r\n\r\n1. :-1: this requires us to mind-read users to protect them from themselves and seems like a losing game for everybody\r\n2. :+1: this seems best because it directly addresses the issue by more thoroughly vetting the user input; I'm not sure what current ability you're referring to; it looks like we're just throwing the rest of the args away at the end of `parse_args`, so I don't think we'd lose anything with this\r\n3. :-1: this doesn't directly address the problem of users' input not being fully validated, and only narrowly fixes the situation indirectly via a breaking change that imposes a new option on users\r\n\r\n> can you think of any other code-based alternatives?\r\n\r\nI did have an idea to combine the two sections that parse parameters, so instead of pulling the command off before `getopt`, we do it after. That'd be the best place to do any validation of the non-option parameters, like your **Option 2**, and make sure there is exactly one (for the command to be executed). A beneficial side effect of this is that the command would no longer need to be first on the command-line. You could do things like: `accumulo-cluster --all start`. This suggestion doesn't replace your **Option 2**, but it complements it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2553303358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2554726981","html_url":"https://github.com/apache/accumulo/issues/5196#issuecomment-2554726981","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5196","id":2554726981,"node_id":"IC_kwDOACaFSM6YRgpF","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T15:47:27Z","updated_at":"2024-12-19T15:47:27Z","author_association":"CONTRIBUTOR","body":"I too am confused on what capability we lose if we implement 2. I think that's the best option.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2554726981/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2554949729","html_url":"https://github.com/apache/accumulo/issues/5196#issuecomment-2554949729","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5196","id":2554949729,"node_id":"IC_kwDOACaFSM6YSXBh","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T16:29:54Z","updated_at":"2024-12-19T16:29:54Z","author_association":"CONTRIBUTOR","body":"> I too am confused on what capability we lose if we implement 2. I think that's the best option.\r\n\r\nThat's my mistake, I was thinking about the optional args we allow to be passed for `accumulo-service`. While you can internally modify `accumulo-cluster` to send extra args through, you cannot pass them directly in on the command line. \r\n\r\nYeah I agree that option 2 is the best approach.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2554949729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2555166403","html_url":"https://github.com/apache/accumulo/issues/5162#issuecomment-2555166403","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5162","id":2555166403,"node_id":"IC_kwDOACaFSM6YTL7D","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T17:09:13Z","updated_at":"2024-12-19T17:09:13Z","author_association":"CONTRIBUTOR","body":"> Another way to approach this would be to remove the tablet servers ZooKeeper entry on a normal shutdown. \r\n\r\nIn the ServiceLock.unlock code (below) in the case of Compactors, Scan Servers, and TabletServers `path` is `/accumulo/<instanceId>/(compactors|sservers|tservers)/<resourceGroup>/<address>` and `localLock` is the ephemeral node that is created. The code is currently only deleting the ephemeral node.\r\n\r\nWe could modify `ServiceLock.unlock` to accept a boolean, which when `true` could perform a recursive delete on `path`. We would only set it to `true` in the case of Compactors, ScanServers, and TabletServers when ServiceLock.unlock is called. This would mean that the LiveTServerSet running in the Manager would not find any TabletServers without locks when they are shut down gracefully. Graceful shutdown is being addressed in #5193.\r\n\r\nhttps://github.com/apache/accumulo/blob/e5370d1d5cd436d86170d16b0e8c0986d3275e15/core/src/main/java/org/apache/accumulo/core/lock/ServiceLock.java#L531-L558\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2555166403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2555582345","html_url":"https://github.com/apache/accumulo/pull/5193#issuecomment-2555582345","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5193","id":2555582345,"node_id":"IC_kwDOACaFSM6YUxeJ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T19:08:38Z","updated_at":"2024-12-19T19:08:38Z","author_association":"CONTRIBUTOR","body":"This is ready for review. I have kicked off a full IT build.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2555582345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2555703447","html_url":"https://github.com/apache/accumulo/issues/5201#issuecomment-2555703447","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5201","id":2555703447,"node_id":"IC_kwDOACaFSM6YVPCX","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T20:20:20Z","updated_at":"2024-12-19T20:20:20Z","author_association":"CONTRIBUTOR","body":"This applies to bulk v2 code, not sure if applies to bulk v1 code.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2555703447/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2555969039","html_url":"https://github.com/apache/accumulo/pull/5192#issuecomment-2555969039","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5192","id":2555969039,"node_id":"IC_kwDOACaFSM6YWP4P","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-19T23:48:21Z","updated_at":"2024-12-19T23:48:21Z","author_association":"MEMBER","body":"As it turns out, there was another thing that ZooSession was doing, that I didn't realize, that I found with @dlmarion 's help through testing. Specifically, when the session is \"expired\" upon reconnection to a ZK cluster after something like a ZK cluster restart, or a session timeout on the server-side, the ZooKeeper object would be replaced with a new one when requested. However, that's not entirely safe to do automatically, and I will create a new issue about that once I've had a chance to write it up in more detail.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2555969039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2556275927","html_url":"https://github.com/apache/accumulo/issues/5203#issuecomment-2556275927","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5203","id":2556275927,"node_id":"IC_kwDOACaFSM6YXazX","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T04:44:41Z","updated_at":"2024-12-20T04:44:41Z","author_association":"MEMBER","body":"Re: #1893","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2556275927/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2556921442","html_url":"https://github.com/apache/accumulo/issues/5186#issuecomment-2556921442","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5186","id":2556921442,"node_id":"IC_kwDOACaFSM6YZ4Zi","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T12:33:55Z","updated_at":"2024-12-20T12:33:55Z","author_association":"CONTRIBUTOR","body":"Should #5188 be implemented first before we do this? The [MetaJob](https://github.com/apache/accumulo/blob/e5370d1d5cd436d86170d16b0e8c0986d3275e15/server/manager/src/main/java/org/apache/accumulo/manager/compaction/queue/CompactionJobQueues.java#L139) object stores both the CompactionJob and TabletMetadata now so if we drop the TabletMetadata thenthere will be some refactoring and will impact the code here. This issue also becomes a lot easier if we don't have to try and estimate the TabletMetadata size.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2556921442/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557302170","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2557302170","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2557302170,"node_id":"IC_kwDOACaFSM6YbVWa","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T16:15:54Z","updated_at":"2024-12-20T16:15:54Z","author_association":"MEMBER","body":"@keith-turner and I met yesterday to discuss the overall structure of the new changes to be made. Here is a summary of what we concluded.\r\n\r\n### The current implementation in 4.0:\r\n1 FATE instance for USER transactions, 1 FATE instance for META transactions.\r\nEach FATE instance has its own set of transaction runners __*which work on all fate operations*__ in a __*single thread pool*__, a work finder (scans the underlying storage for FATE transactions to work on and assigns the work to the runners), a pool watcher (watches for property change and dead threads, resizing pool and submitting more transaction runners if needed), and a dead reservation cleaner (finds and unreserves transactions which are reserved by a now-dead manager).\r\n\r\n### The changes to be made:\r\n\r\n1 FATE instance for USER transactions, 1 FATE instance for META transactions.\r\nEach FATE instance has its own set of executors (new class maybe called FateExecutor). Each FateExecutor __*works on a subset of fate operations*__ (meaning each has a pool of runners, a work finder, and a pool watcher). Each FATE instance only has one dead reservation cleaner since more than one per instance is unneeded (we are just scanning the storage layer for dead reservations).\r\n\r\nThere will be two properties, one to configure the USER pools, and one for META pools.\r\n\r\n### What else we considered:\r\n\r\nWe considered a set of FATE instances for each transaction type (USER/META), but that was a bit bloated and had some less-desirable functionality as some operations wouldn't care about what FATE instance we operate on and only care about the underlying storage layer. For example, starting a transaction (Fate.startTransaction()) just creates the transaction in the store. With multiple FATE instances, this could be achieved the same through any of them, which makes it confusing for code using FATE.\r\n\r\nWe considered one work finder per FATE instance but with the current structure of the code using a TransferQueue for the work, this wouldn't be possible. This does have the draw back of having multiple threads scanning the same store for the same things, then just filtering them out based on what work they are assigned to take. Maybe this structure could change in a follow on PR if desired, but as an initial PR, using multiple work finders per FATE instance.\r\n\r\nWe considered sharing pools between USER/META transactions, but Keith noted that this could lead to dead locks. Best to keep resources for USER and META transactions separate.\r\n\r\nI think I covered everything. If anyone has any questions or concerns, please let me know.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557302170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557323890","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2557323890","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2557323890,"node_id":"IC_kwDOACaFSM6Ybapy","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T16:29:33Z","updated_at":"2024-12-20T16:30:02Z","author_association":"CONTRIBUTOR","body":"> 1 FATE instance for USER transactions, 1 FATE instance for META transactions. Each FATE instance has its own set of executors (new class maybe called FateExecutor). Each FateExecutor **_works on a subset of fate operations_** (meaning each has a pool of runners, a work finder, and a pool watcher). \r\n\r\nHow are the operations being split into different subsets/groups? Type or something else?\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557323890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557355733","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2557355733","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2557355733,"node_id":"IC_kwDOACaFSM6YbibV","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T16:37:48Z","updated_at":"2024-12-20T16:37:48Z","author_association":"MEMBER","body":"> How are the operations being split into different subsets/groups? Type or something else?\r\n\r\nSplit based on `FateOperation` type (e.g., `TABLE_CREATE`, `TABLE_COMPACT`, `TABLE_BULK_IMPORT2`, etc.). The `FateOperation` class is a thrift type and only used for `FateServiceHandler`. Some transactions are seeded with different operations not included in `FateOperation` and used outside of `FateServiceHandler`. Currently, the `FateOperation`s are passed to the Fates as Strings. Will make a small PR to add  a concrete type of `FateOperation` which includes all possible operations and isn't thrift (will probably rename existing `FateOperation` to `TFateOperation`). This gets rid of the use of strings for these.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557355733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557369910","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2557369910","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2557369910,"node_id":"IC_kwDOACaFSM6Ybl42","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T16:47:24Z","updated_at":"2024-12-20T16:47:24Z","author_association":"MEMBER","body":"I realized you may have been asking how is this configurable, so I'll answer that too.\r\nThere will be 2 properties (one for configuring the META pools, and one for USER pools). The properties are JSON. They contain key/values the keys being a list of the fate operation names and the values being the pool size for those operations. The properties will have a default value and will be configurable by the user. We will ensure the property is always valid (covers all fate ops, no overlap, etc.)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557369910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557373111","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2557373111","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2557373111,"node_id":"IC_kwDOACaFSM6Ybmq3","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T16:49:35Z","updated_at":"2024-12-20T16:49:35Z","author_association":"CONTRIBUTOR","body":"@kevinrr888 - Thanks I was asking really both, how we planned to split it and also how we planned to configure it so thanks for the clarification.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557373111/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557405497","html_url":"https://github.com/apache/accumulo/issues/5202#issuecomment-2557405497","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5202","id":2557405497,"node_id":"IC_kwDOACaFSM6Ybuk5","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T17:10:44Z","updated_at":"2024-12-20T17:10:44Z","author_association":"CONTRIBUTOR","body":"Since the description will only be needed in the rejection case constructing it using a supplier would avoid creating it when its not used.\r\n\r\n```java\r\nvoid submit(RejectionHandler rejectionHandler, Supplier<String> descriptionSupplier);\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557405497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557423149","html_url":"https://github.com/apache/accumulo/issues/5186#issuecomment-2557423149","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5186","id":2557423149,"node_id":"IC_kwDOACaFSM6Yby4t","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T17:23:16Z","updated_at":"2024-12-20T17:23:16Z","author_association":"CONTRIBUTOR","body":"> Should https://github.com/apache/accumulo/issues/5188 be implemented first before we do this? The [MetaJob](https://github.com/apache/accumulo/blob/e5370d1d5cd436d86170d16b0e8c0986d3275e15/server/manager/src/main/java/org/apache/accumulo/manager/compaction/queue/CompactionJobQueues.java#L139) object stores both the CompactionJob and TabletMetadata now so if we drop the TabletMetadata thenthere will be some refactoring and will impact the code here. This issue also becomes a lot easier if we don't have to try and estimate the TabletMetadata size.\r\n\r\nIf this is done first should not expend much on effort on computing the tabletmetadata size. Could call TabletMetadata.toString().lenght() to estimate its size.  This is not efficient, but it is quick to write the code for something that will go away.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557423149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557468896","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2557468896","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2557468896,"node_id":"IC_kwDOACaFSM6Yb-Dg","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T17:55:27Z","updated_at":"2024-12-20T17:55:27Z","author_association":"CONTRIBUTOR","body":"> This does have the draw back of having multiple threads scanning the same store for the same things, then just filtering them out based on what work they are assigned to take. Maybe this structure could change in a follow on PR if desired, but as an initial PR, using multiple work finders per FATE instance.\r\n\r\nI'm not sure what the table structure looks like for the USER store, but if the fate operation name is in the colf, then we could set up locality groups for each fate operation in the Initialize and Upgrade code.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557468896/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557484833","html_url":"https://github.com/apache/accumulo/issues/5130#issuecomment-2557484833","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5130","id":2557484833,"node_id":"IC_kwDOACaFSM6YcB8h","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T18:07:35Z","updated_at":"2024-12-20T18:07:35Z","author_association":"MEMBER","body":"> I'm not sure what the table structure looks like for the USER store, but if the fate operation name is in the colf, then we could set up locality groups for each fate operation in the Initialize and Upgrade code.\r\n\r\nYes, good point. That is true for the USER store and is another thing we plan to change. I forgot to mention this. https://github.com/apache/accumulo/pull/5031 is an open PR regarding this. We can just add the fate operation to the same group.\r\nFor META store I don't know of a similar optimization since we store the data in ZooKeeper. Maybe it could be done with refactoring to how we currently store the Fate data, but I don't think it could be done as is.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557484833/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557576982","html_url":"https://github.com/apache/accumulo/issues/5204#issuecomment-2557576982","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5204","id":2557576982,"node_id":"IC_kwDOACaFSM6YcYcW","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T19:11:12Z","updated_at":"2024-12-20T19:11:12Z","author_association":"CONTRIBUTOR","body":"In RunningCompactionInfo, the duration is set to nanos. \r\nhttps://github.com/apache/accumulo/blob/7b746cd08fc18ea3e75ea5f5180c1a6661367db5/core/src/main/java/org/apache/accumulo/core/util/compaction/RunningCompactionInfo.java#L78\r\n\r\nIn ECadmin, this value is reported as milliseconds. \r\nhttps://github.com/apache/accumulo/blob/7b746cd08fc18ea3e75ea5f5180c1a6661367db5/server/base/src/main/java/org/apache/accumulo/server/util/ECAdmin.java#L183-L187 \r\n\r\nThis was noticed in the monitor and was fixed by handling the output in #5007\r\n\r\nhttps://github.com/apache/accumulo/blob/f2f7030580952ffe3ebbd2fe475c8583f12c1860/server/monitor/src/main/resources/org/apache/accumulo/monitor/resources/js/ec.js#L88\r\n\r\nThis unit issue should be fixed at the RunningCompactionInfo level and the change in the monitor removed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557576982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557656038","html_url":"https://github.com/apache/accumulo/pull/5179#issuecomment-2557656038","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5179","id":2557656038,"node_id":"IC_kwDOACaFSM6Ycrvm","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T20:11:58Z","updated_at":"2024-12-20T20:11:58Z","author_association":"MEMBER","body":"> With the new logging you added do you know where the most time is being spent in the test?\r\n\r\nI added some timing logging to the test to find out. Here is what the logs show:\r\n```\r\nTook 31778 ms to stop all tservers\r\nTook 3 ms to start all tservers\r\nGenerated 100 files in 403 ms\r\nCreated table in 23334 ms\r\nImported into table in 601 ms\r\nTook 3031 ms for split count to reach expected range\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557656038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557894083","html_url":"https://github.com/apache/accumulo/pull/5192#issuecomment-2557894083","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5192","id":2557894083,"node_id":"IC_kwDOACaFSM6Ydl3D","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-20T23:56:14Z","updated_at":"2024-12-21T00:04:15Z","author_association":"MEMBER","body":"I ended up addressing my last comment here, so I won't create a follow-on issue. Basically, the concern was that Watchers will not trigger if the session is dropped and we have to replace it with a new session (a new ZooKeeper client instance, since the session is tied to the instance). But Watchers will still see the session expired event. Poorly written watchers are at risk of not being fired ever again, if they don't monitor for session expired events, but well-written watchers should be fine. They just need to use a new ZooKeeper client object to re-set the Watcher if they want to start getting new event notifications. The old ZooSession kind of did that behind the scenes, but it was a little messy, because there was a lot of criss-crossing and tangled APIs.\r\n\r\nThis PR changes that now to abstract ZooKeeper objects behind a new ZooSession object. This new object can be used in place of ZooKeeper, and holds a delegate ZooKeeper internally. When that one's session expires, it creates a replacement seamlessly internally. The methods are a subset of the methods on ZooKeeper. We can add more, as needed, and we can consider rolling in the APIs from ZooReader and ZooReaderWriter into this.\r\n\r\nA lot of other changes were included to remove the direct use of ZooKeeper objects everywhere in the code, and to replace them with this. The other major changes included here are a cleanup of ClientInfo/ServerInfo in the way they bootstrap ClientContext/ServerContext, so they can more easily reuse ZooKeeper objects (specifically, this new ZooSession object) efficiently, and all the different entry points into ServerInfo, in particular, to support the various use cases (normal server, testing, server-side utility with client properties config file, initialize etc.) are streamlined in the implementation and all lazily loaded via Guava Supplier memoization, with care taken to ensure that there are no cyclic dependencies on the instanceId/instanceName lookups and other things, in particular during Initialize where that's the greatest risk. The lazy loading also ensures that we're not wasting resources on establishing any connections to HDFS/ZK for AccumuloClient objects that are created, but not used (in case the user creates a lot of them or something).\r\n\r\nThis change also uses separate ZooSession objects for the instanceName/instanceId lookups in ZK, on demand, as needed, from the persistent ZooSession used for the ServerContext/ClientContext after they are established. The reason for that is to support future work for chroot'ing the majority of the code (#4809). The logic for handling those lookups was moved to ZooUtil and simplified, replacing multiple similar implementations scattered throughout the code.\r\n\r\nSome follow-on work that could be done after this is fully tested and merged:\r\n\r\n1. Consider putting ZooReader/ZooReaderWriter methods directly into the new ZooSession and getting rid of those\r\n2. Consider catching session expired KeeperExceptions from the proxied methods, like ZooReader does, to not throw errors that are transient and recoverable by ZooSession\r\n3. Also consider catching and dealing with InterruptedException from the ZooSession APIs, so that they don't bleed everywhere throughout Accumulo internal APIs (we'll still have to handle the ones from our own sleeps, but we shouldn't have to deal with the ones from ZooKeeper APIs outside of ZooSession)\r\n4. Review all remaining Watcher objects for correct handling of session expiration\r\n5. Finish the chroot work I mentioned in #4809 \r\n6. Re-design the way instance names/IDs are stored, so we don't have to create a second ZooSession to do the lookup of these outside the chroot tree","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557894083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557914996","html_url":"https://github.com/apache/accumulo/pull/5195#issuecomment-2557914996","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5195","id":2557914996,"node_id":"IC_kwDOACaFSM6Ydq90","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-21T00:31:02Z","updated_at":"2024-12-21T00:34:03Z","author_association":"CONTRIBUTOR","body":"After writing the new IT I saw the following problems, with the first being the initial reason I opened this PR.\r\n\r\n 1. Metadata table was not balancing\r\n 2. Sometimes user tables would balance when the metadata table was not balanced\r\n 3. Each call to the balancer would balance all tables.  For example when balancing the root table it would compute balancing for all tables.\r\n\r\nFor 1 the changes in 6eab50f fix this.  For 2 and 3 the changes in 6de5ef9 fix these.   For 2 created a new Migrations class that tracks migrations per data level so that when making balancing decisions it could always know if the previous levels had migrations.  For 3 added a new method to the balancer SPI that conveys what tables need to be balanced.  This new method support partitioning tables for balancing in different ways and allows balancers to delegate to other balancers with smaller partitions.   May also allow different manager processes to parition tables for balancing in the future.\r\n\r\nTook this out of draft after the changes in 6de5ef9\r\n\r\nThe new IT added only test problem 1.  For problems 2 and 3, I verified those by running the IT and looking at the manager logs.  The test exercises the cause of problems 2 and 3 but will not fail if they occur. \r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2557914996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2558191657","html_url":"https://github.com/apache/accumulo/issues/5196#issuecomment-2558191657","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5196","id":2558191657,"node_id":"IC_kwDOACaFSM6Yeugp","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-21T18:09:38Z","updated_at":"2024-12-21T18:09:38Z","author_association":"MEMBER","body":"I'm including a fix for this in my updates to #5174 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2558191657/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2558295729","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2558295729","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2558295729,"node_id":"IC_kwDOACaFSM6YfH6x","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-22T01:48:53Z","updated_at":"2024-12-22T01:48:53Z","author_association":"MEMBER","body":"In these latest changes, I added colorized output to make it prettier, and fixed a few things with argument parsing. I noticed that `--all` had some problems, so I just removed it. I think it's better without. But it can be added back in pretty easily if we want to... we just need to decide on more concrete behavior for it. There's also somethings we can do to lock down repeated options, like calling different servers types with different groups... because right now, the latest one takes precedence. (Previous to these changes, the latest would take precedence, *except* if you specified all servers of that type by omitting the group name, in which case, the earlier one that had the group name present would take precedence, which was very confusing and weird).\r\n\r\nAlso, there's a lot of logic that's intertwined with accumulo-service, and accumulo-service is clobbering the console with things that the accumulo-cluster script was trying to make nice.... like accumulo-service now prints a bunch of stuff that gets in the way of the progress dots in accumulo-cluster for starting tservers. Also, if we're going to do the progress dots, it should probably be done generally, not just for tservers. (like maybe scan servers and compactors, too?)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2558295729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2559651929","html_url":"https://github.com/apache/accumulo/pull/5193#issuecomment-2559651929","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5193","id":2559651929,"node_id":"IC_kwDOACaFSM6YkTBZ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-23T12:50:29Z","updated_at":"2024-12-23T12:50:29Z","author_association":"CONTRIBUTOR","body":"Full IT build was successful","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2559651929/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2559773810","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2559773810","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2559773810,"node_id":"IC_kwDOACaFSM6Ykwxy","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-23T14:06:29Z","updated_at":"2024-12-23T14:06:29Z","author_association":"CONTRIBUTOR","body":"`shellcheck` is failing in `main`, but not the other branches.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2559773810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2559816378","html_url":"https://github.com/apache/accumulo/pull/5174#issuecomment-2559816378","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5174","id":2559816378,"node_id":"IC_kwDOACaFSM6Yk7K6","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-23T14:33:36Z","updated_at":"2024-12-23T14:33:36Z","author_association":"MEMBER","body":"> `shellcheck` is failing in `main`, but not the other branches.\r\n\r\nFixed in 3015c1b25e3f80336ac1177edf7e4b21936ba05b","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2559816378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2560184556","html_url":"https://github.com/apache/accumulo/pull/5211#issuecomment-2560184556","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5211","id":2560184556,"node_id":"IC_kwDOACaFSM6YmVDs","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-23T19:14:40Z","updated_at":"2024-12-23T19:14:40Z","author_association":"MEMBER","body":"Please backport this fix to 2.1 and 3.1 so these scripts don't diverge unnecessarily. This fix won't matter in those branches, since there's only a single tserver group, but keeping the diff small helps a lot with maintenance.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2560184556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2560308726","html_url":"https://github.com/apache/accumulo/pull/5192#issuecomment-2560308726","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5192","id":2560308726,"node_id":"IC_kwDOACaFSM6YmzX2","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-23T21:19:34Z","updated_at":"2024-12-23T21:19:34Z","author_association":"MEMBER","body":"I updated the description above, and squashed the changes to make rebasing subsequent work onto this branch a bit easier.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2560308726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2560607662","html_url":"https://github.com/apache/accumulo/pull/5192#issuecomment-2560607662","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5192","id":2560607662,"node_id":"IC_kwDOACaFSM6Yn8Wu","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-24T03:52:04Z","updated_at":"2024-12-24T03:52:04Z","author_association":"MEMBER","body":"All ITs passed again (only two pre-existing flakes: CompactionIT and SuspendedTabletsIT, failed once, but passed on subsequent run)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2560607662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2563804079","html_url":"https://github.com/apache/accumulo/issues/5151#issuecomment-2563804079","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5151","id":2563804079,"node_id":"IC_kwDOACaFSM6Y0Iuv","user":{"login":"ArbaazKhan1","id":29344877,"node_id":"MDQ6VXNlcjI5MzQ0ODc3","avatar_url":"https://avatars.githubusercontent.com/u/29344877?v=4","gravatar_id":"","url":"https://api.github.com/users/ArbaazKhan1","html_url":"https://github.com/ArbaazKhan1","followers_url":"https://api.github.com/users/ArbaazKhan1/followers","following_url":"https://api.github.com/users/ArbaazKhan1/following{/other_user}","gists_url":"https://api.github.com/users/ArbaazKhan1/gists{/gist_id}","starred_url":"https://api.github.com/users/ArbaazKhan1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ArbaazKhan1/subscriptions","organizations_url":"https://api.github.com/users/ArbaazKhan1/orgs","repos_url":"https://api.github.com/users/ArbaazKhan1/repos","events_url":"https://api.github.com/users/ArbaazKhan1/events{/privacy}","received_events_url":"https://api.github.com/users/ArbaazKhan1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-12-27T15:30:48Z","updated_at":"2024-12-27T15:30:48Z","author_association":"CONTRIBUTOR","body":"I can take a look at this","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2563804079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2567801689","html_url":"https://github.com/apache/accumulo/pull/5217#issuecomment-2567801689","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5217","id":2567801689,"node_id":"IC_kwDOACaFSM6ZDYtZ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-02T13:47:42Z","updated_at":"2025-01-02T13:47:42Z","author_association":"CONTRIBUTOR","body":"I think this looks ok, but have added @keith-turner as a reviewer. He has recently modified newer versions of this code. The Node and parse tree are deprecated in 3.1 and will be removed in 4.0 and has been replaced by the AccessExpression in [github.com/apache/accumulo-access](accumulo-access). I also reviewed the commit history to see if there was a clone or deepCopy method that used to exist, but was removed for some reason, and did not see anything.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2567801689/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2567882694","html_url":"https://github.com/apache/accumulo/pull/5221#issuecomment-2567882694","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5221","id":2567882694,"node_id":"IC_kwDOACaFSM6ZDsfG","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-02T14:44:58Z","updated_at":"2025-01-02T14:44:58Z","author_association":"CONTRIBUTOR","body":"@ctubbsii While testing this I also found that the issue could be fixed by setting the `systemOutput` in the builder.\r\n\r\nhttps://github.com/apache/accumulo/blob/4eff7353c646d90ae3b8be9e2df2b05c6d3c8c1e/shell/src/main/java/org/apache/accumulo/shell/Shell.java#L301-L304\r\n\r\n```\r\n this.terminal = TerminalBuilder.builder().jansi(false).systemOutput(SystemOutput.SysOut).build();\r\n```\r\n\r\nJline's documentation states that the default is the system output stream so it's interested that explicitly setting it fixes the issue. \r\nhttps://github.com/jline/jline3/blob/c75301facc8716b59c1d57d3e3c5943358022560/terminal/src/main/java/org/jline/terminal/TerminalBuilder.java#L187-L193\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2567882694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568174893","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2568174893","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2568174893,"node_id":"IC_kwDOACaFSM6ZEz0t","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-02T18:12:21Z","updated_at":"2025-01-02T18:12:21Z","author_association":"CONTRIBUTOR","body":"> It seems that this test was trying to ensure that an interleave would occur every time after the first isReady()\r\n\r\nThe test wasn't really created to ensure that interleaving would occur, but I created it to show that the interleaving of Fate operations was how Fate worked by default. Fate tries to advance all operations instead of working on one operation to completion before moving to the next operation. I had a [PR](https://github.com/apache/accumulo/pull/3852) that modified Fate to allow it to operate in an interleaving or non-interleaving mode, but it was closed based on the feedback. With the addition of thread pools per operation types, maybe it makes sense to have some operations execute in a non-interleaving fashion (run to completion), like create table or something.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568174893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568192164","html_url":"https://github.com/apache/accumulo/pull/5221#issuecomment-2568192164","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5221","id":2568192164,"node_id":"IC_kwDOACaFSM6ZE4Ck","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-02T18:27:30Z","updated_at":"2025-01-02T18:27:30Z","author_association":"CONTRIBUTOR","body":"@ddanielr  - curious if you saw #3446, which I think might be somewhat related to this. Regarding the property that you found, is that a new addition to a newer JLine release?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568192164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568240965","html_url":"https://github.com/apache/accumulo/pull/5221#issuecomment-2568240965","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5221","id":2568240965,"node_id":"IC_kwDOACaFSM6ZFD9F","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-02T19:06:22Z","updated_at":"2025-01-02T19:09:37Z","author_association":"CONTRIBUTOR","body":"> @ddanielr - curious if you saw #3446, which I think might be somewhat related to this. Regarding the property that you found, is that a new addition to a newer JLine release?\r\n\r\nI did see #3446 which was originally fixed in jline 3.24.0. \r\nHowever we are already on jline 3.25.1 in accumulo 2.1 so whatever was fixed is no longer working in the 3.25.1 release.\r\n\r\nThe property I found was added in jline 3.22.0 so it's not super recent (Jan 2023).\r\nCommit: https://github.com/jline/jline3/commit/d6e84da4b7a55985fbf8b83b155da3811b0631d8#diff-8f75c2bcaf44443b94e6a2a293331a90047529aabbc2d0e2bae5811ce22ad692R56\r\n\r\nVersion 3.22.0: https://github.com/jline/jline3/blob/jline-parent-3.22.0/terminal/src/main/java/org/jline/terminal/TerminalBuilder.java#L56","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568240965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568274204","html_url":"https://github.com/apache/accumulo/pull/5218#issuecomment-2568274204","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5218","id":2568274204,"node_id":"IC_kwDOACaFSM6ZFMEc","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-02T19:34:43Z","updated_at":"2025-01-02T19:38:17Z","author_association":"MEMBER","body":"> Looks ok to me, but I'm not familiar with the serialization to have an opinion on the serialization changes that you made here.\r\n\r\nAfter you mentioned this, I looked into my serialization changes again. I made these changes under the assumption that Strings are no longer used for any of the `TxInfo`s, but this isn't correct (I thought only `TxInfo.TxName` was stored as a String). The changes I have still work, but serializing/deserializing differently based on if it is a String was probably added for a reason and therefore should probably be kept.\r\n\r\nI'll revert these changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568274204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568292932","html_url":"https://github.com/apache/accumulo/pull/5221#issuecomment-2568292932","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5221","id":2568292932,"node_id":"IC_kwDOACaFSM6ZFQpE","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-02T19:52:04Z","updated_at":"2025-01-02T19:52:04Z","author_association":"CONTRIBUTOR","body":"Good find. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568292932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568316082","html_url":"https://github.com/apache/accumulo/pull/5220#issuecomment-2568316082","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5220","id":2568316082,"node_id":"IC_kwDOACaFSM6ZFWSy","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-02T20:13:04Z","updated_at":"2025-01-02T20:13:04Z","author_association":"CONTRIBUTOR","body":"Curious if you tried [global parameter validation](https://jcommander.org/#_global_parameter_validation). It looks like you can create a validator class that is called when `parse` is called and JCommander provides you with all of the arguments. I'm thinking of the following case:\r\n\r\n1. Create a class called `HelpRequestedParameterException` that extends `ParameterException`\r\n2. Create a class that implements `IParametersValidator` that throws `HelpRequestedParameterException` if any of the keys in the parameter map are `-h`, `--help`, or `-?`.\r\n3. Add the validator class to all of the `@Parameters` annotations.\r\n4. Wrap the call to `JCommander.parse()` so that it traps `HelpRequestedParameterException` to display the help.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568316082/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568420871","html_url":"https://github.com/apache/accumulo/pull/5211#issuecomment-2568420871","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5211","id":2568420871,"node_id":"IC_kwDOACaFSM6ZFv4H","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-02T21:46:46Z","updated_at":"2025-01-02T21:46:46Z","author_association":"MEMBER","body":"Backported to 2.1 in b1510c307ebbfde3cfa679ee9c047fad5d233937","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2568420871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569168692","html_url":"https://github.com/apache/accumulo/pull/5193#issuecomment-2569168692","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5193","id":2569168692,"node_id":"IC_kwDOACaFSM6ZImc0","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T12:44:36Z","updated_at":"2025-01-03T12:44:36Z","author_association":"CONTRIBUTOR","body":"Full IT build still succeeding after updates.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569168692/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569358633","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569358633","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569358633,"node_id":"IC_kwDOACaFSM6ZJU0p","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T14:58:56Z","updated_at":"2025-01-03T14:58:56Z","author_association":"MEMBER","body":"> The test wasn't really created to ensure that interleaving would occur, but I created it to show that the interleaving of Fate operations was how Fate worked by default. Fate tries to advance all operations instead of working on one operation to completion before moving to the next operation\r\n\r\nI was seeing, for example:\r\n![image](https://github.com/user-attachments/assets/3fca5a5c-fda3-49e7-bd76-51a0b377ffb2)\r\n\r\nThe test would check that all fate ops occurred before the next set of fate ops across all fate ids. For example, it would ensure FateId1, 2, and 3 would all execute `FirstOp.call` before **any calls to** `SecondOp.call`. This did not always occur causing failures as seen in the trace above.\r\n\r\nIs this an expected behavior? As the test is right now, either it needs to be changed or the code it is testing needs to be changed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569358633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569387909","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569387909","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569387909,"node_id":"IC_kwDOACaFSM6ZJb-F","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T15:19:36Z","updated_at":"2025-01-03T15:19:36Z","author_association":"CONTRIBUTOR","body":"I'm wondering if the recent Fate changes changed the execution order logic. For example, if you look at `ZooStore.reserve` in the 3.1 code (which I'm assuming was very similar to the code before the major Fate changes in 4.0, it includes some logic to make sure that the next operation that is reserved is after the last one.\r\n\r\nhttps://github.com/apache/accumulo/blob/d0fb7f5fd215c9f60dabb123169ef2df71fc6506/core/src/main/java/org/apache/accumulo/core/fate/ZooStore.java#L159-L164\r\n\r\nIt looks like the new logic for selecting the next thing to work on is in `AbstractFateStore.runnable` and I'm not seeing anything like that.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569387909/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569397018","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569397018","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569397018,"node_id":"IC_kwDOACaFSM6ZJeMa","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T15:26:09Z","updated_at":"2025-01-03T15:26:09Z","author_association":"CONTRIBUTOR","body":"Looking at your image, it appears that the code is not interleaving at all. The `FateInterleavingIT` class that is in 4.0 now has been modified from it's original. The original is in #3852. I'm going to try and apply that to 3.1, removing the non-interleaving test, to see what happens.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569397018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569399621","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569399621","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569399621,"node_id":"IC_kwDOACaFSM6ZJe1F","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T15:28:07Z","updated_at":"2025-01-03T15:28:07Z","author_association":"MEMBER","body":"> Looking at your image, it appears that the code is not interleaving at all.\r\n\r\nHow so? There's one FATE thread executing these ops and it jumps back and forth between the 3 FateIds, is that not what is meant by \"interleaving\"?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569399621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569434569","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569434569","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569434569,"node_id":"IC_kwDOACaFSM6ZJnXJ","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T15:40:26Z","updated_at":"2025-01-03T15:40:26Z","author_association":"CONTRIBUTOR","body":"Maybe I'm misunderstanding your image. If you have 3 Fate ops and 1 Fate thread, then the execution order would have been the following in past versions of the code:\r\n\r\nFirstOp.isReady\r\nSecondOp.isReady\r\nThirdOp.isReady\r\nFirstOp.call\r\nSecondOp.call\r\nThirdOp.call\r\n\r\nThe Fate thread is making sure that all transactions make progress. I'm used the word \"interleave\" as in to mix, or alternate. Whereas in a non-interleaving or non-alternating scenario the Fate thread would run each Fate operation to completion before starting on the next Fate operation. In the non-alternating scenario, it would look like:\r\n\r\nFirstOp.isReady\r\nFirstOp.call\r\nSecondOp.isReady\r\nSecondOp.call\r\nThirdOp.isReady\r\nThirdOp.call\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569434569/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569436982","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569436982","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569436982,"node_id":"IC_kwDOACaFSM6ZJn82","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T15:42:17Z","updated_at":"2025-01-03T15:42:17Z","author_association":"MEMBER","body":">  If you have 3 Fate ops and 1 Fate thread, then the execution order would have been the following in past versions of the code:\r\nFirstOp.isReady\r\nSecondOp.isReady\r\nThirdOp.isReady\r\nFirstOp.call\r\nSecondOp.call\r\nThirdOp.call\r\n\r\nHow would SecondOp.isReady be called before FirstOp.call? FirstOp.call returns SecondOp, so SecondOp.isReady has to execute after FirstOp.call","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569436982/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569442603","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569442603","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569442603,"node_id":"IC_kwDOACaFSM6ZJpUr","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T15:46:28Z","updated_at":"2025-01-03T15:46:28Z","author_association":"MEMBER","body":"> I'm wondering if the recent Fate changes changed the execution order logic. For example, if you look at ZooStore.reserve in the 3.1 code (which I'm assuming was very similar to the code before the major Fate changes in 4.0, it includes some logic to make sure that the next operation that is reserved is after the last one.\r\n\r\nYeah, its possible something has been lost/broken, which was the main motivation for this PR.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569442603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569447508","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569447508","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569447508,"node_id":"IC_kwDOACaFSM6ZJqhU","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T15:50:00Z","updated_at":"2025-01-03T15:50:00Z","author_association":"CONTRIBUTOR","body":"Sorry, you are right, it's been a while since I wrote this test. So, it should be that all of the FirstOp's would complete, then all of the SecondOps would complete, then all of the ThirdOps should complete.  I just backported the test to 3.1 and ran it and the tracking table contains:\r\n\r\n```\r\n1735919276619 TXID:3759954868187127084: [] 1735919276640 false -> FirstOp::isReady\r\n1735919277144 TXID:3759954868187127084: [] 1735919277146 false -> FirstOp::call\r\n1735919277660 TXID:8428227940724651079: [] 1735919277663 false -> FirstOp::isReady\r\n1735919278166 TXID:8428227940724651079: [] 1735919278168 false -> FirstOp::call\r\n1735919278672 TXID:1009699229530621992: [] 1735919278675 false -> FirstOp::isReady\r\n1735919279178 TXID:1009699229530621992: [] 1735919279180 false -> FirstOp::call\r\n1735919279684 TXID:3759954868187127084: [] 1735919279687 false -> SecondOp::isReady\r\n1735919280188 TXID:3759954868187127084: [] 1735919280191 false -> SecondOp::call\r\n1735919280695 TXID:8428227940724651079: [] 1735919280697 false -> SecondOp::isReady\r\n1735919281199 TXID:8428227940724651079: [] 1735919281201 false -> SecondOp::call\r\n1735919281704 TXID:1009699229530621992: [] 1735919281707 false -> SecondOp::isReady\r\n1735919282208 TXID:1009699229530621992: [] 1735919282210 false -> SecondOp::call\r\n1735919282714 TXID:3759954868187127084: [] 1735919282716 false -> LastOp::isReady\r\n1735919283217 TXID:3759954868187127084: [] 1735919283220 false -> LastOp::call\r\n1735919283728 TXID:8428227940724651079: [] 1735919283731 false -> LastOp::isReady\r\n1735919284232 TXID:8428227940724651079: [] 1735919284234 false -> LastOp::call\r\n1735919284744 TXID:1009699229530621992: [] 1735919284746 false -> LastOp::isReady\r\n1735919285248 TXID:1009699229530621992: [] 1735919285250 false -> LastOp::call\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569447508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569455938","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569455938","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569455938,"node_id":"IC_kwDOACaFSM6ZJslC","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T15:56:22Z","updated_at":"2025-01-03T15:56:22Z","author_association":"CONTRIBUTOR","body":"Backported FateInterleavingIT to 3.1 in #5223 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569455938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569458312","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569458312","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569458312,"node_id":"IC_kwDOACaFSM6ZJtKI","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T15:58:08Z","updated_at":"2025-01-03T16:01:24Z","author_association":"MEMBER","body":"Yeah, that looks like the expected order.\r\nAgain, I only saw this failure occasionally on 4.0, but it doesn't seem like something that should ever be failing. This failure may also be occurring in 3.x, I haven't run the test there to see.\r\n\r\nWondering if something is not working as expected in FATE, or something is wrong with the test (which is what I attempted to change in this PR).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569458312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569467210","html_url":"https://github.com/apache/accumulo/pull/5214#issuecomment-2569467210","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5214","id":2569467210,"node_id":"IC_kwDOACaFSM6ZJvVK","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T16:04:26Z","updated_at":"2025-01-03T16:04:26Z","author_association":"CONTRIBUTOR","body":"Looking at:\r\n\r\nhttps://github.com/apache/accumulo/blob/b63690ab4889f25509e178a2c506fe5747beb20d/core/src/main/java/org/apache/accumulo/core/fate/AbstractFateStore.java#L182-L203\r\n\r\nIf the `inProgress` set is empty, I don't see anything that prevents the transaction selected from `other` to have a transaction id greater than the previously selected transaction id.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569467210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569679459","html_url":"https://github.com/apache/accumulo/issues/4995#issuecomment-2569679459","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4995","id":2569679459,"node_id":"IC_kwDOACaFSM6ZKjJj","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T18:57:35Z","updated_at":"2025-01-03T18:57:35Z","author_association":"CONTRIBUTOR","body":"[ServerConfigurationFactory.ConfigRefreshRunner](https://github.com/apache/accumulo/blob/2.1/server/base/src/main/java/org/apache/accumulo/server/conf/ServerConfigurationFactory.java#L185) . It looks like the refresh interval is 15 minutes and it checks the data version of the node in ZooKeeper against the version of the cached node. IIRC property updates have always been eventually consistent. I would add another option to the list:\r\n\r\n  4. Make the ConfigRefreshRunner refresh period configurable and add an API to query for the cached version of a specific configuration node (system, table, etc). If all of the servers come back with the same answer, then it's consistent (at least to that point).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569679459/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569697462","html_url":"https://github.com/apache/accumulo/pull/5222#issuecomment-2569697462","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5222","id":2569697462,"node_id":"IC_kwDOACaFSM6ZKni2","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T19:14:05Z","updated_at":"2025-01-03T19:14:05Z","author_association":"CONTRIBUTOR","body":"Ok, I'm going to merge this in and up to main. I'll do a follow-on PR for main to fix the other server processes as only the Compactor and TabletServer have a group name in 2.1 and 3.1.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569697462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569726774","html_url":"https://github.com/apache/accumulo/pull/5222#issuecomment-2569726774","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5222","id":2569726774,"node_id":"IC_kwDOACaFSM6ZKus2","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T19:40:38Z","updated_at":"2025-01-03T19:40:38Z","author_association":"CONTRIBUTOR","body":"changes to main were easy, a second PR was not necessary.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569726774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569831083","html_url":"https://github.com/apache/accumulo/pull/5218#issuecomment-2569831083","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5218","id":2569831083,"node_id":"IC_kwDOACaFSM6ZLIKr","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T21:19:20Z","updated_at":"2025-01-03T21:32:08Z","author_association":"MEMBER","body":"@cshannon - I considered the same and is what I was initially doing when first writing these changes (I think I was going with `fateOp` as the name). I decided to back out this rename due to many places needing a rename and wanted to keep this PR as simple as possible to get it merged in quickly.\r\n\r\nI also think it would be good to rename this. I can do that in a follow-on PR after this is merged in.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569831083/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569945216","html_url":"https://github.com/apache/accumulo/pull/5221#issuecomment-2569945216","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5221","id":2569945216,"node_id":"IC_kwDOACaFSM6ZLkCA","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-03T23:56:31Z","updated_at":"2025-01-03T23:58:44Z","author_association":"MEMBER","body":"> ```\r\n>  this.terminal = TerminalBuilder.builder().jansi(false).systemOutput(SystemOutput.SysOut).build();\r\n> ```\r\n\r\nThis seems like a sensible solution (though I'm not sure I understand why we should disable jansi). However, looking at the code, it looks like you should call `.streams(in, out)` to set up the input/output stream based on what was passed to the Shell (we might pass a different stream to the shell for testing, but the shell's normal execute/main method should use System.in and System.out for these). Trying to trace the code, the systemOutput seems to be a fallback for the system tty when the streams are not set. There's a lot of complex logic in the jline code that reconciles all these options, so I'm not 100% sure what the intent was here.\r\n\r\nI'm pretty sure that before we upgraded jline, we did explicitly set System.in and System.out when constructing the terminal. Perhaps that got lost in the upgrade?\r\n\r\n> Jline's documentation states that the default is the system output stream so it's interested that explicitly setting it fixes the issue. https://github.com/jline/jline3/blob/c75301facc8716b59c1d57d3e3c5943358022560/terminal/src/main/java/org/jline/terminal/TerminalBuilder.java#L187-L193\r\n\r\nTracing through the code, it looks like the default isn't actually `SystemOutput.SysOut`, but `SystemOutput.SysOutOrSysErr`, which seems causes one to be selected based on whether the terminal provider supports the output as a tty. I think it's falling back to stderr because stdout is not a tty.\r\n\r\nI tested by giving it a pseudo tty. This works, and sends it to stdout so I can grep:\r\n```bash\r\nsocat - EXEC:'accumulo shell -e tables\\\\ -np',pty,setsid,ctty | grep meta\r\n```\r\n\r\nHowever, neither a pipe nor a redirection works without simulating a tty. So, neither of these work:\r\n```bash\r\naccumulo shell -e tables | grep meta\r\naccumulo shell -e tables > tables.txt\r\n```\r\n\r\nI added `org.jline` to my log4j config and ran the shell with the options to redirect the java-util-logging to log4j:\r\n```bash\r\nACCUMULO_JAVA_OPTS=-Djava.util.logging.manager=org.apache.logging.log4j.jul.LogManager accumulo shell -e tables\r\n```\r\n\r\nThis gave some useful output about which terminal provider it was loading and which pty implementation it was using (skipping the stack traces for the providers which couldn't be loaded). It seems to be loading both the `jni` and the `exec` terminal providers, but `jni` is first, so I think it's using that:\r\n\r\n```\r\n2025-01-03T18:16:02,963 [org.jline] DEBUG: Available providers: jni, exec\r\n2025-01-03T18:16:02,996 [org.jline] DEBUG: Registering shutdown-hook: Thread[JLine Shutdown Hook,5,main]\r\n2025-01-03T18:16:02,996 [org.jline] DEBUG: Adding shutdown-hook task: org.jline.terminal.impl.PosixSysTerminal$$Lambda$178/0x00007f48531b6940@467cb96f\r\n2025-01-03T18:16:02,997 [org.jline] DEBUG: Using terminal PosixSysTerminal\r\n2025-01-03T18:16:02,997 [org.jline] DEBUG: Using pty LinuxNativePty\r\n```\r\n\r\nI believe the problem is that the `JniTerminalProvider.isSystemStream(stream)` method returns false if any stream is not a tty, which it is not if you're redirecting/piping. This means that when it's selecting the output stream for the system type, and you are only redirecting stdout, then `SystemOutput.SysOutOrSysErr`, results in the stdout being skipped over and the stderr being used.\r\n\r\nYou can verify this by redirecting both streams to separate files. When you do that, it is unable to construct a terminal using any output stream, and instead falls back to the DumbTerminal.\r\n\r\nI think ultimately, the problem is the logic at https://github.com/jline/jline3/blob/c75301facc8716b59c1d57d3e3c5943358022560/terminal/src/main/java/org/jline/terminal/TerminalBuilder.java#L407-L410\r\n\r\nThis logic sets the system stream based on whether the provider says any of the passed streams are considered system streams. But for the JniTerminalProvider, it's only considered a \"system stream\" if the stream is a tty, which is false for the stdout, but true for stderr, so JniTerminalProvider ends up being the selected provider using the stderr, which is still a tty. What it should do instead, it should only use that provider if *all* of the provided streams are considered system streams (but I think that reverts the intent of jline/jline3#787, so there may be a philosophical disagreement with upstream devs on what the correct behavior should be when one stream is a tty and the other is not). Otherwise, it should use the DumbTerminalProvider with the system stream.\r\n\r\nI'm not sure if this worked at all after #3446. I think the original behavior that was implemented in jline/jline3#787 to use the terminal with stderr only still exists after jline/jline3#854, which I don't think fixed the issue. Or, if it did, a subsequent change broke it again. jline/jline3#854 only changed which output stream was used for the DumbTerminal, but the bug we're now seeing is that the DumbTerminal isn't being selected... the JniTerminal is being selected but with only stderr since stdout is not a tty.\r\n\r\nI think this issue needs to be raised again upstream. In the meantime, I think setting the stream directly to stdout will be the right fix for Accumulo. The property can be mentioned to users who need a workaround in the meantime, but I don't think our code should rely on that property being set in the config for shell redirection to work correctly.\r\n\r\nWhat I'd be curious to know, though, is whether pagination is attempted after setting the system output stream correctly. I noticed while testing, when I gave a pseudo tty, if I didn't specify `-np` to disable pagination, it would paginate after every entry. But, it shouldn't do that... it should behave correctly without pagination automatically when there is no tty, but still use the correct output stream for piping/redirection.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2569945216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2573345974","html_url":"https://github.com/apache/accumulo/pull/5224#issuecomment-2573345974","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5224","id":2573345974,"node_id":"IC_kwDOACaFSM6ZYiS2","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-06T15:28:08Z","updated_at":"2025-01-06T15:28:08Z","author_association":"CONTRIBUTOR","body":"If/when this is merged up, then I'm going to create a follow-on PR for `main` to add a method to ServiceLockSupport that addresses this https://github.com/apache/accumulo/pull/4861#discussion_r1759520521 to put the zookeeper node creation code for non-HA servers in one place.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2573345974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2573505536","html_url":"https://github.com/apache/accumulo/pull/5225#issuecomment-2573505536","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5225","id":2573505536,"node_id":"IC_kwDOACaFSM6ZZJQA","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-06T16:50:46Z","updated_at":"2025-01-06T16:50:46Z","author_association":"CONTRIBUTOR","body":"This is waiting on #5224 to be merged","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2573505536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2573508038","html_url":"https://github.com/apache/accumulo/pull/5224#issuecomment-2573508038","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5224","id":2573508038,"node_id":"IC_kwDOACaFSM6ZZJ3G","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-06T16:52:04Z","updated_at":"2025-01-06T16:52:04Z","author_association":"CONTRIBUTOR","body":"> If/when this is merged up, then I'm going to create a follow-on PR for `main` to add a method to ServiceLockSupport that addresses this [#4861 (comment)](https://github.com/apache/accumulo/pull/4861#discussion_r1759520521) to put the zookeeper node creation code for non-HA servers in one place.\r\n\r\nCreated #5225 for this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2573508038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2574106327","html_url":"https://github.com/apache/accumulo/issues/5162#issuecomment-2574106327","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5162","id":2574106327,"node_id":"IC_kwDOACaFSM6Zbb7X","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-06T23:30:51Z","updated_at":"2025-01-06T23:30:51Z","author_association":"CONTRIBUTOR","body":"I created #5226 to suppress the display of dead servers for configured resource groups in the Monitor. I think this is the simplest approach at this point. My earlier comments about removing the lock in ZooKeeper may not fully resolve the issue you raise.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2574106327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575339841","html_url":"https://github.com/apache/accumulo/issues/5123#issuecomment-2575339841","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5123","id":2575339841,"node_id":"IC_kwDOACaFSM6ZgJFB","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-07T13:48:53Z","updated_at":"2025-01-07T13:48:53Z","author_association":"CONTRIBUTOR","body":"Closing this, I don't think I have seen these tests fail in while.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575339841/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575439252","html_url":"https://github.com/apache/accumulo/issues/5060#issuecomment-2575439252","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5060","id":2575439252,"node_id":"IC_kwDOACaFSM6ZghWU","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-07T14:30:53Z","updated_at":"2025-01-07T14:30:53Z","author_association":"CONTRIBUTOR","body":"Does it need to be human readable in the metadata table? If not, then we could just store the list of input files as base64 encoded json. We could also use some other type of encoding (like [CBOR](https://cbor.io/)), but if you want to use jq then base64 decoding is easy on the command line. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575439252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575572696","html_url":"https://github.com/apache/accumulo/pull/5227#issuecomment-2575572696","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5227","id":2575572696,"node_id":"IC_kwDOACaFSM6ZhB7Y","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-07T15:26:13Z","updated_at":"2025-01-07T15:26:13Z","author_association":"CONTRIBUTOR","body":"@keith-turner - the milestone and target branch don't match on this PR","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575572696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575603018","html_url":"https://github.com/apache/accumulo/issues/4856#issuecomment-2575603018","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4856","id":2575603018,"node_id":"IC_kwDOACaFSM6ZhJVK","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-07T15:38:26Z","updated_at":"2025-01-07T15:38:26Z","author_association":"CONTRIBUTOR","body":"@kevinrr888 - does #4852 close this?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575603018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575607317","html_url":"https://github.com/apache/accumulo/issues/5139#issuecomment-2575607317","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5139","id":2575607317,"node_id":"IC_kwDOACaFSM6ZhKYV","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-07T15:40:15Z","updated_at":"2025-01-07T15:40:15Z","author_association":"CONTRIBUTOR","body":"#4828 seems to be related to this.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575607317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575612932","html_url":"https://github.com/apache/accumulo/issues/4856#issuecomment-2575612932","issue_url":"https://api.github.com/repos/apache/accumulo/issues/4856","id":2575612932,"node_id":"IC_kwDOACaFSM6ZhLwE","user":{"login":"kevinrr888","id":43969518,"node_id":"MDQ6VXNlcjQzOTY5NTE4","avatar_url":"https://avatars.githubusercontent.com/u/43969518?v=4","gravatar_id":"","url":"https://api.github.com/users/kevinrr888","html_url":"https://github.com/kevinrr888","followers_url":"https://api.github.com/users/kevinrr888/followers","following_url":"https://api.github.com/users/kevinrr888/following{/other_user}","gists_url":"https://api.github.com/users/kevinrr888/gists{/gist_id}","starred_url":"https://api.github.com/users/kevinrr888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevinrr888/subscriptions","organizations_url":"https://api.github.com/users/kevinrr888/orgs","repos_url":"https://api.github.com/users/kevinrr888/repos","events_url":"https://api.github.com/users/kevinrr888/events{/privacy}","received_events_url":"https://api.github.com/users/kevinrr888/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-07T15:42:41Z","updated_at":"2025-01-07T15:42:41Z","author_association":"MEMBER","body":"@dlmarion I do not believe so.\r\nI believe this issue came about from that PR though.\r\nThat PR did not change any of the existing logic for MetadataConstraints, only reorganized it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575612932/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575686164","html_url":"https://github.com/apache/accumulo/pull/5227#issuecomment-2575686164","issue_url":"https://api.github.com/repos/apache/accumulo/issues/5227","id":2575686164,"node_id":"IC_kwDOACaFSM6ZhdoU","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-01-07T16:12:49Z","updated_at":"2025-01-07T16:12:49Z","author_association":"CONTRIBUTOR","body":"> @keith-turner - the milestone and target branch don't match on this PR\r\n\r\nGood catch,maybe that is why the build was failing. I swtiched the branch.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/2575686164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]