[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392692141","html_url":"https://github.com/apache/couchdb/issues/1350#issuecomment-392692141","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1350","id":392692141,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MjY5MjE0MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-29T08:17:45Z","updated_at":"2018-05-29T08:17:45Z","author_association":"MEMBER","body":"Backed out the changes due to lack of time. This should be resolved for now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392692141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392696085","html_url":"https://github.com/apache/couchdb/issues/1350#issuecomment-392696085","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1350","id":392696085,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MjY5NjA4NQ==","user":{"login":"leiz340","id":39719917,"node_id":"MDQ6VXNlcjM5NzE5OTE3","avatar_url":"https://avatars.githubusercontent.com/u/39719917?v=4","gravatar_id":"","url":"https://api.github.com/users/leiz340","html_url":"https://github.com/leiz340","followers_url":"https://api.github.com/users/leiz340/followers","following_url":"https://api.github.com/users/leiz340/following{/other_user}","gists_url":"https://api.github.com/users/leiz340/gists{/gist_id}","starred_url":"https://api.github.com/users/leiz340/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leiz340/subscriptions","organizations_url":"https://api.github.com/users/leiz340/orgs","repos_url":"https://api.github.com/users/leiz340/repos","events_url":"https://api.github.com/users/leiz340/events{/privacy}","received_events_url":"https://api.github.com/users/leiz340/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-29T08:30:38Z","updated_at":"2018-05-29T08:30:38Z","author_association":"NONE","body":"thanks @wohali \r\nit fine now","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392696085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392779991","html_url":"https://github.com/apache/couchdb/pull/1215#issuecomment-392779991","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1215","id":392779991,"node_id":"MDEyOklzc3VlQ29tbWVudDM5Mjc3OTk5MQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-29T13:39:18Z","updated_at":"2018-05-29T13:39:18Z","author_association":"MEMBER","body":"@jaydoane @janl @wohali \r\n\r\nI propose to revert this commit for the for time being. It doesn't seems that anybody doing anything to fix all those warnings and as I've tried a couple of times on mrview modules I can tell it's often not so trivial thing to do.\r\n\r\nMeanwhile it generates a wall of the warnings making hunting for an actual warnings and compilation errors during dev process quite a chore.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392779991/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392821734","html_url":"https://github.com/apache/couchdb/pull/1215#issuecomment-392821734","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1215","id":392821734,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MjgyMTczNA==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-29T15:32:34Z","updated_at":"2018-05-29T15:32:34Z","author_association":"CONTRIBUTOR","body":"While I agree the wall of warnings is annoying (and also not trivial to fix), I personally find it helpful to prevent new warnings when working on new code. However, if it makes it even more difficult to work on the code base, I'm ok with reverting (although I'm also aware my vote doesn't count).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392821734/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392826035","html_url":"https://github.com/apache/couchdb/pull/1215#issuecomment-392826035","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1215","id":392826035,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MjgyNjAzNQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-29T15:43:30Z","updated_at":"2018-05-29T15:43:30Z","author_association":"MEMBER","body":"@jaydoane But does it prevents the new warnings? We don't count the diff, just dump a bunch of noise, so new warnings just get lost in the old ones. I assume the intent was to annoy people into fixing those warnings, but two month later I don't see that this is working","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392826035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392836996","html_url":"https://github.com/apache/couchdb/pull/1215#issuecomment-392836996","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1215","id":392836996,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MjgzNjk5Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-29T16:14:37Z","updated_at":"2018-05-29T16:14:37Z","author_association":"MEMBER","body":"fine by me","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/392836996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393142676","html_url":"https://github.com/apache/couchdb/pull/1347#issuecomment-393142676","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1347","id":393142676,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzE0MjY3Ng==","user":{"login":"urieli","id":851962,"node_id":"MDQ6VXNlcjg1MTk2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/851962?v=4","gravatar_id":"","url":"https://api.github.com/users/urieli","html_url":"https://github.com/urieli","followers_url":"https://api.github.com/users/urieli/followers","following_url":"https://api.github.com/users/urieli/following{/other_user}","gists_url":"https://api.github.com/users/urieli/gists{/gist_id}","starred_url":"https://api.github.com/users/urieli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/urieli/subscriptions","organizations_url":"https://api.github.com/users/urieli/orgs","repos_url":"https://api.github.com/users/urieli/repos","events_url":"https://api.github.com/users/urieli/events{/privacy}","received_events_url":"https://api.github.com/users/urieli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T12:28:02Z","updated_at":"2018-05-30T12:28:02Z","author_association":"NONE","body":"In the bionic repo, the couchdb package is missing: https://apache.bintray.com/couchdb-deb/dists/bionic/main/binary-amd64/Packages\r\nJenkins is currently showing build failure, which may be related.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393142676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393211795","html_url":"https://github.com/apache/couchdb/pull/1347#issuecomment-393211795","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1347","id":393211795,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzIxMTc5NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T15:44:13Z","updated_at":"2018-05-30T15:44:13Z","author_association":"MEMBER","body":"@urieli Public packages are not yet ready. Please be patient and watch https://github.com/apache/couchdb/issues/1314 for details.\r\n\r\nThe build failures are not specific to bionic compatibility but rather are instability in our test suite.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393211795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393224635","html_url":"https://github.com/apache/couchdb/issues/1349#issuecomment-393224635","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1349","id":393224635,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzIyNDYzNQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T16:21:45Z","updated_at":"2018-05-30T16:21:45Z","author_association":"MEMBER","body":"Here's the relevant logs for the failure:\r\n\r\n```\r\n[info] 2018-05-28T23:56:00.595674Z nonode@nohost <0.31.0> -------- Application ddoc_cache started on node nonode@nohost\r\n[error] 2018-05-28T23:56:00.688798Z nonode@nohost <0.6922.4> -------- ddoc_cache_ev :: started :: {ddoc_cache_entry_custom,{<<\"eunit-test-db-fc3df6c7b8dd77eee5f87a58ab269484\">>,ddoc_cache_remove_test}}\r\n[error] 2018-05-28T23:56:00.689891Z nonode@nohost <0.6922.4> -------- ddoc_cache_ev :: inserted :: {ddoc_cache_entry_custom,{<<\"eunit-test-db-fc3df6c7b8dd77eee5f87a58ab269484\">>,ddoc_cache_remove_test}}\r\n[error] 2018-05-28T23:56:00.756390Z nonode@nohost <0.6922.4> -------- ddoc_cache_ev :: removed :: {ddoc_cache_entry_custom,{<<\"eunit-test-db-fc3df6c7b8dd77eee5f87a58ab269484\">>,ddoc_cache_remove_test}}\r\n[error] 2018-05-28T23:56:00.756867Z nonode@nohost <0.6938.4> -------- ddoc_cache_ev :: started :: {ddoc_cache_entry_custom,{<<\"eunit-test-db-fc3df6c7b8dd77eee5f87a58ab269484\">>,ddoc_cache_remove_test}}\r\n[error] 2018-05-28T23:56:00.757463Z nonode@nohost <0.6938.4> -------- ddoc_cache_ev :: removed :: {ddoc_cache_entry_custom,{<<\"eunit-test-db-fc3df6c7b8dd77eee5f87a58ab269484\">>,ddoc_cache_remove_test}}\r\n[error] 2018-05-28T23:56:00.758095Z nonode@nohost <0.6942.4> -------- ddoc_cache_ev :: lru_init :: nil\r\n[error] 2018-05-28T23:56:00.758103Z nonode@nohost <0.6913.4> -------- gen_server ddoc_cache_lru terminated with reason: no match of right hand value not_found at ddoc_cache_lru:remove_key/2(line:307) <= ddoc_cache_lru:handle_info/2(line:218) <= gen_server:try_dispatch/4(line:601) <= gen_server:handle_msg/5(line:667) <= proc_lib:init_p_do_apply/3(line:247)\r\n  last msg: {'EXIT',<0.6938.4>,normal}\r\n     state: {st,<<>>,<<>>,<0.6914.4>}\r\n[error] 2018-05-28T23:56:00.758791Z nonode@nohost <0.6913.4> -------- CRASH REPORT Process ddoc_cache_lru (<0.6913.4>) with 0 neighbors exited with reason: no match of right hand value not_found at ddoc_cache_lru:remove_key/2(line:307) <= ddoc_cache_lru:handle_info/2(line:218) <= gen_server:try_dispatch/4(line:601) <= gen_server:handle_msg/5(line:667) <= proc_lib:init_p_do_apply/3(line:247) at gen_server:terminate/7(line:812) <= proc_lib:init_p_do_apply/3(line:247); initial_call: {ddoc_cache_lru,init,['Argument__1']}, ancestors: [ddoc_cache_sup,<0.6911.4>], messages: [{'EXIT',<0.6914.4>,killed}], links: [<0.6912.4>], dictionary: [], trap_exit: true, status: running, heap_size: 987, stack_size: 27, reductions: 1423\r\n[error] 2018-05-28T23:56:00.759276Z nonode@nohost <0.6912.4> -------- Supervisor ddoc_cache_sup had child ddoc_cache_lru started with ddoc_cache_lru:start_link() at <0.6913.4> exit with reason no match of right hand value not_found at ddoc_cache_lru:remove_key/2(line:307) <= ddoc_cache_lru:handle_info/2(line:218) <= gen_server:try_dispatch/4(line:601) <= gen_server:handle_msg/5(line:667) <= proc_lib:init_p_do_apply/3(line:247) in context child_terminated\r\n```\r\n\r\nFor some reason when we're processing an exit message from an cache entry that failed to start we appear to be missing any record of the related database [1,2].\r\n\r\n[1] https://github.com/apache/couchdb/blob/master/src/ddoc_cache/src/ddoc_cache_lru.erl#L218\r\n[2] https://github.com/apache/couchdb/blob/master/src/ddoc_cache/src/ddoc_cache_lru.erl#L307\r\n\r\nA temp PR to try and narrow that down might be to add ?EVENT hooks around modifying those khashes which would theoretically show where timing is presumably getting out of whack from the normal expected case.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393224635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393228067","html_url":"https://github.com/apache/couchdb/issues/1349#issuecomment-393228067","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1349","id":393228067,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzIyODA2Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T16:32:19Z","updated_at":"2018-05-30T16:32:19Z","author_association":"MEMBER","body":"If anyone wants to have a go at this temp PR, create a new branch that starts with `jenkins-` and that will trigger a Jenkins job.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393228067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393301414","html_url":"https://github.com/apache/couchdb/issues/1353#issuecomment-393301414","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1353","id":393301414,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzMwMTQxNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T20:10:35Z","updated_at":"2018-05-30T20:10:35Z","author_association":"MEMBER","body":"I'm told https://github.com/apache/couchdb/pull/1176 is sufficient for part of this.\r\n\r\nWe should make this default and make the necessary change to PBKDF2 iterations as well.\r\n\r\n/cc @nickva ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393301414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393320129","html_url":"https://github.com/apache/couchdb/pull/1346#issuecomment-393320129","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1346","id":393320129,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzMyMDEyOQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T21:09:11Z","updated_at":"2018-05-30T21:09:11Z","author_association":"CONTRIBUTOR","body":"Noticed a transitive dependency on bisect:\r\n\r\n```\r\n(HEAD detached at CouchDB-2.2.0)) $ more rebar.config\r\n{cover_enabled, true}.\r\n{deps, [\r\n        {bisect, \"\",\r\n         {git, \"https://github.com/knutin/bisect.git\", {branch, \"master\"}}}\r\n       ]}.\r\n```\r\n\r\nWhich brings in proper master dependency, which fails to compile on R16. However the good news is we don't use the bisect backend just the default (binary one). So I think we can make a branch on our version of hyper to exclude bisect and it should be good.\r\n\r\nAnother one might be to avoid building carray C module (since we don't use it) but that's optional.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393320129/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393324992","html_url":"https://github.com/apache/couchdb/issues/1353#issuecomment-393324992","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1353","id":393324992,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzMyNDk5Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T21:26:35Z","updated_at":"2018-05-30T21:26:35Z","author_association":"MEMBER","body":"A concern about changing the defaults with this work is that, for <2.2.0 Couches replicating against a 2.2.0 Couch, replication will be very very slow. The workaround is to mediate the replication on the 2.2.0+ cluster, or to upgrade the remote node, whichever is easier. A last-ditch is to reduce the iterations/rounds on the 2.2.0+ cluster if necessary.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393324992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393328588","html_url":"https://github.com/apache/couchdb/issues/1354#issuecomment-393328588","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1354","id":393328588,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzMyODU4OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T21:39:56Z","updated_at":"2018-05-30T21:39:56Z","author_association":"MEMBER","body":"Please see https://github.com/apache/couchdb-docker#important-notes-latest2x .","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393328588/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393331453","html_url":"https://github.com/apache/couchdb/issues/1354#issuecomment-393331453","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1354","id":393331453,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzMzMTQ1Mw==","user":{"login":"JohnOllhorn","id":28832014,"node_id":"MDQ6VXNlcjI4ODMyMDE0","avatar_url":"https://avatars.githubusercontent.com/u/28832014?v=4","gravatar_id":"","url":"https://api.github.com/users/JohnOllhorn","html_url":"https://github.com/JohnOllhorn","followers_url":"https://api.github.com/users/JohnOllhorn/followers","following_url":"https://api.github.com/users/JohnOllhorn/following{/other_user}","gists_url":"https://api.github.com/users/JohnOllhorn/gists{/gist_id}","starred_url":"https://api.github.com/users/JohnOllhorn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JohnOllhorn/subscriptions","organizations_url":"https://api.github.com/users/JohnOllhorn/orgs","repos_url":"https://api.github.com/users/JohnOllhorn/repos","events_url":"https://api.github.com/users/JohnOllhorn/events{/privacy}","received_events_url":"https://api.github.com/users/JohnOllhorn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T21:50:52Z","updated_at":"2018-05-30T21:51:03Z","author_association":"NONE","body":"So CouchDB is no longer a single node to operate? But that contradicts the documentation? Ask for something more specific...\r\n[http://docs.couchdb.org/en/master/install/setup.html](http://docs.couchdb.org/en/master/install/setup.html)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393331453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393333006","html_url":"https://github.com/apache/couchdb/pull/1346#issuecomment-393333006","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1346","id":393333006,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzMzMzAwNg==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T21:56:59Z","updated_at":"2018-05-30T21:56:59Z","author_association":"MEMBER","body":"Good catch @nickva I totally missed that dependency. Have removed it now. Left the carray to minimize the fork from upstream.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393333006/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393334462","html_url":"https://github.com/apache/couchdb/issues/1354#issuecomment-393334462","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1354","id":393334462,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzMzNDQ2Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T22:02:46Z","updated_at":"2018-05-30T22:02:46Z","author_association":"MEMBER","body":"Yes you can run it in single node mode, but you have to create the _users and _replicator databases yourself. The Docker image works both in single node and cluster mode, which is why the final configuration is up to you.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393334462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393337144","html_url":"https://github.com/apache/couchdb/issues/1354#issuecomment-393337144","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1354","id":393337144,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzMzNzE0NA==","user":{"login":"JohnOllhorn","id":28832014,"node_id":"MDQ6VXNlcjI4ODMyMDE0","avatar_url":"https://avatars.githubusercontent.com/u/28832014?v=4","gravatar_id":"","url":"https://api.github.com/users/JohnOllhorn","html_url":"https://github.com/JohnOllhorn","followers_url":"https://api.github.com/users/JohnOllhorn/followers","following_url":"https://api.github.com/users/JohnOllhorn/following{/other_user}","gists_url":"https://api.github.com/users/JohnOllhorn/gists{/gist_id}","starred_url":"https://api.github.com/users/JohnOllhorn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JohnOllhorn/subscriptions","organizations_url":"https://api.github.com/users/JohnOllhorn/orgs","repos_url":"https://api.github.com/users/JohnOllhorn/repos","events_url":"https://api.github.com/users/JohnOllhorn/events{/privacy}","received_events_url":"https://api.github.com/users/JohnOllhorn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-30T22:14:35Z","updated_at":"2018-05-30T22:14:54Z","author_association":"NONE","body":"yes and was I written in the title? I have created all databases by hand but the error messages persist.\r\n\r\nIn the Fauxton App I also see all the databases and after a reboot, they are still available.\r\n\r\n```\r\n\r\n_dbs | 4.1 KB | 0 |  \r\n-- | -- | -- | --\r\n_global_changes | 4.1 KB | 0 |  \r\n_metadata | 4.1 KB | 0 |  \r\n_nodes | 250 bytes | 1 |  \r\n_replicator | 2.3 KB | 1 |  \r\n_users | 2.1 KB | 1 |  \r\n\r\n\r\n```\r\n\r\nWhen I verify the installation, all the tests are successful, yet after the successful feedback I get an \"Error: undef\".\r\n\r\nPlease help me with the debugging, I try today to bring the whole day couch to run, but all Issuse or instructions are not helpful!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393337144/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393389348","html_url":"https://github.com/apache/couchdb/issues/1354#issuecomment-393389348","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1354","id":393389348,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzM4OTM0OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T03:22:37Z","updated_at":"2018-05-31T03:22:37Z","author_association":"MEMBER","body":"You're using the wrong port if you can see _dbs as the database. Do not use port 5986 for anything other than what the documentation specifically tells you to do. **Use port 5984 exclusively.**\r\n\r\nHere is what I see locally when starting from scratch. In one window:\r\n\r\n```\r\n$ mkdir ~/data\r\n$ docker run -p 5984:5984 --volume ~/data:/opt/couchdb/data --env COUCHDB_USER=admin --env COUCHDB_PASSWORD=password apache/couchdb:2.1.1\r\n...\r\n\r\n[info] 2018-05-31T03:18:18.300289Z nonode@nohost <0.7.0> -------- Application couch_log started on node nonode@nohost\r\n[info] 2018-05-31T03:18:18.315246Z nonode@nohost <0.7.0> -------- Application folsom started on node nonode@nohost\r\n[info] 2018-05-31T03:18:18.413655Z nonode@nohost <0.7.0> -------- Application couch_stats started on node nonode@nohost\r\n[info] 2018-05-31T03:18:18.413994Z nonode@nohost <0.7.0> -------- Application khash started on node nonode@nohost\r\n[info] 2018-05-31T03:18:18.439314Z nonode@nohost <0.7.0> -------- Application couch_event started on node nonode@nohost\r\n[info] 2018-05-31T03:18:18.457026Z nonode@nohost <0.7.0> -------- Application ibrowse started on node nonode@nohost\r\n[info] 2018-05-31T03:18:18.470989Z nonode@nohost <0.7.0> -------- Application ioq started on node nonode@nohost\r\n[info] 2018-05-31T03:18:18.471257Z nonode@nohost <0.7.0> -------- Application mochiweb started on node nonode@nohost\r\n[info] 2018-05-31T03:18:18.494670Z nonode@nohost <0.195.0> -------- Apache CouchDB 2.1.1 is starting.\r\n...\r\n```\r\n\r\nIn another window, after startup:\r\n\r\n```\r\n$ curl localhost:5984\r\n{\"couchdb\":\"Welcome\",\"version\":\"2.1.1\",\"features\":[\"scheduler\"],\"vendor\":{\"name\":\"The Apache Software Foundation\"}}\r\n$ curl -X PUT http://admin:password@localhost:5984/_users\r\n{\"ok\":true}\r\n$ curl -X PUT http://admin:password@localhost:5984/_replicator\r\n{\"ok\":true}\r\n$ curl -X PUT http://admin:password@localhost:5984/_global_changes\r\n{\"ok\":true}\r\n```\r\n\r\nIn the first window, the errors stop as soon as I complete the above:\r\n\r\n```\r\n[notice] 2018-05-31T03:19:04.990455Z nonode@nohost <0.326.0> -------- chttpd_auth_cache changes listener died database_does_not_exist at mem3_shards:load_shards_from_db/6(line:403) <= mem3_shards:load_shards_from_disk/1(line:378) <= mem3_shards:load_shards_from_disk/2(line:407) <= mem3_shards:for_docid/3(line:91) <= fabric_doc_open:go/3(line:38) <= chttpd_auth_cache:ensure_auth_ddoc_exists/2(line:187) <= chttpd_auth_cache:listen_for_changes/1(line:134)\r\n[error] 2018-05-31T03:19:09.991602Z nonode@nohost emulator -------- Error in process <0.1209.0> with exit value: {database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,378}]},{mem3_shards,load_shards_from_disk...\r\n[notice] 2018-05-31T03:19:09.991792Z nonode@nohost <0.326.0> -------- chttpd_auth_cache changes listener died database_does_not_exist at mem3_shards:load_shards_from_db/6(line:403) <= mem3_shards:load_shards_from_disk/1(line:378) <= mem3_shards:load_shards_from_disk/2(line:407) <= mem3_shards:for_docid/3(line:91) <= fabric_doc_open:go/3(line:38) <= chttpd_auth_cache:ensure_auth_ddoc_exists/2(line:187) <= chttpd_auth_cache:listen_for_changes/1(line:134)\r\n[error] 2018-05-31T03:19:14.992742Z nonode@nohost emulator -------- Error in process <0.1275.0> with exit value: {database_does_not_exist,[{mem3_shards,load_shards_from_db,\"_users\",[{file,\"src/mem3_shards.erl\"},{line,403}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,378}]},{mem3_shards,load_shards_from_disk...\r\n[notice] 2018-05-31T03:19:14.992886Z nonode@nohost <0.326.0> -------- chttpd_auth_cache changes listener died database_does_not_exist at mem3_shards:load_shards_from_db/6(line:403) <= mem3_shards:load_shards_from_disk/1(line:378) <= mem3_shards:load_shards_from_disk/2(line:407) <= mem3_shards:for_docid/3(line:91) <= fabric_doc_open:go/3(line:38) <= chttpd_auth_cache:ensure_auth_ddoc_exists/2(line:187) <= chttpd_auth_cache:listen_for_changes/1(line:134)\r\n[error] 2018-05-31T03:19:16.994711Z nonode@nohost <0.1276.0> c9f97e1670 Request to create N=3 DB but only 1 node(s)\r\n[notice] 2018-05-31T03:19:17.057156Z nonode@nohost <0.1276.0> c9f97e1670 localhost:5984 172.17.0.1 admin PUT /_users 201 ok 94\r\n[error] 2018-05-31T03:19:19.940483Z nonode@nohost <0.1361.0> aa67a941ed Request to create N=3 DB but only 1 node(s)\r\n[notice] 2018-05-31T03:19:19.953376Z nonode@nohost <0.461.0> -------- creating replicator ddoc <<\"shards/80000000-9fffffff/_replicator.1527736759\">>\r\n[notice] 2018-05-31T03:19:19.960056Z nonode@nohost <0.1361.0> aa67a941ed localhost:5984 172.17.0.1 admin PUT /_replicator 201 ok 21\r\n[error] 2018-05-31T03:19:28.679148Z nonode@nohost <0.1582.0> 3d9b9d04d6 Request to create N=3 DB but only 1 node(s)\r\n[notice] 2018-05-31T03:19:28.698094Z nonode@nohost <0.1582.0> 3d9b9d04d6 localhost:5984 172.17.0.1 admin PUT /_global_changes 201 ok 20\r\n```\r\n\r\nand then silence until I start my next command.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393389348/reactions","total_count":34,"+1":20,"-1":0,"laugh":0,"hooray":5,"confused":0,"heart":9,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393394093","html_url":"https://github.com/apache/couchdb/issues/1355#issuecomment-393394093","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1355","id":393394093,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzM5NDA5Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T03:57:43Z","updated_at":"2018-05-31T03:58:10Z","author_association":"MEMBER","body":"Interestingly, this issue goes all the way back to [COUCHDB-1530](https://issues.apache.org/jira/browse/COUCHDB-1530?), aka \"Add a mode to _all_docs to include deleted docs\". In that issue @davisp was +1 on the idea.\r\n\r\nRight now the only way to get a list of tombstones in a DB is to pull the changes feed and filter on **_deleted:true**.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393394093/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393420313","html_url":"https://github.com/apache/couchdb/issues/1357#issuecomment-393420313","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1357","id":393420313,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzQyMDMxMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T06:24:55Z","updated_at":"2018-05-31T06:24:55Z","author_association":"MEMBER","body":"Another instance of this shows a different context, showing `fabric_doc_update:handle_message/3` is involved:\r\n\r\n```\r\n[error] 2018-05-28T07:14:47.811000Z couchdb@node1 <0.17814.1427> a2ea50334d rpc couch_db:update_docs/4 function_clause [{couch_btree,lookup,[undefined,[<<\"a05950b921d13c0139294de524926b87\">>]],[{file,\"src/couch_btree.erl\"},{line,269}]},{couch_db,up\r\ndate_docs,4,[{file,\"src/couch_db.erl\"},{line,974}]},{fabric_rpc,with_db,3,[{file,\"src/fabric_rpc.erl\"},{line,284}]},{rexi_server,init_p,3,[{file,\"src/rexi_server.erl\"},{line,139}]}]\r\n[error] 2018-05-28T07:14:47.811000Z couchdb@node1 <0.12790.1381> a2ea50334d req_err(3462017963) unknown_error : function_clause\r\n    [<<\"fabric_doc_update:handle_message/3 L55\">>,<<\"rexi_utils:process_mailbox/6 L55\">>,<<\"fabric_doc_update:go/3 L39\">>,<<\"fabric:update_docs/3 L259\">>,<<\"fabric:update_doc/3 L239\">>,<<\"chttpd_db:db_req/2 L356\">>,<<\"chttpd:process_request/1 L295\">>,<<\"c\r\nhttpd:handle_request_int/1 L231\">>]\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393420313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393423523","html_url":"https://github.com/apache/couchdb/issues/1357#issuecomment-393423523","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1357","id":393423523,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzQyMzUyMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T06:37:00Z","updated_at":"2018-05-31T06:37:00Z","author_association":"MEMBER","body":"Another instance of this shows yet another context, `fabric_doc_open_revs:handle_message/3`:\r\n\r\n```\r\n[error] 2018-05-28T07:14:37.263000Z couchdb@node1 <0.12.1403> 0f8ce984ef rpc couch_db:open_doc_revs/4 function_clause [{couch_btree,lookup,[undefined,[<<\"ID\">>]],[{file,\"src/couch_btree.erl\"},{line,269}]},{couch_db,ope\r\nn_doc_revs_int,3,[{file,\"src/couch_db.erl\"},{line,1312}]},{couch_db,open_doc_revs,4,[{file,\"src/couch_db.erl\"},{line,238}]},{fabric_rpc,with_db,3,[{file,\"src/fabric_rpc.erl\"},{line,284}]},{rexi_server,init_p,3,[{file,\"src/rexi_server.erl\"},{line,139}]}]\r\n[error] 2018-05-28T07:14:37.279000Z couchdb@node1 <0.25393.1421> 0f8ce984ef req_err(496170674) unknown_error : function_clause\r\n    [<<\"fabric_doc_open_revs:handle_message/3 L64\">>,<<\"rexi_utils:process_mailbox/6 L55\">>,<<\"rexi_utils:recv/6 L49\">>,<<\"fabric_doc_open_revs:go/4 L49\">>,<<\"chttpd_db:db_doc_req/3 L676\">>,<<\"chttpd:process_request/1 L295\">>,<<\"chttpd:handle_request_int/\r\n1 L231\">>,<<\"mochiweb_http:headers/6 L91\">>]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393423523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393428585","html_url":"https://github.com/apache/couchdb/issues/1360#issuecomment-393428585","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1360","id":393428585,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzQyODU4NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T06:59:51Z","updated_at":"2018-05-31T06:59:51Z","author_association":"MEMBER","body":"Duplicate of #1356.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393428585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393491490","html_url":"https://github.com/apache/couchdb/issues/1335#issuecomment-393491490","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1335","id":393491490,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzQ5MTQ5MA==","user":{"login":"taicao88","id":39483774,"node_id":"MDQ6VXNlcjM5NDgzNzc0","avatar_url":"https://avatars.githubusercontent.com/u/39483774?v=4","gravatar_id":"","url":"https://api.github.com/users/taicao88","html_url":"https://github.com/taicao88","followers_url":"https://api.github.com/users/taicao88/followers","following_url":"https://api.github.com/users/taicao88/following{/other_user}","gists_url":"https://api.github.com/users/taicao88/gists{/gist_id}","starred_url":"https://api.github.com/users/taicao88/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taicao88/subscriptions","organizations_url":"https://api.github.com/users/taicao88/orgs","repos_url":"https://api.github.com/users/taicao88/repos","events_url":"https://api.github.com/users/taicao88/events{/privacy}","received_events_url":"https://api.github.com/users/taicao88/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T10:45:43Z","updated_at":"2018-05-31T10:45:43Z","author_association":"NONE","body":"Dear Vohali\r\n\r\n{\"value\":7258,\"type\":\"counter\",\"desc\":\"number of HTTP requests\"}\r\n\r\ncan't get value current only show sum value in 2.1.1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393491490/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393547348","html_url":"https://github.com/apache/couchdb/issues/782#issuecomment-393547348","issue_url":"https://api.github.com/repos/apache/couchdb/issues/782","id":393547348,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzU0NzM0OA==","user":{"login":"touy","id":122671,"node_id":"MDQ6VXNlcjEyMjY3MQ==","avatar_url":"https://avatars.githubusercontent.com/u/122671?v=4","gravatar_id":"","url":"https://api.github.com/users/touy","html_url":"https://github.com/touy","followers_url":"https://api.github.com/users/touy/followers","following_url":"https://api.github.com/users/touy/following{/other_user}","gists_url":"https://api.github.com/users/touy/gists{/gist_id}","starred_url":"https://api.github.com/users/touy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/touy/subscriptions","organizations_url":"https://api.github.com/users/touy/orgs","repos_url":"https://api.github.com/users/touy/repos","events_url":"https://api.github.com/users/touy/events{/privacy}","received_events_url":"https://api.github.com/users/touy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T14:23:44Z","updated_at":"2018-05-31T14:23:44Z","author_association":"NONE","body":"it seems this is a big disadvantage for couchdb , I use use websocket nodeJS, when user double click the link to request and write some log , 2  clicks have the same _rev , which I think I have slow down the system ? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393547348/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393558205","html_url":"https://github.com/apache/couchdb/issues/1363#issuecomment-393558205","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1363","id":393558205,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzU1ODIwNQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T14:56:27Z","updated_at":"2018-05-31T14:56:27Z","author_association":"CONTRIBUTOR","body":"That looks like the state from replication worker. We have a `format_status` callback defined there so it should format the state properly and strip the creds from the url\r\n\r\nhttps://github.com/apache/couchdb/commit/bb74b168e2cd48adccfa826d58d0b57297e4c0a9\r\n\r\nI don't think that made into a release yet? (Mar 14, 2018)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393558205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393574712","html_url":"https://github.com/apache/couchdb/issues/782#issuecomment-393574712","issue_url":"https://api.github.com/repos/apache/couchdb/issues/782","id":393574712,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzU3NDcxMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T15:43:02Z","updated_at":"2018-05-31T15:43:02Z","author_association":"MEMBER","body":"@touy If you don't use what the previous poster said, your situation won't create 2 revisions, because the documents are identical and your 2 versions would both be updating with the same prior _rev value. So only one new revision will be created.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393574712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393574860","html_url":"https://github.com/apache/couchdb/issues/1363#issuecomment-393574860","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1363","id":393574860,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzU3NDg2MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T15:43:23Z","updated_at":"2018-05-31T15:43:23Z","author_association":"MEMBER","body":"Great, so this is fixed. Appreciate it :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393574860/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393577347","html_url":"https://github.com/apache/couchdb/issues/1335#issuecomment-393577347","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1335","id":393577347,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzU3NzM0Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T15:49:08Z","updated_at":"2018-05-31T15:49:08Z","author_association":"MEMBER","body":"```\r\n$ curl localhost:15984/_node/_local/_stats | jq .couchdb.httpd.requests\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100 13920  100 13920    0     0   937k      0 --:--:-- --:--:-- --:--:--  970k\r\n{\r\n  \"value\": 17,\r\n  \"type\": \"counter\",\r\n  \"desc\": \"number of HTTP requests\"\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393577347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393609178","html_url":"https://github.com/apache/couchdb/pull/1346#issuecomment-393609178","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1346","id":393609178,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzYwOTE3OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T17:24:43Z","updated_at":"2018-05-31T17:24:43Z","author_association":"CONTRIBUTOR","body":"Added some tests for this feature: https://github.com/apache/couchdb/pull/1364","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393609178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393610396","html_url":"https://github.com/apache/couchdb/pull/1346#issuecomment-393610396","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1346","id":393610396,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzYxMDM5Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T17:28:33Z","updated_at":"2018-05-31T17:28:33Z","author_association":"CONTRIBUTOR","body":"A small PR to add hyper to top level `.gitignore` file: https://github.com/apache/couchdb/pull/1365","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393610396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393693038","html_url":"https://github.com/apache/couchdb/issues/1338#issuecomment-393693038","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1338","id":393693038,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzY5MzAzOA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-05-31T21:53:45Z","updated_at":"2018-05-31T21:53:45Z","author_association":"CONTRIBUTOR","body":"I like the idea. It could allow for interesting configurations. Here are some thoughts I had:\r\n\r\n1. `replicator` - This would work trivially for _replicator jobs because they are not tied a particular replicator document and placement is based on hashing source, target and a few other parameters. There just getting the replicator node set would be good enough. However things become more complicated for replications backed by a replicator db. Currently ownership (placement) of a replication job is determined by where the replicator doc shards live, such that state updates (completed, failed etc) happen as local doc writes. If some nodes can accept document writes but not be replicator nodes, would mean that some replications would never be able to run. We could fix it in a couple of ways:\r\n\r\n  - Allow non-local doc IO. So let replicator doc updates / reads happen remotely and distribute replication jobs based on a replication ID instead of document ID. Then only the replicator nodes would run replications. But with remove doc IO this would introduce new failure modes.\r\n\r\n - `_replicator` db shards placement is customized such that _replicator docs end up only on replicator nodes. This might work but not sure what would happen when replicator node set changes (a node stops being a replicator node). Then might need to do auto-migration of replicator shards\r\n\r\n2. `coordinator` vs `storage`. This would be great to have. Maybe the coordinator ones could have more CPU but less memory or other such hardware customizations. \r\n\r\nIt is also interesting to think about what happens during membership changes. That is in the period of time during and immediately after a node changes its membership. A bit like the case with a replicator above. But say if a node becomes a storage node, then stops being a storage node. Does all data it stored auto-migrate to other storage nodes and what happens during that transition. That would be great to have, and it would open the door to auto-resharding (but that's for a different discussion).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393693038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393783475","html_url":"https://github.com/apache/couchdb/issues/1335#issuecomment-393783475","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1335","id":393783475,"node_id":"MDEyOklzc3VlQ29tbWVudDM5Mzc4MzQ3NQ==","user":{"login":"taicao88","id":39483774,"node_id":"MDQ6VXNlcjM5NDgzNzc0","avatar_url":"https://avatars.githubusercontent.com/u/39483774?v=4","gravatar_id":"","url":"https://api.github.com/users/taicao88","html_url":"https://github.com/taicao88","followers_url":"https://api.github.com/users/taicao88/followers","following_url":"https://api.github.com/users/taicao88/following{/other_user}","gists_url":"https://api.github.com/users/taicao88/gists{/gist_id}","starred_url":"https://api.github.com/users/taicao88/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taicao88/subscriptions","organizations_url":"https://api.github.com/users/taicao88/orgs","repos_url":"https://api.github.com/users/taicao88/repos","events_url":"https://api.github.com/users/taicao88/events{/privacy}","received_events_url":"https://api.github.com/users/taicao88/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-01T07:03:25Z","updated_at":"2018-06-01T07:03:25Z","author_association":"NONE","body":"Dear Wohali, \r\n\r\nHow to get the same below\r\n\r\n\"httpd\": {\r\n  \"requests\": {\r\n    \"description\": \"number of HTTP requests\",\r\n    \"current\": 191458567.0,\r\n    \"sum\": 191458567.0,\r\n    \"mean\": 71.150999999999996248,\r\n    \"stddev\": 102.38500000000000512,\r\n    \"min\": 0,\r\n    \"max\": 1197\r\n  }\r\n}","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393783475/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393945122","html_url":"https://github.com/apache/couchdb/issues/1335#issuecomment-393945122","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1335","id":393945122,"node_id":"MDEyOklzc3VlQ29tbWVudDM5Mzk0NTEyMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-01T17:04:56Z","updated_at":"2018-06-01T17:04:56Z","author_association":"MEMBER","body":"current and sum are the same. You have to calculate the rest yourself. In a CouchDB 2.x cluster these are better gathered at the load balancer.\r\n\r\na much more valuable statistic for performance management is the httpd.request_time section which includes all the types of measures you're asking for, but on how long it takes CouchDB to respond for each particular request.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393945122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393958394","html_url":"https://github.com/apache/couchdb/pull/1370#issuecomment-393958394","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1370","id":393958394,"node_id":"MDEyOklzc3VlQ29tbWVudDM5Mzk1ODM5NA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-01T17:48:14Z","updated_at":"2018-06-01T17:48:14Z","author_association":"MEMBER","body":"Also of note, I highly recommend moving through this PR a commit at a time as its quite big and the commits are specifically written to try and separate out all of the major changes to ease review.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/393958394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394191191","html_url":"https://github.com/apache/couchdb/issues/1371#issuecomment-394191191","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1371","id":394191191,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDE5MTE5MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-03T21:04:38Z","updated_at":"2018-06-03T21:04:38Z","author_association":"MEMBER","body":"This appears to have been fixed on master (which will become the 2.2.0 release):\r\n\r\n```\r\n# Create the database and 3 documents\r\n$ curl -X PUT localhost:15984/db\r\n{\"ok\":true}\r\n$ curl -X PUT localhost:15984/db/1 -d '{ \"a\": \"1970-01-01\", \"b\": 1, \"c\": \"xxx\" }'\r\n{\"ok\":true,\"id\":\"1\",\"rev\":\"1-5455dc18ba50b873f80d08b786882d75\"}\r\n$ curl -X PUT localhost:15984/db/2 -d '{ \"a\": \"1970-01-02\", \"b\": 2, \"c\": \"yyy\" }'\r\n{\"ok\":true,\"id\":\"2\",\"rev\":\"1-929563268787e16b961a44c66bc502be\"}\r\n$ curl -X PUT localhost:15984/db/3 -d '{ \"a\": \"1970-01-03\", \"b\": 1, \"c\": \"zzz\" }'\r\n{\"ok\":true,\"id\":\"3\",\"rev\":\"1-9f54d5b98444b17b4b80497fce915428\"}\r\n$\r\n\r\n# Now we create the index\r\n$ curl -X POST -H \"Content-Type: application/json\" localhost:15984/db/_index -d '{\r\n   \"index\": {\r\n      \"fields\": [\r\n         \"a\"\r\n      ]\r\n   },\r\n   \"name\": \"a-index\",\r\n   \"type\": \"json\"\r\n}'\r\n{\"result\":\"created\",\"id\":\"_design/2b836b080d41d5929e6cf097a1364826f34f60bd\",\"name\":\"a-index\"}\r\n$ curl localhost:15984/db/_design/2b836b080d41d5929e6cf097a1364826f34f60bd\r\n{\"_id\":\"_design/2b836b080d41d5929e6cf097a1364826f34f60bd\",\"_rev\":\"1-583b3550340ed86a26f2c7b83b1f9625\",\"language\":\"query\",\"views\":{\"a-index\":{\"map\":{\"fields\":{\"a\":\"asc\"},\"partial_filter_selector\":{}},\"reduce\":\"_count\",\"options\":{\"def\":{\"fields\":[\"a\"]}}}}}\r\n\r\n# Now we POST to explain:\r\ncurl -X POST -H \"Content-Type: application/json\" localhost:15984/db/_explain -d '{\r\n  \"selector\": {\r\n    \"a\": {\r\n      \"$gte\": \"1970-01-01\",\r\n      \"$lt\": \"1970-01-31\"\r\n    },\r\n    \"b\": 1\r\n  }\r\n}' | jq .\r\n{\r\n  \"dbname\": \"db\",\r\n  \"index\": {\r\n    \"ddoc\": \"_design/2b836b080d41d5929e6cf097a1364826f34f60bd\",\r\n    \"name\": \"a-index\",\r\n    \"type\": \"json\",\r\n    \"def\": {\r\n      \"fields\": [\r\n        {\r\n          \"a\": \"asc\"\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  \"selector\": {\r\n    \"$and\": [\r\n      {\r\n        \"$and\": [\r\n          {\r\n            \"a\": {\r\n              \"$gte\": \"1970-01-01\"\r\n            }\r\n          },\r\n          {\r\n            \"a\": {\r\n              \"$lt\": \"1970-01-31\"\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"b\": {\r\n          \"$eq\": 1\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"opts\": {\r\n    \"use_index\": [],\r\n    \"bookmark\": \"nil\",\r\n    \"limit\": 25,\r\n    \"skip\": 0,\r\n    \"sort\": {},\r\n    \"fields\": \"all_fields\",\r\n    \"r\": [\r\n      49\r\n    ],\r\n    \"conflicts\": false,\r\n    \"stale\": false,\r\n    \"update\": true,\r\n    \"stable\": false,\r\n    \"execution_stats\": false\r\n  },\r\n  \"limit\": 25,\r\n  \"skip\": 0,\r\n  \"fields\": \"all_fields\",\r\n  \"mrargs\": {\r\n    \"include_docs\": true,\r\n    \"view_type\": \"map\",\r\n    \"reduce\": false,\r\n    \"start_key\": [\r\n      \"1970-01-01\"\r\n    ],\r\n    \"end_key\": [\r\n      \"1970-01-31\",\r\n      \"<MAX>\"\r\n    ],\r\n    \"direction\": \"fwd\",\r\n    \"stable\": false,\r\n    \"update\": true\r\n  }\r\n}\r\n```\r\n\r\nThe reason might be because of #1014 (you have an implicit and).\r\n\r\nYou'll see this fix with the release of 2.2.0.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394191191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394331162","html_url":"https://github.com/apache/couchdb/issues/1218#issuecomment-394331162","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1218","id":394331162,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDMzMTE2Mg==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-04T12:04:09Z","updated_at":"2018-06-04T12:04:09Z","author_association":"MEMBER","body":"@tiangolo I can't reproduce this issue on CouchDB master. We have made some fixes to mango and I think we have resolved this issue. If possible could you test against CouchDB master to see if you can reproduce. \r\n\r\nI'm going to close this issue. Please reopen it if you can reproduce it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394331162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394331471","html_url":"https://github.com/apache/couchdb/issues/1324#issuecomment-394331471","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1324","id":394331471,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDMzMTQ3MQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-04T12:05:33Z","updated_at":"2018-06-04T12:05:33Z","author_association":"MEMBER","body":"This is a nice idea. The big thing is what do we want to log without exposing too much user information? Would logging the fields in the selector without the values be ok?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394331471/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394434081","html_url":"https://github.com/apache/couchdb/issues/1372#issuecomment-394434081","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1372","id":394434081,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDQzNDA4MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-04T17:26:56Z","updated_at":"2018-06-04T17:26:56Z","author_association":"MEMBER","body":"This is a limitation of integers in JavaScript/JSON, and is not limited to CouchDB. For instance, if I open the console in my Firefox 60.0.1 browser:\r\n\r\n```\r\nq = 369553424691494913\r\n369553424691494900\r\nq\r\n369553424691494900\r\n```\r\n\r\nIf you want to ensure the number is stored verbatim, store it as a string, and perform string-to-long-integer conversion in your application.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394434081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394529767","html_url":"https://github.com/apache/couchdb/pull/1346#issuecomment-394529767","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1346","id":394529767,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDUyOTc2Nw==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-04T23:15:59Z","updated_at":"2018-06-04T23:15:59Z","author_association":"MEMBER","body":"So I realized we have one issue we need to discuss here: collation. The reduce function is inserting each key into the filter using a regular old `term_to_binary(Key)`, so it will (incorrectly) treat two keys that are not identical but compare equal in ICU as distinct keys in its computation. I see a handful of paths that we could take:\r\n\r\n1. Force the user to set `\"collation\": \"raw\"` in the design document options in order to use this reducer.\r\n2. Merge this feature as-is and hide behind the \"approximate\" nature of the computation, documenting that it may overestimate the number of distinct keys by more than the stated uncertainty in the presence of such keys.\r\n3. Compute a \"canonical form\" for each key and insert that into the filter instead. I don't even know if that's possible.\r\n\r\nMy initial preference is for Option 2 but I wanted to bring this up before merging to see if others have strong opinions.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394529767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394555963","html_url":"https://github.com/apache/couchdb/issues/1293#issuecomment-394555963","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1293","id":394555963,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDU1NTk2Mw==","user":{"login":"PlaidShirt","id":6610536,"node_id":"MDQ6VXNlcjY2MTA1MzY=","avatar_url":"https://avatars.githubusercontent.com/u/6610536?v=4","gravatar_id":"","url":"https://api.github.com/users/PlaidShirt","html_url":"https://github.com/PlaidShirt","followers_url":"https://api.github.com/users/PlaidShirt/followers","following_url":"https://api.github.com/users/PlaidShirt/following{/other_user}","gists_url":"https://api.github.com/users/PlaidShirt/gists{/gist_id}","starred_url":"https://api.github.com/users/PlaidShirt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PlaidShirt/subscriptions","organizations_url":"https://api.github.com/users/PlaidShirt/orgs","repos_url":"https://api.github.com/users/PlaidShirt/repos","events_url":"https://api.github.com/users/PlaidShirt/events{/privacy}","received_events_url":"https://api.github.com/users/PlaidShirt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-05T01:58:31Z","updated_at":"2018-06-05T02:05:52Z","author_association":"NONE","body":"I seem to have run into this problem as well.  Are there any workarounds for it?  I've looked at downgrading my js install but that doesn't seem to be a viable option on this particular machine.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394555963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394566761","html_url":"https://github.com/apache/couchdb/issues/1293#issuecomment-394566761","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1293","id":394566761,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDU2Njc2MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-05T03:06:59Z","updated_at":"2018-06-05T03:06:59Z","author_association":"MEMBER","body":"Pin to version 19 of the js library, or wait for our updated packages that remove the dependency on the OS provided js-1.8.5 package.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394566761/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394733528","html_url":"https://github.com/apache/couchdb/issues/1293#issuecomment-394733528","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1293","id":394733528,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDczMzUyOA==","user":{"login":"PlaidShirt","id":6610536,"node_id":"MDQ6VXNlcjY2MTA1MzY=","avatar_url":"https://avatars.githubusercontent.com/u/6610536?v=4","gravatar_id":"","url":"https://api.github.com/users/PlaidShirt","html_url":"https://github.com/PlaidShirt","followers_url":"https://api.github.com/users/PlaidShirt/followers","following_url":"https://api.github.com/users/PlaidShirt/following{/other_user}","gists_url":"https://api.github.com/users/PlaidShirt/gists{/gist_id}","starred_url":"https://api.github.com/users/PlaidShirt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PlaidShirt/subscriptions","organizations_url":"https://api.github.com/users/PlaidShirt/orgs","repos_url":"https://api.github.com/users/PlaidShirt/repos","events_url":"https://api.github.com/users/PlaidShirt/events{/privacy}","received_events_url":"https://api.github.com/users/PlaidShirt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-05T14:36:00Z","updated_at":"2018-06-05T14:36:16Z","author_association":"NONE","body":"Thanks for the fast response!  I was having troubles with getting the package downgraded, but after a full night sleep and caffeine I'm up and running with it pinned.  I'll watch this space for updates.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394733528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394868766","html_url":"https://github.com/apache/couchdb/pull/1346#issuecomment-394868766","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1346","id":394868766,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDg2ODc2Ng==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-05T21:37:29Z","updated_at":"2018-06-05T21:37:29Z","author_association":"CONTRIBUTOR","body":"I am thinking of Option 2 with the documentation note.\r\n\r\nFor Options 3, Erlang 20.0 has a bunch of new normalization functions like say: http://erlang.org/doc/man/unicode.html#characters_to_nfc_binary-1. Maybe recursively transform each key to a normalized format before calling term_to_binary on it? Would that be enough? Even if it is would need to backport the module to Erlang versions < 20.0","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394868766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394891029","html_url":"https://github.com/apache/couchdb/pull/1346#issuecomment-394891029","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1346","id":394891029,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDg5MTAyOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-05T23:20:45Z","updated_at":"2018-06-05T23:20:45Z","author_association":"MEMBER","body":"This would be enough of a reason to start requiring Erlang 20 for me, in say 2.3.0 or 3.0. It could be transparent to the user; if the function is available, use it and improve the accuracy of the response.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394891029/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394912676","html_url":"https://github.com/apache/couchdb/pull/1346#issuecomment-394912676","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1346","id":394912676,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDkxMjY3Ng==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-06T01:41:45Z","updated_at":"2018-06-06T01:41:45Z","author_association":"MEMBER","body":"Very cool, I had forgotten about all of that core unicode work. Definitely a nice future enhancement.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394912676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394917719","html_url":"https://github.com/apache/couchdb/pull/1310#issuecomment-394917719","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1310","id":394917719,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDkxNzcxOQ==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-06T02:14:15Z","updated_at":"2018-06-06T02:14:15Z","author_association":"MEMBER","body":"Thanks @bgottlob ... @davisp do you have any recollection why you weren't pretty-printing these messages back in the day?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394917719/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394924878","html_url":"https://github.com/apache/couchdb/issues/1373#issuecomment-394924878","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1373","id":394924878,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDkyNDg3OA==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-06T03:00:50Z","updated_at":"2018-06-06T03:00:50Z","author_association":"MEMBER","body":"Some comments after musing on this topic for a day:\r\n\r\n- We'll need an interface that keeps the current lazy evaluation behavior so that we're not sitting around generating debug messages that won't get sent. The current printf style is efficient in this respect.\r\n- The reason I'm worried about the above is that a future JSON formatter won't be happy receiving aribtrary Erlang terms, so I was trying to figure out the right place to transform them. Doing it at the point of the logging invocation runs the risk of wasted effort if the log level is set higher.\r\n- We exhumed `lager` from the codebase a few years ago. Why? Was it simply that we thought it was a lot of unnecessary code?\r\n- Erlang 21 adds a new logger inspired by lager: http://erlang.org/documentation/doc-10.0-rc1/lib/kernel-6.0/doc/html/logger_chapter.html. The new Erlang logger does allow for maps and/or key-value lists to be logged directly.\r\n- The legacy error_logger also has the concept of a `report` which is a list of atoms and 2-tuples. A `report` is not necessarily JSON-compatible because each value is an arbitrary term.\r\n\r\nLazy evaluation could be as simple as wrapping every log invocation in a `fun() -> ... end` and only invoking the function once we've checked the log level. That should be efficient and cheap, but probably means reverting to macros instead of direct M:F/A calls ...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/394924878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395173064","html_url":"https://github.com/apache/couchdb/pull/1310#issuecomment-395173064","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1310","id":395173064,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTE3MzA2NA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-06T18:44:04Z","updated_at":"2018-06-06T18:44:04Z","author_association":"MEMBER","body":"Ahh, I probably was thinking one vs multi line and wasn't considering how the ~w format doesn't pretty print strings.\r\n\r\n+1 to switching to ~p","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395173064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395196897","html_url":"https://github.com/apache/couchdb/pull/1376#issuecomment-395196897","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1376","id":395196897,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTE5Njg5Nw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-06T20:07:44Z","updated_at":"2018-06-06T20:07:44Z","author_association":"MEMBER","body":"Also, it seems like normalize_sort_fields and all of the mayb_filter_sort_fields logic should actually be inside each index's implementation module. It seems weird to have special cased those module/index types outside that logic.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395196897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395263060","html_url":"https://github.com/apache/couchdb/pull/1377#issuecomment-395263060","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1377","id":395263060,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTI2MzA2MA==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T01:23:40Z","updated_at":"2018-06-07T01:23:40Z","author_association":"MEMBER","body":"Hah, whoops! That's clearly not right. In general we can't call `rereduce` after `finalize`, and that's exactly what I just caused to happen by adding the finalize call directly to `couch_mrview`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395263060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395272747","html_url":"https://github.com/apache/couchdb/pull/1377#issuecomment-395272747","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1377","id":395272747,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTI3Mjc0Nw==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T02:28:39Z","updated_at":"2018-06-07T02:28:39Z","author_association":"MEMBER","body":"OK I think that's sorted now. Tested both `_stats` and `_approx_count_distinct` on both 5984 and 5986. Not the most elegant thing in the world but I think it's clear enough and won't be too brittle going forward if we should need to do other things around finalizing these reductions.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395272747/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395277484","html_url":"https://github.com/apache/couchdb/pull/1377#issuecomment-395277484","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1377","id":395277484,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTI3NzQ4NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T03:01:01Z","updated_at":"2018-06-07T03:01:01Z","author_association":"MEMBER","body":"dare I ask for automated tests?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395277484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395278681","html_url":"https://github.com/apache/couchdb/pull/1377#issuecomment-395278681","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1377","id":395278681,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTI3ODY4MQ==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T03:09:54Z","updated_at":"2018-06-07T03:09:54Z","author_association":"MEMBER","body":"@wohali not 100% sure what you mean. Travis is running the automated tests for both of those and catching where I've missed something. In this case I missed the fact that `_statsorama` and `_stats\\nare\\nawesome` are apparently valid ways to invoke the `_stats` reduce function . Thanks JChris!\r\n\r\nIf you're saying I ought to run the full test suite locally before opening the PR ... yes OK I need to figure out how to do that. I futzed with the firewall on my laptop a bit and eventually gave up.\r\n\r\nIf you're saying we need to test both 5984 and 5986 as part of the test suite that's probably worth filing an issue.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395278681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395284377","html_url":"https://github.com/apache/couchdb/pull/1377#issuecomment-395284377","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1377","id":395284377,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTI4NDM3Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T03:51:58Z","updated_at":"2018-06-07T03:51:58Z","author_association":"MEMBER","body":"My mistake - I thought this was a new feature (missed that that particular PR already landed) and was looking for tests specific for those new features. If the tests are already in place, no need to add any.\r\n\r\nYeah, that sounds like a useless feature we should remove.\r\n\r\n`make check` should run the full test suite for you, at least on a single Erlang. No need to test against all the various erlangs, Travis can take care of that. Not sure what's up with your laptop if `make check` fails there.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395284377/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395344193","html_url":"https://github.com/apache/couchdb/issues/1378#issuecomment-395344193","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1378","id":395344193,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTM0NDE5Mw==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T08:51:19Z","updated_at":"2018-06-07T08:51:19Z","author_association":"CONTRIBUTOR","body":"Clustered Purge is under development. Hopefully it can help solve your problem once it lands. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395344193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395369426","html_url":"https://github.com/apache/couchdb/issues/546#issuecomment-395369426","issue_url":"https://api.github.com/repos/apache/couchdb/issues/546","id":395369426,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTM2OTQyNg==","user":{"login":"tarasvaskiv","id":32297129,"node_id":"MDQ6VXNlcjMyMjk3MTI5","avatar_url":"https://avatars.githubusercontent.com/u/32297129?v=4","gravatar_id":"","url":"https://api.github.com/users/tarasvaskiv","html_url":"https://github.com/tarasvaskiv","followers_url":"https://api.github.com/users/tarasvaskiv/followers","following_url":"https://api.github.com/users/tarasvaskiv/following{/other_user}","gists_url":"https://api.github.com/users/tarasvaskiv/gists{/gist_id}","starred_url":"https://api.github.com/users/tarasvaskiv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tarasvaskiv/subscriptions","organizations_url":"https://api.github.com/users/tarasvaskiv/orgs","repos_url":"https://api.github.com/users/tarasvaskiv/repos","events_url":"https://api.github.com/users/tarasvaskiv/events{/privacy}","received_events_url":"https://api.github.com/users/tarasvaskiv/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T10:16:10Z","updated_at":"2018-06-07T10:16:10Z","author_association":"NONE","body":"Yeah, I had to download https://launchpad.net/ubuntu/bionic/amd64/libmozjs185-dev/1.8.5-1.0.0+dfsg-7\r\ndeb version from here and install on ubuntu 18.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395369426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395393172","html_url":"https://github.com/apache/couchdb/pull/1377#issuecomment-395393172","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1377","id":395393172,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTM5MzE3Mg==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T11:52:11Z","updated_at":"2018-06-07T11:52:11Z","author_association":"MEMBER","body":"Ah yeah @nickva added JS tests to my original PR for the feature.\r\n\r\nWhen I run `make check` locally it hangs because 3 dialogs pop up asking me to allow incoming network access for the various `beam.smp` processes and then they disappear before I can address them.  I'm sure I'll sort it out eventually.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395393172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395421800","html_url":"https://github.com/apache/couchdb/pull/1377#issuecomment-395421800","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1377","id":395421800,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTQyMTgwMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T13:33:51Z","updated_at":"2018-06-07T13:33:51Z","author_association":"MEMBER","body":"Ah, Little Snitch? Try adding blanket allow rules for it. The new Silent Mode stacks up the notifications so you can review them later, that might work for you.\r\n\r\nhttps://help.obdev.at/littlesnitch/#/intro-opmodes","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395421800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395422101","html_url":"https://github.com/apache/couchdb/issues/1378#issuecomment-395422101","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1378","id":395422101,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTQyMjEwMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T13:34:48Z","updated_at":"2018-06-07T13:34:48Z","author_association":"MEMBER","body":"Duplicate of #1352.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395422101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395422351","html_url":"https://github.com/apache/couchdb/issues/1378#issuecomment-395422351","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1378","id":395422351,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTQyMjM1MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T13:35:34Z","updated_at":"2018-06-07T13:35:34Z","author_association":"MEMBER","body":"As a workaround, you can do a filtered replication to another database that removes the tombstones.\r\n\r\nSee https://eclipsesource.com/blogs/2015/04/20/how-to-finally-delete-documents-in-couchdb/ and especially the comment thread posts by @willholley .","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395422351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395425356","html_url":"https://github.com/apache/couchdb/pull/1376#issuecomment-395425356","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1376","id":395425356,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTQyNTM1Ng==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T13:44:57Z","updated_at":"2018-06-07T13:44:57Z","author_association":"MEMBER","body":"thanks @davisp that was a really helpful review. I've done all the code changes you suggested. I've also moved all the `maybe_filter_sort_fields` into the index implementation modules. \r\n\r\nThe implementation you suggested doesn't work for the case where\r\nwe might have a missing field in the middle of a sort list like [here](https://github.com/apache/couchdb/pull/1376/files#diff-cf1206e8c258c0a911b68eaaf80c8085R157)\r\n\r\nI've also rewritten the explanation in the code. Hopefully that makes more sense. I've also edited the PR explanation above with the same text.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395425356/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395485774","html_url":"https://github.com/apache/couchdb/pull/1376#issuecomment-395485774","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1376","id":395485774,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTQ4NTc3NA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T16:35:54Z","updated_at":"2018-06-07T16:35:54Z","author_association":"MEMBER","body":"@garrensmith I see the PR updated but nothing else. Did you forget to push your local changes?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395485774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395495971","html_url":"https://github.com/apache/couchdb/issues/1171#issuecomment-395495971","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1171","id":395495971,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTQ5NTk3MQ==","user":{"login":"rokek","id":8279528,"node_id":"MDQ6VXNlcjgyNzk1Mjg=","avatar_url":"https://avatars.githubusercontent.com/u/8279528?v=4","gravatar_id":"","url":"https://api.github.com/users/rokek","html_url":"https://github.com/rokek","followers_url":"https://api.github.com/users/rokek/followers","following_url":"https://api.github.com/users/rokek/following{/other_user}","gists_url":"https://api.github.com/users/rokek/gists{/gist_id}","starred_url":"https://api.github.com/users/rokek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rokek/subscriptions","organizations_url":"https://api.github.com/users/rokek/orgs","repos_url":"https://api.github.com/users/rokek/repos","events_url":"https://api.github.com/users/rokek/events{/privacy}","received_events_url":"https://api.github.com/users/rokek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T17:10:02Z","updated_at":"2018-06-07T17:10:02Z","author_association":"CONTRIBUTOR","body":"I like the ideas from @wohali and @nickva about replacing the md5 `crypto:hash` calls with a `couch_util` function that swaps in `erlang:md5` if a compile setting exists.\r\n\r\nWould search/replace of the md5 `crypto:hash` calls be sufficient, or does CouchDB invoke OpenSSL's md5 function in other ways?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395495971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395538949","html_url":"https://github.com/apache/couchdb/pull/1377#issuecomment-395538949","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1377","id":395538949,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTUzODk0OQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-07T19:34:02Z","updated_at":"2018-06-07T19:34:02Z","author_association":"CONTRIBUTOR","body":"One more thing that needs to be done is to include the app in the app dependencies for couch:\r\n\r\nhttps://github.com/apache/couchdb/blob/master/src/couch/src/couch.app.src#L50","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395538949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395653775","html_url":"https://github.com/apache/couchdb/pull/1377#issuecomment-395653775","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1377","id":395653775,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTY1Mzc3NQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-08T05:41:59Z","updated_at":"2018-06-08T05:41:59Z","author_association":"CONTRIBUTOR","body":"PR to add hyper to app dependencies: https://github.com/apache/couchdb/pull/1379","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395653775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395673413","html_url":"https://github.com/apache/couchdb/pull/1379#issuecomment-395673413","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1379","id":395673413,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTY3MzQxMw==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-08T07:25:11Z","updated_at":"2018-06-08T07:25:11Z","author_association":"CONTRIBUTOR","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395673413/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395683859","html_url":"https://github.com/apache/couchdb/issues/1378#issuecomment-395683859","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1378","id":395683859,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTY4Mzg1OQ==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-08T08:08:16Z","updated_at":"2018-06-08T08:08:16Z","author_association":"NONE","body":"@jiangphcn: Thanks, but I thought it would have worked for single node, or am I confusing something? Also when do you think this would be delivered? Thanks again?\r\n@wohali: Thanks but my db is the db of a user created by per user db config, so can't really do that, any other suggestions?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395683859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395687730","html_url":"https://github.com/apache/couchdb/issues/1378#issuecomment-395687730","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1378","id":395687730,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTY4NzczMA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-08T08:22:56Z","updated_at":"2018-06-08T08:22:56Z","author_association":"CONTRIBUTOR","body":"For single node purge, you need to use `couch_db:purge_docs(Db1, [{<<\"doc1\">>, [Rev1]}]).` to purge document. However, you need to stop mem3 to avoid unexpected replication. Also anyway this may cause the rebuild of index. If you can accept these side effects, you can have a try with local node purge. \r\n\r\n@davisp and myself are working on clustered purge and code was under review process.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395687730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395731210","html_url":"https://github.com/apache/couchdb/pull/1379#issuecomment-395731210","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1379","id":395731210,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTczMTIxMA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-08T11:19:35Z","updated_at":"2018-06-08T11:19:35Z","author_association":"CONTRIBUTOR","body":"Thank you!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395731210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395759629","html_url":"https://github.com/apache/couchdb/issues/1378#issuecomment-395759629","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1378","id":395759629,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTc1OTYyOQ==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-08T13:24:38Z","updated_at":"2018-06-08T13:24:38Z","author_association":"NONE","body":"@jiangphcn: Thanks again. Great news, this means it might get shipped with next version? Maybe I am pushing too much, but is there a release date?\r\nAlso I need to mention we are using this via REST API so not familiar with your suggested solution,","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395759629/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395761526","html_url":"https://github.com/apache/couchdb/issues/1378#issuecomment-395761526","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1378","id":395761526,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTc2MTUyNg==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-08T13:31:28Z","updated_at":"2018-06-08T13:31:28Z","author_association":"CONTRIBUTOR","body":"I can't accurately say when it will be released for now because there are multiple factors to decide how long it will take to complete this feature. But it should be available in near future. Also, the clustered purge is also to provide REST API approach for usage. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395761526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395872996","html_url":"https://github.com/apache/couchdb/issues/1278#issuecomment-395872996","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1278","id":395872996,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTg3Mjk5Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-08T19:58:04Z","updated_at":"2018-06-08T19:58:04Z","author_association":"MEMBER","body":"@chewbranca Can we get this PR landed? I think it'd be useful (modulo mike's comments)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395872996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395930250","html_url":"https://github.com/apache/couchdb/issues/1340#issuecomment-395930250","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1340","id":395930250,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTkzMDI1MA==","user":{"login":"adrian1299","id":9442635,"node_id":"MDQ6VXNlcjk0NDI2MzU=","avatar_url":"https://avatars.githubusercontent.com/u/9442635?v=4","gravatar_id":"","url":"https://api.github.com/users/adrian1299","html_url":"https://github.com/adrian1299","followers_url":"https://api.github.com/users/adrian1299/followers","following_url":"https://api.github.com/users/adrian1299/following{/other_user}","gists_url":"https://api.github.com/users/adrian1299/gists{/gist_id}","starred_url":"https://api.github.com/users/adrian1299/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrian1299/subscriptions","organizations_url":"https://api.github.com/users/adrian1299/orgs","repos_url":"https://api.github.com/users/adrian1299/repos","events_url":"https://api.github.com/users/adrian1299/events{/privacy}","received_events_url":"https://api.github.com/users/adrian1299/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-09T01:36:51Z","updated_at":"2018-06-09T01:36:51Z","author_association":"NONE","body":"I have the same problem, I didn't resolve, I need help.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395930250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395985529","html_url":"https://github.com/apache/couchdb/issues/1340#issuecomment-395985529","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1340","id":395985529,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTk4NTUyOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-09T17:24:58Z","updated_at":"2018-06-09T17:24:58Z","author_association":"MEMBER","body":"@adrian1299 see https://github.com/apache/couchdb/issues/1293","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395985529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395985624","html_url":"https://github.com/apache/couchdb/issues/1349#issuecomment-395985624","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1349","id":395985624,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTk4NTYyNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-09T17:26:29Z","updated_at":"2018-06-09T17:26:29Z","author_association":"MEMBER","body":"Again:\r\n\r\nhttps://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/261/pipeline\r\nhttps://couchdb-vm2.apache.org/ci_errorlogs/jenkins-couchdb-261-2018-06-08T21:19:03.407386/couchlog.tar.gz\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/395985624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396127078","html_url":"https://github.com/apache/couchdb/issues/1381#issuecomment-396127078","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1381","id":396127078,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjEyNzA3OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-11T05:35:12Z","updated_at":"2018-06-11T05:35:12Z","author_association":"MEMBER","body":"Currently not built for that.\r\n\r\nPull requests welcome :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396127078/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396302149","html_url":"https://github.com/apache/couchdb/pull/1382#issuecomment-396302149","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1382","id":396302149,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjMwMjE0OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-11T16:23:33Z","updated_at":"2018-06-11T16:23:33Z","author_association":"MEMBER","body":"paging @eiri for PR review please","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396302149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396317550","html_url":"https://github.com/apache/couchdb/issues/1094#issuecomment-396317550","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1094","id":396317550,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjMxNzU1MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-11T17:15:11Z","updated_at":"2018-06-11T17:15:11Z","author_association":"MEMBER","body":"This has been worked around with: https://github.com/apache/couchdb-pkg/commit/066661ec8f0ab7b6e9258c89df695b06a0fe39cf\r\n\r\nWe don't try to extract the port (because a simple grep is challenging), but if we can't auto-create the system databases, we print a warning and tell you to do it yourself now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396317550/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396402134","html_url":"https://github.com/apache/couchdb/issues/1383#issuecomment-396402134","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1383","id":396402134,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjQwMjEzNA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-11T22:04:40Z","updated_at":"2018-06-11T22:04:40Z","author_association":"CONTRIBUTOR","body":"Agreed we need other than a default 5 second timeout there if it ends up doing disk IO\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396402134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396556736","html_url":"https://github.com/apache/couchdb/pull/1382#issuecomment-396556736","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1382","id":396556736,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjU1NjczNg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-12T11:27:31Z","updated_at":"2018-06-12T11:27:31Z","author_association":"MEMBER","body":"@wohali @AlexanderKaraberov Just to let you know, I'll get to it later this week, suffering from a flu right now.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396556736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396807798","html_url":"https://github.com/apache/couchdb/pull/1370#issuecomment-396807798","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1370","id":396807798,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjgwNzc5OA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-13T04:13:04Z","updated_at":"2018-06-13T04:13:04Z","author_association":"CONTRIBUTOR","body":"Thanks @kocolosk for your review. I tried to address most of your comments on commits 01, 02 and 03 in new commit 7e0dabb. Will work on other comments. @davisp hey Paul, feel free to add your response :-) ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396807798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396819176","html_url":"https://github.com/apache/couchdb/pull/1376#issuecomment-396819176","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1376","id":396819176,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjgxOTE3Ng==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-13T05:37:31Z","updated_at":"2018-06-13T05:38:08Z","author_association":"CONTRIBUTOR","body":"You have a great set of tests here. I'll try to think of a scenario tomorrow but was curious about our index selection when multiple indexes exist and how this change affects the index selection. I've seen scenarios where previously incorrect indexes become invalid and we switch to a non-performant, although correct index.  However, this seems like a situation where users can only improve their situation from no_usable_index or all_docs to having a usable index. I'll try to think of a scenario where we possibly don't want this to happen (doubt it but just want to be thorough).","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396819176/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396880236","html_url":"https://github.com/apache/couchdb/pull/1146#issuecomment-396880236","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1146","id":396880236,"node_id":"MDEyOklzc3VlQ29tbWVudDM5Njg4MDIzNg==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-13T09:47:40Z","updated_at":"2018-06-13T09:47:40Z","author_association":"MEMBER","body":"I don't see where this gets hooked in, but I don't like that the erlang is expressed in a macro. I assume the author is following the existing method we use for JS, but that's done out of necessity. Let's pull that erlang into a proper module please. will review again after.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/396880236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397055180","html_url":"https://github.com/apache/couchdb/pull/958#issuecomment-397055180","issue_url":"https://api.github.com/repos/apache/couchdb/issues/958","id":397055180,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzA1NTE4MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-13T19:21:38Z","updated_at":"2018-06-13T19:21:38Z","author_association":"MEMBER","body":"No longer WIP. @nickva @kocolosk Either of you want to take a re-gander at this. Should be a lot simpler now with the property tests and automatic tree repair.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397055180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397079284","html_url":"https://github.com/apache/couchdb/issues/1385#issuecomment-397079284","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1385","id":397079284,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzA3OTI4NA==","user":{"login":"seigel","id":15181,"node_id":"MDQ6VXNlcjE1MTgx","avatar_url":"https://avatars.githubusercontent.com/u/15181?v=4","gravatar_id":"","url":"https://api.github.com/users/seigel","html_url":"https://github.com/seigel","followers_url":"https://api.github.com/users/seigel/followers","following_url":"https://api.github.com/users/seigel/following{/other_user}","gists_url":"https://api.github.com/users/seigel/gists{/gist_id}","starred_url":"https://api.github.com/users/seigel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seigel/subscriptions","organizations_url":"https://api.github.com/users/seigel/orgs","repos_url":"https://api.github.com/users/seigel/repos","events_url":"https://api.github.com/users/seigel/events{/privacy}","received_events_url":"https://api.github.com/users/seigel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-13T20:41:58Z","updated_at":"2018-06-13T20:41:58Z","author_association":"NONE","body":"Oh, and I just really want to relax! ;)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397079284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397138672","html_url":"https://github.com/apache/couchdb/pull/1370#issuecomment-397138672","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1370","id":397138672,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzEzODY3Mg==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T01:32:58Z","updated_at":"2018-06-14T01:32:58Z","author_association":"MEMBER","body":"Very nice work all.\r\n\r\nHistorically one could think about external consumers of `_changes` and internal consumers of the sequence index as being on equal footing, and there's something appealing about that. The latter group has some efficiency advantages but fundamentally an external process could go and do everything that the internal consumers do using the node-local HTTP interface. The lack of HTTP access to the purge index breaks that. An external indexer, for example, has no way of knowing revisions have been purged from the main database short of checking the individual shard's purge sequence and rebuilding the entire index if it changes, whereas the internal consumers can be smarter.\r\n\r\nAll that said, I wouldn't change anything about this PR, as it contains everything needed to surface an external API to the purge structures if we should conclude there's a need for it at a later date.\r\n\r\nI'm +1 pending resolution of my (minor) review comments.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397138672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397160730","html_url":"https://github.com/apache/couchdb/issues/1385#issuecomment-397160730","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1385","id":397160730,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzE2MDczMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T03:42:28Z","updated_at":"2018-06-14T03:42:28Z","author_association":"MEMBER","body":"Hi @seigel , we've got a [PR coming with improved documentation on this](https://github.com/apache/couchdb-documentation/pull/268) from @garbados.\r\n\r\nTL;DR: If your new node comes back *as Node 3*, with the same hostname, it will automatically get all of those shards re-replicated to it. This is the recommended approach, especially in AWS where transparently replacing a machine is easy. You just need to have your own DNS set up for these machines - don't use the AWS internal host names, because those are predicated on internal IP addresses you can't control. You really want host names like `node#.clustername.yourdomain.com`.\r\n\r\nFor `q=9, n=3` you have 27 shards total, 9 per machine. Databases in CouchDB are \"presharded,\" meaning that the shard map is fixed. Adding a fourth machine (without removing any machines on the network) will not result in any of those shards moving to the new machine to balance the load.\r\n\r\nThere is a way to bring your new node back as node 4, add it to the cluster membership, and edit the shard map to ensure that a given database is supposed to have shards on that node. You can pre-seed those shards by copying them from other machines, or you can let Couch do all the work. Both approaches are discussed in the PR that has yet to land.\r\n\r\nHope this help!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397160730/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397192307","html_url":"https://github.com/apache/couchdb/issues/1314#issuecomment-397192307","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1314","id":397192307,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzE5MjMwNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T06:59:16Z","updated_at":"2018-06-14T06:59:16Z","author_association":"MEMBER","body":"The new packages are ready and will be uploaded soon - we are performing final acceptance testing on them.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397192307/reactions","total_count":7,"+1":0,"-1":0,"laugh":0,"hooray":7,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397192335","html_url":"https://github.com/apache/couchdb/issues/1293#issuecomment-397192335","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1293","id":397192335,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzE5MjMzNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T06:59:25Z","updated_at":"2018-06-14T06:59:25Z","author_association":"MEMBER","body":"The new packages are ready and will be uploaded soon - we are performing final acceptance testing on them.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397192335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397238330","html_url":"https://github.com/apache/couchdb/pull/1370#issuecomment-397238330","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1370","id":397238330,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzIzODMzMA==","user":{"login":"jiangphcn","id":18000622,"node_id":"MDQ6VXNlcjE4MDAwNjIy","avatar_url":"https://avatars.githubusercontent.com/u/18000622?v=4","gravatar_id":"","url":"https://api.github.com/users/jiangphcn","html_url":"https://github.com/jiangphcn","followers_url":"https://api.github.com/users/jiangphcn/followers","following_url":"https://api.github.com/users/jiangphcn/following{/other_user}","gists_url":"https://api.github.com/users/jiangphcn/gists{/gist_id}","starred_url":"https://api.github.com/users/jiangphcn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiangphcn/subscriptions","organizations_url":"https://api.github.com/users/jiangphcn/orgs","repos_url":"https://api.github.com/users/jiangphcn/repos","events_url":"https://api.github.com/users/jiangphcn/events{/privacy}","received_events_url":"https://api.github.com/users/jiangphcn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T09:49:58Z","updated_at":"2018-06-14T09:49:58Z","author_association":"CONTRIBUTOR","body":"Thanks again for your review @kocolosk \r\nHey @kocolosk @davisp, I tried to address comments related to code change in commit 9038557 and other previous commits. Any additional comments are highly welcome.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397238330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397300378","html_url":"https://github.com/apache/couchdb/pull/1387#issuecomment-397300378","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1387","id":397300378,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzMwMDM3OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T13:42:45Z","updated_at":"2018-06-14T13:42:45Z","author_association":"CONTRIBUTOR","body":"Let's not remove debug_info in this PR. It would be a separate PR discussion. debug_info allows both using the debugger and decompiling the source for example, either one of those might be useful...\r\n\r\nAs for bin_opt_info, we could just leave a comment on how to enable it instead of an override via a variable, which adds more code complexity to maintain. That is if someone has the desire and time to optimize all the binaries, they could enable it locally, compile and fix the issues.  The reviewer can do the same then to check.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397300378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397315782","html_url":"https://github.com/apache/couchdb/pull/1387#issuecomment-397315782","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1387","id":397315782,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzMxNTc4Mg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T14:27:53Z","updated_at":"2018-06-14T14:28:07Z","author_association":"MEMBER","body":"I don't remove `debug_info`. As it said in the commit message \"Flag `debug_info` auto-propagated from rebar, so there are no need to set it manually or we'll end up with a double entry in opts.\" You can add `-vv` to compile and grep for `erl_opts` to see what I mean.\r\n\r\n> we could just leave a comment on how to enable it instead of an override via a variable\r\n\r\nWell, @jaydoane insisted it's a valuable option, so I made it easier to turn on, easier than guess to read README and then manually modify rebar config anyway. But If you think this makes  `rebar.config.script` that more complicated then sure I can remove it completely.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397315782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397318194","html_url":"https://github.com/apache/couchdb/pull/1387#issuecomment-397318194","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1387","id":397318194,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzMxODE5NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T14:35:02Z","updated_at":"2018-06-14T14:35:02Z","author_association":"MEMBER","body":"Ideally enabling/disabling `bin_opt_info` would be in the `configure` script somewhere. I don't know if this is easy or not.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397318194/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397349212","html_url":"https://github.com/apache/couchdb/pull/1387#issuecomment-397349212","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1387","id":397349212,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzM0OTIxMg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T16:05:35Z","updated_at":"2018-06-14T16:05:35Z","author_association":"CONTRIBUTOR","body":"@eiri sorry, didn't know debug_info is already auto-included\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397349212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397360622","html_url":"https://github.com/apache/couchdb/issues/1385#issuecomment-397360622","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1385","id":397360622,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzM2MDYyMg==","user":{"login":"seigel","id":15181,"node_id":"MDQ6VXNlcjE1MTgx","avatar_url":"https://avatars.githubusercontent.com/u/15181?v=4","gravatar_id":"","url":"https://api.github.com/users/seigel","html_url":"https://github.com/seigel","followers_url":"https://api.github.com/users/seigel/followers","following_url":"https://api.github.com/users/seigel/following{/other_user}","gists_url":"https://api.github.com/users/seigel/gists{/gist_id}","starred_url":"https://api.github.com/users/seigel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seigel/subscriptions","organizations_url":"https://api.github.com/users/seigel/orgs","repos_url":"https://api.github.com/users/seigel/repos","events_url":"https://api.github.com/users/seigel/events{/privacy}","received_events_url":"https://api.github.com/users/seigel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T16:41:14Z","updated_at":"2018-06-14T16:41:14Z","author_association":"NONE","body":"Thank you for the update.  Is there anything on the roadmap to heal the cluster much more like the way an elastic search cluster heals, or HDFS?  If so I might be interested in looking at trying to contribute.\r\n\r\nThanks again for the TL;DR and your time.\r\nCheers","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397360622/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397363539","html_url":"https://github.com/apache/couchdb/pull/1387#issuecomment-397363539","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1387","id":397363539,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzM2MzUzOQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T16:49:47Z","updated_at":"2018-06-14T16:49:47Z","author_association":"MEMBER","body":"@wohali I think it's doable, to make that a config's option, but more complicated, at least I couldn't do it right off the bat.\r\n\r\n@nickva suggesting to remove that option all together and leave it on digression of developers. Will that work for you?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397363539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397376172","html_url":"https://github.com/apache/couchdb/pull/1387#issuecomment-397376172","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1387","id":397376172,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzM3NjE3Mg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T17:31:47Z","updated_at":"2018-06-14T17:31:47Z","author_association":"MEMBER","body":"Ok, so I made `ERL_OPTS ` more of a general purpose and added a mention of that option on Make's help.\r\n\r\n@nickva @wohali Does it look (user) friendlier now? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397376172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397425720","html_url":"https://github.com/apache/couchdb/issues/1314#issuecomment-397425720","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1314","id":397425720,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzQyNTcyMA==","user":{"login":"simonmichael","id":10144,"node_id":"MDQ6VXNlcjEwMTQ0","avatar_url":"https://avatars.githubusercontent.com/u/10144?v=4","gravatar_id":"","url":"https://api.github.com/users/simonmichael","html_url":"https://github.com/simonmichael","followers_url":"https://api.github.com/users/simonmichael/followers","following_url":"https://api.github.com/users/simonmichael/following{/other_user}","gists_url":"https://api.github.com/users/simonmichael/gists{/gist_id}","starred_url":"https://api.github.com/users/simonmichael/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonmichael/subscriptions","organizations_url":"https://api.github.com/users/simonmichael/orgs","repos_url":"https://api.github.com/users/simonmichael/repos","events_url":"https://api.github.com/users/simonmichael/events{/privacy}","received_events_url":"https://api.github.com/users/simonmichael/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T20:20:38Z","updated_at":"2018-06-14T20:20:38Z","author_association":"NONE","body":"These will be much appreciated. I have taken down a busy site by upgrading to 18.04 too soon..","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397425720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397455072","html_url":"https://github.com/apache/couchdb/issues/1343#issuecomment-397455072","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1343","id":397455072,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NzQ1NTA3Mg==","user":{"login":"FgfdCBVCbnsebtgf","id":20582836,"node_id":"MDQ6VXNlcjIwNTgyODM2","avatar_url":"https://avatars.githubusercontent.com/u/20582836?v=4","gravatar_id":"","url":"https://api.github.com/users/FgfdCBVCbnsebtgf","html_url":"https://github.com/FgfdCBVCbnsebtgf","followers_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/followers","following_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/following{/other_user}","gists_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/gists{/gist_id}","starred_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/subscriptions","organizations_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/orgs","repos_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/repos","events_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/events{/privacy}","received_events_url":"https://api.github.com/users/FgfdCBVCbnsebtgf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-06-14T22:16:23Z","updated_at":"2018-06-14T22:16:23Z","author_association":"NONE","body":"Hello,\r\nI cannot install the couchdb 2.1.1 in Ubuntu 18.04. I use this url:\r\nhttps://apache.bintray.com/couchdb-deb/dists/bionic/main/\r\n\r\nBut it returns an error. Any suggestions?  Thank you.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/397455072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]