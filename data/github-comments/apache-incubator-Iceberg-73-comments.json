[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762371570","html_url":"https://github.com/apache/iceberg/pull/2084#issuecomment-762371570","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2084","id":762371570,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjM3MTU3MA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T17:02:36Z","updated_at":"2021-01-18T17:02:36Z","author_association":"CONTRIBUTOR","body":"@rdblue that did the trick, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762371570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762408081","html_url":"https://github.com/apache/iceberg/pull/2084#issuecomment-762408081","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2084","id":762408081,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQwODA4MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T18:23:34Z","updated_at":"2021-01-18T18:23:34Z","author_association":"CONTRIBUTOR","body":"I think this is okay, but I'd prefer to get it in after the 0.11.0 release is out so that we don't accidentally introduce a library incompatibility with little time to catch it. Is that okay with you, @Fokko?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762408081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762411138","html_url":"https://github.com/apache/iceberg/pull/2038#issuecomment-762411138","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2038","id":762411138,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQxMTEzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T18:30:42Z","updated_at":"2021-01-18T18:30:42Z","author_association":"CONTRIBUTOR","body":"Thanks for the updates, @pvary! I merged this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762411138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762417324","html_url":"https://github.com/apache/iceberg/pull/2054#issuecomment-762417324","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2054","id":762417324,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQxNzMyNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T18:46:30Z","updated_at":"2021-01-18T18:46:30Z","author_association":"CONTRIBUTOR","body":"Overall, looks good to me. I raised a few minor points and there is a conflict in the serde.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762417324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762418271","html_url":"https://github.com/apache/iceberg/pull/2111#issuecomment-762418271","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2111","id":762418271,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQxODI3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T18:48:59Z","updated_at":"2021-01-18T18:48:59Z","author_association":"CONTRIBUTOR","body":"If I understand correctly, the id-based projection requests fields by name and if the projection type is changed in the Hive conf, that causes the wrong projection. Right? If so, then I agree with the fix to set this in the conf that we use for readers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762418271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762425155","html_url":"https://github.com/apache/iceberg/issues/2098#issuecomment-762425155","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2098","id":762425155,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQyNTE1NQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T19:06:11Z","updated_at":"2021-01-18T19:06:11Z","author_association":"CONTRIBUTOR","body":"I started a thread titled as \"test flakiness with SocketException of broken pipe in HiveMetaStoreClient\" [1]  in the dev mailing list two weeks ago. People have offered some insights there. Main suspicious is connection leak problem.\r\n\r\n[1] https://www.mail-archive.com/dev@iceberg.apache.org/msg01789.html","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762425155/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762427480","html_url":"https://github.com/apache/iceberg/pull/2054#issuecomment-762427480","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2054","id":762427480,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQyNzQ4MA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T19:12:26Z","updated_at":"2021-01-18T19:12:26Z","author_association":"CONTRIBUTOR","body":"> Overall, looks good to me. I raised a few minor points and there is a conflict in the serde.\r\n\r\nThanks for the review.\r\nRebased and fixed to comments. (Hoping that I did not mess up something in the meantime 😄)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762427480/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762435382","html_url":"https://github.com/apache/iceberg/pull/2110#issuecomment-762435382","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2110","id":762435382,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQzNTM4Mg==","user":{"login":"dongjoon-hyun","id":9700541,"node_id":"MDQ6VXNlcjk3MDA1NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9700541?v=4","gravatar_id":"","url":"https://api.github.com/users/dongjoon-hyun","html_url":"https://github.com/dongjoon-hyun","followers_url":"https://api.github.com/users/dongjoon-hyun/followers","following_url":"https://api.github.com/users/dongjoon-hyun/following{/other_user}","gists_url":"https://api.github.com/users/dongjoon-hyun/gists{/gist_id}","starred_url":"https://api.github.com/users/dongjoon-hyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dongjoon-hyun/subscriptions","organizations_url":"https://api.github.com/users/dongjoon-hyun/orgs","repos_url":"https://api.github.com/users/dongjoon-hyun/repos","events_url":"https://api.github.com/users/dongjoon-hyun/events{/privacy}","received_events_url":"https://api.github.com/users/dongjoon-hyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T19:31:45Z","updated_at":"2021-01-18T19:31:45Z","author_association":"MEMBER","body":"It seems that CI fails.\r\n\r\ncc @sunchao","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762435382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762439010","html_url":"https://github.com/apache/iceberg/pull/2084#issuecomment-762439010","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2084","id":762439010,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQzOTAxMA==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T19:40:57Z","updated_at":"2021-01-18T19:42:49Z","author_association":"CONTRIBUTOR","body":"@rdblue Yes, I think that's a great idea. Would be a pity to brick the 0.11 release. I would also postpone #2110 and #1648 in that case since they also pull in the latest version of Avro, and also the 2.11 Jackson version in a transitive way.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762439010/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762439441","html_url":"https://github.com/apache/iceberg/pull/1972#issuecomment-762439441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1972","id":762439441,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQzOTQ0MQ==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T19:42:07Z","updated_at":"2021-01-18T19:42:07Z","author_association":"CONTRIBUTOR","body":"How do we feel about this PR? Only Avro write support enough to get this in, or should we also include reading Iceberg? That would take some more time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762439441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762445221","html_url":"https://github.com/apache/iceberg/pull/2110#issuecomment-762445221","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2110","id":762445221,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQ0NTIyMQ==","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T19:57:53Z","updated_at":"2021-01-18T19:57:53Z","author_association":"MEMBER","body":"Great to see this! I think you will need to specify version for calcite-core as well since it is excluded from hive-exec.\n\nNote Hive 2.3.8 still uses Avro 1.8.2, although it should be compatible with Avro 1.10. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762445221/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762463198","html_url":"https://github.com/apache/iceberg/pull/2061#issuecomment-762463198","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2061","id":762463198,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQ2MzE5OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T20:45:14Z","updated_at":"2021-01-18T20:45:14Z","author_association":"CONTRIBUTOR","body":"Thanks @jun-he!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762463198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762465043","html_url":"https://github.com/apache/iceberg/pull/1893#issuecomment-762465043","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1893","id":762465043,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQ2NTA0Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T20:50:17Z","updated_at":"2021-01-18T20:50:17Z","author_association":"CONTRIBUTOR","body":"Thanks, @zhangjun0x01! It is great that this will be in the 0.11.0 release. Thanks for getting it done!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762465043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762481434","html_url":"https://github.com/apache/iceberg/pull/1972#issuecomment-762481434","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1972","id":762481434,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQ4MTQzNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T21:37:43Z","updated_at":"2021-01-18T21:37:43Z","author_association":"CONTRIBUTOR","body":"@Fokko, sorry for the delay getting back to this. I've been trying to get everything reviewed for the 0.11.0 release.\r\n\r\nI'm excited to see Beam support working, but I don't think that this PR has enough guardrails for general use. Because users create their own Avro files, it would be easy to create files without field IDs and append them to a table. Doing that also requires an extra step to read the Avro file if I'm reading `FilenameToDataFile` correctly. We usually want engines to handle the details of writing data correctly so users don't need to understand them, but this PR delegates the problem to users.\r\n\r\nI think we would need to provide more support so that users don't write bad data into their tables, which would also fix the performance problem introduced by `FilenameToDataFile`. There is already support in Iceberg for writing Avro generics to both Avro and Parquet formats. Could this add file writers using that to ensure that file stats and schema are correct? That would easily add Parquet support in the process.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762481434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762493245","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-762493245","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":762493245,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQ5MzI0NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T22:16:35Z","updated_at":"2021-01-18T22:16:35Z","author_association":"CONTRIBUTOR","body":"@dixingxing0, in our implementation, we store watermarks in snapshot summary metadata. I think that's a more appropriate place for it because it is metadata about the snapshot that is produced. We also use a watermark per writer because we write in 3 different AWS regions. So I think it would make sense to be able to name each watermark, possibly with a default if you choose not to name it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762493245/reactions","total_count":5,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762493308","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-762493308","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":762493308,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQ5MzMwOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T22:16:48Z","updated_at":"2021-01-18T22:16:48Z","author_association":"CONTRIBUTOR","body":"FYI @stevenzwu ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762493308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762493784","html_url":"https://github.com/apache/iceberg/pull/2106#issuecomment-762493784","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2106","id":762493784,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQ5Mzc4NA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T22:18:07Z","updated_at":"2021-01-18T22:18:07Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick! We also need to update the NOTICE files. Want to do that as well?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762493784/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762497638","html_url":"https://github.com/apache/iceberg/pull/1918#issuecomment-762497638","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1918","id":762497638,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjQ5NzYzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T22:30:59Z","updated_at":"2021-01-18T22:30:59Z","author_association":"CONTRIBUTOR","body":"@johnclara, thanks for your work on this. I'm sorry that we haven't gotten back to the review yet. We're working on the 0.11.0 release. I think I should have time to revisit this after that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762497638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762504937","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-762504937","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":762504937,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjUwNDkzNw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-18T22:59:07Z","updated_at":"2021-01-18T22:59:07Z","author_association":"CONTRIBUTOR","body":"@dixingxing0 can you describe the motivation of checkpointing the watermarks in Flink state? \r\n\r\nRyan described our use of watermarks in snapshot metadata. They are used to indicate the data completeness on the ingestion path so that downstream batch consumer jobs can be triggered when data is complete for a window (like hourly).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762504937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762532916","html_url":"https://github.com/apache/iceberg/issues/2098#issuecomment-762532916","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2098","id":762532916,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjUzMjkxNg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T00:46:14Z","updated_at":"2021-01-19T00:47:41Z","author_association":"CONTRIBUTOR","body":"> I started a thread titled as \"test flakiness with SocketException of broken pipe in HiveMetaStoreClient\" [1] in the dev mailing list two weeks ago. People have offered some insights there. Main suspicious is connection leak problem.\r\n> \r\n> [1] https://www.mail-archive.com/dev@iceberg.apache.org/msg01789.html\r\n\r\nCool thank you @stevenzwu. Connection leak would potentially explain why I’m much less able to reproduce when I increase the catalog’s `clients` config value. Also, knowing that it is (was?) happening in the flink tests helps a ton with guidance for how much time to put into investigating from the POV of a potential test inheritance pattern issue vs connection leak issue.\r\n\r\nThis is very helpful. I should be more active on the dev list, though I’m only able to contribute somewhat sporadically given my current work is not exactly iceberg related. I’ll follow up in that thread too with anything I find while investigating. 👍","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762532916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762537381","html_url":"https://github.com/apache/iceberg/pull/2106#issuecomment-762537381","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2106","id":762537381,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjUzNzM4MQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T01:02:23Z","updated_at":"2021-01-19T01:02:23Z","author_association":"CONTRIBUTOR","body":"> Thanks, @kbendick! We also need to update the NOTICE files. Want to do that as well?\r\n\r\nSure I'll do that now. Good catch. I had meant to git grep for \"2020\" etc and admittedly forgot 😅 .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762537381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762556623","html_url":"https://github.com/apache/iceberg/pull/2102#issuecomment-762556623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2102","id":762556623,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjU1NjYyMw==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T02:16:03Z","updated_at":"2021-01-19T02:16:03Z","author_association":"MEMBER","body":"@rdblue Could you please review this PR ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762556623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762559543","html_url":"https://github.com/apache/iceberg/pull/1956#issuecomment-762559543","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1956","id":762559543,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjU1OTU0Mw==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T02:24:53Z","updated_at":"2021-01-19T02:24:53Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01 it seems that Flink 1.12 upgrade might have changed the SQL behavior a little bit. I have to update the `TestFlinkTableSource` to match the new behavior. Can you please take a look and let me know if there is a better alternative?\r\n\r\nhttps://github.com/apache/iceberg/pull/1956/commits/98d9f6ad511b47b554ca14ae5d7fa8931161b3bf","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762559543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762564840","html_url":"https://github.com/apache/iceberg/pull/2102#issuecomment-762564840","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2102","id":762564840,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjU2NDg0MA==","user":{"login":"rdsr","id":129474,"node_id":"MDQ6VXNlcjEyOTQ3NA==","avatar_url":"https://avatars.githubusercontent.com/u/129474?v=4","gravatar_id":"","url":"https://api.github.com/users/rdsr","html_url":"https://github.com/rdsr","followers_url":"https://api.github.com/users/rdsr/followers","following_url":"https://api.github.com/users/rdsr/following{/other_user}","gists_url":"https://api.github.com/users/rdsr/gists{/gist_id}","starred_url":"https://api.github.com/users/rdsr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdsr/subscriptions","organizations_url":"https://api.github.com/users/rdsr/orgs","repos_url":"https://api.github.com/users/rdsr/repos","events_url":"https://api.github.com/users/rdsr/events{/privacy}","received_events_url":"https://api.github.com/users/rdsr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T02:44:06Z","updated_at":"2021-01-19T02:44:06Z","author_association":"CONTRIBUTOR","body":"LG!. I realize that you might have to update the LICENSE file which lists all the code we have borrowed from different project.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762564840/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762566233","html_url":"https://github.com/apache/iceberg/issues/2093#issuecomment-762566233","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2093","id":762566233,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjU2NjIzMw==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T02:48:31Z","updated_at":"2021-01-19T02:48:31Z","author_association":"CONTRIBUTOR","body":"I agree that such a query with several joins is likely not practical to be performing regularly.\r\n\r\nCan you detail more how you intend to use this partition creation / update time info? Is this possibly as a trigger for a batch job - for example, a common pattern would be to continuously write to a table that is partitioned by hour from a streaming job (say, using Apache Flink as the query engine), and then when the new hours partition is committed a batch job would be triggered to process it.\r\n\r\nI’m not opposed to adding such metadata, though there would be better people than me to ask and it’s likely something that should be brought up on the dev mailing list.\r\n\r\nHowever, if you detail your use case (as well as possibly the intended writing situation / query engine), it’s very possible that other users are already handling this use case with some existing pattern that is already supported. Or it’s possible that your use case is new / not currently handled and then adding this metadata might be needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762566233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762568517","html_url":"https://github.com/apache/iceberg/pull/2102#issuecomment-762568517","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2102","id":762568517,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjU2ODUxNw==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T02:55:26Z","updated_at":"2021-01-19T02:55:26Z","author_association":"MEMBER","body":"> LG!. I realize that you might have to update the LICENSE file which lists all the code we have borrowed from different project.\r\n\r\nUpdated","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762568517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762585584","html_url":"https://github.com/apache/iceberg/pull/2092#issuecomment-762585584","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2092","id":762585584,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjU4NTU4NA==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T03:54:17Z","updated_at":"2021-01-19T03:54:17Z","author_association":"CONTRIBUTOR","body":"Thanks again to @rdblue  and @kbendick review this PR. I have addressed it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762585584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762624770","html_url":"https://github.com/apache/iceberg/pull/2112#issuecomment-762624770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2112","id":762624770,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjYyNDc3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T06:12:18Z","updated_at":"2021-01-19T06:12:18Z","author_association":"CONTRIBUTOR","body":"Thanks @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762624770/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762675949","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-762675949","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":762675949,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjY3NTk0OQ==","user":{"login":"txdong-sz","id":5066512,"node_id":"MDQ6VXNlcjUwNjY1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5066512?v=4","gravatar_id":"","url":"https://api.github.com/users/txdong-sz","html_url":"https://github.com/txdong-sz","followers_url":"https://api.github.com/users/txdong-sz/followers","following_url":"https://api.github.com/users/txdong-sz/following{/other_user}","gists_url":"https://api.github.com/users/txdong-sz/gists{/gist_id}","starred_url":"https://api.github.com/users/txdong-sz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/txdong-sz/subscriptions","organizations_url":"https://api.github.com/users/txdong-sz/orgs","repos_url":"https://api.github.com/users/txdong-sz/repos","events_url":"https://api.github.com/users/txdong-sz/events{/privacy}","received_events_url":"https://api.github.com/users/txdong-sz/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T08:12:38Z","updated_at":"2021-01-19T08:12:38Z","author_association":"NONE","body":"we use flink 1.12 now  . but iceberg cannot supoort flink 1.12 now .  \r\nthis is a major version of flink 1.12  (stream and batch can written in one code )   so iceberg with flink 1.12  need to be merge  soon\r\n![image](https://user-images.githubusercontent.com/5066512/105005522-660e9200-5a70-11eb-90a3-404bfae22bc6.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762675949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762679911","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-762679911","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":762679911,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjY3OTkxMQ==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T08:20:41Z","updated_at":"2021-01-19T11:19:01Z","author_association":"CONTRIBUTOR","body":"> @dixingxing0, in our implementation, we store watermarks in snapshot summary metadata. I think that's a more appropriate place for it because it is metadata about the snapshot that is produced. We also use a watermark per writer because we write in 3 different AWS regions. So I think it would make sense to be able to name each watermark, possibly with a default if you choose not to name it.\r\n\r\nThanks @rdblue, agree with you.\r\nSince we will store watermark in snapshot summary metadata, we should also consider rewrite action, currently rewrite action will lost the extra properties in summary metadata, e.g. `flink.max-committed-checkpoint-id`,`flink.job-id`. \r\nI think we should introduce an table property `snapshot-summary-inheritance.enabled`, if set it to true, `newSnapshot` will use the extra properties in `oldSnapshot` as default.\r\n\r\nAbout to name watermark, i think we can introduce an new confiuration `flink.watermark-name`:\r\n```java\r\n// user specified configuration\r\nflink.store-watermark=false      // as default\r\nflink.watermark-name=default  // as default\r\n\r\n// written by flink file committer\r\nflink.watermark-for-default=the-watermark  // use flink.watermark-name as suffix\r\n```\r\n\r\n@rdblue  what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762679911/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762686286","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-762686286","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":762686286,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjY4NjI4Ng==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T08:33:07Z","updated_at":"2021-01-19T08:47:36Z","author_association":"CONTRIBUTOR","body":"> @dixingxing0 can you describe the motivation of checkpointing the watermarks in Flink state?\r\n> \r\n> Ryan described our use of watermarks in snapshot metadata. They are used to indicate the data completeness on the ingestion path so that downstream batch consumer jobs can be triggered when data is complete for a window (like hourly).\r\n\r\nThanks @stevenzwu, about the watermark state, i am just according to the current restore behavior:\r\n```java\r\n      NavigableMap<Long, byte[]> uncommittedDataFiles = Maps\r\n          .newTreeMap(checkpointsState.get().iterator().next())\r\n          .tailMap(maxCommittedCheckpointId, false);\r\n      if (!uncommittedDataFiles.isEmpty()) {\r\n        // Committed all uncommitted data files from the old flink job to iceberg table.\r\n        long maxUncommittedCheckpointId = uncommittedDataFiles.lastKey();\r\n        commitUpToCheckpoint(uncommittedDataFiles, restoredFlinkJobId, maxUncommittedCheckpointId);\r\n      }\r\n```\r\nSince flink will commit last uncommitted checkpoint, i think we should also store the right watermark for that checkpoint.\r\n\r\nOur use case is exactly same as you and @rdblue described, except we don't have multi writers 😄 .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762686286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762695163","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-762695163","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":762695163,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjY5NTE2Mw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T08:49:55Z","updated_at":"2021-01-19T08:49:55Z","author_association":"CONTRIBUTOR","body":"> we use flink 1.12 now . but iceberg cannot supoort flink 1.12 now .\r\n> this is a major version of flink 1.12 (stream and batch can written in one code ) so iceberg with flink 1.12 need to be merge soon\r\n> ![image](https://user-images.githubusercontent.com/5066512/105005522-660e9200-5a70-11eb-90a3-404bfae22bc6.png)\r\n\r\nyou can merged the [pr 1956](https://github.com/apache/iceberg/pull/1956) into master ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762695163/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762698221","html_url":"https://github.com/apache/iceberg/pull/2038#issuecomment-762698221","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2038","id":762698221,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjY5ODIyMQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T08:55:47Z","updated_at":"2021-01-19T08:55:47Z","author_association":"CONTRIBUTOR","body":"Thanks @rdblue for all of the reviews and helpful comments!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762698221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762714531","html_url":"https://github.com/apache/iceberg/issues/1951#issuecomment-762714531","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1951","id":762714531,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjcxNDUzMQ==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T09:24:31Z","updated_at":"2021-01-19T09:24:31Z","author_association":"MEMBER","body":"@txdong-sz Currently, this patch can not work with both Flink 1.11 & 1.12. As previous discussion, community will work on it after Iceberg 0.11 released. So now, you need to merge it manually.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762714531/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762744411","html_url":"https://github.com/apache/iceberg/pull/1947#issuecomment-762744411","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1947","id":762744411,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mjc0NDQxMQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T10:15:51Z","updated_at":"2021-01-19T10:15:51Z","author_association":"CONTRIBUTOR","body":"@rdblue @aokolnychyi Thanks for the detailed review and all the help !!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762744411/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762755120","html_url":"https://github.com/apache/iceberg/pull/2053#issuecomment-762755120","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2053","id":762755120,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mjc1NTEyMA==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T10:35:54Z","updated_at":"2021-01-19T10:35:54Z","author_association":"CONTRIBUTOR","body":"@pvary @rdblue  Thanks for the review and all the help 😄 .","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762755120/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762863122","html_url":"https://github.com/apache/iceberg/pull/2067#issuecomment-762863122","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2067","id":762863122,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mjg2MzEyMg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T14:10:20Z","updated_at":"2021-01-19T14:10:20Z","author_association":"MEMBER","body":"@aokolnychyi  Any comments?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/762863122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763021324","html_url":"https://github.com/apache/iceberg/pull/2064#issuecomment-763021324","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2064","id":763021324,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzAyMTMyNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T18:05:37Z","updated_at":"2021-01-19T18:05:37Z","author_association":"CONTRIBUTOR","body":"This looks nearly ready. Mainly, I would like to get consensus on the config values.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763021324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763052965","html_url":"https://github.com/apache/iceberg/pull/2099#issuecomment-763052965","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2099","id":763052965,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzA1Mjk2NQ==","user":{"login":"williamhyun","id":62487364,"node_id":"MDQ6VXNlcjYyNDg3MzY0","avatar_url":"https://avatars.githubusercontent.com/u/62487364?v=4","gravatar_id":"","url":"https://api.github.com/users/williamhyun","html_url":"https://github.com/williamhyun","followers_url":"https://api.github.com/users/williamhyun/followers","following_url":"https://api.github.com/users/williamhyun/following{/other_user}","gists_url":"https://api.github.com/users/williamhyun/gists{/gist_id}","starred_url":"https://api.github.com/users/williamhyun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/williamhyun/subscriptions","organizations_url":"https://api.github.com/users/williamhyun/orgs","repos_url":"https://api.github.com/users/williamhyun/repos","events_url":"https://api.github.com/users/williamhyun/events{/privacy}","received_events_url":"https://api.github.com/users/williamhyun/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T18:57:28Z","updated_at":"2021-01-19T18:57:28Z","author_association":"MEMBER","body":"Thank you @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763052965/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763080534","html_url":"https://github.com/apache/iceberg/pull/2069#issuecomment-763080534","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2069","id":763080534,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzA4MDUzNA==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T19:36:57Z","updated_at":"2021-01-19T19:36:57Z","author_association":"CONTRIBUTOR","body":"> For ORC metrics, which currently don't populate `nanValueCounts` in the metrics and for which it seems difficult to populate `nanValueCounts`, will this still work when we create `Metrics` using the non-deprecated constructors that require passing `nanValueCounts`? This is in reference to this issue for removing the `Metrics` constructors that don't take in `nanValueCounts` maps: #2044\r\n> \r\n> I suppose when we go to deprecate the old `Metrics` constructors, we can simply pass `null` into the `Metrics` constructor for `nanValueCounts` with ORC in order to keep the current behavior. Or update the various evaluator code paths to ensure that a missing key from this map does not indicate anything special if we choose to pass in an empty map.\r\n> \r\n> This is all based off of my understanding of ORC's `ColumnStatistics` and the notes in this PR about `upperBound ` and `lowerBound` being `NaN` in ORC if _any_ value in the file is `NaN`, so please correct me if I'm mistaken and somebody sees an easy way to get NaN stats from an ORC file. To me, I fail to see how we can get the count of NaN values in the following code block (though as I mentioned we can always continue to pass in `null` to match the existing behavior, provided the various metrics evaluators are aware that `null` for that Map entry for nullValueCounts doesnt convey much meaning for ORC).\r\n> \r\n> We could also potentially track NaN values in the various orc writers, like the parquet writers do.\r\n> \r\n> The relevant code for populating ORC metrics is here:\r\n> \r\n> https://github.com/apache/iceberg/blob/29915e3522f9a808420a2e16fb1c2cf3ae165a74/orc/src/main/java/org/apache/iceberg/orc/OrcMetrics.java#L100-L172\r\n\r\nThanks for your interests in this PR! You are right that some of this PR will not be working without NaN counter for checking if a field contains partial/all NaN, and it's hard to get ORC `nanValueCounts` from ORC file directly. I think today evaluators should treat missing keys from this map or lack of such map the same way as not having NaN value count information for a given field, or do you think we are not doing this in some places?\r\n\r\nRegarding populating NaN counter for ORC files, yes we are going to track NaN values in various ORC writers just as we do for parquet writers, and the change is currently in review in #1790. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763080534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763082097","html_url":"https://github.com/apache/iceberg/issues/2044#issuecomment-763082097","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2044","id":763082097,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzA4MjA5Nw==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T19:39:39Z","updated_at":"2021-01-19T19:39:39Z","author_association":"CONTRIBUTOR","body":"Thanks for creating this task! Just to give some context, I originally added the new constructors and marked the old one as deprecated, as I was implementing NaN counter across different writers, which is still in progress/under review. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763082097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763147771","html_url":"https://github.com/apache/iceberg/pull/2113#issuecomment-763147771","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2113","id":763147771,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE0Nzc3MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T21:18:34Z","updated_at":"2021-01-19T21:18:34Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763147771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763148333","html_url":"https://github.com/apache/iceberg/pull/2104#issuecomment-763148333","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2104","id":763148333,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE0ODMzMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T21:19:39Z","updated_at":"2021-01-19T21:19:39Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763148333/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763163057","html_url":"https://github.com/apache/iceberg/pull/1849#issuecomment-763163057","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1849","id":763163057,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE2MzA1Nw==","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T21:48:23Z","updated_at":"2021-01-19T21:48:23Z","author_association":"NONE","body":"@rdblue, any thoughts on this patch? Are you wanting to wait for an initial impl or have some other thoughts about next steps? Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763163057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763169385","html_url":"https://github.com/apache/iceberg/pull/2054#issuecomment-763169385","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2054","id":763169385,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzE2OTM4NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-19T22:00:59Z","updated_at":"2021-01-19T22:00:59Z","author_association":"CONTRIBUTOR","body":"Thanks, @pvary!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763169385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763241880","html_url":"https://github.com/apache/iceberg/pull/2069#issuecomment-763241880","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2069","id":763241880,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzI0MTg4MA==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T00:35:15Z","updated_at":"2021-01-20T00:35:15Z","author_association":"CONTRIBUTOR","body":"I have updated the PR based on comments. Thank you everyone for your interests in this PR! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763241880/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763263425","html_url":"https://github.com/apache/iceberg/pull/2064#issuecomment-763263425","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2064","id":763263425,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzI2MzQyNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T01:35:07Z","updated_at":"2021-01-20T01:35:07Z","author_association":"CONTRIBUTOR","body":"I think there is consensus around using \"none\", \"hash\", and \"range\" for the distribution mode. Once that's implemented, I think this is ready to commit. I also had some other minor comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763263425/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763273407","html_url":"https://github.com/apache/iceberg/pull/2116#issuecomment-763273407","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2116","id":763273407,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzI3MzQwNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T01:55:40Z","updated_at":"2021-01-20T01:55:40Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews, @aokolnychyi, @dilipbiswal, and @kbendick!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763273407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763275662","html_url":"https://github.com/apache/iceberg/pull/2117#issuecomment-763275662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2117","id":763275662,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzI3NTY2Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T02:02:24Z","updated_at":"2021-01-20T02:02:24Z","author_association":"CONTRIBUTOR","body":"This should be helpful when we want to add sort order for `MERGE INTO` plans.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763275662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763299851","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-763299851","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":763299851,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzI5OTg1MQ==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T03:13:46Z","updated_at":"2021-01-20T03:17:32Z","author_association":"CONTRIBUTOR","body":"@dixingxing0 thx a lot for the additional context. that is very helpful. I left a few comments.\r\n\r\nRegarding the scenario of multiple writer jobs and single table, I am afraid that the additional config won't help because we are talking one table here.\r\n\r\nSomehow, we need to allow a provider to provide the suffix for watermark property key. For us, the suffix is the AWS region. I am not sure what is the cleanest way to achieve that. We can define a provider class config and use reflection to instantiate it. I am hesitant with reflection as it is impossible to pass dependency to reflection instantiated class.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763299851/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763306602","html_url":"https://github.com/apache/iceberg/pull/2102#issuecomment-763306602","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2102","id":763306602,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzMwNjYwMg==","user":{"login":"pan3793","id":26535726,"node_id":"MDQ6VXNlcjI2NTM1NzI2","avatar_url":"https://avatars.githubusercontent.com/u/26535726?v=4","gravatar_id":"","url":"https://api.github.com/users/pan3793","html_url":"https://github.com/pan3793","followers_url":"https://api.github.com/users/pan3793/followers","following_url":"https://api.github.com/users/pan3793/following{/other_user}","gists_url":"https://api.github.com/users/pan3793/gists{/gist_id}","starred_url":"https://api.github.com/users/pan3793/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pan3793/subscriptions","organizations_url":"https://api.github.com/users/pan3793/orgs","repos_url":"https://api.github.com/users/pan3793/repos","events_url":"https://api.github.com/users/pan3793/events{/privacy}","received_events_url":"https://api.github.com/users/pan3793/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T03:36:23Z","updated_at":"2021-01-20T03:36:23Z","author_association":"MEMBER","body":"CI failed because of #2098","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763306602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763311317","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-763311317","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":763311317,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzMxMTMxNw==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T03:52:35Z","updated_at":"2021-01-20T03:52:35Z","author_association":"CONTRIBUTOR","body":"> @dixingxing0 thx a lot for the additional context. that is very helpful. I left a few comments.\r\n> \r\n> Regarding the scenario of multiple writer jobs and single table, I am afraid that the additional config won't help because we are talking one table here.\r\n> \r\n> Somehow, we need to allow a provider to provide the suffix for watermark property key. For us, the suffix is the AWS region. I am not sure what is the cleanest way to achieve that. We can define a provider class config and use reflection to instantiate it. I am hesitant with reflection as it is impossible to pass dependency to reflection instantiated class.\r\n\r\n@stevenzwu  thanks for the review and comments!\r\n\r\nAs you described, we cannot config watermark name suffix as table property  for multiple writers 😁 . How about we introduce new fields in `FlinkSink.Builder` to config watermark name suffix, this should work for multiple writers:\r\n```java\r\n// introduce new fields in org.apache.iceberg.flink.sink.FlinkSink.Builder\r\nprivate boolean storeWatermarkEnabled;      // default false\r\nprivate String watermarkNameSuffix;  // default \"default\"\r\n\r\n// iceberg `table property` or `snapshot summary` written by flink file committer\r\nflink.watermark-for-default=the-watermark  // use watermarkNameSuffix config as suffix\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763311317/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763329566","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-763329566","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":763329566,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzMyOTU2Ng==","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T04:48:46Z","updated_at":"2021-01-20T04:48:46Z","author_association":"CONTRIBUTOR","body":"@dixingxing0 yeah. extending the `FlinkSink.Builder` sounds like a right approach to me.\r\n\r\nSmall suggestion on the naming:\r\n- storeWatermarkEnabled -> storeWatermark\r\n- flink.watermark-for-default -> flink.watermark.default","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763329566/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763421380","html_url":"https://github.com/apache/iceberg/pull/2054#issuecomment-763421380","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2054","id":763421380,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzQyMTM4MA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T08:15:23Z","updated_at":"2021-01-20T08:15:23Z","author_association":"CONTRIBUTOR","body":"Thanks for the review and the merge, @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763421380/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763452212","html_url":"https://github.com/apache/iceberg/pull/2118#issuecomment-763452212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2118","id":763452212,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzQ1MjIxMg==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T09:05:41Z","updated_at":"2021-01-20T09:05:41Z","author_association":"CONTRIBUTOR","body":"Looks good to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763452212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763480600","html_url":"https://github.com/apache/iceberg/pull/2109#issuecomment-763480600","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2109","id":763480600,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzQ4MDYwMA==","user":{"login":"dixingxing0","id":1303530,"node_id":"MDQ6VXNlcjEzMDM1MzA=","avatar_url":"https://avatars.githubusercontent.com/u/1303530?v=4","gravatar_id":"","url":"https://api.github.com/users/dixingxing0","html_url":"https://github.com/dixingxing0","followers_url":"https://api.github.com/users/dixingxing0/followers","following_url":"https://api.github.com/users/dixingxing0/following{/other_user}","gists_url":"https://api.github.com/users/dixingxing0/gists{/gist_id}","starred_url":"https://api.github.com/users/dixingxing0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dixingxing0/subscriptions","organizations_url":"https://api.github.com/users/dixingxing0/orgs","repos_url":"https://api.github.com/users/dixingxing0/repos","events_url":"https://api.github.com/users/dixingxing0/events{/privacy}","received_events_url":"https://api.github.com/users/dixingxing0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T09:49:56Z","updated_at":"2021-01-20T09:49:56Z","author_association":"CONTRIBUTOR","body":"> @dixingxing0 yeah. extending the `FlinkSink.Builder` sounds like a right approach to me.\r\n> \r\n> Small suggestion on the naming:\r\n> \r\n> * storeWatermarkEnabled -> storeWatermark\r\n> * flink.watermark-for-default -> flink.watermark.default\r\n\r\nThanks, i will address it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763480600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763500420","html_url":"https://github.com/apache/iceberg/pull/2118#issuecomment-763500420","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2118","id":763500420,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzUwMDQyMA==","user":{"login":"karuppayya","id":5082742,"node_id":"MDQ6VXNlcjUwODI3NDI=","avatar_url":"https://avatars.githubusercontent.com/u/5082742?v=4","gravatar_id":"","url":"https://api.github.com/users/karuppayya","html_url":"https://github.com/karuppayya","followers_url":"https://api.github.com/users/karuppayya/followers","following_url":"https://api.github.com/users/karuppayya/following{/other_user}","gists_url":"https://api.github.com/users/karuppayya/gists{/gist_id}","starred_url":"https://api.github.com/users/karuppayya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karuppayya/subscriptions","organizations_url":"https://api.github.com/users/karuppayya/orgs","repos_url":"https://api.github.com/users/karuppayya/repos","events_url":"https://api.github.com/users/karuppayya/events{/privacy}","received_events_url":"https://api.github.com/users/karuppayya/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T10:21:15Z","updated_at":"2021-01-20T10:21:15Z","author_association":"CONTRIBUTOR","body":"Change looks good to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763500420/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763609463","html_url":"https://github.com/apache/iceberg/pull/1979#issuecomment-763609463","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1979","id":763609463,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzYwOTQ2Mw==","user":{"login":"steveloughran","id":162090,"node_id":"MDQ6VXNlcjE2MjA5MA==","avatar_url":"https://avatars.githubusercontent.com/u/162090?v=4","gravatar_id":"","url":"https://api.github.com/users/steveloughran","html_url":"https://github.com/steveloughran","followers_url":"https://api.github.com/users/steveloughran/followers","following_url":"https://api.github.com/users/steveloughran/following{/other_user}","gists_url":"https://api.github.com/users/steveloughran/gists{/gist_id}","starred_url":"https://api.github.com/users/steveloughran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/steveloughran/subscriptions","organizations_url":"https://api.github.com/users/steveloughran/orgs","repos_url":"https://api.github.com/users/steveloughran/repos","events_url":"https://api.github.com/users/steveloughran/events{/privacy}","received_events_url":"https://api.github.com/users/steveloughran/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T13:35:34Z","updated_at":"2021-01-20T13:35:34Z","author_association":"CONTRIBUTOR","body":"FWIW, [HADOOP-15710](https://issues.apache.org/jira/browse/HADOOP-15710) first reported this issue in 2018. Someone needs to fix this. Will escalate","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763609463/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763646722","html_url":"https://github.com/apache/iceberg/pull/2126#issuecomment-763646722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2126","id":763646722,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MzY0NjcyMg==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T14:33:43Z","updated_at":"2021-01-20T14:33:43Z","author_association":"CONTRIBUTOR","body":"@marton-bod @pvary If you have time, could you please review this change? Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763646722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763764693","html_url":"https://github.com/apache/iceberg/pull/2123#issuecomment-763764693","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2123","id":763764693,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzc2NDY5Mw==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T16:30:26Z","updated_at":"2021-01-21T12:35:14Z","author_association":"COLLABORATOR","body":"Build failure is due to the flaky Spark tests:\r\n```\r\norg.apache.iceberg.spark.extensions.TestCopyOnWriteDelete > testDeleteWithSerializableIsolation[catalogName = spark_catalog, implementation = org.apache.iceberg.spark.SparkSessionCatalog, config = {type=hive, default-namespace=default, clients=1, parquet-enabled=false, cache-enabled=false}, format = avro, vectorized = false] FAILED\r\n    java.lang.RuntimeException: Failed to get table info from metastore default.table\r\n\r\n        Caused by:\r\n        org.apache.thrift.transport.TTransportException: java.net.SocketException: Broken pipe (Write failed)\r\n\r\n            Caused by:\r\n            java.net.SocketException: Broken pipe (Write failed)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763764693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763787609","html_url":"https://github.com/apache/iceberg/pull/2064#issuecomment-763787609","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2064","id":763787609,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzc4NzYwOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T17:00:35Z","updated_at":"2021-01-20T17:00:35Z","author_association":"CONTRIBUTOR","body":"Looks great, thanks for working on this @openinx!\r\n\r\nAnd thanks to everyone that helped discuss the configuration!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763787609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763791097","html_url":"https://github.com/apache/iceberg/pull/2069#issuecomment-763791097","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2069","id":763791097,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzc5MTA5Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T17:04:24Z","updated_at":"2021-01-20T17:04:24Z","author_association":"CONTRIBUTOR","body":"Thank you for fixing this, @yyanyy! Great work.\r\n\r\nThanks to @jbapple, @jackye1995, and @kbendick for reviewing!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763791097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763795888","html_url":"https://github.com/apache/iceberg/pull/2118#issuecomment-763795888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2118","id":763795888,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzc5NTg4OA==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T17:10:07Z","updated_at":"2021-01-20T17:10:07Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763795888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763840338","html_url":"https://github.com/apache/iceberg/pull/2021#issuecomment-763840338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2021","id":763840338,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzg0MDMzOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T18:20:51Z","updated_at":"2021-01-20T18:20:51Z","author_association":"CONTRIBUTOR","body":"Looks good to me! I'll merge this when the JDK 8 tests pass.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763840338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763851131","html_url":"https://github.com/apache/iceberg/pull/2086#issuecomment-763851131","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2086","id":763851131,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzg1MTEzMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T18:38:53Z","updated_at":"2021-01-20T18:38:53Z","author_association":"CONTRIBUTOR","body":"@pvary, could you rebase this? Looks like it has conflicts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763851131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763896598","html_url":"https://github.com/apache/iceberg/pull/2115#issuecomment-763896598","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2115","id":763896598,"node_id":"MDEyOklzc3VlQ29tbWVudDc2Mzg5NjU5OA==","user":{"login":"TGooch44","id":1591711,"node_id":"MDQ6VXNlcjE1OTE3MTE=","avatar_url":"https://avatars.githubusercontent.com/u/1591711?v=4","gravatar_id":"","url":"https://api.github.com/users/TGooch44","html_url":"https://github.com/TGooch44","followers_url":"https://api.github.com/users/TGooch44/followers","following_url":"https://api.github.com/users/TGooch44/following{/other_user}","gists_url":"https://api.github.com/users/TGooch44/gists{/gist_id}","starred_url":"https://api.github.com/users/TGooch44/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TGooch44/subscriptions","organizations_url":"https://api.github.com/users/TGooch44/orgs","repos_url":"https://api.github.com/users/TGooch44/repos","events_url":"https://api.github.com/users/TGooch44/events{/privacy}","received_events_url":"https://api.github.com/users/TGooch44/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-20T19:59:32Z","updated_at":"2021-01-20T19:59:32Z","author_association":"CONTRIBUTOR","body":"@rymurr Thanks again for taking a look.  Your help on this has really been invaluable.  I'm reviewing your comments now, will comment on each. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/763896598/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764061172","html_url":"https://github.com/apache/iceberg/pull/2088#issuecomment-764061172","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2088","id":764061172,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDA2MTE3Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T00:17:45Z","updated_at":"2021-01-21T00:17:45Z","author_association":"CONTRIBUTOR","body":"+1\r\n\r\nWill merge when tests pass.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764061172/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764061396","html_url":"https://github.com/apache/iceberg/pull/2088#issuecomment-764061396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2088","id":764061396,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDA2MTM5Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T00:18:00Z","updated_at":"2021-01-21T00:18:00Z","author_association":"CONTRIBUTOR","body":"Closing was accidental. Sorry about that.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764061396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764062481","html_url":"https://github.com/apache/iceberg/pull/2114#issuecomment-764062481","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2114","id":764062481,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDA2MjQ4MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T00:19:11Z","updated_at":"2021-01-21T00:19:11Z","author_association":"CONTRIBUTOR","body":"Thanks for keeping the codebase clean, @Fokko!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764062481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764154236","html_url":"https://github.com/apache/iceberg/pull/2127#issuecomment-764154236","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2127","id":764154236,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDE1NDIzNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T01:20:36Z","updated_at":"2021-01-21T01:20:36Z","author_association":"CONTRIBUTOR","body":"@jackye1995, I think we need to update the LICENSE for the `iceberg-spark3-extensions` module with the recent changes from the main LICENSE. We added a couple of new entries under the Spark section and a new section for Delta. Those now affect the extensions module so we should update the LICENSE included in the Jar.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764154236/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764180033","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-764180033","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":764180033,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDE4MDAzMw==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T02:01:43Z","updated_at":"2021-01-21T02:01:43Z","author_association":"CONTRIBUTOR","body":"#2088 is merged, please rebase when you have time, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764180033/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764180367","html_url":"https://github.com/apache/iceberg/pull/2048#issuecomment-764180367","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2048","id":764180367,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDE4MDM2Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T02:02:19Z","updated_at":"2021-01-21T02:02:19Z","author_association":"CONTRIBUTOR","body":"Thanks, @holdenk! Really nice to have this done.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764180367/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764219379","html_url":"https://github.com/apache/iceberg/pull/2127#issuecomment-764219379","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2127","id":764219379,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDIxOTM3OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T03:55:35Z","updated_at":"2021-01-21T03:55:35Z","author_association":"CONTRIBUTOR","body":"Thanks, @jackye1995!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764219379/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764830749","html_url":"https://github.com/apache/iceberg/issues/2131#issuecomment-764830749","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2131","id":764830749,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDgzMDc0OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T17:58:18Z","updated_at":"2021-01-21T17:58:18Z","author_association":"MEMBER","body":"Have you tried the ExpireSnapshotsAction it has a slightly different internal implementation so I think it actually will preserve the file even with the procedure. But I think your concerns are all very valid.\n\n> On Jan 21, 2021, at 11:56 AM, Scott Kruger <notifications@github.com> wrote:\n> \n> \n> It's possible to use the API to construct snapshots in such a way that expiring snapshots (with file deletion enabled) causes active data files to be deleted. This happens with an iceberg table that's manually managed over raw parquet files written by spark (doesn't really bear going into why). The basic steps are:\n> \n> Create a partitioned iceberg table\n> Write two partitions (p1 and p2) as raw parquet data via spark\n> Append files to iceberg table\n> IMPORTANT Commit iceberg overwrite that\n> Deletes files appended in step 3\n> Re-adds those same files\n> Expire snapshot 1 with file deletion enabled\n> Write raw parquet data to a new directory containing data for partitions p2 and p3 (note that p2 is the same partition as in step 2)\n> Commit iceberg overwrite that\n> Deletes files in snapshot 2 from partition p2\n> Adds all new files from step 6\n> Expire snapshot 2 with file deletion enabled\n> Reading the iceberg table now fails because the files from p1, which are still active files, were deleted by the snapshot expiration in step 8\n> Here's a script that shows how to reproduce:\n> \n> // vim: set ts=2 sw=2 bs=2 et\n> \n> // Use Vimux bindings to evaluate expressions in the shell pane. For example:\n> //\n> // * In normal mode, use \\vs to evaluate the block under the cursor\n> // * In (block) visual mode, use \\vs to evaluate the highlighted block\n> \n> import java.sql.{Date,Timestamp}\n> import java.time.LocalDate\n> import org.apache.hadoop.fs._\n> import org.apache.spark.sql._\n> import org.apache.spark.sql.types._\n> import org.apache.spark.sql.functions._\n> import org.apache.spark.sql.expressions._\n> import scala.collection.JavaConversions._\n> import spark.implicits._\n> import org.apache.iceberg.hadoop.{HadoopTables,HadoopInputFile}\n> import org.apache.iceberg.spark.SparkSchemaUtil\n> import org.apache.iceberg.parquet.ParquetUtil\n> import org.apache.iceberg.{PartitionSpec,DataFiles,MetricsConfig}\n> \n> val tableDir = \"hdfs:///tmp/iceberg-table\"\n> \n> val fs = new Path(tableDir).getFileSystem(sc.hadoopConfiguration)\n> fs.delete(new Path(tableDir), true)\n> \n> val tables = new HadoopTables(sc.hadoopConfiguration)\n> \n> // Create simple table partitioned by day\n> val df1 = (\n>   spark\n>     .range(10L)\n>     .select(\n>       'id,\n>       concat(lit(\"value\"), 'id) as 'value,\n>       when('id < 5L, Timestamp.valueOf(\"2021-01-19 00:00:00\")).otherwise(Timestamp.valueOf(\"2021-01-20 00:00:00\")) as 'ts\n>     )\n> )\n> \n> val schema = SparkSchemaUtil.convert(df1.schema)\n> val table = tables.create(\n>   schema,\n>   PartitionSpec.builderFor(schema).day(\"ts\").build,\n>   tableDir\n> )\n> \n> // Get data files from a path\n> def getDataFiles(path: String) = {\n>   fs\n>     .globStatus(new Path(path, \"*/*.parquet\"))\n>     .map({ status => HadoopInputFile.fromStatus(status, sc.hadoopConfiguration) })\n>     .map({ inputFile =>\n>       DataFiles\n>         .builder(table.spec)\n>         .withInputFile(inputFile)\n>         .withMetrics(ParquetUtil.fileMetrics(inputFile, MetricsConfig.getDefault))\n>         .withPartitionPath(new Path(inputFile.location).getParent.getName)\n>         .build\n>     })\n>     .toSeq\n> }\n> \n> // Write dataframe as raw parquet\n> (\n>   df1\n>     .withColumn(\"ts_day\", date_format('ts, \"yyyy-MM-dd\"))\n>     .repartition(2)\n>     .sortWithinPartitions('ts)\n>     .write\n>     .partitionBy(\"ts_day\")\n>     .mode(\"overwrite\")\n>     .parquet(s\"$tableDir/data/commit1\")\n> )\n> \n> // Append data files to iceberg table\n> val dataFiles = getDataFiles(s\"$tableDir/data/commit1\")\n> \n> val append = table.newFastAppend\n> dataFiles.foreach(append.appendFile)\n> append.commit\n> table.refresh\n> \n> // Table data appears OK\n> spark.read.format(\"iceberg\").load(tableDir).show\n> \n> // Issue an overwrite in which the appended datafiles are deleted, then re-added\n> val overwrite = table.newOverwrite\n> dataFiles.foreach(overwrite.deleteFile)\n> dataFiles.foreach(overwrite.addFile)\n> overwrite.commit\n> table.refresh\n> \n> // Table data appears OK\n> spark.read.format(\"iceberg\").load(tableDir).show\n> \n> // Expire first snapshot (append) with file cleanup enabled\n> table.expireSnapshots.expireSnapshotId(table.snapshots.head.snapshotId).cleanExpiredFiles(true).commit\n> table.refresh\n> \n> // Table data appears OK\n> spark.read.format(\"iceberg\").load(tableDir).show\n> \n> // Write new parquet data, with one new (2021-01-21) and one overwritten (2021-01-20) partition\n> (\n>   spark\n>     .range(5L, 15L)\n>     .select(\n>       'id,\n>       concat(lit(\"value\"), 'id) as 'value,\n>       when('id < 10L, Timestamp.valueOf(\"2021-01-20 00:00:00\")).otherwise(Timestamp.valueOf(\"2021-01-21 00:00:00\")) as 'ts\n>     )\n>     .withColumn(\"ts_day\", date_format('ts, \"yyyy-MM-dd\"))\n>     .repartition(2)\n>     .sortWithinPartitions('ts)\n>     .write\n>     .partitionBy(\"ts_day\")\n>     .mode(\"overwrite\")\n>     .parquet(s\"$tableDir/data/commit2\")\n> )\n> \n> // Do an overwrite that deletes the old files from the overwritten partition\n> // (2021-01-20) and adds the fiels we just wrote for the overwritten and new\n> // partitions\n> //\n> val dataFiles2 = getDataFiles(s\"$tableDir/data/commit2\")\n> \n> val overwrite = table.newOverwrite\n> dataFiles.filter({ file => LocalDate.ofEpochDay(file.partition.get(0, classOf[Integer]).toLong) == LocalDate.of(2021, 1, 20) }).foreach(overwrite.deleteFile)\n> dataFiles2.foreach(overwrite.addFile)\n> overwrite.commit\n> table.refresh\n> \n> // Expire the second commit (the first overwrite)\n> table.expireSnapshots.expireSnapshotId(table.snapshots.head.snapshotId).cleanExpiredFiles(true).commit\n> table.refresh\n> \n> // Throws an exception because the files from the original commit for the\n> // partition 2021-01-19 have been deleted, even though they were not affected\n> // by the most recent overwrite\n> spark.read.format(\"iceberg\").load(tableDir).show\n> Clearly there's user error here (we shouldn't be deleting and re-adding the same files added in the previous snapshot), but it feels like iceberg is doing the wrong thing as well, as it deletes files that it still considers active. It feels like the right solution is either to:\n> \n> Reject the commit in step 4 with an exception\n> Warn the user that they're trying to both add and delete the same files and silently remove the affected files from the delete list\n> Detect during the expiration that the files to be deleted are still active and prevent them from getting deleted\n> —\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub <https://github.com/apache/iceberg/issues/2131>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/AADE2YPNOH7ARTMXPY2CDTTS3BTDTANCNFSM4WNIZNDQ>.\n> \n\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764830749/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764835895","html_url":"https://github.com/apache/iceberg/issues/2131#issuecomment-764835895","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2131","id":764835895,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDgzNTg5NQ==","user":{"login":"thesquelched","id":838700,"node_id":"MDQ6VXNlcjgzODcwMA==","avatar_url":"https://avatars.githubusercontent.com/u/838700?v=4","gravatar_id":"","url":"https://api.github.com/users/thesquelched","html_url":"https://github.com/thesquelched","followers_url":"https://api.github.com/users/thesquelched/followers","following_url":"https://api.github.com/users/thesquelched/following{/other_user}","gists_url":"https://api.github.com/users/thesquelched/gists{/gist_id}","starred_url":"https://api.github.com/users/thesquelched/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thesquelched/subscriptions","organizations_url":"https://api.github.com/users/thesquelched/orgs","repos_url":"https://api.github.com/users/thesquelched/repos","events_url":"https://api.github.com/users/thesquelched/events{/privacy}","received_events_url":"https://api.github.com/users/thesquelched/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:06:24Z","updated_at":"2021-01-21T18:06:24Z","author_association":"NONE","body":"> Have you tried the ExpireSnapshotsAction\r\n\r\nNegative, I wasn't aware that was a thing. Is that API public?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764835895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764837589","html_url":"https://github.com/apache/iceberg/issues/2131#issuecomment-764837589","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2131","id":764837589,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDgzNzU4OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:09:08Z","updated_at":"2021-01-21T18:09:08Z","author_association":"MEMBER","body":"https://iceberg.apache.org/maintenance/ Yep Check out the second code\nsample under ExpireSnapshots\n\nOn Thu, Jan 21, 2021 at 12:06 PM Scott Kruger <notifications@github.com>\nwrote:\n\n> Have you tried the ExpireSnapshotsAction\n>\n> Negative, I wasn't aware that was a thing. Is that API public?\n>\n> —\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/2131#issuecomment-764835895>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YOPO5B3EQPZ65F3PSLS3BULBANCNFSM4WNIZNDQ>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764837589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764847971","html_url":"https://github.com/apache/iceberg/issues/2131#issuecomment-764847971","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2131","id":764847971,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg0Nzk3MQ==","user":{"login":"thesquelched","id":838700,"node_id":"MDQ6VXNlcjgzODcwMA==","avatar_url":"https://avatars.githubusercontent.com/u/838700?v=4","gravatar_id":"","url":"https://api.github.com/users/thesquelched","html_url":"https://github.com/thesquelched","followers_url":"https://api.github.com/users/thesquelched/followers","following_url":"https://api.github.com/users/thesquelched/following{/other_user}","gists_url":"https://api.github.com/users/thesquelched/gists{/gist_id}","starred_url":"https://api.github.com/users/thesquelched/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thesquelched/subscriptions","organizations_url":"https://api.github.com/users/thesquelched/orgs","repos_url":"https://api.github.com/users/thesquelched/repos","events_url":"https://api.github.com/users/thesquelched/events{/privacy}","received_events_url":"https://api.github.com/users/thesquelched/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:26:56Z","updated_at":"2021-01-21T18:26:56Z","author_association":"NONE","body":"I noticed that there's no equivalent in `ExpireSnapshotsAction` to `ExpireSnapshots.cleanExpiredFiles()`; does that mean that the former always cleans expired files?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764847971/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764851225","html_url":"https://github.com/apache/iceberg/issues/2131#issuecomment-764851225","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2131","id":764851225,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg1MTIyNQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:32:47Z","updated_at":"2021-01-21T18:32:47Z","author_association":"MEMBER","body":"There is an method \"expire\" which just returns the dataset of files that would be removed without removing files if you like, but if you just want to remove snapshots without cleaning files it should be essentially the same as the table API. The big difference in Table and Action implementations is in identifying which files need to be cleaned.\r\n\r\n  /**\r\n   * Expires snapshots and commits the changes to the table, returning a Dataset of files to delete.\r\n   * <p>\r\n   * This does not delete data files. To delete data files, run {@link #execute()}.\r\n   * <p>\r\n   * This may be called before or after {@link #execute()} is called to return the expired file list.\r\n   *\r\n   * @return a Dataset of files that are no longer referenced by the table\r\n   */\r\n  public Dataset<Row> expire() {","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764851225/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764855499","html_url":"https://github.com/apache/iceberg/issues/1617#issuecomment-764855499","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1617","id":764855499,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg1NTQ5OQ==","user":{"login":"anuragmantri","id":13743212,"node_id":"MDQ6VXNlcjEzNzQzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/13743212?v=4","gravatar_id":"","url":"https://api.github.com/users/anuragmantri","html_url":"https://github.com/anuragmantri","followers_url":"https://api.github.com/users/anuragmantri/followers","following_url":"https://api.github.com/users/anuragmantri/following{/other_user}","gists_url":"https://api.github.com/users/anuragmantri/gists{/gist_id}","starred_url":"https://api.github.com/users/anuragmantri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuragmantri/subscriptions","organizations_url":"https://api.github.com/users/anuragmantri/orgs","repos_url":"https://api.github.com/users/anuragmantri/repos","events_url":"https://api.github.com/users/anuragmantri/events{/privacy}","received_events_url":"https://api.github.com/users/anuragmantri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:40:52Z","updated_at":"2021-01-21T18:56:34Z","author_association":"CONTRIBUTOR","body":"We've put together a [design doc](https://docs.google.com/document/d/1RDEjJAVEXg1csRzyzTuM634L88vvI0iDHNQQK3kOVR0/edit?usp=sharing) for this proposal. We thought through a few scenarios and added an implementation. We will be glad to consider other ideas as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764855499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764858662","html_url":"https://github.com/apache/iceberg/pull/2126#issuecomment-764858662","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2126","id":764858662,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg1ODY2Mg==","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:46:20Z","updated_at":"2021-01-21T18:46:20Z","author_association":"CONTRIBUTOR","body":"Thank @pvary @marton-bod for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764858662/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764862696","html_url":"https://github.com/apache/iceberg/pull/2022#issuecomment-764862696","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2022","id":764862696,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg2MjY5Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T18:53:33Z","updated_at":"2021-01-21T18:53:33Z","author_association":"CONTRIBUTOR","body":"Thanks @dilipbiswal and @mehtaashish23! Looks good.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764862696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764889511","html_url":"https://github.com/apache/iceberg/pull/1972#issuecomment-764889511","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1972","id":764889511,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDg4OTUxMQ==","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T19:39:36Z","updated_at":"2021-01-21T19:39:36Z","author_association":"CONTRIBUTOR","body":"@rdblue I agree, first writing with Beam, and computing statistics is very wasteful. Also, Beam isn't native to object stores (some renaming going on), so I'd have to fix that in the Beam codebase as well.\r\n\r\nGot the Iceberg writers working today. Took less code than I anticipated. It is still very rough, so please don't look at the code :) Will clean this up tomorrow and add tests! Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764889511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764908410","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-764908410","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":764908410,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDkwODQxMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T20:13:12Z","updated_at":"2021-01-21T20:13:12Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @holdenk, will you have time to work on this one? I think it is quite important since our schema evolution will break if someone renames or drops a column that is referenced by the metrics config. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764908410/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764912823","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-764912823","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":764912823,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDkxMjgyMw==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T20:20:58Z","updated_at":"2021-01-21T20:20:58Z","author_association":"CONTRIBUTOR","body":"Yeah I'm happy to do the follow on task :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764912823/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764913239","html_url":"https://github.com/apache/iceberg/issues/2079#issuecomment-764913239","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2079","id":764913239,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDkxMzIzOQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T20:21:38Z","updated_at":"2021-01-21T20:21:38Z","author_association":"CONTRIBUTOR","body":"Thanks, @holdenk!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764913239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764936126","html_url":"https://github.com/apache/iceberg/issues/1617#issuecomment-764936126","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1617","id":764936126,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDkzNjEyNg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-21T20:55:20Z","updated_at":"2021-01-21T20:55:20Z","author_association":"CONTRIBUTOR","body":"Thanks for the design doc! I wonder if this can be done through changes in Catalog and FileIO without touching the Iceberg specification, which can be much simpler to ship without conflicting with already quite a few changes for the format v2 specifications.\r\n\r\nThe key difficulty I see is that table property is a part of the table metadata file. Therefore we cannot know if a table should use any special file path override without actually reading that file. If we have a way to know it without using FileIO, then we can decide for a specific table, all files should be read through a region-specific client for replication, or a different URI scheme for backup and HDFS federation.\r\n\r\nSo here is my alternative proposal:\r\n1. add interface `TablePropertyIO` that is dedicated to read and write table properties.\r\n2. update catalog implementations (mostly in `BaseMetastoreCatalog`) to use `TablePropertyIO` when necessary, by adding it as a part of the `TableOperations` interface similar to `FileIO io()`.\r\n3. add new table property `table-io-impl`, that can be customized to do things like replicaiton, backup, etc.\r\n4. implement those specific table `FileIO` classes.\r\n\r\nCould this proposal satisfy your requirements?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/764936126/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765024859","html_url":"https://github.com/apache/iceberg/pull/2132#issuecomment-765024859","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2132","id":765024859,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTAyNDg1OQ==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T00:16:53Z","updated_at":"2021-01-22T00:16:53Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765024859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765040351","html_url":"https://github.com/apache/iceberg/pull/1981#issuecomment-765040351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1981","id":765040351,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTA0MDM1MQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T00:56:50Z","updated_at":"2021-01-22T00:58:57Z","author_association":"CONTRIBUTOR","body":"~~So, the best I can follow, this looks good, but there's one issue I'm not clear on.  If we're just expanding the projection to include possible matches (e.g. equality case), doesn't this cause a problem where the partition values are joined in (i.e. not materialized in the data like converted Hive tables)?~~\r\n\r\n~~I assume we don't have a way to correct for that case since the recorded transform is incorrect and we cannot materialize the correct data to filter later?~~\r\n\r\nNevermind, they can't really have transforms in the partitions anyway.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765040351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765046766","html_url":"https://github.com/apache/iceberg/pull/1981#issuecomment-765046766","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1981","id":765046766,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTA0Njc2Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T01:14:27Z","updated_at":"2021-01-22T01:14:27Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews, @danielcweeks, @yyanyy, @RussellSpitzer, @jun-he, and @boroknagyz!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765046766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765049917","html_url":"https://github.com/apache/iceberg/pull/2102#issuecomment-765049917","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2102","id":765049917,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTA0OTkxNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T01:23:01Z","updated_at":"2021-01-22T01:23:01Z","author_association":"CONTRIBUTOR","body":"The only remaining issues were nits, so I merged this. Thanks @pan3793!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765049917/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765055907","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-765055907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":765055907,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTA1NTkwNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T01:41:27Z","updated_at":"2021-01-22T01:41:27Z","author_association":"CONTRIBUTOR","body":"Sorry, I got pulled away just after starting a review. I'll be able to do more tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765055907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765057986","html_url":"https://github.com/apache/iceberg/pull/2125#issuecomment-765057986","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2125","id":765057986,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTA1Nzk4Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T01:48:06Z","updated_at":"2021-01-22T01:48:06Z","author_association":"CONTRIBUTOR","body":"Looks good to me overall. Any reason why it is a draft?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765057986/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765058405","html_url":"https://github.com/apache/iceberg/pull/2125#issuecomment-765058405","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2125","id":765058405,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTA1ODQwNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T01:49:27Z","updated_at":"2021-01-22T01:49:27Z","author_association":"CONTRIBUTOR","body":"Looks like there are checkstyle issues to fix:\r\n\r\n```\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/core/src/main/java/org/apache/iceberg/hadoop/HadoopCatalog.java:32:8: Unused import - java.util.stream.Collectors. [UnusedImports]\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/core/src/main/java/org/apache/iceberg/hadoop/HadoopCatalog.java:33:8: Unused import - java.util.stream.Stream. [UnusedImports]\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/core/src/main/java/org/apache/iceberg/hadoop/HadoopCatalog.java:177: Line is longer than 120 characters (found 124). [LineLength]\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/core/src/main/java/org/apache/iceberg/hadoop/HadoopCatalog.java:177:15: '||' should be on the previous line. [OperatorWrap]\r\nError: eckstyle] [ERROR] /home/runner/work/iceberg/iceberg/core/src/main/java/org/apache/iceberg/hadoop/HadoopCatalog.java:229:20: Local variable name 's' must match pattern '^[a-z][a-zA-Z0-9]+$'. [LocalVariableName]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765058405/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765096188","html_url":"https://github.com/apache/iceberg/issues/1973#issuecomment-765096188","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1973","id":765096188,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTA5NjE4OA==","user":{"login":"EricJoy2048","id":32193458,"node_id":"MDQ6VXNlcjMyMTkzNDU4","avatar_url":"https://avatars.githubusercontent.com/u/32193458?v=4","gravatar_id":"","url":"https://api.github.com/users/EricJoy2048","html_url":"https://github.com/EricJoy2048","followers_url":"https://api.github.com/users/EricJoy2048/followers","following_url":"https://api.github.com/users/EricJoy2048/following{/other_user}","gists_url":"https://api.github.com/users/EricJoy2048/gists{/gist_id}","starred_url":"https://api.github.com/users/EricJoy2048/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EricJoy2048/subscriptions","organizations_url":"https://api.github.com/users/EricJoy2048/orgs","repos_url":"https://api.github.com/users/EricJoy2048/repos","events_url":"https://api.github.com/users/EricJoy2048/events{/privacy}","received_events_url":"https://api.github.com/users/EricJoy2048/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T03:29:09Z","updated_at":"2021-01-22T03:29:29Z","author_association":"MEMBER","body":"Is some one can help me?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765096188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765105227","html_url":"https://github.com/apache/iceberg/issues/1973#issuecomment-765105227","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1973","id":765105227,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTEwNTIyNw==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T04:00:31Z","updated_at":"2021-01-22T04:00:45Z","author_association":"CONTRIBUTOR","body":"(DISCLAIMER: I'm just a contributor and the direction is made by Iceberg community, more likely from PMC members.)\r\n\r\nI'm not sure that is supported, as you see in the Iceberg document. At least the case requires Iceberg to support partition value \"range\" for a specific data file (as your data file will be no longer bound to the single partition), which I'm not sure that is something Iceberg community would like to solve in near future. \r\n\r\nIf you have some use cases where the feature is critical, would you mind posting to dev mailing list instead and try to get traction?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765105227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765109855","html_url":"https://github.com/apache/iceberg/issues/2130#issuecomment-765109855","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2130","id":765109855,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTEwOTg1NQ==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T04:17:38Z","updated_at":"2021-01-22T04:17:38Z","author_association":"CONTRIBUTOR","body":"If your workload doesn't need to have full history of snapshots, why not doing some maintenance work in the background?\r\nSpecifically expiring snapshots: https://iceberg.apache.org/maintenance/#expire-snapshots\r\n\r\nIMHO the idea looks feasible, but it adds the complexity and makes it harder to debug so sounds like a trade-off. I'm just a contributor and others may have different opinions. It might be better to post to dev mailing list for possible improvements - it could get more traction from active committers/PMC members.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765109855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765111545","html_url":"https://github.com/apache/iceberg/issues/2130#issuecomment-765111545","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2130","id":765111545,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTExMTU0NQ==","user":{"login":"davidwilcox","id":253677,"node_id":"MDQ6VXNlcjI1MzY3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/253677?v=4","gravatar_id":"","url":"https://api.github.com/users/davidwilcox","html_url":"https://github.com/davidwilcox","followers_url":"https://api.github.com/users/davidwilcox/followers","following_url":"https://api.github.com/users/davidwilcox/following{/other_user}","gists_url":"https://api.github.com/users/davidwilcox/gists{/gist_id}","starred_url":"https://api.github.com/users/davidwilcox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidwilcox/subscriptions","organizations_url":"https://api.github.com/users/davidwilcox/orgs","repos_url":"https://api.github.com/users/davidwilcox/repos","events_url":"https://api.github.com/users/davidwilcox/events{/privacy}","received_events_url":"https://api.github.com/users/davidwilcox/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T04:23:25Z","updated_at":"2021-01-22T04:23:25Z","author_association":"NONE","body":"Thanks @HeartSaVioR! I already sent an email on the mailing list.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765111545/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765113297","html_url":"https://github.com/apache/iceberg/issues/2122#issuecomment-765113297","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2122","id":765113297,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTExMzI5Nw==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T04:29:17Z","updated_at":"2021-01-22T04:29:17Z","author_association":"CONTRIBUTOR","body":"That's a fundamental issue on \"Spark\" side, not \"Iceberg\" side. Spark only has the type \"timestamp\" which is used as \"timestamp with timezone\". Iceberg can't add the support of \"timestamp without timezone\" arbitrarily on Spark. Spark's \"user defined type\" is not a public API so Iceberg can't even expose the column of the type as UDT as well.\r\n\r\nThere still has a possibility to expose it under \"long\" type, but you'll lose the characteristic of \"timestamp\" there. If we think it's still better than \"don't support\", probably a way to move forward.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765113297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765116951","html_url":"https://github.com/apache/iceberg/issues/2130#issuecomment-765116951","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2130","id":765116951,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTExNjk1MQ==","user":{"login":"davidwilcox","id":253677,"node_id":"MDQ6VXNlcjI1MzY3Nw==","avatar_url":"https://avatars.githubusercontent.com/u/253677?v=4","gravatar_id":"","url":"https://api.github.com/users/davidwilcox","html_url":"https://github.com/davidwilcox","followers_url":"https://api.github.com/users/davidwilcox/followers","following_url":"https://api.github.com/users/davidwilcox/following{/other_user}","gists_url":"https://api.github.com/users/davidwilcox/gists{/gist_id}","starred_url":"https://api.github.com/users/davidwilcox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidwilcox/subscriptions","organizations_url":"https://api.github.com/users/davidwilcox/orgs","repos_url":"https://api.github.com/users/davidwilcox/repos","events_url":"https://api.github.com/users/davidwilcox/events{/privacy}","received_events_url":"https://api.github.com/users/davidwilcox/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T04:41:56Z","updated_at":"2021-01-22T04:41:56Z","author_association":"NONE","body":"Looking at this a bit more, I think that this was actually fixed about six months ago in this commit: a5d105d20a1ad816d9a662901780195da7a450fb\r\n\r\nNotice that the call to `io.newInputFile` got moved into a lazy call instead of an eager call. I must still be using an old version of Iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765116951/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765230938","html_url":"https://github.com/apache/iceberg/issues/2133#issuecomment-765230938","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2133","id":765230938,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTIzMDkzOA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-22T08:28:02Z","updated_at":"2021-01-22T08:28:02Z","author_association":"CONTRIBUTOR","body":"Currently flink syntax does not support `CREATE TABLE IF NOT EXISTS` ([doc](https://ci.apache.org/projects/flink/flink-docs-stable/dev/table/sql/create.html#create-table)), I think it should be a flink issue, we should create a flink issue to impove it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/765230938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]