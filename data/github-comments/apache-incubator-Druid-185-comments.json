[{"url":"https://api.github.com/repos/apache/druid/issues/comments/382484584","html_url":"https://github.com/apache/druid/issues/5658#issuecomment-382484584","issue_url":"https://api.github.com/repos/apache/druid/issues/5658","id":382484584,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjQ4NDU4NA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-18T18:29:06Z","updated_at":"2018-04-18T18:29:06Z","author_association":"CONTRIBUTOR","body":"@himanshug it doesn't always happen, but sometimes does. I'll dig this further to find more clues. Thanks for the detailed comments.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382484584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382488555","html_url":"https://github.com/apache/druid/issues/5661#issuecomment-382488555","issue_url":"https://api.github.com/repos/apache/druid/issues/5661","id":382488555,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjQ4ODU1NQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-18T18:42:16Z","updated_at":"2018-04-18T18:42:16Z","author_association":"CONTRIBUTOR","body":"@JeKuOrdina, thank you for the reporting! This was introduced in https://github.com/druid-io/druid/pull/5054. I'll reopen this issue.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382488555/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382489645","html_url":"https://github.com/apache/druid/pull/5597#issuecomment-382489645","issue_url":"https://api.github.com/repos/apache/druid/issues/5597","id":382489645,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjQ4OTY0NQ==","user":{"login":"scrawfor","id":7061689,"node_id":"MDQ6VXNlcjcwNjE2ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7061689?v=4","gravatar_id":"","url":"https://api.github.com/users/scrawfor","html_url":"https://github.com/scrawfor","followers_url":"https://api.github.com/users/scrawfor/followers","following_url":"https://api.github.com/users/scrawfor/following{/other_user}","gists_url":"https://api.github.com/users/scrawfor/gists{/gist_id}","starred_url":"https://api.github.com/users/scrawfor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scrawfor/subscriptions","organizations_url":"https://api.github.com/users/scrawfor/orgs","repos_url":"https://api.github.com/users/scrawfor/repos","events_url":"https://api.github.com/users/scrawfor/events{/privacy}","received_events_url":"https://api.github.com/users/scrawfor/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-18T18:45:48Z","updated_at":"2018-04-18T18:45:48Z","author_association":"CONTRIBUTOR","body":"@b-slim If by `null` filter you mean just removing the filter property, I think this has two small use cases. \r\n\r\n1) We use a (limited) reporting tool which builds our JSON queries for us, which based on user input enables or disables filters.  Without the noop filter, we have to check if any filter should be applied before adding a filter property.  With the noop filter, we can just modify the type for each individual filter to make it inactive.  It reduces the amount of logic we need to build when generating queries.\r\n\r\n2)  When developing a query, you can just disable a filter, instead of removing the filter property entirely. At least for me, this is preferable, because I know I've removed a filter and forgotten what I had in place.\r\n\r\n```\r\n\"filter\": {\r\n    \"type\": \"and\",\r\n    \"fields\": [{\r\n      \"type\": \"selector\",\r\n      \"dimension\": \"profile\",\r\n      \"value\": \"my_application\"\r\n    }, {\r\n      \"type\": \"selector\",\r\n      \"dimension\": \"browser_name\",\r\n      \"value\": \"Chrome\"\r\n    }]\r\n  }\r\n```\r\nbecomes\r\n```\r\n\"filter\": {\r\n    \"type\": \"noop\",\r\n    \"fields\": [{\r\n      \"type\": \"selector\",\r\n      \"dimension\": \"profile\",\r\n      \"value\": \"premierconnect\"\r\n    }, {\r\n      \"type\": \"selector\",\r\n      \"dimension\": \"browser_name\",\r\n      \"value\": \"Chrome\"\r\n    }]\r\n  },\r\n```\r\nNow I can see what my results are without the filter, and I haven't made any large modifications to my query. If I want to re-enable my filter, I just change \"noop\" back to \"and\".","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382489645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382510263","html_url":"https://github.com/apache/druid/issues/5641#issuecomment-382510263","issue_url":"https://api.github.com/repos/apache/druid/issues/5641","id":382510263,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjUxMDI2Mw==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-18T19:58:58Z","updated_at":"2018-04-18T19:58:58Z","author_association":"CONTRIBUTOR","body":"Hi @varaga, you may have done this, but http://druid.io/community/#contributing is a good starting point. We don't currently use JIRA yet, so you can just fork the Druid repository, make a branch for your patch, and make a pull request.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382510263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382513619","html_url":"https://github.com/apache/druid/issues/5661#issuecomment-382513619","issue_url":"https://api.github.com/repos/apache/druid/issues/5661","id":382513619,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjUxMzYxOQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-18T20:10:56Z","updated_at":"2018-04-18T20:10:56Z","author_association":"CONTRIBUTOR","body":"@JeKuOrdina raised #5054.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382513619/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382538838","html_url":"https://github.com/apache/druid/pull/5441#issuecomment-382538838","issue_url":"https://api.github.com/repos/apache/druid/issues/5441","id":382538838,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjUzODgzOA==","user":{"login":"a2l007","id":4603202,"node_id":"MDQ6VXNlcjQ2MDMyMDI=","avatar_url":"https://avatars.githubusercontent.com/u/4603202?v=4","gravatar_id":"","url":"https://api.github.com/users/a2l007","html_url":"https://github.com/a2l007","followers_url":"https://api.github.com/users/a2l007/followers","following_url":"https://api.github.com/users/a2l007/following{/other_user}","gists_url":"https://api.github.com/users/a2l007/gists{/gist_id}","starred_url":"https://api.github.com/users/a2l007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/a2l007/subscriptions","organizations_url":"https://api.github.com/users/a2l007/orgs","repos_url":"https://api.github.com/users/a2l007/repos","events_url":"https://api.github.com/users/a2l007/events{/privacy}","received_events_url":"https://api.github.com/users/a2l007/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-18T21:42:46Z","updated_at":"2018-04-18T21:42:46Z","author_association":"CONTRIBUTOR","body":"@jihoonson Thanks for the review. The main reason for introducing prefetching here is to avoid holding the result set in memory as well to eliminate the need to hold a persistent SQL connection for the entire duration. As per your suggestion of prefetching a portion of the sql results in case the results are large, I was wondering how can we identify the read results from the unread ones? `HttpFirehoseFactory` makes use of the range request feature which I'm not sure if it can be done with sql results as well. \r\nI have addressed your other comments. Please review again.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382538838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382570167","html_url":"https://github.com/apache/druid/pull/5662#issuecomment-382570167","issue_url":"https://api.github.com/repos/apache/druid/issues/5662","id":382570167,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjU3MDE2Nw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-19T00:23:56Z","updated_at":"2018-04-19T00:23:56Z","author_association":"CONTRIBUTOR","body":"@jihoonson - does the returned JSON match what 0.11.0 & earlier returned? If so, this patch looks good to me.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382570167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382576660","html_url":"https://github.com/apache/druid/pull/5662#issuecomment-382576660","issue_url":"https://api.github.com/repos/apache/druid/issues/5662","id":382576660,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjU3NjY2MA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-19T01:06:57Z","updated_at":"2018-04-19T01:06:57Z","author_association":"CONTRIBUTOR","body":"@gianm good point. Fixed the result format.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382576660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382629728","html_url":"https://github.com/apache/druid/pull/5597#issuecomment-382629728","issue_url":"https://api.github.com/repos/apache/druid/issues/5597","id":382629728,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjYyOTcyOA==","user":{"login":"niketh","id":626548,"node_id":"MDQ6VXNlcjYyNjU0OA==","avatar_url":"https://avatars.githubusercontent.com/u/626548?v=4","gravatar_id":"","url":"https://api.github.com/users/niketh","html_url":"https://github.com/niketh","followers_url":"https://api.github.com/users/niketh/followers","following_url":"https://api.github.com/users/niketh/following{/other_user}","gists_url":"https://api.github.com/users/niketh/gists{/gist_id}","starred_url":"https://api.github.com/users/niketh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niketh/subscriptions","organizations_url":"https://api.github.com/users/niketh/orgs","repos_url":"https://api.github.com/users/niketh/repos","events_url":"https://api.github.com/users/niketh/events{/privacy}","received_events_url":"https://api.github.com/users/niketh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-19T06:51:36Z","updated_at":"2018-04-19T06:51:36Z","author_association":"CONTRIBUTOR","body":"@scrawfor  You can also change \"filter\" to \"afilter\" , it does the same thing :). But this is useful too, but you have to remember which filter you have replaced with noop","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382629728/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382697166","html_url":"https://github.com/apache/druid/issues/5516#issuecomment-382697166","issue_url":"https://api.github.com/repos/apache/druid/issues/5516","id":382697166,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjY5NzE2Ng==","user":{"login":"jwroblewski","id":2076482,"node_id":"MDQ6VXNlcjIwNzY0ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2076482?v=4","gravatar_id":"","url":"https://api.github.com/users/jwroblewski","html_url":"https://github.com/jwroblewski","followers_url":"https://api.github.com/users/jwroblewski/followers","following_url":"https://api.github.com/users/jwroblewski/following{/other_user}","gists_url":"https://api.github.com/users/jwroblewski/gists{/gist_id}","starred_url":"https://api.github.com/users/jwroblewski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jwroblewski/subscriptions","organizations_url":"https://api.github.com/users/jwroblewski/orgs","repos_url":"https://api.github.com/users/jwroblewski/repos","events_url":"https://api.github.com/users/jwroblewski/events{/privacy}","received_events_url":"https://api.github.com/users/jwroblewski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-19T11:11:54Z","updated_at":"2018-04-19T11:11:54Z","author_association":"NONE","body":"I was also looking into this, but bumped kafka directly to 1.1.0. Indexer pulls data from my local broker just fine, but [KafkaSupervisor](https://github.com/druid-io/druid/blob/master/extensions-core/kafka-indexing-service/src/test/java/io/druid/indexing/kafka/supervisor/KafkaSupervisorTest.java) tests fail with:\r\n\r\n```\r\njava.util.concurrent.ExecutionException: org.apache.kafka.common.errors.NotLeaderForPartitionException: This server is not the leader for that topic-partition.\r\n\tat io.druid.indexing.kafka.supervisor.KafkaSupervisorTest.addSomeEvents(KafkaSupervisorTest.java:1915)\r\n```\r\n\r\nWhen I connect to the [in-memory broker](https://github.com/druid-io/druid/blob/master/extensions-core/kafka-indexing-service/src/test/java/io/druid/indexing/kafka/supervisor/KafkaSupervisorTest.java#L164) from outside I get the following:\r\n\r\n```\r\n$ kafkacat -L -b localhost:12345\r\nMetadata for all topics (from broker 1: localhost:12345/1):\r\n 1 brokers:\r\n  broker 1 at localhost:12345\r\n 35 topics:\r\n  topic \"testTopic26\" with 3 partitions:\r\n    partition 2, leader 1, replicas: 1, isrs: 1\r\n    partition 1, leader 1, replicas: 1, isrs: 1\r\n    partition 0, leader 1, replicas: 1, isrs: 1\r\n  topic \"testTopic33\" with 3 partitions:\r\n    partition 2, leader 1, replicas: 1, isrs: 1\r\n    partition 1, leader 1, replicas: 1, isrs: 1\r\n    partition 0, leader 1, replicas: 1, isrs: 1\r\n  topic \"testTopic0\" with 3 partitions:\r\n    partition 2, leader 1, replicas: 1, isrs: 1\r\n    partition 1, leader 1, replicas: 1, isrs: 1\r\n    partition 0, leader 1, replicas: 1, isrs: 1\r\n(... and so on ...)\r\n```\r\n\r\nConsole producer fails in the same way as tests:\r\n\r\n```\r\n$ ./kafka-console-producer.sh --broker-list localhost:12345 --topic abc\r\n>test\r\n[2018-04-19 11:37:31,803] WARN [Producer clientId=console-producer] Error while fetching metadata with correlation id 1 : {abc=LEADER_NOT_AVAILABLE} (org.apache.kafka.clients.NetworkClient)\r\n[2018-04-19 11:37:31,912] WARN [Producer clientId=console-producer] Error while fetching metadata with correlation id 3 : {abc=LEADER_NOT_AVAILABLE} (org.apache.kafka.clients.NetworkClient)\r\n>[2018-04-19 11:37:33,075] WARN [Producer clientId=console-producer] Got error produce response with correlation id 5 on topic-partition abc-0, retrying (2 attempts left). Error: NOT_LEADER_FOR_PARTITION (org.apache.kafka.clients.producer.internals.Sender)\r\n[2018-04-19 11:37:33,179] WARN [Producer clientId=console-producer] Got error produce response with correlation id 7 on topic-partition abc-0, retrying (1 attempts left). Error: NOT_LEADER_FOR_PARTITION (org.apache.kafka.clients.producer.internals.Sender)\r\n[2018-04-19 11:37:33,285] WARN [Producer clientId=console-producer] Got error produce response with correlation id 9 on topic-partition abc-0, retrying (0 attempts left). Error: NOT_LEADER_FOR_PARTITION (org.apache.kafka.clients.producer.internals.Sender)\r\n[2018-04-19 11:37:33,392] ERROR Error when sending message to topic abc with key: null, value: 3 bytes with error: (org.apache.kafka.clients.producer.internals.ErrorLoggingCallback)\r\norg.apache.kafka.common.errors.NotLeaderForPartitionException: This server is not the leader for that topic-partition.\r\n```\r\n\r\nFunny enough, when I have test code talk to a 1.1.0 instance running directly on my box (so not managed by the test suite), everything is fine. \r\n\r\nIt looks like the broker instance used by test is somehow misconfigured. Copying all params from my local kafka's server.properties didn't help, though.\r\n\r\nBtw, I also tried using the 1.2.0-SNAPSHOT kafka compiled locally, but the errors were still there.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382697166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382822100","html_url":"https://github.com/apache/druid/pull/5662#issuecomment-382822100","issue_url":"https://api.github.com/repos/apache/druid/issues/5662","id":382822100,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjgyMjEwMA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-19T17:44:11Z","updated_at":"2018-04-19T17:44:11Z","author_association":"CONTRIBUTOR","body":"@jihoonson this Travis failure seems related,\r\n\r\n```\r\n  DatasourcesResourceTest.testFullGetTheDataSource:328 ClassCast com.google.comm...\r\n```\r\n\r\nI think it would be fixed if you used the suggestion from https://github.com/druid-io/druid/pull/5662#discussion_r182615139.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382822100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382834394","html_url":"https://github.com/apache/druid/issues/5516#issuecomment-382834394","issue_url":"https://api.github.com/repos/apache/druid/issues/5516","id":382834394,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjgzNDM5NA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-19T18:23:56Z","updated_at":"2018-04-19T18:23:56Z","author_association":"CONTRIBUTOR","body":"@jwroblewski Interesting… did you try enabling debug logs and seeing if the Kafka broker is logging anything interesting? You should be able to do that by editing `common/src/main/resources/log4j2.xml`.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382834394/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382836636","html_url":"https://github.com/apache/druid/pull/5583#issuecomment-382836636","issue_url":"https://api.github.com/repos/apache/druid/issues/5583","id":382836636,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjgzNjYzNg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-19T18:31:21Z","updated_at":"2018-04-19T18:31:51Z","author_association":"CONTRIBUTOR","body":"Tagged design review due to changing of defaults of important parameters like maxRowsInMemory.\r\n\r\nI am starting another review of this now.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382836636/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382837543","html_url":"https://github.com/apache/druid/pull/5662#issuecomment-382837543","issue_url":"https://api.github.com/repos/apache/druid/issues/5662","id":382837543,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjgzNzU0Mw==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-19T18:34:20Z","updated_at":"2018-04-19T18:34:20Z","author_association":"CONTRIBUTOR","body":"@gianm thanks. Addressed your comment. I also fixed the result order - it was previously always sorted.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382837543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382924110","html_url":"https://github.com/apache/druid/pull/5649#issuecomment-382924110","issue_url":"https://api.github.com/repos/apache/druid/issues/5649","id":382924110,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjkyNDExMA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-20T00:31:33Z","updated_at":"2018-04-20T00:31:33Z","author_association":"CONTRIBUTOR","body":"@gianm i have added the tests can you please take a quick look on this.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382924110/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/382925970","html_url":"https://github.com/apache/druid/pull/5662#issuecomment-382925970","issue_url":"https://api.github.com/repos/apache/druid/issues/5662","id":382925970,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjkyNTk3MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-20T00:41:50Z","updated_at":"2018-04-20T00:41:50Z","author_association":"CONTRIBUTOR","body":"Thanks - merging!","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/382925970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383130391","html_url":"https://github.com/apache/druid/issues/5516#issuecomment-383130391","issue_url":"https://api.github.com/repos/apache/druid/issues/5516","id":383130391,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzEzMDM5MQ==","user":{"login":"jwroblewski","id":2076482,"node_id":"MDQ6VXNlcjIwNzY0ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2076482?v=4","gravatar_id":"","url":"https://api.github.com/users/jwroblewski","html_url":"https://github.com/jwroblewski","followers_url":"https://api.github.com/users/jwroblewski/followers","following_url":"https://api.github.com/users/jwroblewski/following{/other_user}","gists_url":"https://api.github.com/users/jwroblewski/gists{/gist_id}","starred_url":"https://api.github.com/users/jwroblewski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jwroblewski/subscriptions","organizations_url":"https://api.github.com/users/jwroblewski/orgs","repos_url":"https://api.github.com/users/jwroblewski/repos","events_url":"https://api.github.com/users/jwroblewski/events{/privacy}","received_events_url":"https://api.github.com/users/jwroblewski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-20T15:19:35Z","updated_at":"2018-04-20T15:19:35Z","author_association":"NONE","body":"@gianm There are indeed some kafka exceptions in the logs which my IDE was swallowing before, I had to configure additional file appender to capture them. `1.2.0-SNAPSHOT` was used here, but the same happens for `1.1.0`:\r\n\r\n```\r\n2018-04-20 13:57:45,598 ERROR k.s.KafkaApis [kafka-request-handler-1] [KafkaApi-1] Error when handling request {controller_id=1,controller_epoch=1,partition_states=[{topic=abc,partition=2,controller_epoch=1,leader=1,leader_epoch=0,isr=[1],zk_version=0,replicas=[1],is_new=true},{topic=abc,partition=0,controller_epoch=1,leader=1,leader_epoch=0,isr=[1],zk_version=0,replicas=[1],is_new=true},{topic=abc,partition=1,controller_epoch=1,leader=1,leader_epoch=0,isr=[1],zk_version=0,replicas=[1],is_new=true}],live_leaders=[{id=1,host=localhost,port=13736}]}\r\njava.lang.NoClassDefFoundError: org/slf4j/event/Level\r\n\tat kafka.utils.CoreUtils$.swallow$default$3(CoreUtils.scala:83) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.log.AbstractIndex.<init>(AbstractIndex.scala:79) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.log.OffsetIndex.<init>(OffsetIndex.scala:53) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.log.LogSegment$.open(LogSegment.scala:558) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.log.Log.loadSegments(Log.scala:429) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.log.Log.<init>(Log.scala:233) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.log.Log$.apply(Log.scala:1776) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.log.LogManager$$anonfun$getOrCreateLog$1.apply(LogManager.scala:678) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.log.LogManager$$anonfun$getOrCreateLog$1.apply(LogManager.scala:646) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat scala.Option.getOrElse(Option.scala:121) ~[scala-library-2.11.12.jar:?]\r\n\tat kafka.log.LogManager.getOrCreateLog(LogManager.scala:646) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.cluster.Partition$$anonfun$getOrCreateReplica$1.apply(Partition.scala:177) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.cluster.Partition$$anonfun$getOrCreateReplica$1.apply(Partition.scala:173) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.utils.Pool.getAndMaybePut(Pool.scala:65) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.cluster.Partition.getOrCreateReplica(Partition.scala:172) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.cluster.Partition$$anonfun$6$$anonfun$8.apply(Partition.scala:259) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.cluster.Partition$$anonfun$6$$anonfun$8.apply(Partition.scala:259) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.Iterator$class.foreach(Iterator.scala:891) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1334) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.IterableLike$class.foreach(IterableLike.scala:72) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:54) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.TraversableLike$class.map(TraversableLike.scala:234) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.AbstractTraversable.map(Traversable.scala:104) ~[scala-library-2.11.12.jar:?]\r\n\tat kafka.cluster.Partition$$anonfun$6.apply(Partition.scala:259) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.cluster.Partition$$anonfun$6.apply(Partition.scala:253) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.utils.CoreUtils$.inLock(CoreUtils.scala:250) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.utils.CoreUtils$.inWriteLock(CoreUtils.scala:258) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.cluster.Partition.makeLeader(Partition.scala:253) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.server.ReplicaManager$$anonfun$makeLeaders$4.apply(ReplicaManager.scala:1161) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.server.ReplicaManager$$anonfun$makeLeaders$4.apply(ReplicaManager.scala:1159) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:130) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:130) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:236) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40) ~[scala-library-2.11.12.jar:?]\r\n\tat scala.collection.mutable.HashMap.foreach(HashMap.scala:130) ~[scala-library-2.11.12.jar:?]\r\n\tat kafka.server.ReplicaManager.makeLeaders(ReplicaManager.scala:1159) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.server.ReplicaManager.becomeLeaderOrFollower(ReplicaManager.scala:1079) ~[kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.server.KafkaApis.handleLeaderAndIsrRequest(KafkaApis.scala:183) [kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.server.KafkaApis.handle(KafkaApis.scala:108) [kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:69) [kafka_2.11-1.2.0-SNAPSHOT.jar:?]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_162]\r\nCaused by: java.lang.ClassNotFoundException: org.slf4j.event.Level\r\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:381) ~[?:1.8.0_162]\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424) ~[?:1.8.0_162]\r\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357) ~[?:1.8.0_162]\r\n\tat org.apache.maven.surefire.booter.IsolatedClassLoader.loadClass(IsolatedClassLoader.java:97) ~[?:?]\r\n\t... 43 more\r\n```\r\n\r\nThe missing `org.slf4j.event.Level` was introduced in [`slf4j-api 1.7.5`](https://www.slf4j.org/api/org/slf4j/event/Level.html), and druid is still at `1.6.4` plus indexer excludes the `slf4j-api` dependency from kafka artifact. After updating to `1.7.25` in the main pom.xml, tests are now passing!\r\n\r\nThe above also explains why I did not experience the same problem when running tests against an external kafka broker.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383130391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383164450","html_url":"https://github.com/apache/druid/pull/5441#issuecomment-383164450","issue_url":"https://api.github.com/repos/apache/druid/issues/5441","id":383164450,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzE2NDQ1MA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-20T17:20:31Z","updated_at":"2018-04-20T17:20:31Z","author_association":"CONTRIBUTOR","body":"@a2l007 thanks. I'll review soon.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383164450/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383245927","html_url":"https://github.com/apache/druid/issues/5665#issuecomment-383245927","issue_url":"https://api.github.com/repos/apache/druid/issues/5665","id":383245927,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzI0NTkyNw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-20T23:20:12Z","updated_at":"2018-04-20T23:20:12Z","author_association":"CONTRIBUTOR","body":"@jihoonson thanks for doing this! i can help as well with this","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383245927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383248883","html_url":"https://github.com/apache/druid/issues/5665#issuecomment-383248883","issue_url":"https://api.github.com/repos/apache/druid/issues/5665","id":383248883,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzI0ODg4Mw==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-20T23:44:06Z","updated_at":"2018-04-23T17:35:17Z","author_association":"CONTRIBUTOR","body":"@b-slim thanks. I haven't started yet. Please feel free to take this if you want. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383248883/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383259037","html_url":"https://github.com/apache/druid/pull/5471#issuecomment-383259037","issue_url":"https://api.github.com/repos/apache/druid/issues/5471","id":383259037,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzI1OTAzNw==","user":{"login":"samarthjain","id":1642180,"node_id":"MDQ6VXNlcjE2NDIxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1642180?v=4","gravatar_id":"","url":"https://api.github.com/users/samarthjain","html_url":"https://github.com/samarthjain","followers_url":"https://api.github.com/users/samarthjain/followers","following_url":"https://api.github.com/users/samarthjain/following{/other_user}","gists_url":"https://api.github.com/users/samarthjain/gists{/gist_id}","starred_url":"https://api.github.com/users/samarthjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samarthjain/subscriptions","organizations_url":"https://api.github.com/users/samarthjain/orgs","repos_url":"https://api.github.com/users/samarthjain/repos","events_url":"https://api.github.com/users/samarthjain/events{/privacy}","received_events_url":"https://api.github.com/users/samarthjain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-21T01:57:52Z","updated_at":"2018-04-21T01:57:52Z","author_association":"CONTRIBUTOR","body":"Addressed the review comments you left, @jihoonson . I was able to get rid of the hacky approach I took for getting hold of the complete nested query in DirectDruidClient by using it directly higher in the stack in GroupByQueryToolChest and GroupByStrategyV2. Also  fixed the failure you ran into when using a multi-level nested query. To run the integration test on my laptop, I had to add a config file and supply it's path in the ConfigFileConfigProvider. The contents of the config file looked like this:\r\n``\r\n{   \r\n   \"broker_host\": \"127.0.0.1\",\r\n   \"broker_port\": \"8082\",\r\n   \"coordinator_host\": \"127.0.0.1\",\r\n   \"coordinator_port\": \"8081\",\r\n   \"middlemanager_host\": \"127.0.0.1\",\r\n   \"middlemanager_port\":\"8090\",\r\n   \"zookeeper_hosts\": \"127.0.0.1:2181\"\r\n}\r\n``\r\n\r\nI also had to change IntegrationTestingConfigProvider to use the ConfigFileConfigProvider and not DockerConfigProvider. \r\n\r\n@nishantmonu51 - would you happen to know how can I get my newly added integration test to run automatically in the pre-checkin builds?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383259037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383308806","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383308806","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383308806,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzMwODgwNg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-21T16:01:12Z","updated_at":"2018-04-21T16:01:12Z","author_association":"CONTRIBUTOR","body":"@jon-wei I think this broke the Kerberos/Spnego Authentication work flow.\r\nIn nutshell , the credentials received by the router and handed off to broker are not valid because the token is generated for a given hostname (here the Router) thus when the Broker tries to validate the token the request gets rejected. Am not sure if rolling back the this patch is the way to go, or if we should add another mechanism for such a case where the credentials are host based and not transferable. Let me know what you think, am still going through the code to understand how it works internally... ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383308806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383308832","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383308832","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383308832,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzMwODgzMg==","user":{"login":"pjain1","id":11787983,"node_id":"MDQ6VXNlcjExNzg3OTgz","avatar_url":"https://avatars.githubusercontent.com/u/11787983?v=4","gravatar_id":"","url":"https://api.github.com/users/pjain1","html_url":"https://github.com/pjain1","followers_url":"https://api.github.com/users/pjain1/followers","following_url":"https://api.github.com/users/pjain1/following{/other_user}","gists_url":"https://api.github.com/users/pjain1/gists{/gist_id}","starred_url":"https://api.github.com/users/pjain1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjain1/subscriptions","organizations_url":"https://api.github.com/users/pjain1/orgs","repos_url":"https://api.github.com/users/pjain1/repos","events_url":"https://api.github.com/users/pjain1/events{/privacy}","received_events_url":"https://api.github.com/users/pjain1/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-21T16:01:51Z","updated_at":"2018-04-21T16:01:51Z","author_association":"MEMBER","body":"\nHello, \n\nThis employee can no longer access email on this account.  Your email will not be forwarded.\n\nIf you have a sales inquiry, please contact sales@yahoo-inc.com\n\nIf you require assistance with a legal matter, please contact legal-notices@yahoo-inc.com\n\nThank you!\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383308832/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383382677","html_url":"https://github.com/apache/druid/issues/5666#issuecomment-383382677","issue_url":"https://api.github.com/repos/apache/druid/issues/5666","id":383382677,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzM4MjY3Nw==","user":{"login":"acdn-ekeddy","id":32712164,"node_id":"MDQ6VXNlcjMyNzEyMTY0","avatar_url":"https://avatars.githubusercontent.com/u/32712164?v=4","gravatar_id":"","url":"https://api.github.com/users/acdn-ekeddy","html_url":"https://github.com/acdn-ekeddy","followers_url":"https://api.github.com/users/acdn-ekeddy/followers","following_url":"https://api.github.com/users/acdn-ekeddy/following{/other_user}","gists_url":"https://api.github.com/users/acdn-ekeddy/gists{/gist_id}","starred_url":"https://api.github.com/users/acdn-ekeddy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acdn-ekeddy/subscriptions","organizations_url":"https://api.github.com/users/acdn-ekeddy/orgs","repos_url":"https://api.github.com/users/acdn-ekeddy/repos","events_url":"https://api.github.com/users/acdn-ekeddy/events{/privacy}","received_events_url":"https://api.github.com/users/acdn-ekeddy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-22T13:44:18Z","updated_at":"2018-04-22T13:44:18Z","author_association":"NONE","body":"If I reduce the completionTimeout to PT2M,  there is no NPE. The task, however, is always marked failed.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383382677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383467063","html_url":"https://github.com/apache/druid/issues/5568#issuecomment-383467063","issue_url":"https://api.github.com/repos/apache/druid/issues/5568","id":383467063,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzQ2NzA2Mw==","user":{"login":"terry19850829","id":13132142,"node_id":"MDQ6VXNlcjEzMTMyMTQy","avatar_url":"https://avatars.githubusercontent.com/u/13132142?v=4","gravatar_id":"","url":"https://api.github.com/users/terry19850829","html_url":"https://github.com/terry19850829","followers_url":"https://api.github.com/users/terry19850829/followers","following_url":"https://api.github.com/users/terry19850829/following{/other_user}","gists_url":"https://api.github.com/users/terry19850829/gists{/gist_id}","starred_url":"https://api.github.com/users/terry19850829/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/terry19850829/subscriptions","organizations_url":"https://api.github.com/users/terry19850829/orgs","repos_url":"https://api.github.com/users/terry19850829/repos","events_url":"https://api.github.com/users/terry19850829/events{/privacy}","received_events_url":"https://api.github.com/users/terry19850829/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T06:22:10Z","updated_at":"2018-04-23T06:22:10Z","author_association":"NONE","body":"Have the same issue +1","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383467063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383529249","html_url":"https://github.com/apache/druid/issues/5516#issuecomment-383529249","issue_url":"https://api.github.com/repos/apache/druid/issues/5516","id":383529249,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzUyOTI0OQ==","user":{"login":"jwroblewski","id":2076482,"node_id":"MDQ6VXNlcjIwNzY0ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2076482?v=4","gravatar_id":"","url":"https://api.github.com/users/jwroblewski","html_url":"https://github.com/jwroblewski","followers_url":"https://api.github.com/users/jwroblewski/followers","following_url":"https://api.github.com/users/jwroblewski/following{/other_user}","gists_url":"https://api.github.com/users/jwroblewski/gists{/gist_id}","starred_url":"https://api.github.com/users/jwroblewski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jwroblewski/subscriptions","organizations_url":"https://api.github.com/users/jwroblewski/orgs","repos_url":"https://api.github.com/users/jwroblewski/repos","events_url":"https://api.github.com/users/jwroblewski/events{/privacy}","received_events_url":"https://api.github.com/users/jwroblewski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T10:29:40Z","updated_at":"2018-04-23T10:29:40Z","author_association":"NONE","body":"See https://github.com/druid-io/druid/pull/5674.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383529249/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383606655","html_url":"https://github.com/apache/druid/pull/5452#issuecomment-383606655","issue_url":"https://api.github.com/repos/apache/druid/issues/5452","id":383606655,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzYwNjY1NQ==","user":{"login":"nishantmonu51","id":5023786,"node_id":"MDQ6VXNlcjUwMjM3ODY=","avatar_url":"https://avatars.githubusercontent.com/u/5023786?v=4","gravatar_id":"","url":"https://api.github.com/users/nishantmonu51","html_url":"https://github.com/nishantmonu51","followers_url":"https://api.github.com/users/nishantmonu51/followers","following_url":"https://api.github.com/users/nishantmonu51/following{/other_user}","gists_url":"https://api.github.com/users/nishantmonu51/gists{/gist_id}","starred_url":"https://api.github.com/users/nishantmonu51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nishantmonu51/subscriptions","organizations_url":"https://api.github.com/users/nishantmonu51/orgs","repos_url":"https://api.github.com/users/nishantmonu51/repos","events_url":"https://api.github.com/users/nishantmonu51/events{/privacy}","received_events_url":"https://api.github.com/users/nishantmonu51/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T14:59:58Z","updated_at":"2018-04-23T14:59:58Z","author_association":"MEMBER","body":"@b-slim @leventov: In case there are no blocker comments on this PR, can we merge this one when travis is green ? ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383606655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383607685","html_url":"https://github.com/apache/druid/pull/5452#issuecomment-383607685","issue_url":"https://api.github.com/repos/apache/druid/issues/5452","id":383607685,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzYwNzY4NQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T15:02:48Z","updated_at":"2018-04-23T15:02:48Z","author_association":"CONTRIBUTOR","body":"no blocker from my side 👍 \r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383607685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383610687","html_url":"https://github.com/apache/druid/pull/5452#issuecomment-383610687","issue_url":"https://api.github.com/repos/apache/druid/issues/5452","id":383610687,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzYxMDY4Nw==","user":{"login":"leventov","id":609240,"node_id":"MDQ6VXNlcjYwOTI0MA==","avatar_url":"https://avatars.githubusercontent.com/u/609240?v=4","gravatar_id":"","url":"https://api.github.com/users/leventov","html_url":"https://github.com/leventov","followers_url":"https://api.github.com/users/leventov/followers","following_url":"https://api.github.com/users/leventov/following{/other_user}","gists_url":"https://api.github.com/users/leventov/gists{/gist_id}","starred_url":"https://api.github.com/users/leventov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leventov/subscriptions","organizations_url":"https://api.github.com/users/leventov/orgs","repos_url":"https://api.github.com/users/leventov/repos","events_url":"https://api.github.com/users/leventov/events{/privacy}","received_events_url":"https://api.github.com/users/leventov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T15:11:17Z","updated_at":"2018-04-23T15:11:17Z","author_association":"MEMBER","body":"I haven't finished my review.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383610687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383639142","html_url":"https://github.com/apache/druid/issues/5669#issuecomment-383639142","issue_url":"https://api.github.com/repos/apache/druid/issues/5669","id":383639142,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzYzOTE0Mg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T16:32:13Z","updated_at":"2018-04-23T16:32:22Z","author_association":"CONTRIBUTOR","body":"I think PostAggregator should have equals/hashCode methods. One reason is that they're specified directly in queries, and are used to check if two queries are equal or not (like TimeseriesQuery.equals for example). I'm not sure if this capability is needed in production code, but it is useful enough for tests that I think it makes sense to keep it. And I am not confident that it is _not_ important in production code.\r\n\r\nAggregator and BufferAggregator are different. They are more transient objects that are not meant to be serialized or compared to other objects. So I don't think they need equals or hashCode.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383639142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383651021","html_url":"https://github.com/apache/druid/pull/5649#issuecomment-383651021","issue_url":"https://api.github.com/repos/apache/druid/issues/5649","id":383651021,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzY1MTAyMQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T17:10:50Z","updated_at":"2018-04-23T17:10:50Z","author_association":"CONTRIBUTOR","body":"@gianm thanks I have added tests and the start intervals ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383651021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383656609","html_url":"https://github.com/apache/druid/pull/5674#issuecomment-383656609","issue_url":"https://api.github.com/repos/apache/druid/issues/5674","id":383656609,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzY1NjYwOQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T17:28:52Z","updated_at":"2018-04-23T17:28:52Z","author_association":"CONTRIBUTOR","body":"@jwroblewski Could you please link to #5516 in the PR description, and include a summary of what you are changing? (Old Kafka version, new Kafka version, any compatibility issues you may be aware of)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383656609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383658561","html_url":"https://github.com/apache/druid/issues/5671#issuecomment-383658561","issue_url":"https://api.github.com/repos/apache/druid/issues/5671","id":383658561,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzY1ODU2MQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T17:34:27Z","updated_at":"2018-04-23T17:34:27Z","author_association":"CONTRIBUTOR","body":"Maybe do the same for `AggregatorFactory.combine` and `AggregatorFactory.getComparator`.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383658561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383658961","html_url":"https://github.com/apache/druid/issues/5670#issuecomment-383658961","issue_url":"https://api.github.com/repos/apache/druid/issues/5670","id":383658961,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzY1ODk2MQ==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T17:35:36Z","updated_at":"2018-04-23T17:35:36Z","author_association":"CONTRIBUTOR","body":"I think it's guaranteed that the comparator will only see values that came out of `compute`. At least, if it's not guaranteed, it should be.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383658961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383677038","html_url":"https://github.com/apache/druid/pull/5280#issuecomment-383677038","issue_url":"https://api.github.com/repos/apache/druid/issues/5280","id":383677038,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzY3NzAzOA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T18:32:02Z","updated_at":"2018-04-23T18:32:02Z","author_association":"CONTRIBUTOR","body":"Hi @himanshug - have you had a chance to review my review? 😃","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383677038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383687101","html_url":"https://github.com/apache/druid/pull/5649#issuecomment-383687101","issue_url":"https://api.github.com/repos/apache/druid/issues/5649","id":383687101,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzY4NzEwMQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T19:04:35Z","updated_at":"2018-04-23T19:04:35Z","author_association":"CONTRIBUTOR","body":"@gianm thanks","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383687101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383705594","html_url":"https://github.com/apache/druid/pull/5335#issuecomment-383705594","issue_url":"https://api.github.com/repos/apache/druid/issues/5335","id":383705594,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzcwNTU5NA==","user":{"login":"nishantmonu51","id":5023786,"node_id":"MDQ6VXNlcjUwMjM3ODY=","avatar_url":"https://avatars.githubusercontent.com/u/5023786?v=4","gravatar_id":"","url":"https://api.github.com/users/nishantmonu51","html_url":"https://github.com/nishantmonu51","followers_url":"https://api.github.com/users/nishantmonu51/followers","following_url":"https://api.github.com/users/nishantmonu51/following{/other_user}","gists_url":"https://api.github.com/users/nishantmonu51/gists{/gist_id}","starred_url":"https://api.github.com/users/nishantmonu51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nishantmonu51/subscriptions","organizations_url":"https://api.github.com/users/nishantmonu51/orgs","repos_url":"https://api.github.com/users/nishantmonu51/repos","events_url":"https://api.github.com/users/nishantmonu51/events{/privacy}","received_events_url":"https://api.github.com/users/nishantmonu51/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T20:07:17Z","updated_at":"2018-04-23T20:07:17Z","author_association":"MEMBER","body":"LGTM. 👍 ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383705594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383706296","html_url":"https://github.com/apache/druid/pull/5335#issuecomment-383706296","issue_url":"https://api.github.com/repos/apache/druid/issues/5335","id":383706296,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzcwNjI5Ng==","user":{"login":"nishantmonu51","id":5023786,"node_id":"MDQ6VXNlcjUwMjM3ODY=","avatar_url":"https://avatars.githubusercontent.com/u/5023786?v=4","gravatar_id":"","url":"https://api.github.com/users/nishantmonu51","html_url":"https://github.com/nishantmonu51","followers_url":"https://api.github.com/users/nishantmonu51/followers","following_url":"https://api.github.com/users/nishantmonu51/following{/other_user}","gists_url":"https://api.github.com/users/nishantmonu51/gists{/gist_id}","starred_url":"https://api.github.com/users/nishantmonu51/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nishantmonu51/subscriptions","organizations_url":"https://api.github.com/users/nishantmonu51/orgs","repos_url":"https://api.github.com/users/nishantmonu51/repos","events_url":"https://api.github.com/users/nishantmonu51/events{/privacy}","received_events_url":"https://api.github.com/users/nishantmonu51/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T20:09:41Z","updated_at":"2018-04-23T20:09:41Z","author_association":"MEMBER","body":"@fjy: do you still have concerns in merging this PR ? ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383706296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383725532","html_url":"https://github.com/apache/druid/pull/5677#issuecomment-383725532","issue_url":"https://api.github.com/repos/apache/druid/issues/5677","id":383725532,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzcyNTUzMg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T21:14:58Z","updated_at":"2018-04-23T21:14:58Z","author_association":"CONTRIBUTOR","body":"@samarthjain is this change going to have a user-visible effect or is this just code cleanup?\r\n\r\nHow about organizing it such that the Job passes in a `Partitioner` class to the `useSortableBytesAsMapOutputKey` function? That way, we still know that the partitioner is being set properly.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383725532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383730432","html_url":"https://github.com/apache/druid/pull/5677#issuecomment-383730432","issue_url":"https://api.github.com/repos/apache/druid/issues/5677","id":383730432,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzczMDQzMg==","user":{"login":"samarthjain","id":1642180,"node_id":"MDQ6VXNlcjE2NDIxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1642180?v=4","gravatar_id":"","url":"https://api.github.com/users/samarthjain","html_url":"https://github.com/samarthjain","followers_url":"https://api.github.com/users/samarthjain/followers","following_url":"https://api.github.com/users/samarthjain/following{/other_user}","gists_url":"https://api.github.com/users/samarthjain/gists{/gist_id}","starred_url":"https://api.github.com/users/samarthjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samarthjain/subscriptions","organizations_url":"https://api.github.com/users/samarthjain/orgs","repos_url":"https://api.github.com/users/samarthjain/repos","events_url":"https://api.github.com/users/samarthjain/events{/privacy}","received_events_url":"https://api.github.com/users/samarthjain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T21:33:34Z","updated_at":"2018-04-23T21:33:34Z","author_association":"CONTRIBUTOR","body":"@gianm - this is more of a code cleanup and there shouldn't be any user facing change. It was something I discovered when I was trying to understand how the batch hadoop indexing for druid works. \r\n\r\nIt would be good to get your eyes on the code though to confirm that what jobs were doing all this while was correct i.e. they should have been using their own partitioners and not the SortableBytesPartitioner class.\r\n\r\nUpdated the pull request with your suggested change.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383730432/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383743216","html_url":"https://github.com/apache/druid/issues/5552#issuecomment-383743216","issue_url":"https://api.github.com/repos/apache/druid/issues/5552","id":383743216,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc0MzIxNg==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T22:29:03Z","updated_at":"2018-04-23T22:30:07Z","author_association":"CONTRIBUTOR","body":"I was able to get a batch ingestion task working with namenode HA with the following .xml configs on the Druid side, testing against a sequenceiq hadoop 2.7.3 docker container (I faked out one of the name nodes and also didn't really set up the shared edits/fencing in a real way):\r\n\r\nhdfs-site.xml\r\n```\r\n<property>\r\n <name>dfs.nameservices</name>\r\n <value>mycluster</value>\r\n <description>Logical name for this new nameservice</description>\r\n</property>\r\n\r\n<property>\r\n <name>dfs.ha.namenodes.mycluster</name>\r\n <value>nn1,nn2</value>\r\n <description>Unique identifiers for each NameNode in the nameservice</description>\r\n</property>\r\n\r\n<property>\r\n <name>dfs.namenode.rpc-address.mycluster.nn1</name>\r\n <value>hadoop273:8020</value>\r\n</property>\r\n\r\n<property>\r\n <name>dfs.namenode.http-address.mycluster.nn1</name>\r\n <value>hadoop273:50070</value>\r\n</property>\r\n\r\n<property>\r\n <name>dfs.namenode.rpc-address.mycluster.nn2</name>\r\n <value>xfake2:8020</value>\r\n</property>\r\n\r\n<property>\r\n <name>dfs.namenode.http-address.mycluster.nn2</name>\r\n <value>xfake2:50070</value>\r\n</property>\r\n\r\n<property>\r\n  <name>dfs.namenode.shared.edits.dir</name>\r\n  <value>file:///tmp</value>\r\n</property>\r\n\r\n<property>\r\n <name>dfs.client.failover.proxy.provider.mycluster</name>\r\n <value>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider</value>\r\n</property>\r\n\r\n<property>\r\n <name>dfs.ha.fencing.methods</name>\r\n <value>shell(/bin/true)</value>\r\n</property>\r\n```\r\n\r\ncore-site.xml:\r\n```\r\n      <property>\r\n          <name>fs.defaultFS</name>\r\n            <value>hdfs://mycluster</value>\r\n      </property>\r\n```\r\n\r\n@aubdiy Does the ingestion task work for you if you have the equivalent properties set in the hadoop .xml files on the Druid classpath?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383743216/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383743493","html_url":"https://github.com/apache/druid/issues/5552#issuecomment-383743493","issue_url":"https://api.github.com/repos/apache/druid/issues/5552","id":383743493,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc0MzQ5Mw==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T22:30:17Z","updated_at":"2018-04-23T22:30:57Z","author_association":"CONTRIBUTOR","body":"@b-slim @nishantmonu51 \r\n\r\nHave you been able to successfully run batch ingestion with namenode HA on Druid 0.12.0 with HDP?\r\n\r\nWe've seen a customer hit this exception with Druid 0.12.0+ HDP, from investigating it seemed like the job.xml configuration was not picked up by the Druid mapper tasks (The job.xml in their mapper's local temp dir had the right configs, but those configs were not present in the Configuration object when that UnknownHostException is thrown in HdfsDataSegmentPusher)\r\n\r\nIt'd be interesting to know if this is a general Druid + Hadoop issue or one specific to Druid + HDP, or if everything is fine and this issue is caused purely by configuration problems.\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383743493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383745426","html_url":"https://github.com/apache/druid/issues/5552#issuecomment-383745426","issue_url":"https://api.github.com/repos/apache/druid/issues/5552","id":383745426,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc0NTQyNg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T22:40:11Z","updated_at":"2018-04-23T22:40:11Z","author_association":"CONTRIBUTOR","body":"@jon-wei am sure we have positive runs Druid 12 + HDP 3.0 to be released soon (Hadoop 3) we do not have tests for Druid 12 with early version of Hadoop since we don't support such bundle (Our last release was based of Druid 10+some patches) ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383745426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383749508","html_url":"https://github.com/apache/druid/issues/5552#issuecomment-383749508","issue_url":"https://api.github.com/repos/apache/druid/issues/5552","id":383749508,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc0OTUwOA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:01:32Z","updated_at":"2018-04-23T23:01:32Z","author_association":"CONTRIBUTOR","body":"@b-slim got it, thanks","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383749508/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383751198","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383751198","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383751198,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc1MTE5OA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:11:28Z","updated_at":"2018-04-23T23:11:28Z","author_association":"CONTRIBUTOR","body":"@jon-wei can you please take a look at this question? am still unsure why can't we consider the hop from router to broker is like the hop from broker to historical? \r\nAlso in all cases before the query gets to the proxyServelet the Router did run all the authentication chains so am not sure what is the security issue? ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383751198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383752743","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383752743","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383752743,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc1Mjc0Mw==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:20:10Z","updated_at":"2018-04-23T23:20:19Z","author_association":"CONTRIBUTOR","body":"@b-slim The hops are different because the broker verifies permissions on the request, but the router doesn't. So it's ok for the broker to use an escalated connection to talk to historicals (since it has already verified that the end user access is authorized). But it's not ok for the router to use an escalated connection to talk to brokers. The only thing the router has done is verify that the end user is authenticated, but it has not verified that it is authorized.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383752743/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383753208","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383753208","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383753208,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc1MzIwOA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:22:46Z","updated_at":"2018-04-23T23:22:46Z","author_association":"CONTRIBUTOR","body":"@b-slim \r\n\r\n> am still unsure why can't we consider the hop from router to broker is like the hop from broker to historical?\r\n\r\nThe router only passes on requests without performing any authorization checks (like, does a user have access rights to query datasource X?), the router isn't aware of the semantics of specific requests so it can't really check that, so the original identity of the requester needs to be passed on to the forwarding destination\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383753208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383753586","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383753586","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383753586,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc1MzU4Ng==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:24:39Z","updated_at":"2018-04-23T23:24:39Z","author_association":"CONTRIBUTOR","body":"@b-slim does the router -> broker work with Kerberos if you set `druid.auth.authenticator.kerberos.cookieSignatureSecret` to the same value on both router and broker?\r\n\r\nI seem to recall needing to do that when I was testing this patch\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383753586/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383754112","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383754112","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383754112,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc1NDExMg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:27:36Z","updated_at":"2018-04-23T23:29:12Z","author_association":"CONTRIBUTOR","body":"@gianm why can't the router do the authorized stuff, it can do that as well? \r\nseems like the answer is https://github.com/druid-io/druid/pull/5322#issuecomment-383753208\r\nNVM. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383754112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383754608","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383754608","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383754608,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc1NDYwOA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:30:20Z","updated_at":"2018-04-23T23:30:20Z","author_association":"CONTRIBUTOR","body":"@jon-wei i will try your suggestion and update this. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383754608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383757014","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383757014","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383757014,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc1NzAxNA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:44:39Z","updated_at":"2018-04-23T23:46:20Z","author_association":"CONTRIBUTOR","body":"@jon-wei that config did not fix the issue still getting denied when the query reach the Broker.\r\nI think this means we are left with 2 options:\r\n- 1 to escalate with a Do As client kind of thingy not sure. \r\n- 2 Escalate as root Druid and attache the verified ClientId and let the Broker do the Authorize stuff.\r\n\r\nIn both cases we need to add hook to create an escalated client to be used between Router and Broker. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383757014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383757302","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383757302","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383757302,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc1NzMwMg==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:46:15Z","updated_at":"2018-04-23T23:46:15Z","author_association":"CONTRIBUTOR","body":"@b-slim In theory the router could do all the authorization and forward requests as an escalated user, but I think that puts too much responsibility on the router in terms of needing to understand how to authorize requests. For example, suppose the router needs to forward a SQL query. To authorize such a query the SQL query needs to be parsed and planned into Druid queries, so the router would need to run a SQL planner, that workload/burden of knowledge is better left to the actual endpoints. \r\n\r\nOr suppose the router is forwarding coordinator/overlord requests (https://github.com/druid-io/druid/pull/5369), I don't think its right to make the router need to understand the semantics of every possible request.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383757302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383758867","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383758867","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383758867,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc1ODg2Nw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-23T23:54:53Z","updated_at":"2018-04-23T23:54:53Z","author_association":"CONTRIBUTOR","body":"@jon-wei you bring very good points but i think that adding the hook and giving the implementor of the module the choice of doing every thing at the Router or at Broker is a valid design choice as well. For instance the current Kerberos implementation doesn't do any authorization stuff thus there is no need really to make the Broker do the work. \r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383758867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383763489","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383763489","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383763489,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc2MzQ4OQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T00:22:56Z","updated_at":"2018-04-24T00:22:56Z","author_association":"CONTRIBUTOR","body":"> For instance the current Kerberos implementation doesn't do any authorization stuff thus there is no need really to make the Broker do the work.\r\n\r\nSuppose the Kerberos authenticator is being used in conjunction with an authorization system, e.g. a role-based access control system, it would be incorrect for the Kerberos authenticator to use an escalated identity to forward requests (i.e., it's a big security hole that would bypass all authorization checks). \r\n\r\n> I think this means we are left with 2 options:\r\n1 to escalate with a Do As client kind of thingy not sure.\r\n2 Escalate as root Druid and attache the verified ClientId and let the Broker do the Authorize stuff.\r\nIn both cases we need to add hook to create an escalated client to be used between Router and Broker.\r\n\r\nIf it's the only option, I suppose we could build a way to send escalated requests with a subidentity, where the subidentity is used for authorization checks at the forwarding endpoint but I think it'd be good to see if there are other options. \r\n\r\nI'm being wary of adding escalated communication paths because of potential for privilege escalation bugs (ideally I think the broker -> historical request path should inherit the original request credentials as well, vs. using escalated comms, but that's not implemented right now).\r\n\r\nI'm not deeply familiar with Kerberos, is there something we could do with ticket forwarding here (https://web.mit.edu/kerberos/krb5-1.13/doc/user/tkt_mgmt.html)? Is this related?\r\n\r\n---------------\r\n\r\nAs a side note, how do you test your Kerberos stuff? Do you have any testing VMs/dockerfiles that are publicly available or you can share? \r\n\r\nI set up a kerberos environment from scratch sometime last year, it was quite a pain, wondering if you know of any more convenient tools.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383763489/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383764435","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383764435","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383764435,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc2NDQzNQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T00:29:17Z","updated_at":"2018-04-24T00:29:17Z","author_association":"CONTRIBUTOR","body":"> As a side note, how do you test your Kerberos stuff? Do you have any testing VMs/dockerfiles that are publicly available or you can share?\r\n\r\n> I set up a kerberos environment from scratch sometime last year, it was quite a pain, wondering if you know of any more convenient tools.\r\n\r\n@jon-wei yes this task is very painful, i tried to do the docker thingy but it did not really work kerberos depends on lot of other services like DNS and other stuff thus am relying on a pre-deployed internal test cluster where i attache a remote debugger.... ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383764435/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383765810","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383765810","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383765810,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc2NTgxMA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T00:38:46Z","updated_at":"2018-04-24T00:39:16Z","author_association":"CONTRIBUTOR","body":"> In both cases we need to add hook to create an escalated client to be used between Router and Broker.\r\n\r\nTo clarify what I was saying above, maybe we do need to add additional hooks to the auth system to support this use case, but I think it'd be good to minimize \"send as internal superuser\" cases when possible.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383765810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383766879","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383766879","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383766879,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc2Njg3OQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T00:45:52Z","updated_at":"2018-04-24T00:45:52Z","author_association":"CONTRIBUTOR","body":"> but I think it'd be good to minimize \"send as internal superuser\" cases when possible.\r\n\r\n@jon-wei I do agree, am looking at how this can be done with a clean design.\r\n am thinking one way is to decouple Authorization and Authentication, what you think? ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383766879/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383780214","html_url":"https://github.com/apache/druid/issues/5566#issuecomment-383780214","issue_url":"https://api.github.com/repos/apache/druid/issues/5566","id":383780214,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc4MDIxNA==","user":{"login":"lianglingbo","id":14233280,"node_id":"MDQ6VXNlcjE0MjMzMjgw","avatar_url":"https://avatars.githubusercontent.com/u/14233280?v=4","gravatar_id":"","url":"https://api.github.com/users/lianglingbo","html_url":"https://github.com/lianglingbo","followers_url":"https://api.github.com/users/lianglingbo/followers","following_url":"https://api.github.com/users/lianglingbo/following{/other_user}","gists_url":"https://api.github.com/users/lianglingbo/gists{/gist_id}","starred_url":"https://api.github.com/users/lianglingbo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lianglingbo/subscriptions","organizations_url":"https://api.github.com/users/lianglingbo/orgs","repos_url":"https://api.github.com/users/lianglingbo/repos","events_url":"https://api.github.com/users/lianglingbo/events{/privacy}","received_events_url":"https://api.github.com/users/lianglingbo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T02:09:51Z","updated_at":"2018-04-24T02:09:51Z","author_association":"NONE","body":"how can i use nested groupBy ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383780214/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383784045","html_url":"https://github.com/apache/druid/pull/5684#issuecomment-383784045","issue_url":"https://api.github.com/repos/apache/druid/issues/5684","id":383784045,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc4NDA0NQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T02:34:30Z","updated_at":"2018-04-24T02:34:30Z","author_association":"CONTRIBUTOR","body":"@jon-wei  LGTM but i don't this this is a bug, i bet it is a config issue. \r\nAlso am not really sure how the Reducer will be able to pick the right configs if my memory is correct the classpath is the same. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383784045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383795045","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383795045","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383795045,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc5NTA0NQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T03:51:06Z","updated_at":"2018-04-24T04:01:00Z","author_association":"CONTRIBUTOR","body":"> am thinking one way is to decouple Authorization and Authentication, what you think?\r\n\r\nHm, I think the current system is pretty decoupled, it was intended to allow multiple authentication schemes to interoperate with various authorization mechanisms, the request flow is at a high level like the following:\r\n- Authenticator checks incoming request, determines and validates the identity of the user, generates an AuthenticationResult (contains a string that identifies the user and the name of the authorizer that should handle the request, the result is intended to be fed into any valid Authorizer implementation)\r\n- Authorizer only looks at the AuthenticationResult attached to the request to make authorization decisions, it doesn't care how the Authenticator determined that result","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383795045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383797095","html_url":"https://github.com/apache/druid/pull/5684#issuecomment-383797095","issue_url":"https://api.github.com/repos/apache/druid/issues/5684","id":383797095,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc5NzA5NQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T04:07:13Z","updated_at":"2018-04-24T04:07:13Z","author_association":"CONTRIBUTOR","body":"@b-slim Thanks for the review, I removed the bug label for now","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383797095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383797800","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383797800","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383797800,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzc5NzgwMA==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T04:12:35Z","updated_at":"2018-04-24T04:13:25Z","author_association":"CONTRIBUTOR","body":"Well, decoupled as much as I think they can be, authorization needs some kind of authenticated \r\n\"user identity\" to make any sense","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383797800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383873067","html_url":"https://github.com/apache/druid/issues/5687#issuecomment-383873067","issue_url":"https://api.github.com/repos/apache/druid/issues/5687","id":383873067,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzg3MzA2Nw==","user":{"login":"lianglingbo","id":14233280,"node_id":"MDQ6VXNlcjE0MjMzMjgw","avatar_url":"https://avatars.githubusercontent.com/u/14233280?v=4","gravatar_id":"","url":"https://api.github.com/users/lianglingbo","html_url":"https://github.com/lianglingbo","followers_url":"https://api.github.com/users/lianglingbo/followers","following_url":"https://api.github.com/users/lianglingbo/following{/other_user}","gists_url":"https://api.github.com/users/lianglingbo/gists{/gist_id}","starred_url":"https://api.github.com/users/lianglingbo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lianglingbo/subscriptions","organizations_url":"https://api.github.com/users/lianglingbo/orgs","repos_url":"https://api.github.com/users/lianglingbo/repos","events_url":"https://api.github.com/users/lianglingbo/events{/privacy}","received_events_url":"https://api.github.com/users/lianglingbo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T09:51:41Z","updated_at":"2018-04-24T09:51:41Z","author_association":"NONE","body":"check your address ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383873067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383875493","html_url":"https://github.com/apache/druid/issues/5687#issuecomment-383875493","issue_url":"https://api.github.com/repos/apache/druid/issues/5687","id":383875493,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzg3NTQ5Mw==","user":{"login":"davidkeeper","id":38687149,"node_id":"MDQ6VXNlcjM4Njg3MTQ5","avatar_url":"https://avatars.githubusercontent.com/u/38687149?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkeeper","html_url":"https://github.com/davidkeeper","followers_url":"https://api.github.com/users/davidkeeper/followers","following_url":"https://api.github.com/users/davidkeeper/following{/other_user}","gists_url":"https://api.github.com/users/davidkeeper/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkeeper/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkeeper/subscriptions","organizations_url":"https://api.github.com/users/davidkeeper/orgs","repos_url":"https://api.github.com/users/davidkeeper/repos","events_url":"https://api.github.com/users/davidkeeper/events{/privacy}","received_events_url":"https://api.github.com/users/davidkeeper/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T10:00:07Z","updated_at":"2018-04-24T10:00:07Z","author_association":"NONE","body":"@lianglingbo sorry I can't understand what's your meaning, all config points a localhost  address in a single node machine.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383875493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383948990","html_url":"https://github.com/apache/druid/pull/5674#issuecomment-383948990","issue_url":"https://api.github.com/repos/apache/druid/issues/5674","id":383948990,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzk0ODk5MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T14:18:33Z","updated_at":"2018-04-24T14:18:33Z","author_association":"CONTRIBUTOR","body":"@jwroblewski I'm seeing some errors on the CI build (https://travis-ci.org/druid-io/druid/jobs/370030347) like the following. They seem to all be in KafkaIndexTaskTest. Did you run into these when testing locally?\r\n\r\n```\r\ntestRunWithPauseAndResume[isIncrementalHandoffSupported = true](io.druid.indexing.kafka.KafkaIndexTaskTest)  Time elapsed: 60.731 sec  <<< ERROR!\r\njava.lang.Exception: test timed out after 60000 milliseconds\r\n\tat java.lang.Thread.sleep(Native Method)\r\n\tat io.druid.indexing.kafka.KafkaIndexTaskTest.testRunWithPauseAndResume(KafkaIndexTaskTest.java:1615)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)\r\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$StatementThread.run(FailOnTimeout.java:74)\r\ntestRunOneTaskTwoPartitions[isIncrementalHandoffSupported = true](io.druid.indexing.kafka.KafkaIndexTaskTest)  Time elapsed: 60.649 sec  <<< ERROR!\r\njava.lang.Exception: test timed out after 60000 milliseconds\r\n\tat sun.misc.Unsafe.park(Native Method)\r\n\tat java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n\tat java.util.concurrent.FutureTask.awaitDone(FutureTask.java:429)\r\n\tat java.util.concurrent.FutureTask.get(FutureTask.java:191)\r\n\tat io.druid.indexing.kafka.KafkaIndexTaskTest.testRunOneTaskTwoPartitions(KafkaIndexTaskTest.java:1391)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)\r\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n\tat org.junit.internal.runners.statements.FailOnTimeout$StatementThread.run(FailOnTimeout.java:74)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383948990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383955297","html_url":"https://github.com/apache/druid/pull/5688#issuecomment-383955297","issue_url":"https://api.github.com/repos/apache/druid/issues/5688","id":383955297,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzk1NTI5Nw==","user":{"login":"kaijianding","id":8663725,"node_id":"MDQ6VXNlcjg2NjM3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/8663725?v=4","gravatar_id":"","url":"https://api.github.com/users/kaijianding","html_url":"https://github.com/kaijianding","followers_url":"https://api.github.com/users/kaijianding/followers","following_url":"https://api.github.com/users/kaijianding/following{/other_user}","gists_url":"https://api.github.com/users/kaijianding/gists{/gist_id}","starred_url":"https://api.github.com/users/kaijianding/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaijianding/subscriptions","organizations_url":"https://api.github.com/users/kaijianding/orgs","repos_url":"https://api.github.com/users/kaijianding/repos","events_url":"https://api.github.com/users/kaijianding/events{/privacy}","received_events_url":"https://api.github.com/users/kaijianding/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T14:34:07Z","updated_at":"2018-04-24T14:34:07Z","author_association":"CONTRIBUTOR","body":"@niketh could you review this PR cause it is related to your PR #5570 ?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383955297/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383957080","html_url":"https://github.com/apache/druid/pull/5674#issuecomment-383957080","issue_url":"https://api.github.com/repos/apache/druid/issues/5674","id":383957080,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzk1NzA4MA==","user":{"login":"jwroblewski","id":2076482,"node_id":"MDQ6VXNlcjIwNzY0ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2076482?v=4","gravatar_id":"","url":"https://api.github.com/users/jwroblewski","html_url":"https://github.com/jwroblewski","followers_url":"https://api.github.com/users/jwroblewski/followers","following_url":"https://api.github.com/users/jwroblewski/following{/other_user}","gists_url":"https://api.github.com/users/jwroblewski/gists{/gist_id}","starred_url":"https://api.github.com/users/jwroblewski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jwroblewski/subscriptions","organizations_url":"https://api.github.com/users/jwroblewski/orgs","repos_url":"https://api.github.com/users/jwroblewski/repos","events_url":"https://api.github.com/users/jwroblewski/events{/privacy}","received_events_url":"https://api.github.com/users/jwroblewski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T14:38:52Z","updated_at":"2018-04-24T14:38:52Z","author_association":"NONE","body":"@gianm Funny thing, I have two workspaces with this code, one passes, the other produces the same error as travis. Kafka seems to be looping there with the following msg, until test case times out:\r\n```\r\n2018-04-24 14:06:20,855 WARN i.d.i.k.KafkaIndexTask [kafka-task-test-2] Retrying in 100ms\r\n2018-04-24 14:06:20,958 WARN i.d.i.k.KafkaIndexTask [kafka-task-test-2] OffsetOutOfRangeException with message [Offsets out of range with no configured reset policy for partitions: {topic43-0=2}]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383957080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383957228","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383957228","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383957228,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzk1NzIyOA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T14:39:11Z","updated_at":"2018-04-24T14:39:11Z","author_association":"CONTRIBUTOR","body":"Due to reasons raised by @jon-wei in https://github.com/druid-io/druid/pull/5322#issuecomment-383757302, I think we should keep the responsibility for verifying authorization at the final destination, not the router. The router would need the ability to understand every possible endpoint, and there are too many.\r\n\r\nThe DoAs / subidentity stuff you are talking about sounds related to #5436 -- we might be able to solve two issues with one approach. Although for #5436 I didn't have it being security critical in mind. I was just thinking of it being some extra metadata for metrics, rather than being used for downstream authorization.\r\n\r\n> @b-slim does the router -> broker work with Kerberos if you set \r\n druid.auth.authenticator.kerberos.cookieSignatureSecret to the same value on both router and broker?\r\n>\r\n> I seem to recall needing to do that when I was testing this patch\r\n\r\n@jon-wei were you testing on a single machine with `druid.auth.authenticator.kerberos.serverPrincipal` set the same on both the broker and router? Or were the values different? From my reading of how SPNEGO works, the method we are using today may only work if the broker and router have the same server principal name (SPN).\r\n\r\n> I'm being wary of adding escalated communication paths because of potential for privilege escalation bugs (ideally I think the broker -> historical request path should inherit the original request credentials as well, vs. using escalated comms, but that's not implemented right now).\r\n\r\nReading over this ticket it doesn't sound like inheriting original credentials makes sense with Kerberos. The SPN (server principal name) is part of the negotiation and so the same ticket will not work for more than one server. So it sounds like we need to do something beyond just forwarding the negotiated ticket from the original requester.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383957228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383962481","html_url":"https://github.com/apache/druid/pull/5280#issuecomment-383962481","issue_url":"https://api.github.com/repos/apache/druid/issues/5280","id":383962481,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzk2MjQ4MQ==","user":{"login":"himanshug","id":246308,"node_id":"MDQ6VXNlcjI0NjMwOA==","avatar_url":"https://avatars.githubusercontent.com/u/246308?v=4","gravatar_id":"","url":"https://api.github.com/users/himanshug","html_url":"https://github.com/himanshug","followers_url":"https://api.github.com/users/himanshug/followers","following_url":"https://api.github.com/users/himanshug/following{/other_user}","gists_url":"https://api.github.com/users/himanshug/gists{/gist_id}","starred_url":"https://api.github.com/users/himanshug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/himanshug/subscriptions","organizations_url":"https://api.github.com/users/himanshug/orgs","repos_url":"https://api.github.com/users/himanshug/repos","events_url":"https://api.github.com/users/himanshug/events{/privacy}","received_events_url":"https://api.github.com/users/himanshug/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T14:53:02Z","updated_at":"2018-04-24T14:53:02Z","author_association":"CONTRIBUTOR","body":"> Hi @himanshug - have you had a chance to review my review? 😃\r\n\r\n@gianm thanks for the review. sorry, I haven't had a chance to take another look. I'll try and finish it this week or next.\r\nPS: not sure if you know, but I'm going through some major transitions personally this week :)","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383962481/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383970060","html_url":"https://github.com/apache/druid/pull/5280#issuecomment-383970060","issue_url":"https://api.github.com/repos/apache/druid/issues/5280","id":383970060,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzk3MDA2MA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T15:13:46Z","updated_at":"2018-04-24T15:13:46Z","author_association":"CONTRIBUTOR","body":"@himanshug I have heard, congratulations :)\r\n\r\nThe comments I had were relatively minor, I think the main interesting one was the types being lost, so we probably want some additional tests for numeric dimensions.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383970060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383973998","html_url":"https://github.com/apache/druid/pull/5674#issuecomment-383973998","issue_url":"https://api.github.com/repos/apache/druid/issues/5674","id":383973998,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzk3Mzk5OA==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T15:24:57Z","updated_at":"2018-04-24T15:24:57Z","author_association":"CONTRIBUTOR","body":"Is it possible the broker didn't accept the messages for some reason?\r\n\r\nThat's the case in which I'd expect to see those warnings from the consumer.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383973998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383984766","html_url":"https://github.com/apache/druid/issues/5687#issuecomment-383984766","issue_url":"https://api.github.com/repos/apache/druid/issues/5687","id":383984766,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzk4NDc2Ng==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T15:55:20Z","updated_at":"2018-04-24T15:55:20Z","author_association":"CONTRIBUTOR","body":"Hi @davidkeeper - you may have a misunderstanding of how Druid works. Deep storage is required and must be configured to _something_. If you have a single node deployment then `local` should work. Otherwise it should point to some sort of shared storage.\r\n\r\nI am going to close this but feel free to check our docs (http://druid.io/docs/latest/tutorials/cluster.html) or write in to the user list (http://druid.io/community/) if you have some more questions about how to get Druid up and running.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383984766/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/383994670","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-383994670","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":383994670,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzk5NDY3MA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T16:24:12Z","updated_at":"2018-04-24T16:24:12Z","author_association":"CONTRIBUTOR","body":"@jon-wei and @gianm seems we both agree that currently the Kerberos Auth module is broken when using Router in a Different machine with Different host name. In the Ker/Spnego terms this is called [a double Hop](https://blogs.technet.microsoft.com/askds/2008/06/13/understanding-kerberos-double-hop/) \r\n**Thus i think we agree that we need a way to decorate the Http Client thus we need to add something like the escalated or call it decorated jetty client.**\r\n\r\nAs i said above probably the most kosher way to do this is to use the Do As (here the Router acting on behalf of client). But looking at the current Kerberos Auth module this do As is not even needed because there is no Authorization at all, thus a first fix will be to use the bare escalated as Router. \r\nIMO this is a legitimate  use case and common pattern we see, where only admins access the Druid Cluster and delegate the Authorization to something like Superset or any other entity like Hive Server, thus the need for Authentication only.\r\n\r\nAgain your concerns are totally valid  and i think we can achieve both patterns by letting the implementor of Auth module decide whether it is okay or not to escalate as root-druid.\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/383994670/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384013772","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384013772","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384013772,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDAxMzc3Mg==","user":{"login":"gianm","id":1214075,"node_id":"MDQ6VXNlcjEyMTQwNzU=","avatar_url":"https://avatars.githubusercontent.com/u/1214075?v=4","gravatar_id":"","url":"https://api.github.com/users/gianm","html_url":"https://github.com/gianm","followers_url":"https://api.github.com/users/gianm/followers","following_url":"https://api.github.com/users/gianm/following{/other_user}","gists_url":"https://api.github.com/users/gianm/gists{/gist_id}","starred_url":"https://api.github.com/users/gianm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gianm/subscriptions","organizations_url":"https://api.github.com/users/gianm/orgs","repos_url":"https://api.github.com/users/gianm/repos","events_url":"https://api.github.com/users/gianm/events{/privacy}","received_events_url":"https://api.github.com/users/gianm/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T17:24:34Z","updated_at":"2018-04-24T17:24:34Z","author_association":"CONTRIBUTOR","body":"> But looking at the current Kerberos Auth module this do As is not even needed because there is no Authorization at all, thus a first fix will be to use the bare escalated as Router.\r\nIMO this is a legitimate use case and common pattern we see, where only admins access the Druid Cluster and delegate the Authorization to something like Superset or any other entity like Hive Server, thus the need for Authentication only.\r\n\r\nThat makes the router a security hole that completely bypasses the authorization mechanisms. I believe you when you say you have use cases where this is okay, but if we support this behavior, I really believe it has to be off by default and _very_ clear from the documentation that it is not a fully secure configuration. I would also prefer it to be a router-specific configuration rather than something more general.\r\n\r\nWe should also keep researching how to support this properly, since that workaround would not be usable for anyone that actually wants to enforce permissions at a more granular level than \"you're in\" vs. \"you're out\".","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384013772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384021477","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384021477","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384021477,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDAyMTQ3Nw==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T17:49:13Z","updated_at":"2018-04-24T17:52:01Z","author_association":"CONTRIBUTOR","body":"My first preference would be to see if there's a way to use existing Kerberos features/mechanisms to handle this use case, I'll do some research on this.\r\n\r\nIf that's not possible, maybe we could add in some kind of impersonation path (like, router signs the request it forwards with some secret shared by the druid nodes, the request contains the identity of the sending user, the request hits a new Authenticator implementation at the broker that checks for such signed messages and authenticates that impersonated user by checking the signature), rather than a full-on \"send as superuser\" path.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384021477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384027691","html_url":"https://github.com/apache/druid/pull/5148#issuecomment-384027691","issue_url":"https://api.github.com/repos/apache/druid/issues/5148","id":384027691,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDAyNzY5MQ==","user":{"login":"AlexanderSaydakov","id":13126686,"node_id":"MDQ6VXNlcjEzMTI2Njg2","avatar_url":"https://avatars.githubusercontent.com/u/13126686?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderSaydakov","html_url":"https://github.com/AlexanderSaydakov","followers_url":"https://api.github.com/users/AlexanderSaydakov/followers","following_url":"https://api.github.com/users/AlexanderSaydakov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderSaydakov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderSaydakov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderSaydakov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderSaydakov/orgs","repos_url":"https://api.github.com/users/AlexanderSaydakov/repos","events_url":"https://api.github.com/users/AlexanderSaydakov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderSaydakov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T18:08:15Z","updated_at":"2018-04-24T18:08:15Z","author_association":"CONTRIBUTOR","body":"I think I have addressed the review points. The build failure seems to be unrelated to the datasketches extension.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384027691/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384042868","html_url":"https://github.com/apache/druid/pull/5674#issuecomment-384042868","issue_url":"https://api.github.com/repos/apache/druid/issues/5674","id":384042868,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA0Mjg2OA==","user":{"login":"andrey-zvez","id":1395092,"node_id":"MDQ6VXNlcjEzOTUwOTI=","avatar_url":"https://avatars.githubusercontent.com/u/1395092?v=4","gravatar_id":"","url":"https://api.github.com/users/andrey-zvez","html_url":"https://github.com/andrey-zvez","followers_url":"https://api.github.com/users/andrey-zvez/followers","following_url":"https://api.github.com/users/andrey-zvez/following{/other_user}","gists_url":"https://api.github.com/users/andrey-zvez/gists{/gist_id}","starred_url":"https://api.github.com/users/andrey-zvez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrey-zvez/subscriptions","organizations_url":"https://api.github.com/users/andrey-zvez/orgs","repos_url":"https://api.github.com/users/andrey-zvez/repos","events_url":"https://api.github.com/users/andrey-zvez/events{/privacy}","received_events_url":"https://api.github.com/users/andrey-zvez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T18:58:05Z","updated_at":"2018-04-24T19:01:37Z","author_association":"NONE","body":"Also stumbled over this issue. The problem is that KafkaIndexTaskTest uses offsets which are not yet available, not yet sent to broker. And it seems that new version of kafka client can't handle this situation. It throws OffsetOutOfRangeException but doesn't remove last fetche response. So next time it reuse last response and throws the same exception. [Here is kafka client code responsible](https://github.com/apache/kafka/blob/56f614c50a076c2de39a2c26b3d16635f3a78f48/clients/src/main/java/org/apache/kafka/clients/consumer/internals/Fetcher.java#L482).\r\n\r\nTests might pass if producer manages to send messages before task actually start consuming. I make tests work by moving runTask(...) after producing some messages (enough to make startOffset valid). Still not sure this is the right thing to do. But so far I couldn't find any way to make consumer discard last fetch response and go to kafka.   \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384042868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384045445","html_url":"https://github.com/apache/druid/pull/5674#issuecomment-384045445","issue_url":"https://api.github.com/repos/apache/druid/issues/5674","id":384045445,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA0NTQ0NQ==","user":{"login":"jwroblewski","id":2076482,"node_id":"MDQ6VXNlcjIwNzY0ODI=","avatar_url":"https://avatars.githubusercontent.com/u/2076482?v=4","gravatar_id":"","url":"https://api.github.com/users/jwroblewski","html_url":"https://github.com/jwroblewski","followers_url":"https://api.github.com/users/jwroblewski/followers","following_url":"https://api.github.com/users/jwroblewski/following{/other_user}","gists_url":"https://api.github.com/users/jwroblewski/gists{/gist_id}","starred_url":"https://api.github.com/users/jwroblewski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jwroblewski/subscriptions","organizations_url":"https://api.github.com/users/jwroblewski/orgs","repos_url":"https://api.github.com/users/jwroblewski/repos","events_url":"https://api.github.com/users/jwroblewski/events{/privacy}","received_events_url":"https://api.github.com/users/jwroblewski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T19:06:29Z","updated_at":"2018-04-25T08:19:07Z","author_association":"NONE","body":"What I see in the traces seems to confirm the above:\r\n\r\n```\r\n2018-04-24 21:04:06,636 DEBUG o.a.k.c.c.i.Fetcher [kafka-task-test-0] [Consumer clientId=consumer-1, groupId=622415042] Handling ListOffsetResponse response for topic0-0. Fetched offset 0, timestamp -1\r\n2018-04-24 21:04:06,636 INFO o.a.k.c.c.i.Fetcher [kafka-task-test-0] [Consumer clientId=consumer-1, groupId=622415042] Resetting offset for partition topic0-0 to offset 0.\r\n2018-04-24 21:04:06,636 DEBUG o.a.k.c.c.KafkaConsumer [kafka-task-test-0] [Consumer clientId=consumer-1, groupId=622415042] Seeking to offset 200 for partition topic0-0\r\n```\r\n\r\nThis happens with `kafka-clients-1.1.0`. Switching back to `kafka-clients-0.10.2.0` makes the tests pass again.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384045445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384065322","html_url":"https://github.com/apache/druid/pull/5686#issuecomment-384065322","issue_url":"https://api.github.com/repos/apache/druid/issues/5686","id":384065322,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA2NTMyMg==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T20:16:22Z","updated_at":"2018-04-24T20:16:42Z","author_association":"CONTRIBUTOR","body":"Thanks for the patch, can you elaborate on the \"partial\" nature of the fix? What's supported/not supported?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384065322/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384066446","html_url":"https://github.com/apache/druid/pull/5686#issuecomment-384066446","issue_url":"https://api.github.com/repos/apache/druid/issues/5686","id":384066446,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA2NjQ0Ng==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T20:20:18Z","updated_at":"2018-04-24T20:20:18Z","author_association":"CONTRIBUTOR","body":"Ah, nevermind, I guess you mean \"partially fixes\" by addressing the Google extension specifically and not other types","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384066446/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384070105","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384070105","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384070105,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA3MDEwNQ==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T20:32:24Z","updated_at":"2018-04-24T20:32:24Z","author_association":"CONTRIBUTOR","body":"@b-slim Do you have a logs or stack trace of the error that happens in the router->broker case? I don't have a setup to reproduce this yet.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384070105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384073417","html_url":"https://github.com/apache/druid/pull/5686#issuecomment-384073417","issue_url":"https://api.github.com/repos/apache/druid/issues/5686","id":384073417,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA3MzQxNw==","user":{"login":"erikdubbelboer","id":522870,"node_id":"MDQ6VXNlcjUyMjg3MA==","avatar_url":"https://avatars.githubusercontent.com/u/522870?v=4","gravatar_id":"","url":"https://api.github.com/users/erikdubbelboer","html_url":"https://github.com/erikdubbelboer","followers_url":"https://api.github.com/users/erikdubbelboer/followers","following_url":"https://api.github.com/users/erikdubbelboer/following{/other_user}","gists_url":"https://api.github.com/users/erikdubbelboer/gists{/gist_id}","starred_url":"https://api.github.com/users/erikdubbelboer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erikdubbelboer/subscriptions","organizations_url":"https://api.github.com/users/erikdubbelboer/orgs","repos_url":"https://api.github.com/users/erikdubbelboer/repos","events_url":"https://api.github.com/users/erikdubbelboer/events{/privacy}","received_events_url":"https://api.github.com/users/erikdubbelboer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T20:43:25Z","updated_at":"2018-04-24T20:43:25Z","author_association":"CONTRIBUTOR","body":"Exactly.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384073417/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384079193","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384079193","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384079193,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA3OTE5Mw==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T21:03:38Z","updated_at":"2018-04-24T21:03:38Z","author_association":"CONTRIBUTOR","body":"Hm, I tried having my broker and router bind to different IP addresses in my testing setup, not able to reproduce the failure, my query to the router succeeds (192.168.56.1 is an interface on a virtual box network)\r\n\r\n```\r\n2018-04-24T20:46:56,741 INFO [qtp127269549-75] io.druid.security.kerberos.KerberosAuthenticator - Login using keytab /Users/jw/kerberos/http2-rc4-hmac.keytab, for principal HTTP/192.168.56.1@VM\r\n2018-04-24T20:46:56,786 INFO [qtp127269549-75] io.druid.security.kerberos.KerberosAuthenticator - Initialized, principal HTTP/192.168.56.1@VM from keytab /Users/jw/kerberos/http2-rc4-hmac.keytab\r\n```\r\n\r\n```\r\n2018-04-24T20:46:56,967 INFO [qtp1339630217-119] io.druid.security.kerberos.KerberosAuthenticator - Login using keytab /Users/jw/kerberos/http2-rc4-hmac.keytab, for principal HTTP/127.0.0.1@VM\r\n2018-04-24T20:46:56,969 INFO [qtp1339630217-119] io.druid.security.kerberos.KerberosAuthenticator - Initialized, principal HTTP/127.0.0.1@VM from keytab /Users/jw/kerberos/http2-rc4-hmac.keytab\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384079193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384084065","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384084065","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384084065,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA4NDA2NQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T21:21:28Z","updated_at":"2018-04-24T21:21:28Z","author_association":"CONTRIBUTOR","body":"@jon-wei i get the following \r\n```\r\njava.security.PrivilegedActionException: GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)\r\nstackTrace = {StackTraceElement[36]@9389} \r\n 0 = {StackTraceElement@9391} \"sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:856)\"\r\n 1 = {StackTraceElement@9392} \"sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:342)\"\r\n 2 = {StackTraceElement@9393} \"sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:285)\"\r\n 3 = {StackTraceElement@9394} \"io.druid.security.kerberos.DruidKerberosAuthenticationHandler$2.run(DruidKerberosAuthenticationHandler.java:183)\"\r\n 4 = {StackTraceElement@9395} \"io.druid.security.kerberos.DruidKerberosAuthenticationHandler$2.run(DruidKerberosAuthenticationHandler.java:161)\"\r\n 5 = {StackTraceElement@9396} \"java.security.AccessController.doPrivileged(Native Method)\"\r\n 6 = {StackTraceElement@9397} \"javax.security.auth.Subject.doAs(Subject.java:422)\"\r\n 7 = {StackTraceElement@9398} \"io.druid.security.kerberos.DruidKerberosAuthenticationHandler.authenticate(DruidKerberosAuthenticationHandler.java:160)\"\r\n 8 = {StackTraceElement@9399} \"io.druid.security.kerberos.KerberosAuthenticator$1.doFilterSuper(KerberosAuthenticator.java:295)\"\r\n 9 = {StackTraceElement@9400} \"io.druid.security.kerberos.KerberosAuthenticator$1.doFilter(KerberosAuthenticator.java:265)\"\r\n 10 = {StackTraceElement@9401} \"io.druid.server.security.AuthenticationWrappingFilter.doFilter(AuthenticationWrappingFilter.java:60)\"\r\n 11 = {StackTraceElement@9402} \"org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)\"\r\n 12 = {StackTraceElement@9403} \"io.druid.server.security.SecuritySanityCheckFilter.doFilter(SecuritySanityCheckFilter.java:86)\"\r\n 13 = {StackTraceElement@9404} \"org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759)\"\r\n 14 = {StackTraceElement@9405} \"org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)\"\r\n 15 = {StackTraceElement@9406} \"org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:224)\"\r\n 16 = {StackTraceElement@9407} \"org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180)\"\r\n 17 = {StackTraceElement@9408} \"org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512)\"\r\n 18 = {StackTraceElement@9409} \"org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\"\r\n 19 = {StackTraceElement@9410} \"org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112)\"\r\n 20 = {StackTraceElement@9411} \"org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\"\r\n 21 = {StackTraceElement@9412} \"org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:493)\"\r\n 22 = {StackTraceElement@9413} \"org.eclipse.jetty.server.handler.HandlerList.handle(HandlerList.java:52)\"\r\n 23 = {StackTraceElement@9414} \"org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\"\r\n 24 = {StackTraceElement@9415} \"org.eclipse.jetty.server.Server.handle(Server.java:534)\"\r\n 25 = {StackTraceElement@9416} \"org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320)\"\r\n 26 = {StackTraceElement@9417} \"org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251)\"\r\n 27 = {StackTraceElement@9418} \"org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283)\"\r\n 28 = {StackTraceElement@9419} \"org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108)\"\r\n 29 = {StackTraceElement@9420} \"org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)\"\r\n 30 = {StackTraceElement@9421} \"org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303)\"\r\n 31 = {StackTraceElement@9422} \"org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148)\"\r\n 32 = {StackTraceElement@9423} \"org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136)\"\r\n 33 = {StackTraceElement@9424} \"org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671)\"\r\n 34 = {StackTraceElement@9425} \"org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589)\"\r\n 35 = {StackTraceElement@9426} \"java.lang.Thread.run(Thread.java:748)\"\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384084065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384084346","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384084346","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384084346,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA4NDM0Ng==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T21:22:27Z","updated_at":"2018-04-24T21:22:42Z","author_association":"CONTRIBUTOR","body":"i have two similar Routers if i hit one colocated with broker it works if i hit the second it does not. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384084346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384085818","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384085818","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384085818,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA4NTgxOA==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T21:27:59Z","updated_at":"2018-04-24T21:27:59Z","author_association":"CONTRIBUTOR","body":"@jon-wei FYI i am running out of 0.12.0 i don;t see any major code changes since then. \r\non the Druid logs i see the followings\r\n```\r\n2018-04-24T21:11:25,320 ERROR [qtp2006056784-185] io.druid.security.kerberos.KerberosAuthenticator - Could not find matching key from server creds.\r\n2018-04-24T21:11:25,320 DEBUG [qtp2006056784-185] io.druid.security.kerberos.KerberosAuthenticator - Request [{http://ctr-e138-1518143905142-237396-01-000003.hwx.site:8082/druid/v2/}] triggering authentication\r\n2018-04-24T21:11:25,694 DEBUG [qtp2006056784-185] io.druid.security.kerberos.KerberosAuthenticator - Authentication exception: GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384085818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384086276","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384086276","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384086276,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA4NjI3Ng==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T21:29:48Z","updated_at":"2018-04-24T21:29:48Z","author_association":"CONTRIBUTOR","body":"Cool, thanks for the info.\r\n\r\nI'll try spinning up non-colocated brokers and routers to see if I can reproduce.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384086276/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384088079","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384088079","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384088079,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA4ODA3OQ==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T21:36:32Z","updated_at":"2018-04-24T21:36:51Z","author_association":"CONTRIBUTOR","body":"@jon-wei am looking at ```io.druid.security.kerberos.KerberosAuthenticator#getPrincipalFromRequestNew``` and am wondering if this a common logic used by other projects or it is a Druid specific thingy?","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384088079/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384089837","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384089837","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384089837,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA4OTgzNw==","user":{"login":"jon-wei","id":8729063,"node_id":"MDQ6VXNlcjg3MjkwNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8729063?v=4","gravatar_id":"","url":"https://api.github.com/users/jon-wei","html_url":"https://github.com/jon-wei","followers_url":"https://api.github.com/users/jon-wei/followers","following_url":"https://api.github.com/users/jon-wei/following{/other_user}","gists_url":"https://api.github.com/users/jon-wei/gists{/gist_id}","starred_url":"https://api.github.com/users/jon-wei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jon-wei/subscriptions","organizations_url":"https://api.github.com/users/jon-wei/orgs","repos_url":"https://api.github.com/users/jon-wei/repos","events_url":"https://api.github.com/users/jon-wei/events{/privacy}","received_events_url":"https://api.github.com/users/jon-wei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T21:43:41Z","updated_at":"2018-04-24T21:43:41Z","author_association":"CONTRIBUTOR","body":"that's Druid specific, I added it to get the principal name","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384089837/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384092073","html_url":"https://github.com/apache/druid/pull/5695#issuecomment-384092073","issue_url":"https://api.github.com/repos/apache/druid/issues/5695","id":384092073,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDA5MjA3Mw==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T21:52:50Z","updated_at":"2018-04-24T21:52:50Z","author_association":"CONTRIBUTOR","body":"@Caroline1000 thanks. I changed the title to be more specific.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384092073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384100080","html_url":"https://github.com/apache/druid/pull/5471#issuecomment-384100080","issue_url":"https://api.github.com/repos/apache/druid/issues/5471","id":384100080,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEwMDA4MA==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T22:28:50Z","updated_at":"2018-04-24T22:28:50Z","author_association":"CONTRIBUTOR","body":"@samarthjain thanks for the update! I'll take another look.\r\n\r\n>To run the integration test on my laptop, I had to add a config file and supply it's path in the ConfigFileConfigProvider. The contents of the config file looked like this:\r\n{ \"broker_host\": \"127.0.0.1\", \"broker_port\": \"8082\", \"coordinator_host\": \"127.0.0.1\", \"coordinator_port\": \"8081\", \"middlemanager_host\": \"127.0.0.1\", \"middlemanager_port\":\"8090\", \"zookeeper_hosts\": \"127.0.0.1:2181\" }\r\n\r\nWould you elaborate on why this configuration is needed? It's supposed to get addresses automatically in the integration tests.\r\n\r\n> @nishantmonu51 - would you happen to know how can I get my newly added integration test to run automatically in the pre-checkin builds?\r\n\r\nWhat do you mean by this? If you add an integration test, it should be run automatically on the travis. You can check it by checking the log on travis or running the integration test on your own.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384100080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384100395","html_url":"https://github.com/apache/druid/pull/5471#issuecomment-384100395","issue_url":"https://api.github.com/repos/apache/druid/issues/5471","id":384100395,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEwMDM5NQ==","user":{"login":"jihoonson","id":2322288,"node_id":"MDQ6VXNlcjIzMjIyODg=","avatar_url":"https://avatars.githubusercontent.com/u/2322288?v=4","gravatar_id":"","url":"https://api.github.com/users/jihoonson","html_url":"https://github.com/jihoonson","followers_url":"https://api.github.com/users/jihoonson/followers","following_url":"https://api.github.com/users/jihoonson/following{/other_user}","gists_url":"https://api.github.com/users/jihoonson/gists{/gist_id}","starred_url":"https://api.github.com/users/jihoonson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jihoonson/subscriptions","organizations_url":"https://api.github.com/users/jihoonson/orgs","repos_url":"https://api.github.com/users/jihoonson/repos","events_url":"https://api.github.com/users/jihoonson/events{/privacy}","received_events_url":"https://api.github.com/users/jihoonson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T22:30:12Z","updated_at":"2018-04-24T22:30:12Z","author_association":"CONTRIBUTOR","body":"Also, please check the CI failure.\r\n\r\n```\r\nResults :\r\nFailed tests: \r\n  GroupByLimitPushDownInsufficientBufferTest.testPartialLimitPushDownMergeForceAggs:605 expected:<MapBasedRow{timestamp=1970-01-01T00:00:00.000Z, event={dimA=mango, metA=190}}> but was:<MapBasedRow{timestamp=1970-01-01T00:00:00.000Z, event={dimA=zebra, metA=180}}>\r\nTests in error: \r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\n  GroupByQueryRunnerTest.testSubqueryWithFirstLast:6177 » ClassCast java.lang.Lo...\r\nTests run: 83353, Failures: 1, Errors: 20, Skipped: 62\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384100395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384103277","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384103277","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384103277,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEwMzI3Nw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T22:45:15Z","updated_at":"2018-04-24T22:45:15Z","author_association":"CONTRIBUTOR","body":"@jon-wei here the full stack with more debug flags\r\n```java\r\n2018-04-24T22:42:43,745 INFO [qtp409957428-173] io.druid.security.kerberos.KerberosAuthenticator - Initialized, principal HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM from keytab /etc/security/keytabs/spnego.service.keytab\r\n2018-04-24T22:42:43,747 ERROR [qtp409957428-173] io.druid.security.kerberos.KerberosAuthenticator - Could not find matching key from server creds.\r\n2018-04-24T22:42:43,748 DEBUG [qtp409957428-173] io.druid.security.kerberos.KerberosAuthenticator - Request [{http://ctr-e138-1518143905142-237396-01-000003.hwx.site:8082/druid/v2/}] triggering authentication\r\nFound KeyTab /etc/security/keytabs/spnego.service.keytab for HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM\r\nFound KeyTab /etc/security/keytabs/spnego.service.keytab for HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM\r\nEntered Krb5Context.acceptSecContext with state=STATE_NEW\r\n>>> KeyTabInputStream, readName(): EXAMPLE.COM\r\n>>> KeyTabInputStream, readName(): HTTP\r\n>>> KeyTabInputStream, readName(): ctr-e138-1518143905142-237396-01-000003.hwx.site\r\n>>> KeyTab: load() entry length: 108; type: 16\r\n>>> KeyTabInputStream, readName(): EXAMPLE.COM\r\n>>> KeyTabInputStream, readName(): HTTP\r\n>>> KeyTabInputStream, readName(): ctr-e138-1518143905142-237396-01-000003.hwx.site\r\n>>> KeyTab: load() entry length: 116; type: 18\r\n>>> KeyTabInputStream, readName(): EXAMPLE.COM\r\n>>> KeyTabInputStream, readName(): HTTP\r\n>>> KeyTabInputStream, readName(): ctr-e138-1518143905142-237396-01-000003.hwx.site\r\n>>> KeyTab: load() entry length: 100; type: 23\r\n>>> KeyTabInputStream, readName(): EXAMPLE.COM\r\n>>> KeyTabInputStream, readName(): HTTP\r\n>>> KeyTabInputStream, readName(): ctr-e138-1518143905142-237396-01-000003.hwx.site\r\n>>> KeyTab: load() entry length: 92; type: 3\r\n>>> KeyTabInputStream, readName(): EXAMPLE.COM\r\n>>> KeyTabInputStream, readName(): HTTP\r\n>>> KeyTabInputStream, readName(): ctr-e138-1518143905142-237396-01-000003.hwx.site\r\n>>> KeyTab: load() entry length: 100; type: 17\r\nLooking for keys for: HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM\r\nAdded key: 17version: 2\r\nFound unsupported keytype (3) for HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM\r\nAdded key: 23version: 2\r\nAdded key: 18version: 2\r\nAdded key: 16version: 2\r\n>>> EType: sun.security.krb5.internal.crypto.Des3CbcHmacSha1KdEType\r\n2018-04-24T22:42:43,765 ERROR [qtp409957428-173] io.druid.security.kerberos.KerberosAuthenticator - WTF\r\norg.apache.hadoop.security.authentication.client.AuthenticationException: GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler.authenticate(DruidKerberosAuthenticationHandler.java:221) ~[druid-kerberos-0.12.0-rc2-SNAPSHOT.jar:0.12.0-rc2-SNAPSHOT]\r\n        at io.druid.security.kerberos.KerberosAuthenticator$1.doFilterSuper(KerberosAuthenticator.java:295) [druid-kerberos-0.12.0-rc2-SNAPSHOT.jar:0.12.0-rc2-SNAPSHOT]\r\n        at io.druid.security.kerberos.KerberosAuthenticator$1.doFilter(KerberosAuthenticator.java:265) [druid-kerberos-0.12.0-rc2-SNAPSHOT.jar:0.12.0-rc2-SNAPSHOT]\r\n        at io.druid.server.security.AuthenticationWrappingFilter.doFilter(AuthenticationWrappingFilter.java:60) [druid-server-0.12.0.3.0.0.0-1195.jar:0.12.0.3.0.0.0-1195]\r\n        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759) [jetty-servlet-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at io.druid.server.security.SecuritySanityCheckFilter.doFilter(SecuritySanityCheckFilter.java:86) [druid-server-0.12.0.3.0.0.0-1195.jar:0.12.0.3.0.0.0-1195]\r\n        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1759) [jetty-servlet-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582) [jetty-servlet-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:224) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1180) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:512) [jetty-servlet-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1112) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:493) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.handler.HandlerList.handle(HandlerList.java:52) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.Server.handle(Server.java:534) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:320) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:251) [jetty-server-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:283) [jetty-io-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:108) [jetty-io-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93) [jetty-io-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.executeProduceConsume(ExecuteProduceConsume.java:303) [jetty-util-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceConsume(ExecuteProduceConsume.java:148) [jetty-util-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:136) [jetty-util-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:671) [jetty-util-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:589) [jetty-util-9.3.19.v20170502.jar:9.3.19.v20170502]\r\n        at java.lang.Thread.run(Thread.java:748) [?:1.8.0_161]\r\nCaused by: org.ietf.jgss.GSSException: Failure unspecified at GSS-API level (Mechanism level: Checksum failed)\r\n        at sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:856) ~[?:1.8.0_161]\r\n        at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:342) ~[?:1.8.0_161]\r\n        at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:285) ~[?:1.8.0_161]\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler$2.run(DruidKerberosAuthenticationHandler.java:183) ~[?:?]\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler$2.run(DruidKerberosAuthenticationHandler.java:161) ~[?:?]\r\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_161]\r\n        at javax.security.auth.Subject.doAs(Subject.java:422) ~[?:1.8.0_161]\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler.authenticate(DruidKerberosAuthenticationHandler.java:160) ~[?:?]\r\n        ... 28 more\r\nCaused by: sun.security.krb5.KrbCryptoException: Checksum failed\r\n        at sun.security.krb5.internal.crypto.Des3CbcHmacSha1KdEType.decrypt(Des3CbcHmacSha1KdEType.java:96) ~[?:1.8.0_161]\r\n        at sun.security.krb5.internal.crypto.Des3CbcHmacSha1KdEType.decrypt(Des3CbcHmacSha1KdEType.java:88) ~[?:1.8.0_161]\r\n        at sun.security.krb5.EncryptedData.decrypt(EncryptedData.java:175) ~[?:1.8.0_161]\r\n        at sun.security.krb5.KrbApReq.authenticate(KrbApReq.java:281) ~[?:1.8.0_161]\r\n        at sun.security.krb5.KrbApReq.<init>(KrbApReq.java:149) ~[?:1.8.0_161]\r\n        at sun.security.jgss.krb5.InitSecContextToken.<init>(InitSecContextToken.java:108) ~[?:1.8.0_161]\r\n        at sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:829) ~[?:1.8.0_161]\r\n        at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:342) ~[?:1.8.0_161]\r\n        at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:285) ~[?:1.8.0_161]\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler$2.run(DruidKerberosAuthenticationHandler.java:183) ~[?:?]\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler$2.run(DruidKerberosAuthenticationHandler.java:161) ~[?:?]\r\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_161]\r\n        at javax.security.auth.Subject.doAs(Subject.java:422) ~[?:1.8.0_161]\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler.authenticate(DruidKerberosAuthenticationHandler.java:160) ~[?:?]\r\n        ... 28 more\r\nCaused by: java.security.GeneralSecurityException: Checksum failed\r\n        at sun.security.krb5.internal.crypto.dk.DkCrypto.decrypt(DkCrypto.java:362) ~[?:1.8.0_161]\r\n        at sun.security.krb5.internal.crypto.Des3.decrypt(Des3.java:79) ~[?:1.8.0_161]\r\n        at sun.security.krb5.internal.crypto.Des3CbcHmacSha1KdEType.decrypt(Des3CbcHmacSha1KdEType.java:94) ~[?:1.8.0_161]\r\n        at sun.security.krb5.internal.crypto.Des3CbcHmacSha1KdEType.decrypt(Des3CbcHmacSha1KdEType.java:88) ~[?:1.8.0_161]\r\n        at sun.security.krb5.EncryptedData.decrypt(EncryptedData.java:175) ~[?:1.8.0_161]\r\n        at sun.security.krb5.KrbApReq.authenticate(KrbApReq.java:281) ~[?:1.8.0_161]\r\n        at sun.security.krb5.KrbApReq.<init>(KrbApReq.java:149) ~[?:1.8.0_161]\r\n        at sun.security.jgss.krb5.InitSecContextToken.<init>(InitSecContextToken.java:108) ~[?:1.8.0_161]\r\n        at sun.security.jgss.krb5.Krb5Context.acceptSecContext(Krb5Context.java:829) ~[?:1.8.0_161]\r\n        at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:342) ~[?:1.8.0_161]\r\n        at sun.security.jgss.GSSContextImpl.acceptSecContext(GSSContextImpl.java:285) ~[?:1.8.0_161]\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler$2.run(DruidKerberosAuthenticationHandler.java:183) ~[?:?]\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler$2.run(DruidKerberosAuthenticationHandler.java:161) ~[?:?]\r\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_161]\r\n        at javax.security.auth.Subject.doAs(Subject.java:422) ~[?:1.8.0_161]\r\n        at io.druid.security.kerberos.DruidKerberosAuthenticationHandler.authenticate(DruidKerberosAuthenticationHandler.java:160) ~[?:?]\r\n        ... 28 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384103277/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384103792","html_url":"https://github.com/apache/druid/pull/5322#issuecomment-384103792","issue_url":"https://api.github.com/repos/apache/druid/issues/5322","id":384103792,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEwMzc5Mg==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-24T22:48:10Z","updated_at":"2018-04-24T22:48:10Z","author_association":"CONTRIBUTOR","body":"and this what a happy ending looks like when use colocated broker/router \r\n```java\r\n2018-04-24T22:46:17,795 ERROR [qtp409957428-188] io.druid.security.kerberos.KerberosAuthenticator - Could not find matching key from server creds.\r\n2018-04-24T22:46:17,796 DEBUG [qtp409957428-188] io.druid.security.kerberos.KerberosAuthenticator - Request [{http://ctr-e138-1518143905142-237396-01-000003.hwx.site:8082/druid/v2/}] triggering authentication\r\nFound KeyTab /etc/security/keytabs/spnego.service.keytab for HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM\r\nFound KeyTab /etc/security/keytabs/spnego.service.keytab for HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM\r\nEntered Krb5Context.acceptSecContext with state=STATE_NEW\r\nLooking for keys for: HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM\r\nAdded key: 17version: 2\r\nFound unsupported keytype (3) for HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM\r\nAdded key: 23version: 2\r\nAdded key: 18version: 2\r\nAdded key: 16version: 2\r\n>>> EType: sun.security.krb5.internal.crypto.Des3CbcHmacSha1KdEType\r\nUsing builtin default etypes for permitted_enctypes\r\ndefault etypes for permitted_enctypes: 18 17 16 23.\r\n>>> EType: sun.security.krb5.internal.crypto.Aes256CtsHmacSha1EType\r\nMemoryCache: add 1524609977/563031/EE1A4FB089925135C370E3646612BD84/druid@EXAMPLE.COM to druid@EXAMPLE.COM|HTTP/ctr-e138-1518143905142-237396-01-000003.hwx.site@EXAMPLE.COM\r\n>>> KrbApReq: authenticate succeed.\r\nKrb5Context setting peerSeqNumber to: 583816652\r\n>>> EType: sun.security.krb5.internal.crypto.Aes256CtsHmacSha1EType\r\nKrb5Context setting mySeqNumber to: 449475208\r\n2018-04-24T22:46:17,812 DEBUG [qtp409957428-188] io.druid.security.kerberos.KerberosAuthenticator - Request [{http://ctr-e138-1518143905142-237396-01-000003.hwx.site:8082/druid/v2/}] user [{druid}] authenticated\r\n```","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384103792/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384124693","html_url":"https://github.com/apache/druid/pull/5471#issuecomment-384124693","issue_url":"https://api.github.com/repos/apache/druid/issues/5471","id":384124693,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEyNDY5Mw==","user":{"login":"samarthjain","id":1642180,"node_id":"MDQ6VXNlcjE2NDIxODA=","avatar_url":"https://avatars.githubusercontent.com/u/1642180?v=4","gravatar_id":"","url":"https://api.github.com/users/samarthjain","html_url":"https://github.com/samarthjain","followers_url":"https://api.github.com/users/samarthjain/followers","following_url":"https://api.github.com/users/samarthjain/following{/other_user}","gists_url":"https://api.github.com/users/samarthjain/gists{/gist_id}","starred_url":"https://api.github.com/users/samarthjain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samarthjain/subscriptions","organizations_url":"https://api.github.com/users/samarthjain/orgs","repos_url":"https://api.github.com/users/samarthjain/repos","events_url":"https://api.github.com/users/samarthjain/events{/privacy}","received_events_url":"https://api.github.com/users/samarthjain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T00:45:38Z","updated_at":"2018-04-25T00:45:38Z","author_association":"CONTRIBUTOR","body":"> What do you mean by this? If you add an integration test, it should be run automatically on the travis. You can check it by checking the log on travis or running the integration test on your own.\r\n\r\nThe core of the problem is that I used the wikiticker data set for my new integration test. I ended up assuming that the data set provided in http://druid.io/docs/latest/tutorials/quickstart.html will be available to run in the CI build environment too. But turns out, that isn't the case. At this point, it seems like I would have to emulate what other IT tests like ITIndexerTest are doing and load the data up in the setup phase of this new IT test. \r\n\r\nLooking at other IT tests like ITTwitterQueryTest and ITWikipediaQueryTest, I don't see where the data is first being loaded. My best guess is that the data is already available in some s3 bucket which then the docker cluster is downloading. For ex- I see lines like below in the sample-data.sql file - https://github.com/druid-io/druid/blob/master/integration-tests/docker/sample-data.sql\r\n\r\n`INSERT INTO druid_segments (id,dataSource,created_date,start,end,partitioned,version,used,payload) VALUES ('twitterstream_2013-01-01T00:00:00.000Z_2013-01-02T00:00:00.000Z_2013-01-02T04:13:41.980Z_v9','twitterstream','2013-05-13T01:08:18.192Z','2013-01-01T00:00:00.000Z','2013-01-02T00:00:00.000Z',0,'2013-01-02T04:13:41.980Z_v9',1,'{\\\"dataSource\\\":\\\"twitterstream\\\",\\\"interval\\\":\\\"2013-01-.....\r\n`\r\n\r\nIt would be nice if there was a way to access the twitter stream data used by these IT tests. That way I could have written tests for this feature with queries and expected results. Without access to the data, that isn't possible.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384124693/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384269541","html_url":"https://github.com/apache/druid/issues/5566#issuecomment-384269541","issue_url":"https://api.github.com/repos/apache/druid/issues/5566","id":384269541,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDI2OTU0MQ==","user":{"login":"kskalski","id":775012,"node_id":"MDQ6VXNlcjc3NTAxMg==","avatar_url":"https://avatars.githubusercontent.com/u/775012?v=4","gravatar_id":"","url":"https://api.github.com/users/kskalski","html_url":"https://github.com/kskalski","followers_url":"https://api.github.com/users/kskalski/followers","following_url":"https://api.github.com/users/kskalski/following{/other_user}","gists_url":"https://api.github.com/users/kskalski/gists{/gist_id}","starred_url":"https://api.github.com/users/kskalski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kskalski/subscriptions","organizations_url":"https://api.github.com/users/kskalski/orgs","repos_url":"https://api.github.com/users/kskalski/repos","events_url":"https://api.github.com/users/kskalski/events{/privacy}","received_events_url":"https://api.github.com/users/kskalski/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T12:31:15Z","updated_at":"2018-04-25T12:31:15Z","author_association":"NONE","body":"FYI, I got a fix here https://github.com/druid-io/druid/pull/5699 though it is a bit symptomatic, there might be a better way to address it, since this incompatibility of values returned by first/last aggregators might be hitting other places too. ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384269541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384301722","html_url":"https://github.com/apache/druid/issues/5698#issuecomment-384301722","issue_url":"https://api.github.com/repos/apache/druid/issues/5698","id":384301722,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDMwMTcyMg==","user":{"login":"sanastas","id":12136181,"node_id":"MDQ6VXNlcjEyMTM2MTgx","avatar_url":"https://avatars.githubusercontent.com/u/12136181?v=4","gravatar_id":"","url":"https://api.github.com/users/sanastas","html_url":"https://github.com/sanastas","followers_url":"https://api.github.com/users/sanastas/followers","following_url":"https://api.github.com/users/sanastas/following{/other_user}","gists_url":"https://api.github.com/users/sanastas/gists{/gist_id}","starred_url":"https://api.github.com/users/sanastas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanastas/subscriptions","organizations_url":"https://api.github.com/users/sanastas/orgs","repos_url":"https://api.github.com/users/sanastas/repos","events_url":"https://api.github.com/users/sanastas/events{/privacy}","received_events_url":"https://api.github.com/users/sanastas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T14:13:13Z","updated_at":"2018-04-25T14:13:13Z","author_association":"NONE","body":"Hereby attached the refactor we suggest to IncrementalIndex module so it can adopt another index based on Oak. Would be happy to hear your comments. Thanks!\r\n[Incremental Index Refactoring Suggestion.pdf](https://github.com/druid-io/druid/files/1947353/Incremental.Index.Refactoring.Suggestion.pdf)\r\n","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384301722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384321457","html_url":"https://github.com/apache/druid/issues/5698#issuecomment-384321457","issue_url":"https://api.github.com/repos/apache/druid/issues/5698","id":384321457,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDMyMTQ1Nw==","user":{"login":"b-slim","id":7376396,"node_id":"MDQ6VXNlcjczNzYzOTY=","avatar_url":"https://avatars.githubusercontent.com/u/7376396?v=4","gravatar_id":"","url":"https://api.github.com/users/b-slim","html_url":"https://github.com/b-slim","followers_url":"https://api.github.com/users/b-slim/followers","following_url":"https://api.github.com/users/b-slim/following{/other_user}","gists_url":"https://api.github.com/users/b-slim/gists{/gist_id}","starred_url":"https://api.github.com/users/b-slim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b-slim/subscriptions","organizations_url":"https://api.github.com/users/b-slim/orgs","repos_url":"https://api.github.com/users/b-slim/repos","events_url":"https://api.github.com/users/b-slim/events{/privacy}","received_events_url":"https://api.github.com/users/b-slim/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T15:07:12Z","updated_at":"2018-04-25T15:07:12Z","author_association":"CONTRIBUTOR","body":"@sanastas sounds great contribution is this lib open source? what it used with other projects? ","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384321457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384324366","html_url":"https://github.com/apache/druid/issues/5629#issuecomment-384324366","issue_url":"https://api.github.com/repos/apache/druid/issues/5629","id":384324366,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDMyNDM2Ng==","user":{"login":"sixtus","id":91857,"node_id":"MDQ6VXNlcjkxODU3","avatar_url":"https://avatars.githubusercontent.com/u/91857?v=4","gravatar_id":"","url":"https://api.github.com/users/sixtus","html_url":"https://github.com/sixtus","followers_url":"https://api.github.com/users/sixtus/followers","following_url":"https://api.github.com/users/sixtus/following{/other_user}","gists_url":"https://api.github.com/users/sixtus/gists{/gist_id}","starred_url":"https://api.github.com/users/sixtus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sixtus/subscriptions","organizations_url":"https://api.github.com/users/sixtus/orgs","repos_url":"https://api.github.com/users/sixtus/repos","events_url":"https://api.github.com/users/sixtus/events{/privacy}","received_events_url":"https://api.github.com/users/sixtus/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T15:15:18Z","updated_at":"2018-04-25T15:15:18Z","author_association":"CONTRIBUTOR","body":"it looks like it was just the cruft of 6 years old recipes. It went away after tuning jvm and druid options.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384324366/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/druid/issues/comments/384328912","html_url":"https://github.com/apache/druid/issues/5698#issuecomment-384328912","issue_url":"https://api.github.com/repos/apache/druid/issues/5698","id":384328912,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDMyODkxMg==","user":{"login":"sanastas","id":12136181,"node_id":"MDQ6VXNlcjEyMTM2MTgx","avatar_url":"https://avatars.githubusercontent.com/u/12136181?v=4","gravatar_id":"","url":"https://api.github.com/users/sanastas","html_url":"https://github.com/sanastas","followers_url":"https://api.github.com/users/sanastas/followers","following_url":"https://api.github.com/users/sanastas/following{/other_user}","gists_url":"https://api.github.com/users/sanastas/gists{/gist_id}","starred_url":"https://api.github.com/users/sanastas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanastas/subscriptions","organizations_url":"https://api.github.com/users/sanastas/orgs","repos_url":"https://api.github.com/users/sanastas/repos","events_url":"https://api.github.com/users/sanastas/events{/privacy}","received_events_url":"https://api.github.com/users/sanastas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-04-25T15:28:15Z","updated_at":"2018-04-25T15:28:15Z","author_association":"NONE","body":"We intend to make Oak open source, but it is not yet there. Oak was not yet used in real project, we just measured it performance intensively on different machines and under different workloads. We are looking forward to see how it affects Druid's performance.","reactions":{"url":"https://api.github.com/repos/apache/druid/issues/comments/384328912/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]