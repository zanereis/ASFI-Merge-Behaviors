[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433791990","html_url":"https://github.com/apache/iceberg/pull/6838#issuecomment-1433791990","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6838","id":1433791990,"node_id":"IC_kwDOCW7NX85Vde32","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-16T22:19:01Z","updated_at":"2023-02-16T22:19:01Z","author_association":"CONTRIBUTOR","body":"I rebased my changed, can you take another look? @amogh-jahagirdar and @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433791990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433928069","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1433928069","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1433928069,"node_id":"IC_kwDOCW7NX85VeAGF","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T00:32:23Z","updated_at":"2023-02-17T00:32:23Z","author_association":"CONTRIBUTOR","body":"> 1.) We won't be able to really write tests for the SparkPositionDeltaWrite until the SQL conf change is in because this PR just focuses on data frame write options\r\n\r\nI think to solve this, we should add back the Spark SQL session write config. The problem I raised in [my comment](https://github.com/apache/iceberg/pull/6651#discussion_r1101931339) was only a problem for the read option. If we remove the read session config then we can avoid it. But having the write config doesn't have the same issue (because writes automatically handle cases where the branch doesn't exist) and adding it back would allow us to run the tests.\r\n\r\n> 2.) Behavior of createOrReplaceTable when the branch write option is passed in. Say for example a user does the following:\r\n> \r\n> ```\r\n> data.writeTo(\"prod.db.table\")\r\n>     .tableProperty(\"write.format.default\", \"orc\")\r\n>     .partitionedBy($\"level\", days($\"ts\"))\r\n>    .writeOption(SparkWriteOption.BRANCH, \"branch\")\r\n>     .createOrReplace()\r\n> ```\r\n> \r\n> What should the desired behavior be? Currently what happens is the write will be performed on branch and then if it's a replace the main table state will stay the same. So the `replace` loses its meaning. Another possible desired behavior is the branch is written to and replace will actually perform a replace branch to replace the head of main with the head of the target branch. This is what makes sense to me but I think it'll be hard to achieve this based on catalog/planner abstractions.\r\n\r\nI think the simplest answer is that we can just disallow `branch` with staged Spark tables. The branch should be passed through `LogicalWriteInfo` so we can disable this by adding a method to `StagedSparkTable` that is used for atomic create/replace:\r\n\r\n```java\r\n  @Override\r\n  public WriteBuilder newWriteBuilder(LogicalWriteInfo info) {\r\n    String branch = info.options().get(SparkWriteOptions.BRANCH);\r\n    if (branch != null && !branch.equalsIgnoreCase(SnapshotRef.MAIN_BRANCH)) {\r\n      throw new UnsupportedOperationException(\r\n          String.format(\"Cannot create or replace table with branch: %s\", branch));\r\n    }\r\n\r\n    return super.newWriteBuilder(info);\r\n  }\r\n```\r\n\r\nEventually, we may want to handle this case and decide on behavior. The `create`, `replace`, and `createOrReplace` methods in `DataFrameWriterV2` completely replace the table state, including the schema and partitioning. So the correct behavior for a branch is to add the new schema, partition spec, and properties, then create a new snapshot and set the branch state to that snapshot. This would be similar to the behavior in `TableMetadata.buildReplacement`, but slightly different because it would not need to set the table's current schema and partition spec, just the ones for the branch. We should definitely not handle this right away and should instead just disable it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433928069/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433966548","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1433966548","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1433966548,"node_id":"IC_kwDOCW7NX85VeJfU","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T01:26:32Z","updated_at":"2023-02-17T01:26:32Z","author_association":"CONTRIBUTOR","body":"That makes sense @rdblue , we should just add back the SQL write config and that way we can cover all the write cases. For `createOrReplace` we can just prevent it via `StagedSparkTable` and `LogicalWriteInfo`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1433966548/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434002524","html_url":"https://github.com/apache/iceberg/pull/6771#issuecomment-1434002524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6771","id":1434002524,"node_id":"IC_kwDOCW7NX85VeSRc","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T02:18:22Z","updated_at":"2023-02-17T02:18:22Z","author_association":"COLLABORATOR","body":"Merged, thanks @gaborkaszab , @ajantha-bhat for additional review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434002524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434146591","html_url":"https://github.com/apache/iceberg/issues/6863#issuecomment-1434146591","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6863","id":1434146591,"node_id":"IC_kwDOCW7NX85Ve1cf","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T06:07:14Z","updated_at":"2023-02-17T06:07:14Z","author_association":"CONTRIBUTOR","body":"I will be happy to do this. @RussellSpitzer \r\nBut I have a question, you mean if `spark.sql.catalog.catalog-name.type=hive`, use `spark.sql.catalog.catalog-name.warehouse` as `hive.metastore.warhouse.dir` default configuration of hive catalog value passed into `HiveCatalog`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434146591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434205893","html_url":"https://github.com/apache/iceberg/pull/5984#issuecomment-1434205893","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5984","id":1434205893,"node_id":"IC_kwDOCW7NX85VfD7F","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T07:15:17Z","updated_at":"2023-02-17T07:15:17Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar Thanks for review, addressed the round of comments","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434205893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434369915","html_url":"https://github.com/apache/iceberg/pull/3337#issuecomment-1434369915","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3337","id":1434369915,"node_id":"IC_kwDOCW7NX85Vfr97","user":{"login":"fengguangyuan","id":10569747,"node_id":"MDQ6VXNlcjEwNTY5NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/10569747?v=4","gravatar_id":"","url":"https://api.github.com/users/fengguangyuan","html_url":"https://github.com/fengguangyuan","followers_url":"https://api.github.com/users/fengguangyuan/followers","following_url":"https://api.github.com/users/fengguangyuan/following{/other_user}","gists_url":"https://api.github.com/users/fengguangyuan/gists{/gist_id}","starred_url":"https://api.github.com/users/fengguangyuan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengguangyuan/subscriptions","organizations_url":"https://api.github.com/users/fengguangyuan/orgs","repos_url":"https://api.github.com/users/fengguangyuan/repos","events_url":"https://api.github.com/users/fengguangyuan/events{/privacy}","received_events_url":"https://api.github.com/users/fengguangyuan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T09:27:03Z","updated_at":"2023-02-17T09:27:03Z","author_association":"NONE","body":"> It seems quite dangerous to retry on any `TException` and retry forever. My opinion is that we can set a configurable max retry, and only retry based on exception content. This can be implemented using Iceberg's `Tasks` util class.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434369915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434371245","html_url":"https://github.com/apache/iceberg/pull/3337#issuecomment-1434371245","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3337","id":1434371245,"node_id":"IC_kwDOCW7NX85VfsSt","user":{"login":"fengguangyuan","id":10569747,"node_id":"MDQ6VXNlcjEwNTY5NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/10569747?v=4","gravatar_id":"","url":"https://api.github.com/users/fengguangyuan","html_url":"https://github.com/fengguangyuan","followers_url":"https://api.github.com/users/fengguangyuan/followers","following_url":"https://api.github.com/users/fengguangyuan/following{/other_user}","gists_url":"https://api.github.com/users/fengguangyuan/gists{/gist_id}","starred_url":"https://api.github.com/users/fengguangyuan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengguangyuan/subscriptions","organizations_url":"https://api.github.com/users/fengguangyuan/orgs","repos_url":"https://api.github.com/users/fengguangyuan/repos","events_url":"https://api.github.com/users/fengguangyuan/events{/privacy}","received_events_url":"https://api.github.com/users/fengguangyuan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T09:28:14Z","updated_at":"2023-02-17T09:28:14Z","author_association":"NONE","body":"I believe the new version has resolved this issue with best efforts.\r\nSo I should close this issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434371245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434374131","html_url":"https://github.com/apache/iceberg/issues/6868#issuecomment-1434374131","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6868","id":1434374131,"node_id":"IC_kwDOCW7NX85Vfs_z","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T09:30:59Z","updated_at":"2023-02-17T09:30:59Z","author_association":"CONTRIBUTOR","body":"@zombee0 thanks for raising this question.\r\n\r\nAvro supports parallelization by decoding the blocks in parallel. For example, we could reduce the block size to increase parallelism. But before doing so, I think it is important to understand why the Manifest file is so big. It can be that there are many columns, or there are many small files that you can compact.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434374131/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434387258","html_url":"https://github.com/apache/iceberg/issues/6868#issuecomment-1434387258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6868","id":1434387258,"node_id":"IC_kwDOCW7NX85VfwM6","user":{"login":"zombee0","id":28446271,"node_id":"MDQ6VXNlcjI4NDQ2Mjcx","avatar_url":"https://avatars.githubusercontent.com/u/28446271?v=4","gravatar_id":"","url":"https://api.github.com/users/zombee0","html_url":"https://github.com/zombee0","followers_url":"https://api.github.com/users/zombee0/followers","following_url":"https://api.github.com/users/zombee0/following{/other_user}","gists_url":"https://api.github.com/users/zombee0/gists{/gist_id}","starred_url":"https://api.github.com/users/zombee0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zombee0/subscriptions","organizations_url":"https://api.github.com/users/zombee0/orgs","repos_url":"https://api.github.com/users/zombee0/repos","events_url":"https://api.github.com/users/zombee0/events{/privacy}","received_events_url":"https://api.github.com/users/zombee0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T09:43:04Z","updated_at":"2023-02-17T10:52:39Z","author_association":"NONE","body":"> @zombee0 thanks for raising this question.\r\n> \r\n> Avro supports parallelization by decoding the blocks in parallel. For example, we could reduce the block size to increase parallelism. But before doing so, I think it is important to understand why the Manifest file is so big. It can be that there are many columns, or there are many small files that you can compact.\r\n\r\n@Fokko Yes, we have an iceberg table with almost 1000 column, and I don't know why the manifest file were compacted to several files, and it is very big, when I use iceberg tablescan.plantasks it cost long time","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434387258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434470512","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1434470512","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1434470512,"node_id":"IC_kwDOCW7NX85VgEhw","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T10:55:23Z","updated_at":"2023-02-17T10:55:23Z","author_association":"MEMBER","body":"Restarting the build.\r\n\r\n```\r\nExecution failed for task ':iceberg-spark:iceberg-spark-3.3_2.12:checkstyleMain'.\r\nSee https://docs.gradle.org/7.6/userguide/command_line_interface.html#sec:command_line_warnings\r\n> A failure occurred while executing org.gradle.api.plugins.quality.internal.CheckstyleAction\r\n499 actionable tasks: 499 executed\r\n   > An unexpected error occurred configuring and executing Checkstyle.\r\n      > java.lang.Error: Error was thrown while processing /home/runner/work/iceberg/iceberg/spark/v3.3/spark/src/main/java/org/apache/iceberg/spark/SparkTableUtil.java\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434470512/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434549025","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1434549025","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1434549025,"node_id":"IC_kwDOCW7NX85VgXsh","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T12:06:49Z","updated_at":"2023-02-17T12:06:49Z","author_association":"MEMBER","body":"cc: @snazy, @dimas-b, @nastra   ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434549025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434582970","html_url":"https://github.com/apache/iceberg/pull/6869#issuecomment-1434582970","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6869","id":1434582970,"node_id":"IC_kwDOCW7NX85Vgf-6","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T12:37:36Z","updated_at":"2023-02-17T12:37:36Z","author_association":"MEMBER","body":"cc: @amogh-jahagirdar, @Fokko  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434582970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434587642","html_url":"https://github.com/apache/iceberg/pull/6815#issuecomment-1434587642","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6815","id":1434587642,"node_id":"IC_kwDOCW7NX85VghH6","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T12:42:21Z","updated_at":"2023-02-17T12:42:21Z","author_association":"MEMBER","body":"@amogh-jahagirdar, @rdblue: \r\n\r\nwe have the below compile warning because of the findbugs dependency removal. \r\n\r\n<img width=\"554\" alt=\"image\" src=\"https://user-images.githubusercontent.com/5889404/219656305-a906b689-9db2-48c9-a588-76b61d19ccf3.png\">\r\n\r\n\r\n```\r\n> Task :iceberg-api:compileJava\r\nwarning: unknown enum constant When.UNKNOWN\r\n  reason: class file for javax.annotation.meta.When not found\r\nunknown enum constant When.UNKNOWN\r\n\r\nwarning: unknown enum constant When.UNKNOWN\r\n  reason: class file for javax.annotation.meta.When not found\r\nwarning: unknown enum constant When.UNKNOWN\r\n  reason: class file for javax.annotation.meta.When not found\r\nwarning: unknown enum constant When.UNKNOWN\r\n  reason: class file for javax.annotation.meta.When not found\r\n```  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434587642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434588412","html_url":"https://github.com/apache/iceberg/pull/6090#issuecomment-1434588412","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6090","id":1434588412,"node_id":"IC_kwDOCW7NX85VghT8","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T12:43:09Z","updated_at":"2023-02-17T12:43:09Z","author_association":"MEMBER","body":"@jackye1995: Can you please consider this for the 1.2.0 release?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434588412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434622518","html_url":"https://github.com/apache/iceberg/issues/3340#issuecomment-1434622518","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3340","id":1434622518,"node_id":"IC_kwDOCW7NX85Vgpo2","user":{"login":"fengguangyuan","id":10569747,"node_id":"MDQ6VXNlcjEwNTY5NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/10569747?v=4","gravatar_id":"","url":"https://api.github.com/users/fengguangyuan","html_url":"https://github.com/fengguangyuan","followers_url":"https://api.github.com/users/fengguangyuan/followers","following_url":"https://api.github.com/users/fengguangyuan/following{/other_user}","gists_url":"https://api.github.com/users/fengguangyuan/gists{/gist_id}","starred_url":"https://api.github.com/users/fengguangyuan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengguangyuan/subscriptions","organizations_url":"https://api.github.com/users/fengguangyuan/orgs","repos_url":"https://api.github.com/users/fengguangyuan/repos","events_url":"https://api.github.com/users/fengguangyuan/events{/privacy}","received_events_url":"https://api.github.com/users/fengguangyuan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T13:02:37Z","updated_at":"2023-02-17T13:02:37Z","author_association":"NONE","body":"> > # Why the problem ?\r\n> > Considering the following cases, each `AppendFiles` instance may hold a stale table metadata instance (referenced by `base` defined as a member variable in `SnapshotProducer`), because of some new snapshots committed by other threads or tasks:\r\n> > ```java\r\n> > AppendFiles af1 = table.newAppend().addFile(thread-1.file);\r\n> > AppendFiles af2 = table.newAppend().addFile(thread-2.file);\r\n> > AppendFiles af3 = table.newAppend().addFile(thread-3.file);\r\n> > ...\r\n> > ```\r\n> > \r\n> > \r\n> >     \r\n> >       \r\n> >     \r\n> > \r\n> >       \r\n> >     \r\n> > \r\n> >     \r\n> >   \r\n> > With so many `AppendFiles` existed, the referenced staled `TableMetadata` instances also won't be reclaimed by GC in time, and as we know that the size of TableMetadata instance is increased along with the number of snapshots, in consequence, the GC issues come, commonly seeing `GC overhead limited exceed` error.\r\n> \r\n> Hi @fengguangyuan! Firstly, thank you for your contributions.\r\n> \r\n> I wanted to ask you about your comment here about the GC overhead limit exceeded and your concern with having too many snapshots (which definitely is valid in general, though there are configurations to rewrite snapshots after a certain number and table maintenance operations to keep snapshots at a healthy amount of your needs). I'm hoping you can help me understand more your practices: how you're using the library to achieve this additional parallelism (is this via `.par` to make a Scala parallel collection with Spark, do you have custom code, is it just a configuration property you've raised)? Also, what catalog are you using and what filestore are you writing to? And also (important but I understand if it's not easy to answer right away), at what rate are you accumulating additional snapshots based on the your incoming data (maybe how many files do you have per snapshot in general)? And also, how often are you calling `AppendFile` per commit (as you mentioned `AppendFile` so I'm wondering if you're using the library a bit more directly or what).\r\n> \r\n> I know this isn't necessarily a small ask, but you've given a very thorough description here, and I'd really like to better understand the problems that you're seeing arise as well as your usage of the library. I think it would be really valuable.\r\n> \r\n> Anything you can provide, starting with the basics of:\r\n> \r\n> * system you're using for writing (eg Flink, Spark, Trino, etc),\r\n> * catalog you're using\r\n> * iceberg version you're using\r\n> * any non-default configuration values you're setting, particularly that would affect commit rate and snapshot production\r\n> \r\n> Also, ideally:\r\n> \r\n> * How are you achieving this added parallelism (a config value, high level code in your job, code that you've written using the Iceberg library, etc)\r\n> * If you've written your own code using the Java API, the relationship between commits and AppendaFile\r\n> \r\n> Anything you can share would greatly help in understanding your use case and the problems you're facing more. And there might be learnings to be had from your usage. ðŸ™‚\r\n> \r\n> Thanks, Kyle!\r\nBest regards, Kyle :)\r\n\r\nSo sorry too long to no reply. Thanks for you recommendations, it's a lesson has taken to my heart!\r\n\r\nAfter known more abort the code,  it's indeed a bad case to share a table in different threads.\r\nIt's the caller's responsibilities  NOT to do like that, to avoid generating a large amount staled `metadata` objects with Hive operations in a short time, leading to the pressure on JVM.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434622518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434625639","html_url":"https://github.com/apache/iceberg/issues/3340#issuecomment-1434625639","issue_url":"https://api.github.com/repos/apache/iceberg/issues/3340","id":1434625639,"node_id":"IC_kwDOCW7NX85VgqZn","user":{"login":"fengguangyuan","id":10569747,"node_id":"MDQ6VXNlcjEwNTY5NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/10569747?v=4","gravatar_id":"","url":"https://api.github.com/users/fengguangyuan","html_url":"https://github.com/fengguangyuan","followers_url":"https://api.github.com/users/fengguangyuan/followers","following_url":"https://api.github.com/users/fengguangyuan/following{/other_user}","gists_url":"https://api.github.com/users/fengguangyuan/gists{/gist_id}","starred_url":"https://api.github.com/users/fengguangyuan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fengguangyuan/subscriptions","organizations_url":"https://api.github.com/users/fengguangyuan/orgs","repos_url":"https://api.github.com/users/fengguangyuan/repos","events_url":"https://api.github.com/users/fengguangyuan/events{/privacy}","received_events_url":"https://api.github.com/users/fengguangyuan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T13:05:20Z","updated_at":"2023-02-17T13:05:20Z","author_association":"NONE","body":"> I still do not get why you need to open a new transaction for each thread. The transaction is supposed to be opened at operation start time and only updated in batch after the data files or manifest files are aggregated. What is exactly the use case that would led to the use pattern you describe?\r\n\r\nBest regards, jackey. :)\r\nI will close this issue because of misuse of the `Table`!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434625639/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434626097","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1434626097","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1434626097,"node_id":"IC_kwDOCW7NX85Vgqgx","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T13:05:45Z","updated_at":"2023-02-17T13:05:45Z","author_association":"MEMBER","body":"Sure this does not break the expected-hash calculations for commits?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434626097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434626492","html_url":"https://github.com/apache/iceberg/issues/6868#issuecomment-1434626492","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6868","id":1434626492,"node_id":"IC_kwDOCW7NX85Vgqm8","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T13:06:04Z","updated_at":"2023-02-17T13:06:04Z","author_association":"CONTRIBUTOR","body":"@zombee0 Got it, and do you use the statistics over all the columns? You can also configure how to collect all the statistics: https://iceberg.apache.org/docs/latest/configuration/#write-properties\r\n\r\n![image](https://user-images.githubusercontent.com/1134248/219660666-67572dc0-ed12-48eb-8399-b8c72d36a0c0.png)\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434626492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434697865","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1434697865","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1434697865,"node_id":"IC_kwDOCW7NX85Vg8CJ","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T14:06:21Z","updated_at":"2023-02-17T14:07:48Z","author_association":"MEMBER","body":"> Sure this does not break the expected-hash calculations for commits?\r\n\r\nI just added a testcase for commit from multiple catalogs/clients on same branch + same table. It passes. \r\nSo, I think there is no impact. \r\nAlso, expected hash is passed after the refresh operation from NessieCatalog. So, the client won't be modified after passing expected hash in the same flow.\r\n\r\n@snazy: Do you see any problem with the current changes? Do you feel we should only modify `listTables, listNamespaces, listNamespaceMetadata, removeProperties,  setProperties` instead of refreshing all the APIs? \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434697865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434753229","html_url":"https://github.com/apache/iceberg/issues/6863#issuecomment-1434753229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6863","id":1434753229,"node_id":"IC_kwDOCW7NX85VhJjN","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T14:50:36Z","updated_at":"2023-02-17T14:50:36Z","author_association":"MEMBER","body":"I think that is one way to do it. We also may want to consider if we should respect the Spark.sql.warehouse did property if it exists ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434753229/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434943296","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1434943296","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1434943296,"node_id":"IC_kwDOCW7NX85Vh39A","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T17:08:32Z","updated_at":"2023-02-17T17:08:32Z","author_association":"MEMBER","body":"Isn't now also (without this PR) if two concurrent commits happen for a same table, the client can get refreshed between the \r\ncaller of this\r\nhttps://github.com/apache/iceberg/blob/bb95e8bb1a9c283b86afeae978d2f838456c5d03/nessie/src/main/java/org/apache/iceberg/nessie/NessieIcebergClient.java#L423 \r\nto \r\nhttps://github.com/apache/iceberg/blob/bb95e8bb1a9c283b86afeae978d2f838456c5d03/nessie/src/main/java/org/apache/iceberg/nessie/NessieIcebergClient.java#L430\r\n\r\nbecause of existing refresh in this code by concurrent operations?\r\nhttps://github.com/apache/iceberg/blob/bb95e8bb1a9c283b86afeae978d2f838456c5d03/core/src/main/java/org/apache/iceberg/BaseMetastoreTableOperations.java#L119\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1434943296/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435029763","html_url":"https://github.com/apache/iceberg/pull/6846#issuecomment-1435029763","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6846","id":1435029763,"node_id":"IC_kwDOCW7NX85ViNED","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T17:51:22Z","updated_at":"2023-02-17T17:51:22Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi  fixed all the tests. Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435029763/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435041793","html_url":"https://github.com/apache/iceberg/pull/6823#issuecomment-1435041793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6823","id":1435041793,"node_id":"IC_kwDOCW7NX85ViQAB","user":{"login":"munendrasn","id":9696252,"node_id":"MDQ6VXNlcjk2OTYyNTI=","avatar_url":"https://avatars.githubusercontent.com/u/9696252?v=4","gravatar_id":"","url":"https://api.github.com/users/munendrasn","html_url":"https://github.com/munendrasn","followers_url":"https://api.github.com/users/munendrasn/followers","following_url":"https://api.github.com/users/munendrasn/following{/other_user}","gists_url":"https://api.github.com/users/munendrasn/gists{/gist_id}","starred_url":"https://api.github.com/users/munendrasn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/munendrasn/subscriptions","organizations_url":"https://api.github.com/users/munendrasn/orgs","repos_url":"https://api.github.com/users/munendrasn/repos","events_url":"https://api.github.com/users/munendrasn/events{/privacy}","received_events_url":"https://api.github.com/users/munendrasn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T17:59:32Z","updated_at":"2023-02-17T17:59:32Z","author_association":"CONTRIBUTOR","body":"Thank you all for the review ðŸ™‚ ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435041793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435042523","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1435042523","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1435042523,"node_id":"IC_kwDOCW7NX85ViQLb","user":{"login":"dimas-b","id":40603221,"node_id":"MDQ6VXNlcjQwNjAzMjIx","avatar_url":"https://avatars.githubusercontent.com/u/40603221?v=4","gravatar_id":"","url":"https://api.github.com/users/dimas-b","html_url":"https://github.com/dimas-b","followers_url":"https://api.github.com/users/dimas-b/followers","following_url":"https://api.github.com/users/dimas-b/following{/other_user}","gists_url":"https://api.github.com/users/dimas-b/gists{/gist_id}","starred_url":"https://api.github.com/users/dimas-b/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimas-b/subscriptions","organizations_url":"https://api.github.com/users/dimas-b/orgs","repos_url":"https://api.github.com/users/dimas-b/repos","events_url":"https://api.github.com/users/dimas-b/events{/privacy}","received_events_url":"https://api.github.com/users/dimas-b/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T18:00:06Z","updated_at":"2023-02-17T18:00:19Z","author_association":"CONTRIBUTOR","body":"> Isn't now also (without this PR) if two concurrent commits happen for a same table, the client can get refreshed [...]\r\n\r\nI think so. This issue is not specific to this PR. I just think this PR makes it more likely to manifest.\r\n\r\nWould it be possible to keep the \"expected\" hash at the Tx level?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435042523/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435143309","html_url":"https://github.com/apache/iceberg/pull/6875#issuecomment-1435143309","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6875","id":1435143309,"node_id":"IC_kwDOCW7NX85VioyN","user":{"login":"dimas-b","id":40603221,"node_id":"MDQ6VXNlcjQwNjAzMjIx","avatar_url":"https://avatars.githubusercontent.com/u/40603221?v=4","gravatar_id":"","url":"https://api.github.com/users/dimas-b","html_url":"https://github.com/dimas-b","followers_url":"https://api.github.com/users/dimas-b/followers","following_url":"https://api.github.com/users/dimas-b/following{/other_user}","gists_url":"https://api.github.com/users/dimas-b/gists{/gist_id}","starred_url":"https://api.github.com/users/dimas-b/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimas-b/subscriptions","organizations_url":"https://api.github.com/users/dimas-b/orgs","repos_url":"https://api.github.com/users/dimas-b/repos","events_url":"https://api.github.com/users/dimas-b/events{/privacy}","received_events_url":"https://api.github.com/users/dimas-b/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T19:36:03Z","updated_at":"2023-02-17T19:36:03Z","author_association":"CONTRIBUTOR","body":"cc: @snazy @ajantha-bhat ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435143309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435227269","html_url":"https://github.com/apache/iceberg/pull/6876#issuecomment-1435227269","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6876","id":1435227269,"node_id":"IC_kwDOCW7NX85Vi9SF","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T20:24:31Z","updated_at":"2023-02-17T20:24:31Z","author_association":"CONTRIBUTOR","body":"cc @karuppayya @RussellSpitzer @rdblue @szehon-ho @flyrain @amogh-jahagirdar @singhpk234 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435227269/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435230249","html_url":"https://github.com/apache/iceberg/issues/6647#issuecomment-1435230249","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6647","id":1435230249,"node_id":"IC_kwDOCW7NX85Vi-Ap","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T20:27:51Z","updated_at":"2023-02-17T20:27:51Z","author_association":"CONTRIBUTOR","body":"@Fokko, the solution here is to convert the Parquet schema to Iceberg and preserve the IDs right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435230249/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435236861","html_url":"https://github.com/apache/iceberg/pull/6838#issuecomment-1435236861","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6838","id":1435236861,"node_id":"IC_kwDOCW7NX85Vi_n9","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T20:32:25Z","updated_at":"2023-02-17T20:32:25Z","author_association":"CONTRIBUTOR","body":"Thanks, @dramaticlly! Thanks for reviewing, @amogh-jahagirdar!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435236861/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435237338","html_url":"https://github.com/apache/iceberg/pull/6838#issuecomment-1435237338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6838","id":1435237338,"node_id":"IC_kwDOCW7NX85Vi_va","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T20:33:04Z","updated_at":"2023-02-17T20:33:04Z","author_association":"CONTRIBUTOR","body":"Thank you @aokolnychyi , I can refactor and also add more tests for SparkWirteConf in general if you want. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435237338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435257994","html_url":"https://github.com/apache/iceberg/pull/6846#issuecomment-1435257994","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6846","id":1435257994,"node_id":"IC_kwDOCW7NX85VjEyK","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T20:55:52Z","updated_at":"2023-02-17T20:55:52Z","author_association":"CONTRIBUTOR","body":"Thank you, @abmo-x!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435257994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435265950","html_url":"https://github.com/apache/iceberg/pull/6716#issuecomment-1435265950","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6716","id":1435265950,"node_id":"IC_kwDOCW7NX85VjGue","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T21:04:50Z","updated_at":"2023-02-17T21:04:50Z","author_association":"CONTRIBUTOR","body":"Thanks, @szehon-ho! It is nice to have this done. I also added @rdblue as a co-author since this PR includes some logic from PR #6599.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435265950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435319406","html_url":"https://github.com/apache/iceberg/pull/6877#issuecomment-1435319406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6877","id":1435319406,"node_id":"IC_kwDOCW7NX85VjTxu","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T21:55:56Z","updated_at":"2023-02-17T21:55:56Z","author_association":"CONTRIBUTOR","body":"cc @RussellSpitzer @rdblue @jackye1995 @dramaticlly","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435319406/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435325527","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1435325527","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1435325527,"node_id":"IC_kwDOCW7NX85VjVRX","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T22:02:59Z","updated_at":"2023-02-17T22:02:59Z","author_association":"CONTRIBUTOR","body":"I see some comments have been resolved but the code hasn't been updated yet. I assume those will be fixed and pushed together with the SQL write config and handling of staged tables?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435325527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435337753","html_url":"https://github.com/apache/iceberg/pull/6875#issuecomment-1435337753","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6875","id":1435337753,"node_id":"IC_kwDOCW7NX85VjYQZ","user":{"login":"dimas-b","id":40603221,"node_id":"MDQ6VXNlcjQwNjAzMjIx","avatar_url":"https://avatars.githubusercontent.com/u/40603221?v=4","gravatar_id":"","url":"https://api.github.com/users/dimas-b","html_url":"https://github.com/dimas-b","followers_url":"https://api.github.com/users/dimas-b/followers","following_url":"https://api.github.com/users/dimas-b/following{/other_user}","gists_url":"https://api.github.com/users/dimas-b/gists{/gist_id}","starred_url":"https://api.github.com/users/dimas-b/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimas-b/subscriptions","organizations_url":"https://api.github.com/users/dimas-b/orgs","repos_url":"https://api.github.com/users/dimas-b/repos","events_url":"https://api.github.com/users/dimas-b/events{/privacy}","received_events_url":"https://api.github.com/users/dimas-b/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T22:16:19Z","updated_at":"2023-02-17T22:16:19Z","author_association":"CONTRIBUTOR","body":"Hmmm... `TestNessieTable` passed locally, but failed in CI :thinking: I'll investigate next week.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435337753/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435352632","html_url":"https://github.com/apache/iceberg/pull/6651#issuecomment-1435352632","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6651","id":1435352632,"node_id":"IC_kwDOCW7NX85Vjb44","user":{"login":"namrathamyske","id":17932873,"node_id":"MDQ6VXNlcjE3OTMyODcz","avatar_url":"https://avatars.githubusercontent.com/u/17932873?v=4","gravatar_id":"","url":"https://api.github.com/users/namrathamyske","html_url":"https://github.com/namrathamyske","followers_url":"https://api.github.com/users/namrathamyske/followers","following_url":"https://api.github.com/users/namrathamyske/following{/other_user}","gists_url":"https://api.github.com/users/namrathamyske/gists{/gist_id}","starred_url":"https://api.github.com/users/namrathamyske/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/namrathamyske/subscriptions","organizations_url":"https://api.github.com/users/namrathamyske/orgs","repos_url":"https://api.github.com/users/namrathamyske/repos","events_url":"https://api.github.com/users/namrathamyske/events{/privacy}","received_events_url":"https://api.github.com/users/namrathamyske/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T22:33:01Z","updated_at":"2023-02-17T22:33:26Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi sorry has missed committing it. Now all changes from review have been incorporated. SQL write config and handling of staged tables is still pending in this PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435352632/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435355617","html_url":"https://github.com/apache/iceberg/pull/5629#issuecomment-1435355617","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5629","id":1435355617,"node_id":"IC_kwDOCW7NX85Vjcnh","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T22:36:24Z","updated_at":"2023-02-17T22:38:10Z","author_association":"CONTRIBUTOR","body":"This seems a bit odd to me, to be honest. Why not use `scan.description()` in Spark for this?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435355617/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435399907","html_url":"https://github.com/apache/iceberg/pull/5615#issuecomment-1435399907","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5615","id":1435399907,"node_id":"IC_kwDOCW7NX85Vjnbj","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-17T23:44:51Z","updated_at":"2023-02-17T23:44:51Z","author_association":"CONTRIBUTOR","body":"Thank you, @karuppayya! It is great to have this done.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435399907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435413448","html_url":"https://github.com/apache/iceberg/issues/5424#issuecomment-1435413448","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5424","id":1435413448,"node_id":"IC_kwDOCW7NX85VjqvI","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-18T00:12:04Z","updated_at":"2023-02-18T00:12:04Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435413448/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435481371","html_url":"https://github.com/apache/iceberg/issues/6868#issuecomment-1435481371","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6868","id":1435481371,"node_id":"IC_kwDOCW7NX85Vj7Ub","user":{"login":"zombee0","id":28446271,"node_id":"MDQ6VXNlcjI4NDQ2Mjcx","avatar_url":"https://avatars.githubusercontent.com/u/28446271?v=4","gravatar_id":"","url":"https://api.github.com/users/zombee0","html_url":"https://github.com/zombee0","followers_url":"https://api.github.com/users/zombee0/followers","following_url":"https://api.github.com/users/zombee0/following{/other_user}","gists_url":"https://api.github.com/users/zombee0/gists{/gist_id}","starred_url":"https://api.github.com/users/zombee0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zombee0/subscriptions","organizations_url":"https://api.github.com/users/zombee0/orgs","repos_url":"https://api.github.com/users/zombee0/repos","events_url":"https://api.github.com/users/zombee0/events{/privacy}","received_events_url":"https://api.github.com/users/zombee0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-18T04:38:15Z","updated_at":"2023-02-18T04:38:15Z","author_association":"NONE","body":"@Fokko Does the iceberg team have any plan to support decode a big manifest file with several threads parallel?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435481371/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435526469","html_url":"https://github.com/apache/iceberg/pull/6831#issuecomment-1435526469","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6831","id":1435526469,"node_id":"IC_kwDOCW7NX85VkGVF","user":{"login":"wangyinsheng","id":13392313,"node_id":"MDQ6VXNlcjEzMzkyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/13392313?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyinsheng","html_url":"https://github.com/wangyinsheng","followers_url":"https://api.github.com/users/wangyinsheng/followers","following_url":"https://api.github.com/users/wangyinsheng/following{/other_user}","gists_url":"https://api.github.com/users/wangyinsheng/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyinsheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyinsheng/subscriptions","organizations_url":"https://api.github.com/users/wangyinsheng/orgs","repos_url":"https://api.github.com/users/wangyinsheng/repos","events_url":"https://api.github.com/users/wangyinsheng/events{/privacy}","received_events_url":"https://api.github.com/users/wangyinsheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-18T09:03:38Z","updated_at":"2023-02-18T09:03:38Z","author_association":"CONTRIBUTOR","body":"@Fokko PTAL","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435526469/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435667169","html_url":"https://github.com/apache/iceberg/issues/6522#issuecomment-1435667169","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6522","id":1435667169,"node_id":"IC_kwDOCW7NX85Vkorh","user":{"login":"leichangqing","id":36058877,"node_id":"MDQ6VXNlcjM2MDU4ODc3","avatar_url":"https://avatars.githubusercontent.com/u/36058877?v=4","gravatar_id":"","url":"https://api.github.com/users/leichangqing","html_url":"https://github.com/leichangqing","followers_url":"https://api.github.com/users/leichangqing/followers","following_url":"https://api.github.com/users/leichangqing/following{/other_user}","gists_url":"https://api.github.com/users/leichangqing/gists{/gist_id}","starred_url":"https://api.github.com/users/leichangqing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leichangqing/subscriptions","organizations_url":"https://api.github.com/users/leichangqing/orgs","repos_url":"https://api.github.com/users/leichangqing/repos","events_url":"https://api.github.com/users/leichangqing/events{/privacy}","received_events_url":"https://api.github.com/users/leichangqing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-18T13:12:52Z","updated_at":"2023-02-18T13:12:52Z","author_association":"NONE","body":"\r\n<img width=\"1027\" alt=\"image\" src=\"https://user-images.githubusercontent.com/36058877/219867698-c745b74b-11cf-463f-8b37-89eb14d9f529.png\">\r\n\r\n# HADOOP_HOME is your hadoop root directory after unpack the binary package.\r\nexport HADOOP_CLASSPATH=`$HADOOP_HOME/bin/hadoop classpath`\r\n\r\n# Start the flink standalone cluster\r\n/app/flink/bin/sql-client.sh embedded \\\r\n-j '/app/flink/lib/iceberg-flink-runtime-1.16-1.1.0.jar' \\\r\n-j '/app/flink/lib/flink-sql-connector-hive-3.1.2_2.12-1.16.1.jar' \\\r\nshell\r\n~       \r\n\r\njava.lang.ClassCastException: org.apache.iceberg.hive.HiveCatalog cannot be cast to org.apache.iceberg.catalog.Catalog","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435667169/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435719206","html_url":"https://github.com/apache/iceberg/issues/6420#issuecomment-1435719206","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6420","id":1435719206,"node_id":"IC_kwDOCW7NX85Vk1Ym","user":{"login":"wmoustafa","id":10084105,"node_id":"MDQ6VXNlcjEwMDg0MTA1","avatar_url":"https://avatars.githubusercontent.com/u/10084105?v=4","gravatar_id":"","url":"https://api.github.com/users/wmoustafa","html_url":"https://github.com/wmoustafa","followers_url":"https://api.github.com/users/wmoustafa/followers","following_url":"https://api.github.com/users/wmoustafa/following{/other_user}","gists_url":"https://api.github.com/users/wmoustafa/gists{/gist_id}","starred_url":"https://api.github.com/users/wmoustafa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wmoustafa/subscriptions","organizations_url":"https://api.github.com/users/wmoustafa/orgs","repos_url":"https://api.github.com/users/wmoustafa/repos","events_url":"https://api.github.com/users/wmoustafa/events{/privacy}","received_events_url":"https://api.github.com/users/wmoustafa/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-18T17:09:43Z","updated_at":"2023-02-18T17:09:43Z","author_association":"CONTRIBUTOR","body":"That is correct @JanKaul. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435719206/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435798046","html_url":"https://github.com/apache/iceberg/issues/5613#issuecomment-1435798046","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5613","id":1435798046,"node_id":"IC_kwDOCW7NX85VlIoe","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T00:13:14Z","updated_at":"2023-02-19T00:13:14Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435798046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435798049","html_url":"https://github.com/apache/iceberg/issues/5607#issuecomment-1435798049","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5607","id":1435798049,"node_id":"IC_kwDOCW7NX85VlIoh","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T00:13:16Z","updated_at":"2023-02-19T00:13:16Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435798049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435798056","html_url":"https://github.com/apache/iceberg/issues/5579#issuecomment-1435798056","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5579","id":1435798056,"node_id":"IC_kwDOCW7NX85VlIoo","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T00:13:18Z","updated_at":"2023-02-19T00:13:18Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435798056/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435806740","html_url":"https://github.com/apache/iceberg/issues/2468#issuecomment-1435806740","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2468","id":1435806740,"node_id":"IC_kwDOCW7NX85VlKwU","user":{"login":"leichangqing","id":36058877,"node_id":"MDQ6VXNlcjM2MDU4ODc3","avatar_url":"https://avatars.githubusercontent.com/u/36058877?v=4","gravatar_id":"","url":"https://api.github.com/users/leichangqing","html_url":"https://github.com/leichangqing","followers_url":"https://api.github.com/users/leichangqing/followers","following_url":"https://api.github.com/users/leichangqing/following{/other_user}","gists_url":"https://api.github.com/users/leichangqing/gists{/gist_id}","starred_url":"https://api.github.com/users/leichangqing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leichangqing/subscriptions","organizations_url":"https://api.github.com/users/leichangqing/orgs","repos_url":"https://api.github.com/users/leichangqing/repos","events_url":"https://api.github.com/users/leichangqing/events{/privacy}","received_events_url":"https://api.github.com/users/leichangqing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T01:10:18Z","updated_at":"2023-02-19T01:10:18Z","author_association":"NONE","body":"the issue still exists in iceberg1.1.0 on flink1.16.1.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435806740/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435809940","html_url":"https://github.com/apache/iceberg/issues/2468#issuecomment-1435809940","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2468","id":1435809940,"node_id":"IC_kwDOCW7NX85VlLiU","user":{"login":"leichangqing","id":36058877,"node_id":"MDQ6VXNlcjM2MDU4ODc3","avatar_url":"https://avatars.githubusercontent.com/u/36058877?v=4","gravatar_id":"","url":"https://api.github.com/users/leichangqing","html_url":"https://github.com/leichangqing","followers_url":"https://api.github.com/users/leichangqing/followers","following_url":"https://api.github.com/users/leichangqing/following{/other_user}","gists_url":"https://api.github.com/users/leichangqing/gists{/gist_id}","starred_url":"https://api.github.com/users/leichangqing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leichangqing/subscriptions","organizations_url":"https://api.github.com/users/leichangqing/orgs","repos_url":"https://api.github.com/users/leichangqing/repos","events_url":"https://api.github.com/users/leichangqing/events{/privacy}","received_events_url":"https://api.github.com/users/leichangqing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T01:33:35Z","updated_at":"2023-02-19T01:33:35Z","author_association":"NONE","body":"I found the issue cause:","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435809940/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435810205","html_url":"https://github.com/apache/iceberg/issues/5613#issuecomment-1435810205","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5613","id":1435810205,"node_id":"IC_kwDOCW7NX85VlLmd","user":{"login":"stevenzwu","id":1545663,"node_id":"MDQ6VXNlcjE1NDU2NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1545663?v=4","gravatar_id":"","url":"https://api.github.com/users/stevenzwu","html_url":"https://github.com/stevenzwu","followers_url":"https://api.github.com/users/stevenzwu/followers","following_url":"https://api.github.com/users/stevenzwu/following{/other_user}","gists_url":"https://api.github.com/users/stevenzwu/gists{/gist_id}","starred_url":"https://api.github.com/users/stevenzwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stevenzwu/subscriptions","organizations_url":"https://api.github.com/users/stevenzwu/orgs","repos_url":"https://api.github.com/users/stevenzwu/repos","events_url":"https://api.github.com/users/stevenzwu/events{/privacy}","received_events_url":"https://api.github.com/users/stevenzwu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T01:35:22Z","updated_at":"2023-02-19T01:35:22Z","author_association":"CONTRIBUTOR","body":"this is implemented by PR #6299 \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435810205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435810264","html_url":"https://github.com/apache/iceberg/issues/2468#issuecomment-1435810264","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2468","id":1435810264,"node_id":"IC_kwDOCW7NX85VlLnY","user":{"login":"leichangqing","id":36058877,"node_id":"MDQ6VXNlcjM2MDU4ODc3","avatar_url":"https://avatars.githubusercontent.com/u/36058877?v=4","gravatar_id":"","url":"https://api.github.com/users/leichangqing","html_url":"https://github.com/leichangqing","followers_url":"https://api.github.com/users/leichangqing/followers","following_url":"https://api.github.com/users/leichangqing/following{/other_user}","gists_url":"https://api.github.com/users/leichangqing/gists{/gist_id}","starred_url":"https://api.github.com/users/leichangqing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leichangqing/subscriptions","organizations_url":"https://api.github.com/users/leichangqing/orgs","repos_url":"https://api.github.com/users/leichangqing/repos","events_url":"https://api.github.com/users/leichangqing/events{/privacy}","received_events_url":"https://api.github.com/users/leichangqing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T01:35:47Z","updated_at":"2023-02-19T01:35:47Z","author_association":"NONE","body":"BEFORE:  install flink1.16.1 with hive3.1.2, the download 2 jars(iceberg-flink-runtime-1.16-1.1.0.jar, iceberg-hive-runtime-1.1.0.jar) and place at flink1.16.1/lib,   refer to many website to start sql-client.sh as following:","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435810264/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435810559","html_url":"https://github.com/apache/iceberg/issues/2468#issuecomment-1435810559","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2468","id":1435810559,"node_id":"IC_kwDOCW7NX85VlLr_","user":{"login":"leichangqing","id":36058877,"node_id":"MDQ6VXNlcjM2MDU4ODc3","avatar_url":"https://avatars.githubusercontent.com/u/36058877?v=4","gravatar_id":"","url":"https://api.github.com/users/leichangqing","html_url":"https://github.com/leichangqing","followers_url":"https://api.github.com/users/leichangqing/followers","following_url":"https://api.github.com/users/leichangqing/following{/other_user}","gists_url":"https://api.github.com/users/leichangqing/gists{/gist_id}","starred_url":"https://api.github.com/users/leichangqing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leichangqing/subscriptions","organizations_url":"https://api.github.com/users/leichangqing/orgs","repos_url":"https://api.github.com/users/leichangqing/repos","events_url":"https://api.github.com/users/leichangqing/events{/privacy}","received_events_url":"https://api.github.com/users/leichangqing/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T01:37:56Z","updated_at":"2023-02-19T01:37:56Z","author_association":"NONE","body":"# HADOOP_HOME is your hadoop root directory after unpack the binary package.\r\nexport HADOOP_HOME=/app/hadoop-3.3.3\r\nexport HADOOP_CLASSPATH=`$HADOOP_HOME/bin/hadoop classpath`\r\n\r\n# Start the flink standalone cluster\r\n/app/flink/bin/sql-client.sh embedded \\\r\n-j '/app/flink/lib/iceberg-flink-runtime-1.16-1.1.0.jar' \\\r\n-j '/app/flink/lib/flink-sql-connector-hive-3.1.2_2.12-1.16.1.jar' \\\r\n-j '/app/flink/lib/iceberg-hive-runtime-1.1.0.jar' \\\r\nshell\r\nAFTER: modify the start command as following, the issue was fixed\r\nexport HADOOP_HOME=/app/hadoop-3.3.3\r\nexport HADOOP_CLASSPATH=`$HADOOP_HOME/bin/hadoop classpath`\r\n\r\n# Start the flink standalone cluster\r\n/app/flink/bin/sql-client.sh embedded \\\r\nshell\r\n~                                                                                                                                             \r\nI think that flink default jar have conflict with -j.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435810559/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435903566","html_url":"https://github.com/apache/iceberg/pull/6831#issuecomment-1435903566","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6831","id":1435903566,"node_id":"IC_kwDOCW7NX85VliZO","user":{"login":"wangyinsheng","id":13392313,"node_id":"MDQ6VXNlcjEzMzkyMzEz","avatar_url":"https://avatars.githubusercontent.com/u/13392313?v=4","gravatar_id":"","url":"https://api.github.com/users/wangyinsheng","html_url":"https://github.com/wangyinsheng","followers_url":"https://api.github.com/users/wangyinsheng/followers","following_url":"https://api.github.com/users/wangyinsheng/following{/other_user}","gists_url":"https://api.github.com/users/wangyinsheng/gists{/gist_id}","starred_url":"https://api.github.com/users/wangyinsheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangyinsheng/subscriptions","organizations_url":"https://api.github.com/users/wangyinsheng/orgs","repos_url":"https://api.github.com/users/wangyinsheng/repos","events_url":"https://api.github.com/users/wangyinsheng/events{/privacy}","received_events_url":"https://api.github.com/users/wangyinsheng/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T06:12:25Z","updated_at":"2023-02-19T06:12:25Z","author_association":"CONTRIBUTOR","body":"@rdblue PTAL","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1435903566/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436091339","html_url":"https://github.com/apache/iceberg/issues/6647#issuecomment-1436091339","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6647","id":1436091339,"node_id":"IC_kwDOCW7NX85VmQPL","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T20:57:24Z","updated_at":"2023-02-19T20:57:45Z","author_association":"CONTRIBUTOR","body":"@rdblue that's correct.\r\n\r\nI took a shortcut and get the schema from the metadata. That should still be the preferred way because it is probably faster (Pydantic without any GIL just going through the JSON document).\r\n\r\nHowever, the fields in Parquet also have metadata, and those contain the `field_id`:\r\n```python\r\nâžœ  Desktop python3\r\nPython 3.10.10 (main, Feb  8 2023, 05:34:50) [Clang 14.0.0 (clang-1400.0.29.202)] on darwin\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from pyarrow.fs import LocalFileSystem\r\n>>> import pyarrow.parquet as pq\r\n>>> \r\n>>> fs = LocalFileSystem()\r\n>>> \r\n>>> path = \"/Users/fokkodriesprong/Desktop/00003-4-5e18fe8b-532b-42ec-bdb9-0c7ba7078155-00001.parquet\"\r\n>>> \r\n>>> with fs.open_input_file(path) as fout:\r\n...     parquet_schema = pq.read_schema(fout)\r\n... \r\n>>> \r\n>>> parquet_schema\r\nVendorID: int64\r\n  -- field metadata --\r\n  PARQUET:field_id: '1'\r\ntpep_pickup_datetime: timestamp[us, tz=UTC]\r\n  -- field metadata --\r\n  PARQUET:field_id: '2'\r\ntpep_dropoff_datetime: timestamp[us, tz=UTC]\r\n  -- field metadata --\r\n  PARQUET:field_id: '3'\r\npassenger_count: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '4'\r\ntrip_distance: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '5'\r\nRatecodeID: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '6'\r\nstore_and_fwd_flag: string\r\n  -- field metadata --\r\n  PARQUET:field_id: '7'\r\nPULocationID: int64\r\n  -- field metadata --\r\n  PARQUET:field_id: '8'\r\nDOLocationID: int64\r\n  -- field metadata --\r\n  PARQUET:field_id: '9'\r\npayment_type: int64\r\n  -- field metadata --\r\n  PARQUET:field_id: '10'\r\nfare_amount: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '11'\r\nextra: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '12'\r\nmta_tax: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '13'\r\ntip_amount: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '14'\r\ntolls_amount: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '15'\r\nimprovement_surcharge: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '16'\r\ntotal_amount: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '17'\r\ncongestion_surcharge: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '18'\r\nairport_fee: double\r\n  -- field metadata --\r\n  PARQUET:field_id: '19'\r\n-- schema metadata --\r\niceberg.schema: '{\"type\":\"struct\",\"schema-id\":0,\"fields\":[{\"id\":1,\"name\":' + 1236\r\n```\r\n\r\n@amogh-jahagirdar  The idea is to implement a visitor to convert this Arrow schema to an Iceberg one with the correct IDs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436091339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436093092","html_url":"https://github.com/apache/iceberg/pull/6882#issuecomment-1436093092","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6882","id":1436093092,"node_id":"IC_kwDOCW7NX85VmQqk","user":{"login":"dependabot[bot]","id":49699333,"node_id":"MDM6Qm90NDk2OTkzMzM=","avatar_url":"https://avatars.githubusercontent.com/in/29110?v=4","gravatar_id":"","url":"https://api.github.com/users/dependabot%5Bbot%5D","html_url":"https://github.com/apps/dependabot","followers_url":"https://api.github.com/users/dependabot%5Bbot%5D/followers","following_url":"https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dependabot%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/dependabot%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/dependabot%5Bbot%5D/repos","events_url":"https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/dependabot%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-19T21:03:33Z","updated_at":"2023-02-19T21:03:33Z","author_association":"CONTRIBUTOR","body":"Looks like duckdb is up-to-date now, so this is no longer needed.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436093092/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436142396","html_url":"https://github.com/apache/iceberg/issues/5477#issuecomment-1436142396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5477","id":1436142396,"node_id":"IC_kwDOCW7NX85Vmcs8","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T00:13:21Z","updated_at":"2023-02-20T00:13:21Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436142396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436494627","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1436494627","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1436494627,"node_id":"IC_kwDOCW7NX85Vnysj","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T07:50:27Z","updated_at":"2023-02-20T07:50:27Z","author_association":"MEMBER","body":"> I think so. This issue is not specific to this PR. I just think this PR makes it more likely to manifest.\r\nWould it be possible to keep the \"expected\" hash at the Tx level?\r\n\r\n@dimas-b : In that case, txn can only commit one successful commit?\r\n\r\n> Sure this does not break the expected-hash calculations for commits?\r\n\r\n@snazy: can you please elaborate on this? Without this PR also, concurrent commits from the same client can refresh the catalog and cause breakage of expected-hash. \r\n\r\na) Are you suggesting that this PR will increase the probability of that event happening and we don't want to do that?  \r\nb) Even the sequential updates have issues mentioned in the PR description and I want to fix them. Should I keep the changes only for `listTables(), listNamespaces(), loadNamespaceMetadata(), setProperties(), removeProperties()`?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436494627/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436838847","html_url":"https://github.com/apache/iceberg/pull/6886#issuecomment-1436838847","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6886","id":1436838847,"node_id":"IC_kwDOCW7NX85VpGu_","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T11:46:48Z","updated_at":"2023-02-20T11:46:48Z","author_association":"CONTRIBUTOR","body":"I checked the test code in the spark test directory, and I couldn't find a suitable place to add the test, so I may need a little hint on how to add the test for this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436838847/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436846022","html_url":"https://github.com/apache/iceberg/issues/6863#issuecomment-1436846022","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6863","id":1436846022,"node_id":"IC_kwDOCW7NX85VpIfG","user":{"login":"youngxinler","id":36697727,"node_id":"MDQ6VXNlcjM2Njk3NzI3","avatar_url":"https://avatars.githubusercontent.com/u/36697727?v=4","gravatar_id":"","url":"https://api.github.com/users/youngxinler","html_url":"https://github.com/youngxinler","followers_url":"https://api.github.com/users/youngxinler/followers","following_url":"https://api.github.com/users/youngxinler/following{/other_user}","gists_url":"https://api.github.com/users/youngxinler/gists{/gist_id}","starred_url":"https://api.github.com/users/youngxinler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youngxinler/subscriptions","organizations_url":"https://api.github.com/users/youngxinler/orgs","repos_url":"https://api.github.com/users/youngxinler/repos","events_url":"https://api.github.com/users/youngxinler/events{/privacy}","received_events_url":"https://api.github.com/users/youngxinler/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T11:50:19Z","updated_at":"2023-02-20T11:50:19Z","author_association":"CONTRIBUTOR","body":"thanks for @RussellSpitzer , good hint,  i supports `spark.sql.warehouse.dir` and assumes that `spark.sql.catalog.$catalogName.warehouse` is preferred.\r\n\r\nPR has been associated, if there is any problem with the code, you can directly raise it, looking forward to your guidance and review.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436846022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436901624","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1436901624","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1436901624,"node_id":"IC_kwDOCW7NX85VpWD4","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T12:15:11Z","updated_at":"2023-02-20T12:15:11Z","author_association":"MEMBER","body":"I'm suggesting to provide a fix for it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436901624/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436923998","html_url":"https://github.com/apache/iceberg/pull/6887#issuecomment-1436923998","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6887","id":1436923998,"node_id":"IC_kwDOCW7NX85Vpbhe","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T12:25:01Z","updated_at":"2023-02-20T12:25:01Z","author_association":"MEMBER","body":"cc: @danielcweeks, @rdblue  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1436923998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437249484","html_url":"https://github.com/apache/iceberg/issues/6868#issuecomment-1437249484","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6868","id":1437249484,"node_id":"IC_kwDOCW7NX85Vqq_M","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T16:07:01Z","updated_at":"2023-02-20T16:07:01Z","author_association":"CONTRIBUTOR","body":"@zombee0 Currently manifests are decoded in parallel, but a single manifest isn't decoded by multiple threads. I'm not aware of any plans to make this possible. If you're interested in working on this, you're more than welcome.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437249484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437509528","html_url":"https://github.com/apache/iceberg/pull/6779#issuecomment-1437509528","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6779","id":1437509528,"node_id":"IC_kwDOCW7NX85VrqeY","user":{"login":"abmo-x","id":69539469,"node_id":"MDQ6VXNlcjY5NTM5NDY5","avatar_url":"https://avatars.githubusercontent.com/u/69539469?v=4","gravatar_id":"","url":"https://api.github.com/users/abmo-x","html_url":"https://github.com/abmo-x","followers_url":"https://api.github.com/users/abmo-x/followers","following_url":"https://api.github.com/users/abmo-x/following{/other_user}","gists_url":"https://api.github.com/users/abmo-x/gists{/gist_id}","starred_url":"https://api.github.com/users/abmo-x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abmo-x/subscriptions","organizations_url":"https://api.github.com/users/abmo-x/orgs","repos_url":"https://api.github.com/users/abmo-x/repos","events_url":"https://api.github.com/users/abmo-x/events{/privacy}","received_events_url":"https://api.github.com/users/abmo-x/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T20:19:20Z","updated_at":"2023-02-20T20:19:20Z","author_association":"CONTRIBUTOR","body":"Thanks @szehon-ho ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437509528/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437608244","html_url":"https://github.com/apache/iceberg/pull/6849#issuecomment-1437608244","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6849","id":1437608244,"node_id":"IC_kwDOCW7NX85VsCk0","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-20T22:15:09Z","updated_at":"2023-02-20T22:15:09Z","author_association":"CONTRIBUTOR","body":"I updated per szehon feedback, also use intellij to reformat all tables in markdown syntax to read a little better. appreciate another look @szehon-ho and @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437608244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437689999","html_url":"https://github.com/apache/iceberg/issues/5614#issuecomment-1437689999","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5614","id":1437689999,"node_id":"IC_kwDOCW7NX85VsWiP","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T00:12:57Z","updated_at":"2023-02-21T00:12:57Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437689999/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437690025","html_url":"https://github.com/apache/iceberg/issues/5605#issuecomment-1437690025","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5605","id":1437690025,"node_id":"IC_kwDOCW7NX85VsWip","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T00:12:59Z","updated_at":"2023-02-21T00:12:59Z","author_association":"NONE","body":"This issue has been automatically marked as stale because it has been open for 180 days with no activity. It will be closed in next 14 days if no further activity occurs. To permanently prevent this issue from being considered stale, add the label 'not-stale', but commenting on the issue is preferred when possible.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437690025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437743359","html_url":"https://github.com/apache/iceberg/pull/6779#issuecomment-1437743359","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6779","id":1437743359,"node_id":"IC_kwDOCW7NX85Vsjj_","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T01:38:02Z","updated_at":"2023-02-21T01:38:02Z","author_association":"COLLABORATOR","body":"Ill wait bit for other comments, if not will commit","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437743359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437779486","html_url":"https://github.com/apache/iceberg/pull/6849#issuecomment-1437779486","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6849","id":1437779486,"node_id":"IC_kwDOCW7NX85VssYe","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T02:37:36Z","updated_at":"2023-02-21T02:37:36Z","author_association":"COLLABORATOR","body":"HI @dramaticlly , sorry about this, while intellij format looks cool, would it be possible to do it in a separate pr?  So we have more fine-grained commits and ease of seeing exact changes.  Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437779486/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437904012","html_url":"https://github.com/apache/iceberg/issues/6865#issuecomment-1437904012","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6865","id":1437904012,"node_id":"IC_kwDOCW7NX85VtKyM","user":{"login":"0xffmeta","id":98149057,"node_id":"U_kgDOBdmiwQ","avatar_url":"https://avatars.githubusercontent.com/u/98149057?v=4","gravatar_id":"","url":"https://api.github.com/users/0xffmeta","html_url":"https://github.com/0xffmeta","followers_url":"https://api.github.com/users/0xffmeta/followers","following_url":"https://api.github.com/users/0xffmeta/following{/other_user}","gists_url":"https://api.github.com/users/0xffmeta/gists{/gist_id}","starred_url":"https://api.github.com/users/0xffmeta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/0xffmeta/subscriptions","organizations_url":"https://api.github.com/users/0xffmeta/orgs","repos_url":"https://api.github.com/users/0xffmeta/repos","events_url":"https://api.github.com/users/0xffmeta/events{/privacy}","received_events_url":"https://api.github.com/users/0xffmeta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T06:02:01Z","updated_at":"2023-02-21T06:02:01Z","author_association":"CONTRIBUTOR","body":"cc @rdblue @aokolnychyi if you have some time, maybe you can take a look and check if this makes sense to you. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1437904012/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438335009","html_url":"https://github.com/apache/iceberg/issues/6890#issuecomment-1438335009","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6890","id":1438335009,"node_id":"IC_kwDOCW7NX85Vu0Ah","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T11:42:04Z","updated_at":"2023-02-21T11:42:04Z","author_association":"CONTRIBUTOR","body":"@coolderli could you please describe your catalog configuration and which operations you are executing? That may help in pinpointing down the issue. Also logs would be helpful in case you have them.\r\n\r\nThis might be a shot in the dark, but could you try with [`cache-enabled = false`](https://iceberg.apache.org/docs/latest/configuration/#catalog-properties) or run `REFRESH`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438335009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438351030","html_url":"https://github.com/apache/iceberg/issues/6890#issuecomment-1438351030","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6890","id":1438351030,"node_id":"IC_kwDOCW7NX85Vu362","user":{"login":"coolderli","id":38486782,"node_id":"MDQ6VXNlcjM4NDg2Nzgy","avatar_url":"https://avatars.githubusercontent.com/u/38486782?v=4","gravatar_id":"","url":"https://api.github.com/users/coolderli","html_url":"https://github.com/coolderli","followers_url":"https://api.github.com/users/coolderli/followers","following_url":"https://api.github.com/users/coolderli/following{/other_user}","gists_url":"https://api.github.com/users/coolderli/gists{/gist_id}","starred_url":"https://api.github.com/users/coolderli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coolderli/subscriptions","organizations_url":"https://api.github.com/users/coolderli/orgs","repos_url":"https://api.github.com/users/coolderli/repos","events_url":"https://api.github.com/users/coolderli/events{/privacy}","received_events_url":"https://api.github.com/users/coolderli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T11:55:45Z","updated_at":"2023-02-21T11:55:45Z","author_association":"CONTRIBUTOR","body":"@nastra Thank you for your attention.\r\nI used the hive catalog. We periodically perform orphan file cleanup for each table.\r\nAs described above, I renamed table_a to table_b and recreated table_a. Then table_a and table_b have the same data directory.\r\nThe table_a's orphan file cleanup program will clean up table_b's normal files, so when we query table_b encountered FileNotFoundException.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438351030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438406781","html_url":"https://github.com/apache/iceberg/pull/6893#issuecomment-1438406781","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6893","id":1438406781,"node_id":"IC_kwDOCW7NX85VvFh9","user":{"login":"zhongyujiang","id":42907416,"node_id":"MDQ6VXNlcjQyOTA3NDE2","avatar_url":"https://avatars.githubusercontent.com/u/42907416?v=4","gravatar_id":"","url":"https://api.github.com/users/zhongyujiang","html_url":"https://github.com/zhongyujiang","followers_url":"https://api.github.com/users/zhongyujiang/followers","following_url":"https://api.github.com/users/zhongyujiang/following{/other_user}","gists_url":"https://api.github.com/users/zhongyujiang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhongyujiang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhongyujiang/subscriptions","organizations_url":"https://api.github.com/users/zhongyujiang/orgs","repos_url":"https://api.github.com/users/zhongyujiang/repos","events_url":"https://api.github.com/users/zhongyujiang/events{/privacy}","received_events_url":"https://api.github.com/users/zhongyujiang/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T12:34:51Z","updated_at":"2023-02-21T12:34:51Z","author_association":"CONTRIBUTOR","body":"@rdblue Could you help review this? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438406781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438420603","html_url":"https://github.com/apache/iceberg/issues/6890#issuecomment-1438420603","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6890","id":1438420603,"node_id":"IC_kwDOCW7NX85VvI57","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T12:45:22Z","updated_at":"2023-02-21T12:47:08Z","author_association":"MEMBER","body":"True. As both the tables share the same path, running remove orphan files on one table can clean up the live files of another table. \r\n\r\nI don't think we have a fix for this based on the current remove orphan files design.   \r\n\r\nFor Nessie Catalog, I am using UUID for the table path during \"create table\" to avoid this problem. Maybe we need to enforce this to all the catalogs (I can work on this once people agree to this change)\r\n\r\nAs a workaround, when you create a new table (you can specify the new table location in the create table statement or table properties)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438420603/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438462253","html_url":"https://github.com/apache/iceberg/pull/6760#issuecomment-1438462253","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6760","id":1438462253,"node_id":"IC_kwDOCW7NX85VvTEt","user":{"login":"ludlows","id":6441333,"node_id":"MDQ6VXNlcjY0NDEzMzM=","avatar_url":"https://avatars.githubusercontent.com/u/6441333?v=4","gravatar_id":"","url":"https://api.github.com/users/ludlows","html_url":"https://github.com/ludlows","followers_url":"https://api.github.com/users/ludlows/followers","following_url":"https://api.github.com/users/ludlows/following{/other_user}","gists_url":"https://api.github.com/users/ludlows/gists{/gist_id}","starred_url":"https://api.github.com/users/ludlows/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ludlows/subscriptions","organizations_url":"https://api.github.com/users/ludlows/orgs","repos_url":"https://api.github.com/users/ludlows/repos","events_url":"https://api.github.com/users/ludlows/events{/privacy}","received_events_url":"https://api.github.com/users/ludlows/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T13:09:53Z","updated_at":"2023-02-21T13:09:53Z","author_association":"CONTRIBUTOR","body":"Hi @szehon-ho , thanks for your suggestions.\r\nyep, it is also possible to return an empty Option. but it seems that we need to modify more parts if so.\r\n\r\nAnd hi @aokolnychyi , @rdblue , do you have any suggestions about the new feature of `rewrite_data_files` ?\r\nthanks.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438462253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438585925","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1438585925","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1438585925,"node_id":"IC_kwDOCW7NX85VvxRF","user":{"login":"dimas-b","id":40603221,"node_id":"MDQ6VXNlcjQwNjAzMjIx","avatar_url":"https://avatars.githubusercontent.com/u/40603221?v=4","gravatar_id":"","url":"https://api.github.com/users/dimas-b","html_url":"https://github.com/dimas-b","followers_url":"https://api.github.com/users/dimas-b/followers","following_url":"https://api.github.com/users/dimas-b/following{/other_user}","gists_url":"https://api.github.com/users/dimas-b/gists{/gist_id}","starred_url":"https://api.github.com/users/dimas-b/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimas-b/subscriptions","organizations_url":"https://api.github.com/users/dimas-b/orgs","repos_url":"https://api.github.com/users/dimas-b/repos","events_url":"https://api.github.com/users/dimas-b/events{/privacy}","received_events_url":"https://api.github.com/users/dimas-b/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T14:28:19Z","updated_at":"2023-02-21T14:28:19Z","author_association":"CONTRIBUTOR","body":"+1 to fixing how Nessie Catalog (and related classes) track expected hash and refresh references.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438585925/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438592791","html_url":"https://github.com/apache/iceberg/pull/6789#issuecomment-1438592791","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6789","id":1438592791,"node_id":"IC_kwDOCW7NX85Vvy8X","user":{"login":"dimas-b","id":40603221,"node_id":"MDQ6VXNlcjQwNjAzMjIx","avatar_url":"https://avatars.githubusercontent.com/u/40603221?v=4","gravatar_id":"","url":"https://api.github.com/users/dimas-b","html_url":"https://github.com/dimas-b","followers_url":"https://api.github.com/users/dimas-b/followers","following_url":"https://api.github.com/users/dimas-b/following{/other_user}","gists_url":"https://api.github.com/users/dimas-b/gists{/gist_id}","starred_url":"https://api.github.com/users/dimas-b/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimas-b/subscriptions","organizations_url":"https://api.github.com/users/dimas-b/orgs","repos_url":"https://api.github.com/users/dimas-b/repos","events_url":"https://api.github.com/users/dimas-b/events{/privacy}","received_events_url":"https://api.github.com/users/dimas-b/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T14:33:01Z","updated_at":"2023-02-21T14:33:01Z","author_association":"CONTRIBUTOR","body":"> [...]  In that case, txn can only commit one successful commit?\r\n\r\nThe Nessie server is able to resolve non-conflicting changes to the catalog, even when the expected hash is behind the current branch HEAD.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438592791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438704495","html_url":"https://github.com/apache/iceberg/issues/6853#issuecomment-1438704495","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6853","id":1438704495,"node_id":"IC_kwDOCW7NX85VwONv","user":{"login":"Saranviveka","id":15131550,"node_id":"MDQ6VXNlcjE1MTMxNTUw","avatar_url":"https://avatars.githubusercontent.com/u/15131550?v=4","gravatar_id":"","url":"https://api.github.com/users/Saranviveka","html_url":"https://github.com/Saranviveka","followers_url":"https://api.github.com/users/Saranviveka/followers","following_url":"https://api.github.com/users/Saranviveka/following{/other_user}","gists_url":"https://api.github.com/users/Saranviveka/gists{/gist_id}","starred_url":"https://api.github.com/users/Saranviveka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Saranviveka/subscriptions","organizations_url":"https://api.github.com/users/Saranviveka/orgs","repos_url":"https://api.github.com/users/Saranviveka/repos","events_url":"https://api.github.com/users/Saranviveka/events{/privacy}","received_events_url":"https://api.github.com/users/Saranviveka/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T15:46:02Z","updated_at":"2023-02-21T15:46:02Z","author_association":"NONE","body":"Team, Would like to know whether equality check would be considered for date partition created on timestamp field ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438704495/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438715035","html_url":"https://github.com/apache/iceberg/pull/6875#issuecomment-1438715035","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6875","id":1438715035,"node_id":"IC_kwDOCW7NX85VwQyb","user":{"login":"dimas-b","id":40603221,"node_id":"MDQ6VXNlcjQwNjAzMjIx","avatar_url":"https://avatars.githubusercontent.com/u/40603221?v=4","gravatar_id":"","url":"https://api.github.com/users/dimas-b","html_url":"https://github.com/dimas-b","followers_url":"https://api.github.com/users/dimas-b/followers","following_url":"https://api.github.com/users/dimas-b/following{/other_user}","gists_url":"https://api.github.com/users/dimas-b/gists{/gist_id}","starred_url":"https://api.github.com/users/dimas-b/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimas-b/subscriptions","organizations_url":"https://api.github.com/users/dimas-b/orgs","repos_url":"https://api.github.com/users/dimas-b/repos","events_url":"https://api.github.com/users/dimas-b/events{/privacy}","received_events_url":"https://api.github.com/users/dimas-b/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T15:52:55Z","updated_at":"2023-02-21T15:52:55Z","author_association":"CONTRIBUTOR","body":"CI is broken because of https://github.com/projectnessie/nessie/issues/6156","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438715035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438813798","html_url":"https://github.com/apache/iceberg/issues/6824#issuecomment-1438813798","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6824","id":1438813798,"node_id":"IC_kwDOCW7NX85Vwo5m","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T17:00:51Z","updated_at":"2023-02-21T17:00:51Z","author_association":"CONTRIBUTOR","body":"#6451 Try to helps in most of the case\r\n#6570 might be interesting for you as well","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438813798/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438877037","html_url":"https://github.com/apache/iceberg/pull/6869#issuecomment-1438877037","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6869","id":1438877037,"node_id":"IC_kwDOCW7NX85Vw4Vt","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T17:48:19Z","updated_at":"2023-02-21T17:48:19Z","author_association":"CONTRIBUTOR","body":"@amogh-jahagirdar are we planning to create actual instances of `ViewRepresentation`? If not, then I think it should be safe to remove the annotation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438877037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438893112","html_url":"https://github.com/apache/iceberg/issues/6890#issuecomment-1438893112","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6890","id":1438893112,"node_id":"IC_kwDOCW7NX85Vw8Q4","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T18:01:41Z","updated_at":"2023-02-21T18:01:41Z","author_association":"COLLABORATOR","body":"Yea this is a tough problem Ive thought about before as well, the only fix is to create table with new location as Ajantha mentioned.  I feel the only fix would have to maintain your own index of table to location, and then check if a location is taken before allowing to create the table at that location.  I'm not sure if that's a feature we can have catalog support at some point.  (Though it wont help cross-catalog cases).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438893112/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438905193","html_url":"https://github.com/apache/iceberg/issues/6890#issuecomment-1438905193","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6890","id":1438905193,"node_id":"IC_kwDOCW7NX85Vw_Np","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T18:11:57Z","updated_at":"2023-02-21T18:11:57Z","author_association":"COLLABORATOR","body":"I remember there's some related thoughts on the matter:  https://github.com/apache/iceberg/issues/4159","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1438905193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439085830","html_url":"https://github.com/apache/iceberg/pull/6499#issuecomment-1439085830","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6499","id":1439085830,"node_id":"IC_kwDOCW7NX85VxrUG","user":{"login":"krvikash","id":11939923,"node_id":"MDQ6VXNlcjExOTM5OTIz","avatar_url":"https://avatars.githubusercontent.com/u/11939923?v=4","gravatar_id":"","url":"https://api.github.com/users/krvikash","html_url":"https://github.com/krvikash","followers_url":"https://api.github.com/users/krvikash/followers","following_url":"https://api.github.com/users/krvikash/following{/other_user}","gists_url":"https://api.github.com/users/krvikash/gists{/gist_id}","starred_url":"https://api.github.com/users/krvikash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krvikash/subscriptions","organizations_url":"https://api.github.com/users/krvikash/orgs","repos_url":"https://api.github.com/users/krvikash/repos","events_url":"https://api.github.com/users/krvikash/events{/privacy}","received_events_url":"https://api.github.com/users/krvikash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T20:59:57Z","updated_at":"2023-02-21T20:59:57Z","author_association":"CONTRIBUTOR","body":"Hi @pvary | @nastra, When you get time could you please review it?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439085830/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439094408","html_url":"https://github.com/apache/iceberg/pull/6512#issuecomment-1439094408","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6512","id":1439094408,"node_id":"IC_kwDOCW7NX85VxtaI","user":{"login":"krvikash","id":11939923,"node_id":"MDQ6VXNlcjExOTM5OTIz","avatar_url":"https://avatars.githubusercontent.com/u/11939923?v=4","gravatar_id":"","url":"https://api.github.com/users/krvikash","html_url":"https://github.com/krvikash","followers_url":"https://api.github.com/users/krvikash/followers","following_url":"https://api.github.com/users/krvikash/following{/other_user}","gists_url":"https://api.github.com/users/krvikash/gists{/gist_id}","starred_url":"https://api.github.com/users/krvikash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krvikash/subscriptions","organizations_url":"https://api.github.com/users/krvikash/orgs","repos_url":"https://api.github.com/users/krvikash/repos","events_url":"https://api.github.com/users/krvikash/events{/privacy}","received_events_url":"https://api.github.com/users/krvikash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T21:07:05Z","updated_at":"2023-02-21T21:07:05Z","author_association":"CONTRIBUTOR","body":"Rebased with master and resolved conflicts.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439094408/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439095868","html_url":"https://github.com/apache/iceberg/pull/6512#issuecomment-1439095868","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6512","id":1439095868,"node_id":"IC_kwDOCW7NX85Vxtw8","user":{"login":"krvikash","id":11939923,"node_id":"MDQ6VXNlcjExOTM5OTIz","avatar_url":"https://avatars.githubusercontent.com/u/11939923?v=4","gravatar_id":"","url":"https://api.github.com/users/krvikash","html_url":"https://github.com/krvikash","followers_url":"https://api.github.com/users/krvikash/followers","following_url":"https://api.github.com/users/krvikash/following{/other_user}","gists_url":"https://api.github.com/users/krvikash/gists{/gist_id}","starred_url":"https://api.github.com/users/krvikash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krvikash/subscriptions","organizations_url":"https://api.github.com/users/krvikash/orgs","repos_url":"https://api.github.com/users/krvikash/repos","events_url":"https://api.github.com/users/krvikash/events{/privacy}","received_events_url":"https://api.github.com/users/krvikash/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T21:08:12Z","updated_at":"2023-02-21T21:08:12Z","author_association":"CONTRIBUTOR","body":"Hi @ajantha-bhat | @nastra | @rdblue, when you get time, could you please review it again? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439095868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439134204","html_url":"https://github.com/apache/iceberg/pull/6344#issuecomment-1439134204","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6344","id":1439134204,"node_id":"IC_kwDOCW7NX85Vx3H8","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T21:48:05Z","updated_at":"2023-02-21T21:48:05Z","author_association":"CONTRIBUTOR","body":"Thanks a lot for the review @aokolnychyi. Filed https://github.com/apache/iceberg/pull/6898 for your comments.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439134204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439164338","html_url":"https://github.com/apache/iceberg/pull/6876#issuecomment-1439164338","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6876","id":1439164338,"node_id":"IC_kwDOCW7NX85Vx-ey","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T22:19:28Z","updated_at":"2023-02-21T22:19:28Z","author_association":"CONTRIBUTOR","body":"@szehon-ho @amogh-jahagirdar @singhpk234, could you take another look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439164338/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439167871","html_url":"https://github.com/apache/iceberg/pull/6877#issuecomment-1439167871","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6877","id":1439167871,"node_id":"IC_kwDOCW7NX85Vx_V_","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T22:23:08Z","updated_at":"2023-02-21T22:23:08Z","author_association":"CONTRIBUTOR","body":"Thanks, @dramaticlly @jackye1995 @nastra @singhpk234!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439167871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439168611","html_url":"https://github.com/apache/iceberg/pull/6878#issuecomment-1439168611","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6878","id":1439168611,"node_id":"IC_kwDOCW7NX85Vx_hj","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T22:23:55Z","updated_at":"2023-02-21T22:23:55Z","author_association":"CONTRIBUTOR","body":"@dramaticlly, I merged #6877. Could you rebase this one?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439168611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439173789","html_url":"https://github.com/apache/iceberg/pull/6878#issuecomment-1439173789","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6878","id":1439173789,"node_id":"IC_kwDOCW7NX85VyAyd","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T22:28:56Z","updated_at":"2023-02-21T22:29:19Z","author_association":"CONTRIBUTOR","body":"@an\r\n\r\n> @dramaticlly, I merged #6877. Could you rebase this one?\r\n\r\nThank you @aokolnychyi , rebased latest upstream and I see the parent commit is what you just merged. I guess we cam wait until all check to pass","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439173789/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439176764","html_url":"https://github.com/apache/iceberg/pull/6889#issuecomment-1439176764","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6889","id":1439176764,"node_id":"IC_kwDOCW7NX85VyBg8","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T22:32:08Z","updated_at":"2023-02-21T22:32:08Z","author_association":"CONTRIBUTOR","body":"seeing some random test failure on `:iceberg-spark:iceberg-spark-3.1_2.12:test`\r\n```\r\n        java.lang.RuntimeException: The root scratch dir: /tmp/hive on HDFS should be writable. Current permissions are: rwxr-xr-x\r\n```\r\n\r\nseems irrelevant to my change, let me close and reopen to trigger another run","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439176764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439226758","html_url":"https://github.com/apache/iceberg/pull/6849#issuecomment-1439226758","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6849","id":1439226758,"node_id":"IC_kwDOCW7NX85VyNuG","user":{"login":"dramaticlly","id":5961173,"node_id":"MDQ6VXNlcjU5NjExNzM=","avatar_url":"https://avatars.githubusercontent.com/u/5961173?v=4","gravatar_id":"","url":"https://api.github.com/users/dramaticlly","html_url":"https://github.com/dramaticlly","followers_url":"https://api.github.com/users/dramaticlly/followers","following_url":"https://api.github.com/users/dramaticlly/following{/other_user}","gists_url":"https://api.github.com/users/dramaticlly/gists{/gist_id}","starred_url":"https://api.github.com/users/dramaticlly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dramaticlly/subscriptions","organizations_url":"https://api.github.com/users/dramaticlly/orgs","repos_url":"https://api.github.com/users/dramaticlly/repos","events_url":"https://api.github.com/users/dramaticlly/events{/privacy}","received_events_url":"https://api.github.com/users/dramaticlly/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-21T23:31:55Z","updated_at":"2023-02-21T23:32:05Z","author_association":"CONTRIBUTOR","body":"> HI @dramaticlly , sorry about this, while intellij format looks cool, would it be possible to do it in a separate pr? So we have more fine-grained commits and ease of seeing exact changes. Thanks\r\n\r\nThank you @szehon-ho . I reverted format lint to limit the scope only for add-files","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439226758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439254712","html_url":"https://github.com/apache/iceberg/issues/5461#issuecomment-1439254712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/5461","id":1439254712,"node_id":"IC_kwDOCW7NX85VyUi4","user":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"created_at":"2023-02-22T00:11:59Z","updated_at":"2023-02-22T00:11:59Z","author_association":"NONE","body":"This issue has been closed because it has not received any activity in the last 14 days since being marked as 'stale'","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439254712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439254959","html_url":"https://github.com/apache/iceberg/pull/6878#issuecomment-1439254959","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6878","id":1439254959,"node_id":"IC_kwDOCW7NX85VyUmv","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-22T00:12:23Z","updated_at":"2023-02-22T00:12:23Z","author_association":"CONTRIBUTOR","body":"Thanks, @dramaticlly! Thanks for reviewing, @jackye1995 @amogh-jahagirdar!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439254959/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439260724","html_url":"https://github.com/apache/iceberg/pull/6899#issuecomment-1439260724","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6899","id":1439260724,"node_id":"IC_kwDOCW7NX85VyWA0","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-22T00:18:57Z","updated_at":"2023-02-22T00:18:57Z","author_association":"CONTRIBUTOR","body":"cc @amogh-jahagirdar @singhpk234 @rdblue @karuppayya @RussellSpitzer @flyrain @szehon-ho ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439260724/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439278223","html_url":"https://github.com/apache/iceberg/pull/6898#issuecomment-1439278223","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6898","id":1439278223,"node_id":"IC_kwDOCW7NX85VyaSP","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-22T00:42:57Z","updated_at":"2023-02-22T00:42:57Z","author_association":"CONTRIBUTOR","body":"Will take a look today.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439278223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439439544","html_url":"https://github.com/apache/iceberg/pull/6826#issuecomment-1439439544","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6826","id":1439439544,"node_id":"IC_kwDOCW7NX85VzBq4","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-22T04:53:55Z","updated_at":"2023-02-22T04:53:55Z","author_association":"MEMBER","body":"@Fokko: Can you please take a look at this?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439439544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439558920","html_url":"https://github.com/apache/iceberg/pull/6382#issuecomment-1439558920","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6382","id":1439558920,"node_id":"IC_kwDOCW7NX85Vze0I","user":{"login":"yegangy0718","id":8229749,"node_id":"MDQ6VXNlcjgyMjk3NDk=","avatar_url":"https://avatars.githubusercontent.com/u/8229749?v=4","gravatar_id":"","url":"https://api.github.com/users/yegangy0718","html_url":"https://github.com/yegangy0718","followers_url":"https://api.github.com/users/yegangy0718/followers","following_url":"https://api.github.com/users/yegangy0718/following{/other_user}","gists_url":"https://api.github.com/users/yegangy0718/gists{/gist_id}","starred_url":"https://api.github.com/users/yegangy0718/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yegangy0718/subscriptions","organizations_url":"https://api.github.com/users/yegangy0718/orgs","repos_url":"https://api.github.com/users/yegangy0718/repos","events_url":"https://api.github.com/users/yegangy0718/events{/privacy}","received_events_url":"https://api.github.com/users/yegangy0718/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-22T07:39:02Z","updated_at":"2023-02-22T07:39:02Z","author_association":"CONTRIBUTOR","body":"Hi @stevenzwu  if we decide to keep shuffling implementation in the Iceberg repo, could you help to take another look at the PR? Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439558920/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439581426","html_url":"https://github.com/apache/iceberg/pull/6450#issuecomment-1439581426","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6450","id":1439581426,"node_id":"IC_kwDOCW7NX85VzkTy","user":{"login":"ggershinsky","id":12033212,"node_id":"MDQ6VXNlcjEyMDMzMjEy","avatar_url":"https://avatars.githubusercontent.com/u/12033212?v=4","gravatar_id":"","url":"https://api.github.com/users/ggershinsky","html_url":"https://github.com/ggershinsky","followers_url":"https://api.github.com/users/ggershinsky/followers","following_url":"https://api.github.com/users/ggershinsky/following{/other_user}","gists_url":"https://api.github.com/users/ggershinsky/gists{/gist_id}","starred_url":"https://api.github.com/users/ggershinsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ggershinsky/subscriptions","organizations_url":"https://api.github.com/users/ggershinsky/orgs","repos_url":"https://api.github.com/users/ggershinsky/repos","events_url":"https://api.github.com/users/ggershinsky/events{/privacy}","received_events_url":"https://api.github.com/users/ggershinsky/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-22T08:03:11Z","updated_at":"2023-02-22T08:03:11Z","author_association":"CONTRIBUTOR","body":"I've leveraged the IcebergDecoder and IcebergEncoder as they are, including the 8-byte header (schema hash) - this enables updating the key metadata schema in the future, while making minimal / no changes in the code. But if it's better to use an explicit 1-2 byte version header, instead of the 8-byte hash (to save 6 bytes? to make versions more formal?) - and to call RawDecoder (plus add RawEncoder), lets discuss.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439581426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439835161","html_url":"https://github.com/apache/iceberg/issues/6902#issuecomment-1439835161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6902","id":1439835161,"node_id":"IC_kwDOCW7NX85V0iQZ","user":{"login":"lexluo09","id":39718951,"node_id":"MDQ6VXNlcjM5NzE4OTUx","avatar_url":"https://avatars.githubusercontent.com/u/39718951?v=4","gravatar_id":"","url":"https://api.github.com/users/lexluo09","html_url":"https://github.com/lexluo09","followers_url":"https://api.github.com/users/lexluo09/followers","following_url":"https://api.github.com/users/lexluo09/following{/other_user}","gists_url":"https://api.github.com/users/lexluo09/gists{/gist_id}","starred_url":"https://api.github.com/users/lexluo09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lexluo09/subscriptions","organizations_url":"https://api.github.com/users/lexluo09/orgs","repos_url":"https://api.github.com/users/lexluo09/repos","events_url":"https://api.github.com/users/lexluo09/events{/privacy}","received_events_url":"https://api.github.com/users/lexluo09/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-22T11:10:21Z","updated_at":"2023-02-22T11:10:21Z","author_association":"NONE","body":"Can someone take a look? Thanks\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439835161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439835577","html_url":"https://github.com/apache/iceberg/issues/6904#issuecomment-1439835577","issue_url":"https://api.github.com/repos/apache/iceberg/issues/6904","id":1439835577,"node_id":"IC_kwDOCW7NX85V0iW5","user":{"login":"lexluo09","id":39718951,"node_id":"MDQ6VXNlcjM5NzE4OTUx","avatar_url":"https://avatars.githubusercontent.com/u/39718951?v=4","gravatar_id":"","url":"https://api.github.com/users/lexluo09","html_url":"https://github.com/lexluo09","followers_url":"https://api.github.com/users/lexluo09/followers","following_url":"https://api.github.com/users/lexluo09/following{/other_user}","gists_url":"https://api.github.com/users/lexluo09/gists{/gist_id}","starred_url":"https://api.github.com/users/lexluo09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lexluo09/subscriptions","organizations_url":"https://api.github.com/users/lexluo09/orgs","repos_url":"https://api.github.com/users/lexluo09/repos","events_url":"https://api.github.com/users/lexluo09/events{/privacy}","received_events_url":"https://api.github.com/users/lexluo09/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-02-22T11:10:42Z","updated_at":"2023-02-22T11:10:42Z","author_association":"NONE","body":"\r\nCan someone take a look? Thanks\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1439835577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]