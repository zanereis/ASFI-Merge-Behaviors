[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781937809","html_url":"https://github.com/apache/iceberg/pull/2252#issuecomment-781937809","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2252","id":781937809,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MTkzNzgwOQ==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T09:04:09Z","updated_at":"2021-02-19T09:04:09Z","author_association":"COLLABORATOR","body":"Thanks for the review @aokolnychyi , @pvary !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/781937809/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782128283","html_url":"https://github.com/apache/iceberg/issues/2090#issuecomment-782128283","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2090","id":782128283,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjEyODI4Mw==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T15:00:11Z","updated_at":"2021-02-19T15:00:11Z","author_association":"CONTRIBUTOR","body":"The relevant change on the nessie side is done here: https://github.com/projectnessie/nessie/pull/835 so this can be addressed after the next Nessie release.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782128283/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782132895","html_url":"https://github.com/apache/iceberg/pull/2217#issuecomment-782132895","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2217","id":782132895,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjEzMjg5NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T15:07:37Z","updated_at":"2021-02-19T15:07:37Z","author_association":"MEMBER","body":"Really exciting to see more functionality being added here!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782132895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782246914","html_url":"https://github.com/apache/iceberg/pull/2254#issuecomment-782246914","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2254","id":782246914,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjI0NjkxNA==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T18:12:33Z","updated_at":"2021-02-19T18:12:33Z","author_association":"CONTRIBUTOR","body":"The manifest and residual evaluator expect the following java types for each data type https://github.com/apache/iceberg/blob/efc461862fc93637fe4c0127d69bfb777c87766e/api/src/main/java/org/apache/iceberg/types/Type.java#L29\r\n\r\nI think we will need to do something very similar to wrapping the record into an `InternalRecordWrapper` like here https://github.com/apache/iceberg/blob/efc461862fc93637fe4c0127d69bfb777c87766e/data/src/main/java/org/apache/iceberg/data/GenericReader.java#L86\r\nThat should handle conversion between types used by `iceberg-data` v/s the ones used by the evaluators.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782246914/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782249850","html_url":"https://github.com/apache/iceberg/pull/2242#issuecomment-782249850","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2242","id":782249850,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjI0OTg1MA==","user":{"login":"dilipbiswal","id":14225158,"node_id":"MDQ6VXNlcjE0MjI1MTU4","avatar_url":"https://avatars.githubusercontent.com/u/14225158?v=4","gravatar_id":"","url":"https://api.github.com/users/dilipbiswal","html_url":"https://github.com/dilipbiswal","followers_url":"https://api.github.com/users/dilipbiswal/followers","following_url":"https://api.github.com/users/dilipbiswal/following{/other_user}","gists_url":"https://api.github.com/users/dilipbiswal/gists{/gist_id}","starred_url":"https://api.github.com/users/dilipbiswal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dilipbiswal/subscriptions","organizations_url":"https://api.github.com/users/dilipbiswal/orgs","repos_url":"https://api.github.com/users/dilipbiswal/repos","events_url":"https://api.github.com/users/dilipbiswal/events{/privacy}","received_events_url":"https://api.github.com/users/dilipbiswal/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T18:17:25Z","updated_at":"2021-02-19T18:17:25Z","author_association":"CONTRIBUTOR","body":"LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782249850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782256886","html_url":"https://github.com/apache/iceberg/pull/2214#issuecomment-782256886","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2214","id":782256886,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjI1Njg4Ng==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T18:28:21Z","updated_at":"2021-02-19T18:28:21Z","author_association":"CONTRIBUTOR","body":">  If you were actually referring to newAppender, since the creation of ContentFile that stores sort order information is outside the responsibility of FileAppender, the caller of it that creates data/delete file is responsible for passing the sort order around. I think it's the same reason as why we created DataWriter.\r\n\r\nYes I was referring to the appender. Thanks for the clarification.\r\n\r\n>  I think the row level delete support is also in this style - SparkAppenderFactory constructor could take in row level delete related arguments, but SparkWrite and other spark code are not using such constructor yet.\r\n\r\nOkay I see, in that case this should be fine.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782256886/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782289335","html_url":"https://github.com/apache/iceberg/pull/2254#issuecomment-782289335","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2254","id":782289335,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjI4OTMzNQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T19:23:29Z","updated_at":"2021-02-19T19:23:29Z","author_association":"CONTRIBUTOR","body":"> I think we will need to do something very similar to wrapping the record into an `InternalRecordWrapper` like here\r\n> https://github.com/apache/iceberg/blob/efc461862fc93637fe4c0127d69bfb777c87766e/data/src/main/java/org/apache/iceberg/data/GenericReader.java#L86\r\n\r\nThat works! Thanks for the pointer. Updated the PR","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782289335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782338616","html_url":"https://github.com/apache/iceberg/issues/2019#issuecomment-782338616","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2019","id":782338616,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjMzODYxNg==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T20:49:21Z","updated_at":"2021-02-19T20:49:21Z","author_association":"CONTRIBUTOR","body":"If somebody else wants to take over this, I'm still waiting on my NOT_STARTS_WITH pr to be finished getting reviewed. It's possible I'll have time for this soon, but putting that out there in case this is blocking anybody somehow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782338616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782356066","html_url":"https://github.com/apache/iceberg/pull/2242#issuecomment-782356066","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2242","id":782356066,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjM1NjA2Ng==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T21:14:34Z","updated_at":"2021-02-19T21:14:34Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi Can you add some context as to why we are doing this? PS: I am not too familiar so it might be an obvious answer.\r\n\r\nI see this in the Javadoc of `resolveOperator`\r\n> This function is similar to transform, but skips sub-trees that have already been marked as analyzed\r\n\r\nDoes this cause issues for us?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782356066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782359658","html_url":"https://github.com/apache/iceberg/pull/2243#issuecomment-782359658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2243","id":782359658,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjM1OTY1OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T21:20:38Z","updated_at":"2021-02-19T21:20:38Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @RussellSpitzer @dilipbiswal @shardulm94! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782359658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782360970","html_url":"https://github.com/apache/iceberg/pull/2238#issuecomment-782360970","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2238","id":782360970,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjM2MDk3MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T21:21:33Z","updated_at":"2021-02-19T21:21:33Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @viirya @RussellSpitzer @dilipbiswal! ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782360970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782361915","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-782361915","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":782361915,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjM2MTkxNQ==","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T21:22:04Z","updated_at":"2021-02-19T21:38:15Z","author_association":"CONTRIBUTOR","body":"Looking into what's been done since I opened this, Flink now has filter pushdown. So we likely need to update `org.apache.iceberg.flink.FlinkFilters` to account for NOT_STARTS_WITH. Or at the least we might consider adding some tests in Flink that use `NOT LIKE` to ensure those queries will work correctly.\r\n\r\nI will look into that asap.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782361915/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782362720","html_url":"https://github.com/apache/iceberg/pull/2242#issuecomment-782362720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2242","id":782362720,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjM2MjcyMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T21:23:09Z","updated_at":"2021-02-19T21:23:09Z","author_association":"CONTRIBUTOR","body":"@shardulm94, I think we are fine but `resolveOperator` isn't used in optimizer rules. We plugin our rewrite rules in the optimizer so it seems cleaner not to use this method.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782362720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782385240","html_url":"https://github.com/apache/iceberg/pull/2255#issuecomment-782385240","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2255","id":782385240,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjM4NTI0MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T21:50:34Z","updated_at":"2021-02-19T21:53:10Z","author_association":"CONTRIBUTOR","body":"It would be great to get as many eyes as possible on this one. Especially, from folks working on query engines other than Spark.\r\n\r\ncc @rdblue @RussellSpitzer @pvary @openinx @holdenk @shardulm94 @danielcweeks @rdsr @jackye1995 @rymurr @karuppayya @JingsongLi","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782385240/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782396170","html_url":"https://github.com/apache/iceberg/pull/2242#issuecomment-782396170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2242","id":782396170,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjM5NjE3MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T22:08:29Z","updated_at":"2021-02-19T22:08:29Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @shardulm94 @dilipbiswal!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782396170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782425002","html_url":"https://github.com/apache/iceberg/pull/2062#issuecomment-782425002","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2062","id":782425002,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjQyNTAwMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T22:43:15Z","updated_at":"2021-02-19T22:43:15Z","author_association":"CONTRIBUTOR","body":"> I will look into that asap.\r\n\r\nLet's do it in a follow-up, this PR is already very large.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782425002/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782429034","html_url":"https://github.com/apache/iceberg/pull/2256#issuecomment-782429034","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2256","id":782429034,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjQyOTAzNA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-19T22:51:31Z","updated_at":"2021-02-19T22:51:31Z","author_association":"CONTRIBUTOR","body":"This one actually depends on #2255. I'll reopen later.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782429034/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782579099","html_url":"https://github.com/apache/iceberg/issues/2219#issuecomment-782579099","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2219","id":782579099,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MjU3OTA5OQ==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-20T07:32:36Z","updated_at":"2021-02-20T07:32:36Z","author_association":"CONTRIBUTOR","body":"I submit a PR (#2258 ) to fix this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782579099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782951127","html_url":"https://github.com/apache/iceberg/pull/2092#issuecomment-782951127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2092","id":782951127,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mjk1MTEyNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-21T23:36:26Z","updated_at":"2021-02-21T23:36:26Z","author_association":"CONTRIBUTOR","body":"Looks good now. I'll merge this. Thanks @XuQianJin-Stars!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782951127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782953035","html_url":"https://github.com/apache/iceberg/pull/1648#issuecomment-782953035","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1648","id":782953035,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mjk1MzAzNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-21T23:48:13Z","updated_at":"2021-02-21T23:48:13Z","author_association":"CONTRIBUTOR","body":"@Fokko, looks correct overall, although there is one error in a test case. I'd also like to fix the allocation problem the the fixed converter.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/782953035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783534771","html_url":"https://github.com/apache/iceberg/pull/2254#issuecomment-783534771","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2254","id":783534771,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzUzNDc3MQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T17:21:24Z","updated_at":"2021-02-22T17:21:24Z","author_association":"CONTRIBUTOR","body":"@shardulm94: Could you please review as a committer, so I can merge?\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783534771/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783538655","html_url":"https://github.com/apache/iceberg/issues/1808#issuecomment-783538655","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1808","id":783538655,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzUzODY1NQ==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T17:27:27Z","updated_at":"2021-02-22T17:27:27Z","author_association":"CONTRIBUTOR","body":"@rdblue any preference for where this component would live?I have an initial impl done for create tag/branch in with the rest of the sql extensions currently but not sure if its best there. I can create a nessie extensions module if you prefer but there will be some duplication w/ the existing extensions module.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783538655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783555066","html_url":"https://github.com/apache/iceberg/issues/2260#issuecomment-783555066","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2260","id":783555066,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzU1NTA2Ng==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T17:53:01Z","updated_at":"2021-02-22T17:53:01Z","author_association":"CONTRIBUTOR","body":"@rlcyf: Could you try out this with SparkCatalog instead of SparkSessionCatalog?\r\nI have seen some problems with the SparkSessionCatalog implementation using internal Hive Catalog instead of the provided Iceberg one. The consensus was that Spark should and will fix this in their catalog implementation.\r\n\r\nThe tests were running correctly with this config:\r\n```\r\n        new Object[] { \"testhive\", SparkCatalog.class.getName(), ImmutableMap.of(\r\n            \"type\", \"hive\",\r\n            \"default-namespace\", \"default\"\r\n        )},\r\n```\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783555066/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783605257","html_url":"https://github.com/apache/iceberg/pull/2248#issuecomment-783605257","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2248","id":783605257,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzYwNTI1Nw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T19:10:24Z","updated_at":"2021-02-22T19:10:24Z","author_association":"CONTRIBUTOR","body":"@shardulm94, could you do one more pass? I removed the property from this PR as it is pretty large, I don't want to modify the core module here. I'll submit a follow-up PR. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783605257/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783605573","html_url":"https://github.com/apache/iceberg/pull/2248#issuecomment-783605573","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2248","id":783605573,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzYwNTU3Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-22T19:10:57Z","updated_at":"2021-02-22T19:10:57Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer @rdblue, let me know if you have any thoughts too.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783605573/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783773073","html_url":"https://github.com/apache/iceberg/pull/2096#issuecomment-783773073","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2096","id":783773073,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mzc3MzA3Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T00:16:33Z","updated_at":"2021-02-23T00:16:33Z","author_association":"CONTRIBUTOR","body":"Looks great, thanks for updating this, @yyanyy!\r\n\r\nThere were a few minor comments in tests, but we can pick up those fixes later. I think overall this looks great!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783773073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783787014","html_url":"https://github.com/apache/iceberg/pull/2259#issuecomment-783787014","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2259","id":783787014,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mzc4NzAxNA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T00:51:13Z","updated_at":"2021-02-23T00:51:13Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01, is it possible to expose a method on the table loaded by the catalog to access the Iceberg table instead? That's what we do in Spark. `SparkTable` has a `table` method to access the underlying Iceberg table. It isn't very exposed because you have to cast the Spark `Table` interface to Iceberg's `SparkTable` to use it. I'd prefer a solution like that to adding a new public method to a public API.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783787014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783804212","html_url":"https://github.com/apache/iceberg/pull/2259#issuecomment-783804212","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2259","id":783804212,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzgwNDIxMg==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T01:43:30Z","updated_at":"2021-02-23T01:43:30Z","author_association":"CONTRIBUTOR","body":"> @zhangjun0x01, is it possible to expose a method on the table loaded by the catalog to access the Iceberg table instead? That's what we do in Spark. `SparkTable` has a `table` method to access the underlying Iceberg table. It isn't very exposed because you have to cast the Spark `Table` interface to Iceberg's `SparkTable` to use it. I'd prefer a solution like that to adding a new public method to a public API.\r\n\r\n@rdblue Thanks for your suggestion, I will think about how to implement it","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783804212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783842081","html_url":"https://github.com/apache/iceberg/issues/2260#issuecomment-783842081","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2260","id":783842081,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mzg0MjA4MQ==","user":{"login":"yfcck","id":43957,"node_id":"MDQ6VXNlcjQzOTU3","avatar_url":"https://avatars.githubusercontent.com/u/43957?v=4","gravatar_id":"","url":"https://api.github.com/users/yfcck","html_url":"https://github.com/yfcck","followers_url":"https://api.github.com/users/yfcck/followers","following_url":"https://api.github.com/users/yfcck/following{/other_user}","gists_url":"https://api.github.com/users/yfcck/gists{/gist_id}","starred_url":"https://api.github.com/users/yfcck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yfcck/subscriptions","organizations_url":"https://api.github.com/users/yfcck/orgs","repos_url":"https://api.github.com/users/yfcck/repos","events_url":"https://api.github.com/users/yfcck/events{/privacy}","received_events_url":"https://api.github.com/users/yfcck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T02:58:21Z","updated_at":"2021-02-23T02:58:21Z","author_association":"NONE","body":"> @rlcyf: Could you try out this with SparkCatalog instead of SparkSessionCatalog?\r\n> I have seen some problems with the SparkSessionCatalog implementation using internal Hive Catalog instead of the provided Iceberg one. The consensus was that Spark should and will fix this in their catalog implementation.\r\n> \r\n> The tests were running correctly with this config:\r\n> \r\n> ```\r\n>         new Object[] { \"testhive\", SparkCatalog.class.getName(), ImmutableMap.of(\r\n>             \"type\", \"hive\",\r\n>             \"default-namespace\", \"default\"\r\n>         )},\r\n> ```\r\n> \r\n> Thanks,\r\n> Peter\r\n\r\nI have tested both SparkCatalog and SparkSessionCatalog,still can not!\r\nuse java api work fine!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783842081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783842437","html_url":"https://github.com/apache/iceberg/issues/2260#issuecomment-783842437","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2260","id":783842437,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Mzg0MjQzNw==","user":{"login":"yfcck","id":43957,"node_id":"MDQ6VXNlcjQzOTU3","avatar_url":"https://avatars.githubusercontent.com/u/43957?v=4","gravatar_id":"","url":"https://api.github.com/users/yfcck","html_url":"https://github.com/yfcck","followers_url":"https://api.github.com/users/yfcck/followers","following_url":"https://api.github.com/users/yfcck/following{/other_user}","gists_url":"https://api.github.com/users/yfcck/gists{/gist_id}","starred_url":"https://api.github.com/users/yfcck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yfcck/subscriptions","organizations_url":"https://api.github.com/users/yfcck/orgs","repos_url":"https://api.github.com/users/yfcck/repos","events_url":"https://api.github.com/users/yfcck/events{/privacy}","received_events_url":"https://api.github.com/users/yfcck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T02:59:51Z","updated_at":"2021-02-23T02:59:51Z","author_association":"NONE","body":">  new Object[] { \"testhive\", SparkCatalog.class.getName(), ImmutableMap.of(\r\n>             \"type\", \"hive\",\r\n>             \"default-namespace\", \"default\"\r\n>         )},\r\n\r\nhow to use this config! can u give a full example?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783842437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783912599","html_url":"https://github.com/apache/iceberg/pull/2263#issuecomment-783912599","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2263","id":783912599,"node_id":"MDEyOklzc3VlQ29tbWVudDc4MzkxMjU5OQ==","user":{"login":"scutzou","id":17271682,"node_id":"MDQ6VXNlcjE3MjcxNjgy","avatar_url":"https://avatars.githubusercontent.com/u/17271682?v=4","gravatar_id":"","url":"https://api.github.com/users/scutzou","html_url":"https://github.com/scutzou","followers_url":"https://api.github.com/users/scutzou/followers","following_url":"https://api.github.com/users/scutzou/following{/other_user}","gists_url":"https://api.github.com/users/scutzou/gists{/gist_id}","starred_url":"https://api.github.com/users/scutzou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scutzou/subscriptions","organizations_url":"https://api.github.com/users/scutzou/orgs","repos_url":"https://api.github.com/users/scutzou/repos","events_url":"https://api.github.com/users/scutzou/events{/privacy}","received_events_url":"https://api.github.com/users/scutzou/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T05:24:33Z","updated_at":"2021-02-23T05:24:33Z","author_association":"CONTRIBUTOR","body":"> Actually, isn't the unlock already called within `cleanupMetadataAndUnlock` at the moment?\r\n\r\nIn `doCommit`, lockId will be lost when an exception is thrown from `acquireLock`.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/783912599/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784140777","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-784140777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":784140777,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDE0MDc3Nw==","user":{"login":"XuQianJin-Stars","id":10494131,"node_id":"MDQ6VXNlcjEwNDk0MTMx","avatar_url":"https://avatars.githubusercontent.com/u/10494131?v=4","gravatar_id":"","url":"https://api.github.com/users/XuQianJin-Stars","html_url":"https://github.com/XuQianJin-Stars","followers_url":"https://api.github.com/users/XuQianJin-Stars/followers","following_url":"https://api.github.com/users/XuQianJin-Stars/following{/other_user}","gists_url":"https://api.github.com/users/XuQianJin-Stars/gists{/gist_id}","starred_url":"https://api.github.com/users/XuQianJin-Stars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XuQianJin-Stars/subscriptions","organizations_url":"https://api.github.com/users/XuQianJin-Stars/orgs","repos_url":"https://api.github.com/users/XuQianJin-Stars/repos","events_url":"https://api.github.com/users/XuQianJin-Stars/events{/privacy}","received_events_url":"https://api.github.com/users/XuQianJin-Stars/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T11:40:40Z","updated_at":"2021-02-23T11:40:40Z","author_association":"CONTRIBUTOR","body":"hi @ismailsimsek What is this current progress?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784140777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784153620","html_url":"https://github.com/apache/iceberg/issues/2033#issuecomment-784153620","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2033","id":784153620,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDE1MzYyMA==","user":{"login":"kezhuw","id":541734,"node_id":"MDQ6VXNlcjU0MTczNA==","avatar_url":"https://avatars.githubusercontent.com/u/541734?v=4","gravatar_id":"","url":"https://api.github.com/users/kezhuw","html_url":"https://github.com/kezhuw","followers_url":"https://api.github.com/users/kezhuw/followers","following_url":"https://api.github.com/users/kezhuw/following{/other_user}","gists_url":"https://api.github.com/users/kezhuw/gists{/gist_id}","starred_url":"https://api.github.com/users/kezhuw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kezhuw/subscriptions","organizations_url":"https://api.github.com/users/kezhuw/orgs","repos_url":"https://api.github.com/users/kezhuw/repos","events_url":"https://api.github.com/users/kezhuw/events{/privacy}","received_events_url":"https://api.github.com/users/kezhuw/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T12:05:18Z","updated_at":"2021-02-23T12:05:18Z","author_association":"MEMBER","body":"@stevenzwu I think you are right, at least partially, it is a Flink bug anyway. Before [FLIP-147(Support Checkpoints After Tasks Finished)](https://cwiki.apache.org/confluence/x/mw-ZCQ) , sink writers sit in dilemma situation that there is no reliable way to commit final result to external system. `endInput` was not designed to commit final result, but actually has been used for a workaround/last-resort. There is no strong guarantee that `endInput` will be invoked only once. So basically, if sink writers want to commit final result in `endInput`, they should prepare for situations that `endInput` could run multiple times. Thus, @openinx the test should not focus (or focus only) on stop-with-savepoint, but multiple runs of `endInput`.\r\n\r\nI want quote some comments from our discussions here.\r\n\r\n@aljoscha [said](https://issues.apache.org/jira/browse/FLINK-21132?focusedCommentId=17274459&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17274459) that:\r\n\r\n> The motivation for introducing endOfInput() were things like hash-join in the SQL runner where an operator would read from the build side until getting an end-of-input, at which point it would switch over to reading from the probe side. With these use cases in mind sending an endOfInput() is a bug. The same is true for sinks, which will do some bookkeeping based on knowing that all the input data has been read.\r\n\r\n@gaoyunhaii [said](https://issues.apache.org/jira/browse/FLINK-21132?focusedCommentId=17271999&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17271999) that:\r\n\r\n> First of all, I think there would be some problem fro the current implementation that committed in endOfInput(), considering if the job is bounded (namely the first case). The problem is that if the failover happens right after commit() in the endOfInput, then the job will be restarted and fallback to the last checkpoint, which will cause replay of the data committed in endOfInput. FLIP-147: Support checkpoint after tasks finished is a precedent step to solve the commit problem of the sinks in the first case.\r\n\r\ncc @pnowojski  @aljoscha @gaoyunhaii @rkhachatryan @becketqin @StephanEwen @tillrohrmann","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784153620/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784154992","html_url":"https://github.com/apache/iceberg/pull/1870#issuecomment-784154992","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1870","id":784154992,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDE1NDk5Mg==","user":{"login":"ismailsimsek","id":6005685,"node_id":"MDQ6VXNlcjYwMDU2ODU=","avatar_url":"https://avatars.githubusercontent.com/u/6005685?v=4","gravatar_id":"","url":"https://api.github.com/users/ismailsimsek","html_url":"https://github.com/ismailsimsek","followers_url":"https://api.github.com/users/ismailsimsek/followers","following_url":"https://api.github.com/users/ismailsimsek/following{/other_user}","gists_url":"https://api.github.com/users/ismailsimsek/gists{/gist_id}","starred_url":"https://api.github.com/users/ismailsimsek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ismailsimsek/subscriptions","organizations_url":"https://api.github.com/users/ismailsimsek/orgs","repos_url":"https://api.github.com/users/ismailsimsek/repos","events_url":"https://api.github.com/users/ismailsimsek/events{/privacy}","received_events_url":"https://api.github.com/users/ismailsimsek/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T12:07:54Z","updated_at":"2021-02-23T12:07:54Z","author_association":"CONTRIBUTOR","body":"sorry i got busy with some other stuff, it should be close to finish, @XuQianJin-Stars please feel free to add your review @rdblue  @jackye1995  its ready for another review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784154992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784160924","html_url":"https://github.com/apache/iceberg/issues/2260#issuecomment-784160924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2260","id":784160924,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDE2MDkyNA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T12:18:41Z","updated_at":"2021-02-23T12:18:41Z","author_association":"CONTRIBUTOR","body":"> > new Object[] { \"testhive\", SparkCatalog.class.getName(), ImmutableMap.of(\r\n> > \"type\", \"hive\",\r\n> > \"default-namespace\", \"default\"\r\n> > )},\r\n> \r\n> how to use this config! can u give a full example?\r\n\r\nI am not too familiar with spark, but I expect that this should be something like this:\r\n\r\n```\r\nbin/spark-sql\r\n--conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\r\n--conf spark.sql.catalog.test=org.apache.iceberg.spark.SparkCatalog\r\n--conf spark.sql.catalog.test.type=hive\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784160924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784167496","html_url":"https://github.com/apache/iceberg/issues/2076#issuecomment-784167496","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2076","id":784167496,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDE2NzQ5Ng==","user":{"login":"chong0929","id":26707386,"node_id":"MDQ6VXNlcjI2NzA3Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/26707386?v=4","gravatar_id":"","url":"https://api.github.com/users/chong0929","html_url":"https://github.com/chong0929","followers_url":"https://api.github.com/users/chong0929/followers","following_url":"https://api.github.com/users/chong0929/following{/other_user}","gists_url":"https://api.github.com/users/chong0929/gists{/gist_id}","starred_url":"https://api.github.com/users/chong0929/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chong0929/subscriptions","organizations_url":"https://api.github.com/users/chong0929/orgs","repos_url":"https://api.github.com/users/chong0929/repos","events_url":"https://api.github.com/users/chong0929/events{/privacy}","received_events_url":"https://api.github.com/users/chong0929/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T12:30:42Z","updated_at":"2021-02-23T12:30:42Z","author_association":"NONE","body":"Is your problem solved? I have the same error.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784167496/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784276498","html_url":"https://github.com/apache/iceberg/issues/2260#issuecomment-784276498","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2260","id":784276498,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDI3NjQ5OA==","user":{"login":"yfcck","id":43957,"node_id":"MDQ6VXNlcjQzOTU3","avatar_url":"https://avatars.githubusercontent.com/u/43957?v=4","gravatar_id":"","url":"https://api.github.com/users/yfcck","html_url":"https://github.com/yfcck","followers_url":"https://api.github.com/users/yfcck/followers","following_url":"https://api.github.com/users/yfcck/following{/other_user}","gists_url":"https://api.github.com/users/yfcck/gists{/gist_id}","starred_url":"https://api.github.com/users/yfcck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yfcck/subscriptions","organizations_url":"https://api.github.com/users/yfcck/orgs","repos_url":"https://api.github.com/users/yfcck/repos","events_url":"https://api.github.com/users/yfcck/events{/privacy}","received_events_url":"https://api.github.com/users/yfcck/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T15:19:04Z","updated_at":"2021-02-23T15:19:04Z","author_association":"NONE","body":"> > > new Object[] { \"testhive\", SparkCatalog.class.getName(), ImmutableMap.of(\r\n> > > \"type\", \"hive\",\r\n> > > \"default-namespace\", \"default\"\r\n> > > )},\r\n> > \r\n> > \r\n> > how to use this config! can u give a full example?\r\n> \r\n> I am not too familiar with spark, but I expect that this should be something like this:\r\n> \r\n> ```\r\n> bin/spark-sql\r\n> --conf spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions\r\n> --conf spark.sql.catalog.test=org.apache.iceberg.spark.SparkCatalog\r\n> --conf spark.sql.catalog.test.type=hive\r\n> ```\r\n\r\nths!\r\nI configured it like thisStill report that warning.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784276498/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784660095","html_url":"https://github.com/apache/iceberg/issues/1994#issuecomment-784660095","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1994","id":784660095,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDY2MDA5NQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T01:18:48Z","updated_at":"2021-02-24T01:18:48Z","author_association":"CONTRIBUTOR","body":"Looks like #2119 is in so I'll close this. Thanks, @Jecarm!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784660095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784853409","html_url":"https://github.com/apache/iceberg/pull/2149#issuecomment-784853409","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2149","id":784853409,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDg1MzQwOQ==","user":{"login":"saurabhagas","id":5038921,"node_id":"MDQ6VXNlcjUwMzg5MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5038921?v=4","gravatar_id":"","url":"https://api.github.com/users/saurabhagas","html_url":"https://github.com/saurabhagas","followers_url":"https://api.github.com/users/saurabhagas/followers","following_url":"https://api.github.com/users/saurabhagas/following{/other_user}","gists_url":"https://api.github.com/users/saurabhagas/gists{/gist_id}","starred_url":"https://api.github.com/users/saurabhagas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saurabhagas/subscriptions","organizations_url":"https://api.github.com/users/saurabhagas/orgs","repos_url":"https://api.github.com/users/saurabhagas/repos","events_url":"https://api.github.com/users/saurabhagas/events{/privacy}","received_events_url":"https://api.github.com/users/saurabhagas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T07:20:52Z","updated_at":"2021-02-24T07:20:52Z","author_association":"NONE","body":"@rdblue, can you check this PR and give your final verdict please? If the change isn't acceptable, I'll close the tracking issue as well. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784853409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784937086","html_url":"https://github.com/apache/iceberg/pull/2259#issuecomment-784937086","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2259","id":784937086,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDkzNzA4Ng==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T09:26:46Z","updated_at":"2021-02-24T09:33:52Z","author_association":"CONTRIBUTOR","body":"@rdblue I check the code , found the [comment](https://github.com/apache/iceberg/blob/master/flink/src/main/java/org/apache/iceberg/flink/FlinkCatalog.java#L540) , `We can not create a IcebergCatalogTable extends CatalogTable` ,so  in flink,   if we want to get the iceberg table in `FlinkCatalog` more conveniently , I think we can only change `loadIcebergTable` method to `public `","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/784937086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785002429","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-785002429","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":785002429,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTAwMjQyOQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T11:13:24Z","updated_at":"2021-02-24T11:14:00Z","author_association":"COLLABORATOR","body":"This is the PR for #2227 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785002429/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785004147","html_url":"https://github.com/apache/iceberg/issues/2227#issuecomment-785004147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2227","id":785004147,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTAwNDE0Nw==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T11:16:04Z","updated_at":"2021-02-24T11:18:11Z","author_association":"COLLABORATOR","body":"Hi @rymurr i pushed my PR, if you have time to take a look.\r\n\r\nI tested manually on real Iceberg table.  Verified that table metadata is dropped, and that all the expected data/metadata files are gone if purge=true.\r\n\r\nThe 3.7 tox test failures were broken before my change actually.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785004147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785014578","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-785014578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":785014578,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTAxNDU3OA==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T11:35:13Z","updated_at":"2021-02-24T11:35:13Z","author_association":"CONTRIBUTOR","body":"thanks @szehon-ho! I should get time to review in the next day or two.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785014578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785238135","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-785238135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":785238135,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTIzODEzNQ==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T17:21:43Z","updated_at":"2021-02-24T17:21:43Z","author_association":"COLLABORATOR","body":"Great,  no rush, thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785238135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785242961","html_url":"https://github.com/apache/iceberg/pull/2259#issuecomment-785242961","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2259","id":785242961,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTI0Mjk2MQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T17:28:26Z","updated_at":"2021-02-24T17:28:26Z","author_association":"CONTRIBUTOR","body":"Okay, sounds like we can't go that direction then. What about using the Iceberg catalogs directly? You should be able to create one easily and then use that directly rather than using a Flink catalog to do the loading. Or what about exposing the underlying Iceberg catalog from the Flink catalog? So you'd load the Flink catalog, call `catalog()` to get the Iceberg catalog and then be able to load tables from there? The advantage of that approach is that you'd add one method but be able to do any catalog operation directly rather than just load a table.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785242961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785251738","html_url":"https://github.com/apache/iceberg/pull/2257#issuecomment-785251738","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2257","id":785251738,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTI1MTczOA==","user":{"login":"holdenk","id":59893,"node_id":"MDQ6VXNlcjU5ODkz","avatar_url":"https://avatars.githubusercontent.com/u/59893?v=4","gravatar_id":"","url":"https://api.github.com/users/holdenk","html_url":"https://github.com/holdenk","followers_url":"https://api.github.com/users/holdenk/followers","following_url":"https://api.github.com/users/holdenk/following{/other_user}","gists_url":"https://api.github.com/users/holdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/holdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/holdenk/subscriptions","organizations_url":"https://api.github.com/users/holdenk/orgs","repos_url":"https://api.github.com/users/holdenk/repos","events_url":"https://api.github.com/users/holdenk/events{/privacy}","received_events_url":"https://api.github.com/users/holdenk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T17:41:25Z","updated_at":"2021-02-24T17:41:25Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785251738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785263292","html_url":"https://github.com/apache/iceberg/pull/2237#issuecomment-785263292","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2237","id":785263292,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTI2MzI5Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T17:59:33Z","updated_at":"2021-02-24T17:59:33Z","author_association":"CONTRIBUTOR","body":"Thanks @danielcweeks!\r\n\r\n@jackye1995, I didn't wait to fix that typo because I didn't want this commit to touch an additional unrelated file. We can fix that in a separate PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785263292/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785267733","html_url":"https://github.com/apache/iceberg/pull/2255#issuecomment-785267733","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2255","id":785267733,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTI2NzczMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T18:06:27Z","updated_at":"2021-02-24T18:06:27Z","author_association":"CONTRIBUTOR","body":"Overall this looks like a good step. Thanks @aokolnychyi! I think we just need to fix a few minor things and then it's ready to go.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785267733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785269593","html_url":"https://github.com/apache/iceberg/pull/2267#issuecomment-785269593","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2267","id":785269593,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTI2OTU5Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T18:09:20Z","updated_at":"2021-02-24T18:09:20Z","author_association":"CONTRIBUTOR","body":"Looks like a correct implementation. I think this needs a test for the non-empty drop behavior so that we know what happens there, but otherwise I think this is good. Thanks, @jackye1995.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785269593/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785271513","html_url":"https://github.com/apache/iceberg/pull/2263#issuecomment-785271513","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2263","id":785271513,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTI3MTUxMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T18:12:29Z","updated_at":"2021-02-24T18:12:40Z","author_association":"CONTRIBUTOR","body":"Good catch, and thank you for fixing this, @ZorTsou!\r\n\r\nThanks for the reviews, @pvary and @marton-bod!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785271513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785273633","html_url":"https://github.com/apache/iceberg/pull/2268#issuecomment-785273633","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2268","id":785273633,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTI3MzYzMw==","user":{"login":"rymurr","id":2022305,"node_id":"MDQ6VXNlcjIwMjIzMDU=","avatar_url":"https://avatars.githubusercontent.com/u/2022305?v=4","gravatar_id":"","url":"https://api.github.com/users/rymurr","html_url":"https://github.com/rymurr","followers_url":"https://api.github.com/users/rymurr/followers","following_url":"https://api.github.com/users/rymurr/following{/other_user}","gists_url":"https://api.github.com/users/rymurr/gists{/gist_id}","starred_url":"https://api.github.com/users/rymurr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rymurr/subscriptions","organizations_url":"https://api.github.com/users/rymurr/orgs","repos_url":"https://api.github.com/users/rymurr/repos","events_url":"https://api.github.com/users/rymurr/events{/privacy}","received_events_url":"https://api.github.com/users/rymurr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T18:15:56Z","updated_at":"2021-02-24T18:15:56Z","author_association":"CONTRIBUTOR","body":"Current Failures:\r\n* linters don't pass in `Literals` anymore\r\n* pandas and pyarrow version related issues \r\n\r\nAdded:\r\n* python 3.9 tests","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785273633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785322301","html_url":"https://github.com/apache/iceberg/pull/2149#issuecomment-785322301","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2149","id":785322301,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTMyMjMwMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T19:36:00Z","updated_at":"2021-02-24T19:36:00Z","author_association":"CONTRIBUTOR","body":"@saurabhagas, I'm not sure there's enough information in the issue to understand why a different method can't be used, or if it is a good idea to expose this. It sounds like you're constructing different schemas and using stats differently, so how much similarity is there? The Parquet values produced by this are specific to Iceberg's object model. If you're building something different from Iceberg then I would say that it makes the most sense for you to have similar code for your use case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785322301/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785403354","html_url":"https://github.com/apache/iceberg/pull/2255#issuecomment-785403354","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2255","id":785403354,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTQwMzM1NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T21:41:54Z","updated_at":"2021-02-24T21:41:54Z","author_association":"CONTRIBUTOR","body":"I've addressed some of the comments. Still open questions:\r\n\r\n- Having `options` in the `Action` directly. That seems simpler than having `ConfigurableAction`.\r\n- Accepting Strings instead of Tables in all actions so that each action loads the table. My worry is that it will require a proper catalog config for resolution. I think most people will leverage SQL extensions for simple cases so it feels more flexible to pass the `Table` object. However, I agree it is not consistent with `snapshotTable` and `migrateTable`.\r\n- Shall we make action results closeable? Seems like that would really complicate the usage so maybe we can skip doing that unless needed by other query engines.\r\n- Using `with` prefix for some method names. I'd say let's not use it to be consistent.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785403354/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785430989","html_url":"https://github.com/apache/iceberg/issues/2260#issuecomment-785430989","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2260","id":785430989,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTQzMDk4OQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-24T22:37:53Z","updated_at":"2021-02-24T22:37:53Z","author_association":"CONTRIBUTOR","body":"@rlcyf: Does this prevent you from reading the data? Or it is just a warning? Does adding the iceberg-hive-runtime.jar to the classpath help?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785430989/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785511922","html_url":"https://github.com/apache/iceberg/pull/2259#issuecomment-785511922","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2259","id":785511922,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTUxMTkyMg==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T01:38:48Z","updated_at":"2021-02-25T01:38:48Z","author_association":"CONTRIBUTOR","body":"Great,I think it is a good idea to add a `catalog()` method to  exposing iceberg catalog,I updated it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785511922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785526677","html_url":"https://github.com/apache/iceberg/pull/2263#issuecomment-785526677","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2263","id":785526677,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTUyNjY3Nw==","user":{"login":"scutzou","id":17271682,"node_id":"MDQ6VXNlcjE3MjcxNjgy","avatar_url":"https://avatars.githubusercontent.com/u/17271682?v=4","gravatar_id":"","url":"https://api.github.com/users/scutzou","html_url":"https://github.com/scutzou","followers_url":"https://api.github.com/users/scutzou/followers","following_url":"https://api.github.com/users/scutzou/following{/other_user}","gists_url":"https://api.github.com/users/scutzou/gists{/gist_id}","starred_url":"https://api.github.com/users/scutzou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scutzou/subscriptions","organizations_url":"https://api.github.com/users/scutzou/orgs","repos_url":"https://api.github.com/users/scutzou/repos","events_url":"https://api.github.com/users/scutzou/events{/privacy}","received_events_url":"https://api.github.com/users/scutzou/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T02:20:15Z","updated_at":"2021-02-25T02:20:15Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @marton-bod @pvary @rdblue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785526677/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785617395","html_url":"https://github.com/apache/iceberg/pull/1963#issuecomment-785617395","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1963","id":785617395,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTYxNzM5NQ==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T05:12:58Z","updated_at":"2021-02-25T05:12:58Z","author_association":"CONTRIBUTOR","body":"Thank you @rdblue for reviewing this PR again! I think I have addressed all the feedback. Since the visitor change is non-trivial and the original change didn't contain tests, in order to ensure the new code with before/afterField pattern doesn't impact normal avro writes, I added all the necessary tests to this PR (which means that #1935 will be done if the current changes are merged), but please feel free to suggest removing some classes for an easier review.\r\n\r\nOne thing I'd like to mention is a behavior difference among different file types in handling optional struct field with required and optional sub fields. I think it might be fine for now since I think we don't use those statistics, but just want to capture the current status here:\r\n\r\nfor example, if the schema is `someField, optional struct<required int1, optional int2>`, and there are 50 records with this schema in total, within which 6 records have null struct, and 3 records have struct but null int2, then each file format will produce the following count info:\r\n\r\n|         | valueCount | nullCount |\r\n|---------|------------|-----------|\r\n| Parquet | int1: 50, int2: 50       | int1:  6,  int2: 9    |\r\n| Orc     |int1: 44, int2: 50            | int1: 0, int2: 9          |\r\n| Avro    |int1: 44, int2: 44            |int1: 0, int2: 3          |\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785617395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785624674","html_url":"https://github.com/apache/iceberg/pull/2149#issuecomment-785624674","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2149","id":785624674,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTYyNDY3NA==","user":{"login":"saurabhagas","id":5038921,"node_id":"MDQ6VXNlcjUwMzg5MjE=","avatar_url":"https://avatars.githubusercontent.com/u/5038921?v=4","gravatar_id":"","url":"https://api.github.com/users/saurabhagas","html_url":"https://github.com/saurabhagas","followers_url":"https://api.github.com/users/saurabhagas/followers","following_url":"https://api.github.com/users/saurabhagas/following{/other_user}","gists_url":"https://api.github.com/users/saurabhagas/gists{/gist_id}","starred_url":"https://api.github.com/users/saurabhagas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saurabhagas/subscriptions","organizations_url":"https://api.github.com/users/saurabhagas/orgs","repos_url":"https://api.github.com/users/saurabhagas/repos","events_url":"https://api.github.com/users/saurabhagas/events{/privacy}","received_events_url":"https://api.github.com/users/saurabhagas/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T05:33:03Z","updated_at":"2021-02-25T05:33:03Z","author_association":"NONE","body":"Thanks for the reply. Closing the issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/785624674/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786165769","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-786165769","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":786165769,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjE2NTc2OQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T20:04:09Z","updated_at":"2021-02-25T20:04:09Z","author_association":"CONTRIBUTOR","body":"Let me do another round now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786165769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786207748","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-786207748","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":786207748,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjIwNzc0OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T21:11:26Z","updated_at":"2021-02-25T21:11:26Z","author_association":"CONTRIBUTOR","body":"I see that the current approach tries to promote the sort columns on read, which is one way of doing this. I think I'd prefer the approach we took with `validateReferencedColumns` that does its validation during table creation and in a few other relevant places. If we do it that way, we don't need to modify any ORC and Parquet code and the scope of the change will be really small.\r\n\r\nBasically, we could modify `TableMetadata#newTableMetadata` as this:\r\n\r\n```\r\n    MetricsConfig metricsConfig = MetricsConfig.fromProperties(properties);\r\n    metricsConfig.validateReferencedColumns(schema);\r\n    MetricsConfig freshMetricsConfig = metricsConfig.copyWithPromotedSortColumns(freshSortOrder);\r\n\r\n    Map<String, String> freshProperties = Maps.newHashMap(properties);\r\n    freshProperties.putAll(freshMetricsConfig.toProperties());\r\n```\r\n\r\nThat will need two new methods in `MetricsConfig` (let's not make them public):\r\n\r\n```\r\n  MetricsConfig copyWithPromotedSortColumns(SortOrder sortOrder) {\r\n    // create a copy\r\n    // check the default mode\r\n    // if none or count -> iterate through the sort order fields and promote as needed if not set by the user\r\n  }\r\n\r\n  Map<String, String> toProperties() {\r\n    // map into table props\r\n  }\r\n```\r\n\r\nWhat are your thoughts, @RussellSpitzer @rdblue @holdenk @shardulm94 @pvary?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786207748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786242036","html_url":"https://github.com/apache/iceberg/issues/2274#issuecomment-786242036","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2274","id":786242036,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI0MjAzNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T21:32:38Z","updated_at":"2021-02-25T21:32:38Z","author_association":"CONTRIBUTOR","body":"@rdblue @RussellSpitzer @pvary @marton-bod, what do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786242036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786255094","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-786255094","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":786255094,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI1NTA5NA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T21:57:16Z","updated_at":"2021-02-25T21:57:16Z","author_association":"MEMBER","body":"Would that also catch alters? @aokolnychyi? I don't think that's unreasonable since it does make sense to keep it off the read path if possible ...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786255094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786255694","html_url":"https://github.com/apache/iceberg/issues/2270#issuecomment-786255694","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2270","id":786255694,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI1NTY5NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T21:58:30Z","updated_at":"2021-02-25T21:58:30Z","author_association":"CONTRIBUTOR","body":"I think it will be useful. For example, I've frequently seen projects where folks create a number of tables and want to use more or less the same properties across tables within that project. Instead of specifying the same props over and over again, they could set them in their session config template. In another project, they may have a set of different props.\r\n\r\nI believe Spark has does that in some cases already. For instance, properties like `spark.datasource.ds_name.key` are propagated into sources during some operations. I'd vote for a catalog-native solution in Spark 3. That way, it will become a standard way of representing this in Spark.\r\n\r\nThe session conf can look like this:\r\n\r\n```\r\nspark.sql.catalog.cat_name.table_defaults.key1 = value1\r\nspark.sql.catalog.cat_name.table_defaults.key2 = value2\r\n```\r\n\r\nThen individual property values in create statements will override what is in the session conf.\r\n\r\n```\r\nCREATE TABLE ...\r\nTBLPROPERTIES (\r\n  'k2' 'custom_value'\r\n)\r\n````\r\n\r\nIn the future, we can also support read and write options.\r\n\r\n```\r\n// the name is arbitrary\r\ninterface SupportsSessionConfigDefaults extends TableCatalog {\r\n    String tablePropertiesPrefix();\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786255694/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786256705","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-786256705","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":786256705,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI1NjcwNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T22:00:35Z","updated_at":"2021-02-25T22:00:35Z","author_association":"CONTRIBUTOR","body":"We will catch altering sort order separately just like we catch a few other places for `validateReferencedColumns`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786256705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786256901","html_url":"https://github.com/apache/iceberg/issues/2270#issuecomment-786256901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2270","id":786256901,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI1NjkwMQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T22:01:01Z","updated_at":"2021-02-25T22:01:01Z","author_association":"MEMBER","body":"I know we implemented something like this within the Spark Cassandra Connector, where we allowed a user to set any property that the underlying SCC could use at the Catalog level and therefor set it for all operations carried out by that Catalog.\r\n\r\nIn our use case I didn't have any hope of doing this in Spark itself so we just implemented it in the \"Initialize\" method of the catalog but it might be nice if Spark supported this as a first class feature as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786256901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786258918","html_url":"https://github.com/apache/iceberg/pull/2273#issuecomment-786258918","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2273","id":786258918,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI1ODkxOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T22:05:14Z","updated_at":"2021-02-25T22:05:14Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer is working on a data compaction proposal and there is a PR to rework the Action API in #2255.\r\n\r\nI'd prefer to get #2255 and subsequent PRs (which I have locally) in before we make more changes around actions.\r\n\r\n@RussellSpitzer, could you please take a look at this PR? I think you have a solution for this and it would be great to confirm it works for @chenjunjiedada. \r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786258918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786259936","html_url":"https://github.com/apache/iceberg/pull/2257#issuecomment-786259936","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2257","id":786259936,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI1OTkzNg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T22:07:20Z","updated_at":"2021-02-25T22:07:20Z","author_association":"CONTRIBUTOR","body":"Let me take a look today! Thanks, @holdenk!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786259936/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786261493","html_url":"https://github.com/apache/iceberg/pull/2273#issuecomment-786261493","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2273","id":786261493,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI2MTQ5Mw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T22:10:29Z","updated_at":"2021-02-25T22:11:51Z","author_association":"MEMBER","body":"I believe so, for a preview i'm thinking that we should make rewrite/optimize an action which takes a variable \"CompactionStrategy\" class that has a fulfills an interface like\r\n```java\r\n  /**\r\n   * Removes all file references which this plan will not rewrite.\r\n   * @param dataFiles iterator of live datafiles in a given partition\r\n   * @return iterator containing only files to be rewritten\r\n   */\r\n  Iterator<DataFile> filesToCompact(Iterator<DataFile> dataFiles);\r\n\r\n  /**\r\n   * Groups files into lists which will be processed in a single executable\r\n   * unit. Each group will end up being committed as an independent set of\r\n   * changes.\r\n   * @param dataFiles iterator of files to be rewritten\r\n   * @return iterator of sets of files to be processed together\r\n   */\r\n  Iterator<List<DataFile>> groupsFilesPerJob(Iterator<DataFile> dataFiles);\r\n\r\n  /**\r\n   * Method which will actually rewrite and commit changes to a group of files\r\n   * based on the particular CompactionStrategy's algorithm\r\n   * @param filesToRewrite a group of files to be rewritten together\r\n   * @return a list of newly committed files\r\n   */\r\n  List<DataFile> rewriteFiles(List<DataFile> filesToRewrite);\r\n}\r\n```\r\n\r\nAlthough I think we may need to have the methods use FileScanTask since we are going to need access to DeleteFiles and Data files to properly run the \"rewrite\" action ... I hope to get this up soon, I just have been wavering on that issue since it is no longer trivial to take a set of DataFiles and generate tasks to read them.\r\n\r\nWhat I want to be sure of here is that we don't just allow a \"filter\" expression because some algorithms may want to collect the entire list of files before considering which files to compact or not.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786261493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786261856","html_url":"https://github.com/apache/iceberg/issues/2270#issuecomment-786261856","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2270","id":786261856,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI2MTg1Ng==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T22:11:18Z","updated_at":"2021-02-25T22:11:18Z","author_association":"CONTRIBUTOR","body":"@holdenk @dongjoon-hyun @viirya @rdblue @sunchao, do you think it is worth trying in Spark? Seems all catalog implementations would benefit from this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786261856/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786276758","html_url":"https://github.com/apache/iceberg/pull/2265#issuecomment-786276758","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2265","id":786276758,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI3Njc1OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T22:40:18Z","updated_at":"2021-02-25T22:40:18Z","author_association":"CONTRIBUTOR","body":"@zhangjun0x01, can you update the description to include what you're changing in Iceberg and why it should be done that way? I'm surprised to see changes to types in the API module so I think this warrants a clear description of why that's needed. It is really helpful to provide context for reviewers. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786276758/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786278708","html_url":"https://github.com/apache/iceberg/pull/2239#issuecomment-786278708","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2239","id":786278708,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjI3ODcwOA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T22:44:38Z","updated_at":"2021-02-25T22:44:38Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, @RussellSpitzer @rdblue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786278708/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786301938","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-786301938","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":786301938,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjMwMTkzOA==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T23:29:06Z","updated_at":"2021-02-26T02:40:49Z","author_association":"CONTRIBUTOR","body":"*** Maybe I should create a new issue\r\n\r\nI see in the docs that currently Iceberg only supports Hive 2.x. So I tried querying the table from Spark. Here is the stack trace I got. Which is similar to the trace I got for Hive (attached in thread above).\r\n\r\nI can however, query the table just fine from Flink SQL. \r\n\r\nI'd also like to point out that all of this testing was done from a different EMR cluster than the one that wrote out the original data (Flink streaming job). Indicating I'm able to connect to Glue to get the relevant metadata, but for some reason Spark and Hive can't (Hive I understand that I should be testing with version 2.x) \r\n\r\n***** Flink section *******************\r\n```\r\nFlink SQL> select * from iceberg.iceberg_warehouse.iceberg_dummy_table;\r\n[INFO] Result retrieval cancelled.\r\n```\r\n***** Spark section *******************\r\nSpark version: version 3.0.1-amzn-0\r\nI'm able to see the tables via spark-shell still so it's able to see the metadata:\r\n```\r\nspark-sql> use iceberg_warehouse;\r\nTime taken: 0.139 seconds\r\nspark-sql> show tables;\r\niceberg_warehouse\ticeberg_dummy_table\tfalse\r\nTime taken: 0.339 seconds, Fetched 1 row(s)\r\nspark-sql>\r\n```   \r\n\r\nSpark-sql shell error I get:\r\n```\r\nspark-sql> select * from iceberg_dummy_table;\r\nError in query: org.apache.hadoop.hive.ql.metadata.HiveException: Unable to fetch table iceberg_dummy_table. StorageDescriptor cannot be null for table: iceberg_dummy_table (Service: null; Status Code: 0; Error Code: null; Request ID: null; Proxy: null);\r\norg.apache.spark.sql.AnalysisException: org.apache.hadoop.hive.ql.metadata.HiveException: Unable to fetch table iceberg_dummy_table. StorageDescriptor cannot be null for table: iceberg_dummy_table (Service: null; Status Code: 0; Error Code: null; Request ID: null; Proxy: null);\r\n\tat org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:113)\r\n\tat org.apache.spark.sql.hive.HiveExternalCatalog.tableExists(HiveExternalCatalog.scala:855)\r\n\tat org.apache.spark.sql.catalyst.catalog.ExternalCatalogWithListener.tableExists(ExternalCatalogWithListener.scala:146)\r\n\tat org.apache.spark.sql.catalyst.catalog.SessionCatalog.tableExists(SessionCatalog.scala:432)\r\n\tat org.apache.spark.sql.catalyst.catalog.SessionCatalog.requireTableExists(SessionCatalog.scala:185)\r\n\tat org.apache.spark.sql.catalyst.catalog.SessionCatalog.getTableMetadata(SessionCatalog.scala:445)\r\n\tat org.apache.spark.sql.execution.datasources.v2.V2SessionCatalog.loadTable(V2SessionCatalog.scala:66)\r\n\tat org.apache.spark.sql.connector.catalog.CatalogV2Util$.loadTable(CatalogV2Util.scala:283)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.loaded$lzycompute$1(Analyzer.scala:1010)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.loaded$1(Analyzer.scala:1010)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.$anonfun$lookupRelation$3(Analyzer.scala:1022)\r\n\tat scala.Option.orElse(Option.scala:447)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.org$apache$spark$sql$catalyst$analysis$Analyzer$ResolveRelations$$lookupRelation(Analyzer.scala:1021)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$9.applyOrElse(Analyzer.scala:977)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$$anonfun$apply$9.applyOrElse(Analyzer.scala:962)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUp$3(AnalysisHelper.scala:90)\r\n\tat org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:72)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUp$1(AnalysisHelper.scala:90)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUp(AnalysisHelper.scala:86)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUp$(AnalysisHelper.scala:84)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUp$2(AnalysisHelper.scala:87)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.applyFunctionIfChanged$1(TreeNode.scala:380)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$mapChildren$1(TreeNode.scala:416)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:248)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:414)\r\n\tat org.apache.spark.sql.catalyst.trees.TreeNode.mapChildren(TreeNode.scala:362)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.$anonfun$resolveOperatorsUp$1(AnalysisHelper.scala:87)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.allowInvokingTransformsInAnalyzer(AnalysisHelper.scala:194)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUp(AnalysisHelper.scala:86)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.resolveOperatorsUp$(AnalysisHelper.scala:84)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.resolveOperatorsUp(LogicalPlan.scala:29)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:962)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer$ResolveRelations$.apply(Analyzer.scala:934)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$2(RuleExecutor.scala:149)\r\n\tat scala.collection.LinearSeqOptimized.foldLeft(LinearSeqOptimized.scala:126)\r\n\tat scala.collection.LinearSeqOptimized.foldLeft$(LinearSeqOptimized.scala:122)\r\n\tat scala.collection.immutable.List.foldLeft(List.scala:89)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$1(RuleExecutor.scala:146)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$execute$1$adapted(RuleExecutor.scala:138)\r\n\tat scala.collection.immutable.List.foreach(List.scala:392)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.execute(RuleExecutor.scala:138)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.org$apache$spark$sql$catalyst$analysis$Analyzer$$executeSameContext(Analyzer.scala:176)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:170)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.execute(Analyzer.scala:130)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.$anonfun$executeAndTrack$1(RuleExecutor.scala:116)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker$.withTracker(QueryPlanningTracker.scala:104)\r\n\tat org.apache.spark.sql.catalyst.rules.RuleExecutor.executeAndTrack(RuleExecutor.scala:116)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.$anonfun$executeAndCheck$1(Analyzer.scala:154)\r\n\tat org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper$.markInAnalyzer(AnalysisHelper.scala:201)\r\n\tat org.apache.spark.sql.catalyst.analysis.Analyzer.executeAndCheck(Analyzer.scala:153)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$analyzed$1(QueryExecution.scala:68)\r\n\tat org.apache.spark.sql.catalyst.QueryPlanningTracker.measurePhase(QueryPlanningTracker.scala:149)\r\n\tat org.apache.spark.sql.execution.QueryExecution.$anonfun$executePhase$1(QueryExecution.scala:153)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\r\n\tat org.apache.spark.sql.execution.QueryExecution.executePhase(QueryExecution.scala:153)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed$lzycompute(QueryExecution.scala:68)\r\n\tat org.apache.spark.sql.execution.QueryExecution.analyzed(QueryExecution.scala:66)\r\n\tat org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:58)\r\n\tat org.apache.spark.sql.Dataset$.$anonfun$ofRows$2(Dataset.scala:100)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\r\n\tat org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:98)\r\n\tat org.apache.spark.sql.SparkSession.$anonfun$sql$1(SparkSession.scala:607)\r\n\tat org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:764)\r\n\tat org.apache.spark.sql.SparkSession.sql(SparkSession.scala:602)\r\n\tat org.apache.spark.sql.SQLContext.sql(SQLContext.scala:650)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLDriver.run(SparkSQLDriver.scala:63)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processCmd(SparkSQLCLIDriver.scala:377)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.$anonfun$processLine$1(SparkSQLCLIDriver.scala:496)\r\n\tat scala.collection.Iterator.foreach(Iterator.scala:941)\r\n\tat scala.collection.Iterator.foreach$(Iterator.scala:941)\r\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1429)\r\n\tat scala.collection.IterableLike.foreach(IterableLike.scala:74)\r\n\tat scala.collection.IterableLike.foreach$(IterableLike.scala:73)\r\n\tat scala.collection.AbstractIterable.foreach(Iterable.scala:56)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.processLine(SparkSQLCLIDriver.scala:490)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver$.main(SparkSQLCLIDriver.scala:282)\r\n\tat org.apache.spark.sql.hive.thriftserver.SparkSQLCLIDriver.main(SparkSQLCLIDriver.scala)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.spark.deploy.JavaMainApplication.start(SparkApplication.scala:52)\r\n\tat org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:936)\r\n\tat org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:180)\r\n\tat org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:203)\r\n\tat org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:90)\r\n\tat org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:1015)\r\n\tat org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:1024)\r\n\tat org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)\r\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Unable to fetch table iceberg_dummy_table. StorageDescriptor cannot be null for table: iceberg_dummy_table (Service: null; Status Code: 0; Error Code: null; Request ID: null; Proxy: null)\r\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getTable(Hive.java:1296)\r\n\tat org.apache.spark.sql.hive.client.HiveClientImpl.getRawTableOption(HiveClientImpl.scala:397)\r\n\tat org.apache.spark.sql.hive.client.HiveClientImpl.$anonfun$tableExists$1(HiveClientImpl.scala:411)\r\n\tat scala.runtime.java8.JFunction0$mcZ$sp.apply(JFunction0$mcZ$sp.java:23)\r\n\tat org.apache.spark.sql.hive.client.HiveClientImpl.$anonfun$withHiveState$1(HiveClientImpl.scala:294)\r\n\tat org.apache.spark.sql.hive.client.HiveClientImpl.liftedTree1$1(HiveClientImpl.scala:227)\r\n\tat org.apache.spark.sql.hive.client.HiveClientImpl.retryLocked(HiveClientImpl.scala:226)\r\n\tat org.apache.spark.sql.hive.client.HiveClientImpl.withHiveState(HiveClientImpl.scala:276)\r\n\tat org.apache.spark.sql.hive.client.HiveClientImpl.tableExists(HiveClientImpl.scala:411)\r\n\tat org.apache.spark.sql.hive.HiveExternalCatalog.$anonfun$tableExists$1(HiveExternalCatalog.scala:855)\r\n\tat scala.runtime.java8.JFunction0$mcZ$sp.apply(JFunction0$mcZ$sp.java:23)\r\n\tat org.apache.spark.sql.hive.HiveExternalCatalog.withClient(HiveExternalCatalog.scala:103)\r\n\t... 90 more\r\nCaused by: InvalidObjectException(message:StorageDescriptor cannot be null for table: iceberg_dummy_table (Service: null; Status Code: 0; Error Code: null; Request ID: null; Proxy: null))\r\n\tat com.amazonaws.glue.catalog.converters.BaseCatalogToHiveConverter$5.get(BaseCatalogToHiveConverter.java:51)\r\n\tat com.amazonaws.glue.catalog.converters.BaseCatalogToHiveConverter.getHiveException(BaseCatalogToHiveConverter.java:90)\r\n\tat com.amazonaws.glue.catalog.converters.BaseCatalogToHiveConverter.wrapInHiveException(BaseCatalogToHiveConverter.java:81)\r\n\tat com.amazonaws.glue.catalog.metastore.GlueMetastoreClientDelegate.getTable(GlueMetastoreClientDelegate.java:430)\r\n\tat com.amazonaws.glue.catalog.metastore.AWSCatalogMetastoreClient.getTable(AWSCatalogMetastoreClient.java:1008)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient$SynchronizedHandler.invoke(HiveMetaStoreClient.java:2364)\r\n\tat com.sun.proxy.$Proxy37.getTable(Unknown Source)\r\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getTable(Hive.java:1288)\r\n\t... 101 more\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786301938/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786312470","html_url":"https://github.com/apache/iceberg/pull/2255#issuecomment-786312470","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2255","id":786312470,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjMxMjQ3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-25T23:59:13Z","updated_at":"2021-02-25T23:59:13Z","author_association":"CONTRIBUTOR","body":"> Having options in the Action directly. That seems simpler than having ConfigurableAction.\r\n\r\n+1\r\n\r\n> Accepting Strings instead of Tables in all actions so that each action loads the table.\r\n\r\nI actually like that some accept a `Table`. I'm trying to think of a better way to structure the ones that take strings. I agree with the idea that it is easier to use that way, but the problem is that we need a way to parse the string into an identifier and to load a catalog. Maybe we should have a version that accepts a catalog and an identifier? I'm not sure what to do here.\r\n\r\n> Shall we make action results closeable?\r\n\r\nLet's skip it for now if we don't need it.\r\n\r\n> Using with prefix for some method names. I'd say let's not use it to be consistent.\r\n\r\n+1 for fewer words.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786312470/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786313768","html_url":"https://github.com/apache/iceberg/issues/757#issuecomment-786313768","issue_url":"https://api.github.com/repos/apache/iceberg/issues/757","id":786313768,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjMxMzc2OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T00:02:32Z","updated_at":"2021-02-26T00:02:47Z","author_association":"MEMBER","body":"I was just reminded of this yesterday when I saw someone attempting to count all the rows in their partitions using a full table scan, we should really doc all of these, I probably will if I have some time but this would be a GREAT ticket for anyone who wants to do a first time contribution :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786313768/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786322311","html_url":"https://github.com/apache/iceberg/pull/2255#issuecomment-786322311","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2255","id":786322311,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjMyMjMxMQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T00:25:08Z","updated_at":"2021-02-26T00:34:12Z","author_association":"CONTRIBUTOR","body":">  I'm trying to think of a better way to structure the ones that take strings. I agree with the idea that it is easier to use that way, but the problem is that we need a way to parse the string into an identifier and to load a catalog...\r\n\r\nThat's the part I am not sure about. I considered using Iceberg's table identifier but it is in the `catalog` package, which makes it weird. Plus, one identifier will point to a non-Iceberg table. Apart from that, only implementations will parse identifiers and the syntax could (?) actually vary from engine to engine. It is unlikely we can make catalog loading and identifier parsing generic.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786322311/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786330715","html_url":"https://github.com/apache/iceberg/pull/2257#issuecomment-786330715","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2257","id":786330715,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjMzMDcxNQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T00:48:33Z","updated_at":"2021-02-26T00:48:33Z","author_association":"CONTRIBUTOR","body":"Sorry, I won't get to this one today. I'll review it tomorrow.\r\n\r\ncc @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786330715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786338505","html_url":"https://github.com/apache/iceberg/issues/2270#issuecomment-786338505","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2270","id":786338505,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjMzODUwNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T01:10:06Z","updated_at":"2021-02-26T01:10:06Z","author_association":"CONTRIBUTOR","body":"This sounds useful, kind of like the `site` configuration in Hadoop. I like Russell's idea to do this at the catalog level, but I'm already a little worried that catalog configuration is going to end up being quite large and difficult to maintain across Flink, Spark, Hive, and others since each has a separate way to configure catalogs.\r\n\r\nWould we actually set these values in tables or would we just change the default so that precedence is table config, then administrator config, then hard-coded defaults?\r\n\r\nWhere should we put the administrator config?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786338505/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786341170","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-786341170","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":786341170,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM0MTE3MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T01:17:12Z","updated_at":"2021-02-26T01:17:12Z","author_association":"CONTRIBUTOR","body":"I don't think I would approach the problem as @aokolnychyi is suggesting. I thought that this would promote when accessing the metrics. So basically `MetricsConfig.fromProperties` becomes `MetricsConfig.forTable` so that it can be based on both the properties and the sort order for a table. I think that would be a reasonably small change.\r\n\r\nThe advantage of that approach is that the sort order doesn't make changes to table properties. Those are always configured by users.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786341170/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786344598","html_url":"https://github.com/apache/iceberg/issues/2270#issuecomment-786344598","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2270","id":786344598,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM0NDU5OA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T01:24:59Z","updated_at":"2021-02-26T01:25:28Z","author_association":"CONTRIBUTOR","body":"In the [example](https://github.com/apache/iceberg/issues/2270#issuecomment-786255694) above, I'd imagine Spark would load defaults from the session config, combine it with properties provided in the create table statement and pass to the catalog implementation. Meaning we would get a map with `k1 -> v1` (comes from the session conf) and `k2 -> custom_value` (comes from the statement directly), which will be persistent in the metadata.\r\n\r\nThe idea of not persisting props and simply overriding at runtime seems interesting but it will be way harder to implement, I guess.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786344598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786351720","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-786351720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":786351720,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM1MTcyMA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T01:45:31Z","updated_at":"2021-02-26T03:16:42Z","author_association":"CONTRIBUTOR","body":"> So basically MetricsConfig.fromProperties becomes MetricsConfig.forTable so that it can be based on both the properties and the sort order for a table.\r\n\r\nThe problem is that we build `MetricsConfig` in places where we don't have access to the table object. We made a recent change to make `BaseTable` serializable but we would need to modify quite some places to pass it around. Also, I am not sure about a potential performance penalty. We do serialize things like spec and props so maybe it won't be a big deal to serialize the complete table object but someone has to test that. We could pass the sort order around but it anyway seemed like a major work to redo that in all places. Plus, it is easy to miss something. For example, the current change does not capture Flink and our import code in `SparkTableUtil` but all tests are green.\r\n\r\n> The advantage of that approach is that the sort order doesn't make changes to table properties. Those are always configured by users.\r\n\r\nI think having something like `toTableProperties` on `MetricsConfig` will make it possible to migrate to column ids instead of names in the future. If we want to use column ids, then modifying table props seems inevitable to me.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786351720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786355684","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-786355684","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":786355684,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM1NTY4NA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T01:57:38Z","updated_at":"2021-02-26T01:57:57Z","author_association":"CONTRIBUTOR","body":"But I do get the concern of modifying table properties. However, it looks there will be a few places where will need to do that anyway (e.g. schema evolution). ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786355684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786371177","html_url":"https://github.com/apache/iceberg/pull/2265#issuecomment-786371177","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2265","id":786371177,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM3MTE3Nw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T02:41:47Z","updated_at":"2021-02-26T02:41:47Z","author_association":"CONTRIBUTOR","body":"> @zhangjun0x01, can you update the description to include what you're changing in Iceberg and why it should be done that way? I'm surprised to see changes to types in the API module so I think this warrants a clear description of why that's needed. It is really helpful to provide context for reviewers. Thanks!\r\n\r\n @rdblue I udpated the description.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786371177/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786378195","html_url":"https://github.com/apache/iceberg/issues/2244#issuecomment-786378195","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2244","id":786378195,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM3ODE5NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T03:03:15Z","updated_at":"2021-02-26T03:03:15Z","author_association":"MEMBER","body":"We decided in the last Sync that a reasonable solution here would be for Spark to read both timezone types as timestamp with timezone with a flag disabling this behavior by default. If the flag is disabled an error message would alert the user that Spark cannot handle the two different types and will always display the local timezone, but the underlying data would be correct.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786378195/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786379497","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-786379497","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":786379497,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM3OTQ5Nw==","user":{"login":"bkahloon","id":42993708,"node_id":"MDQ6VXNlcjQyOTkzNzA4","avatar_url":"https://avatars.githubusercontent.com/u/42993708?v=4","gravatar_id":"","url":"https://api.github.com/users/bkahloon","html_url":"https://github.com/bkahloon","followers_url":"https://api.github.com/users/bkahloon/followers","following_url":"https://api.github.com/users/bkahloon/following{/other_user}","gists_url":"https://api.github.com/users/bkahloon/gists{/gist_id}","starred_url":"https://api.github.com/users/bkahloon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkahloon/subscriptions","organizations_url":"https://api.github.com/users/bkahloon/orgs","repos_url":"https://api.github.com/users/bkahloon/repos","events_url":"https://api.github.com/users/bkahloon/events{/privacy}","received_events_url":"https://api.github.com/users/bkahloon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T03:07:13Z","updated_at":"2021-02-26T03:07:13Z","author_association":"CONTRIBUTOR","body":"@RussellSpitzer was able to help me resolve this.  I was issuing the spark sql query incorrectly.\r\n\r\n```\r\nSELECT * FROM my_catalog.iceberg_warehouse.iceberg_dummy_table\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786379497/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786379866","html_url":"https://github.com/apache/iceberg/issues/2202#issuecomment-786379866","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2202","id":786379866,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjM3OTg2Ng==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T03:08:24Z","updated_at":"2021-02-26T03:08:24Z","author_association":"MEMBER","body":"For future users, the issue here was that the spark catalog was configured as \"my_catalog\" but the tables were being referred to in the session catalog which was not replaced with the Iceberg Spark SessionCatalog class.\r\n\r\nThere are two solutions\r\n\r\nusing the tripart identifier \"catalogname.namespace.table\"\r\n\r\nor telling spark to use your catalog (whatever it's name is) by default\r\n\r\n\"use my_catalog\"","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786379866/reactions","total_count":5,"+1":5,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786405987","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-786405987","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":786405987,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjQwNTk4Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T04:39:14Z","updated_at":"2021-02-26T04:39:14Z","author_association":"MEMBER","body":"I'm having issues with writing to ORC tables from spark in our tests, probably a version conflict?\r\n\r\n```\r\nCaused by: java.lang.NoSuchMethodError: org.apache.orc.TypeDescription.createRowBatch()Lorg/apache/hadoop/hive/ql/exec/vector/VectorizedRowBatch;\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786405987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786442910","html_url":"https://github.com/apache/iceberg/issues/2274#issuecomment-786442910","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2274","id":786442910,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjQ0MjkxMA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T06:29:38Z","updated_at":"2021-02-26T06:29:38Z","author_association":"CONTRIBUTOR","body":"AFAIK Hive queries does not support HMS catalogs so I have only seen unit tests for them.\r\n\r\nShall I check the current status? What are the features we are looking for? Just one more level in the namespace hierarchy, or we are looking for sonething more?\r\n\r\nThanks, Peter ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786442910/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786480334","html_url":"https://github.com/apache/iceberg/pull/2273#issuecomment-786480334","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2273","id":786480334,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjQ4MDMzNA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T08:01:53Z","updated_at":"2021-02-26T08:01:53Z","author_association":"COLLABORATOR","body":"The `CompactionStrategy` looks great!  We have encountered a table with tens of millions of small files, the rewrite action takes days and fails eventually because of HDFS overhead. So I added an option to break down the grouped scan files into partitions and then execute the rewrite partition by partition.  With the `CompactionStrategy` we could tell the user to customize the rewrite strategy case by case.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786480334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786600794","html_url":"https://github.com/apache/iceberg/pull/2254#issuecomment-786600794","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2254","id":786600794,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjYwMDc5NA==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T11:51:29Z","updated_at":"2021-02-26T11:51:29Z","author_association":"CONTRIBUTOR","body":"Thanks @shardulm94 and @marton-bod for the review!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786600794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786639303","html_url":"https://github.com/apache/iceberg/issues/2277#issuecomment-786639303","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2277","id":786639303,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjYzOTMwMw==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T13:11:25Z","updated_at":"2021-02-26T13:11:25Z","author_association":"CONTRIBUTOR","body":"@allenzhg: What catalog do you try to do?\r\nThe valid values are:\r\n- `hive` - HiveCatalog\r\n- `hadoop` - HadoopCatalog\r\n\r\nWhere do you issue the table building statement? (Hive/Flink/Spark?)\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786639303/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786693696","html_url":"https://github.com/apache/iceberg/issues/2274#issuecomment-786693696","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2274","id":786693696,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjY5MzY5Ng==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T14:51:05Z","updated_at":"2021-02-26T14:51:05Z","author_association":"COLLABORATOR","body":"Hi Anton,\r\nI just checked the Hive master code and found no query language support for catalogs, only HMS API support. I tried from our iceberg-mr unit tests and got compilation errors when using `catalog_name.db_name.tbl_name` in create table or select statements. This might limit the utility of including this into the `HiveCatalog`, at least from the Hive side - not sure if it'd add more benefit to Spark or Flink. To echo Peter, is it an extra level of namespacing that you're primarily looking for?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786693696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786703516","html_url":"https://github.com/apache/iceberg/pull/2254#issuecomment-786703516","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2254","id":786703516,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjcwMzUxNg==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T15:07:17Z","updated_at":"2021-02-26T15:07:17Z","author_association":"CONTRIBUTOR","body":"@shardulm94, @marton-bod: Added the fix for timestamp.withZone in #2278 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786703516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786749149","html_url":"https://github.com/apache/iceberg/issues/2277#issuecomment-786749149","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2277","id":786749149,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Njc0OTE0OQ==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T16:25:10Z","updated_at":"2021-02-26T16:25:10Z","author_association":"COLLABORATOR","body":"@allenzhg Did you create the Iceberg table from Flink and then try to create a Hive table on top of it?\r\nYou might want to reference this documentation: https://iceberg.apache.org/hive/, under the `Using Hadoop Catalog` section. A couple of things stand out:\r\n- `'iceberg.mr.catalog'='hadoop_catalog'` is not a valid catalog value, as Peter pointed out. Can you retry with `'iceberg.mr.catalog'='hadoop'`?\r\n- According to the docs, the table name you specify to the Hive DDL must match the table name of the Iceberg table. In this case, it seems that the Iceberg table is called `sample1`, whereas you are trying to create a Hive table called `sample2` on top of it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786749149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786779145","html_url":"https://github.com/apache/iceberg/pull/2210#issuecomment-786779145","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2210","id":786779145,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Njc3OTE0NQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T17:17:10Z","updated_at":"2021-02-26T17:17:10Z","author_association":"MEMBER","body":"We have some strange classpath issues with ORC in our test classpath, to make things worse, when I attempt to debug the issue the debug console does not have the same issue and can call the missing method without issue.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786779145/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786781250","html_url":"https://github.com/apache/iceberg/issues/2274#issuecomment-786781250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2274","id":786781250,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Njc4MTI1MA==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T17:20:54Z","updated_at":"2021-02-26T17:20:54Z","author_association":"CONTRIBUTOR","body":"Thanks for checking the Hive side, @pvary @marton-bod. Yeah, I was primarily looking for adding an extra level of namespacing.\r\n\r\nWe have an internal metastore that implements the v3 protocol. That's why I was wondering if we ever plan to support catalogs in our `HiveCatalog` or we need to look for an alternative. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786781250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786781441","html_url":"https://github.com/apache/iceberg/issues/2274#issuecomment-786781441","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2274","id":786781441,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Njc4MTQ0MQ==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T17:21:17Z","updated_at":"2021-02-26T17:21:17Z","author_association":"CONTRIBUTOR","body":"FYI @raptond @karuppayya ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786781441/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786785988","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-786785988","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":786785988,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Njc4NTk4OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T17:29:31Z","updated_at":"2021-02-26T17:29:31Z","author_association":"CONTRIBUTOR","body":"My concern isn't modifying table properties specifically. We need to do that so that we update the properties to reflect the user's intent. If we have a setting for a column, renaming the property to carry it through a column rename is preserving the user's intent. But if we update table properties then we are potentially losing what the user chose to do.\r\n\r\nFor example, what do we do when the sort field is removed and there is a metrics config property? We can't remove a `truncate[16]` setting because we don't know whether it was added when the field was added to the sort, or if it was specifically set by the table owner. Similarly, we have cases where the owner may set a field to `counts` and then add it to the sort. I think that the table owner's config should take precedence. So we don't replace the property, but how then does the owner signal that it should be defaulted instead? Last, how do we handle tables that currently have sort orders? If we base metrics on the current sort order then everything starts working automatically. If we don't, then we would need to trigger a commit to update the properties.\r\n\r\nEven if we don't pass the table around, I think we should definitely pass the sort order in to get the metrics config. It is probably not the time to refactor and pass the table, but we can pass the sort order like we do the other table config.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786785988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786827216","html_url":"https://github.com/apache/iceberg/pull/2266#issuecomment-786827216","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2266","id":786827216,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjgyNzIxNg==","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T18:46:21Z","updated_at":"2021-02-26T18:46:21Z","author_association":"COLLABORATOR","body":"Thanks @rymurr  for the quick review, i will take a look next week at make the changes!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786827216/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786830890","html_url":"https://github.com/apache/iceberg/pull/2276#issuecomment-786830890","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2276","id":786830890,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjgzMDg5MA==","user":{"login":"sunchao","id":506679,"node_id":"MDQ6VXNlcjUwNjY3OQ==","avatar_url":"https://avatars.githubusercontent.com/u/506679?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchao","html_url":"https://github.com/sunchao","followers_url":"https://api.github.com/users/sunchao/followers","following_url":"https://api.github.com/users/sunchao/following{/other_user}","gists_url":"https://api.github.com/users/sunchao/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchao/subscriptions","organizations_url":"https://api.github.com/users/sunchao/orgs","repos_url":"https://api.github.com/users/sunchao/repos","events_url":"https://api.github.com/users/sunchao/events{/privacy}","received_events_url":"https://api.github.com/users/sunchao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T18:52:45Z","updated_at":"2021-02-26T18:52:45Z","author_association":"MEMBER","body":"I did something wrong with the split size configs - will fix and update this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786830890/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786855993","html_url":"https://github.com/apache/iceberg/pull/2240#issuecomment-786855993","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2240","id":786855993,"node_id":"MDEyOklzc3VlQ29tbWVudDc4Njg1NTk5Mw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-26T19:43:37Z","updated_at":"2021-02-26T19:43:37Z","author_association":"CONTRIBUTOR","body":"> For example, what do we do when the sort field is removed and there is a metrics config property?\r\n\r\nYeah, that's the point we won't be able to differentiate if we modified the props. I am convinced now.\r\nIf we have enough confidence that this feature will be useful, I am ok if we want to modify all places where we write.\r\n\r\nI took a look at how hard will it be to move to `Table` as that would simplify our life in the future. Since `BaseTable` uses a proxy for serializing, we only serialize `FileIO` and the metadata location. We will need to read the metadata file back on each executor. In addition, `FileIO` may contain a full Hadoop conf. That's why we broadcast `FileIO` and `EncryptionManager` in Spark. We could consider broadcasting `Table` instead of `FileIO` and `EncryptionManager`. However, we will still have to read the metadata file from each executor. Is that a big deal?\r\n\r\nI am fine either way.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/786855993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]