[{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436002554","html_url":"https://github.com/apache/couchdb/issues/1713#issuecomment-436002554","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1713","id":436002554,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjAwMjU1NA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-05T19:24:04Z","updated_at":"2018-11-05T19:24:04Z","author_association":"MEMBER","body":"@eiri Agree, the alarm notices are harmless, they show up once in the logfile and then are done.\r\n\r\nIf the compaction daemon is running fine, there's no need for any workaround in my opinion.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436002554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436174906","html_url":"https://github.com/apache/couchdb/issues/1712#issuecomment-436174906","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1712","id":436174906,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjE3NDkwNg==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-06T08:48:06Z","updated_at":"2018-11-06T08:48:06Z","author_association":"NONE","body":"@wohali in my local CouchDB settings cluster I have \r\n\r\ncluster\r\nn | 3 | Â \r\nq | 8\r\n\r\nSo by checking the docs I see I have a 3 node cluster, right?\r\nT\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436174906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436199916","html_url":"https://github.com/apache/couchdb/pull/1709#issuecomment-436199916","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1709","id":436199916,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjE5OTkxNg==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-06T10:11:06Z","updated_at":"2018-11-06T10:11:06Z","author_association":"MEMBER","body":"+1. Nice work.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436199916/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436241078","html_url":"https://github.com/apache/couchdb/issues/1715#issuecomment-436241078","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1715","id":436241078,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjI0MTA3OA==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-06T12:49:20Z","updated_at":"2018-11-06T12:49:20Z","author_association":"CONTRIBUTOR","body":"Additional debugging info for the case. \r\n```\r\ndiff --git a/.travis.yml b/.travis.yml\r\nindex 01b2862a3..89e21baf2 100644\r\n--- a/.travis.yml\r\n+++ b/.travis.yml\r\n@@ -49,6 +49,7 @@ env:\r\n\r\n # Then comment this section out\r\n before_script:\r\n+  - ulimit -a\r\n   - rm -rf /tmp/couchjslogs\r\n   - mkdir -p /tmp/couchjslogs\r\n   - ./configure -c --disable-docs --disable-fauxton\r\ndiff --git a/Makefile b/Makefile\r\nindex 0ab7b4eed..09757fe2c 100644\r\n--- a/Makefile\r\n+++ b/Makefile\r\n@@ -149,6 +149,7 @@ check: all\r\n eunit: export BUILDDIR = $(shell pwd)\r\n eunit: export ERL_AFLAGS = -config $(shell pwd)/rel/files/eunit.config\r\n eunit: couch\r\n+       @ulimit -a && exit 1\r\n        @$(REBAR) setup_eunit 2> /dev/null\r\n        @$(REBAR) -r eunit $(EUNIT_OPTS)\r\n```\r\n\r\nhttps://travis-ci.org/apache/couchdb/jobs/451351684\r\n\r\n# before_script\r\n```\r\ncore file size          (blocks, -c) unlimited\r\ndata seg size           (kbytes, -d) unlimited\r\nscheduling priority             (-e) 0\r\nfile size               (blocks, -f) unlimited\r\npending signals                 (-i) 241238\r\nmax locked memory       (kbytes, -l) 64\r\nmax memory size         (kbytes, -m) unlimited\r\nopen files                      (-n) 30000\r\npipe size            (512 bytes, -p) 8\r\nPOSIX message queues     (bytes, -q) 819200\r\nreal-time priority              (-r) 0\r\nstack size              (kbytes, -s) 8192\r\ncpu time               (seconds, -t) unlimited\r\nmax user processes              (-u) unlimited\r\nvirtual memory          (kbytes, -v) unlimited\r\nfile locks                      (-x) unlimited\r\n```\r\n\r\n# eunit\r\n```\r\ntime(seconds)        unlimited\r\nfile(blocks)         unlimited\r\ndata(kbytes)         unlimited\r\nstack(kbytes)        unlimited\r\ncoredump(blocks)     unlimited\r\nmemory(kbytes)       unlimited\r\nlocked memory(kbytes) 64\r\nprocess              unlimited\r\nnofiles              30000\r\nvmemory(kbytes)      unlimited\r\nlocks                unlimited\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436241078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436247039","html_url":"https://github.com/apache/couchdb/issues/1715#issuecomment-436247039","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1715","id":436247039,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjI0NzAzOQ==","user":{"login":"iilyak","id":9804420,"node_id":"MDQ6VXNlcjk4MDQ0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/9804420?v=4","gravatar_id":"","url":"https://api.github.com/users/iilyak","html_url":"https://github.com/iilyak","followers_url":"https://api.github.com/users/iilyak/followers","following_url":"https://api.github.com/users/iilyak/following{/other_user}","gists_url":"https://api.github.com/users/iilyak/gists{/gist_id}","starred_url":"https://api.github.com/users/iilyak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iilyak/subscriptions","organizations_url":"https://api.github.com/users/iilyak/orgs","repos_url":"https://api.github.com/users/iilyak/repos","events_url":"https://api.github.com/users/iilyak/events{/privacy}","received_events_url":"https://api.github.com/users/iilyak/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-06T13:10:25Z","updated_at":"2018-11-06T13:10:25Z","author_association":"CONTRIBUTOR","body":"I don't have any more ideas at the moment","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436247039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436334506","html_url":"https://github.com/apache/couchdb/issues/1712#issuecomment-436334506","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1712","id":436334506,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjMzNDUwNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-06T17:18:24Z","updated_at":"2018-11-06T17:18:37Z","author_association":"MEMBER","body":"@tudordumitriu That's not sufficient. Are you running a single server, or 3 servers?\r\n\r\nIf you do a `GET /dbname` for your database name, what does it show the `q` and `n` values set at?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436334506/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436544021","html_url":"https://github.com/apache/couchdb/issues/1712#issuecomment-436544021","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1712","id":436544021,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjU0NDAyMQ==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T08:29:17Z","updated_at":"2018-11-07T08:29:17Z","author_association":"NONE","body":"Hi\r\nI am getting\r\n\r\n{\r\ndb_name: \"userdb-61\",\r\nupdate_seq: \"13287-g1AAAAFreJzLYWBg4MhgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUoxJTIkyf___z8riYGB9REedUkKQDLJHqqUuRefUgeQ0niY0of4lCaAlNZDlbKY4VGaxwIkGRqAFFD1fJByNn2CyhdAlO8HK08iqPwARPl9kHIuPYLKH0CUg93OvSgLAJpEc00\",\r\nsizes: {\r\nfile: 6510167,\r\nexternal: 1266543,\r\nactive: 3097201\r\n},\r\npurge_seq: 0,\r\nother: {\r\ndata_size: 1266543\r\n},\r\ndoc_del_count: 1793,\r\ndoc_count: 308,\r\ndisk_size: 6510167,\r\ndisk_format_version: 6,\r\ndata_size: 3097201,\r\ncompact_running: false,\r\ncluster: {\r\nq: 8,\r\nn: 1,\r\nw: 1,\r\nr: 1\r\n},\r\ninstance_start_time: \"0\"\r\n}\r\n\r\nAnd as far as I remember when I installed it I selected single node.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436544021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436650664","html_url":"https://github.com/apache/couchdb/pull/1719#issuecomment-436650664","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1719","id":436650664,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY1MDY2NA==","user":{"login":"willholley","id":97787,"node_id":"MDQ6VXNlcjk3Nzg3","avatar_url":"https://avatars.githubusercontent.com/u/97787?v=4","gravatar_id":"","url":"https://api.github.com/users/willholley","html_url":"https://github.com/willholley","followers_url":"https://api.github.com/users/willholley/followers","following_url":"https://api.github.com/users/willholley/following{/other_user}","gists_url":"https://api.github.com/users/willholley/gists{/gist_id}","starred_url":"https://api.github.com/users/willholley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willholley/subscriptions","organizations_url":"https://api.github.com/users/willholley/orgs","repos_url":"https://api.github.com/users/willholley/repos","events_url":"https://api.github.com/users/willholley/events{/privacy}","received_events_url":"https://api.github.com/users/willholley/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T14:57:12Z","updated_at":"2018-11-07T14:57:12Z","author_association":"MEMBER","body":"I'd like to see a test that compares the results of a $not selector with and without an index, since that was the issue that triggered investigation into this. Adding the index should not change the result set. Otherwise, the solution looks good to me.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436650664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436656084","html_url":"https://github.com/apache/couchdb/issues/1720#issuecomment-436656084","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1720","id":436656084,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY1NjA4NA==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T15:11:55Z","updated_at":"2018-11-07T15:11:55Z","author_association":"NONE","body":"_(note: obviously I can setup the main replication as a push replication from the central server to the users db one to work around current behaviour, I know that, but the basic feature request remain...)_","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436656084/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436666222","html_url":"https://github.com/apache/couchdb/pull/1718#issuecomment-436666222","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1718","id":436666222,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY2NjIyMg==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T15:39:15Z","updated_at":"2018-11-07T15:39:15Z","author_association":"MEMBER","body":"It seems like rather than adding a second pass we should just modify this clause:\r\n\r\nhttps://github.com/apache/couchdb/blob/master/src/mango/src/mango_selector.erl#L636\r\n\r\nThere we can just do a lists:member tests and if the exists:false field is present we just return false from that test and reject the index.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436666222/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436692179","html_url":"https://github.com/apache/couchdb/pull/1146#issuecomment-436692179","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1146","id":436692179,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY5MjE3OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T16:45:30Z","updated_at":"2018-11-07T16:45:30Z","author_association":"MEMBER","body":"Hi @abc3, I'm going through and closing out old PRs. We'd still love to have this submitted, but I'm going to close this PR for now.\r\n\r\nWhen a module version of this is available, we'd be more than happy to accept your PR.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436692179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436692987","html_url":"https://github.com/apache/couchdb/pull/1182#issuecomment-436692987","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1182","id":436692987,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY5Mjk4Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T16:47:32Z","updated_at":"2018-11-07T16:47:32Z","author_association":"MEMBER","body":"Let's try to get this into 2.3.0. That means you need to resolve the conflicts @obi458 and we need another review from @davisp .","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436692987/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436693355","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-436693355","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":436693355,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY5MzM1NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T16:48:33Z","updated_at":"2018-11-07T16:48:33Z","author_association":"MEMBER","body":"@AlexanderKaraberov Can you resolve the conflicts on this PR please?\r\n\r\n@garrensmith do you think you could review this PR please?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436693355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436694360","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-436694360","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":436694360,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY5NDM2MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T16:51:15Z","updated_at":"2018-11-07T16:51:15Z","author_association":"MEMBER","body":"@eiri any luck on this one or have you given up?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436694360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436694633","html_url":"https://github.com/apache/couchdb/pull/1718#issuecomment-436694633","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1718","id":436694633,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY5NDYzMw==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T16:52:02Z","updated_at":"2018-11-07T16:52:02Z","author_association":"MEMBER","body":"Cool. I did think of doing that. It requires passing in another list of all the fields in the index because we can get a situation where there would be two checks on a field. So the first check might pass and remove the field from the required field list and then if we did a `lists:member` check for the `$exists: false` then it wouldn't find it in the `RequiredFields`. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436694633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436695697","html_url":"https://github.com/apache/couchdb/pull/1405#issuecomment-436695697","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1405","id":436695697,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY5NTY5Nw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T16:55:02Z","updated_at":"2018-11-07T16:55:02Z","author_association":"MEMBER","body":"@nickva That mochiweb fix has landed.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436695697/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436698198","html_url":"https://github.com/apache/couchdb/pull/1443#issuecomment-436698198","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1443","id":436698198,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY5ODE5OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:01:42Z","updated_at":"2018-11-07T17:01:42Z","author_association":"MEMBER","body":"@janl here's the problem:\r\n\r\n```\r\nmodule 'couch_replicator_create_target_with_options_tests'\r\n  Create target with range partitions tests\r\n    undefined\r\n    *** instantiation of subtests failed ***\r\n**in function couch_replicator_create_target_with_options_tests:should_create_target_with_q_4/1 (test/couch_replicator_create_target_with_options_tests.erl, line 61)\r\n**error:{badmatch,{error,{db_not_found,<<\"could not open http://127.0.0.1:41783/eunit-test-db-\"...>>}}}\r\n```\r\n\r\nMaybe something's wrong with `PUT /db` when you specify `?q=#&n=#`?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436698198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436698963","html_url":"https://github.com/apache/couchdb/pull/1608#issuecomment-436698963","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1608","id":436698963,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY5ODk2Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:03:53Z","updated_at":"2018-11-07T17:03:53Z","author_association":"MEMBER","body":"@abbyad Thank you for your first time contribution to Apache CouchDB!! :confetti_ball: :cocktail: ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436698963/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436699189","html_url":"https://github.com/apache/couchdb/pull/1616#issuecomment-436699189","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1616","id":436699189,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjY5OTE4OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:04:31Z","updated_at":"2018-11-07T17:04:31Z","author_association":"MEMBER","body":"Will hold this until after 2.3.0 releases.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436699189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436700234","html_url":"https://github.com/apache/couchdb/pull/1638#issuecomment-436700234","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1638","id":436700234,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcwMDIzNA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:07:23Z","updated_at":"2018-11-07T17:07:23Z","author_association":"MEMBER","body":"@dch I'd like to see this land at the same time with us supporting binding only to IPv6 addresses, and there being sufficient test suites to validate, though this may require running `make check` on a IPv6-enabled host.\r\n\r\nBut that's just a wish, you're the one doing the work :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436700234/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436700895","html_url":"https://github.com/apache/couchdb/pull/1658#issuecomment-436700895","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1658","id":436700895,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcwMDg5NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:09:12Z","updated_at":"2018-11-07T17:09:12Z","author_association":"MEMBER","body":"@kocolosk any progress on the test suite? Also, is there any need for #1337 to land for this to function?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436700895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436702895","html_url":"https://github.com/apache/couchdb/pull/1680#issuecomment-436702895","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1680","id":436702895,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcwMjg5NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:14:44Z","updated_at":"2018-11-07T17:14:44Z","author_association":"MEMBER","body":"PR merged, this is ready to go.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436702895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436703613","html_url":"https://github.com/apache/couchdb/pull/1717#issuecomment-436703613","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1717","id":436703613,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcwMzYxMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:16:43Z","updated_at":"2018-11-07T17:16:43Z","author_association":"MEMBER","body":"Your tests are failing.\r\n\r\nDoes this impact what happens if I do something like:\r\n\r\n```\r\ncurl -X PUT localhost:15984/_node/_local/_config/admins/joan -d '500'\r\n```\r\n\r\ni.e., an invalid body?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436703613/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436703653","html_url":"https://github.com/apache/couchdb/pull/1405#issuecomment-436703653","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1405","id":436703653,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcwMzY1Mw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:16:49Z","updated_at":"2018-11-07T17:16:49Z","author_association":"CONTRIBUTOR","body":"And we already depend on it:\r\n\r\nhttps://github.com/apache/couchdb-mochiweb/releases/tag/CouchDB-v2.18.0-1\r\n\r\nClosing this issue","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436703653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436705702","html_url":"https://github.com/apache/couchdb/issues/1632#issuecomment-436705702","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1632","id":436705702,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcwNTcwMg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:22:39Z","updated_at":"2018-11-07T17:22:39Z","author_association":"MEMBER","body":"Jenkins is working now - despite this issue - thanks to working around at the VM level.\r\n\r\nWe still want to get the Python 2/3 thing sorted out.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436705702/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436708178","html_url":"https://github.com/apache/couchdb/issues/1579#issuecomment-436708178","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1579","id":436708178,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcwODE3OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:29:54Z","updated_at":"2018-11-07T17:29:54Z","author_association":"MEMBER","body":"@regner Can you confirm that your upgrade was from 2.1.0 to 2.2.0 and that the problems only started happening with 2.2.0?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436708178/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436711148","html_url":"https://github.com/apache/couchdb/pull/806#issuecomment-436711148","issue_url":"https://api.github.com/repos/apache/couchdb/issues/806","id":436711148,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcxMTE0OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:38:29Z","updated_at":"2018-11-07T17:38:29Z","author_association":"MEMBER","body":"```\r\n12:37 <+davisp> Wohali: Not dead but you can close it. Maybe add a \"revisit when there's\r\n                time\" sort of label if we have one?\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436711148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436713738","html_url":"https://github.com/apache/couchdb/issues/1226#issuecomment-436713738","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1226","id":436713738,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcxMzczOA==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T17:46:17Z","updated_at":"2018-11-07T17:46:17Z","author_association":"MEMBER","body":"Hey @wohali thank you for the remainder, it totally slipped my mind!\r\n\r\nYeah, I had a discussion about this with @chewbranca some time ago and he was rather dismissive of the work on #1237 expressing strong believe that the approach there is invalid. I don't have a better idea on how to go about views' etags and I don't see any value on continuing with something that'd face pushback, so I gave up.\r\n\r\nI'll close the both issues.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436713738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436721428","html_url":"https://github.com/apache/couchdb/issues/1604#issuecomment-436721428","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1604","id":436721428,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcyMTQyOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T18:08:53Z","updated_at":"2018-11-07T18:08:53Z","author_association":"MEMBER","body":"I've decided to just have moving `_security` over be the very last operation, after replication is done. A server admin can remove or alter `_security` if they need to after the fact.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436721428/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436729906","html_url":"https://github.com/apache/couchdb/pull/1658#issuecomment-436729906","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1658","id":436729906,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjcyOTkwNg==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T18:33:07Z","updated_at":"2018-11-07T18:33:21Z","author_association":"MEMBER","body":"Yes, 6f35073 added some tests. Could do more but I think I'd need to figure out how to mock internal replication.\r\n\r\nNo, #1337 is an independent thought. Both can coexist. Of the two I would personally consider this one to be a higher priority for production automation and operations.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436729906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436743035","html_url":"https://github.com/apache/couchdb/pull/1237#issuecomment-436743035","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1237","id":436743035,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc0MzAzNQ==","user":{"login":"benel","id":597307,"node_id":"MDQ6VXNlcjU5NzMwNw==","avatar_url":"https://avatars.githubusercontent.com/u/597307?v=4","gravatar_id":"","url":"https://api.github.com/users/benel","html_url":"https://github.com/benel","followers_url":"https://api.github.com/users/benel/followers","following_url":"https://api.github.com/users/benel/following{/other_user}","gists_url":"https://api.github.com/users/benel/gists{/gist_id}","starred_url":"https://api.github.com/users/benel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benel/subscriptions","organizations_url":"https://api.github.com/users/benel/orgs","repos_url":"https://api.github.com/users/benel/repos","events_url":"https://api.github.com/users/benel/events{/privacy}","received_events_url":"https://api.github.com/users/benel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T19:13:27Z","updated_at":"2018-11-07T19:13:27Z","author_association":"NONE","body":"Will it be merged?\r\nRegards and thx for the work done.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436743035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436754715","html_url":"https://github.com/apache/couchdb/issues/1008#issuecomment-436754715","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1008","id":436754715,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc1NDcxNQ==","user":{"login":"sklassen","id":6997477,"node_id":"MDQ6VXNlcjY5OTc0Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/6997477?v=4","gravatar_id":"","url":"https://api.github.com/users/sklassen","html_url":"https://github.com/sklassen","followers_url":"https://api.github.com/users/sklassen/followers","following_url":"https://api.github.com/users/sklassen/following{/other_user}","gists_url":"https://api.github.com/users/sklassen/gists{/gist_id}","starred_url":"https://api.github.com/users/sklassen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sklassen/subscriptions","organizations_url":"https://api.github.com/users/sklassen/orgs","repos_url":"https://api.github.com/users/sklassen/repos","events_url":"https://api.github.com/users/sklassen/events{/privacy}","received_events_url":"https://api.github.com/users/sklassen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T19:50:11Z","updated_at":"2018-11-07T19:50:11Z","author_association":"CONTRIBUTOR","body":"Hi @janl , @wohali , @davisp \r\n\r\nI have created a test suite that generates the timeout mentioned above. \r\n\r\nhttps://github.com/sklassen/couchapp-erlang-example.git\r\n\r\nThere is a python script that generates a large number of (fairly big) documents. There is a javascript and erlang version of each view. Try the script with 5 documents to see it function. Then try 500 and you should see a timeouts on the erlang view. The javascript view can may crash too, restarting the server. \r\n\r\nI last ran it on Couchdb 2.2, on ubuntu 18.04 from the  http://apache.bintray.com/couchdb-deb bionic package. I ran it on a NUC 7i with 4 cores and 15G of memory (n=1,q=8). I've also seen it on (n=1,q=1) and over three NUCs (n=3,q=8). The same erlang views ran on 1.6x without issue.\r\n\r\nPerhaphs there is a configurable timeout that needs tweaking?\r\n\r\n \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436754715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436767606","html_url":"https://github.com/apache/couchdb/pull/1680#issuecomment-436767606","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1680","id":436767606,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc2NzYwNg==","user":{"login":"lag-linaro","id":613036,"node_id":"MDQ6VXNlcjYxMzAzNg==","avatar_url":"https://avatars.githubusercontent.com/u/613036?v=4","gravatar_id":"","url":"https://api.github.com/users/lag-linaro","html_url":"https://github.com/lag-linaro","followers_url":"https://api.github.com/users/lag-linaro/followers","following_url":"https://api.github.com/users/lag-linaro/following{/other_user}","gists_url":"https://api.github.com/users/lag-linaro/gists{/gist_id}","starred_url":"https://api.github.com/users/lag-linaro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lag-linaro/subscriptions","organizations_url":"https://api.github.com/users/lag-linaro/orgs","repos_url":"https://api.github.com/users/lag-linaro/repos","events_url":"https://api.github.com/users/lag-linaro/events{/privacy}","received_events_url":"https://api.github.com/users/lag-linaro/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T20:33:58Z","updated_at":"2018-11-07T20:33:58Z","author_association":"CONTRIBUTOR","body":"You madam, are a star!  Thank you.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436767606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436771655","html_url":"https://github.com/apache/couchdb/pull/1237#issuecomment-436771655","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1237","id":436771655,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc3MTY1NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T20:47:59Z","updated_at":"2018-11-07T20:47:59Z","author_association":"MEMBER","body":"@benel No, see #1226.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436771655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436771931","html_url":"https://github.com/apache/couchdb/pull/1658#issuecomment-436771931","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1658","id":436771931,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc3MTkzMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T20:48:55Z","updated_at":"2018-11-07T20:48:55Z","author_association":"MEMBER","body":"@kocolosk thanks. Do you think you could submit a documentation PR for this new feature?\r\n\r\nAlso, you must update `default.ini` and/or `local.ini` under `etc/rel/overlay` before this PR lands. ;)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436771931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436780950","html_url":"https://github.com/apache/couchdb/pull/1721#issuecomment-436780950","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1721","id":436780950,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc4MDk1MA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T21:19:07Z","updated_at":"2018-11-07T21:19:07Z","author_association":"MEMBER","body":"+1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436780950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436788053","html_url":"https://github.com/apache/couchdb/pull/1658#issuecomment-436788053","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1658","id":436788053,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc4ODA1Mw==","user":{"login":"kocolosk","id":16679,"node_id":"MDQ6VXNlcjE2Njc5","avatar_url":"https://avatars.githubusercontent.com/u/16679?v=4","gravatar_id":"","url":"https://api.github.com/users/kocolosk","html_url":"https://github.com/kocolosk","followers_url":"https://api.github.com/users/kocolosk/followers","following_url":"https://api.github.com/users/kocolosk/following{/other_user}","gists_url":"https://api.github.com/users/kocolosk/gists{/gist_id}","starred_url":"https://api.github.com/users/kocolosk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kocolosk/subscriptions","organizations_url":"https://api.github.com/users/kocolosk/orgs","repos_url":"https://api.github.com/users/kocolosk/repos","events_url":"https://api.github.com/users/kocolosk/events{/privacy}","received_events_url":"https://api.github.com/users/kocolosk/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T21:43:16Z","updated_at":"2018-11-07T21:43:16Z","author_association":"MEMBER","body":"I already took care of the documentation PR -- submitted and approved: https://github.com/apache/couchdb-documentation/pull/339\r\n\r\nI will update the default config and address Nick's other comment, hopefully tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436788053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436789360","html_url":"https://github.com/apache/couchdb/issues/1579#issuecomment-436789360","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1579","id":436789360,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc4OTM2MA==","user":{"login":"regner","id":815037,"node_id":"MDQ6VXNlcjgxNTAzNw==","avatar_url":"https://avatars.githubusercontent.com/u/815037?v=4","gravatar_id":"","url":"https://api.github.com/users/regner","html_url":"https://github.com/regner","followers_url":"https://api.github.com/users/regner/followers","following_url":"https://api.github.com/users/regner/following{/other_user}","gists_url":"https://api.github.com/users/regner/gists{/gist_id}","starred_url":"https://api.github.com/users/regner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/regner/subscriptions","organizations_url":"https://api.github.com/users/regner/orgs","repos_url":"https://api.github.com/users/regner/repos","events_url":"https://api.github.com/users/regner/events{/privacy}","received_events_url":"https://api.github.com/users/regner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T21:47:42Z","updated_at":"2018-11-07T21:47:42Z","author_association":"NONE","body":"Will check git history of our puppet configs to get you the exact version numbers.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436789360/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436790140","html_url":"https://github.com/apache/couchdb/issues/1579#issuecomment-436790140","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1579","id":436790140,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc5MDE0MA==","user":{"login":"regner","id":815037,"node_id":"MDQ6VXNlcjgxNTAzNw==","avatar_url":"https://avatars.githubusercontent.com/u/815037?v=4","gravatar_id":"","url":"https://api.github.com/users/regner","html_url":"https://github.com/regner","followers_url":"https://api.github.com/users/regner/followers","following_url":"https://api.github.com/users/regner/following{/other_user}","gists_url":"https://api.github.com/users/regner/gists{/gist_id}","starred_url":"https://api.github.com/users/regner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/regner/subscriptions","organizations_url":"https://api.github.com/users/regner/orgs","repos_url":"https://api.github.com/users/regner/repos","events_url":"https://api.github.com/users/regner/events{/privacy}","received_events_url":"https://api.github.com/users/regner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T21:50:09Z","updated_at":"2018-11-07T21:50:09Z","author_association":"NONE","body":"We went from `2.1.1` to `2.2.0` so we did skip the `2.1.2` version.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436790140/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436805703","html_url":"https://github.com/apache/couchdb/pull/1406#issuecomment-436805703","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1406","id":436805703,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjgwNTcwMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T22:45:51Z","updated_at":"2018-11-07T22:45:51Z","author_association":"MEMBER","body":"@chewbranca @jaydoane I'm ready to merge this once tests have passed. Can you please resolve the conflict in `chttpd_misc.erl`?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436805703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436812313","html_url":"https://github.com/apache/couchdb/issues/1720#issuecomment-436812313","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1720","id":436812313,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjgxMjMxMw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-07T23:12:47Z","updated_at":"2018-11-07T23:12:47Z","author_association":"CONTRIBUTOR","body":"Another way to set this up is to make the replication a `normal` (non-continuous) replication. Normal replications have priority and unless an operator explicitly dials down `max_jobs` parameter or restarts a replication node (server).\r\n\r\nThe reason for this behavior is that traditionally (before the scheduling replicator was created) a `normal` replication replicates a snapshot of the database at particular time. So say you replicate from source S to target T. Then after the replication starts, you add a document do S. That document won't appear in T if replication is `normal`. If replication is `continuous` then it will. \r\n\r\nSo basically if you have a bunch of continuous replications but want to make one replication unstoppable, have your user code periodically create normal replications from source to target. Monitor when the replication finishes and re-create it.\r\n\r\nIn some cases it might even be helpful to use the `_replicate` endpoint which doesn't involve creating a replication document, which is ok if you create it and monitor it programmatically. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436812313/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436830355","html_url":"https://github.com/apache/couchdb/pull/1708#issuecomment-436830355","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1708","id":436830355,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjgzMDM1NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T00:38:06Z","updated_at":"2018-11-08T00:38:06Z","author_association":"MEMBER","body":"@Ryan-Gordon All done, and thanks again! :confetti_ball: ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436830355/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436830727","html_url":"https://github.com/apache/couchdb/issues/1705#issuecomment-436830727","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1705","id":436830727,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjgzMDcyNw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T00:39:52Z","updated_at":"2018-11-08T00:39:52Z","author_association":"MEMBER","body":"Closed by #1708!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436830727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436852403","html_url":"https://github.com/apache/couchdb/pull/1406#issuecomment-436852403","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1406","id":436852403,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjg1MjQwMw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T02:36:12Z","updated_at":"2018-11-08T02:36:12Z","author_association":"MEMBER","body":"Never mind, I'll fix it myself...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436852403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436865836","html_url":"https://github.com/apache/couchdb/pull/1717#issuecomment-436865836","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1717","id":436865836,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjg2NTgzNg==","user":{"login":"wenli200133","id":13113371,"node_id":"MDQ6VXNlcjEzMTEzMzcx","avatar_url":"https://avatars.githubusercontent.com/u/13113371?v=4","gravatar_id":"","url":"https://api.github.com/users/wenli200133","html_url":"https://github.com/wenli200133","followers_url":"https://api.github.com/users/wenli200133/followers","following_url":"https://api.github.com/users/wenli200133/following{/other_user}","gists_url":"https://api.github.com/users/wenli200133/gists{/gist_id}","starred_url":"https://api.github.com/users/wenli200133/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wenli200133/subscriptions","organizations_url":"https://api.github.com/users/wenli200133/orgs","repos_url":"https://api.github.com/users/wenli200133/repos","events_url":"https://api.github.com/users/wenli200133/events{/privacy}","received_events_url":"https://api.github.com/users/wenli200133/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T04:00:31Z","updated_at":"2018-11-08T04:00:31Z","author_association":"CONTRIBUTOR","body":"Hi @wohali , now checks have passed.\r\nI think `'500'` is invalid body, `\"500\"` is valid body.\r\nI have another PR for fixing this issue, https://github.com/apache/couchdb/pull/1717 and https://github.com/apache/couchdb-config/pull/21,  https://github.com/apache/couchdb/pull/1717 is dependent on https://github.com/apache/couchdb-config/pull/21.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436865836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436891391","html_url":"https://github.com/apache/couchdb/pull/1717#issuecomment-436891391","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1717","id":436891391,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjg5MTM5MQ==","user":{"login":"wenli200133","id":13113371,"node_id":"MDQ6VXNlcjEzMTEzMzcx","avatar_url":"https://avatars.githubusercontent.com/u/13113371?v=4","gravatar_id":"","url":"https://api.github.com/users/wenli200133","html_url":"https://github.com/wenli200133","followers_url":"https://api.github.com/users/wenli200133/followers","following_url":"https://api.github.com/users/wenli200133/following{/other_user}","gists_url":"https://api.github.com/users/wenli200133/gists{/gist_id}","starred_url":"https://api.github.com/users/wenli200133/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wenli200133/subscriptions","organizations_url":"https://api.github.com/users/wenli200133/orgs","repos_url":"https://api.github.com/users/wenli200133/repos","events_url":"https://api.github.com/users/wenli200133/events{/privacy}","received_events_url":"https://api.github.com/users/wenli200133/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T06:50:55Z","updated_at":"2018-11-08T06:50:55Z","author_association":"CONTRIBUTOR","body":"PR apache/couchdb-config#21 need first enter into the master, then #1717 can pick the updated config codes up.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/436891391/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437069687","html_url":"https://github.com/apache/couchdb/pull/1718#issuecomment-437069687","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1718","id":437069687,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzA2OTY4Nw==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T16:43:14Z","updated_at":"2018-11-08T16:43:14Z","author_association":"MEMBER","body":"You could also start with a second empty list and when one is found we move it from one to the other. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437069687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437071221","html_url":"https://github.com/apache/couchdb/issues/1493#issuecomment-437071221","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1493","id":437071221,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzA3MTIyMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T16:44:25Z","updated_at":"2018-11-08T16:44:25Z","author_association":"MEMBER","body":"This is now starting to show up in Jenkins.\r\n\r\nhttps://builds.apache.org/job/CouchDB/job/master/388/\r\n\r\nhttps://builds.apache.org/blue/organizations/jenkins/CouchDB/detail/master/384/pipeline\r\n  * this one is actually `ddoc_cache_remove_test: check_refresh_test_`\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437071221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437072339","html_url":"https://github.com/apache/couchdb/issues/1715#issuecomment-437072339","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1715","id":437072339,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzA3MjMzOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T16:47:16Z","updated_at":"2018-11-08T16:47:16Z","author_association":"MEMBER","body":"@iilyak See https://github.com/JuliaLang/julia/issues/9501 . Perhaps we are doing the same thing?\r\n\r\n>the original bug was in the test (redirecting stdout, but not reading from it to prevent kernel from blocking on more data)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437072339/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437072818","html_url":"https://github.com/apache/couchdb/issues/1715#issuecomment-437072818","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1715","id":437072818,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzA3MjgxOA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T16:48:36Z","updated_at":"2018-11-08T16:48:36Z","author_association":"MEMBER","body":"Also, at one point we were using the alternate form of virtualisation, but our tests took a lot longer to run.\r\n\r\nTravis apparently has more backpressure on the full-VM instances because they require more resources to run than the containers we use now. With such interest in running CouchDB in Docker, I think it's probably best if we look deeper and see if we can't find an actual root cause.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437072818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437077781","html_url":"https://github.com/apache/couchdb/issues/1679#issuecomment-437077781","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1679","id":437077781,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzA3Nzc4MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T17:02:33Z","updated_at":"2018-11-08T17:02:33Z","author_association":"MEMBER","body":"Closing until we get more information.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437077781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437078570","html_url":"https://github.com/apache/couchdb/issues/1712#issuecomment-437078570","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1712","id":437078570,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzA3ODU3MA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T17:04:46Z","updated_at":"2018-11-08T17:04:46Z","author_association":"MEMBER","body":"@tudordumitriu Could you please set your CouchDB to debug level logging in `local.ini`, reproduce this problem, and share with us an excerpt of the logfile from when this occurs? Thanks!\r\n\r\n```\r\n[log]\r\nlevel = debug\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437078570/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437082395","html_url":"https://github.com/apache/couchdb/issues/1704#issuecomment-437082395","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1704","id":437082395,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzA4MjM5NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T17:15:44Z","updated_at":"2018-11-08T17:15:44Z","author_association":"MEMBER","body":"@eiri now that Elixir tests have landed, maybe focus on porting this to Elixir so we can ditch the JS test suite ASAP? :) Unless you think there's an actual race condition here that needs addressing.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437082395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437084772","html_url":"https://github.com/apache/couchdb/issues/1704#issuecomment-437084772","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1704","id":437084772,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzA4NDc3Mg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-08T17:23:05Z","updated_at":"2018-11-08T17:23:05Z","author_association":"MEMBER","body":"@wohali I'm actually digging into it right now, had to work on something else for a first half of the week.\r\n\r\nThe elixir tests landing is a good news, though it'll take me some time to get up to the speed with them. My current plan is to confirm that this is more of the tests issue rather than a real corner case problem and if it's the former I'll switch to just porting it.\r\n\r\nI'll keep posting my progress on this thread.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437084772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437206064","html_url":"https://github.com/apache/couchdb/pull/1718#issuecomment-437206064","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1718","id":437206064,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzIwNjA2NA==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T00:26:49Z","updated_at":"2018-11-09T00:27:15Z","author_association":"CONTRIBUTOR","body":"Instead of having an extra list, perhaps you can convert `RequiredFields` to be a tuple list:\r\n[{\"field\", false}, {\"field1\", false}....]. Then instead of removing it, you tag it with `true`.\r\nWhen it see `$exists:false`, you tag it with `exists_field` or something and then that can't be changed if the field shows up again later on.\r\n\r\nAt the top, you just check for all `true`.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437206064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437263723","html_url":"https://github.com/apache/couchdb/pull/1718#issuecomment-437263723","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1718","id":437263723,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzI2MzcyMw==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T06:28:55Z","updated_at":"2018-11-09T06:28:55Z","author_association":"MEMBER","body":"Yes. Nice idea. Iâll change it to that.\n\n________________________________\nFrom: Tony Sun <notifications@github.com>\nSent: Friday, November 9, 2018 2:26:50 AM\nTo: apache/couchdb\nCc: garren smith; Author\nSubject: Re: [apache/couchdb] Perform explicit $exists:false on Index validation (#1718)\n\n\nInstead of having an extra list, perhaps you can convert RequiredFields to be a tuple list:\n[{\"field\", false}, {\"field1\", false}....]. Then instead of removing it, you tag it with true.\nWhen it see $exists:false, you tag it with exists_field or something and then that can't be changed if the field shows up again later on.\n\nâ\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub<https://github.com/apache/couchdb/pull/1718#issuecomment-437206064>, or mute the thread<https://github.com/notifications/unsubscribe-auth/AAK9AmrvpLGvqXOBc2gYLkX3cyTx-K_0ks5utMvKgaJpZM4YSEoK>.\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437263723/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437303960","html_url":"https://github.com/apache/couchdb/pull/1602#issuecomment-437303960","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1602","id":437303960,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzMwMzk2MA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T09:37:02Z","updated_at":"2018-11-09T09:37:02Z","author_association":"MEMBER","body":"> I'm +1 on removing runtime configurability but would prefer that the configuration is expressed in the .app files of the respective erlang applications. This will allow package maintainers (etc) to more easily tweak at build time if necessary without introducing the runtime malleability that concerns us.\r\n\r\n@rnewson latest push defines all http handlers in `couch.app`.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437303960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437304265","html_url":"https://github.com/apache/couchdb/pull/1602#issuecomment-437304265","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1602","id":437304265,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzMwNDI2NQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T09:38:16Z","updated_at":"2018-11-09T09:46:40Z","author_association":"MEMBER","body":"> also noting that changing couchjs stack size is an important ability.\r\n\r\nSince query servers can still be setup using env vars, the solution to this already exists:\r\n\r\n```\r\nexport COUCHDB_QUERY_SERVER_JAVASCRIPT=\"/path/to/couchjs /path/to/main.js -S STACK SIZE\"\r\ncouchdb\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437304265/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437317772","html_url":"https://github.com/apache/couchdb/pull/1602#issuecomment-437317772","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1602","id":437317772,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzMxNzc3Mg==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T10:29:31Z","updated_at":"2018-11-09T10:29:31Z","author_association":"MEMBER","body":"> @janl How is httpsd enabled in this new world? Previously that would have been:\r\n\r\n@wohali good one, Iâve made this analogous to the native query server:\r\n\r\n1. if the legacy config is found, it is treated as option 2. set to `true`\r\n2. now users can do `[ssl] enable = BOOL`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437317772/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437319020","html_url":"https://github.com/apache/couchdb/pull/1602#issuecomment-437319020","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1602","id":437319020,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzMxOTAyMA==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T10:34:34Z","updated_at":"2018-11-09T10:34:34Z","author_association":"MEMBER","body":"Pending any test issues and/or review notes, this is good to go now. Thanks everyone for the input!","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437319020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437343263","html_url":"https://github.com/apache/couchdb/issues/1712#issuecomment-437343263","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1712","id":437343263,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzM0MzI2Mw==","user":{"login":"tudordumitriu","id":4671554,"node_id":"MDQ6VXNlcjQ2NzE1NTQ=","avatar_url":"https://avatars.githubusercontent.com/u/4671554?v=4","gravatar_id":"","url":"https://api.github.com/users/tudordumitriu","html_url":"https://github.com/tudordumitriu","followers_url":"https://api.github.com/users/tudordumitriu/followers","following_url":"https://api.github.com/users/tudordumitriu/following{/other_user}","gists_url":"https://api.github.com/users/tudordumitriu/gists{/gist_id}","starred_url":"https://api.github.com/users/tudordumitriu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tudordumitriu/subscriptions","organizations_url":"https://api.github.com/users/tudordumitriu/orgs","repos_url":"https://api.github.com/users/tudordumitriu/repos","events_url":"https://api.github.com/users/tudordumitriu/events{/privacy}","received_events_url":"https://api.github.com/users/tudordumitriu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T12:17:40Z","updated_at":"2018-11-09T12:17:40Z","author_association":"NONE","body":"Here it is a clean log after enabling debug\r\nThis problem occurs randomly and by chance I just got over it again on a different doc\r\n[couch.log](https://github.com/apache/couchdb/files/2565771/couch.log)\r\n\r\nThank you","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437343263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437357434","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-437357434","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":437357434,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzM1NzQzNA==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T13:20:53Z","updated_at":"2018-11-09T13:20:53Z","author_association":"CONTRIBUTOR","body":"Hello @nickva \r\nOnce again thank you for a thorough review and your comments. I've addressed all the requested changes as well as fixed formatting style for the whole multipart case clause. All the commits squashed into one, and branch is rebased onto `master`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437357434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437400416","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-437400416","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":437400416,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzQwMDQxNg==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T15:47:19Z","updated_at":"2018-11-09T15:47:32Z","author_association":"CONTRIBUTOR","body":"Looks much better. Nice work cleaning it up.\r\n\r\nI see eunit test failures locally and in Travis. Not sure exactly why, maybe because of the name change of the function or maybe something on master changed?\r\n\r\nAlso see a minor comment about simplifying meck unloading.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437400416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437410621","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-437410621","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":437410621,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzQxMDYyMQ==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T16:17:09Z","updated_at":"2018-11-09T16:18:00Z","author_association":"CONTRIBUTOR","body":"Valid point. `meck:unload()` has been incorporated. As for failed test this failure is due to the fact `Options` list which is passed to the `fabric_doc_open_revs:go()` has to contain `user_ctx`. Fixed as well. Reran `chttpd` tests locally: `All 232 tests passed.`","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437410621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437421418","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-437421418","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":437421418,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzQyMTQxOA==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T16:50:48Z","updated_at":"2018-11-09T16:52:41Z","author_association":"CONTRIBUTOR","body":"@nickva I checked Travis logs and seemingly only one job `Job #6237.5` for OTP 17.5 failed for some odd reason. All other ones are successful as well as `chttpd` for the failed one. I've skimmed through the logs of this job and I do believe this error has nothing to do with my functionality. Perhaps some configs are wrong:\r\n```\r\n Failed: 0.  Skipped: 0.  Passed: 1004.\r\nOne or more tests were cancelled.\r\nERROR: One or more eunit tests failed.\r\nERROR: eunit failed while processing /home/travis/build/apache/couchdb/src/couch: rebar_abort\r\nmake[1]: *** [eunit] Error 1\r\nmake[1]: Leaving directory `/home/travis/build/apache/couchdb'\r\nmake: *** [check] Error 2\r\nThe command \"make check\" exited with 2.\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437421418/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437435048","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-437435048","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":437435048,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzQzNTA0OA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T17:33:12Z","updated_at":"2018-11-09T17:33:12Z","author_association":"CONTRIBUTOR","body":"Ah it's probably flaky, I'll try to restart it","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437435048/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437447396","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-437447396","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":437447396,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzQ0NzM5Ng==","user":{"login":"AlexanderKaraberov","id":3254818,"node_id":"MDQ6VXNlcjMyNTQ4MTg=","avatar_url":"https://avatars.githubusercontent.com/u/3254818?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexanderKaraberov","html_url":"https://github.com/AlexanderKaraberov","followers_url":"https://api.github.com/users/AlexanderKaraberov/followers","following_url":"https://api.github.com/users/AlexanderKaraberov/following{/other_user}","gists_url":"https://api.github.com/users/AlexanderKaraberov/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexanderKaraberov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexanderKaraberov/subscriptions","organizations_url":"https://api.github.com/users/AlexanderKaraberov/orgs","repos_url":"https://api.github.com/users/AlexanderKaraberov/repos","events_url":"https://api.github.com/users/AlexanderKaraberov/events{/privacy}","received_events_url":"https://api.github.com/users/AlexanderKaraberov/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T18:15:43Z","updated_at":"2018-11-09T18:16:47Z","author_association":"CONTRIBUTOR","body":"@nickva Thanks! Indeed it was some intermittent failure. All is good now. Let me know if I need to address something else before this can be merged into `master`. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437447396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437473945","html_url":"https://github.com/apache/couchdb/issues/1724#issuecomment-437473945","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1724","id":437473945,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzQ3Mzk0NQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-09T19:45:14Z","updated_at":"2018-11-09T19:45:14Z","author_association":"MEMBER","body":"I'm -0.5 on the proposal.\r\n\r\nConcerns:\r\n\r\n1) Overall throughput decrease if a database doesn't have any of these new functions, just from having to traverse your new code path on *every read*,\r\n2) Lack of security and sandboxing in Erlang-based functions, which is why we ship with the Erlang query server disabled by default\r\n\r\nI know that point 2 above is why this feature will never land at Cloudant and would likely never land at anyone running a public/SaaS CouchDB offering. A potential alternative would be #1554 's approach.\r\n\r\nThe only way to handling point 1 above is to actually have proper load testing & metrics showing the impact. This is something Cloudant devs have done with their major functionality changes in PRs over the past couple of years. Do you have any data points to share?\r\n\r\nThe alternative to this was already proposed by the committer list and is in the roadmap is the per-document permissions: the `_access` proposal. See https://lists.apache.org/thread.html/6aa77dd8e5974a3a540758c6902ccb509ab5a2e4802ecf4fd724a5e4@%3Cdev.couchdb.apache.org%3E\r\n This approach already has a bunch of code behind it as well, and would vastly improve on the current db-per-user access model. With `_access` would we even need `validate_doc_read` functions? I don't think so.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437473945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437604042","html_url":"https://github.com/apache/couchdb/pull/1725#issuecomment-437604042","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1725","id":437604042,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzYwNDA0Mg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-10T18:07:49Z","updated_at":"2018-11-10T18:07:49Z","author_association":"MEMBER","body":"LGTM +1","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437604042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437618041","html_url":"https://github.com/apache/couchdb/issues/1724#issuecomment-437618041","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1724","id":437618041,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzYxODA0MQ==","user":{"login":"ermouth","id":1540047,"node_id":"MDQ6VXNlcjE1NDAwNDc=","avatar_url":"https://avatars.githubusercontent.com/u/1540047?v=4","gravatar_id":"","url":"https://api.github.com/users/ermouth","html_url":"https://github.com/ermouth","followers_url":"https://api.github.com/users/ermouth/followers","following_url":"https://api.github.com/users/ermouth/following{/other_user}","gists_url":"https://api.github.com/users/ermouth/gists{/gist_id}","starred_url":"https://api.github.com/users/ermouth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ermouth/subscriptions","organizations_url":"https://api.github.com/users/ermouth/orgs","repos_url":"https://api.github.com/users/ermouth/repos","events_url":"https://api.github.com/users/ermouth/events{/privacy}","received_events_url":"https://api.github.com/users/ermouth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-10T20:14:18Z","updated_at":"2018-11-10T20:14:18Z","author_association":"CONTRIBUTOR","body":"There exist approaches to filter outgoing data streams very fast without intervening CouchDB codebase â see ie https://github.com/ermouth/covercouch â however I doubt itâs useful for 2.x.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437618041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437630220","html_url":"https://github.com/apache/couchdb/pull/1726#issuecomment-437630220","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1726","id":437630220,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzYzMDIyMA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-10T23:32:11Z","updated_at":"2018-11-10T23:32:11Z","author_association":"MEMBER","body":"Can you confirm this doesn't break support for 1.6.6? We currently have 1.6.6 in our regression testing environment and plan to start running `make elixir` as part of our test suite soon.\r\n\r\nThe regression environment is Erlang 19 so I don't even know if we can upgrade to 1.7 with that or not...","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437630220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437644518","html_url":"https://github.com/apache/couchdb/pull/1726#issuecomment-437644518","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1726","id":437644518,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzY0NDUxOA==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-11T05:13:16Z","updated_at":"2018-11-11T05:13:16Z","author_association":"CONTRIBUTOR","body":"@wohali, yes, I also ran the tests with elixir 1.6.6, and they all pass except for this one test (which also fails on 1.7.4):\r\n```\r\n  * test Standard config options are present (2.0ms)\r\n\r\n  1) test Standard config options are present (ConfigTest)\r\n     test/config_test.exs:70\r\n     Expected truthy, got nil\r\n     code: assert context[:config][\"daemons\"][\"httpd\"]\r\n     stacktrace:\r\n       test/config_test.exs:72: (test)\r\n```\r\nI hope to have a fix for that test shortly.\r\n\r\nAs for erlang/elixir version compatibility, there's this [nice table](https://hexdocs.pm/elixir/compatibility-and-deprecations.html#compatibility-between-elixir-and-erlang-otp) which indicates elixir 1.7 should be compatible with OTP 19. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437644518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437691748","html_url":"https://github.com/apache/couchdb/issues/1728#issuecomment-437691748","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1728","id":437691748,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzY5MTc0OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-11T18:12:35Z","updated_at":"2018-11-11T18:12:35Z","author_association":"MEMBER","body":"This is normal - IF you didn't follow our setup documentation correctly.\r\n\r\nStart here: http://docs.couchdb.org/en/stable/install/setup.html","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437691748/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437692894","html_url":"https://github.com/apache/couchdb/pull/1182#issuecomment-437692894","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1182","id":437692894,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzY5Mjg5NA==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-11T18:28:51Z","updated_at":"2018-11-11T18:28:51Z","author_association":"MEMBER","body":"Will try and get a review done this week.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437692894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437930176","html_url":"https://github.com/apache/couchdb/issues/1106#issuecomment-437930176","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1106","id":437930176,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzkzMDE3Ng==","user":{"login":"mariocasciaro","id":105319,"node_id":"MDQ6VXNlcjEwNTMxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/105319?v=4","gravatar_id":"","url":"https://api.github.com/users/mariocasciaro","html_url":"https://github.com/mariocasciaro","followers_url":"https://api.github.com/users/mariocasciaro/followers","following_url":"https://api.github.com/users/mariocasciaro/following{/other_user}","gists_url":"https://api.github.com/users/mariocasciaro/gists{/gist_id}","starred_url":"https://api.github.com/users/mariocasciaro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mariocasciaro/subscriptions","organizations_url":"https://api.github.com/users/mariocasciaro/orgs","repos_url":"https://api.github.com/users/mariocasciaro/repos","events_url":"https://api.github.com/users/mariocasciaro/events{/privacy}","received_events_url":"https://api.github.com/users/mariocasciaro/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-12T15:49:44Z","updated_at":"2018-11-12T15:49:44Z","author_association":"NONE","body":"Trying to add some more information here since I have similar errors in my log (actually a lot of them):\r\n\r\n```\r\n[error] 2018-11-12T15:03:04.488080Z couchdb@xxx.xxx emulator -------- Error in process <0.1582.0> on node 'couchdb@xxx.xxx' with exit value:\r\n{badarg,[{ets,member,[mem3_openers,<<\"xxx\">>],[]},{mem3_shards,maybe_spawn_shard_writer,3,[{file,\"src/mem3_shards.erl\"},{line,476}]},{mem3_shards,load_shards_from_db,2,[{file,\"src/mem3_shards.erl\"},{line,381}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,370}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,91}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,38}]},{couch_index_server,'-get_index/3-fun-0-',2,[{file,\"src/couch_index_server.erl\"},{line,68}]}]}\r\n\r\n[error] 2018-11-12T15:03:04.488130Z couchdb@xxx.xxx <0.244.0> -------- Error opening view group `rel` from database `shards/00000000-ffffffff/xxx.1534776614`: {'EXIT',{{badmatch,{badarg,[{ets,member,[mem3_openers,<<\"xxx\">>],[]},{mem3_shards,maybe_spawn_shard_writer,3,[{file,\"src/mem3_shards.erl\"},{line,476}]},{mem3_shards,load_shards_from_db,2,[{file,\"src/mem3_shards.erl\"},{line,381}]},{mem3_shards,load_shards_from_disk,1,[{file,\"src/mem3_shards.erl\"},{line,370}]},{mem3_shards,load_shards_from_disk,2,[{file,\"src/mem3_shards.erl\"},{line,399}]},{mem3_shards,for_docid,3,[{file,\"src/mem3_shards.erl\"},{line,91}]},{fabric_doc_open,go,3,[{file,\"src/fabric_doc_open.erl\"},{line,38}]},{couch_index_server,'-get_index/3-fun-0-',2,[{file,\"src/couch_index_server.erl\"},{line,68}]}]}},[{couch_mrview,get_info,2,[{file,\"src/couch_mrview.erl\"},{line,337}]},{couch_compaction_daemon,maybe_compact_view,3,[{file,\"src/couch_compaction_daemon.erl\"},{line,257}]},{couch_compaction_daemon,maybe_compact_views,3,[{file,\"src/couch_compaction_daemon.erl\"},{line,228}]},{couch_compaction_daemon,'-compact_loop/1-fun-0-',4,[{file,\"src/couch_compaction_daemon.erl\"},{line,142}]},{couch_server,'-all_databases/2-fun-0-',4,[{file,\"src/couch_server.erl\"},{line,315}]},{couch_util,fold_files2,6,[{file,\"src/couch_util.erl\"},{line,108}]},{couch_util,fold_files2,6,[{file,\"src/couch_util.erl\"},{line,113}]},{couch_server,all_databases,2,[{file,\"src/couch_server.erl\"},{line,305}]}]}}\r\n```\r\n\r\nUsually those errors are preceded by lines like these:\r\n\r\n```\r\n[notice] 2018-11-12T15:02:58.436921Z couchdb@xxx.xxx <0.276.0> -------- rexi_server_mon : cluster unstable\r\n[notice] 2018-11-12T15:02:58.436962Z couchdb@xxx.xxx <0.279.0> -------- rexi_server_mon : cluster unstable\r\n[notice] 2018-11-12T15:02:58.437193Z couchdb@xxx.xxx <0.275.0> -------- rexi_server : cluster unstable\r\n[notice] 2018-11-12T15:02:58.437287Z couchdb@xxx.xxx <0.278.0> -------- rexi_buffer : cluster unstable\r\n[notice] 2018-11-12T15:02:58.469005Z couchdb@xxx.xxx <0.276.0> -------- rexi_server_mon : cluster unstable\r\n[notice] 2018-11-12T15:02:58.469046Z couchdb@xxx.xxx <0.279.0> -------- rexi_server_mon : cluster unstable\r\n[notice] 2018-11-12T15:02:58.469310Z couchdb@xxx.xxx <0.275.0> -------- rexi_server : cluster unstable\r\n[notice] 2018-11-12T15:02:58.469357Z couchdb@xxx.xxx <0.278.0> -------- rexi_buffer : cluster unstable\r\n```\r\n\r\nI also noticed that the stat `number of rexi_DOWN messages handled` is very high, it increases of about 1000 every 10 minutes.\r\n\r\nOther info:\r\n```\r\nq=1\r\nn=3\r\n\r\nDatabases: around 200, most of them < 1mb, a few up to 40mb, total size 200mb\r\nLoad on the database: max 100 requests per minute\r\nLoad on machines: very low, CPU avg 2%, Max memory usage 40%\r\nMachines specs: 1 vCpu, 2GB ram\r\nI can consistently see those errors on all the 3 machines in the cluster and all have about the same number of 'rexi_DOWN messages handled'.\r\n```\r\n\r\nThe same application and database configuration (but with different data) is running on another environment, actually with higher load and many more databases and I can't see all those error messages.\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437930176/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437930612","html_url":"https://github.com/apache/couchdb/issues/1704#issuecomment-437930612","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1704","id":437930612,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzkzMDYxMg==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-12T15:51:00Z","updated_at":"2018-11-12T15:51:00Z","author_association":"MEMBER","body":"So, this turned out not to be about `delayed_commits` tests, but a some kind of a race in a server restart code introduced in #1543. I haven't nailed what is it exactly yet, so far it seems to be triggered when restart's killing running compaction or/and when there are a previous content in the system databases in `dev/lib/node*`. This explains why it's less frequent on CI (it starts from a clean state every time) and it's more profound in dev env (I don't run `make devclean` on _each_ test run).\r\n\r\nSince this is not the tests themselves, but actual `restart` API part we are using in elixir tests I'll keep looking.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437930612/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437942605","html_url":"https://github.com/apache/couchdb/pull/1470#issuecomment-437942605","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1470","id":437942605,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzk0MjYwNQ==","user":{"login":"janl","id":11321,"node_id":"MDQ6VXNlcjExMzIx","avatar_url":"https://avatars.githubusercontent.com/u/11321?v=4","gravatar_id":"","url":"https://api.github.com/users/janl","html_url":"https://github.com/janl","followers_url":"https://api.github.com/users/janl/followers","following_url":"https://api.github.com/users/janl/following{/other_user}","gists_url":"https://api.github.com/users/janl/gists{/gist_id}","starred_url":"https://api.github.com/users/janl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/janl/subscriptions","organizations_url":"https://api.github.com/users/janl/orgs","repos_url":"https://api.github.com/users/janl/repos","events_url":"https://api.github.com/users/janl/events{/privacy}","received_events_url":"https://api.github.com/users/janl/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-12T16:24:26Z","updated_at":"2018-11-12T16:24:26Z","author_association":"MEMBER","body":"@davisp *ping* :)","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437942605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437962188","html_url":"https://github.com/apache/couchdb/issues/1633#issuecomment-437962188","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1633","id":437962188,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzk2MjE4OA==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-12T17:21:29Z","updated_at":"2018-11-12T17:21:29Z","author_association":"MEMBER","body":"The good news is: the Erlang test suite now passes under Windows with no problems.\r\n\r\nThe bad news is: `make javascript` is now broken because `dev\\run` is now broken somehow.\r\n\r\nLooking into it.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437962188/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437964133","html_url":"https://github.com/apache/couchdb/pull/1195#issuecomment-437964133","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1195","id":437964133,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzk2NDEzMw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-12T17:27:24Z","updated_at":"2018-11-12T17:27:24Z","author_association":"CONTRIBUTOR","body":"@AlexanderKaraberov \r\n\r\n+1 \r\n\r\nThank you for your contribution and for your patience when reviewing the PR\r\n\r\nLet's do a final ping on this to other developers who looked at this before\r\n\r\n@garrensmith @rnewson @janl @wohali \r\n Any objections or concerns to merging this?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/437964133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438077577","html_url":"https://github.com/apache/couchdb/pull/1718#issuecomment-438077577","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1718","id":438077577,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODA3NzU3Nw==","user":{"login":"tonysun83","id":6991573,"node_id":"MDQ6VXNlcjY5OTE1NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6991573?v=4","gravatar_id":"","url":"https://api.github.com/users/tonysun83","html_url":"https://github.com/tonysun83","followers_url":"https://api.github.com/users/tonysun83/followers","following_url":"https://api.github.com/users/tonysun83/following{/other_user}","gists_url":"https://api.github.com/users/tonysun83/gists{/gist_id}","starred_url":"https://api.github.com/users/tonysun83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tonysun83/subscriptions","organizations_url":"https://api.github.com/users/tonysun83/orgs","repos_url":"https://api.github.com/users/tonysun83/repos","events_url":"https://api.github.com/users/tonysun83/events{/privacy}","received_events_url":"https://api.github.com/users/tonysun83/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T00:04:28Z","updated_at":"2018-11-13T00:04:28Z","author_association":"CONTRIBUTOR","body":"+1 after some of the formatting issues. ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438077577/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438157349","html_url":"https://github.com/apache/couchdb/issues/1732#issuecomment-438157349","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1732","id":438157349,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODE1NzM0OQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T06:53:29Z","updated_at":"2018-11-13T06:53:29Z","author_association":"MEMBER","body":"@willholley Garren mentioned you might have an idea here as well?","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438157349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438190778","html_url":"https://github.com/apache/couchdb/issues/1720#issuecomment-438190778","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1720","id":438190778,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODE5MDc3OA==","user":{"login":"skeyby","id":1609532,"node_id":"MDQ6VXNlcjE2MDk1MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1609532?v=4","gravatar_id":"","url":"https://api.github.com/users/skeyby","html_url":"https://github.com/skeyby","followers_url":"https://api.github.com/users/skeyby/followers","following_url":"https://api.github.com/users/skeyby/following{/other_user}","gists_url":"https://api.github.com/users/skeyby/gists{/gist_id}","starred_url":"https://api.github.com/users/skeyby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skeyby/subscriptions","organizations_url":"https://api.github.com/users/skeyby/orgs","repos_url":"https://api.github.com/users/skeyby/repos","events_url":"https://api.github.com/users/skeyby/events{/privacy}","received_events_url":"https://api.github.com/users/skeyby/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T09:09:11Z","updated_at":"2018-11-13T09:09:11Z","author_association":"NONE","body":"You're right but when you start a new full replication the whole db has to be scanned for already present and updated docs, when a DB has many documents that would be an huge overkill. The proposal work-around this issue by keeping the sequence number at hand.\r\n\r\nFurthermore the whole point is to keep the \"master\" replication flowing in a _near-realtime-fashion_, if I have to restart it every, let's say, 10 minutes then the currently stop-and-start by the scheduler it's already enough.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438190778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438198601","html_url":"https://github.com/apache/couchdb/pull/1718#issuecomment-438198601","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1718","id":438198601,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODE5ODYwMQ==","user":{"login":"garrensmith","id":179458,"node_id":"MDQ6VXNlcjE3OTQ1OA==","avatar_url":"https://avatars.githubusercontent.com/u/179458?v=4","gravatar_id":"","url":"https://api.github.com/users/garrensmith","html_url":"https://github.com/garrensmith","followers_url":"https://api.github.com/users/garrensmith/followers","following_url":"https://api.github.com/users/garrensmith/following{/other_user}","gists_url":"https://api.github.com/users/garrensmith/gists{/gist_id}","starred_url":"https://api.github.com/users/garrensmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/garrensmith/subscriptions","organizations_url":"https://api.github.com/users/garrensmith/orgs","repos_url":"https://api.github.com/users/garrensmith/repos","events_url":"https://api.github.com/users/garrensmith/events{/privacy}","received_events_url":"https://api.github.com/users/garrensmith/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T09:34:01Z","updated_at":"2018-11-13T09:34:01Z","author_association":"MEMBER","body":"Thanks @tonysun83 I've fixed the formatting issues","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438198601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438220553","html_url":"https://github.com/apache/couchdb/issues/1729#issuecomment-438220553","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1729","id":438220553,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODIyMDU1Mw==","user":{"login":"mariocasciaro","id":105319,"node_id":"MDQ6VXNlcjEwNTMxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/105319?v=4","gravatar_id":"","url":"https://api.github.com/users/mariocasciaro","html_url":"https://github.com/mariocasciaro","followers_url":"https://api.github.com/users/mariocasciaro/followers","following_url":"https://api.github.com/users/mariocasciaro/following{/other_user}","gists_url":"https://api.github.com/users/mariocasciaro/gists{/gist_id}","starred_url":"https://api.github.com/users/mariocasciaro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mariocasciaro/subscriptions","organizations_url":"https://api.github.com/users/mariocasciaro/orgs","repos_url":"https://api.github.com/users/mariocasciaro/repos","events_url":"https://api.github.com/users/mariocasciaro/events{/privacy}","received_events_url":"https://api.github.com/users/mariocasciaro/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T10:44:57Z","updated_at":"2018-11-13T10:44:57Z","author_association":"NONE","body":"Never mind, after further investigation it seems that  those dbs were created at a time when the cluster was still not properly configured.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438220553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438288539","html_url":"https://github.com/apache/couchdb/issues/1730#issuecomment-438288539","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1730","id":438288539,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODI4ODUzOQ==","user":{"login":"davisp","id":19929,"node_id":"MDQ6VXNlcjE5OTI5","avatar_url":"https://avatars.githubusercontent.com/u/19929?v=4","gravatar_id":"","url":"https://api.github.com/users/davisp","html_url":"https://github.com/davisp","followers_url":"https://api.github.com/users/davisp/followers","following_url":"https://api.github.com/users/davisp/following{/other_user}","gists_url":"https://api.github.com/users/davisp/gists{/gist_id}","starred_url":"https://api.github.com/users/davisp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davisp/subscriptions","organizations_url":"https://api.github.com/users/davisp/orgs","repos_url":"https://api.github.com/users/davisp/repos","events_url":"https://api.github.com/users/davisp/events{/privacy}","received_events_url":"https://api.github.com/users/davisp/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T14:38:33Z","updated_at":"2018-11-13T14:38:33Z","author_association":"MEMBER","body":"Update jiffy to 0.15.2 in test/elixir/mix.lock.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438288539/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438344549","html_url":"https://github.com/apache/couchdb/issues/1704#issuecomment-438344549","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1704","id":438344549,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM0NDU0OQ==","user":{"login":"eiri","id":70542,"node_id":"MDQ6VXNlcjcwNTQy","avatar_url":"https://avatars.githubusercontent.com/u/70542?v=4","gravatar_id":"","url":"https://api.github.com/users/eiri","html_url":"https://github.com/eiri","followers_url":"https://api.github.com/users/eiri/followers","following_url":"https://api.github.com/users/eiri/following{/other_user}","gists_url":"https://api.github.com/users/eiri/gists{/gist_id}","starred_url":"https://api.github.com/users/eiri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eiri/subscriptions","organizations_url":"https://api.github.com/users/eiri/orgs","repos_url":"https://api.github.com/users/eiri/repos","events_url":"https://api.github.com/users/eiri/events{/privacy}","received_events_url":"https://api.github.com/users/eiri/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T16:48:00Z","updated_at":"2018-11-13T16:48:00Z","author_association":"MEMBER","body":"Ok, I just can't reproduce this outside of javascript test suite, i.e. repeating the same steps in a bash script.\r\n\r\nI'm going to concentrate on that elixir porting then, to see if the issue persist and if not I'll just write it off on javascript voodoo and we'll have our port.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438344549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438365522","html_url":"https://github.com/apache/couchdb/pull/1734#issuecomment-438365522","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1734","id":438365522,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM2NTUyMg==","user":{"login":"rnewson","id":47223,"node_id":"MDQ6VXNlcjQ3MjIz","avatar_url":"https://avatars.githubusercontent.com/u/47223?v=4","gravatar_id":"","url":"https://api.github.com/users/rnewson","html_url":"https://github.com/rnewson","followers_url":"https://api.github.com/users/rnewson/followers","following_url":"https://api.github.com/users/rnewson/following{/other_user}","gists_url":"https://api.github.com/users/rnewson/gists{/gist_id}","starred_url":"https://api.github.com/users/rnewson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnewson/subscriptions","organizations_url":"https://api.github.com/users/rnewson/orgs","repos_url":"https://api.github.com/users/rnewson/repos","events_url":"https://api.github.com/users/rnewson/events{/privacy}","received_events_url":"https://api.github.com/users/rnewson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T17:37:47Z","updated_at":"2018-11-13T17:37:47Z","author_association":"MEMBER","body":"-1 from me. As you note, there are many legitimate reasons for a document write to fail and for the replication to continue regardless. Making replication even more complicated by adding a new mode of operation is not a step in the right direction.\r\n\r\nInstead, I think we should be showing these things more clearly. If the count of failed writes is not persisted, it should be. If it doesn't explain the reasons, it should (vdu_rejections: 4, doc_too_large: 5, etc, etc).\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438365522/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438366635","html_url":"https://github.com/apache/couchdb/issues/1730#issuecomment-438366635","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1730","id":438366635,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM2NjYzNQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T17:41:07Z","updated_at":"2018-11-13T17:41:07Z","author_association":"MEMBER","body":"@davisp that did it, awesome! I'll file the PR shortly.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438366635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438368873","html_url":"https://github.com/apache/couchdb/issues/1732#issuecomment-438368873","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1732","id":438368873,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM2ODg3Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T17:47:22Z","updated_at":"2018-11-13T17:47:22Z","author_association":"MEMBER","body":"So I think the problem is what I previously mentioned, that basically the test completes too fast (<1ms) and the result is `0.0`. The only fix I see possible here is to not test for that assertion on Windows platforms.\r\n\r\nI'll file a PR.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438368873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438374131","html_url":"https://github.com/apache/couchdb/pull/1734#issuecomment-438374131","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1734","id":438374131,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM3NDEzMQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T17:59:52Z","updated_at":"2018-11-13T17:59:52Z","author_association":"MEMBER","body":"I think the fundamental problem you're trying to solve here is surfacing the failures to the user.\r\n\r\nCurrently the replication status fields aren't rich enough to capture \"Succeeded, but with errors\" as a new end state. I would argue strongly that we need that state, that Fauxton needs to display it in a different colour, and that the specific types of failures should be enumerated (along with the total # of documents that _successfully_ replicated).\r\n\r\nNote as well that continuous replications could be in a \"Succeeding/running, but with errors\" state as well that should be called out.\r\n\r\nThe problem is that client code needs to be rewritten. Many replication monitoring scripts that I've run into in the wild tend to be of the sort \"start the replication, check `/_active_tasks` or `scheduler/jobs`, if not errored, everything is fine, when it hits succeeded, we're good.\" Those scripts will have to be taught to react to the new state.\r\n\r\n-----\r\n\r\nAt the very least, failing on a single document write seems overkill. If this proposal is to proceed, I'd recommend changing your setting to:\r\n\r\n```\r\nstop_on_doc_write_failure = false ; current behaviour\r\nstop_on_doc_write_failure = ### ; stops after ### failures occur\r\nstop_on_doc_write_failure = true ; same as = 1\r\n```\r\n\r\n-----\r\n\r\n\r\nEither way, this is too big of a change to go into 2.3.0 (which is imminent) so I'd ask you to hold off on merging this PR for now if approved. If I had to express a numerical opinion, it'd be -0.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438374131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438374493","html_url":"https://github.com/apache/couchdb/issues/1735#issuecomment-438374493","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1735","id":438374493,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM3NDQ5Mw==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T18:00:55Z","updated_at":"2018-11-13T18:00:55Z","author_association":"MEMBER","body":"On a subsequent run, a different test fails:\r\n\r\n```\r\nBulkDocsTest\r\n  * test bulk docs supplies `id` if not provided in doc (125.0ms)\r\n  * test bulk docs can create, update, & delete many docs per request (296.0ms)\r\n  * test bulk docs raises error for invlaid `new_edits` parameter (141.0ms)\r\n  * test bulk docs raises error for invlaid `docs` parameter (235.0ms)\r\n  * test bulk docs raises error for missing `docs` parameter (140.0ms)\r\n  * test bulk docs raises error for `all_or_nothing` option (266.0ms)\r\n  * test bulk docs can detect conflicts (235.0ms)\r\n\r\n  1) test bulk docs can detect conflicts (BulkDocsTest)\r\n     test/bulk_docs_test.exs:45\r\n     Expected 201 and the same number of response rows as in request, but got\r\n     %HTTPotion.Response{\r\n       body: [\r\n         %{\r\n           \"accepted\" => true,\r\n           \"id\" => \"1\",\r\n           \"ok\" => true,\r\n           \"rev\" => \"2-59422af42db146a6a87b76e5edbeeb44\"\r\n         },\r\n         %{\r\n           \"id\" => \"2\",\r\n           \"ok\" => true,\r\n           \"rev\" => \"2-0450643c5eb507fee080a4298e102c9a\"\r\n         },\r\n         %{\r\n           \"id\" => \"3\",\r\n           \"ok\" => true,\r\n           \"rev\" => \"2-7c9bd31172bbb3d4097fa45e3a6e2c85\"\r\n         },\r\n         %{\r\n           \"id\" => \"4\",\r\n           \"ok\" => true,\r\n           \"rev\" => \"2-2fd866cc031a23ac8ccccb49952a2666\"\r\n         },\r\n         %{\r\n           \"id\" => \"5\",\r\n           \"ok\" => true,\r\n           \"rev\" => \"2-3af34b0749ed8322340556d497581836\"\r\n         }\r\n       ],\r\n       headers: %HTTPotion.Headers{\r\n         hdrs: %{\r\n           \"cache-control\" => \"must-revalidate\",\r\n           \"content-length\" => \"338\",\r\n           \"content-type\" => \"application/json\",\r\n           \"date\" => \"Tue, 13 Nov 2018 17:49:03 GMT\",\r\n           \"server\" => \"CouchDB/2.2.0-878866c1e (Erlang OTP/19)\",\r\n           \"x-couch-request-id\" => \"b0a6f69516\",\r\n           \"x-couchdb-body-time\" => \"0\"\r\n         }\r\n       },\r\n       status_code: 202\r\n     }\r\n\r\n     code: resp = bulk_post(docs, db)\r\n     stacktrace:\r\n       test/bulk_docs_test.exs:134: BulkDocsTest.bulk_post/2\r\n       test/bulk_docs_test.exs:57: (test)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438374493/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438375741","html_url":"https://github.com/apache/couchdb/issues/1735#issuecomment-438375741","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1735","id":438375741,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM3NTc0MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T18:04:45Z","updated_at":"2018-11-13T18:04:45Z","author_association":"MEMBER","body":"One more:\r\n\r\n```\r\n  * test multiple updates with same _rev raise conflict errors (187.0ms)\r\n\r\n  1) test multiple updates with same _rev raise conflict errors (RevisionTest)\r\n     test/conflicts_test.exs:20\r\n     Assertion with == failed\r\n     code:  assert resp.status_code() == 409\r\n     left:  202\r\n     right: 409\r\n     stacktrace:\r\n       test/conflicts_test.exs:91: RevisionTest.assert_conflict/1\r\n       test/conflicts_test.exs:25: (test)\r\n```","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438375741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438375836","html_url":"https://github.com/apache/couchdb/issues/1735#issuecomment-438375836","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1735","id":438375836,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM3NTgzNg==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T18:05:03Z","updated_at":"2018-11-13T18:05:03Z","author_association":"MEMBER","body":"Starting to feel like the tests have some race conditions.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438375836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438377284","html_url":"https://github.com/apache/couchdb/pull/1734#issuecomment-438377284","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1734","id":438377284,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM3NzI4NA==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T18:09:23Z","updated_at":"2018-11-16T04:55:30Z","author_association":"CONTRIBUTOR","body":"@rnewson \r\n\r\n> there are many legitimate reasons for a document write to fail and for the replication to continue regardless. \r\n\r\nThe `continue regardless` thing is what this is mostly about, it configures whether continuing should happen or shouldn't happen. Once it continues and checkpoints it's a headache to retry it (delete checkpoints on target and source, create / update the replication document, get another error, do the same thing again, etc). A replication \"successfully\" completing is misleading the user as well in  a way and can be perceived as a \"data loss\".\r\n\r\n>  If the count of failed writes is not persisted, it should be. \r\n\r\nWe fixed that recently and now is persisted between job runs (before it wasn't) but persisting it to the replication doc would invite more updates to doc which were trying to move away from, especially with continuous replications. We could persist it to the the checkpoint history, we already save it there. But we'd have to checkpoint and retrying the replication would involve all the hassle as described above. We could invent some other, new place to persist replication state (new type of local replicator docs).\r\n\r\nI am not against adding more detailed counts, but that could be orthogonal to the idea of stopping a replication job on failure. The downside is that it doesn't help with knowing which document failed and why. So even then, fixing it means doing a diff between databases or scouring log files.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438377284/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438381281","html_url":"https://github.com/apache/couchdb/pull/1734#issuecomment-438381281","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1734","id":438381281,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM4MTI4MQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T18:20:40Z","updated_at":"2018-11-13T18:20:40Z","author_association":"MEMBER","body":"I'd remind both of you that if this is a discussion that bears more thought, it'd be best to take it to `dev@couchdb.apache.org` and not discuss it in this PR, please.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438381281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438395597","html_url":"https://github.com/apache/couchdb/pull/1734#issuecomment-438395597","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1734","id":438395597,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM5NTU5Nw==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T19:02:09Z","updated_at":"2018-11-13T19:02:09Z","author_association":"CONTRIBUTOR","body":"@wohali \r\n\r\n> I would argue strongly that we need that state, that Fauxton needs to display it in a different colour\r\n\r\nWith doc_write_failures count we have that state. I think we could improve Fauxton to highlight the replication line in yellow.\r\n\r\n> The problem is that client code needs to be rewritten. Many replication monitoring scripts that I've run into in the wild tend to be of the sort \"start the replication, check /_active_tasks or scheduler/jobs, if not errored, everything is fine, when it hits succeeded, we're good.\"\r\n\r\nExactly, that complicates the state machine (that blue / yellow diagram we have) a bit as well. That is why I proposed this PR: it keeps the states the same, it identifies which document failed and why, and if the error condition is fixed, it will eventually complete successfully. \r\n\r\n>  If this proposal is to proceed, I'd recommend changing your setting to:\r\n\r\n```\r\nstop_on_doc_write_failure = false ; current behaviour\r\nstop_on_doc_write_failure = ### ; stops after ### failures occur\r\n```\r\n\r\nOr just call it max_doc_write_failures? and make it infinity or integer with 0 being equivalent to true currently. That might work. The problem then is users still won't  know which document failed to fix it, and it would be somewhat indeterministic depending on the order in which replication workers write. I think in general there would be a sharp binary choice between users who say migrate their data and would not tolerate returning \"success\" of all their data didn't copy over vs users who expect doc write rejects, then they'd be ok with the default (infinity or false in this case).\r\n\r\nAnother option is to allow max per/failure type counts. Max vdu fails, max attachment size fails, etc.\r\n\r\n \r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438395597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438416101","html_url":"https://github.com/apache/couchdb/issues/1735#issuecomment-438416101","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1735","id":438416101,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODQxNjEwMQ==","user":{"login":"jaydoane","id":51209,"node_id":"MDQ6VXNlcjUxMjA5","avatar_url":"https://avatars.githubusercontent.com/u/51209?v=4","gravatar_id":"","url":"https://api.github.com/users/jaydoane","html_url":"https://github.com/jaydoane","followers_url":"https://api.github.com/users/jaydoane/followers","following_url":"https://api.github.com/users/jaydoane/following{/other_user}","gists_url":"https://api.github.com/users/jaydoane/gists{/gist_id}","starred_url":"https://api.github.com/users/jaydoane/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaydoane/subscriptions","organizations_url":"https://api.github.com/users/jaydoane/orgs","repos_url":"https://api.github.com/users/jaydoane/repos","events_url":"https://api.github.com/users/jaydoane/events{/privacy}","received_events_url":"https://api.github.com/users/jaydoane/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T20:01:40Z","updated_at":"2018-11-13T20:01:40Z","author_association":"CONTRIBUTOR","body":"Unfortunately, I've also noticed numerous elixir tests failing intermittently on macos and linux as well. I think that in general, directly porting JS tests can expose or exacerbate latent races. One way I've been dealing with them is to wrap the success condition in the `retry_until` function.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438416101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438457919","html_url":"https://github.com/apache/couchdb/pull/1736#issuecomment-438457919","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1736","id":438457919,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODQ1NzkxOQ==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T22:11:43Z","updated_at":"2018-11-13T22:11:43Z","author_association":"MEMBER","body":"@jaydoane says this all runs fine for him, so that's an informal +1. Would like a +1 from a committer before I merge this though.","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438457919/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438478801","html_url":"https://github.com/apache/couchdb/pull/1734#issuecomment-438478801","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1734","id":438478801,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODQ3ODgwMQ==","user":{"login":"nickva","id":211822,"node_id":"MDQ6VXNlcjIxMTgyMg==","avatar_url":"https://avatars.githubusercontent.com/u/211822?v=4","gravatar_id":"","url":"https://api.github.com/users/nickva","html_url":"https://github.com/nickva","followers_url":"https://api.github.com/users/nickva/followers","following_url":"https://api.github.com/users/nickva/following{/other_user}","gists_url":"https://api.github.com/users/nickva/gists{/gist_id}","starred_url":"https://api.github.com/users/nickva/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nickva/subscriptions","organizations_url":"https://api.github.com/users/nickva/orgs","repos_url":"https://api.github.com/users/nickva/repos","events_url":"https://api.github.com/users/nickva/events{/privacy}","received_events_url":"https://api.github.com/users/nickva/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-13T23:31:54Z","updated_at":"2018-11-13T23:36:54Z","author_association":"CONTRIBUTOR","body":"Added per-replication job configuration. \r\n\r\nTo manually play with it and test refer to this script:\r\n\r\nhttps://gist.github.com/nickva/8dacbda953db77292d864f59af2d6d2c\r\n\r\n* Create a source, add a 10k doc to it\r\n* Set `max_document_size = 10000`\r\n* Set `stop_on_doc_write_failures = true`\r\n* Create a replication\r\n* Check `_scheduler/docs` for state:\r\n  * If set stop_on_doc_write_failure = true is should stop with:\r\n    ```\"{doc_write_failure,\\\"<docid>\\\", {error,request_body_too_large}}\",```\r\n   crashed state.  It should not complete.\r\n* Reset the document size limit, wait for the replication to complete (there is a quicker reschedule step in the file).\r\n","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438478801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438487776","html_url":"https://github.com/apache/couchdb/pull/1619#issuecomment-438487776","issue_url":"https://api.github.com/repos/apache/couchdb/issues/1619","id":438487776,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODQ4Nzc3Ng==","user":{"login":"wohali","id":112292,"node_id":"MDQ6VXNlcjExMjI5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/112292?v=4","gravatar_id":"","url":"https://api.github.com/users/wohali","html_url":"https://github.com/wohali","followers_url":"https://api.github.com/users/wohali/followers","following_url":"https://api.github.com/users/wohali/following{/other_user}","gists_url":"https://api.github.com/users/wohali/gists{/gist_id}","starred_url":"https://api.github.com/users/wohali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wohali/subscriptions","organizations_url":"https://api.github.com/users/wohali/orgs","repos_url":"https://api.github.com/users/wohali/repos","events_url":"https://api.github.com/users/wohali/events{/privacy}","received_events_url":"https://api.github.com/users/wohali/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-14T00:11:40Z","updated_at":"2018-11-14T00:11:40Z","author_association":"MEMBER","body":"@nickva This is blocking 2.3.0's release.\r\n\r\nHow about we always put the Expires value into the `Set-Cookie` header, regardless of `allow_persistent`? ","reactions":{"url":"https://api.github.com/repos/apache/couchdb/issues/comments/438487776/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]