[{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763503","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763503","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763503,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1MDM=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-22T02:36:45Z","updated_at":"2025-01-21T13:38:22Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242</a></p>\n\n<p>    I added another change to remove slept operations from the DelayQueue and re-add to force a resort. I'm concerned, though, that this might affect operation order. In fact, I'm concerned that old sleep that was added might affect operation order. More testing in that area is needed.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763511","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763511","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763511,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1MTE=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-22T02:42:49Z","updated_at":"2025-01-21T13:38:22Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apache9\">apache9</a>:</i>\n<p>OK, seem I misunderstand the meaning of sleepFor. It just sets the sleep time, and is not the actual sleep action so we will not sleep in foreground, good. Thanks for quick fix. The description looks good to me.</p>\n\n<p>Thanks.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763511/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763518","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763518","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763518,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1MTg=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-22T12:57:58Z","updated_at":"2025-01-21T13:38:22Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apache9\">apache9</a>:</i>\n<p>I changed the name to better describe the problem.</p>\n\n<p>Thanks.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763526","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763526","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763526,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1MjY=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-27T21:11:55Z","updated_at":"2025-01-21T13:38:22Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user madrob commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r153243087\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r153243087</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/CuratorFrameworkImpl.java &#8212;<br/>\n    @@ -973,6 +981,33 @@ void performBackgroundOperation(OperationAndData<?> operationAndData)<br/>\n     }<br/>\n }</p>\n\n<p>    +    @VisibleForTesting<br/>\n    +    volatile long sleepAndQueueOperationSeconds = 1;<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    why volatile? did you mean to use an AtomicLong?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763526/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763529","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763529","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763529,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1Mjk=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-27T21:11:55Z","updated_at":"2025-01-21T13:38:22Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user madrob commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r153252423\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r153252423</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/CuratorFrameworkImpl.java &#8212;<br/>\n    @@ -640,12 +646,14 @@ boolean useContainerParentsIfAvailable()<br/>\n     }<br/>\n }</p>\n\n<ul class=\"alternate\" type=\"square\">\n\t<li><DATA_TYPE> void queueOperation(OperationAndData<DATA_TYPE> operationAndData)<br/>\n    +    <DATA_TYPE> boolean queueOperation(OperationAndData<DATA_TYPE> operationAndData)\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    Please add a comment explaining how to handle the return value &#8211; there are a lot of callers that have not been updated to check the new return value. Looks like true iff the operation was queued?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763529/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763536","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763536","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763536,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1MzY=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-27T21:11:55Z","updated_at":"2025-01-21T13:38:22Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user madrob commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r153252872\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r153252872</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/CuratorFrameworkImpl.java &#8212;<br/>\n    @@ -973,6 +981,33 @@ void performBackgroundOperation(OperationAndData<?> operationAndData)<br/>\n     }<br/>\n }</p>\n\n<p>    +    @VisibleForTesting<br/>\n    +    volatile long sleepAndQueueOperationSeconds = 1;<br/>\n    +<br/>\n    +    private void sleepAndQueueOperation(OperationAndData<?> operationAndData) throws InterruptedException<br/>\n    +    {<br/>\n    +operationAndData.sleepFor(sleepAndQueueOperationSeconds, TimeUnit.SECONDS);<br/>\n    +if ( queueOperation(operationAndData) )<br/>\n    +</p>\n{\n    +    forcedSleepOperations.add(operationAndData);\n    +}\n<p>    +    }<br/>\n    +<br/>\n    +    private void unSleepBackgroundOperations()<br/>\n    +    {<br/>\n    +Collection<OperationAndData<?>> drain = new ArrayList<>(forcedSleepOperations.size());<br/>\n    +forcedSleepOperations.drainTo(drain);<br/>\n    +log.debug(\"Clearing sleep for {} operations\", drain.size());<br/>\n    +for ( OperationAndData<?> operation : drain )<br/>\n    +{<br/>\n    +    operation.clearSleep();<br/>\n    +    if ( backgroundOperations.remove(operation) )<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    Why do we need to reinsert all of the operations? Isn't clearing the sleep enough?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763536/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763541","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763541","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763541,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1NDE=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-27T21:11:55Z","updated_at":"2025-01-21T13:38:22Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user madrob commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r153252731\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r153252731</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/CuratorFrameworkImpl.java &#8212;<br/>\n    @@ -973,6 +981,33 @@ void performBackgroundOperation(OperationAndData<?> operationAndData)<br/>\n     }<br/>\n }</p>\n\n<p>    +    @VisibleForTesting<br/>\n    +    volatile long sleepAndQueueOperationSeconds = 1;<br/>\n    +<br/>\n    +    private void sleepAndQueueOperation(OperationAndData<?> operationAndData) throws InterruptedException<br/>\n    +    {<br/>\n    +operationAndData.sleepFor(sleepAndQueueOperationSeconds, TimeUnit.SECONDS);<br/>\n    +if ( queueOperation(operationAndData) )<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    If this returns false, then we just drop the operation?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763544","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763544","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763544,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1NDQ=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-27T21:11:56Z","updated_at":"2025-01-21T13:38:22Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user madrob commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r153253397\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r153253397</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/test/java/org/apache/curator/framework/imps/TestFrameworkEdges.java &#8212;<br/>\n    @@ -60,6 +60,37 @@<br/>\n     {<br/>\n private final Timing2 timing = new Timing2();</p>\n\n<p>    +    @Test<br/>\n    +    public void testBackgroundLatencyUnSleep() throws Exception<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    Could we test multiple operations and verify that after the first one fires the rest don't continue to sleep?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763544/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763546","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763546","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763546,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1NDY=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-27T22:00:57Z","updated_at":"2025-01-21T13:38:23Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r153336927\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r153336927</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/CuratorFrameworkImpl.java &#8212;<br/>\n    @@ -973,6 +981,33 @@ void performBackgroundOperation(OperationAndData<?> operationAndData)<br/>\n     }<br/>\n }</p>\n\n<p>    +    @VisibleForTesting<br/>\n    +    volatile long sleepAndQueueOperationSeconds = 1;<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    I've been moving away from AtomicLong when compareAndSet ops aren't needed. Those wrappers ended up creating unnecessary garbage in the heap.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763552","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763552","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763552,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1NTI=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-27T22:03:17Z","updated_at":"2025-01-21T13:38:23Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r153337468\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r153337468</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/CuratorFrameworkImpl.java &#8212;<br/>\n    @@ -973,6 +981,33 @@ void performBackgroundOperation(OperationAndData<?> operationAndData)<br/>\n     }<br/>\n }</p>\n\n<p>    +    @VisibleForTesting<br/>\n    +    volatile long sleepAndQueueOperationSeconds = 1;<br/>\n    +<br/>\n    +    private void sleepAndQueueOperation(OperationAndData<?> operationAndData) throws InterruptedException<br/>\n    +    {<br/>\n    +operationAndData.sleepFor(sleepAndQueueOperationSeconds, TimeUnit.SECONDS);<br/>\n    +if ( queueOperation(operationAndData) )<br/>\n    +</p>\n{\n    +    forcedSleepOperations.add(operationAndData);\n    +}\n<p>    +    }<br/>\n    +<br/>\n    +    private void unSleepBackgroundOperations()<br/>\n    +    {<br/>\n    +Collection<OperationAndData<?>> drain = new ArrayList<>(forcedSleepOperations.size());<br/>\n    +forcedSleepOperations.drainTo(drain);<br/>\n    +log.debug(\"Clearing sleep for {} operations\", drain.size());<br/>\n    +for ( OperationAndData<?> operation : drain )<br/>\n    +{<br/>\n    +    operation.clearSleep();<br/>\n    +    if ( backgroundOperations.remove(operation) )<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    From my read of DelayQueue and research on the net it's not enough. We need the DelayQueue to re-do the sort and it only does this on item insert.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763556","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763556","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763556,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1NTY=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-27T22:18:43Z","updated_at":"2025-01-21T13:38:23Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user madrob commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r153341026\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r153341026</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/CuratorFrameworkImpl.java &#8212;<br/>\n    @@ -973,6 +981,33 @@ void performBackgroundOperation(OperationAndData<?> operationAndData)<br/>\n     }<br/>\n }</p>\n\n<p>    +    @VisibleForTesting<br/>\n    +    volatile long sleepAndQueueOperationSeconds = 1;<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    That's reasonable, thanks.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763560","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763560","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763560,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1NjA=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-27T22:19:45Z","updated_at":"2025-01-21T13:38:23Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user madrob commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r153341281\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r153341281</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/CuratorFrameworkImpl.java &#8212;<br/>\n    @@ -973,6 +981,33 @@ void performBackgroundOperation(OperationAndData<?> operationAndData)<br/>\n     }<br/>\n }</p>\n\n<p>    +    @VisibleForTesting<br/>\n    +    volatile long sleepAndQueueOperationSeconds = 1;<br/>\n    +<br/>\n    +    private void sleepAndQueueOperation(OperationAndData<?> operationAndData) throws InterruptedException<br/>\n    +    {<br/>\n    +operationAndData.sleepFor(sleepAndQueueOperationSeconds, TimeUnit.SECONDS);<br/>\n    +if ( queueOperation(operationAndData) )<br/>\n    +</p>\n{\n    +    forcedSleepOperations.add(operationAndData);\n    +}\n<p>    +    }<br/>\n    +<br/>\n    +    private void unSleepBackgroundOperations()<br/>\n    +    {<br/>\n    +Collection<OperationAndData<?>> drain = new ArrayList<>(forcedSleepOperations.size());<br/>\n    +forcedSleepOperations.drainTo(drain);<br/>\n    +log.debug(\"Clearing sleep for {} operations\", drain.size());<br/>\n    +for ( OperationAndData<?> operation : drain )<br/>\n    +{<br/>\n    +    operation.clearSleep();<br/>\n    +    if ( backgroundOperations.remove(operation) )<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    Ah, I'm with you now. Can you add a method comment that explains the nuance of the implementation here?</p>\n\n<p>    If we're really concerned about ordering, then we could update clearSleep() to set expiration time to the current time instead of setting it to zero.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763560/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763781","html_url":"https://github.com/apache/curator/issues/964#issuecomment-2604763781","issue_url":"https://api.github.com/repos/apache/curator/issues/964","id":2604763781,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM3ODE=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-28T10:28:31Z","updated_at":"2025-01-21T13:38:29Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=borjab\">borjab</a>:</i>\n<p>Added a pull request. Still need to find a way to test it. But any feedback is will be welcome:</p>\n\n<p><a href=\"https://github.com/apache/curator/pull/243\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/243</a></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763781/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/347580345","html_url":"https://github.com/apache/curator/pull/243#issuecomment-347580345","issue_url":"https://api.github.com/repos/apache/curator/issues/243","id":347580345,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NzU4MDM0NQ==","user":{"login":"borjab","id":6207374,"node_id":"MDQ6VXNlcjYyMDczNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/6207374?v=4","gravatar_id":"","url":"https://api.github.com/users/borjab","html_url":"https://github.com/borjab","followers_url":"https://api.github.com/users/borjab/followers","following_url":"https://api.github.com/users/borjab/following{/other_user}","gists_url":"https://api.github.com/users/borjab/gists{/gist_id}","starred_url":"https://api.github.com/users/borjab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/borjab/subscriptions","organizations_url":"https://api.github.com/users/borjab/orgs","repos_url":"https://api.github.com/users/borjab/repos","events_url":"https://api.github.com/users/borjab/events{/privacy}","received_events_url":"https://api.github.com/users/borjab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-28T16:29:41Z","updated_at":"2017-11-28T16:29:41Z","author_association":"NONE","body":"Fix now includes test to reproduce error. ","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/347580345/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763788","html_url":"https://github.com/apache/curator/issues/964#issuecomment-2604763788","issue_url":"https://api.github.com/repos/apache/curator/issues/964","id":2604763788,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM3ODg=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-11-28T16:32:18Z","updated_at":"2025-01-21T13:38:29Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=borjab\">borjab</a>:</i>\n<p>New Test case to reproduce the problem.  It is the best I have been able to create to emulate a connection problem between zookeepers without affecting the zookeeper connection. Of course it is more realistic to use netstat with the attached script. </p>\n\n<p><a href=\"https://github.com/apache/curator/pull/243\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">Pull request. Now with new test</a></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/348898912","html_url":"https://github.com/apache/curator/pull/243#issuecomment-348898912","issue_url":"https://api.github.com/repos/apache/curator/issues/243","id":348898912,"node_id":"MDEyOklzc3VlQ29tbWVudDM0ODg5ODkxMg==","user":{"login":"borjab","id":6207374,"node_id":"MDQ6VXNlcjYyMDczNzQ=","avatar_url":"https://avatars.githubusercontent.com/u/6207374?v=4","gravatar_id":"","url":"https://api.github.com/users/borjab","html_url":"https://github.com/borjab","followers_url":"https://api.github.com/users/borjab/followers","following_url":"https://api.github.com/users/borjab/following{/other_user}","gists_url":"https://api.github.com/users/borjab/gists{/gist_id}","starred_url":"https://api.github.com/users/borjab/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/borjab/subscriptions","organizations_url":"https://api.github.com/users/borjab/orgs","repos_url":"https://api.github.com/users/borjab/repos","events_url":"https://api.github.com/users/borjab/events{/privacy}","received_events_url":"https://api.github.com/users/borjab/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-04T08:57:47Z","updated_at":"2017-12-04T08:57:47Z","author_association":"NONE","body":"Thanks for the feedback. You are right that the test has a lot of room for improvement.  I will work on the tests as requested. ","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/348898912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/349122867","html_url":"https://github.com/apache/curator/pull/243#issuecomment-349122867","issue_url":"https://api.github.com/repos/apache/curator/issues/243","id":349122867,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTEyMjg2Nw==","user":{"login":"cammckenzie","id":7763121,"node_id":"MDQ6VXNlcjc3NjMxMjE=","avatar_url":"https://avatars.githubusercontent.com/u/7763121?v=4","gravatar_id":"","url":"https://api.github.com/users/cammckenzie","html_url":"https://github.com/cammckenzie","followers_url":"https://api.github.com/users/cammckenzie/followers","following_url":"https://api.github.com/users/cammckenzie/following{/other_user}","gists_url":"https://api.github.com/users/cammckenzie/gists{/gist_id}","starred_url":"https://api.github.com/users/cammckenzie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cammckenzie/subscriptions","organizations_url":"https://api.github.com/users/cammckenzie/orgs","repos_url":"https://api.github.com/users/cammckenzie/repos","events_url":"https://api.github.com/users/cammckenzie/events{/privacy}","received_events_url":"https://api.github.com/users/cammckenzie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-04T22:08:45Z","updated_at":"2017-12-04T22:08:45Z","author_association":"CONTRIBUTOR","body":"Thanks!","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/349122867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763795","html_url":"https://github.com/apache/curator/issues/964#issuecomment-2604763795","issue_url":"https://api.github.com/repos/apache/curator/issues/964","id":2604763795,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM3OTU=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-05T19:14:48Z","updated_at":"2025-01-21T13:38:29Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=borjab\">borjab</a>:</i>\n<p>Just for reference.  I am strugging to create a deterministic and faster test.  But at least I  have seen a pattern after injecting connectionStateListeners.  Errors appear 95% of the time with the following sequence. </p>\n\n<p>Client A: Connection SUSPENDED<br/>\nClient A: Connection RECONNECTED<br/>\nClient B or A: Connection SUSPENDED<br/>\nClient A or B: Connection SUSPENDED<br/>\nClient A:Connection: RECONNECTED<br/>\nClient B:Connection: RECONNECTED</p>\n\n<p>Resulting in two toLeader() events in both clients.  I have tried to reduce the timming to make it faster but then errors tend to disappear <img class=\"emoticon\" src=\"https://issues.apache.org/jira/images/icons/emoticons/sad.png\" height=\"16\" width=\"16\" align=\"absmiddle\" alt=\"\" border=\"0\"/></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763795/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763568","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763568","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763568,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1Njg=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-05T20:47:00Z","updated_at":"2025-01-21T13:38:23Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r155071186\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r155071186</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/CuratorFrameworkImpl.java &#8212;<br/>\n    @@ -973,6 +981,33 @@ void performBackgroundOperation(OperationAndData<?> operationAndData)<br/>\n     }<br/>\n }</p>\n\n<p>    +    @VisibleForTesting<br/>\n    +    volatile long sleepAndQueueOperationSeconds = 1;<br/>\n    +<br/>\n    +    private void sleepAndQueueOperation(OperationAndData<?> operationAndData) throws InterruptedException<br/>\n    +    {<br/>\n    +operationAndData.sleepFor(sleepAndQueueOperationSeconds, TimeUnit.SECONDS);<br/>\n    +if ( queueOperation(operationAndData) )<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    Yes, the only reason it wouldn't be queued is that the handle is closing, etc. `false` is the indication that no further operations are needed.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763571","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763571","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763571,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1NzE=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-05T21:02:46Z","updated_at":"2025-01-21T13:38:23Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user madrob commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r155074746\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r155074746</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/OperationAndData.java &#8212;<br/>\n    @@ -115,6 +115,11 @@ BackgroundCallback getCallback()<br/>\n     return operation;<br/>\n }</p>\n\n<p>    +    void clearSleep()<br/>\n    +    {<br/>\n    +sleepUntilTimeMs.set(0);<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    I think this should be set to the time to current time (equivalent to `sleepFor(0)`), rather than blowing it away and setting to zero.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763572","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763572","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763572,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1NzI=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-05T21:50:10Z","updated_at":"2025-01-21T13:38:23Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242#discussion_r155086416\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242#discussion_r155086416</a></p>\n\n<p>    &#8212; Diff: curator-framework/src/main/java/org/apache/curator/framework/imps/OperationAndData.java &#8212;<br/>\n    @@ -115,6 +115,11 @@ BackgroundCallback getCallback()<br/>\n     return operation;<br/>\n }</p>\n\n<p>    +    void clearSleep()<br/>\n    +    {<br/>\n    +sleepUntilTimeMs.set(0);<br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    But 0 is fine and very clear</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763572/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763898","html_url":"https://github.com/apache/curator/issues/965#issuecomment-2604763898","issue_url":"https://api.github.com/repos/apache/curator/issues/965","id":2604763898,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM4OTg=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-14T10:28:56Z","updated_at":"2025-01-21T13:38:32Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>GitHub user kghost opened a pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/246\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/246</a></p>\n\n<p>    Detect ZooKeeper 3.5.x under OSGi</p>\n\n<p>    Fix: <a href=\"https://issues.apache.org/jira/browse/CURATOR-445\" title=\"Curator failed to detect ZooKeeper 3.5.x under OSGi\" class=\"issue-link\" data-issue-key=\"CURATOR-445\"><del>CURATOR-445</del></a></p>\n\n<p>You can merge this pull request into a Git repository by running:</p>\n\n<p>    $ git pull <a href=\"https://github.com/kghost/curator\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/kghost/curator</a> <a href=\"https://issues.apache.org/jira/browse/CURATOR-445\" title=\"Curator failed to detect ZooKeeper 3.5.x under OSGi\" class=\"issue-link\" data-issue-key=\"CURATOR-445\"><del>CURATOR-445</del></a></p>\n\n<p>Alternatively you can review and apply these changes as the patch at:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/246.patch\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/246.patch</a></p>\n\n<p>To close this pull request, make a commit to your master/trunk branch<br/>\nwith (at least) the following in the commit message:</p>\n\n<p>    This closes #246</p>\n\n<hr />\n<p>commit 477438ab129da3d53ef9974ff0a088a63f3b8647<br/>\nAuthor: Zang MingJie <zealot0630@gmail.com><br/>\nDate:   2017-12-14T10:27:36Z</p>\n\n<p>    Detect ZooKeeper 3.5.x under OSGi</p>\n\n<p>    Fix: <a href=\"https://issues.apache.org/jira/browse/CURATOR-445\" title=\"Curator failed to detect ZooKeeper 3.5.x under OSGi\" class=\"issue-link\" data-issue-key=\"CURATOR-445\"><del>CURATOR-445</del></a></p>\n\n<hr />","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763898/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/351776022","html_url":"https://github.com/apache/curator/pull/245#issuecomment-351776022","issue_url":"https://api.github.com/repos/apache/curator/issues/245","id":351776022,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTc3NjAyMg==","user":{"login":"dragonsinth","id":1919660,"node_id":"MDQ6VXNlcjE5MTk2NjA=","avatar_url":"https://avatars.githubusercontent.com/u/1919660?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonsinth","html_url":"https://github.com/dragonsinth","followers_url":"https://api.github.com/users/dragonsinth/followers","following_url":"https://api.github.com/users/dragonsinth/following{/other_user}","gists_url":"https://api.github.com/users/dragonsinth/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonsinth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonsinth/subscriptions","organizations_url":"https://api.github.com/users/dragonsinth/orgs","repos_url":"https://api.github.com/users/dragonsinth/repos","events_url":"https://api.github.com/users/dragonsinth/events{/privacy}","received_events_url":"https://api.github.com/users/dragonsinth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-14T17:12:08Z","updated_at":"2017-12-14T17:12:08Z","author_association":"CONTRIBUTOR","body":"hi leyoliu,\r\n\r\nThank you for contribution.\r\n\r\nThere are many tests about order of events on startup.  For example: TestTreeCache.testStartup()\r\n\r\nAre you able to write a test to show the failure you see?\r\n\r\nThank you,\r\nScott\r\n","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/351776022/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/352188988","html_url":"https://github.com/apache/curator/pull/245#issuecomment-352188988","issue_url":"https://api.github.com/repos/apache/curator/issues/245","id":352188988,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MjE4ODk4OA==","user":{"login":"leyoliu1987","id":32660478,"node_id":"MDQ6VXNlcjMyNjYwNDc4","avatar_url":"https://avatars.githubusercontent.com/u/32660478?v=4","gravatar_id":"","url":"https://api.github.com/users/leyoliu1987","html_url":"https://github.com/leyoliu1987","followers_url":"https://api.github.com/users/leyoliu1987/followers","following_url":"https://api.github.com/users/leyoliu1987/following{/other_user}","gists_url":"https://api.github.com/users/leyoliu1987/gists{/gist_id}","starred_url":"https://api.github.com/users/leyoliu1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leyoliu1987/subscriptions","organizations_url":"https://api.github.com/users/leyoliu1987/orgs","repos_url":"https://api.github.com/users/leyoliu1987/repos","events_url":"https://api.github.com/users/leyoliu1987/events{/privacy}","received_events_url":"https://api.github.com/users/leyoliu1987/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-16T15:06:17Z","updated_at":"2017-12-16T15:06:17Z","author_association":"NONE","body":"Hi  Mr Scott,\r\n    Thank you for reply me! I test my appliation many times again, below is my simple code and running result and zookeeper Node structure.\r\n\r\nzk node structure:\r\n TOPIC\r\n     LISTENERIPS:192.168.58.22\r\n     SENDCHANNEL\r\n     \t\tSMS:true\r\n\t\tWECHAT:false\r\n\t\tWEBSOCKET:dragnet\r\n     SERVERNAME:test\r\n     TOPICNAME:dragnet\r\n\r\n\r\n public class TopicTreeListener implements TreeCacheListener {\r\n\t\r\n\t@Override\r\n\tpublic void childEvent(CuratorFramework client, TreeCacheEvent event) throws Exception {\r\n\t\tChildData data = event.getData();\r\n\t\tType type = event.getType();\r\n\t\tSystem.out.println(\"type=\"+type);\r\n        }\r\n}\r\n\r\nbelow is my running result:\r\n    \r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=INITIALIZED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\n\r\n![image](https://user-images.githubusercontent.com/32660478/34071705-4276f034-e2b5-11e7-966c-d69d153211ed.png)\r\n\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/352188988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764007","html_url":"https://github.com/apache/curator/issues/966#issuecomment-2604764007","issue_url":"https://api.github.com/repos/apache/curator/issues/966","id":2604764007,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQwMDc=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-18T20:39:42Z","updated_at":"2025-01-21T13:38:36Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mserrano\">mserrano</a>:</i>\n<p>Note, while curator is compatible with ZK 3.4.x at runtime, the test ZK classes <tt>TestingZooKeeperMain</tt> and <tt>QuorumConfigBuilder</tt> (and perhaps others) use 3.5.x ZK APIs.  This means ZK 3.5.x jars need to be in the classpath for testing purposes.  This makes it very difficult to use curator 4.0.0 if the you want to work with 3.4.x.  Since ZK 3.5.x has API incompatibilities with ZK 3.4.x, it is not viable to put ZK 3.5.x in the classpath just during testing.</p>\n\n<p>IMO, this means it is not realistic to make the soft-compatibility claim with 3.4.x and the priority of this bug should be raised or the compatibility claim removed.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764010","html_url":"https://github.com/apache/curator/issues/966#issuecomment-2604764010","issue_url":"https://api.github.com/repos/apache/curator/issues/966","id":2604764010,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQwMTA=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-18T20:55:33Z","updated_at":"2025-01-21T13:38:36Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=randgalt\">randgalt</a>:</i>\n<p>We didn't claim that you could use Curator's test module with 3.4.x. But, as you point out, it would be useful. I'll see what I can do.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764019","html_url":"https://github.com/apache/curator/issues/966#issuecomment-2604764019","issue_url":"https://api.github.com/repos/apache/curator/issues/966","id":2604764019,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQwMTk=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-18T21:02:34Z","updated_at":"2025-01-21T13:38:36Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=randgalt\">randgalt</a>:</i>\n<p>If you want to use Curator's test lib with Zookeeper 3.4.x you need to use the older version (as Curator itself does in the curator-test-zk34 module):</p>\n\n<div class=\"code panel\" style=\"border-width: 1px;\"><div class=\"codeContent panelContent\">\n<pre class=\"code-java\">\n<dependency>\n    <groupId>org.apache.curator</groupId>\n    <artifactId>curator-test</artifactId>\n    <version>2.12.0</version>\n    <exclusions>\n<exclusion>\n    <groupId>org.apache.zookeeper</groupId>\n    <artifactId>zookeeper</artifactId>\n</exclusion>\n    </exclusions>\n    <scope>test</scope>\n</dependency>\n</pre>\n</div></div>\n\n<p>I'll update the docs when I get a chance.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764019/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764025","html_url":"https://github.com/apache/curator/issues/966#issuecomment-2604764025","issue_url":"https://api.github.com/repos/apache/curator/issues/966","id":2604764025,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQwMjU=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-19T01:37:07Z","updated_at":"2025-01-21T13:38:36Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mserrano\">mserrano</a>:</i>\n<p>Oh... duh! </p>\n\n<p>Thanks Jordan.  Works perfectly.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764025/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764030","html_url":"https://github.com/apache/curator/issues/966#issuecomment-2604764030","issue_url":"https://api.github.com/repos/apache/curator/issues/966","id":2604764030,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQwMzA=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-19T02:14:26Z","updated_at":"2025-01-21T13:38:36Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>GitHub user Randgalt opened a pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/248\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/248</a></p>\n\n<p>    <a href=\"https://issues.apache.org/jira/browse/CURATOR-446\" title=\"Compile error with tests using 4.0.0 and ZK 3.4.11 - need to update docs on how to use old test lib\" class=\"issue-link\" data-issue-key=\"CURATOR-446\"><del>CURATOR-446</del></a> Update docs to document how to use the curator-test module with ZooKeeper 3.4.x</p>\n\n<p>    Update docs to document how to use the curator-test module with ZooKeeper 3.4.x</p>\n\n<p>You can merge this pull request into a Git repository by running:</p>\n\n<p>    $ git pull <a href=\"https://github.com/apache/curator\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator</a> <a href=\"https://issues.apache.org/jira/browse/CURATOR-446\" title=\"Compile error with tests using 4.0.0 and ZK 3.4.11 - need to update docs on how to use old test lib\" class=\"issue-link\" data-issue-key=\"CURATOR-446\"><del>CURATOR-446</del></a></p>\n\n<p>Alternatively you can review and apply these changes as the patch at:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/248.patch\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/248.patch</a></p>\n\n<p>To close this pull request, make a commit to your master/trunk branch<br/>\nwith (at least) the following in the commit message:</p>\n\n<p>    This closes #248</p>\n\n<hr />\n<p>commit e37cb59c1e9b7ac7f21d3c3444b6bb789a3e3708<br/>\nAuthor: randgalt <randgalt@apache.org><br/>\nDate:   2017-12-19T02:11:27Z</p>\n\n<p>    Update docs to document how to use the curator-test module with ZooKeeper 3.4.x</p>\n\n<hr />","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764030/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/352646006","html_url":"https://github.com/apache/curator/pull/245#issuecomment-352646006","issue_url":"https://api.github.com/repos/apache/curator/issues/245","id":352646006,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MjY0NjAwNg==","user":{"login":"leyoliu1987","id":32660478,"node_id":"MDQ6VXNlcjMyNjYwNDc4","avatar_url":"https://avatars.githubusercontent.com/u/32660478?v=4","gravatar_id":"","url":"https://api.github.com/users/leyoliu1987","html_url":"https://github.com/leyoliu1987","followers_url":"https://api.github.com/users/leyoliu1987/followers","following_url":"https://api.github.com/users/leyoliu1987/following{/other_user}","gists_url":"https://api.github.com/users/leyoliu1987/gists{/gist_id}","starred_url":"https://api.github.com/users/leyoliu1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leyoliu1987/subscriptions","organizations_url":"https://api.github.com/users/leyoliu1987/orgs","repos_url":"https://api.github.com/users/leyoliu1987/repos","events_url":"https://api.github.com/users/leyoliu1987/events{/privacy}","received_events_url":"https://api.github.com/users/leyoliu1987/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-19T05:45:07Z","updated_at":"2017-12-19T05:45:07Z","author_association":"NONE","body":"Hi Mr Scott,\r\n    I'm waiting your reply","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/352646006/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/352646473","html_url":"https://github.com/apache/curator/pull/245#issuecomment-352646473","issue_url":"https://api.github.com/repos/apache/curator/issues/245","id":352646473,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MjY0NjQ3Mw==","user":{"login":"leyoliu1987","id":32660478,"node_id":"MDQ6VXNlcjMyNjYwNDc4","avatar_url":"https://avatars.githubusercontent.com/u/32660478?v=4","gravatar_id":"","url":"https://api.github.com/users/leyoliu1987","html_url":"https://github.com/leyoliu1987","followers_url":"https://api.github.com/users/leyoliu1987/followers","following_url":"https://api.github.com/users/leyoliu1987/following{/other_user}","gists_url":"https://api.github.com/users/leyoliu1987/gists{/gist_id}","starred_url":"https://api.github.com/users/leyoliu1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leyoliu1987/subscriptions","organizations_url":"https://api.github.com/users/leyoliu1987/orgs","repos_url":"https://api.github.com/users/leyoliu1987/repos","events_url":"https://api.github.com/users/leyoliu1987/events{/privacy}","received_events_url":"https://api.github.com/users/leyoliu1987/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-19T05:48:33Z","updated_at":"2017-12-19T05:48:33Z","author_association":"NONE","body":"Hi Mr Scott,\r\nThank you for reply me! I test my appliation many times again, below is my simple code and running result and zookeeper Node structure.\r\n\r\nzk node structure:\r\nTOPIC\r\nLISTENERIPS:192.168.58.22\r\nSENDCHANNEL\r\nSMS:true\r\nWECHAT:false\r\nWEBSOCKET:dragnet\r\nSERVERNAME:test\r\nTOPICNAME:dragnet\r\n\r\npublic class TopicTreeListener implements TreeCacheListener {\r\n\r\n@Override\r\npublic void childEvent(CuratorFramework client, TreeCacheEvent event) throws Exception {\r\n\tChildData data = event.getData();\r\n\tType type = event.getType();\r\n\tSystem.out.println(\"type=\"+type);\r\n    }\r\n}\r\n\r\nbelow is my running result:\r\n\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=INITIALIZED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\ntype=NODE_ADDED\r\n\r\nhttps://user-images.githubusercontent.com/32660478/34071705-4276f034-e2b5-11e7-966c-d69d153211ed.png\r\n","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/352646473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604754661","html_url":"https://github.com/apache/curator/issues/908#issuecomment-2604754661","issue_url":"https://api.github.com/repos/apache/curator/issues/908","id":2604754661,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NTQ2NjE=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-20T20:40:28Z","updated_at":"2025-01-21T13:34:44Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>GitHub user Randgalt opened a pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/249\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/249</a></p>\n\n<p>    <a href=\"https://issues.apache.org/jira/browse/CURATOR-388\" title=\"PathChildrenCache stops working if container node is auto-removed and later recreated\" class=\"issue-link\" data-issue-key=\"CURATOR-388\"><del>CURATOR-388</del></a> PathChildrenCache stops working if container node is auto-removed</p>\n\n<p>    PathChildrenCache stops working if container node is auto-removed and later recreated - test and a fix</p>\n\n<p>You can merge this pull request into a Git repository by running:</p>\n\n<p>    $ git pull <a href=\"https://github.com/apache/curator\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator</a> <a href=\"https://issues.apache.org/jira/browse/CURATOR-388\" title=\"PathChildrenCache stops working if container node is auto-removed and later recreated\" class=\"issue-link\" data-issue-key=\"CURATOR-388\"><del>CURATOR-388</del></a></p>\n\n<p>Alternatively you can review and apply these changes as the patch at:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/249.patch\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/249.patch</a></p>\n\n<p>To close this pull request, make a commit to your master/trunk branch<br/>\nwith (at least) the following in the commit message:</p>\n\n<p>    This closes #249</p>\n\n<hr />\n<p>commit 21b0877842d12c61f5c8c7f886d596809e12a628<br/>\nAuthor: randgalt <randgalt@...><br/>\nDate:   2017-12-20T20:39:37Z</p>\n\n<p>    PathChildrenCache stops working if container node is auto-removed and later recreated - test and a fix</p>\n\n<hr />","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604754661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/353214628","html_url":"https://github.com/apache/curator/pull/245#issuecomment-353214628","issue_url":"https://api.github.com/repos/apache/curator/issues/245","id":353214628,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzIxNDYyOA==","user":{"login":"dragonsinth","id":1919660,"node_id":"MDQ6VXNlcjE5MTk2NjA=","avatar_url":"https://avatars.githubusercontent.com/u/1919660?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonsinth","html_url":"https://github.com/dragonsinth","followers_url":"https://api.github.com/users/dragonsinth/followers","following_url":"https://api.github.com/users/dragonsinth/following{/other_user}","gists_url":"https://api.github.com/users/dragonsinth/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonsinth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonsinth/subscriptions","organizations_url":"https://api.github.com/users/dragonsinth/orgs","repos_url":"https://api.github.com/users/dragonsinth/repos","events_url":"https://api.github.com/users/dragonsinth/events{/privacy}","received_events_url":"https://api.github.com/users/dragonsinth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-20T23:38:21Z","updated_at":"2017-12-20T23:38:21Z","author_association":"CONTRIBUTOR","body":"Hi @leyoliu1987 I tried but I cannot reproduce your problem.\r\n\r\nI added a new example, https://github.com/apache/curator/blob/master/curator-examples/src/main/java/cache/TreeCacheExample.java\r\n\r\nWhen I run TreeCacheExample, I do not your problem.  I see INITIALIZED happen at the very end after all NODE_ADDED events.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/353214628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/353215658","html_url":"https://github.com/apache/curator/pull/248#issuecomment-353215658","issue_url":"https://api.github.com/repos/apache/curator/issues/248","id":353215658,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzIxNTY1OA==","user":{"login":"cammckenzie","id":7763121,"node_id":"MDQ6VXNlcjc3NjMxMjE=","avatar_url":"https://avatars.githubusercontent.com/u/7763121?v=4","gravatar_id":"","url":"https://api.github.com/users/cammckenzie","html_url":"https://github.com/cammckenzie","followers_url":"https://api.github.com/users/cammckenzie/followers","following_url":"https://api.github.com/users/cammckenzie/following{/other_user}","gists_url":"https://api.github.com/users/cammckenzie/gists{/gist_id}","starred_url":"https://api.github.com/users/cammckenzie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cammckenzie/subscriptions","organizations_url":"https://api.github.com/users/cammckenzie/orgs","repos_url":"https://api.github.com/users/cammckenzie/repos","events_url":"https://api.github.com/users/cammckenzie/events{/privacy}","received_events_url":"https://api.github.com/users/cammckenzie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-20T23:45:22Z","updated_at":"2017-12-20T23:45:22Z","author_association":"CONTRIBUTOR","body":"Looks ok to me.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/353215658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764035","html_url":"https://github.com/apache/curator/issues/966#issuecomment-2604764035","issue_url":"https://api.github.com/repos/apache/curator/issues/966","id":2604764035,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQwMzU=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-20T23:45:24Z","updated_at":"2025-01-21T13:38:36Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user cammckenzie commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/248\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/248</a></p>\n\n<p>    Looks ok to me.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764039","html_url":"https://github.com/apache/curator/issues/966#issuecomment-2604764039","issue_url":"https://api.github.com/repos/apache/curator/issues/966","id":2604764039,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQwMzk=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-20T23:50:52Z","updated_at":"2025-01-21T13:38:36Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user asfgit closed the pull request at:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/248\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/248</a></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/353523607","html_url":"https://github.com/apache/curator/pull/249#issuecomment-353523607","issue_url":"https://api.github.com/repos/apache/curator/issues/249","id":353523607,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzUyMzYwNw==","user":{"login":"cammckenzie","id":7763121,"node_id":"MDQ6VXNlcjc3NjMxMjE=","avatar_url":"https://avatars.githubusercontent.com/u/7763121?v=4","gravatar_id":"","url":"https://api.github.com/users/cammckenzie","html_url":"https://github.com/cammckenzie","followers_url":"https://api.github.com/users/cammckenzie/followers","following_url":"https://api.github.com/users/cammckenzie/following{/other_user}","gists_url":"https://api.github.com/users/cammckenzie/gists{/gist_id}","starred_url":"https://api.github.com/users/cammckenzie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cammckenzie/subscriptions","organizations_url":"https://api.github.com/users/cammckenzie/orgs","repos_url":"https://api.github.com/users/cammckenzie/repos","events_url":"https://api.github.com/users/cammckenzie/events{/privacy}","received_events_url":"https://api.github.com/users/cammckenzie/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-22T05:14:00Z","updated_at":"2017-12-22T05:14:00Z","author_association":"CONTRIBUTOR","body":"I think this looks OK.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/353523607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604754669","html_url":"https://github.com/apache/curator/issues/908#issuecomment-2604754669","issue_url":"https://api.github.com/repos/apache/curator/issues/908","id":2604754669,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NTQ2Njk=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-22T05:14:02Z","updated_at":"2025-01-21T13:34:44Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user cammckenzie commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/249\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/249</a></p>\n\n<p>    I think this looks OK.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604754669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604754676","html_url":"https://github.com/apache/curator/issues/908#issuecomment-2604754676","issue_url":"https://api.github.com/repos/apache/curator/issues/908","id":2604754676,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NTQ2NzY=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-22T05:22:23Z","updated_at":"2025-01-21T13:34:44Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user asfgit closed the pull request at:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/249\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/249</a></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604754676/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/353547466","html_url":"https://github.com/apache/curator/pull/245#issuecomment-353547466","issue_url":"https://api.github.com/repos/apache/curator/issues/245","id":353547466,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzU0NzQ2Ng==","user":{"login":"leyoliu1987","id":32660478,"node_id":"MDQ6VXNlcjMyNjYwNDc4","avatar_url":"https://avatars.githubusercontent.com/u/32660478?v=4","gravatar_id":"","url":"https://api.github.com/users/leyoliu1987","html_url":"https://github.com/leyoliu1987","followers_url":"https://api.github.com/users/leyoliu1987/followers","following_url":"https://api.github.com/users/leyoliu1987/following{/other_user}","gists_url":"https://api.github.com/users/leyoliu1987/gists{/gist_id}","starred_url":"https://api.github.com/users/leyoliu1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leyoliu1987/subscriptions","organizations_url":"https://api.github.com/users/leyoliu1987/orgs","repos_url":"https://api.github.com/users/leyoliu1987/repos","events_url":"https://api.github.com/users/leyoliu1987/events{/privacy}","received_events_url":"https://api.github.com/users/leyoliu1987/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-22T08:22:26Z","updated_at":"2017-12-22T08:22:26Z","author_association":"NONE","body":"Hi Mr Scott,\r\n    I absolutely aggree you are right when you use \"cache.getListenable().addListener(T listener)\",can you try more time by using \"cache.getListenable().addListener(T listener, Executor executor)\" like below:\r\n\r\npublic class TreeCacheExample\r\n{\r\n    public static void main(String[] args) throws Exception\r\n    {\r\n        CuratorFramework client = CreateClientExamples.createSimple(\"127.0.0.1:2181\");\r\n        client.getUnhandledErrorListenable().addListener((message, e) -> {\r\n            System.err.println(\"error=\" + message);\r\n            e.printStackTrace();\r\n        });\r\n        client.getConnectionStateListenable().addListener((c, newState) -> {\r\n            System.out.println(\"state=\" + newState);\r\n        });\r\n        client.start();\r\n\r\n        TreeCache cache = TreeCache.newBuilder(client, \"/\").setCacheData(false).build();\r\n         **ExecutorService pool = Executors.newFixedThreadPool(10);**\r\n        cache.getListenable().addListener((c, event) -> {\r\n            if ( event.getData() != null )\r\n            {\r\n                System.out.println(\"type=\" + event.getType() + \" path=\" + event.getData().getPath());\r\n            }\r\n            else\r\n            {\r\n                System.out.println(\"type=\" + event.getType());\r\n            }\r\n        },**pool** );\r\n        cache.start();\r\n\r\n        BufferedReader in = new BufferedReader(new InputStreamReader(System.in));\r\n        in.readLine();\r\n    }\r\n}\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/353547466/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/353549061","html_url":"https://github.com/apache/curator/pull/245#issuecomment-353549061","issue_url":"https://api.github.com/repos/apache/curator/issues/245","id":353549061,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzU0OTA2MQ==","user":{"login":"leyoliu1987","id":32660478,"node_id":"MDQ6VXNlcjMyNjYwNDc4","avatar_url":"https://avatars.githubusercontent.com/u/32660478?v=4","gravatar_id":"","url":"https://api.github.com/users/leyoliu1987","html_url":"https://github.com/leyoliu1987","followers_url":"https://api.github.com/users/leyoliu1987/followers","following_url":"https://api.github.com/users/leyoliu1987/following{/other_user}","gists_url":"https://api.github.com/users/leyoliu1987/gists{/gist_id}","starred_url":"https://api.github.com/users/leyoliu1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leyoliu1987/subscriptions","organizations_url":"https://api.github.com/users/leyoliu1987/orgs","repos_url":"https://api.github.com/users/leyoliu1987/repos","events_url":"https://api.github.com/users/leyoliu1987/events{/privacy}","received_events_url":"https://api.github.com/users/leyoliu1987/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-22T08:32:12Z","updated_at":"2017-12-22T08:32:12Z","author_association":"NONE","body":"if use  \"  ExecutorService pool = Executors..newCachedThreadPool()\" as ThreadPool is no problem. I don't know why .","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/353549061/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/353629445","html_url":"https://github.com/apache/curator/pull/245#issuecomment-353629445","issue_url":"https://api.github.com/repos/apache/curator/issues/245","id":353629445,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzYyOTQ0NQ==","user":{"login":"dragonsinth","id":1919660,"node_id":"MDQ6VXNlcjE5MTk2NjA=","avatar_url":"https://avatars.githubusercontent.com/u/1919660?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonsinth","html_url":"https://github.com/dragonsinth","followers_url":"https://api.github.com/users/dragonsinth/followers","following_url":"https://api.github.com/users/dragonsinth/following{/other_user}","gists_url":"https://api.github.com/users/dragonsinth/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonsinth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonsinth/subscriptions","organizations_url":"https://api.github.com/users/dragonsinth/orgs","repos_url":"https://api.github.com/users/dragonsinth/repos","events_url":"https://api.github.com/users/dragonsinth/events{/privacy}","received_events_url":"https://api.github.com/users/dragonsinth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-12-22T16:17:25Z","updated_at":"2017-12-22T16:17:25Z","author_association":"CONTRIBUTOR","body":"Hi @leyoliu1987,\r\n\r\n I think the executor is your problem.  If you use `Executors.newFixedThreadPool(10)` you are creating 10 different threads to handle events on.  When numerous events fire at close to the same time, you will handle all of those events _concurrently_.  That makes you will observe them simultaneously / concurrently / out of order / in a racy way.  So this is not a TreeCache problem.  If you use a single-threaded executor you should see everything in sequential order.\r\n\r\nThanks!\r\nScott\r\n ","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/353629445/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/354790335","html_url":"https://github.com/apache/curator/pull/242#issuecomment-354790335","issue_url":"https://api.github.com/repos/apache/curator/issues/242","id":354790335,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDc5MDMzNQ==","user":{"login":"Randgalt","id":264818,"node_id":"MDQ6VXNlcjI2NDgxOA==","avatar_url":"https://avatars.githubusercontent.com/u/264818?v=4","gravatar_id":"","url":"https://api.github.com/users/Randgalt","html_url":"https://github.com/Randgalt","followers_url":"https://api.github.com/users/Randgalt/followers","following_url":"https://api.github.com/users/Randgalt/following{/other_user}","gists_url":"https://api.github.com/users/Randgalt/gists{/gist_id}","starred_url":"https://api.github.com/users/Randgalt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Randgalt/subscriptions","organizations_url":"https://api.github.com/users/Randgalt/orgs","repos_url":"https://api.github.com/users/Randgalt/repos","events_url":"https://api.github.com/users/Randgalt/events{/privacy}","received_events_url":"https://api.github.com/users/Randgalt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T15:23:49Z","updated_at":"2018-01-02T15:23:49Z","author_association":"MEMBER","body":"@madrob you OK with merging this now? ","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/354790335/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763584","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763584","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763584,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1ODQ=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T15:23:52Z","updated_at":"2025-01-21T13:38:23Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242</a></p>\n\n<p>    @madrob you OK with merging this now? </p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/354791465","html_url":"https://github.com/apache/curator/pull/247#issuecomment-354791465","issue_url":"https://api.github.com/repos/apache/curator/issues/247","id":354791465,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDc5MTQ2NQ==","user":{"login":"Randgalt","id":264818,"node_id":"MDQ6VXNlcjI2NDgxOA==","avatar_url":"https://avatars.githubusercontent.com/u/264818?v=4","gravatar_id":"","url":"https://api.github.com/users/Randgalt","html_url":"https://github.com/Randgalt","followers_url":"https://api.github.com/users/Randgalt/followers","following_url":"https://api.github.com/users/Randgalt/following{/other_user}","gists_url":"https://api.github.com/users/Randgalt/gists{/gist_id}","starred_url":"https://api.github.com/users/Randgalt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Randgalt/subscriptions","organizations_url":"https://api.github.com/users/Randgalt/orgs","repos_url":"https://api.github.com/users/Randgalt/repos","events_url":"https://api.github.com/users/Randgalt/events{/privacy}","received_events_url":"https://api.github.com/users/Randgalt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T15:28:19Z","updated_at":"2018-01-02T15:28:19Z","author_association":"MEMBER","body":"I don't know why you think lockCount is not involved in \"multithreading\" but I assure you that it is.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/354791465/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/354800187","html_url":"https://github.com/apache/curator/pull/242#issuecomment-354800187","issue_url":"https://api.github.com/repos/apache/curator/issues/242","id":354800187,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDgwMDE4Nw==","user":{"login":"madrob","id":1592330,"node_id":"MDQ6VXNlcjE1OTIzMzA=","avatar_url":"https://avatars.githubusercontent.com/u/1592330?v=4","gravatar_id":"","url":"https://api.github.com/users/madrob","html_url":"https://github.com/madrob","followers_url":"https://api.github.com/users/madrob/followers","following_url":"https://api.github.com/users/madrob/following{/other_user}","gists_url":"https://api.github.com/users/madrob/gists{/gist_id}","starred_url":"https://api.github.com/users/madrob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/madrob/subscriptions","organizations_url":"https://api.github.com/users/madrob/orgs","repos_url":"https://api.github.com/users/madrob/repos","events_url":"https://api.github.com/users/madrob/events{/privacy}","received_events_url":"https://api.github.com/users/madrob/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T16:02:57Z","updated_at":"2018-01-02T16:02:57Z","author_association":"CONTRIBUTOR","body":" ","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/354800187/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763591","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763591","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763591,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1OTE=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T16:03:00Z","updated_at":"2025-01-21T13:38:24Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user madrob commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242</a></p>\n\n<p>     </p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763591/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763597","html_url":"https://github.com/apache/curator/issues/963#issuecomment-2604763597","issue_url":"https://api.github.com/repos/apache/curator/issues/963","id":2604763597,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjM1OTc=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T16:04:13Z","updated_at":"2025-01-21T13:38:24Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user asfgit closed the pull request at:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/242\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/242</a></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604763597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/354804035","html_url":"https://github.com/apache/curator/pull/244#issuecomment-354804035","issue_url":"https://api.github.com/repos/apache/curator/issues/244","id":354804035,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDgwNDAzNQ==","user":{"login":"Randgalt","id":264818,"node_id":"MDQ6VXNlcjI2NDgxOA==","avatar_url":"https://avatars.githubusercontent.com/u/264818?v=4","gravatar_id":"","url":"https://api.github.com/users/Randgalt","html_url":"https://github.com/Randgalt","followers_url":"https://api.github.com/users/Randgalt/followers","following_url":"https://api.github.com/users/Randgalt/following{/other_user}","gists_url":"https://api.github.com/users/Randgalt/gists{/gist_id}","starred_url":"https://api.github.com/users/Randgalt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Randgalt/subscriptions","organizations_url":"https://api.github.com/users/Randgalt/orgs","repos_url":"https://api.github.com/users/Randgalt/repos","events_url":"https://api.github.com/users/Randgalt/events{/privacy}","received_events_url":"https://api.github.com/users/Randgalt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T16:17:11Z","updated_at":"2018-01-02T16:17:11Z","author_association":"MEMBER","body":"Sorry to be pedantic, but please first open an issue for this at http://issues.apache.org/jira/browse/CURATOR - see https://cwiki.apache.org/confluence/display/CURATOR/Submitting+Pull+Requests for details.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/354804035/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/354805224","html_url":"https://github.com/apache/curator/pull/239#issuecomment-354805224","issue_url":"https://api.github.com/repos/apache/curator/issues/239","id":354805224,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDgwNTIyNA==","user":{"login":"Randgalt","id":264818,"node_id":"MDQ6VXNlcjI2NDgxOA==","avatar_url":"https://avatars.githubusercontent.com/u/264818?v=4","gravatar_id":"","url":"https://api.github.com/users/Randgalt","html_url":"https://github.com/Randgalt","followers_url":"https://api.github.com/users/Randgalt/followers","following_url":"https://api.github.com/users/Randgalt/following{/other_user}","gists_url":"https://api.github.com/users/Randgalt/gists{/gist_id}","starred_url":"https://api.github.com/users/Randgalt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Randgalt/subscriptions","organizations_url":"https://api.github.com/users/Randgalt/orgs","repos_url":"https://api.github.com/users/Randgalt/repos","events_url":"https://api.github.com/users/Randgalt/events{/privacy}","received_events_url":"https://api.github.com/users/Randgalt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T16:21:52Z","updated_at":"2018-01-02T16:21:52Z","author_association":"MEMBER","body":"Duplicate of CURATOR-446 - https://github.com/apache/curator/pull/248","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/354805224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764041","html_url":"https://github.com/apache/curator/issues/966#issuecomment-2604764041","issue_url":"https://api.github.com/repos/apache/curator/issues/966","id":2604764041,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQwNDE=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T16:21:54Z","updated_at":"2025-01-21T13:38:37Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/239\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/239</a></p>\n\n<p>    Duplicate of <a href=\"https://issues.apache.org/jira/browse/CURATOR-446\" title=\"Compile error with tests using 4.0.0 and ZK 3.4.11 - need to update docs on how to use old test lib\" class=\"issue-link\" data-issue-key=\"CURATOR-446\"><del>CURATOR-446</del></a> - <a href=\"https://github.com/apache/curator/pull/248\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/248</a></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764041/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764143","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764143","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764143,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxNDM=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-02T20:36:47Z","updated_at":"2025-01-21T13:38:39Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>GitHub user njhill opened a pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    <a href=\"https://issues.apache.org/jira/browse/CURATOR-447\" title=\"TreeCache: Improve memory usage and concurrent update logic\" class=\"issue-link\" data-issue-key=\"CURATOR-447\"><del>CURATOR-447</del></a> TreeCache: Improve memory usage and thread safety</p>\n\n<p>    Jira <a href=\"https://issues.apache.org/jira/browse/CURATOR-374\" class=\"external-link\" rel=\"nofollow\">https://issues.apache.org/jira/browse/CURATOR-374</a> reduced per-node memory usage in `TreeCache`. It can be improved further via removal of the `nodeState` field - its `LIVE` state corresponds exactly to the adjacent `childData` field being non-null, and a sentinel `ChildData` value can be used for the `DEAD` state. This simplification also reduces the room for bugs and state inconsistencies.</p>\n\n<p>    Other improvements included:</p>\n<ul>\n\t<li>A further simplification to have `TreeNode` extend `AtomicReference`, which obviates the need for an explicit `childData` field</li>\n\t<li>More robust cache update logic (in get-children and get-data event callbacks)</li>\n\t<li>Avoid overhead of incrementing/decrementing the `outstandingOps` atomic integer post-initialization</li>\n</ul>\n\n\n<p>    See corresponding JIRA: <a href=\"https://issues.apache.org/jira/browse/CURATOR-447\" title=\"TreeCache: Improve memory usage and concurrent update logic\" class=\"issue-link\" data-issue-key=\"CURATOR-447\"><del>CURATOR-447</del></a>(<a href=\"https://issues.apache.org/jira/browse/CURATOR-447\" class=\"external-link\" rel=\"nofollow\">https://issues.apache.org/jira/browse/CURATOR-447</a>)</p>\n\n<p>You can merge this pull request into a Git repository by running:</p>\n\n<p>    $ git pull <a href=\"https://github.com/njhill/curator\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/njhill/curator</a> <a href=\"https://issues.apache.org/jira/browse/CURATOR-447\" title=\"TreeCache: Improve memory usage and concurrent update logic\" class=\"issue-link\" data-issue-key=\"CURATOR-447\"><del>CURATOR-447</del></a></p>\n\n<p>Alternatively you can review and apply these changes as the patch at:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250.patch\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250.patch</a></p>\n\n<p>To close this pull request, make a commit to your master/trunk branch<br/>\nwith (at least) the following in the commit message:</p>\n\n<p>    This closes #250</p>\n\n<hr />\n<p>commit 1c7be856fb514015286855f1ad9fd89069c32906<br/>\nAuthor: nickhill <nickhill@...><br/>\nDate:   2017-03-26T20:19:40Z</p>\n\n<p>    remove nodeState field, improve thread safety of cache updates</p>\n\n<p>    also simplify by having TreeNode extend AtomicReference<ChildData></p>\n\n<p>commit 67210556919d7f822c431597245c4fa7246901dd<br/>\nAuthor: nickhill <nickhill@...><br/>\nDate:   2017-03-26T20:20:32Z</p>\n\n<p>    avoid incrementing/decrementing outstandingOps post-initialization</p>\n\n<p>    no need to incur the synchronization overhead</p>\n\n<p>commit a5a680d50e50a0a804caa875a53e2ee8d9a268f9<br/>\nAuthor: nickhill <nickhill@...><br/>\nDate:   2018-01-02T16:36:20Z</p>\n\n<p>    remove superfluous braces</p>\n\n<hr />","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764143/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/355376125","html_url":"https://github.com/apache/curator/pull/208#issuecomment-355376125","issue_url":"https://api.github.com/repos/apache/curator/issues/208","id":355376125,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTM3NjEyNQ==","user":{"login":"adamdecaf","id":120951,"node_id":"MDQ6VXNlcjEyMDk1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/120951?v=4","gravatar_id":"","url":"https://api.github.com/users/adamdecaf","html_url":"https://github.com/adamdecaf","followers_url":"https://api.github.com/users/adamdecaf/followers","following_url":"https://api.github.com/users/adamdecaf/following{/other_user}","gists_url":"https://api.github.com/users/adamdecaf/gists{/gist_id}","starred_url":"https://api.github.com/users/adamdecaf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adamdecaf/subscriptions","organizations_url":"https://api.github.com/users/adamdecaf/orgs","repos_url":"https://api.github.com/users/adamdecaf/repos","events_url":"https://api.github.com/users/adamdecaf/events{/privacy}","received_events_url":"https://api.github.com/users/adamdecaf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-04T19:30:32Z","updated_at":"2018-01-04T19:30:32Z","author_association":"NONE","body":"Was this supposed to be backported to the 2.x series? We upgraded some clients to 2.12.0 and ran into this. \r\n\r\nhttps://github.com/apache/curator/blob/apache-curator-2.12.0/curator-x-discovery/src/main/java/org/apache/curator/x/discovery/details/JsonInstanceSerializer.java","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/355376125/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604756002","html_url":"https://github.com/apache/curator/issues/914#issuecomment-2604756002","issue_url":"https://api.github.com/repos/apache/curator/issues/914","id":2604756002,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NTYwMDI=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-04T19:30:38Z","updated_at":"2025-01-21T13:35:12Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user adamdecaf commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/208\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/208</a></p>\n\n<p>    Was this supposed to be backported to the 2.x series? We upgraded some clients to 2.12.0 and ran into this. </p>\n\n<p>    <a href=\"https://github.com/apache/curator/blob/apache-curator-2.12.0/curator-x-discovery/src/main/java/org/apache/curator/x/discovery/details/JsonInstanceSerializer.java\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/blob/apache-curator-2.12.0/curator-x-discovery/src/main/java/org/apache/curator/x/discovery/details/JsonInstanceSerializer.java</a></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604756002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/355377939","html_url":"https://github.com/apache/curator/pull/208#issuecomment-355377939","issue_url":"https://api.github.com/repos/apache/curator/issues/208","id":355377939,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTM3NzkzOQ==","user":{"login":"Randgalt","id":264818,"node_id":"MDQ6VXNlcjI2NDgxOA==","avatar_url":"https://avatars.githubusercontent.com/u/264818?v=4","gravatar_id":"","url":"https://api.github.com/users/Randgalt","html_url":"https://github.com/Randgalt","followers_url":"https://api.github.com/users/Randgalt/followers","following_url":"https://api.github.com/users/Randgalt/following{/other_user}","gists_url":"https://api.github.com/users/Randgalt/gists{/gist_id}","starred_url":"https://api.github.com/users/Randgalt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Randgalt/subscriptions","organizations_url":"https://api.github.com/users/Randgalt/orgs","repos_url":"https://api.github.com/users/Randgalt/repos","events_url":"https://api.github.com/users/Randgalt/events{/privacy}","received_events_url":"https://api.github.com/users/Randgalt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-04T19:37:35Z","updated_at":"2018-01-04T19:38:11Z","author_association":"MEMBER","body":"It was marked to go into 2.13.0 but was never released as we moved to a common binary for ZK 3.4 and 3.5. Have you tried 4.0.0? see: http://curator.apache.org/zk-compatibility.html\r\n  ","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/355377939/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604756010","html_url":"https://github.com/apache/curator/issues/914#issuecomment-2604756010","issue_url":"https://api.github.com/repos/apache/curator/issues/914","id":2604756010,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NTYwMTA=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-04T19:37:38Z","updated_at":"2025-01-21T13:35:12Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/208\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/208</a></p>\n\n<p>    It was marked to go into 2.13.0 but was never released as we moved to a common binary for ZK 3.4 and 3.5. Have you tried 4.0.0?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604756010/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/355378484","html_url":"https://github.com/apache/curator/pull/208#issuecomment-355378484","issue_url":"https://api.github.com/repos/apache/curator/issues/208","id":355378484,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTM3ODQ4NA==","user":{"login":"adamdecaf","id":120951,"node_id":"MDQ6VXNlcjEyMDk1MQ==","avatar_url":"https://avatars.githubusercontent.com/u/120951?v=4","gravatar_id":"","url":"https://api.github.com/users/adamdecaf","html_url":"https://github.com/adamdecaf","followers_url":"https://api.github.com/users/adamdecaf/followers","following_url":"https://api.github.com/users/adamdecaf/following{/other_user}","gists_url":"https://api.github.com/users/adamdecaf/gists{/gist_id}","starred_url":"https://api.github.com/users/adamdecaf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adamdecaf/subscriptions","organizations_url":"https://api.github.com/users/adamdecaf/orgs","repos_url":"https://api.github.com/users/adamdecaf/repos","events_url":"https://api.github.com/users/adamdecaf/events{/privacy}","received_events_url":"https://api.github.com/users/adamdecaf/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-04T19:39:46Z","updated_at":"2018-01-04T19:42:47Z","author_association":"NONE","body":"> Have you tried 4.0.0?\r\n\r\n~~Of curator?~~ No. We're actually moving off curator/zk in favor of another service discovery technology. I'm probably going to use the [JsonInstanceSerializer patch](https://github.com/apache/curator/blob/3ca02ea7f076d40333d664dd609962d0fe2e4c5f/curator-x-discovery/src/main/java/org/apache/curator/x/discovery/details/JsonInstanceSerializer.java) in our upgraded clients. \r\n  ","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/355378484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604756018","html_url":"https://github.com/apache/curator/issues/914#issuecomment-2604756018","issue_url":"https://api.github.com/repos/apache/curator/issues/914","id":2604756018,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NTYwMTg=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-04T19:39:48Z","updated_at":"2025-01-21T13:35:12Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user adamdecaf commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/208\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/208</a></p>\n\n<p>    > Have you tried 4.0.0?</p>\n\n<p>    Of curator? No. We're actually moving off curator/zk in favor of another service discovery technology. I'm probably going to use the <span class=\"error\">&#91;JsonInstanceSerializer patch&#93;</span>(<a href=\"https://github.com/apache/curator/blob/3ca02ea7f076d40333d664dd609962d0fe2e4c5f/curator-x-discovery/src/main/java/org/apache/curator/x/discovery/details/JsonInstanceSerializer.java\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/blob/3ca02ea7f076d40333d664dd609962d0fe2e4c5f/curator-x-discovery/src/main/java/org/apache/curator/x/discovery/details/JsonInstanceSerializer.java</a>) in our upgraded clients. </p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604756018/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/355850701","html_url":"https://github.com/apache/curator/pull/207#issuecomment-355850701","issue_url":"https://api.github.com/repos/apache/curator/issues/207","id":355850701,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTg1MDcwMQ==","user":{"login":"Randgalt","id":264818,"node_id":"MDQ6VXNlcjI2NDgxOA==","avatar_url":"https://avatars.githubusercontent.com/u/264818?v=4","gravatar_id":"","url":"https://api.github.com/users/Randgalt","html_url":"https://github.com/Randgalt","followers_url":"https://api.github.com/users/Randgalt/followers","following_url":"https://api.github.com/users/Randgalt/following{/other_user}","gists_url":"https://api.github.com/users/Randgalt/gists{/gist_id}","starred_url":"https://api.github.com/users/Randgalt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Randgalt/subscriptions","organizations_url":"https://api.github.com/users/Randgalt/orgs","repos_url":"https://api.github.com/users/Randgalt/repos","events_url":"https://api.github.com/users/Randgalt/events{/privacy}","received_events_url":"https://api.github.com/users/Randgalt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-07T20:37:09Z","updated_at":"2018-01-07T20:37:09Z","author_association":"MEMBER","body":"Sorry it's taken so long to address this... Can we get a test that shows the original problem with the fix?","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/355850701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604728491","html_url":"https://github.com/apache/curator/issues/753#issuecomment-2604728491","issue_url":"https://api.github.com/repos/apache/curator/issues/753","id":2604728491,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3Mjg0OTE=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-07T20:37:11Z","updated_at":"2025-01-21T13:24:24Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/207\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/207</a></p>\n\n<p>    Sorry it's taken so long to address this... Can we get a test that shows the original problem with the fix?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604728491/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/356004155","html_url":"https://github.com/apache/curator/pull/250#issuecomment-356004155","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":356004155,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjAwNDE1NQ==","user":{"login":"njhill","id":16958488,"node_id":"MDQ6VXNlcjE2OTU4NDg4","avatar_url":"https://avatars.githubusercontent.com/u/16958488?v=4","gravatar_id":"","url":"https://api.github.com/users/njhill","html_url":"https://github.com/njhill","followers_url":"https://api.github.com/users/njhill/followers","following_url":"https://api.github.com/users/njhill/following{/other_user}","gists_url":"https://api.github.com/users/njhill/gists{/gist_id}","starred_url":"https://api.github.com/users/njhill/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njhill/subscriptions","organizations_url":"https://api.github.com/users/njhill/orgs","repos_url":"https://api.github.com/users/njhill/repos","events_url":"https://api.github.com/users/njhill/events{/privacy}","received_events_url":"https://api.github.com/users/njhill/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-08T15:48:13Z","updated_at":"2018-01-08T15:48:13Z","author_association":"CONTRIBUTOR","body":"@dragonsinth @Randgalt any interest in these updates? FWIW I've had them running in production for some time.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/356004155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764147","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764147","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764147,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxNDc=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-08T15:48:15Z","updated_at":"2025-01-21T13:38:39Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user njhill commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    @dragonsinth @Randgalt any interest in these updates? FWIW I've had them running in production for some time.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/356005584","html_url":"https://github.com/apache/curator/pull/250#issuecomment-356005584","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":356005584,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjAwNTU4NA==","user":{"login":"Randgalt","id":264818,"node_id":"MDQ6VXNlcjI2NDgxOA==","avatar_url":"https://avatars.githubusercontent.com/u/264818?v=4","gravatar_id":"","url":"https://api.github.com/users/Randgalt","html_url":"https://github.com/Randgalt","followers_url":"https://api.github.com/users/Randgalt/followers","following_url":"https://api.github.com/users/Randgalt/following{/other_user}","gists_url":"https://api.github.com/users/Randgalt/gists{/gist_id}","starred_url":"https://api.github.com/users/Randgalt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Randgalt/subscriptions","organizations_url":"https://api.github.com/users/Randgalt/orgs","repos_url":"https://api.github.com/users/Randgalt/repos","events_url":"https://api.github.com/users/Randgalt/events{/privacy}","received_events_url":"https://api.github.com/users/Randgalt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-08T15:52:49Z","updated_at":"2018-01-08T15:52:49Z","author_association":"MEMBER","body":"I'll defer to @dragonsinth ","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/356005584/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764150","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764150","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764150,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxNTA=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-08T15:52:52Z","updated_at":"2025-01-21T13:38:39Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user Randgalt commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    I'll defer to @dragonsinth </p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/356095592","html_url":"https://github.com/apache/curator/pull/250#issuecomment-356095592","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":356095592,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjA5NTU5Mg==","user":{"login":"dragonsinth","id":1919660,"node_id":"MDQ6VXNlcjE5MTk2NjA=","avatar_url":"https://avatars.githubusercontent.com/u/1919660?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonsinth","html_url":"https://github.com/dragonsinth","followers_url":"https://api.github.com/users/dragonsinth/followers","following_url":"https://api.github.com/users/dragonsinth/following{/other_user}","gists_url":"https://api.github.com/users/dragonsinth/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonsinth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonsinth/subscriptions","organizations_url":"https://api.github.com/users/dragonsinth/orgs","repos_url":"https://api.github.com/users/dragonsinth/repos","events_url":"https://api.github.com/users/dragonsinth/events{/privacy}","received_events_url":"https://api.github.com/users/dragonsinth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-08T21:03:25Z","updated_at":"2018-01-08T21:03:25Z","author_association":"CONTRIBUTOR","body":"Hi @njhill just got back to work from vacation, and this is a little more than I can just eyeball, I gotta think through it a bit when I have more time.  I think I would like to see the removal of `nodeState` in isolation, perhaps with an explicit `PENDING` sentinel rather than just `null`.\r\n\r\nIt's not clear to me that `TreeNode extends AtomicReference` and `@Nullable outstandingOps` are wins.  The first one doesn't really save any memory, and for the second one, the ongoing CPU cost to update `outstandingOps` is basically nothing, it's almost certainly immeasurably tiny, and you have to introduce racy field reads to accomplish it.\r\n\r\nHave you done memory use measurements?  I would expect the memory footprint of `ConcurrentMap<String, TreeNode> children` to mostly dominate the memory overhead of our own classes, not to mention all the Watchers.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/356095592/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764157","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764157","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764157,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxNTc=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-08T21:03:28Z","updated_at":"2025-01-21T13:38:40Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    Hi @njhill just got back to work from vacation, and this is a little more than I can just eyeball, I gotta think through it a bit when I have more time.  I think I would like to see the removal of `nodeState` in isolation, perhaps with an explicit `PENDING` sentinel rather than just `null`.</p>\n\n<p>    It's not clear to me that `TreeNode extends AtomicReference` and `@Nullable outstandingOps` are wins.  The first one doesn't really save any memory, and for the second one, the ongoing CPU cost to update `outstandingOps` is basically nothing, it's almost certainly immeasurably tiny, and you have to introduce racy field reads to accomplish it.</p>\n\n<p>    Have you done memory use measurements?  I would expect the memory footprint of `ConcurrentMap<String, TreeNode> children` to mostly dominate the memory overhead of our own classes, not to mention all the Watchers.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/356134637","html_url":"https://github.com/apache/curator/pull/250#issuecomment-356134637","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":356134637,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjEzNDYzNw==","user":{"login":"njhill","id":16958488,"node_id":"MDQ6VXNlcjE2OTU4NDg4","avatar_url":"https://avatars.githubusercontent.com/u/16958488?v=4","gravatar_id":"","url":"https://api.github.com/users/njhill","html_url":"https://github.com/njhill","followers_url":"https://api.github.com/users/njhill/followers","following_url":"https://api.github.com/users/njhill/following{/other_user}","gists_url":"https://api.github.com/users/njhill/gists{/gist_id}","starred_url":"https://api.github.com/users/njhill/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njhill/subscriptions","organizations_url":"https://api.github.com/users/njhill/orgs","repos_url":"https://api.github.com/users/njhill/repos","events_url":"https://api.github.com/users/njhill/events{/privacy}","received_events_url":"https://api.github.com/users/njhill/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-08T23:54:19Z","updated_at":"2018-01-08T23:54:19Z","author_association":"CONTRIBUTOR","body":"Thanks @dragonsinth, there's of course no rush at all!\r\n\r\nI agree that `TreeNode extends AtomicReference` isn't a \"win\" as such, it just looked cleaner to me than using another `AtomicReferenceFieldUpdater`. But it's likely subjective and certainly a minor thing.\r\n\r\nThe `outstandingOps` change seems clearer to me - the field has no use for most of the life of the cache and yet is incremented/decremented on every single change. It's not the CPU cycle overhead but more the (CPU) cache coherency overhead since it's an `AtomicLong`. I didn't think the change introduces any raciness - the only times when `outstandingOps` needs to be modified (during initialization or re-initialization) it will be guaranteed to be non-null.\r\n\r\n> I would expect the memory footprint of `ConcurrentMap<String, TreeNode>` children to mostly dominate the memory overhead of our own classes\r\n\r\nGood point. The description of [CURATOR-374](https://issues.apache.org/jira/browse/CURATOR-374) implied this might have _some_ mem overhead benefit for very large caches, but removal of the `nodeState` field was motivated more by state simplification and consolidation of atomic updates. I'll do some quick measurements but I acknowledge percentage-wise the saving might not be significant.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/356134637/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764162","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764162","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764162,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxNjI=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-08T23:54:22Z","updated_at":"2025-01-21T13:38:40Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user njhill commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    Thanks @dragonsinth, there's of course no rush at all!</p>\n\n<p>    I agree that `TreeNode extends AtomicReference` isn't a \"win\" as such, it just looked cleaner to me than using another `AtomicReferenceFieldUpdater`. But it's likely subjective and certainly a minor thing.</p>\n\n<p>    The `outstandingOps` change seems clearer to me - the field has no use for most of the life of the cache and yet is incremented/decremented on every single change. It's not the CPU cycle overhead but more the (CPU) cache coherency overhead since it's an `AtomicLong`. I didn't think the change introduces any raciness - the only times when `outstandingOps` needs to be modified (during initialization or re-initialization) it will be guaranteed to be non-null.</p>\n\n<p>    > I would expect the memory footprint of `ConcurrentMap<String, TreeNode>` children to mostly dominate the memory overhead of our own classes</p>\n\n<p>    Good point. The description of <a href=\"https://issues.apache.org/jira/browse/CURATOR-374\" title=\"Reduce memory usage in TreeCache\" class=\"issue-link\" data-issue-key=\"CURATOR-374\"><del>CURATOR-374</del></a>(<a href=\"https://issues.apache.org/jira/browse/CURATOR-374\" class=\"external-link\" rel=\"nofollow\">https://issues.apache.org/jira/browse/CURATOR-374</a>) implied this might have <em>some</em> mem overhead benefit for very large caches, but removal of the `nodeState` field was motivated more by state simplification and consolidation of atomic updates. I'll do some quick measurements but I acknowledge percentage-wise the saving might not be significant.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764162/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/356315327","html_url":"https://github.com/apache/curator/pull/250#issuecomment-356315327","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":356315327,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjMxNTMyNw==","user":{"login":"njhill","id":16958488,"node_id":"MDQ6VXNlcjE2OTU4NDg4","avatar_url":"https://avatars.githubusercontent.com/u/16958488?v=4","gravatar_id":"","url":"https://api.github.com/users/njhill","html_url":"https://github.com/njhill","followers_url":"https://api.github.com/users/njhill/followers","following_url":"https://api.github.com/users/njhill/following{/other_user}","gists_url":"https://api.github.com/users/njhill/gists{/gist_id}","starred_url":"https://api.github.com/users/njhill/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njhill/subscriptions","organizations_url":"https://api.github.com/users/njhill/orgs","repos_url":"https://api.github.com/users/njhill/repos","events_url":"https://api.github.com/users/njhill/events{/privacy}","received_events_url":"https://api.github.com/users/njhill/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-09T15:22:54Z","updated_at":"2018-01-09T15:22:54Z","author_association":"CONTRIBUTOR","body":"@dragonsinth I've removed the `outstandingOps` change commit from the PR, and added a new commit which reverts the `TreeNode extends AtomicReference<ChildData>` change. Hopefully that helps to make this more palatable!","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/356315327/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764167","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764167","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764167,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxNjc=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-09T15:22:56Z","updated_at":"2025-01-21T13:38:40Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user njhill commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    @dragonsinth I've removed the `outstandingOps` change commit from the PR, and added a new commit which reverts the `TreeNode extends AtomicReference<ChildData>` change. Hopefully that helps to make this more palatable!</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604762069","html_url":"https://github.com/apache/curator/issues/952#issuecomment-2604762069","issue_url":"https://api.github.com/repos/apache/curator/issues/952","id":2604762069,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjIwNjk=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-10T11:21:40Z","updated_at":"2025-01-21T13:37:42Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user iocanel commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/237#discussion_r160649759\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/237#discussion_r160649759</a></p>\n\n<p>    &#8212; Diff: curator-framework/pom.xml &#8212;<br/>\n    @@ -100,6 +100,27 @@<br/>\n </execution><br/>\n     </executions><br/>\n </plugin><br/>\n    +    <plugin><br/>\n    +<groupId>org.apache.felix</groupId><br/>\n    +<artifactId>maven-bundle-plugin</artifactId><br/>\n    +<version>3.3.0</version><br/>\n    +<extensions>true</extensions><br/>\n    +<configuration><br/>\n    +    <instructions><br/>\n    +<Import-Package>!org.apache.curator,*</Import-Package><br/>\n    &#8212; End diff &#8211;</p>\n\n<p>    There is no need to define the plugin again. The plugin is defined once in the parent pom and inherited from the rest of the modules.</p>\n\n<p>    To customize a modules configuration please set properties:</p>\n<ul class=\"alternate\" type=\"square\">\n\t<li>`osgi.import.package`</li>\n\t<li>`osgi.export.package`</li>\n</ul>\n","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604762069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764398","html_url":"https://github.com/apache/curator/issues/968#issuecomment-2604764398","issue_url":"https://api.github.com/repos/apache/curator/issues/968","id":2604764398,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQzOTg=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-23T16:36:16Z","updated_at":"2025-01-21T13:38:46Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kturner\">kturner</a>:</i>\n<p>The current error message was misleading. It made me think I had not yet started the framework. Therefore I did not consider the case that I had possibly stopped it until digging deeper.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/360173058","html_url":"https://github.com/apache/curator/pull/251#issuecomment-360173058","issue_url":"https://api.github.com/repos/apache/curator/issues/251","id":360173058,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MDE3MzA1OA==","user":{"login":"Randgalt","id":264818,"node_id":"MDQ6VXNlcjI2NDgxOA==","avatar_url":"https://avatars.githubusercontent.com/u/264818?v=4","gravatar_id":"","url":"https://api.github.com/users/Randgalt","html_url":"https://github.com/Randgalt","followers_url":"https://api.github.com/users/Randgalt/followers","following_url":"https://api.github.com/users/Randgalt/following{/other_user}","gists_url":"https://api.github.com/users/Randgalt/gists{/gist_id}","starred_url":"https://api.github.com/users/Randgalt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Randgalt/subscriptions","organizations_url":"https://api.github.com/users/Randgalt/orgs","repos_url":"https://api.github.com/users/Randgalt/repos","events_url":"https://api.github.com/users/Randgalt/events{/privacy}","received_events_url":"https://api.github.com/users/Randgalt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-24T15:34:46Z","updated_at":"2018-01-24T15:34:46Z","author_association":"MEMBER","body":"I realize this is a tiny change, but I'd appreciate it if you open a Jira issue to track this at http://issues.apache.org/jira/browse/CURATOR","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/360173058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/360174562","html_url":"https://github.com/apache/curator/pull/251#issuecomment-360174562","issue_url":"https://api.github.com/repos/apache/curator/issues/251","id":360174562,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MDE3NDU2Mg==","user":{"login":"prismec","id":3080401,"node_id":"MDQ6VXNlcjMwODA0MDE=","avatar_url":"https://avatars.githubusercontent.com/u/3080401?v=4","gravatar_id":"","url":"https://api.github.com/users/prismec","html_url":"https://github.com/prismec","followers_url":"https://api.github.com/users/prismec/followers","following_url":"https://api.github.com/users/prismec/following{/other_user}","gists_url":"https://api.github.com/users/prismec/gists{/gist_id}","starred_url":"https://api.github.com/users/prismec/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prismec/subscriptions","organizations_url":"https://api.github.com/users/prismec/orgs","repos_url":"https://api.github.com/users/prismec/repos","events_url":"https://api.github.com/users/prismec/events{/privacy}","received_events_url":"https://api.github.com/users/prismec/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-24T15:39:23Z","updated_at":"2018-01-24T15:39:23Z","author_association":"NONE","body":"https://issues.apache.org/jira/browse/CURATOR-449 <https://issues.apache.org/jira/browse/CURATOR-449>\n\n--------------------------------------------------------------\nSmarter Ecommerce GmbH\n\nSpittelwiese 15\n4020 Linz\n \nT +43 732 997002-100\npeter.rietzler@smarter-ecommerce.com\nhttp://www.smarter-ecommerce.com <http://www.smarter-ecommerce.com/>\nUID: ATU 63760825\n-----------------------------------------------------------------\nsmec  we automate ecommerce success\n-----------------------------------------------------------------\n\n> On 24 Jan 2018, at 16:34 , Jordan Zimmerman <notifications@github.com> wrote:\n> \n> I realize this is a tiny change, but I'd appreciate it if you open a Jira issue to track this at http://issues.apache.org/jira/browse/CURATOR <http://issues.apache.org/jira/browse/CURATOR>\n> \n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub <https://github.com/apache/curator/pull/251#issuecomment-360173058>, or mute the thread <https://github.com/notifications/unsubscribe-auth/AC8A0dc0bLN2thdNO00xXxahadjY2Aapks5tN02ZgaJpZM4RrcEp>.\n> \n\n","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/360174562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764534","html_url":"https://github.com/apache/curator/issues/969#issuecomment-2604764534","issue_url":"https://api.github.com/repos/apache/curator/issues/969","id":2604764534,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQ1MzQ=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-01-24T15:39:25Z","updated_at":"2025-01-21T13:38:50Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user prismec commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/251\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/251</a></p>\n\n<p>    <a href=\"https://issues.apache.org/jira/browse/CURATOR-449\" class=\"external-link\" rel=\"nofollow\">https://issues.apache.org/jira/browse/CURATOR-449</a> <<a href=\"https://issues.apache.org/jira/browse/CURATOR-449\" class=\"external-link\" rel=\"nofollow\">https://issues.apache.org/jira/browse/CURATOR-449</a>></p>\n\n<p>    --------------------------------------------------------------<br/>\n    Smarter Ecommerce GmbH</p>\n\n<p>    Spittelwiese 15<br/>\n    4020 Linz</p>\n\n<p>    T +43 732 997002-100<br/>\n    peter.rietzler@smarter-ecommerce.com<br/>\n    <a href=\"http://www.smarter-ecommerce.com\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">http://www.smarter-ecommerce.com</a> <<a href=\"http://www.smarter-ecommerce.com/\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">http://www.smarter-ecommerce.com/</a>><br/>\n    UID: ATU 63760825<br/>\n    -----------------------------------------------------------------<br/>\n    smec  we automate ecommerce success<br/>\n    -----------------------------------------------------------------</p>\n\n<p>    > On 24 Jan 2018, at 16:34 , Jordan Zimmerman <notifications@github.com> wrote:<br/>\n    > <br/>\n    > I realize this is a tiny change, but I'd appreciate it if you open a Jira issue to track this at <a href=\"http://issues.apache.org/jira/browse/CURATOR\" class=\"external-link\" rel=\"nofollow\">http://issues.apache.org/jira/browse/CURATOR</a> <<a href=\"http://issues.apache.org/jira/browse/CURATOR\" class=\"external-link\" rel=\"nofollow\">http://issues.apache.org/jira/browse/CURATOR</a>><br/>\n    > <br/>\n    > You are receiving this because you authored the thread.<br/>\n    > Reply to this email directly, view it on GitHub <<a href=\"https://github.com/apache/curator/pull/251#issuecomment-360173058\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/251#issuecomment-360173058</a>>, or mute the thread <<a href=\"https://github.com/notifications/unsubscribe-auth/AC8A0dc0bLN2thdNO00xXxahadjY2Aapks5tN02ZgaJpZM4RrcEp\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/notifications/unsubscribe-auth/AC8A0dc0bLN2thdNO00xXxahadjY2Aapks5tN02ZgaJpZM4RrcEp</a>>.<br/>\n    > </p>\n\n","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/363312768","html_url":"https://github.com/apache/curator/pull/250#issuecomment-363312768","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":363312768,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MzMxMjc2OA==","user":{"login":"njhill","id":16958488,"node_id":"MDQ6VXNlcjE2OTU4NDg4","avatar_url":"https://avatars.githubusercontent.com/u/16958488?v=4","gravatar_id":"","url":"https://api.github.com/users/njhill","html_url":"https://github.com/njhill","followers_url":"https://api.github.com/users/njhill/followers","following_url":"https://api.github.com/users/njhill/following{/other_user}","gists_url":"https://api.github.com/users/njhill/gists{/gist_id}","starred_url":"https://api.github.com/users/njhill/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njhill/subscriptions","organizations_url":"https://api.github.com/users/njhill/orgs","repos_url":"https://api.github.com/users/njhill/repos","events_url":"https://api.github.com/users/njhill/events{/privacy}","received_events_url":"https://api.github.com/users/njhill/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-06T05:10:18Z","updated_at":"2018-02-06T05:10:18Z","author_association":"CONTRIBUTOR","body":"@dragonsinth any interest in these changes? Maybe I should rename the PR since as you pointed out the memory saving aspect isn't very significant (I measured about 2% on a cache of 50k empty nodes), but hopefully the state and update logic simplification is beneficial?","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/363312768/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764173","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764173","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764173,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxNzM=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-06T05:10:22Z","updated_at":"2025-01-21T13:38:40Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user njhill commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    @dragonsinth any interest in these changes? Maybe I should rename the PR since as you pointed out the memory saving aspect isn't very significant (I measured about 2% on a cache of 50k empty nodes), but hopefully the state and update logic simplification is beneficial?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764173/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/363329713","html_url":"https://github.com/apache/curator/pull/250#issuecomment-363329713","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":363329713,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MzMyOTcxMw==","user":{"login":"dragonsinth","id":1919660,"node_id":"MDQ6VXNlcjE5MTk2NjA=","avatar_url":"https://avatars.githubusercontent.com/u/1919660?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonsinth","html_url":"https://github.com/dragonsinth","followers_url":"https://api.github.com/users/dragonsinth/followers","following_url":"https://api.github.com/users/dragonsinth/following{/other_user}","gists_url":"https://api.github.com/users/dragonsinth/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonsinth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonsinth/subscriptions","organizations_url":"https://api.github.com/users/dragonsinth/orgs","repos_url":"https://api.github.com/users/dragonsinth/repos","events_url":"https://api.github.com/users/dragonsinth/events{/privacy}","received_events_url":"https://api.github.com/users/dragonsinth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-06T07:01:53Z","updated_at":"2018-02-06T07:01:53Z","author_association":"CONTRIBUTOR","body":"Sorry, been busy then out of town. I'll look tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/363329713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764179","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764179","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764179,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxNzk=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-06T07:01:55Z","updated_at":"2025-01-21T13:38:40Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    Sorry, been busy then out of town. I'll look tomorrow.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764793","html_url":"https://github.com/apache/curator/issues/971#issuecomment-2604764793","issue_url":"https://api.github.com/repos/apache/curator/issues/971","id":2604764793,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQ3OTM=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-06T15:01:39Z","updated_at":"2025-01-21T13:38:56Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=randgalt\">randgalt</a>:</i>\n<p>Are you seeing an issue in production? Do you have a sample that shows the problem?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/363859172","html_url":"https://github.com/apache/curator/pull/250#issuecomment-363859172","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":363859172,"node_id":"MDEyOklzc3VlQ29tbWVudDM2Mzg1OTE3Mg==","user":{"login":"dragonsinth","id":1919660,"node_id":"MDQ6VXNlcjE5MTk2NjA=","avatar_url":"https://avatars.githubusercontent.com/u/1919660?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonsinth","html_url":"https://github.com/dragonsinth","followers_url":"https://api.github.com/users/dragonsinth/followers","following_url":"https://api.github.com/users/dragonsinth/following{/other_user}","gists_url":"https://api.github.com/users/dragonsinth/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonsinth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonsinth/subscriptions","organizations_url":"https://api.github.com/users/dragonsinth/orgs","repos_url":"https://api.github.com/users/dragonsinth/repos","events_url":"https://api.github.com/users/dragonsinth/events{/privacy}","received_events_url":"https://api.github.com/users/dragonsinth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-07T18:12:10Z","updated_at":"2018-02-07T18:12:10Z","author_association":"CONTRIBUTOR","body":"I'm sure this is probably right, but the old code has a _lot_ of miles on it.  I have to read through super carefully and convince myself that there are no behavioral changes. ","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/363859172/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764184","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764184","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764184,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxODQ=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-07T18:12:12Z","updated_at":"2025-01-21T13:38:40Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    I'm sure this is probably right, but the old code has a <em>lot</em> of miles on it.  I have to read through super carefully and convince myself that there are no behavioral changes. </p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764189","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764189","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764189,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxODk=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T19:57:47Z","updated_at":"2025-01-21T13:38:40Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250#discussion_r167668989\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250#discussion_r167668989</a></p>\n\n<p>    &#8212; Diff: curator-recipes/src/main/java/org/apache/curator/framework/recipes/cache/TreeCache.java &#8212;<br/>\n    @@ -377,15 +375,16 @@ public void processResult(CuratorFramework client, CuratorEvent event) throws Ex<br/>\n     Preconditions.checkState(parent == null, \"unexpected EXISTS on non-root node\");<br/>\n     if ( event.getResultCode() == KeeperException.Code.OK.intValue() )</p>\n     {\n    -    nodeStateUpdater.compareAndSet(this, NodeState.DEAD, NodeState.PENDING);\n    +    childDataUpdater.compareAndSet(this, DEAD, null);\n wasCreated();\n     }\n<p>     break;<br/>\n case CHILDREN:<br/>\n     if ( event.getResultCode() == KeeperException.Code.OK.intValue() )<br/>\n     {<br/>\n ChildData oldChildData = childData;</p>\n<ul class=\"alternate\" type=\"square\">\n\t<li>if ( oldChildData != null && oldChildData.getStat().getMzxid() == newStat.getMzxid() )<br/>\n    +    //TODO consider doing update of cversion, pzxid, numChildren only\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    seems reasonable to me</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764193","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764193","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764193,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxOTM=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T20:32:41Z","updated_at":"2025-01-21T13:38:40Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250#discussion_r167673103\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250#discussion_r167673103</a></p>\n\n<p>    &#8212; Diff: curator-recipes/src/main/java/org/apache/curator/framework/recipes/cache/TreeCache.java &#8212;<br/>\n    @@ -704,8 +687,7 @@ private TreeNode find(String findPath)<br/>\n {<br/>\n     TreeNode childNode = entry.getValue();<br/>\n     ChildData childData = childNode.childData;</p>\n<ul class=\"alternate\" type=\"square\">\n\t<li>// Double-check liveness after retreiving data.\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    I kind of liked this comment, although I misspelled \"retrieving\" here and below</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764199","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764199","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764199,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQxOTk=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T20:32:41Z","updated_at":"2025-01-21T13:38:41Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250#discussion_r167672355\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250#discussion_r167672355</a></p>\n\n<p>    &#8212; Diff: curator-recipes/src/main/java/org/apache/curator/framework/recipes/cache/TreeCache.java &#8212;<br/>\n    @@ -397,14 +396,11 @@ public void processResult(CuratorFramework client, CuratorEvent event) throws Ex<br/>\n     break;<br/>\n }</p>\n\n<ul class=\"alternate\" type=\"square\">\n\t<li>ConcurrentMap<String, TreeNode> childMap = children;</li>\n\t<li>if ( childMap == null )<br/>\n    +    ConcurrentMap<String, TreeNode> childMap;<br/>\n    +    while ( (childMap = children) == null )<br/>\n {<br/>\n     childMap = Maps.newConcurrentMap();</li>\n\t<li>if ( !childrenUpdater.compareAndSet(this, null, childMap) )</li>\n\t<li>{\n    -    childMap = children;\n    -}\n<p>    +if ( childrenUpdater.compareAndSet(this, null, childMap) ) break;</p>\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    I see why you turned this into a loop (nice catch), but I think it reads a little clearly and more deliberateif you revert back to the original code and just change the `if` -> `while`.  Ideally if Curator moves wholesale to Java 1.8,  funcs, like:</p>\n\n<p>    ```<br/>\nConcurrentMap<String, TreeNode> childMap = childrenUpdater.updateAndGet(this, (oldChildren) -> </p>\n{\n    return oldChildren != null ? oldChildren : Maps.newConcurrentMap();\n}\n<p>);<br/>\n    ```</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764205","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764205","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764205,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQyMDU=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T20:32:42Z","updated_at":"2025-01-21T13:38:41Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250#discussion_r167677124\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250#discussion_r167677124</a></p>\n\n<p>    &#8212; Diff: curator-recipes/src/main/java/org/apache/curator/framework/recipes/cache/TreeCache.java &#8212;<br/>\n    @@ -436,41 +432,28 @@ else if ( event.getResultCode() == KeeperException.Code.NONODE.intValue() )<br/>\n case GET_DATA:<br/>\n     if ( event.getResultCode() == KeeperException.Code.OK.intValue() )<br/>\n     {</p>\n<ul class=\"alternate\" type=\"square\">\n\t<li>ChildData toPublish = new ChildData(event.getPath(), newStat, event.getData());</li>\n\t<li>ChildData oldChildData;</li>\n\t<li>if ( cacheData )</li>\n\t<li>{\n    -oldChildData = childDataUpdater.getAndSet(this, toPublish);\n    -    }</li>\n\t<li>else</li>\n\t<li>{\n    -oldChildData = childDataUpdater.getAndSet(this, new ChildData(event.getPath(), newStat, null));\n    -    }\n<p>    -</p></li>\n\t<li>boolean added;</li>\n\t<li>if (parent == null) \n{\n    -// We're the singleton root.\n    -added = nodeStateUpdater.getAndSet(this, NodeState.LIVE) != NodeState.LIVE;\n    -    }\n<p> else {</p></li>\n\t<li>added = nodeStateUpdater.compareAndSet(this, NodeState.PENDING, NodeState.LIVE);</li>\n\t<li>if (!added) {</li>\n\t<li>// Ordinary nodes are not allowed to transition from dead -> live;</li>\n\t<li>// make sure this isn't a delayed response that came in after death.</li>\n\t<li>if (nodeState != NodeState.LIVE) \n{\n    -return;\n    -    }\n<p>    +    String eventPath = event.getPath();<br/>\n    +    ChildData toPublish = new ChildData(eventPath, newStat, event.getData());<br/>\n    +    ChildData toUpdate = cacheData ? toPublish : new ChildData(eventPath, newStat, null);<br/>\n    +    while (true) {<br/>\n    +final ChildData oldChildData = childData;<br/>\n    +if ( (isLive(oldChildData) && newStat.getMzxid() <= oldChildData.getStat().getMzxid())<br/>\n    +// Ordinary nodes are not allowed to transition from dead -> live;<br/>\n    +// make sure this isn't a delayed response that came in after death.<br/>\n    +|| (parent != null && oldChildData == DEAD) ) </p>\n{\n    +    break;\n     }</li>\n\t<li>}<br/>\n    -</li>\n\t<li>if ( added )</li>\n\t<li>{\n    -publishEvent(TreeCacheEvent.Type.NODE_ADDED, toPublish);\n    -    }</li>\n\t<li>else</li>\n\t<li>{</li>\n\t<li>if ( oldChildData == null || oldChildData.getStat().getMzxid() != newStat.getMzxid() )<br/>\n    +if ( childDataUpdater.compareAndSet(this, oldChildData, toUpdate) )<br/>\n     {</li>\n\t<li>publishEvent(TreeCacheEvent.Type.NODE_UPDATED, toPublish);<br/>\n    +    if ( !isLive(oldChildData) )<br/>\n    +    \n{\n    +publishEvent(TreeCacheEvent.Type.NODE_ADDED, toPublish);\n    +    }\n<p>    +    else if ( oldChildData.getStat().getMzxid() != newStat.getMzxid() )<br/>\n    +    </p>\n{\n    +publishEvent(TreeCacheEvent.Type.NODE_UPDATED, toPublish);\n    +    }\n<p>    +    break;</p>\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    I think the second check is now superfluous since we checked above.</p>\n\n<p>    ```<br/>\n    if ( childDataUpdater.compareAndSet(this, oldChildData, toUpdate) )</p>\n    {\npublishEvent(isLive(oldChildData) ? TreeCacheEvent.Type.NODE_UPDATED : TreeCacheEvent.Type.NODE_ADDED, toPublish);\nbreak;\n    }\n<p>    ```</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764212","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764212","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764212,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQyMTI=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T20:32:42Z","updated_at":"2025-01-21T13:38:41Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250#discussion_r167675994\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250#discussion_r167675994</a></p>\n\n<p>    &#8212; Diff: curator-recipes/src/main/java/org/apache/curator/framework/recipes/cache/TreeCache.java &#8212;<br/>\n    @@ -436,41 +432,28 @@ else if ( event.getResultCode() == KeeperException.Code.NONODE.intValue() )<br/>\n case GET_DATA:<br/>\n     if ( event.getResultCode() == KeeperException.Code.OK.intValue() )<br/>\n     {</p>\n<ul class=\"alternate\" type=\"square\">\n\t<li>ChildData toPublish = new ChildData(event.getPath(), newStat, event.getData());</li>\n\t<li>ChildData oldChildData;</li>\n\t<li>if ( cacheData )</li>\n\t<li>{\n    -oldChildData = childDataUpdater.getAndSet(this, toPublish);\n    -    }</li>\n\t<li>else</li>\n\t<li>{\n    -oldChildData = childDataUpdater.getAndSet(this, new ChildData(event.getPath(), newStat, null));\n    -    }\n<p>    -</p></li>\n\t<li>boolean added;</li>\n\t<li>if (parent == null) \n{\n    -// We're the singleton root.\n    -added = nodeStateUpdater.getAndSet(this, NodeState.LIVE) != NodeState.LIVE;\n    -    }\n<p> else {</p></li>\n\t<li>added = nodeStateUpdater.compareAndSet(this, NodeState.PENDING, NodeState.LIVE);</li>\n\t<li>if (!added) {</li>\n\t<li>// Ordinary nodes are not allowed to transition from dead -> live;</li>\n\t<li>// make sure this isn't a delayed response that came in after death.</li>\n\t<li>if (nodeState != NodeState.LIVE) \n{\n    -return;\n    -    }\n<p>    +    String eventPath = event.getPath();<br/>\n    +    ChildData toPublish = new ChildData(eventPath, newStat, event.getData());<br/>\n    +    ChildData toUpdate = cacheData ? toPublish : new ChildData(eventPath, newStat, null);<br/>\n    +    while (true) {<br/>\n    +final ChildData oldChildData = childData;<br/>\n    +if ( (isLive(oldChildData) && newStat.getMzxid() <= oldChildData.getStat().getMzxid())<br/>\n    +// Ordinary nodes are not allowed to transition from dead -> live;<br/>\n    +// make sure this isn't a delayed response that came in after death.<br/>\n    +|| (parent != null && oldChildData == DEAD) ) {<br/>\n    +    break;</p>\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    Can we break up these cases for clarity?</p>\n\n<p>    ```<br/>\n    final ChildData oldChildData = childData;<br/>\n    // Ignore this event if we've already processed a newer update for this node.<br/>\n    if ( (isLive(oldChildData) && newStat.getMzxid() <= oldChildData.getStat().getMzxid()) )</p>\n    {\nbreak;\n    }<br/>\n    // Non-root nodes are not allowed to transition from dead -> live;<br/>\n    // make sure this isn't a delayed response that came in after death.<br/>\n    if ( parent != null && oldChildData == DEAD )<br/>\n    {\nbreak;\n    }\n<p>    ```</p>\n","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764219","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764219","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764219,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQyMTk=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T20:32:42Z","updated_at":"2025-01-21T13:38:41Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250#discussion_r167673343\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250#discussion_r167673343</a></p>\n\n<p>    &#8212; Diff: curator-recipes/src/main/java/org/apache/curator/framework/recipes/cache/TreeCache.java &#8212;<br/>\n    @@ -728,13 +710,12 @@ private TreeNode find(String findPath)<br/>\n public ChildData getCurrentData(String fullPath)<br/>\n {<br/>\n     TreeNode node = find(fullPath);</p>\n<ul class=\"alternate\" type=\"square\">\n\t<li>if ( node == null || node.nodeState != NodeState.LIVE )<br/>\n    +if ( node == null )\n     {\n return null;\n     }\n<p>     ChildData result = node.childData;</p></li>\n\t<li>// Double-check liveness after retreiving data.</li>\n\t<li>return node.nodeState == NodeState.LIVE ? result : null;<br/>\n    +return result != DEAD ? result : null;\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    shouldn't this be `isLive` for consistency?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/365054735","html_url":"https://github.com/apache/curator/pull/250#issuecomment-365054735","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":365054735,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NTA1NDczNQ==","user":{"login":"dragonsinth","id":1919660,"node_id":"MDQ6VXNlcjE5MTk2NjA=","avatar_url":"https://avatars.githubusercontent.com/u/1919660?v=4","gravatar_id":"","url":"https://api.github.com/users/dragonsinth","html_url":"https://github.com/dragonsinth","followers_url":"https://api.github.com/users/dragonsinth/followers","following_url":"https://api.github.com/users/dragonsinth/following{/other_user}","gists_url":"https://api.github.com/users/dragonsinth/gists{/gist_id}","starred_url":"https://api.github.com/users/dragonsinth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragonsinth/subscriptions","organizations_url":"https://api.github.com/users/dragonsinth/orgs","repos_url":"https://api.github.com/users/dragonsinth/repos","events_url":"https://api.github.com/users/dragonsinth/events{/privacy}","received_events_url":"https://api.github.com/users/dragonsinth/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T20:40:22Z","updated_at":"2018-02-12T20:40:22Z","author_association":"CONTRIBUTOR","body":"@njhill this looks good to me with a few changes.  I pushed one extra commit onto https://github.com/apache/curator/tree/CURATOR-447 for you to look at.  If you agree with my changes (some of them are to conform to the project style) please sync your branch to mine and I'll merge this.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/365054735/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764223","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764223","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764223,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQyMjM=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T20:40:25Z","updated_at":"2025-01-21T13:38:41Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    @njhill this looks good to me with a few changes.  I pushed one extra commit onto <a href=\"https://github.com/apache/curator/tree/CURATOR-447\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/tree/CURATOR-447</a> for you to look at.  If you agree with my changes (some of them are to conform to the project style) please sync your branch to mine and I'll merge this.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764226","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764226","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764226,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQyMjY=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T23:06:32Z","updated_at":"2025-01-21T13:38:41Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user njhill commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250#discussion_r167715541\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250#discussion_r167715541</a></p>\n\n<p>    &#8212; Diff: curator-recipes/src/main/java/org/apache/curator/framework/recipes/cache/TreeCache.java &#8212;<br/>\n    @@ -704,8 +687,7 @@ private TreeNode find(String findPath)<br/>\n {<br/>\n     TreeNode childNode = entry.getValue();<br/>\n     ChildData childData = childNode.childData;</p>\n<ul class=\"alternate\" type=\"square\">\n\t<li>// Double-check liveness after retreiving data.\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    The reason I removed it is that unlike before it's not really \"double\" checking anymore against the separate `nodeState` field, there's only a single check for liveness which is now implicit in the value of `childData`. But I could well have misinterpreted the reason for comment, no problem with leaving it in!</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764226/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764231","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764231","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764231,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQyMzE=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T23:07:46Z","updated_at":"2025-01-21T13:38:41Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user njhill commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250#discussion_r167715799\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250#discussion_r167715799</a></p>\n\n<p>    &#8212; Diff: curator-recipes/src/main/java/org/apache/curator/framework/recipes/cache/TreeCache.java &#8212;<br/>\n    @@ -728,13 +710,12 @@ private TreeNode find(String findPath)<br/>\n public ChildData getCurrentData(String fullPath)<br/>\n {<br/>\n     TreeNode node = find(fullPath);</p>\n<ul class=\"alternate\" type=\"square\">\n\t<li>if ( node == null || node.nodeState != NodeState.LIVE )<br/>\n    +if ( node == null )\n     {\n return null;\n     }\n<p>     ChildData result = node.childData;</p></li>\n\t<li>// Double-check liveness after retreiving data.</li>\n\t<li>return node.nodeState == NodeState.LIVE ? result : null;<br/>\n    +return result != DEAD ? result : null;\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    Reason was that `isLive` also checks for `null` which isn't necessary here (since we're returning `null` anyhow). But no harm in making it consistent.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/365098028","html_url":"https://github.com/apache/curator/pull/250#issuecomment-365098028","issue_url":"https://api.github.com/repos/apache/curator/issues/250","id":365098028,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NTA5ODAyOA==","user":{"login":"njhill","id":16958488,"node_id":"MDQ6VXNlcjE2OTU4NDg4","avatar_url":"https://avatars.githubusercontent.com/u/16958488?v=4","gravatar_id":"","url":"https://api.github.com/users/njhill","html_url":"https://github.com/njhill","followers_url":"https://api.github.com/users/njhill/followers","following_url":"https://api.github.com/users/njhill/following{/other_user}","gists_url":"https://api.github.com/users/njhill/gists{/gist_id}","starred_url":"https://api.github.com/users/njhill/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/njhill/subscriptions","organizations_url":"https://api.github.com/users/njhill/orgs","repos_url":"https://api.github.com/users/njhill/repos","events_url":"https://api.github.com/users/njhill/events{/privacy}","received_events_url":"https://api.github.com/users/njhill/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T23:24:27Z","updated_at":"2018-02-12T23:24:27Z","author_association":"CONTRIBUTOR","body":"Thanks alot @dragonsinth for going through this so carefully. I like your additional simplifications, and sorry for the project style inconsistencies that I missed!\r\n\r\nI've pulled in your commit and added one more just to remove some parentheses no longer needed after splitting those conditions into separate `if`s.","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/365098028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764238","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764238","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764238,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQyMzg=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-12T23:24:29Z","updated_at":"2025-01-21T13:38:41Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user njhill commented on the issue:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>\n\n<p>    Thanks alot @dragonsinth for going through this so carefully. I like your additional simplifications, and sorry for the project style inconsistencies that I missed!</p>\n\n<p>    I've pulled in your commit and added one more just to remove some parentheses no longer needed after splitting those conditions into separate `if`s.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764246","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764246","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764246,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQyNDY=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-13T00:51:51Z","updated_at":"2025-01-21T13:38:42Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user dragonsinth commented on a diff in the pull request:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250#discussion_r167733216\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250#discussion_r167733216</a></p>\n\n<p>    &#8212; Diff: curator-recipes/src/main/java/org/apache/curator/framework/recipes/cache/TreeCache.java &#8212;<br/>\n    @@ -702,19 +687,18 @@ private TreeNode find(String findPath)<br/>\n ImmutableMap.Builder<String, ChildData> builder = ImmutableMap.builder();<br/>\n for ( Map.Entry<String, TreeNode> entry : map.entrySet() )<br/>\n {</p>\n<ul class=\"alternate\" type=\"square\">\n\t<li>TreeNode childNode = entry.getValue();</li>\n\t<li>ChildData childData = childNode.childData;</li>\n\t<li>// Double-check liveness after retreiving data.</li>\n\t<li>if ( childData != null && childNode.nodeState == NodeState.LIVE )<br/>\n    +ChildData childData = entry.getValue().childData;<br/>\n    +// Double-check liveness after retrieving data.<br/>\n    +if ( isLive(childData) )\n\t<ul class=\"alternate\" type=\"square\">\n\t\t<li>\n\t\t<ul class=\"alternate\" type=\"square\">\n\t\t\t<li>End diff &#8211;</li>\n\t\t</ul>\n\t\t</li>\n\t</ul>\n\t</li>\n</ul>\n\n\n<p>    It's subtle, but the point I'm trying to make is that you have to read `.childData` exactly once, then check the liveness, then use only that value going forward.  It would be an error to remove the local variable here and reference `entry.getValue().childData` twice.</p>\n\n<p>    It's a \"double\" check because <em>generally</em> there shouldn't be any non-LIVE children in the parent `children` map that we're iterating.  But due to volatility we have to \"double check\" that child nodes read from the map are still alive after pulling `.childData`</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764246/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764248","html_url":"https://github.com/apache/curator/issues/967#issuecomment-2604764248","issue_url":"https://api.github.com/repos/apache/curator/issues/967","id":2604764248,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjQyNDg=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-13T00:55:38Z","updated_at":"2025-01-21T13:38:42Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=githubbot\">githubbot</a>:</i>\n<p>Github user asfgit closed the pull request at:</p>\n\n<p>    <a href=\"https://github.com/apache/curator/pull/250\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apache/curator/pull/250</a></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604764248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604765105","html_url":"https://github.com/apache/curator/issues/973#issuecomment-2604765105","issue_url":"https://api.github.com/repos/apache/curator/issues/973","id":2604765105,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjUxMDU=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-13T18:28:20Z","updated_at":"2025-01-21T13:39:05Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=randgalt\">randgalt</a>:</i>\n<p>The problem seems to be in your serializer. Are you using Curator's <tt>JsonInstanceSerializer</tt>or a custom serializer? Can you post the code of your serializer?</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604765105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604765114","html_url":"https://github.com/apache/curator/issues/973#issuecomment-2604765114","issue_url":"https://api.github.com/repos/apache/curator/issues/973","id":2604765114,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjUxMTQ=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-14T05:13:48Z","updated_at":"2025-01-21T13:39:05Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kislayverma\">kislayverma</a>:</i>\n<p>I was using a custom class (POJO with 4 String fields and JsonRootName annotation) with Curator'sJsonInstanceSerializer serializer.</p>\n\n<p>While registering the service, this object wasn't getting posted to Zookeeper (though the node got created with new id). Then doing ServiceProvider.start() in a different place (code given above) is when this NPE comes.</p>\n\n<p>I stopped using the POJO and started to post only basic data (ServiceProvider<Void>), and then both problems went away. The data would get loaded in Zookeeper, and this piece does not throw NPE.</p>\n\n<p>Not sure why this exception would come at ServiceProvider.start() instead of coming at getInstance()? Also. perhaps the errorreporting can be better than an NPE which is difficult to debug.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604765114/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604765224","html_url":"https://github.com/apache/curator/issues/974#issuecomment-2604765224","issue_url":"https://api.github.com/repos/apache/curator/issues/974","id":2604765224,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjUyMjQ=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-15T13:27:47Z","updated_at":"2025-01-21T13:39:08Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=randgalt\">randgalt</a>:</i>\n<p>Have you read this? <a href=\"http://curator.apache.org/zk-compatibility.html\" class=\"external-link\" target=\"_blank\" rel=\"nofollow noopener\">http://curator.apache.org/zk-compatibility.html</a>- you need to add the proper exclusions in your dependency management tool.</p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604765224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604765228","html_url":"https://github.com/apache/curator/issues/974#issuecomment-2604765228","issue_url":"https://api.github.com/repos/apache/curator/issues/974","id":2604765228,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDQ3NjUyMjg=","user":{"login":"jira-importer","id":99357308,"node_id":"U_kgDOBewSfA","avatar_url":"https://avatars.githubusercontent.com/u/99357308?v=4","gravatar_id":"","url":"https://api.github.com/users/jira-importer","html_url":"https://github.com/jira-importer","followers_url":"https://api.github.com/users/jira-importer/followers","following_url":"https://api.github.com/users/jira-importer/following{/other_user}","gists_url":"https://api.github.com/users/jira-importer/gists{/gist_id}","starred_url":"https://api.github.com/users/jira-importer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jira-importer/subscriptions","organizations_url":"https://api.github.com/users/jira-importer/orgs","repos_url":"https://api.github.com/users/jira-importer/repos","events_url":"https://api.github.com/users/jira-importer/events{/privacy}","received_events_url":"https://api.github.com/users/jira-importer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-02-15T13:37:40Z","updated_at":"2025-01-21T13:39:08Z","author_association":"COLLABORATOR","body":"<i><a href=\"https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sishbi\">sishbi</a>:</i>\n<p>Yes, I have read that andI am still seeing these compile-time issues.</p>\n\n<p>We initially had issues running curator-test until I downgraded back to 2.12.0 of that (thanks to that wiki page) but this module does not use curator-test. The module uses curator-framework implicitly as we have written a wrapper library around curator which depends on zookeeper/curator that is used by this module.</p>\n\n<p>Here is an extract from the module pom.xml (we include the zookeeper / curator libraries directly as this is a war which must be deployed):</p>\n\n<p><tt><dependency></tt><br/>\n<tt> <groupId>org.apache.zookeeper</groupId></tt><br/>\n<tt> <artifactId>zookeeper</artifactId></tt><br/>\n<tt> <version>3.4.10</version></tt><br/>\n<tt> <scope>compile</scope></tt><br/>\n<tt></dependency></tt><br/>\n<tt><dependency></tt><br/>\n<tt> <groupId>org.apache.curator</groupId></tt><br/>\n<tt> <artifactId>curator-framework</artifactId></tt><br/>\n<tt> <version>4.0.0</version></tt><br/>\n<tt> <scope>compile</scope></tt><br/>\n<tt> <exclusions></tt><br/>\n<tt>  <exclusion></tt><br/>\n<tt>   <groupId>org.apache.zookeeper</groupId></tt><br/>\n<tt>   <artifactId>zookeeper</artifactId></tt><br/>\n<tt>  </exclusion></tt><br/>\n<tt> </exclusions></tt><br/>\n<tt></dependency></tt><br/>\n<tt><dependency></tt><br/>\n<tt> <groupId>org.apache.curator</groupId></tt><br/>\n<tt> <artifactId>curator-client</artifactId></tt><br/>\n<tt> <version>4.0.0</version></tt><br/>\n<tt> <scope>compile</scope></tt><br/>\n<tt> <exclusions></tt><br/>\n<tt>  <exclusion></tt><br/>\n<tt>   <groupId>org.apache.zookeeper</groupId></tt><br/>\n<tt>   <artifactId>zookeeper</artifactId></tt><br/>\n<tt>  </exclusion></tt><br/>\n<tt> </exclusions></tt><br/>\n<tt></dependency></tt><br/>\n<tt><dependency></tt><br/>\n<tt> <groupId>org.apache.curator</groupId></tt><br/>\n<tt> <artifactId>curator-x-discovery</artifactId></tt><br/>\n<tt> <version>4.0.0</version></tt><br/>\n<tt> <scope>compile</scope></tt><br/>\n<tt> <exclusions></tt><br/>\n<tt>  <exclusion></tt><br/>\n<tt>   <groupId>org.apache.zookeeper</groupId></tt><br/>\n<tt>   <artifactId>zookeeper</artifactId></tt><br/>\n<tt>  </exclusion></tt><br/>\n<tt> </exclusions></tt><br/>\n<tt></dependency></tt></p>","reactions":{"url":"https://api.github.com/repos/apache/curator/issues/comments/2604765228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]