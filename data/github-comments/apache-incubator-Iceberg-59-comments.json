[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720366359","html_url":"https://github.com/apache/iceberg/issues/1684#issuecomment-720366359","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1684","id":720366359,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDM2NjM1OQ==","user":{"login":"zanmeipaul","id":20592867,"node_id":"MDQ6VXNlcjIwNTkyODY3","avatar_url":"https://avatars.githubusercontent.com/u/20592867?v=4","gravatar_id":"","url":"https://api.github.com/users/zanmeipaul","html_url":"https://github.com/zanmeipaul","followers_url":"https://api.github.com/users/zanmeipaul/followers","following_url":"https://api.github.com/users/zanmeipaul/following{/other_user}","gists_url":"https://api.github.com/users/zanmeipaul/gists{/gist_id}","starred_url":"https://api.github.com/users/zanmeipaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zanmeipaul/subscriptions","organizations_url":"https://api.github.com/users/zanmeipaul/orgs","repos_url":"https://api.github.com/users/zanmeipaul/repos","events_url":"https://api.github.com/users/zanmeipaul/events{/privacy}","received_events_url":"https://api.github.com/users/zanmeipaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T09:57:08Z","updated_at":"2020-11-02T09:57:08Z","author_association":"NONE","body":"> Could you pls check that whether it did commit the iceberg transaction successfully ? If we did not commit the transaction, then hive won't see the results. As we transaction commitment happened when flink checkpoint occur, so it's better to check the checkpoint configurations (such as checkpoint interval, disable or enable ? )\r\n\r\nHi @openinx  \r\n\r\nflink checkpoint is not turned on\r\n\r\nIf flink uses hive CATALOG, data can be written normally, and the datagen connector data is generated, the process will automatically end;\r\nhadoop CATALOG does not end the process of writing data","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720366359/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720415969","html_url":"https://github.com/apache/iceberg/issues/1684#issuecomment-720415969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1684","id":720415969,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDQxNTk2OQ==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T11:31:12Z","updated_at":"2020-11-02T11:31:12Z","author_association":"MEMBER","body":"Could you help to dump the stack trace for the hadoop catalog case ? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720415969/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720419135","html_url":"https://github.com/apache/iceberg/pull/1695#issuecomment-720419135","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1695","id":720419135,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDQxOTEzNQ==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T11:38:18Z","updated_at":"2020-11-02T11:38:18Z","author_association":"COLLABORATOR","body":"@rdblue yes, I think it makes sense to separate it out. The logic is flawed so it can cause other issues later and I believe does not address the Hive1.1-related issue fully either. I've created an issue https://github.com/apache/iceberg/issues/1708 and a PR https://github.com/apache/iceberg/pull/1707  for that. \r\n\r\nI'll rebase this PR to the latest master once https://github.com/apache/iceberg/pull/1707 has been merged. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720419135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720486160","html_url":"https://github.com/apache/iceberg/pull/1417#issuecomment-720486160","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1417","id":720486160,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDQ4NjE2MA==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T13:54:35Z","updated_at":"2020-11-02T13:54:35Z","author_association":"COLLABORATOR","body":"Hi @cmathiesen  - thanks a lot for starting to work on this! \r\nI was just wondering if this development is still in progress? Happy to provide any assistance if you happen to be lower on bandwidth at the moment. Thanks! :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720486160/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720538250","html_url":"https://github.com/apache/iceberg/pull/1417#issuecomment-720538250","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1417","id":720538250,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDUzODI1MA==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T15:22:43Z","updated_at":"2020-11-02T15:22:43Z","author_association":"CONTRIBUTOR","body":"> Hi @cmathiesen - thanks a lot for starting to work on this!\r\n> I was just wondering if this development is still in progress? Happy to provide any assistance if you happen to be lower on bandwidth at the moment. Thanks! :)\r\n\r\n@marton-bod Thanks for pinging on this one, it's been on my TODO list for a while. I'll take a look at sorting out the merge conflicts today or tomorrow and push that. If you have some time to help out based on the comments above that would be really appreciated. We can add you as an external collaborator if you want to contribute directly to this branch or feel free to raise a PR against it that we merge in to our branch and that will then show up in this PR etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720538250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720542716","html_url":"https://github.com/apache/iceberg/issues/1668#issuecomment-720542716","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1668","id":720542716,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDU0MjcxNg==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T15:29:30Z","updated_at":"2020-11-02T15:29:30Z","author_association":"CONTRIBUTOR","body":"Yes, it's actually on my list to do this as the next addition to the Hive documentation. I have a set of integration tests that I'm writing that create tables using each of the possible methods (Hadoop Tables, Hive Catalog, Custom Catalog etc.) and then query them from Hive. Once I have a complete path working I've been documenting it as I'm then sure it works end to end. I've only managed to get HadoopTables done so far but just started on the Hive Catalog path. I'll work on this when I get the time and raise a PR when appropriate but of course if someone gets to this first I'm happy to review whatever they come up with.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720542716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720611482","html_url":"https://github.com/apache/iceberg/pull/1417#issuecomment-720611482","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1417","id":720611482,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDYxMTQ4Mg==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T17:23:29Z","updated_at":"2020-11-02T17:23:29Z","author_association":"CONTRIBUTOR","body":"OK, I've fixed the merge conflicts. I see there is a failing test - `testJoinTables` which I'm afraid I haven't had a chance to look at yet. Will try continue tomorrow.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720611482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720619722","html_url":"https://github.com/apache/iceberg/pull/1697#issuecomment-720619722","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1697","id":720619722,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDYxOTcyMg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T17:36:58Z","updated_at":"2020-11-02T17:36:58Z","author_association":"CONTRIBUTOR","body":"> Since ORC files are splittable on row groups, whats the motivation to keep files to a target file size?\r\n\r\nBecause we keep file-level stats in Iceberg metadata, files that are too large will result in more tasks than necessary because we can't skip using column-level bounds as effectively. We don't actually use this, but I think that's a reasonable use case for it.\r\n\r\nWe are also interested in determining a reasonable output parallelism in Spark. We haven't made much progress on it yet, though.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720619722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720624585","html_url":"https://github.com/apache/iceberg/issues/1654#issuecomment-720624585","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1654","id":720624585,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDYyNDU4NQ==","user":{"login":"mickjermsurawong-stripe","id":42550941,"node_id":"MDQ6VXNlcjQyNTUwOTQx","avatar_url":"https://avatars.githubusercontent.com/u/42550941?v=4","gravatar_id":"","url":"https://api.github.com/users/mickjermsurawong-stripe","html_url":"https://github.com/mickjermsurawong-stripe","followers_url":"https://api.github.com/users/mickjermsurawong-stripe/followers","following_url":"https://api.github.com/users/mickjermsurawong-stripe/following{/other_user}","gists_url":"https://api.github.com/users/mickjermsurawong-stripe/gists{/gist_id}","starred_url":"https://api.github.com/users/mickjermsurawong-stripe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mickjermsurawong-stripe/subscriptions","organizations_url":"https://api.github.com/users/mickjermsurawong-stripe/orgs","repos_url":"https://api.github.com/users/mickjermsurawong-stripe/repos","events_url":"https://api.github.com/users/mickjermsurawong-stripe/events{/privacy}","received_events_url":"https://api.github.com/users/mickjermsurawong-stripe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T17:46:16Z","updated_at":"2020-11-02T17:46:16Z","author_association":"CONTRIBUTOR","body":"The Avro fix https://github.com/apache/avro/pull/969 has been merged and it's in version 1.10. \r\nIdeally the fix is back-ported to older versions too. I've sent a note to Avro dev to get a sense of how pressing is this problem to others.\r\n\r\nIf this would help others, we made a patch to our internal Iceberg to avoid the hang instead. Specifically, we re-implemented the thin logic of checking the Avro header in Iceberg, and do nothing to Avro.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720624585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720643016","html_url":"https://github.com/apache/iceberg/issues/1708#issuecomment-720643016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1708","id":720643016,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDY0MzAxNg==","user":{"login":"HotSushi","id":6441597,"node_id":"MDQ6VXNlcjY0NDE1OTc=","avatar_url":"https://avatars.githubusercontent.com/u/6441597?v=4","gravatar_id":"","url":"https://api.github.com/users/HotSushi","html_url":"https://github.com/HotSushi","followers_url":"https://api.github.com/users/HotSushi/followers","following_url":"https://api.github.com/users/HotSushi/following{/other_user}","gists_url":"https://api.github.com/users/HotSushi/gists{/gist_id}","starred_url":"https://api.github.com/users/HotSushi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HotSushi/subscriptions","organizations_url":"https://api.github.com/users/HotSushi/orgs","repos_url":"https://api.github.com/users/HotSushi/repos","events_url":"https://api.github.com/users/HotSushi/events{/privacy}","received_events_url":"https://api.github.com/users/HotSushi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T18:19:53Z","updated_at":"2020-11-02T18:19:53Z","author_association":"CONTRIBUTOR","body":"+1 \r\n\r\nThe reason why the error in https://github.com/apache/iceberg/pull/1557 doesn't show up in the integration test [here](https://github.com/ExpediaGroup/iceberg/blob/master/mr/src/test/java/org/apache/iceberg/mr/hive/HiveIcebergStorageHandlerBaseTest.java#L145),  is because Hive2 overwrites properties set in `configureInputJobProperties()` on top of `configureJobConf()`.\r\n\r\nWe found that, Hive2 did not make significant change over Hive1.1 in relevant code, except for a piece where scheme of table location is ignored (see [here](https://github.com/apache/hive/blob/master/ql/src/java/org/apache/hadoop/hive/ql/io/HiveInputFormat.java#L400)). Therefore the error in https://github.com/apache/iceberg/pull/1557 can show up if file split's location is incorrectly set up. We made an internal change to get around this issue in https://github.com/linkedin/iceberg/pull/43.\r\n\r\nIt should be safe to go ahead with the revert. Thanks @marton-bod \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720643016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720653349","html_url":"https://github.com/apache/iceberg/pull/1612#issuecomment-720653349","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1612","id":720653349,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDY1MzM0OQ==","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T18:40:13Z","updated_at":"2020-11-02T18:44:10Z","author_association":"CONTRIBUTOR","body":"> I'm not quite convinced that not supporting the Hive `PARTITIONED BY` clause is the right way to go, but I think it is a reasonable step to get this patch done. We don't need to support it to support the Schema DDL, so it would be fine with me to throw an exception and reject its use for now.\r\n\r\nUpdated the patch to throw an exception if `PARTITIONED BY` is used.\r\n \r\n> What are the chances of integrating Iceberg into Hive itself and solving some of these limitations?\r\n\r\nIf we want to change the Hive syntax we would need Hive to depend on Iceberg.\r\n\r\nIceberg has 2 dependencies on Hive\r\n- HMS API to store the snapshot\r\n- SerDe implementation\r\n\r\nThat would mean that we have cyclic dependency which could be problematic\r\n(Edit) Maybe moving the SerDe implementation to the Hive repo could narrow down the Iceberg dependency on Hive to avoid serious headaches","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720653349/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720744237","html_url":"https://github.com/apache/iceberg/pull/1706#issuecomment-720744237","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1706","id":720744237,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDc0NDIzNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T21:50:18Z","updated_at":"2020-11-02T21:50:18Z","author_association":"CONTRIBUTOR","body":"This looks like a serious problem to me. Case 1 above seems very likely. Do we need to create any patch releases for this or stop the 0.10.0 release to get this into 0.10.0? (FYI @aokolnychyi)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720744237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720745607","html_url":"https://github.com/apache/iceberg/pull/1706#issuecomment-720745607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1706","id":720745607,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDc0NTYwNw==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T21:53:24Z","updated_at":"2020-11-02T21:53:42Z","author_association":"CONTRIBUTOR","body":"I'd be in favor of failing RC2 and including this in 0.10.0","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720745607/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720746396","html_url":"https://github.com/apache/iceberg/issues/1708#issuecomment-720746396","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1708","id":720746396,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDc0NjM5Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T21:55:21Z","updated_at":"2020-11-02T21:55:21Z","author_association":"CONTRIBUTOR","body":"@HotSushi, could you open a PR with the fix?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720746396/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720746716","html_url":"https://github.com/apache/iceberg/pull/1707#issuecomment-720746716","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1707","id":720746716,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDc0NjcxNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T21:56:09Z","updated_at":"2020-11-02T21:56:09Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, if we create 0.10.0 RC2, we should include this fix as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720746716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720746878","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-720746878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":720746878,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDc0Njg3OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T21:56:32Z","updated_at":"2020-11-02T21:56:32Z","author_association":"MEMBER","body":"@liukun4515 I went over this a bit more with @aokolnychyi , we saw that the catalog name is being appended like you saw but this should be a valid identifier for the table. Can you provide me with a bit more info about where things are going wrong and the test you have which is failing?\r\n\r\nFrom what we went over the main issue (if there is one) should be with metadata names from catalogs that start with \"Hadoop.\" or \"hive.\" since there is special logic stripping these catalog names from the table identifiers. All other named catalogs should have their identifier prepended with the Catalog name.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720746878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720748387","html_url":"https://github.com/apache/iceberg/pull/1706#issuecomment-720748387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1706","id":720748387,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDc0ODM4Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-02T22:00:05Z","updated_at":"2020-11-02T22:00:05Z","author_association":"CONTRIBUTOR","body":"I ran the tests without the fix and they do break as expected. I'm going to merge this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720748387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720808972","html_url":"https://github.com/apache/iceberg/issues/1702#issuecomment-720808972","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1702","id":720808972,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDgwODk3Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T00:47:29Z","updated_at":"2020-11-03T00:47:29Z","author_association":"CONTRIBUTOR","body":"@zhangdove, from the description, it looks like the current metadata file for the table was deleted, is that right? If so, then the table was corrupted and this should result in the exception that was thrown. Reading an old metadata file instead of the current one would be incorrect and would roll back changes in the missing metadata file.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720808972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720809218","html_url":"https://github.com/apache/iceberg/pull/1703#issuecomment-720809218","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1703","id":720809218,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDgwOTIxOA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T00:48:42Z","updated_at":"2020-11-03T00:48:42Z","author_association":"CONTRIBUTOR","body":"From the description on #1702, I think the behavior is correct. If a metadata file is deleted, then the table has been broken by another process and it should not automatically roll back to some version that happens to still exist.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720809218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720809829","html_url":"https://github.com/apache/iceberg/pull/1701#issuecomment-720809829","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1701","id":720809829,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDgwOTgyOQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T00:51:12Z","updated_at":"2020-11-03T00:51:12Z","author_association":"CONTRIBUTOR","body":"This comment is actually referring to the Netflix/metacat project, so \"metacat\" is correct.\r\n\r\nThanks for taking the time to post a fix for this though!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720809829/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720810347","html_url":"https://github.com/apache/iceberg/pull/1695#issuecomment-720810347","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1695","id":720810347,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDgxMDM0Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T00:53:06Z","updated_at":"2020-11-03T00:53:06Z","author_association":"CONTRIBUTOR","body":"Merged. Thanks @marton-bod!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720810347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720811031","html_url":"https://github.com/apache/iceberg/pull/1669#issuecomment-720811031","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1669","id":720811031,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDgxMTAzMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T00:55:36Z","updated_at":"2020-11-03T00:55:36Z","author_association":"CONTRIBUTOR","body":"@openinx, please let me know if/when you'd like me to take a look at this PR.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720811031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720812260","html_url":"https://github.com/apache/iceberg/pull/1657#issuecomment-720812260","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1657","id":720812260,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDgxMjI2MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T01:00:17Z","updated_at":"2020-11-03T01:00:17Z","author_association":"CONTRIBUTOR","body":"@rymurr, what changed in Arrow between 0.1.0 and 0.2.0? This isn't part of Iceberg's API, but it is plausible that someone could use the iceberg-arrow module. I'm wondering if that would be likely to break direct uses. I suspect that we should include even major version updates to Arrow in our minor version releases, although not in the patch releases.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720812260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720824937","html_url":"https://github.com/apache/iceberg/issues/1702#issuecomment-720824937","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1702","id":720824937,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDgyNDkzNw==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T01:20:13Z","updated_at":"2020-11-03T01:20:13Z","author_association":"CONTRIBUTOR","body":"@rdblue Yes, just as you described.\r\n\r\nThere is a parameter `write.metadata.previous-versions-max` control the number of metadata, when another process using `actions.RemoveOrphanFiles()` to clean orphan files, the older of metadata files will be deleted, and SparkSession still old cache metadata file information.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720824937/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720827476","html_url":"https://github.com/apache/iceberg/pull/1669#issuecomment-720827476","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1669","id":720827476,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDgyNzQ3Ng==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T01:23:31Z","updated_at":"2020-11-03T01:23:31Z","author_association":"MEMBER","body":"Will take a look today, thanks.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720827476/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720843969","html_url":"https://github.com/apache/iceberg/pull/1391#issuecomment-720843969","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1391","id":720843969,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDg0Mzk2OQ==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T01:36:34Z","updated_at":"2020-11-03T01:36:34Z","author_association":"COLLABORATOR","body":"@JingsongLi , I think this is ready for another review. Could you please take a look?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720843969/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720847578","html_url":"https://github.com/apache/iceberg/pull/1709#issuecomment-720847578","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1709","id":720847578,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDg0NzU3OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T01:40:30Z","updated_at":"2020-11-03T01:40:30Z","author_association":"CONTRIBUTOR","body":"@aokolnychyi, this may be another good one for 0.10.0 if it isn't too late.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720847578/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720851376","html_url":"https://github.com/apache/iceberg/issues/1702#issuecomment-720851376","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1702","id":720851376,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDg1MTM3Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T01:44:39Z","updated_at":"2020-11-03T01:44:39Z","author_association":"CONTRIBUTOR","body":"Are you saying that the version that was deleted wasn't the current version? This failed because a session was kept open for a long time?\r\n\r\nIf so, why didn't refresh on its own work?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720851376/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720862186","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-720862186","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":720862186,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDg2MjE4Ng==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T01:55:19Z","updated_at":"2020-11-03T01:55:19Z","author_association":"CONTRIBUTOR","body":"@jackye1995, I'm happy with the implementation and behavior (other than changing `IcebergSource` later). The main things to fix are names and how we configure it. Thanks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720862186/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720867287","html_url":"https://github.com/apache/iceberg/issues/1702#issuecomment-720867287","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1702","id":720867287,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDg2NzI4Nw==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T02:08:48Z","updated_at":"2020-11-03T02:08:48Z","author_association":"CONTRIBUTOR","body":"We have a Spark service on Zeppelin, it's a long service SparkSession.\r\n\r\nWhen a table that has already been queried is re-queried after some time, it will throw out that the manifestfiles do not exist.\r\n\r\nSo, we executor `spark.sql(\"refresh table prod.db.tb\")`.However, when do refresh, because the old version value is kept in`HadoopTableOperations`, the metadata file is searched using the old version number. The older version of the metadata file has been cleared by another process with `actions.RemoveOrphanFiles()`.\r\n\r\nhttps://github.com/apache/iceberg/blob/4f2b82e53aca0b5d4bee50353396e53a3f55cd10/core/src/main/java/org/apache/iceberg/hadoop/HadoopTableOperations.java#L98\r\n\r\nFinally, the exception is as originally described:\r\n\r\n`\r\norg.apache.iceberg.exceptions.ValidationException: Metadata file for version 3175 is missing\r\n`\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720867287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720872157","html_url":"https://github.com/apache/iceberg/pull/1356#issuecomment-720872157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1356","id":720872157,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDg3MjE1Nw==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T02:29:21Z","updated_at":"2020-11-03T02:29:21Z","author_association":"COLLABORATOR","body":"@shardulm94 , Does that ORC fix also valid in parquet side? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720872157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720873467","html_url":"https://github.com/apache/iceberg/pull/1706#issuecomment-720873467","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1706","id":720873467,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDg3MzQ2Nw==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T02:35:22Z","updated_at":"2020-11-03T02:35:22Z","author_association":"CONTRIBUTOR","body":"I would also be in favor of including this in 0.10.0. Seems like this issue has been here since the very beginning and went unnoticed. Most of our test cases which check for correctness test on a small number of rows (100) and hence do no trigger this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720873467/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720882605","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-720882605","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":720882605,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDg4MjYwNQ==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T03:19:11Z","updated_at":"2020-11-03T03:23:35Z","author_association":"NONE","body":"> @liukun4515 I went over this a bit more with @aokolnychyi , we saw that the catalog name is being appended like you saw but this should be a valid identifier for the table. Can you provide me with a bit more info about where things are going wrong and the test you have which is failing?\r\n> \r\n> From what we went over the main issue (if there is one) should be with metadata names from catalogs that start with \"Hadoop.\" or \"hive.\" since there is special logic stripping these catalog names from the table identifiers. All other named catalogs should have their identifier prepended with the Catalog name.\r\n\r\nThe multi catalog is supported in the spark3.\r\nIn sql extension pr [remove orphan file](https://github.com/aokolnychyi/incubator-iceberg/pull/2/files), if the name of the catalog is `testhive`, the test will fail with the exception.\r\n\r\n`spark.read().format(\"iceberg\").load(allManifestsMetadataTable)` can load the path or table name without catalog(using the default catalog).\r\n`spark.table(allManifestsMetadataTable)`can only load the table name with catalog.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720882605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720889782","html_url":"https://github.com/apache/iceberg/pull/1709#issuecomment-720889782","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1709","id":720889782,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDg4OTc4Mg==","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T03:49:54Z","updated_at":"2020-11-03T04:05:01Z","author_association":"CONTRIBUTOR","body":"Not related to this PR, but I think we don't handle correctly nulls inside NOT IN predicates. If I am not mistaken, NOT IN with null inside should match nothing.\r\n\r\nCreated #1710 for this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720889782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720904777","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-720904777","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":720904777,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDkwNDc3Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T04:59:20Z","updated_at":"2020-11-03T04:59:20Z","author_association":"MEMBER","body":"I don't see why it should fail with that name, can you give an example\ntest? If that is the name of a registered spark catalog it should work.\n\nOn Mon, Nov 2, 2020, 9:19 PM Kun Liu <notifications@github.com> wrote:\n\n> @liukun4515 <https://github.com/liukun4515> I went over this a bit more\n> with @aokolnychyi <https://github.com/aokolnychyi> , we saw that the\n> catalog name is being appended like you saw but this should be a valid\n> identifier for the table. Can you provide me with a bit more info about\n> where things are going wrong and the test you have which is failing?\n>\n> From what we went over the main issue (if there is one) should be with\n> metadata names from catalogs that start with \"Hadoop.\" or \"hive.\" since\n> there is special logic stripping these catalog names from the table\n> identifiers. All other named catalogs should have their identifier\n> prepended with the Catalog name.\n>\n> The multi catalog is supported in the spark3, when the name of the catalog\n> is not \"hadoop\" or \"hive\".\n> In sql extension pr remove orphan file\n> <https://github.com/aokolnychyi/incubator-iceberg/pull/2/files>, if the\n> name of the catalog is testhive, the test will fail with the exception.\n>\n> \n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/1652#issuecomment-720882605>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YLALNRSJDQJAC4VW73SN5ZEDANCNFSM4S4DNVQA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720904777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720917093","html_url":"https://github.com/apache/iceberg/pull/1657#issuecomment-720917093","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1657","id":720917093,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDkxNzA5Mw==","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T05:46:33Z","updated_at":"2020-11-03T05:46:33Z","author_association":"NONE","body":"It's actually 1.0 to 2.0 but it is really more like 1.0 to 1.1. There was a performance optimization that made it into the Java library but no external APIs breaking changes from my recollection. The perf path is probably beneficial to Iceberg.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720917093/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720930842","html_url":"https://github.com/apache/iceberg/pull/1669#issuecomment-720930842","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1669","id":720930842,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDkzMDg0Mg==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T06:30:20Z","updated_at":"2020-11-03T06:30:20Z","author_association":"CONTRIBUTOR","body":"Thanks @simonsssu for your contribution.\r\nIf you don't mind, can you write a design document?\r\nI think it is good to have a global design.\r\n\r\nI have some initial question:\r\n- When to do compaction?\r\n- Does compaction block checkpoint? If there are large number of files need to be compacted, that will lead to the timeout/failure of checkpoint.\r\n- How to do incremental compaction instead of compacting the whole table?\r\n- When to commit compaction? Does it support multiple streaming sinks?\r\n- in addition, can we reuse more codes in https://github.com/apache/iceberg/pull/1623 ? I think essentially they do the same job.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720930842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720937192","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-720937192","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":720937192,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDkzNzE5Mg==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T06:48:32Z","updated_at":"2020-11-03T06:59:41Z","author_association":"NONE","body":"> I don't see why it should fail with that name, can you give an example test? If that is the name of a registered spark catalog it should work.\r\n> [](#)\r\n> On Mon, Nov 2, 2020, 9:19 PM Kun Liu ***@***.***> wrote: @liukun4515 <https://github.com/liukun4515> I went over this a bit more with @aokolnychyi <https://github.com/aokolnychyi> , we saw that the catalog name is being appended like you saw but this should be a valid identifier for the table. Can you provide me with a bit more info about where things are going wrong and the test you have which is failing? From what we went over the main issue (if there is one) should be with metadata names from catalogs that start with \"Hadoop.\" or \"hive.\" since there is special logic stripping these catalog names from the table identifiers. All other named catalogs should have their identifier prepended with the Catalog name. The multi catalog is supported in the spark3, when the name of the catalog is not \"hadoop\" or \"hive\". In sql extension pr remove orphan file <https://github.com/aokolnychyi/incubator-iceberg/pull/2/files>, if the name of the catalog is testhive, the test will fail with the exception.  You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub <[#1652 (comment)](https://github.com/apache/iceberg/issues/1652#issuecomment-720882605)>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/AADE2YLALNRSJDQJAC4VW73SN5ZEDANCNFSM4S4DNVQA> .\r\n\r\nthe conf of spark catalog is:\r\n```\r\ncatalogname : testhive\r\ntype: hive\r\n.....\r\n```\r\nThe identifier of spark table is `testhive.default.tablename`, the interface of spark2 just can load file_path or default table name.\r\n\r\n![image](https://user-images.githubusercontent.com/7450163/97956562-f16a7680-1de3-11eb-931a-d529a70aeabb.png)\r\n\r\n\r\nThe identifier `testhive.default.tablename` is not supported in the spark2.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720937192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720943002","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-720943002","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":720943002,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDk0MzAwMg==","user":{"login":"liukun4515","id":7450163,"node_id":"MDQ6VXNlcjc0NTAxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/7450163?v=4","gravatar_id":"","url":"https://api.github.com/users/liukun4515","html_url":"https://github.com/liukun4515","followers_url":"https://api.github.com/users/liukun4515/followers","following_url":"https://api.github.com/users/liukun4515/following{/other_user}","gists_url":"https://api.github.com/users/liukun4515/gists{/gist_id}","starred_url":"https://api.github.com/users/liukun4515/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liukun4515/subscriptions","organizations_url":"https://api.github.com/users/liukun4515/orgs","repos_url":"https://api.github.com/users/liukun4515/repos","events_url":"https://api.github.com/users/liukun4515/events{/privacy}","received_events_url":"https://api.github.com/users/liukun4515/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T07:04:16Z","updated_at":"2020-11-03T07:04:16Z","author_association":"NONE","body":"@RussellSpitzer you can load spark table from customer catalog where the name is neither `hadoop` nor `hive` and execute the `RemoveOrphanFilesAction`  action.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720943002/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720966040","html_url":"https://github.com/apache/iceberg/issues/1684#issuecomment-720966040","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1684","id":720966040,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMDk2NjA0MA==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T08:08:47Z","updated_at":"2020-11-03T08:08:47Z","author_association":"CONTRIBUTOR","body":"According to https://github.com/apache/iceberg/blob/master/site/docs/hive.md\r\nHive reader only supports read a existed Hadoop table...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/720966040/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721004658","html_url":"https://github.com/apache/iceberg/pull/1669#issuecomment-721004658","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1669","id":721004658,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTAwNDY1OA==","user":{"login":"simonsssu","id":12323514,"node_id":"MDQ6VXNlcjEyMzIzNTE0","avatar_url":"https://avatars.githubusercontent.com/u/12323514?v=4","gravatar_id":"","url":"https://api.github.com/users/simonsssu","html_url":"https://github.com/simonsssu","followers_url":"https://api.github.com/users/simonsssu/followers","following_url":"https://api.github.com/users/simonsssu/following{/other_user}","gists_url":"https://api.github.com/users/simonsssu/gists{/gist_id}","starred_url":"https://api.github.com/users/simonsssu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simonsssu/subscriptions","organizations_url":"https://api.github.com/users/simonsssu/orgs","repos_url":"https://api.github.com/users/simonsssu/repos","events_url":"https://api.github.com/users/simonsssu/events{/privacy}","received_events_url":"https://api.github.com/users/simonsssu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T09:33:47Z","updated_at":"2020-11-03T09:33:47Z","author_association":"CONTRIBUTOR","body":"@JingsongLi Hi Jingsong, Sorry for late response.  I will write a design doc in google doc. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721004658/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721012326","html_url":"https://github.com/apache/iceberg/pull/1623#issuecomment-721012326","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1623","id":721012326,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTAxMjMyNg==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T09:49:22Z","updated_at":"2020-11-03T09:49:22Z","author_association":"CONTRIBUTOR","body":"BTW, @zhangjun0x01 It is better to modify PR title to `Flink: Add a rewrite datafile action`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721012326/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721178340","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-721178340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":721178340,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTE3ODM0MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T14:58:55Z","updated_at":"2020-11-03T14:58:55Z","author_association":"MEMBER","body":"Ah so the error is that the current code uses the non-catalog based Spark\ndataframe pathway through spark.read.format.load. Which triggers\nIcebergSource as a datasource register which can't handle catalogs since it\nis the \"non-catalog\" path.\n\nOn Tue, Nov 3, 2020 at 1:04 AM Kun Liu <notifications@github.com> wrote:\n\n> @RussellSpitzer <https://github.com/RussellSpitzer> you can load spark\n> table from customer catalog where the name is neither hadoop nor hive and\n> execute the RemoveOrphanFilesAction action.\n>\n> \n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/apache/iceberg/issues/1652#issuecomment-720943002>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AADE2YINZSR3VCZJIMGUYZDSN6TP5ANCNFSM4S4DNVQA>\n> .\n>\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721178340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721184762","html_url":"https://github.com/apache/iceberg/issues/1652#issuecomment-721184762","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1652","id":721184762,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTE4NDc2Mg==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T15:05:28Z","updated_at":"2020-11-03T15:05:28Z","author_association":"MEMBER","body":"Ok I can put up a PR for this, the answer is when using Spark3 we should be calling\r\n\r\n    return spark.table(allManifestsMetadataTable).selectExpr(\"path as file_path\");\r\n\r\nInstead of spark.load..blahblah, I need to think for a second if this breaks compatibility with anything ...","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721184762/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721245449","html_url":"https://github.com/apache/iceberg/pull/1417#issuecomment-721245449","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1417","id":721245449,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTI0NTQ0OQ==","user":{"login":"massdosage","id":29457,"node_id":"MDQ6VXNlcjI5NDU3","avatar_url":"https://avatars.githubusercontent.com/u/29457?v=4","gravatar_id":"","url":"https://api.github.com/users/massdosage","html_url":"https://github.com/massdosage","followers_url":"https://api.github.com/users/massdosage/followers","following_url":"https://api.github.com/users/massdosage/following{/other_user}","gists_url":"https://api.github.com/users/massdosage/gists{/gist_id}","starred_url":"https://api.github.com/users/massdosage/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massdosage/subscriptions","organizations_url":"https://api.github.com/users/massdosage/orgs","repos_url":"https://api.github.com/users/massdosage/repos","events_url":"https://api.github.com/users/massdosage/events{/privacy}","received_events_url":"https://api.github.com/users/massdosage/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T16:44:42Z","updated_at":"2020-11-03T16:44:42Z","author_association":"CONTRIBUTOR","body":"This seems to be the cause of the failing `testJoinTables` test:\r\n```\r\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 1\r\n\tat org.apache.iceberg.data.GenericRecord.get(GenericRecord.java:114)\r\n\tat org.apache.iceberg.mr.hive.serde.objectinspector.IcebergRecordObjectInspector.getStructFieldData(IcebergRecordObjectInspector.java:73)\r\n```\r\nI haven't had time to look into the root cause yet.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721245449/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721248387","html_url":"https://github.com/apache/iceberg/issues/1699#issuecomment-721248387","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1699","id":721248387,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTI0ODM4Nw==","user":{"login":"marton-bod","id":19599214,"node_id":"MDQ6VXNlcjE5NTk5MjE0","avatar_url":"https://avatars.githubusercontent.com/u/19599214?v=4","gravatar_id":"","url":"https://api.github.com/users/marton-bod","html_url":"https://github.com/marton-bod","followers_url":"https://api.github.com/users/marton-bod/followers","following_url":"https://api.github.com/users/marton-bod/following{/other_user}","gists_url":"https://api.github.com/users/marton-bod/gists{/gist_id}","starred_url":"https://api.github.com/users/marton-bod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marton-bod/subscriptions","organizations_url":"https://api.github.com/users/marton-bod/orgs","repos_url":"https://api.github.com/users/marton-bod/repos","events_url":"https://api.github.com/users/marton-bod/events{/privacy}","received_events_url":"https://api.github.com/users/marton-bod/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T16:49:48Z","updated_at":"2020-11-03T16:49:48Z","author_association":"COLLABORATOR","body":"Thanks for flagging this issue @qphien . I've started investigating it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721248387/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721276007","html_url":"https://github.com/apache/iceberg/pull/1391#issuecomment-721276007","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1391","id":721276007,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTI3NjAwNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T17:36:51Z","updated_at":"2020-11-03T17:36:51Z","author_association":"CONTRIBUTOR","body":"I'm not sure we want to move forward with these changes. This is a lot of code churn and I don't see much of a benefit. Abstracting this requires using more generic types and calling `asStruct` or similar methods. Without a motivating use case like a new visitor, I wonder if this has enough value to warrant making the changes.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721276007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721282801","html_url":"https://github.com/apache/iceberg/issues/1702#issuecomment-721282801","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1702","id":721282801,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTI4MjgwMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T17:49:53Z","updated_at":"2020-11-03T17:49:53Z","author_association":"CONTRIBUTOR","body":"Okay, if I understand correctly, you keep a table around for several days. It starts on some version, like 3175. Then when you call refresh, it tries to look up the next version and fails because both 3175 and 3176 have been deleted already. So it tries to use 3175 and fails.\r\n\r\nIt seems to me that the problem is keeping a table reference around for that long. Why not drop the cached reference and reload it? You could turn off caching in your catalog.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721282801/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721292039","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-721292039","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":721292039,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTI5MjAzOQ==","user":{"login":"shangxinli","id":31421745,"node_id":"MDQ6VXNlcjMxNDIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31421745?v=4","gravatar_id":"","url":"https://api.github.com/users/shangxinli","html_url":"https://github.com/shangxinli","followers_url":"https://api.github.com/users/shangxinli/followers","following_url":"https://api.github.com/users/shangxinli/following{/other_user}","gists_url":"https://api.github.com/users/shangxinli/gists{/gist_id}","starred_url":"https://api.github.com/users/shangxinli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shangxinli/subscriptions","organizations_url":"https://api.github.com/users/shangxinli/orgs","repos_url":"https://api.github.com/users/shangxinli/repos","events_url":"https://api.github.com/users/shangxinli/events{/privacy}","received_events_url":"https://api.github.com/users/shangxinli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T18:08:03Z","updated_at":"2020-11-03T18:09:21Z","author_association":"CONTRIBUTOR","body":"@shardulm94 I am also curious about why Iceberg reimplements those filters. @rdblue Can you cast some light on this? \r\n\r\nI can see the pros and cons of reimplementing. The concern for reimplementing is that it creates duplication and fragments. For short-term workaround it is fine, but for the long run, I think deduping to one implementation makes more sense. Otherwise, when new filters are added in Parquet, we need to reimplement them here. Column index is one, and bloom filer is another one on the way, and so on. If some filters in Iceberg but not in Parquet, we can bring in to the Parquet community to add them. What do you think?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721292039/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721297867","html_url":"https://github.com/apache/iceberg/pull/1356#issuecomment-721297867","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1356","id":721297867,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTI5Nzg2Nw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T18:19:57Z","updated_at":"2020-11-03T18:19:57Z","author_association":"CONTRIBUTOR","body":"> This includes an optimization that avoids reading extra footer in case of no position column.\r\n\r\nSeparate fixes should be added in different PRs. Thanks for fixing this, I'd like to get it in without blocking on vectorization.\r\n\r\n> Do we want to include this to 0.10.0?\r\n\r\nI don't think so. We want to get 0.10.0 out and even if the vectorization changes made it in, we wouldn't be able to read delete files in the vectorized path.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721297867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721302005","html_url":"https://github.com/apache/iceberg/issues/1710#issuecomment-721302005","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1710","id":721302005,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTMwMjAwNQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T18:28:26Z","updated_at":"2020-11-03T18:28:26Z","author_association":"CONTRIBUTOR","body":"I don't think this is going to be easy. You're right about the behavior, but NOT IN is passed as `not(in(...))` and it works because `not(null)` is `null`. We could inspect the child expression in `not` and look for `in` with a null, but replacing with `alwaysFalse` at that point isn't correct because negating further up the expression tree should still result in `null`, but negating `alwaysFalse` is `alwaysTrue`.\r\n\r\nIn fact, the fix in #1709 also has that problem. `not(x > null)` should be `null`, but would evaluate to `true`. I'm going to revert #1709 until we figure this out.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721302005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721317727","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-721317727","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":721317727,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTMxNzcyNw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T19:01:19Z","updated_at":"2020-11-03T19:01:19Z","author_association":"CONTRIBUTOR","body":"There are a few reasons why Iceberg reimplemented the filters.\r\n\r\n* Faster iteration and more features without needing Parquet releases\r\n* Parquet's filter API has some problems\r\n  * Evaluation is negated (`canDrop` vs `shouldRead`), which has led to more bugs\r\n  * It is missing some predicates that we need to be well supported, like `startsWith`, `in`, `alwaysTrue`, and `alwaysFalse`\r\n  * The API is very difficult to work with\r\n* Iceberg replaces record materialization, so we would need to run these filters from Iceberg code anyway\r\n* Iceberg had already implemented similar filters, like stats evaluation, so it was simple to reuse that code\r\n\r\nTo fix some of the issues with the Parquet API, my hope was that eventually Parquet would use Iceberg's expression API and filters in place of its own. We'd need to refactor a bit to make this happen, but I think it would still be a good option. There are several things that I think would be great to standardize across some of the storage projects like the `FileIO` classes and the expressions.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721317727/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721319133","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-721319133","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":721319133,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTMxOTEzMw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T19:04:00Z","updated_at":"2020-11-03T19:04:00Z","author_association":"CONTRIBUTOR","body":"One more thing, we also wanted to use Iceberg's comparators. I think we had those done before Parquet introduced its comparators, and Iceberg also has strong support for `CharSequence` without conversion to `String`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721319133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721351653","html_url":"https://github.com/apache/iceberg/issues/1711#issuecomment-721351653","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1711","id":721351653,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTM1MTY1Mw==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T20:13:50Z","updated_at":"2020-11-03T20:13:50Z","author_association":"CONTRIBUTOR","body":"I think we should maintain compatibility in `ScanEvent` since it is part of the API. I think I favor the first option, to add an `IncrementalScanEvent`.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721351653/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721354388","html_url":"https://github.com/apache/iceberg/pull/1611#issuecomment-721354388","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1611","id":721354388,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTM1NDM4OA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T20:20:19Z","updated_at":"2020-11-03T20:20:19Z","author_association":"CONTRIBUTOR","body":"Thanks, @HeartSaVioR! I'm okay with adding two tables if you think it's going to be helpful. I merged this and it should go out when we push docs for 0.10.0. Thank you!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721354388/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721365810","html_url":"https://github.com/apache/iceberg/pull/1611#issuecomment-721365810","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1611","id":721365810,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTM2NTgxMA==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T20:46:55Z","updated_at":"2020-11-03T20:46:55Z","author_association":"CONTRIBUTOR","body":"Thanks for understanding, and thanks again for reviewing and merging!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721365810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721415513","html_url":"https://github.com/apache/iceberg/pull/1573#issuecomment-721415513","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1573","id":721415513,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQxNTUxMw==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T22:51:32Z","updated_at":"2020-11-03T22:51:32Z","author_association":"CONTRIBUTOR","body":"> Dan and I had a discussion about `create` and came to an agreement to implement it, but to make sure the docs for it don't make claims about atomicity. It is still useful to have it because some engines may use `create` without overwrite to write data files. And although there are no guarantees when used concurrently, at least only one writer wins. We've had issues with concurrent writes corrupting version-hint.txt files in other file systems, so a lack of guarantees isn't unique to S3.\r\n\r\nI had to make some significant changes in order to make create work in what seems like a reasonable way, but there's lots of behavioral things to consider.  For example, S3InputFile caches the exists call (as does the S3OutputFile now).  I believe we do that to optimize for a traditional exists() -> contentLength() -> open() pattern so that we don't make multiple requests to get the same information from S3.  However, this may not make sense in the create path.\r\n\r\nThis also exposes some strange aspects of the FileIO api in that `deleteFile` is a function of `FileIO` and `exists()` is a function of `InputFile` (though not `OutputFile`).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721415513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721417229","html_url":"https://github.com/apache/iceberg/pull/1573#issuecomment-721417229","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1573","id":721417229,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQxNzIyOQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T22:56:18Z","updated_at":"2020-11-03T22:56:18Z","author_association":"CONTRIBUTOR","body":"@jackye1995 and @rdblue I created a very basic `S3URI` class to replace the `AmazonS3URI`.  For now, it really makes not assumptions other than it is a valid URI and the authority equates to a bucket and path equates to key.\r\n\r\nThere are some advantages to leaving this simple because there are a number of technically valid schemes (e.g. https, s3, s3a, s3n (we still have this form) and may even support signed URLs (didn't look into that).  Since we're already assuming that this will only be used for S3, maybe we don't want to be too opinionated about the validation.  Thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721417229/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721421412","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-721421412","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":721421412,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQyMTQxMg==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T23:08:34Z","updated_at":"2020-11-03T23:08:34Z","author_association":"CONTRIBUTOR","body":"> I meant to make a comment before on this. We used Function<String, String> in Nessie for this and it feels like a narrower interface for this purpose. See here: https://github.com/projectnessie/nessie/blob/main/clients/client/src/main/java/com/dremio/nessie/client/NessieClient.java#L161\r\n\r\nInteresting, but it should still be compatible by using `Map<String, String>::get`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721421412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721422648","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-721422648","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":721422648,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQyMjY0OA==","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T23:12:22Z","updated_at":"2020-11-03T23:12:22Z","author_association":"NONE","body":"I was suggesting using the narrower function instead map here as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721422648/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721423980","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-721423980","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":721423980,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQyMzk4MA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T23:16:04Z","updated_at":"2020-11-03T23:16:04Z","author_association":"CONTRIBUTOR","body":"What's the drawback of using a map? It is a bit narrower to use the function, but it is also limiting. Catalogs can't use `getOrDefault` or check `contains`. I also don't have a serious problem if we need to copy to create an Immutable map for this because it isn't in a performance-critical path.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721423980/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721424922","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-721424922","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":721424922,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQyNDkyMg==","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-03T23:18:57Z","updated_at":"2020-11-03T23:18:57Z","author_association":"NONE","body":"Just a lot extra methods exposed. Iteration, put, etc.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721424922/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721468134","html_url":"https://github.com/apache/iceberg/issues/1713#issuecomment-721468134","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1713","id":721468134,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQ2ODEzNA==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T01:54:46Z","updated_at":"2020-11-04T01:54:46Z","author_association":"CONTRIBUTOR","body":"As the data type of your `frontdoor_timestamp` field is timestamp, you can express `frontdoor_timestamp = '2020-10-20'` by using the following method\r\n\r\n```\r\nval tasks = scan\r\n      .filter(Expressions.greaterThanOrEqual(\"frontdoor_timestamp\", Timestamp.valueOf(\"2020-10-20\").getTime * 1000))\r\n      .filter(Expressions.lessThan(\"frontdoor_timestamp\", Timestamp.valueOf(\"2020-10-21\").getTime * 1000))\r\n```\r\n\r\nMaybe there's a better way to write it, and hopefully that helps you.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721468134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721477554","html_url":"https://github.com/apache/iceberg/issues/1702#issuecomment-721477554","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1702","id":721477554,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQ3NzU1NA==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T02:31:55Z","updated_at":"2020-11-04T02:31:55Z","author_association":"CONTRIBUTOR","body":"Right! We can disable the cache of the catalog by using the `cache-enabled` parameter, but we still want to use the cache to ensure the consistency of the results before and after the data analysis in a short time.\r\n\r\nIn addition, I'm not sure whether agree with the modified of the #1703  from the community's point of view. At least in the current case it will not work.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721477554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721477788","html_url":"https://github.com/apache/iceberg/pull/1391#issuecomment-721477788","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1391","id":721477788,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQ3Nzc4OA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T02:32:46Z","updated_at":"2020-11-04T02:32:46Z","author_association":"COLLABORATOR","body":"@rdblue , This was motivated when `ParquetWithFlinkSchemaVisitor` was adding, see discussion here https://github.com/apache/iceberg/pull/1272#discussion_r476009695. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721477788/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721479960","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-721479960","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":721479960,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTQ3OTk2MA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T02:41:39Z","updated_at":"2020-11-04T02:41:39Z","author_association":"MEMBER","body":"#1652 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721479960/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721502457","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-721502457","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":721502457,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTUwMjQ1Nw==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T04:16:22Z","updated_at":"2020-11-04T04:16:22Z","author_association":"MEMBER","body":"@zhangjun0x01 You may want to take a look at this, especially if you have an Idea on how to make the Spark Actions all extend BaseSparkAction\r\n\r\nAlso pinging for review  @aokolnychyi  and @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721502457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721514228","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-721514228","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":721514228,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTUxNDIyOA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T05:06:46Z","updated_at":"2020-11-04T05:06:46Z","author_association":"CONTRIBUTOR","body":"> Just a lot extra methods exposed. Iteration, put, etc.\r\n\r\nI think the advantage of using a `Map` is that:\r\n1. consistent with the `TableProperties` interface\r\n2. consistent with the Spark and Flink properties interface\r\n3. as Ryan says, there are some useful methods like `getOrDefault` and `contains`, and iteration might still be needed for some use cases such as getting all configs of a certain prefix.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721514228/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721582518","html_url":"https://github.com/apache/iceberg/issues/1684#issuecomment-721582518","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1684","id":721582518,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTU4MjUxOA==","user":{"login":"zanmeipaul","id":20592867,"node_id":"MDQ6VXNlcjIwNTkyODY3","avatar_url":"https://avatars.githubusercontent.com/u/20592867?v=4","gravatar_id":"","url":"https://api.github.com/users/zanmeipaul","html_url":"https://github.com/zanmeipaul","followers_url":"https://api.github.com/users/zanmeipaul/followers","following_url":"https://api.github.com/users/zanmeipaul/following{/other_user}","gists_url":"https://api.github.com/users/zanmeipaul/gists{/gist_id}","starred_url":"https://api.github.com/users/zanmeipaul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zanmeipaul/subscriptions","organizations_url":"https://api.github.com/users/zanmeipaul/orgs","repos_url":"https://api.github.com/users/zanmeipaul/repos","events_url":"https://api.github.com/users/zanmeipaul/events{/privacy}","received_events_url":"https://api.github.com/users/zanmeipaul/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T08:19:20Z","updated_at":"2020-11-04T08:19:20Z","author_association":"NONE","body":"Hi @openinx  @JingsongLi  Thank you for your help. The problem has been solved\r\n\r\nCheckpoint needs to be configured to write data successfully","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721582518/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721596157","html_url":"https://github.com/apache/iceberg/pull/1623#issuecomment-721596157","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1623","id":721596157,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTU5NjE1Nw==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T08:47:24Z","updated_at":"2020-11-04T08:47:24Z","author_association":"MEMBER","body":"@JingsongLi   Any other concern for this patch ?  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721596157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721600027","html_url":"https://github.com/apache/iceberg/pull/1623#issuecomment-721600027","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1623","id":721600027,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTYwMDAyNw==","user":{"login":"JingsongLi","id":9601882,"node_id":"MDQ6VXNlcjk2MDE4ODI=","avatar_url":"https://avatars.githubusercontent.com/u/9601882?v=4","gravatar_id":"","url":"https://api.github.com/users/JingsongLi","html_url":"https://github.com/JingsongLi","followers_url":"https://api.github.com/users/JingsongLi/followers","following_url":"https://api.github.com/users/JingsongLi/following{/other_user}","gists_url":"https://api.github.com/users/JingsongLi/gists{/gist_id}","starred_url":"https://api.github.com/users/JingsongLi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JingsongLi/subscriptions","organizations_url":"https://api.github.com/users/JingsongLi/orgs","repos_url":"https://api.github.com/users/JingsongLi/repos","events_url":"https://api.github.com/users/JingsongLi/events{/privacy}","received_events_url":"https://api.github.com/users/JingsongLi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T08:54:56Z","updated_at":"2020-11-04T08:54:56Z","author_association":"CONTRIBUTOR","body":"Hi @zhangjun0x01 , I think we can add a method `setMaxParallelism` to Flink `RewriteDataFilesAction`. It don't need be a table property.\r\nAnd I think the default value of maxParallelism can be `env.getParallelism`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721600027/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721659857","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-721659857","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":721659857,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTY1OTg1Nw==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T10:50:48Z","updated_at":"2020-11-04T10:50:48Z","author_association":"CONTRIBUTOR","body":"> @zhangjun0x01 You may want to take a look at this, especially if you have an Idea on how to make the Spark Actions all extend BaseSparkAction\r\n\r\nI extracted getManifestListPathsgetOtherMetadataFilePaths and other methods from spark to BaseAction. I think  if we do RemoveOrphanFilesAction and ExpireSnapshotsAction for flink in the future, we can use these methods.\r\n\r\nMy idea is to put the common part of spark actions into BaseSparkAction, and put the common part of spark and flink into BaseAction\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721659857/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721679822","html_url":"https://github.com/apache/iceberg/issues/1711#issuecomment-721679822","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1711","id":721679822,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTY3OTgyMg==","user":{"login":"skambha","id":16563220,"node_id":"MDQ6VXNlcjE2NTYzMjIw","avatar_url":"https://avatars.githubusercontent.com/u/16563220?v=4","gravatar_id":"","url":"https://api.github.com/users/skambha","html_url":"https://github.com/skambha","followers_url":"https://api.github.com/users/skambha/followers","following_url":"https://api.github.com/users/skambha/following{/other_user}","gists_url":"https://api.github.com/users/skambha/gists{/gist_id}","starred_url":"https://api.github.com/users/skambha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skambha/subscriptions","organizations_url":"https://api.github.com/users/skambha/orgs","repos_url":"https://api.github.com/users/skambha/repos","events_url":"https://api.github.com/users/skambha/events{/privacy}","received_events_url":"https://api.github.com/users/skambha/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T11:33:37Z","updated_at":"2020-11-04T11:33:37Z","author_association":"CONTRIBUTOR","body":"sounds good. I went ahead and created a pr using the first option. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721679822/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721680720","html_url":"https://github.com/apache/iceberg/issues/1719#issuecomment-721680720","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1719","id":721680720,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTY4MDcyMA==","user":{"login":"openinx","id":5028729,"node_id":"MDQ6VXNlcjUwMjg3Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/5028729?v=4","gravatar_id":"","url":"https://api.github.com/users/openinx","html_url":"https://github.com/openinx","followers_url":"https://api.github.com/users/openinx/followers","following_url":"https://api.github.com/users/openinx/following{/other_user}","gists_url":"https://api.github.com/users/openinx/gists{/gist_id}","starred_url":"https://api.github.com/users/openinx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/openinx/subscriptions","organizations_url":"https://api.github.com/users/openinx/orgs","repos_url":"https://api.github.com/users/openinx/repos","events_url":"https://api.github.com/users/openinx/events{/privacy}","received_events_url":"https://api.github.com/users/openinx/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T11:35:38Z","updated_at":"2020-11-04T11:35:38Z","author_association":"MEMBER","body":"> ./bin/sql-client.sh embedded -j ./iceberg-flink-0.10.0.jar -j ./flink-sql-connector-hive-3.1.2_2.12-1.11.2.jar shell\r\n\r\nI think you've loaded the wrong iceberg-flink jar,   iceberg-flink-runtime-0.10.0 is the correct one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721680720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721740878","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-721740878","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":721740878,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTc0MDg3OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T13:46:27Z","updated_at":"2020-11-04T13:46:27Z","author_association":"MEMBER","body":"> > @zhangjun0x01 You may want to take a look at this, especially if you have an Idea on how to make the Spark Actions all extend BaseSparkAction\r\n> \r\n> I extracted getManifestListPathsgetOtherMetadataFilePaths and other methods from spark to BaseAction. I think if we do RemoveOrphanFilesAction and ExpireSnapshotsAction for flink in the future, we can use these methods.\r\n> \r\n> My idea is to put the common part of spark actions into BaseSparkAction, and put the common part of spark and flink into BaseAction\r\n\r\nThe problem with this is that we now have some actions which must extend BaseAction and not BaseSparkAction, like \r\n\r\nhttps://github.com/apache/iceberg/blob/f9f5bcfe66be2c808a4f14f59c195f92c31de8fa/core/src/main/java/org/apache/iceberg/actions/BaseSnapshotUpdateAction.java#L26\r\n\r\nIf we follow this pattern, all actions derived from this base cannot use FlinkActions or SparkActions, they can only use BaseAction\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721740878/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721809179","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-721809179","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":721809179,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTgwOTE3OQ==","user":{"login":"shangxinli","id":31421745,"node_id":"MDQ6VXNlcjMxNDIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31421745?v=4","gravatar_id":"","url":"https://api.github.com/users/shangxinli","html_url":"https://github.com/shangxinli","followers_url":"https://api.github.com/users/shangxinli/followers","following_url":"https://api.github.com/users/shangxinli/following{/other_user}","gists_url":"https://api.github.com/users/shangxinli/gists{/gist_id}","starred_url":"https://api.github.com/users/shangxinli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shangxinli/subscriptions","organizations_url":"https://api.github.com/users/shangxinli/orgs","repos_url":"https://api.github.com/users/shangxinli/repos","events_url":"https://api.github.com/users/shangxinli/events{/privacy}","received_events_url":"https://api.github.com/users/shangxinli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T15:44:27Z","updated_at":"2020-11-04T15:44:27Z","author_association":"CONTRIBUTOR","body":"@rdblue, make sense. Now the question is for ColumnIndex filter do we also want to reimplement? And the same question for future bloomfilter. Since we already had other types of filter reimplemented,  it makes more sense to do the same thing. It is just more effort to do, but I can do it if Iceberg decides to reimplement all the filters in Parquet. \r\n\r\nIf we don't reimplement, we might need Parquet to release 1.11.2(we discussed in the last Parquet meeting and that is possible if needed) with a fix to have skipped record count. But we still have the same issue you mentioned above(IN, STARTWITH not supported etc). \r\n\r\n@shardulm94, I didn't address your comments yet. If we decide to reimplement the ColumnIndex filter, then we cannot call readNextRowGroupFilter(). Instead, we will filter pages(maybe in BaseColumnIterator?, need to look into it more). So I will address later once we have agreement here.  \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721809179/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721839901","html_url":"https://github.com/apache/iceberg/issues/1713#issuecomment-721839901","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1713","id":721839901,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTgzOTkwMQ==","user":{"login":"dmgcodevil","id":1413873,"node_id":"MDQ6VXNlcjE0MTM4NzM=","avatar_url":"https://avatars.githubusercontent.com/u/1413873?v=4","gravatar_id":"","url":"https://api.github.com/users/dmgcodevil","html_url":"https://github.com/dmgcodevil","followers_url":"https://api.github.com/users/dmgcodevil/followers","following_url":"https://api.github.com/users/dmgcodevil/following{/other_user}","gists_url":"https://api.github.com/users/dmgcodevil/gists{/gist_id}","starred_url":"https://api.github.com/users/dmgcodevil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dmgcodevil/subscriptions","organizations_url":"https://api.github.com/users/dmgcodevil/orgs","repos_url":"https://api.github.com/users/dmgcodevil/repos","events_url":"https://api.github.com/users/dmgcodevil/events{/privacy}","received_events_url":"https://api.github.com/users/dmgcodevil/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T16:36:51Z","updated_at":"2020-11-04T16:36:51Z","author_association":"CONTRIBUTOR","body":"@zhangdove thanks for the reply, so it's not possible to use a transformation function on queried fields, am I getting this right?\r\nAlso, I've noticed that I need to multiply my timestamp by 1000 otherwise I'm getting wrong results. Why do we need to do that?\r\nFor example in iceberg parquet file frontdoor_timestamp = 1603411200404000, however Timestamp.valueOf(\"2020-10-20\").getTime = 1603411200404","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721839901/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721874701","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-721874701","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":721874701,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTg3NDcwMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T17:38:46Z","updated_at":"2020-11-04T17:38:46Z","author_association":"CONTRIBUTOR","body":"@shangxinli, I think we probably want to build the filtering into Iceberg. I could be convinced otherwise, but it would take a lot of work to use Parquet filters.\r\n\r\nAfter my comment yesterday, I was looking at the implementation here and [noticed another problem](https://github.com/apache/iceberg/pull/1566#discussion_r516902119): Parquet expects a filter that references columns using the name that was written into each data file. Iceberg allows renaming and so the Iceberg filters are written to use field IDs instead of names. That is needed for correctness. If I rename field `a` to `x`, then I have to rewrite the filter `x > 5` to `a > 5` when reading an old data file, or else Parquet thinks there are no matching records because column `x` is not present and is all nulls.\r\n\r\nParquet also doesn't support customizing the filter in `ReadSupport`, so to do this you have to read each file's footer to get its schema, rewrite the filter, and then open the file again to read it.\r\n\r\nI'm remembering more of the issues with the original filter path now, and I think that it makes more sense to do the work in Iceberg for now, with the intent to get the work upstream in a 2.0 Parquet API that fixes some of these issues.\r\n\r\nWhat do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721874701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721899321","html_url":"https://github.com/apache/iceberg/pull/1566#issuecomment-721899321","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1566","id":721899321,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTg5OTMyMQ==","user":{"login":"shangxinli","id":31421745,"node_id":"MDQ6VXNlcjMxNDIxNzQ1","avatar_url":"https://avatars.githubusercontent.com/u/31421745?v=4","gravatar_id":"","url":"https://api.github.com/users/shangxinli","html_url":"https://github.com/shangxinli","followers_url":"https://api.github.com/users/shangxinli/followers","following_url":"https://api.github.com/users/shangxinli/following{/other_user}","gists_url":"https://api.github.com/users/shangxinli/gists{/gist_id}","starred_url":"https://api.github.com/users/shangxinli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shangxinli/subscriptions","organizations_url":"https://api.github.com/users/shangxinli/orgs","repos_url":"https://api.github.com/users/shangxinli/repos","events_url":"https://api.github.com/users/shangxinli/events{/privacy}","received_events_url":"https://api.github.com/users/shangxinli/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T18:28:37Z","updated_at":"2020-11-04T18:28:37Z","author_association":"CONTRIBUTOR","body":"@rdblue I think it makes sense.  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721899321/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721909659","html_url":"https://github.com/apache/iceberg/pull/1722#issuecomment-721909659","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1722","id":721909659,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTkwOTY1OQ==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T18:50:03Z","updated_at":"2020-11-04T18:50:03Z","author_association":"MEMBER","body":"Should we add a test since there isn't one?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721909659/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721923247","html_url":"https://github.com/apache/iceberg/pull/1356#issuecomment-721923247","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1356","id":721923247,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTkyMzI0Nw==","user":{"login":"shardulm94","id":6961317,"node_id":"MDQ6VXNlcjY5NjEzMTc=","avatar_url":"https://avatars.githubusercontent.com/u/6961317?v=4","gravatar_id":"","url":"https://api.github.com/users/shardulm94","html_url":"https://github.com/shardulm94","followers_url":"https://api.github.com/users/shardulm94/followers","following_url":"https://api.github.com/users/shardulm94/following{/other_user}","gists_url":"https://api.github.com/users/shardulm94/gists{/gist_id}","starred_url":"https://api.github.com/users/shardulm94/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shardulm94/subscriptions","organizations_url":"https://api.github.com/users/shardulm94/orgs","repos_url":"https://api.github.com/users/shardulm94/repos","events_url":"https://api.github.com/users/shardulm94/events{/privacy}","received_events_url":"https://api.github.com/users/shardulm94/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T19:16:45Z","updated_at":"2020-11-04T19:16:45Z","author_association":"CONTRIBUTOR","body":"> @shardulm94 , Does that ORC fix also valid in parquet side?\r\n\r\n@chenjunjiedada Which fix you are referring to?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721923247/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721936730","html_url":"https://github.com/apache/iceberg/pull/1722#issuecomment-721936730","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1722","id":721936730,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTkzNjczMA==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T19:43:24Z","updated_at":"2020-11-04T19:43:24Z","author_association":"CONTRIBUTOR","body":"> Should we add a test since there isn't one?\r\n\r\nThanks for the quick feedback! Looks like we have coverage for same method names that accepts string parameter in `TestEvaluator`, I'll add the versions with `UnboundTerm` parameter to this class too, unless people have better suggestions. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721936730/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721958329","html_url":"https://github.com/apache/iceberg/pull/1675#issuecomment-721958329","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1675","id":721958329,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTk1ODMyOQ==","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T20:29:23Z","updated_at":"2020-11-04T20:29:23Z","author_association":"CONTRIBUTOR","body":"+1 LGTM","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721958329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721993672","html_url":"https://github.com/apache/iceberg/pull/1675#issuecomment-721993672","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1675","id":721993672,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTk5MzY3Mg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T21:49:52Z","updated_at":"2020-11-04T21:49:52Z","author_association":"CONTRIBUTOR","body":"Thanks for reviewing, everyone!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/721993672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722001888","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-722001888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":722001888,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjAwMTg4OA==","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T22:09:52Z","updated_at":"2020-11-04T22:09:52Z","author_association":"CONTRIBUTOR","body":"@rdblue @jacques-n any thoughts?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722001888/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722007184","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-722007184","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":722007184,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjAwNzE4NA==","user":{"login":"jacques-n","id":183350,"node_id":"MDQ6VXNlcjE4MzM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/183350?v=4","gravatar_id":"","url":"https://api.github.com/users/jacques-n","html_url":"https://github.com/jacques-n","followers_url":"https://api.github.com/users/jacques-n/followers","following_url":"https://api.github.com/users/jacques-n/following{/other_user}","gists_url":"https://api.github.com/users/jacques-n/gists{/gist_id}","starred_url":"https://api.github.com/users/jacques-n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacques-n/subscriptions","organizations_url":"https://api.github.com/users/jacques-n/orgs","repos_url":"https://api.github.com/users/jacques-n/repos","events_url":"https://api.github.com/users/jacques-n/events{/privacy}","received_events_url":"https://api.github.com/users/jacques-n/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T22:22:32Z","updated_at":"2020-11-04T22:22:32Z","author_association":"NONE","body":"I'm fine with it as is. \r\n\r\nSome background: I'm not especially supportive of maps in interfaces since they are so broad. I've had bad experiences in the past where we've had to move maps to external storage (say DynamoDB) and having a broad use of the Map interface hurt us in reworking things.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722007184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722007621","html_url":"https://github.com/apache/iceberg/pull/1640#issuecomment-722007621","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1640","id":722007621,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjAwNzYyMQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T22:23:42Z","updated_at":"2020-11-04T22:23:42Z","author_association":"CONTRIBUTOR","body":"I think it is okay to use a map here. Like I said, even if we had to copy values to create a map to pass in here, that happens once per session and is not an unreasonable amount of overhead.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722007621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722008888","html_url":"https://github.com/apache/iceberg/pull/1722#issuecomment-722008888","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1722","id":722008888,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjAwODg4OA==","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-04T22:27:09Z","updated_at":"2020-11-04T22:27:09Z","author_association":"MEMBER","body":"I mean it looks obviously correct to me :) I just hoped we could guard against future mistakes :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722008888/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722040499","html_url":"https://github.com/apache/iceberg/issues/1702#issuecomment-722040499","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1702","id":722040499,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjA0MDQ5OQ==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T00:04:06Z","updated_at":"2020-11-05T00:04:06Z","author_association":"CONTRIBUTOR","body":"The fix in #1703 doesn't seem like the right one to me because it will hide problems with broken tables, where the current metadata file is actually missing. For your use case, maybe you should clear out the cache every so often to avoid having this happen, or refresh all of the tables in the cache periodically. Refreshing periodically would make sense to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722040499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722056997","html_url":"https://github.com/apache/iceberg/issues/1702#issuecomment-722056997","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1702","id":722056997,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjA1Njk5Nw==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T00:54:05Z","updated_at":"2020-11-05T00:54:05Z","author_association":"CONTRIBUTOR","body":"Are there any relevant parameters to refresh periodically(If it exists)? Or, we need to manually trigger Refresh all of the Table on a regular basis?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722056997/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722065664","html_url":"https://github.com/apache/iceberg/issues/1660#issuecomment-722065664","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1660","id":722065664,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjA2NTY2NA==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T01:22:38Z","updated_at":"2020-11-05T01:22:38Z","author_association":"CONTRIBUTOR","body":"we had add the max parallelism on #1623 ,close this issue","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722065664/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722068400","html_url":"https://github.com/apache/iceberg/pull/1723#issuecomment-722068400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1723","id":722068400,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjA2ODQwMA==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T01:31:40Z","updated_at":"2020-11-05T01:31:40Z","author_association":"CONTRIBUTOR","body":"FYI @jerryshao and @HeartSaVioR. Since we can project the position of a record in a file, I added this to metadata so that we can use it in streaming offsets. Please have a look, I think it should avoid needing an extra boolean in the offsets.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722068400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722071336","html_url":"https://github.com/apache/iceberg/pull/796#issuecomment-722071336","issue_url":"https://api.github.com/repos/apache/iceberg/issues/796","id":722071336,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjA3MTMzNg==","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T01:41:33Z","updated_at":"2020-11-05T01:41:33Z","author_association":"CONTRIBUTOR","body":"Thanks for the recent update, @jerryshao! Now that 0.10.0 is about ready to go, I think I will have more time to help get this in.\r\n\r\nI've found it difficult to review this one, I think because I've ended up losing context between reviews. Right now, the changes are large enough that it takes me a few days to get time to review. And if it takes you a few days to get the time to update, then we end up with quite a while between reviews and it is harder to pick it back up and continue. I think to avoid that, we may want to look for ways to break this into smaller, easier to review changes. Is there anything that you think we can split out right now? The changes to `SnapshotUtil` look likely.\r\n\r\nAlso, I opened #1723 to make the offset a bit simpler, hopefully that helps.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722071336/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722073524","html_url":"https://github.com/apache/iceberg/pull/796#issuecomment-722073524","issue_url":"https://api.github.com/repos/apache/iceberg/issues/796","id":722073524,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjA3MzUyNA==","user":{"login":"jerryshao","id":850797,"node_id":"MDQ6VXNlcjg1MDc5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/850797?v=4","gravatar_id":"","url":"https://api.github.com/users/jerryshao","html_url":"https://github.com/jerryshao","followers_url":"https://api.github.com/users/jerryshao/followers","following_url":"https://api.github.com/users/jerryshao/following{/other_user}","gists_url":"https://api.github.com/users/jerryshao/gists{/gist_id}","starred_url":"https://api.github.com/users/jerryshao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jerryshao/subscriptions","organizations_url":"https://api.github.com/users/jerryshao/orgs","repos_url":"https://api.github.com/users/jerryshao/repos","events_url":"https://api.github.com/users/jerryshao/events{/privacy}","received_events_url":"https://api.github.com/users/jerryshao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T01:48:38Z","updated_at":"2020-11-05T01:48:38Z","author_association":"CONTRIBUTOR","body":"Sure, let me think a bit on this to split this PR to small ones.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722073524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722075510","html_url":"https://github.com/apache/iceberg/issues/1713#issuecomment-722075510","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1713","id":722075510,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjA3NTUxMA==","user":{"login":"zhangdove","id":25578853,"node_id":"MDQ6VXNlcjI1NTc4ODUz","avatar_url":"https://avatars.githubusercontent.com/u/25578853?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangdove","html_url":"https://github.com/zhangdove","followers_url":"https://api.github.com/users/zhangdove/followers","following_url":"https://api.github.com/users/zhangdove/following{/other_user}","gists_url":"https://api.github.com/users/zhangdove/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangdove/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangdove/subscriptions","organizations_url":"https://api.github.com/users/zhangdove/orgs","repos_url":"https://api.github.com/users/zhangdove/repos","events_url":"https://api.github.com/users/zhangdove/events{/privacy}","received_events_url":"https://api.github.com/users/zhangdove/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T01:55:01Z","updated_at":"2020-11-05T01:55:01Z","author_association":"CONTRIBUTOR","body":"I can't guarantee I can explain the cleanup, so I suggest you take a look at the test case here\r\nhttps://github.com/apache/iceberg/blob/master/api/src/test/java/org/apache/iceberg/transforms/TestTimestampsProjection.java","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722075510/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722081604","html_url":"https://github.com/apache/iceberg/pull/1641#issuecomment-722081604","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1641","id":722081604,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjA4MTYwNA==","user":{"login":"yyanyy","id":71906210,"node_id":"MDQ6VXNlcjcxOTA2MjEw","avatar_url":"https://avatars.githubusercontent.com/u/71906210?v=4","gravatar_id":"","url":"https://api.github.com/users/yyanyy","html_url":"https://github.com/yyanyy","followers_url":"https://api.github.com/users/yyanyy/followers","following_url":"https://api.github.com/users/yyanyy/following{/other_user}","gists_url":"https://api.github.com/users/yyanyy/gists{/gist_id}","starred_url":"https://api.github.com/users/yyanyy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yyanyy/subscriptions","organizations_url":"https://api.github.com/users/yyanyy/orgs","repos_url":"https://api.github.com/users/yyanyy/repos","events_url":"https://api.github.com/users/yyanyy/events{/privacy}","received_events_url":"https://api.github.com/users/yyanyy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T02:15:33Z","updated_at":"2020-11-05T02:15:33Z","author_association":"CONTRIBUTOR","body":"Thank you for all the comments! I think I have addressed all the feedback, and rebased the change. I have also removed the draft tag from the pr. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722081604/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722105602","html_url":"https://github.com/apache/iceberg/pull/1715#issuecomment-722105602","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1715","id":722105602,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjEwNTYwMg==","user":{"login":"zhangjun0x01","id":25563794,"node_id":"MDQ6VXNlcjI1NTYzNzk0","avatar_url":"https://avatars.githubusercontent.com/u/25563794?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangjun0x01","html_url":"https://github.com/zhangjun0x01","followers_url":"https://api.github.com/users/zhangjun0x01/followers","following_url":"https://api.github.com/users/zhangjun0x01/following{/other_user}","gists_url":"https://api.github.com/users/zhangjun0x01/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangjun0x01/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangjun0x01/subscriptions","organizations_url":"https://api.github.com/users/zhangjun0x01/orgs","repos_url":"https://api.github.com/users/zhangjun0x01/repos","events_url":"https://api.github.com/users/zhangjun0x01/events{/privacy}","received_events_url":"https://api.github.com/users/zhangjun0x01/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T02:48:53Z","updated_at":"2020-11-05T02:48:53Z","author_association":"CONTRIBUTOR","body":"I took a look at the methods of BaseSparkAction. At present, these methods are only called by RemoveOrphanFilesAction and ExpireSnapshotsAction. They are mainly used to build DataFrame. Can we change the class name of BaseSparkAction ? such as BaseBuildDataFrameAction, to avoid confusion\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722105602/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722111978","html_url":"https://github.com/apache/iceberg/pull/1356#issuecomment-722111978","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1356","id":722111978,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjExMTk3OA==","user":{"login":"chenjunjiedada","id":3960228,"node_id":"MDQ6VXNlcjM5NjAyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3960228?v=4","gravatar_id":"","url":"https://api.github.com/users/chenjunjiedada","html_url":"https://github.com/chenjunjiedada","followers_url":"https://api.github.com/users/chenjunjiedada/followers","following_url":"https://api.github.com/users/chenjunjiedada/following{/other_user}","gists_url":"https://api.github.com/users/chenjunjiedada/gists{/gist_id}","starred_url":"https://api.github.com/users/chenjunjiedada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenjunjiedada/subscriptions","organizations_url":"https://api.github.com/users/chenjunjiedada/orgs","repos_url":"https://api.github.com/users/chenjunjiedada/repos","events_url":"https://api.github.com/users/chenjunjiedada/events{/privacy}","received_events_url":"https://api.github.com/users/chenjunjiedada/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T03:05:32Z","updated_at":"2020-11-05T03:05:32Z","author_association":"COLLABORATOR","body":"@shardulm94 I meant #1706.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722111978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722114182","html_url":"https://github.com/apache/iceberg/issues/1719#issuecomment-722114182","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1719","id":722114182,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjExNDE4Mg==","user":{"login":"HeChuanXUPT","id":5425689,"node_id":"MDQ6VXNlcjU0MjU2ODk=","avatar_url":"https://avatars.githubusercontent.com/u/5425689?v=4","gravatar_id":"","url":"https://api.github.com/users/HeChuanXUPT","html_url":"https://github.com/HeChuanXUPT","followers_url":"https://api.github.com/users/HeChuanXUPT/followers","following_url":"https://api.github.com/users/HeChuanXUPT/following{/other_user}","gists_url":"https://api.github.com/users/HeChuanXUPT/gists{/gist_id}","starred_url":"https://api.github.com/users/HeChuanXUPT/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeChuanXUPT/subscriptions","organizations_url":"https://api.github.com/users/HeChuanXUPT/orgs","repos_url":"https://api.github.com/users/HeChuanXUPT/repos","events_url":"https://api.github.com/users/HeChuanXUPT/events{/privacy}","received_events_url":"https://api.github.com/users/HeChuanXUPT/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T03:13:51Z","updated_at":"2020-11-05T03:13:51Z","author_association":"CONTRIBUTOR","body":"> > ./bin/sql-client.sh embedded -j ./iceberg-flink-0.10.0.jar -j ./flink-sql-connector-hive-3.1.2_2.12-1.11.2.jar shell\r\n> \r\n> I think you've loaded the wrong iceberg-flink jar, iceberg-flink-runtime-0.10.0 is the correct one.\r\n\r\nMy fault  ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722114182/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722192045","html_url":"https://github.com/apache/iceberg/pull/1723#issuecomment-722192045","issue_url":"https://api.github.com/repos/apache/iceberg/issues/1723","id":722192045,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjE5MjA0NQ==","user":{"login":"HeartSaVioR","id":1317309,"node_id":"MDQ6VXNlcjEzMTczMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1317309?v=4","gravatar_id":"","url":"https://api.github.com/users/HeartSaVioR","html_url":"https://github.com/HeartSaVioR","followers_url":"https://api.github.com/users/HeartSaVioR/followers","following_url":"https://api.github.com/users/HeartSaVioR/following{/other_user}","gists_url":"https://api.github.com/users/HeartSaVioR/gists{/gist_id}","starred_url":"https://api.github.com/users/HeartSaVioR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeartSaVioR/subscriptions","organizations_url":"https://api.github.com/users/HeartSaVioR/orgs","repos_url":"https://api.github.com/users/HeartSaVioR/repos","events_url":"https://api.github.com/users/HeartSaVioR/events{/privacy}","received_events_url":"https://api.github.com/users/HeartSaVioR/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-11-05T07:17:56Z","updated_at":"2020-11-05T07:17:56Z","author_association":"CONTRIBUTOR","body":"I'm not familiar with the details on the code, but it looks OK in general. This would help us to read a manifest file incrementally across multiple batches without a custom representation.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/722192045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]