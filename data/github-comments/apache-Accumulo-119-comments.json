[{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693356943","html_url":"https://github.com/apache/accumulo/issues/3658#issuecomment-1693356943","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3658","id":1693356943,"node_id":"IC_kwDOACaFSM5k7pOP","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-25T13:23:35Z","updated_at":"2023-08-25T13:23:35Z","author_association":"CONTRIBUTOR","body":"@keith-turner, @ctubbsii,  others:\r\n\r\nI have pushed changes to my branch (diff [here](https://github.com/apache/accumulo/compare/elasticity...dlmarion:accumulo:generic-task-api?expand=1)) that modify the Compactor and CompactionCoordinator to use the new TaskManager and TaskRunner Thrift APIs. The RPCs between these two components are now using the new API methods and objects. The External Compaction ITs all pass. Wanted to get any feedback you might have on the approach before moving forward. The next step would be to rename the Compactor and make it more generic so that it can handle different types of tasks.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693356943/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693463618","html_url":"https://github.com/apache/accumulo/issues/3724#issuecomment-1693463618","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3724","id":1693463618,"node_id":"IC_kwDOACaFSM5k8DRC","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-25T14:35:27Z","updated_at":"2023-08-25T14:35:27Z","author_association":"CONTRIBUTOR","body":"Capturing the discussion from the accumulo channel in the ASF slack:\r\n\r\n> \r\nIvarator\r\n  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692908949704919?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nAfter many discussions, I am now thinking along the lines of some fault tolerant coding here.  I think the metadata/in-memory checker should keeps a transaction log on the side.  Whenever things are determined to be consistent it can essentially clear that log.  However when it finds an inconsistency, it can essentially replay that log against what it last knew to be correct to determine what the state of affairs should be.  Then the appropriate reparations can be made.\r\n\r\n\r\nHP\r\n  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692909248027599?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nIt would be cool if it could be smart enough to log results of the decision like \"Metadata still had a reference to a file we successfully major compacted\"  which is basically what we've had to manually search for to confirm we haven't lost data.\r\nStill chewing on potential edge cases like when splits / merges occur...\r\n\r\n\r\n\r\n\r\n\r\nIvarator\r\n  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692909353286359?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nagreed.... messages to help pinpoint the error.\r\n\r\n\r\nKeith Turner\r\n  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692910049730589?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nOne way to implement this would be to have a per tablet set of files that were compacted away.  This set would be cleared on each successful consistency check.  Unsuccessful checks could use the set to compute better messages.\r\n\r\n\r\nIvarator\r\n  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692910103192139?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nI expect files that are compacted away would certainly be part of this transaction log.\r\n\r\n\r\nIvarator\r\n  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692910149781299?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nI will work this tomorrow I think.  In the meantime I look forward to any headway on #3721\r\n\r\n\r\nctubbsii\r\n:mask:  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692910270011849?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nA per-tablet set of files that were compacted away will complicate the no-chop merges feature, because a file might get compacted due to one range entry, but might need to stick around with a different range that has yet to be compacted.\r\n\r\n\r\nctubbsii\r\n:mask:  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692910335942879?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nThat could be mitigated by forcing the compaction code to always compact all ranges for a given file, whenever that file is included in a compaction.\r\n\r\n\r\nKeith Turner\r\n  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692910359144889?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nFor that case, it would probably key the set on file+range like it does when tracking the tablets current files\r\n\r\n\r\nctubbsii\r\n:mask:  [18 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692910424802869?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nYeah, key on StoredTabletFile. A lot of those internal structures were changed in 3.0, though. I'm not sure if this idea would target 2.1 or 3.1. If it's targeting 2.1, it may look very different in 3.1 (and because 3.0 is non-LTM, it wouldn't have the feature at all).\r\n\r\n\r\nChris Shannon\r\n  [4 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692960509933319?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nIf we tracked the set of files based on StoredTabletFile I don't think it would be too much different with the no-chop-merge changes. The internal structure was changed in 3.0 but both 2.1 and 3.0 still only rely on the path as the key for uniqueness (well really it's the file metadata which is just the path.)  With my no-chop-merges branch and changes coming we add the concept of a range to go along with the path to determine a unique file but that is transparent and internal to the StoredTabletFile structure (technically it's part of all TabletFiles). So if we just use StoredTabletFile object when tracking in the set then I would think any code written would work for the most part without too many changes.\r\n\r\n\r\nChris Shannon\r\n  [4 hours ago](https://the-asf.slack.com/archives/CERNB8NDC/p1692960704319349?thread_ts=1692709052.736109&cid=CERNB8NDC)\r\nOne of the benefits of treating each combination of path + range as a unique file (vs the original attempt of having one file track a collection of ranges) is most of the code just \"works\" transparently. Any code that uses a tablet file doesn't really care the paths are the same with different ranges, it just treats them as unique files so things like splits, compactions, etc just work without much modification and i would expect something similar here (edited)","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693463618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693531516","html_url":"https://github.com/apache/accumulo/issues/3722#issuecomment-1693531516","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3722","id":1693531516,"node_id":"IC_kwDOACaFSM5k8T18","user":{"login":"dtspence","id":33552925,"node_id":"MDQ6VXNlcjMzNTUyOTI1","avatar_url":"https://avatars.githubusercontent.com/u/33552925?v=4","gravatar_id":"","url":"https://api.github.com/users/dtspence","html_url":"https://github.com/dtspence","followers_url":"https://api.github.com/users/dtspence/followers","following_url":"https://api.github.com/users/dtspence/following{/other_user}","gists_url":"https://api.github.com/users/dtspence/gists{/gist_id}","starred_url":"https://api.github.com/users/dtspence/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dtspence/subscriptions","organizations_url":"https://api.github.com/users/dtspence/orgs","repos_url":"https://api.github.com/users/dtspence/repos","events_url":"https://api.github.com/users/dtspence/events{/privacy}","received_events_url":"https://api.github.com/users/dtspence/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-25T15:19:40Z","updated_at":"2023-08-25T15:19:40Z","author_association":"CONTRIBUTOR","body":"Would the `UniqueNameAllocator` be a good candidate for representation as a plug-in interface?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693531516/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693591054","html_url":"https://github.com/apache/accumulo/pull/3719#issuecomment-1693591054","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3719","id":1693591054,"node_id":"IC_kwDOACaFSM5k8iYO","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-25T16:06:11Z","updated_at":"2023-08-25T16:06:11Z","author_association":"MEMBER","body":"> What if GOAL_STATE was treated as a process? The pull-down could look like\r\n> \r\n> * GOAL_STATE (Green - Normal. Yellow - SAFE_MODE, Red SHUTDOWN)\r\n> * Manager(s) (Green expected running, Yellow - on or more expected not available, Red, all down)\r\n> * TSERVERS (Green is n > x% available, Yellow if y < n < x, available, Red n < y.\r\n> * GC (Green normal, Yellow slow, Red not run since ?)\r\n> \r\n> The roll-up goal would be to show - GOAL_STATE or if something needed attention.\r\n\r\nIt basically already works like that, except the goal state. The goal state is not really a \"server\" status, though, so I think maybe it's useful to not conflate it with the status codes in the \"Servers\" menu in the nav bar. I think it'd be better to treat it as its own visual element, which is why I was suggesting having a separate \"System messages\" element.\r\n\r\nThis gets a bit complicated, though, because \"Safe mode\" and \"Shutting down\" are really handled by the Manager, even though they are system-wide goal states.\r\n\r\nOne other option is that the Manager just turns orange with safe mode, and red with shutting down. That will be visually distinct enough from the normal yellow because a few tservers are offline. But, it still won't satisfy Ivan's desire to have text prominently displayed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693591054/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693608068","html_url":"https://github.com/apache/accumulo/issues/3722#issuecomment-1693608068","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3722","id":1693608068,"node_id":"IC_kwDOACaFSM5k8miE","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-25T16:15:34Z","updated_at":"2023-08-25T16:15:34Z","author_association":"MEMBER","body":"> Would the `UniqueNameAllocator` be a good candidate for representation as a plug-in interface?\r\n\r\nAt first glance it seems like maybe it could, only because there may be other better ways to do it. However, I don't really see any value in users deciding on the file naming for Accumulo's internally generated data files. There's a risk of the names being not unique, which could severely break things. There's also the risk of them breaking our file naming conventions, which some internal code uses to clean up (.rf.tmp files), or assumptions about whether a file was added as part of a bulk import vs. a major compaction, due to the first letter prefix, etc.\r\n\r\nWe could really go overboard, by making a pluggable interface for every little operation inside Accumulo. I'd be reluctant to making this one pluggable. There's too much that could go wrong, and I don't think it necessarily makes sense to pass this on to users.\r\n\r\nIs there a particular alternative implementation you had in mind? Or were you just thinking about tuning the existing mechanism more?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693608068/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693885903","html_url":"https://github.com/apache/accumulo/issues/3722#issuecomment-1693885903","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3722","id":1693885903,"node_id":"IC_kwDOACaFSM5k9qXP","user":{"login":"dtspence","id":33552925,"node_id":"MDQ6VXNlcjMzNTUyOTI1","avatar_url":"https://avatars.githubusercontent.com/u/33552925?v=4","gravatar_id":"","url":"https://api.github.com/users/dtspence","html_url":"https://github.com/dtspence","followers_url":"https://api.github.com/users/dtspence/followers","following_url":"https://api.github.com/users/dtspence/following{/other_user}","gists_url":"https://api.github.com/users/dtspence/gists{/gist_id}","starred_url":"https://api.github.com/users/dtspence/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dtspence/subscriptions","organizations_url":"https://api.github.com/users/dtspence/orgs","repos_url":"https://api.github.com/users/dtspence/repos","events_url":"https://api.github.com/users/dtspence/events{/privacy}","received_events_url":"https://api.github.com/users/dtspence/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-25T20:19:28Z","updated_at":"2023-08-25T20:19:28Z","author_association":"CONTRIBUTOR","body":"> > Would the `UniqueNameAllocator` be a good candidate for representation as a plug-in interface?\r\n> \r\n> At first glance it seems like maybe it could, only because there may be other better ways to do it. However, I don't really see any value in users deciding on the file naming for Accumulo's internally generated data files. There's a risk of the names being not unique, which could severely break things. There's also the risk of them breaking our file naming conventions, which some internal code uses to clean up (.rf.tmp files), or assumptions about whether a file was added as part of a bulk import vs. a major compaction, due to the first letter prefix, etc.\r\n> \r\n> We could really go overboard, by making a pluggable interface for every little operation inside Accumulo. I'd be reluctant to making this one pluggable. There's too much that could go wrong, and I don't think it necessarily makes sense to pass this on to users.\r\n> \r\n> Is there a particular alternative implementation you had in mind? Or were you just thinking about tuning the existing mechanism more?\r\n\r\nThere was a discussion about implementations (some may be tuning related) (e.g. partitioning lookups at global or tablet server level). We do not have any specific implementations though. In context, we had discussed different implementation trade-offs and if having the method as pluggable could help with some of the challenges mentioned.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693885903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693997778","html_url":"https://github.com/apache/accumulo/pull/3640#issuecomment-1693997778","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3640","id":1693997778,"node_id":"IC_kwDOACaFSM5k-FrS","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-25T22:26:17Z","updated_at":"2023-08-27T17:26:57Z","author_association":"CONTRIBUTOR","body":"@keith-turner - You can ignore that original comment about the DeleteRowsIT hanging. It turns out the client was getting exceptions with trying to load Tablets that were offline. Things got screwed up as metadata was being updated for online tablets but that has been fixed. \r\n\r\nI have deletes (seemingly) working without chop compactions in a branch that is based off of this PR: \r\nhttps://github.com/cshannon/accumulo/commit/3e5cd920a0edf108b143e7f2624ed436a8a55e3b\r\n\r\nIt loads the tablets that overlap the start/end of the delete range and then if the tablets share a boundary with the delete range (end row matches prevs end row) then the files are fenced. This is the same condition used to detect when to run a chop compaction. \r\n\r\nThis isn't final because the condition on when metadata is updated is likely going to change when I look at getting rid of splits which I'll do next. Currently this works because splits run first and create the new tablets on the deletion boundaries. When splits go away in favor of fencing the files, i'll need to update the condition on when fencing happens but i at least wanted to get this working for now.\r\n\r\nAt some point (when I work on splits) I guess I'll want to create a PR for the combination of no chop deletes and fencing files instead of splits but that runs into the chained PR issue so we will see how that goes, but until then I'll keep it just in a branch.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1693997778/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1694718540","html_url":"https://github.com/apache/accumulo/pull/3640#issuecomment-1694718540","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3640","id":1694718540,"node_id":"IC_kwDOACaFSM5lA1pM","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-27T17:17:16Z","updated_at":"2023-08-27T17:17:16Z","author_association":"CONTRIBUTOR","body":"I am going to go ahead and merge this into the no-chop-merge branch as I am going to create another PR for removing chops and splits for deletion that is based on this. The entire no-chop-merge branch will go through another final review before going back into main so it will be reviewed again.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1694718540/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1694736806","html_url":"https://github.com/apache/accumulo/pull/3728#issuecomment-1694736806","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3728","id":1694736806,"node_id":"IC_kwDOACaFSM5lA6Gm","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-27T18:56:23Z","updated_at":"2023-08-27T18:56:23Z","author_association":"CONTRIBUTOR","body":"I started a full IT build and will report back the results when finished.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1694736806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1695775189","html_url":"https://github.com/apache/accumulo/issues/3724#issuecomment-1695775189","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3724","id":1695775189,"node_id":"IC_kwDOACaFSM5lE3nV","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-28T14:12:47Z","updated_at":"2023-08-28T14:12:47Z","author_association":"CONTRIBUTOR","body":"If the issue found in #3721 is found to be the cause of the \"in-memory differ\" issue that has been happening in 2.1.x, then I'm not sure that we would need to add #3727 . ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1695775189/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1695782503","html_url":"https://github.com/apache/accumulo/pull/3730#issuecomment-1695782503","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3730","id":1695782503,"node_id":"IC_kwDOACaFSM5lE5Zn","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-28T14:17:09Z","updated_at":"2023-08-28T14:17:09Z","author_association":"CONTRIBUTOR","body":"Did you intend to target this for 3.1 (current main) or as a fix to 2.1.3?  You may need to adjust the target branch and resolve changes for 2.1.3.  ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1695782503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1695830250","html_url":"https://github.com/apache/accumulo/pull/3728#issuecomment-1695830250","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3728","id":1695830250,"node_id":"IC_kwDOACaFSM5lFFDq","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-28T14:45:02Z","updated_at":"2023-08-28T14:45:55Z","author_association":"CONTRIBUTOR","body":"> I started a full IT build and will report back the results when finished.\r\n\r\nThe full IT build passed. Also, the best IT that demonstrates deletion working is `DeleteRowsIT`","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1695830250/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1695965800","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1695965800","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1695965800,"node_id":"IC_kwDOACaFSM5lFmJo","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-28T16:12:30Z","updated_at":"2023-08-28T16:12:30Z","author_association":"CONTRIBUTOR","body":"I'm not convinced that we should do something like this yet. It's attempting to solve the problem by overwriting the list of files for the Tablet. It's not fixing the root cause and could introduce other issues. I would feel much better if this **only** dumped the transaction log.\r\n\r\nIn the three places that `DatafileTransactionLog` is used, it's called right after the code adds to the local synchronized`datafileSizes` map.  In the case of bulk import and minor compaction, the metadata table is updated before the files are added to `datafileSizes`. In the case of major compaction, it happens after. In any of those cases, if #3721 is the cause, then the metadata table would be out of sync with `datafileSizes` and `datafileSizes` should contain the correct list of files.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1695965800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696015302","html_url":"https://github.com/apache/accumulo/issues/3722#issuecomment-1696015302","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3722","id":1696015302,"node_id":"IC_kwDOACaFSM5lFyPG","user":{"login":"jschmidt10","id":1583214,"node_id":"MDQ6VXNlcjE1ODMyMTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1583214?v=4","gravatar_id":"","url":"https://api.github.com/users/jschmidt10","html_url":"https://github.com/jschmidt10","followers_url":"https://api.github.com/users/jschmidt10/followers","following_url":"https://api.github.com/users/jschmidt10/following{/other_user}","gists_url":"https://api.github.com/users/jschmidt10/gists{/gist_id}","starred_url":"https://api.github.com/users/jschmidt10/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jschmidt10/subscriptions","organizations_url":"https://api.github.com/users/jschmidt10/orgs","repos_url":"https://api.github.com/users/jschmidt10/repos","events_url":"https://api.github.com/users/jschmidt10/events{/privacy}","received_events_url":"https://api.github.com/users/jschmidt10/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-28T16:45:37Z","updated_at":"2023-08-28T16:45:37Z","author_association":"CONTRIBUTOR","body":"Here's an initial PR that makes it configurable. It does not hit the granularity that Ed mentioned above. This would be a global allocation configuration.\r\n\r\nhttps://github.com/apache/accumulo/pull/3729","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696015302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696183698","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1696183698","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1696183698,"node_id":"IC_kwDOACaFSM5lGbWS","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-28T18:44:49Z","updated_at":"2023-08-28T18:44:49Z","author_association":"CONTRIBUTOR","body":"> I'm not convinced that we should do something like this yet. It's attempting to solve the problem by overwriting the list of files for the Tablet. It's not fixing the root cause and could introduce other issues. I would feel much better if this **only** dumped the transaction log.\r\n> \r\n> In the three places that `DatafileTransactionLog` is used, it's called right after the code adds to the local synchronized`datafileSizes` map. In the case of bulk import and minor compaction, the metadata table is updated before the files are added to `datafileSizes`. In the case of major compaction, it happens after. In any of those cases, if #3721 is the cause, then the metadata table would be out of sync with `datafileSizes` and `datafileSizes` should contain the correct list of files.\r\n\r\nI was not attempting to solve the problem but to supply a mechanism to do cleanup when this is detected.  I was expecting that \"log\" would be used until a snafu happens at which time the recovery value can be set as appropriate given what ever happened and then set back to \"log\".  It took us 16 hours to try and recover a system the last time this happened.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696183698/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696374252","html_url":"https://github.com/apache/accumulo/issues/3731#issuecomment-1696374252","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3731","id":1696374252,"node_id":"IC_kwDOACaFSM5lHJ3s","user":{"login":"jsduncan2","id":11251939,"node_id":"MDQ6VXNlcjExMjUxOTM5","avatar_url":"https://avatars.githubusercontent.com/u/11251939?v=4","gravatar_id":"","url":"https://api.github.com/users/jsduncan2","html_url":"https://github.com/jsduncan2","followers_url":"https://api.github.com/users/jsduncan2/followers","following_url":"https://api.github.com/users/jsduncan2/following{/other_user}","gists_url":"https://api.github.com/users/jsduncan2/gists{/gist_id}","starred_url":"https://api.github.com/users/jsduncan2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsduncan2/subscriptions","organizations_url":"https://api.github.com/users/jsduncan2/orgs","repos_url":"https://api.github.com/users/jsduncan2/repos","events_url":"https://api.github.com/users/jsduncan2/events{/privacy}","received_events_url":"https://api.github.com/users/jsduncan2/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-28T20:34:41Z","updated_at":"2023-08-28T20:55:42Z","author_association":"NONE","body":"We are also seeing this with the BatchWriter. If one large mutation (> 49 * 1024 * 1024 bytes) or several mutations that add up to that same size or greater are sent, we enter an infinite loop. The BatchWriter client receives a “java.io.IOException: org.apache.thrift.transport.TTransportException: Socket is closed by peer.” here: https://github.com/apache/accumulo/blob/main/core/src/main/java/org/apache/accumulo/core/clientImpl/TabletServerBatchWriter.java#L897\r\n\r\nFor what it’s worth, Thrift 0.14 seems to have added this max message size check (different from the max frame size check): https://issues.apache.org/jira/browse/THRIFT-5021\r\n\r\nA possible additional improvement could be to have the BatchWriter break its set of mutations into chunks that are smaller than Thrift’s max message size (while also respecting all other constraints).\r\n\r\nThis doesn’t address the case where a single mutations exceeds the max message size limit. I’m not sure the best solution here. Possibly throwing a `MutationsRejectedException`?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696374252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696675223","html_url":"https://github.com/apache/accumulo/issues/3732#issuecomment-1696675223","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3732","id":1696675223,"node_id":"IC_kwDOACaFSM5lITWX","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T02:27:59Z","updated_at":"2023-08-29T02:27:59Z","author_association":"MEMBER","body":"First, I just want to mention I'm not sure this is the best venue for a discussion. This is probably better suited to the developer mailing list. But I'll respond here for now.\r\n\r\nIt's worth noting that this was something that we didn't quite finish cleaning up in 2.1 and 3.0 (my fault... I had this on my personal TODO list, but it got lost), so some stuff is still there and hasn't been removed. The scan interpreter was removed, but the formatter still partially remains as a per-table property. I would argue for completing that removal, rather than reversing course, though.\r\n\r\nFor background, there is quite a history with this. The earliest I could find relates to a proposal in 2013 to try to replace the shell with a suite of more narrowly tailored utilities [ACCUMULO-1045](https://issues.apache.org/jira/browse/ACCUMULO-1045) in the spirit of Unix's \"Make each program do one thing well\" philosophy, so that a bloated shell was not needed, and we could reduce a lot of complexity by empowering users to utilize tools in their OS's shell rather than reimplement those features ourselves in Accumulo's shell with a lot of maintenance overhead. Formatting the output using Linux tools (sed, awk, perl, cut, tr, head, tail, paste, etc.) was just one of the possible options. Now that we have modern Java, which can execute a .java source file with a main method without first compiling and packaging it, or that can use JShell, which comes loaded with a bunch of features itself for interactively scripting Java, and now that we have a simple to use AccumuloClient object that can be initialized automatically using a client configuration file, it is very trivial to interact with Accumulo without using the provided shell. So, we are closer today than we ever have been to be able to get rid of the shell in favor of separate tools, though not quite in the way I proposed in ACCUMULO-1045. Now, most of the shell's interactivity features could probably be replaced by JShell, and the few remaining use cases can be easily scripted by users on-demand for their specific cases. So, in a way, I think we're even better situated to get rid of the Accumulo shell than what I proposed on that old JIRA.\r\n\r\nWe revisited the discussion when we started looking at the complexity and inconvenience of the ScanInterpreter in 2019 with #1138. It was there that we first actually proposed to remove the formatter and interpreter options, without a drastic change in the Accumulo shell. It finally got done over a year ago when #2806 was merged to address #2787, which itself was created because of the user confusion the current code caused (#2210).\r\n\r\nWhile this change happened recently, it's been in the works for years, with on-and-off discussions about it. It basically boils down to this:\r\n\r\n* The feature adds a lot of complexity, for a small convenience. There are now many much more simple ways for users to achieve the same thing. Even if JShell isn't used, it's trivial to write a small AccumuloClient that uses the same config file and scans a table and outputs lines in any format the user wishes.\r\n* This feature tried to bridge the gap for users between the limited maintenance functionality that the shell is supposed to be for, and the way they actually think about their data. Unfortunately, it did so by creating confusion because Accumulo now has two views of the data... how it's actually stored, and the way users think about it; this creates as many problems as it solves, not the least of which was that it did this inconsistently between similar shell commands.\r\n* It bloats the shell and makes users more dependent on Accumulo's shell to satisfy every little niche use case they might have, rather than being a general purpose tool for maintenance. We want to balance the convenience with having a general purpose maintenance tool with the shell having a limited and easy-to-maintain scope. We don't want to go too far and become the default means by which users scan their data, with a bloated and feature-full tool that is intended to handle nearly every use case out of an abundance of convenience (that's not sustainable).\r\n\r\nUltimately, I don't think we need this feature in Accumulo anymore to support the use case it was originally intended for. I think I could probably help you write a set of much more narrowly-focused set of tools to handle your use case. Before we try to reintroduce this feature, I'm happy to try to discuss your specific use cases, and to help your team consider some alternatives that I think might be better overall.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696675223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696914218","html_url":"https://github.com/apache/accumulo/pull/3736#issuecomment-1696914218","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3736","id":1696914218,"node_id":"IC_kwDOACaFSM5lJNsq","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T07:26:37Z","updated_at":"2023-08-29T07:26:37Z","author_association":"MEMBER","body":"#3729 was merged before I had a chance to review it. Here's my suggestions to make the property names (and implementation) a bit more simple to understand.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1696914218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697122028","html_url":"https://github.com/apache/accumulo/pull/3733#issuecomment-1697122028","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3733","id":1697122028,"node_id":"IC_kwDOACaFSM5lKAbs","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T09:52:07Z","updated_at":"2023-08-29T09:52:07Z","author_association":"MEMBER","body":"I think removing the use of Writer, and cleanup of closing the batch writer are distinct things. Removing the use of the single-mutation Writer can be done as a separate, first step. It would make it much easier to evaluate the changes that are specifically related to the Batch Writer cleanup.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697122028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697127644","html_url":"https://github.com/apache/accumulo/issues/3735#issuecomment-1697127644","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3735","id":1697127644,"node_id":"IC_kwDOACaFSM5lKBzc","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T09:55:58Z","updated_at":"2023-08-29T09:55:58Z","author_association":"MEMBER","body":"If #3733 is split into two tasks: one to refactor to use the batch writer, and the other to fix the BatchWriter's writes-after-close bug, then when the first task is merged forward, we can just delete it from 3.1, since it will be unused in 3.1 after that. Right now, it's hard to do that separately, because the changes in #3733 that would allow us to do this are currently entangled with the bugfix there.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697127644/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697206998","html_url":"https://github.com/apache/accumulo/pull/3728#issuecomment-1697206998","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3728","id":1697206998,"node_id":"IC_kwDOACaFSM5lKVLW","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T10:50:42Z","updated_at":"2023-08-29T10:50:42Z","author_association":"CONTRIBUTOR","body":"> This code is a nightmare to look at and work with. Not your code specifically... just the totality of what's there, due to the complexity of all the edge cases and the overlaps checks, and the deep call stacks that are difficult to follow; I'm not even sure what can be done to clean any of it up. Your code thankfully is not making it worse... but I do wonder if there's more we can do to make some of these internals more maintainable in general.\r\n\r\n@ctubbsii - Thanks for the review, you are right this was quite a challenge to work through all the edge cases and I'm not sure if I got them all or not. I got the ones that of course were failing due to testing but there may be more that might come up. When I was working through the issues the main test case I used to help was https://github.com/apache/accumulo/blob/5bec1c33af6c464ce75f25ade7b4bd4dba0709ea/test/src/main/java/org/apache/accumulo/test/functional/DeleteRowsIT.java#L82-L115 \r\n\r\nThat test seemed to cover most stuff but I need to think about if there are more. Something else that I just realized I still need to test but didn't have time for yet is deleting ranges when tablets already contained fenced files which makes sure clipping of ranges works. (I do have tests for this already for the merge case though). A simple way to test that would be to merge some tablets to create fenced files (and make sure compaction is disabled so it doesn't clean it up after) and then run a delete that will touch the files again so we have to narrow the ranges on a file that already has a range. I can do that later this week to make sure it works and if it doesn't fix any issues.\r\n\r\nOne nice thing about putting all of this into the no-chop-merge branch is it gives an opportunity to keep testing and do follow up PRs before doing one big final review. I think things are finally getting close though so hoping we can get this merged into main before too long.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697206998/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697240962","html_url":"https://github.com/apache/accumulo/issues/3731#issuecomment-1697240962","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3731","id":1697240962,"node_id":"IC_kwDOACaFSM5lKdeC","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T11:13:03Z","updated_at":"2023-08-29T11:13:03Z","author_association":"MEMBER","body":"@cshannon previously looked into #3134, which is related to Thrift's max message stuff, and may have some insight.\r\n\r\nUpon a first pass investigating this, I can see that Thrift does not have an API for configuring the max message size. It has a hard-coded value of 100MB. The max frame size is 16MB, but that is configurable. I'm not sure why the max message size isn't configurable, but it seems like a patch to Thrift would be needed to do much about this.\r\n\r\nWe can try to break up the Mutations based on the max message size, or throw some client side error that isn't going to retry forever, but that's going to take a lot of wiring up of the RPC layer up into the Accumulo client library, and I'm not quite comfortable with tightly coupling those layers like that. It might be better to just impose a strict limit on the client side for the max message, using our knowledge of the hard-coded Thrift value... and work with upstream Thrift to change it or make it configurable.\r\n\r\nHowever, I *think* if you set the BatchWriter maxMemory to something less than 100MB (might need to account for some overhead), you can probably avoid hitting this issue.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697240962/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697257663","html_url":"https://github.com/apache/accumulo/issues/3731#issuecomment-1697257663","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3731","id":1697257663,"node_id":"IC_kwDOACaFSM5lKhi_","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T11:25:45Z","updated_at":"2023-08-29T11:28:46Z","author_association":"MEMBER","body":"It looks like the problem occurred in 0.14.0 with commit https://github.com/apache/thrift/commit/63213c17ad3fece91fdaaca8f59165ca3f41c5c1 (apache/thrift#2191; [THRIFT-5237](https://issues.apache.org/jira/browse/THRIFT-5237)). The change added a TConfiguration object and a TEndpointTransport base class for several TTransports, including the TFramedTransport that we use. However, they didn't provide new constructors to be able to pass in a TConfiguration in the child classes, and not all of them have a way to customize the TConfiguration they use.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697257663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697377127","html_url":"https://github.com/apache/accumulo/issues/3731#issuecomment-1697377127","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3731","id":1697377127,"node_id":"IC_kwDOACaFSM5lK-tn","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T12:46:42Z","updated_at":"2023-08-29T12:46:42Z","author_association":"CONTRIBUTOR","body":"In #3134, If I recall correctly we were not applying our setting correctly to `maxFrameSize` so Thrift was hanging instead of throwing an error like it should after changes. I didn't touch anything with max message size in thrift. It's a bit confusing as there is maxFrameSize and maxMessageSize is used interchangeably a lot but they are different. We actually call it `maxMessageSize` in our [code](https://github.com/apache/accumulo/blob/5bec1c33af6c464ce75f25ade7b4bd4dba0709ea/server/base/src/main/java/org/apache/accumulo/server/rpc/TServerUtils.java#L153) and our [configuration](https://github.com/apache/accumulo/blob/5bec1c33af6c464ce75f25ade7b4bd4dba0709ea/core/src/main/java/org/apache/accumulo/core/conf/Property.java#L648) even though we apply it to `maxFrameSize` in thrift and the default is set to 1 GB.\r\n\r\nI found some docs here: \r\nhttps://github.com/apache/thrift/blob/v0.17.0/doc/specs/thrift-tconfiguration.md#maxmessagesize and https://github.com/apache/thrift/blob/v0.17.0/doc/specs/thrift-tconfiguration.md#maxframesize-vs-maxmessagesize\r\n\r\nIt says that all current implementations just send 1 frame at a time so the values are related and will essentially pick the smaller one I guess. So I think we should really be applying our max message size setting in our configuration to both max message and max frame size in thrift and that would likely solve the issue, but as @ctubbsii pointed out, it doesn't look like we can currently do that without a patch to make it configurable.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697377127/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697500992","html_url":"https://github.com/apache/accumulo/issues/3731#issuecomment-1697500992","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3731","id":1697500992,"node_id":"IC_kwDOACaFSM5lLc9A","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T13:59:10Z","updated_at":"2023-08-29T13:59:10Z","author_association":"MEMBER","body":"We could put an upper-bound on our own configuration, so you can't set the max frame size bigger than the hard-coded limit. I'm not sure what configuration triggered this, though. There's still the issue of the fact that it's going to cause an exception that isn't going to fall out... mostly because it's hard to distinguish the error from transient transport exceptions, except for the e.getMessage() string, which is probably a bit fragile.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697500992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697799057","html_url":"https://github.com/apache/accumulo/pull/3733#issuecomment-1697799057","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3733","id":1697799057,"node_id":"IC_kwDOACaFSM5lMluR","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T16:41:29Z","updated_at":"2023-08-29T16:41:29Z","author_association":"CONTRIBUTOR","body":"> I think removing the use of Writer, and cleanup of closing the batch writer are distinct things. Removing the use of the single-mutation Writer can be done as a separate, first step. It would make it much easier to evaluate the changes that are specifically related to the Batch Writer cleanup.\r\n\r\nI fixed that because I realized it had the same underlying problem and could cause metadata writes to happen after one would expect.  I can the change commit messages to be more generic in that it fixes all write issues of the same kind.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697799057/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697948210","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1697948210","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1697948210,"node_id":"IC_kwDOACaFSM5lNKIy","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T18:38:46Z","updated_at":"2023-08-29T18:38:46Z","author_association":"CONTRIBUTOR","body":"Created as `draft` because I think a test needs to be added to confirm that the message and frame sizes are getting set. While looking at this I found several things:\r\n\r\n1. Not all Thrift server types use the framed transport\r\n\r\n2. According to [this](https://github.com/apache/thrift/blob/master/doc/specs/thrift-tconfiguration.md#maxframesize) all current implementations send one message in one frame, which begs the question why are we using framed transports.\r\n\r\n3. The Accumulo servers have properties for their max message size, which falls back to the general max message size when not defined. The remaining places where Thrift connections are created are using a maxMessageSize of `Integer.MAX_VALUE`. As mentioned, the Accumulo max message properties were not setting the Thrift `maxMessageSize`, they were setting the `maxFrameSize`. The default Thrift `maxMessageSize` is 100MB, so any frame size over that will get lowered to 100MB. This change sets the Thrift maxMessageSize, I'm unsure what will happen when the client and server have different values.\r\n\r\n4. Ideally, we should get reduce the max message size Accumulo properties to 1 and default it to a large value (2GB?).","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697948210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697966150","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1697966150","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1697966150,"node_id":"IC_kwDOACaFSM5lNOhG","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T18:53:02Z","updated_at":"2023-08-29T18:53:02Z","author_association":"CONTRIBUTOR","body":"So, I think my initial reaction to this change was based on a misunderstanding. I thought this was creating a 3rd object in which changes were tracked, and then either updating the tablet metadata or `datafileSize` with the contents of the 3rd object. It's not doing that after looking further, it's either updating the tablet metadata from `datafileSizes` or the reverse of that. ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697966150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697969605","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1697969605","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1697969605,"node_id":"IC_kwDOACaFSM5lNPXF","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T18:55:43Z","updated_at":"2023-08-29T18:55:43Z","author_association":"CONTRIBUTOR","body":"Kicked off full IT build","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1697969605/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698074719","html_url":"https://github.com/apache/accumulo/pull/3730#issuecomment-1698074719","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3730","id":1698074719,"node_id":"IC_kwDOACaFSM5lNpBf","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T20:21:37Z","updated_at":"2023-08-29T20:21:37Z","author_association":"MEMBER","body":"> Did you intend to target this for 3.1 (current main) or as a fix to 2.1.3? You may need to adjust the target branch and resolve changes for 2.1.3.\r\n\r\nThis is not an urgent issue for 2.1 and not worth any behavior changes there. I wouldn't suggest targeting that branch. The main branch should suffice, pending the outcome of code reviews.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698074719/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698075184","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1698075184","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1698075184,"node_id":"IC_kwDOACaFSM5lNpIw","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T20:21:59Z","updated_at":"2023-08-29T20:21:59Z","author_association":"CONTRIBUTOR","body":"> I was not attempting to solve the problem but to supply a mechanism to do cleanup when this is detected. I was expecting that \"log\" would be used until a snafu happens at which time the recovery value can be set as appropriate given what ever happened and then set back to \"log\". It took us 16 hours to try and recover a system the last time this happened.\r\n\r\nThere is a highly unlikely edge case with this work flow. If two tablets develop inconsistencies at around the same time, but analysis reveals one needs `memsync` and the other needs `metasync` that would be tricky to handle this situation.  There is also the even more unlikely possibility that while the setting is set to `memsync` or `metasync` that a new inconsistencies comes into existence that needs to opposite of what was set to fix an existing analyzed inconsistency.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698075184/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698133502","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1698133502","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1698133502,"node_id":"IC_kwDOACaFSM5lN3X-","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T20:58:05Z","updated_at":"2023-08-29T20:58:05Z","author_association":"CONTRIBUTOR","body":"> It seems like the only way to know if this is safe is to understand the underlying bug well enough to just fix the bug (which we currently think is https://github.com/apache/accumulo/issues/3721).\r\n\r\nEventually the bug may be found and fixed, but in the meantime tooling is needed to deal with issues that arise.  If this PR were scoped down to only logging helpful info, then there may still be a gap in tooling. We can already edit the metadata table, there is not a quick way to deal with problems in with tablets in memory data at the moment though.  Not sure of the best way to address this, the following are some possible solutions.\r\n\r\n * Add a per tablet RPC to reload a tablets files from the metadata table.\r\n * Add an operation to Accumulo reload a tablet on a tserver.  The tserver closes and immediately opens the tablet, creating a new Tablet object.  This could be a generally useful primitive to quickly resets all the tablets in memory state without balancing.\r\n * Create a balancer implementation that allows reloading individual tablets based on dynamic configuration. Similar to the above in functionality, maybe not as fast.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698133502/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698206554","html_url":"https://github.com/apache/accumulo/pull/3733#issuecomment-1698206554","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3733","id":1698206554,"node_id":"IC_kwDOACaFSM5lOJNa","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-29T22:03:45Z","updated_at":"2023-08-29T22:03:45Z","author_association":"MEMBER","body":"> > I think removing the use of Writer, and cleanup of closing the batch writer are distinct things. Removing the use of the single-mutation Writer can be done as a separate, first step. It would make it much easier to evaluate the changes that are specifically related to the Batch Writer cleanup.\r\n> \r\n> I fixed that because I realized it had the same underlying problem and could cause metadata writes to happen after one would expect. I can the change commit messages to be more generic in that it fixes all write issues of the same kind.\r\n\r\nNo argument from me for fixing it... it definitely needed to be fixed. I was just thinking it would be nice to clearly see the swapping out of Writer for BatchWriter in one commit, and a separate commit that actually fixes the bug in the BatchWriter, so it's clear which part of this changeset addresses the bug. In case we need to revisit the bugfix later (because it's complicated and I don't fully understand it... I'm just kind of taking your word for it after not seeing anything obviously wrong with it), I thought it would be useful to not have to tease them apart later if there was a problem that required a follow-up bugfix. And also the first commit that would remove the use of Writer would enable the follow on work for #3734 and #3735 to proceed right away, fully decoupled from the bugfix here, since they only depend on the discontinuation of the Writer class, and not on the bugfix.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698206554/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698390286","html_url":"https://github.com/apache/accumulo/pull/3733#issuecomment-1698390286","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3733","id":1698390286,"node_id":"IC_kwDOACaFSM5lO2EO","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T02:17:38Z","updated_at":"2023-08-30T02:17:38Z","author_association":"CONTRIBUTOR","body":"> I thought it would be useful to not have to tease them apart later if there was a problem that required a follow-up bugfix. \r\n\r\nI am not going to break this into multiple commits in order to optimize possible eventualities that may or may not happen.  If I wanted to spend time on it, I could probably come up with a scenario for breaking this in 3 commits and another for breaking it into 4 commits.  I would rather spend my time ensuring the changes to fix the observed bug are correct.  If anyone needs assistance reviewing because its a big change, I will be glad to chat and discuss the changes.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698390286/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698979347","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1698979347","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1698979347,"node_id":"IC_kwDOACaFSM5lRF4T","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T11:26:26Z","updated_at":"2023-08-30T11:26:26Z","author_association":"CONTRIBUTOR","body":"Full IT build passed.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1698979347/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699235263","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1699235263","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1699235263,"node_id":"IC_kwDOACaFSM5lSEW_","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T13:53:31Z","updated_at":"2023-08-30T13:53:31Z","author_association":"CONTRIBUTOR","body":"This is a great find.  Thank you @dlmarion.  I would like to point out that this only resolves half of the issue.  The other side of this issue is that the when this exception is thrown on the client side of the scan, the underlying logic will retry indefinitely leaving the process hung.  Granted that this PR will fix avoid the problem for the most part, but I worry that some other situation will cause the scan (or batch writer) to hang indefinitly.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699235263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699239844","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1699239844","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1699239844,"node_id":"IC_kwDOACaFSM5lSFek","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T13:56:16Z","updated_at":"2023-08-30T13:56:16Z","author_association":"CONTRIBUTOR","body":"@ivakegg - I overlooked that part of the issue in #3731, I'll look at that also.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699239844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699279031","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1699279031","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1699279031,"node_id":"IC_kwDOACaFSM5lSPC3","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T14:19:15Z","updated_at":"2023-08-30T14:19:15Z","author_association":"CONTRIBUTOR","body":"> I'm really not sure about this. I'm uncomfortable with automatic surgery on the metadata table as an option that's even on the table, because I think it has a high chance of making things worse. It seems like the only way to know if this is safe is to understand the underlying bug well enough to just fix the bug (which we currently think is #3721). Even as something that only logs activity, isn't this redundant with the existing tablet activity logging?\r\n> \r\n> I also can't help but wonder that if a replay log could fix this so easily, then wouldn't we be able to rely on the WAL? Why would we need something else that's more narrowly scoped and niche than the WAL? How can we be confident this would address the issue if we know the WAL, which has the benefits of being polished and tested over many years, has already failed to do so?\r\n> \r\n> Like I said, I'm just not so sure about this direction.\r\n\r\nThe problem is that one of the WAL's that we care about is on a separate tablet most likely on a separate tserver.  So essentially this log is tracking what the tablet thinks the remote tablet should be doing.  I can only hope that #3721 is the only issue.  Hence why I am creating this mechanism.\r\nI agree the automatic update  seems scary but it would only be done if the log agrees with one side or the other.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699279031/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699299696","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1699299696","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1699299696,"node_id":"IC_kwDOACaFSM5lSUFw","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T14:31:15Z","updated_at":"2023-08-30T14:31:15Z","author_association":"CONTRIBUTOR","body":"> @ivakegg - I overlooked that part of the issue in #3731, I'll look at that also.\r\n\r\nLooks like when it's thrown from [here](https://github.com/apache/thrift/blob/v0.17.0/lib/java/src/main/java/org/apache/thrift/transport/TEndpointTransport.java) the type is set to END_OF_FILE. aed8516 throws a subclass of IOException in this case, which is handled differently in the calling code so that it does not retry.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699299696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699333641","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1699333641","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1699333641,"node_id":"IC_kwDOACaFSM5lScYJ","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T14:51:05Z","updated_at":"2023-08-30T14:51:05Z","author_association":"CONTRIBUTOR","body":"OK, it appears to be a concensus that nobody is comfortable with any kind of automated repair.  I will create a subset of this PR that provides only the logging portion to coincide with the metadata/memory consistency checking.  Having the information on what transactions occured makes it a lot easier to determine what happened.  Thank you for your reviews thus far everybody.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699333641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699387044","html_url":"https://github.com/apache/accumulo/issues/3693#issuecomment-1699387044","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3693","id":1699387044,"node_id":"IC_kwDOACaFSM5lSpak","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T15:22:34Z","updated_at":"2023-08-30T15:22:34Z","author_association":"CONTRIBUTOR","body":"The data object that's stored in zookeeper had to change. \r\nhttps://github.com/apache/accumulo/blob/f02d2ac5000d7d3ed664ba51e7e9d586fbba4a65/server/base/src/main/java/org/apache/accumulo/server/metadata/RootGcCandidates.java#L43-L59 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699387044/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699764785","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1699764785","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1699764785,"node_id":"IC_kwDOACaFSM5lUFox","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T20:05:18Z","updated_at":"2023-08-30T21:45:09Z","author_association":"MEMBER","body":"> it would only be done if the log agrees with one side or the other.\r\n\r\nI think I missed that fundamental description of your intent. It seemed to me that by making it configurable, the user would just choose which one was they wanted to use, which didn't seem safe at all. Based on this description, it seems like the intent was to make a 3rd source of truth, and have all 3 sources vote on what the right answer was. In that mechanism, I'd be worried about the situation being worsened when the \"minority report\" was actually the correct answer.\r\n\r\nWithout looking at the updated changes in depth yet, I'm thinking of an implementation that would look something like:\r\n\r\n* An insertion-ordered list of transactions and consistency checks\r\n* When a consistency check succeeds, everything prior can be removed from the log\r\n* When the consistency check fails, all the entries since the last successful consistency check are logged with a warning or error in a specially named logger\r\n\r\nThis requires no configuration (other than any custom log4j configuration that the user desires).\r\n\r\nWe would probably also need to add an administrative utility to do the actual repair upon recognition. We could use the existing RPC mechanism to unload a tablet and then load it, but there are other options we can consider as well. I think whatever is done for that, it can be done as a separate, discrete task.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699764785/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699933017","html_url":"https://github.com/apache/accumulo/issues/3732#issuecomment-1699933017","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3732","id":1699933017,"node_id":"IC_kwDOACaFSM5lUutZ","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T22:24:00Z","updated_at":"2023-08-30T22:24:00Z","author_association":"MEMBER","body":"I could probably start helping by providing some examples of alternatives, if you could highlight some specific pain points with the alternatives you've tried so far.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699933017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699935398","html_url":"https://github.com/apache/accumulo/pull/3733#issuecomment-1699935398","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3733","id":1699935398,"node_id":"IC_kwDOACaFSM5lUvSm","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-30T22:27:00Z","updated_at":"2023-08-30T22:27:00Z","author_association":"MEMBER","body":"> I am not going to break this into multiple commits\r\n\r\nThat's fine. But, do you mind if I do it, instead of merging this as-is?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1699935398/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700021859","html_url":"https://github.com/apache/accumulo/pull/3733#issuecomment-1700021859","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3733","id":1700021859,"node_id":"IC_kwDOACaFSM5lVEZj","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-31T00:00:57Z","updated_at":"2023-08-31T00:00:57Z","author_association":"CONTRIBUTOR","body":"> That's fine. But, do you mind if I do it, instead of merging this as-is?\r\n\r\nNo I don't mind at all.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700021859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700291253","html_url":"https://github.com/apache/accumulo/pull/3717#issuecomment-1700291253","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3717","id":1700291253,"node_id":"IC_kwDOACaFSM5lWGK1","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-31T02:44:46Z","updated_at":"2023-08-31T02:44:46Z","author_association":"CONTRIBUTOR","body":"> @keith-turner I think this is ready to merge, but was wondering if you had thoughts on the race condition that might get overlooked if the fate object is created while it is still upgrading, but the upgrade finishes before we check it.\r\n\r\nThe check may not catch that, but I don't think the code currently does that.  It we wanted to get more defensive about that could add an explicit check in the fate startup code that ensures upgrade is not running.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700291253/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700834742","html_url":"https://github.com/apache/accumulo/pull/3733#issuecomment-1700834742","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3733","id":1700834742,"node_id":"IC_kwDOACaFSM5lYK22","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-31T11:06:55Z","updated_at":"2023-08-31T11:06:55Z","author_association":"MEMBER","body":"I applied the Writer removal changes (those more closely related to #3735) in commit f76f12baa6e6e5499fe94cc833f02f9e2865f159, and merged that into 2.1 and forward into main first. The only difference to what was originally in this PR was that I also removed an unused private Logger in Writer in that commit.\r\n\r\nI've resolved merge conflicts by merging 2.1 into this PR.\r\n\r\nNow, this PR just represents the fixes for #3721, and I will squash and merge that separately.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700834742/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700862203","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1700862203","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1700862203,"node_id":"IC_kwDOACaFSM5lYRj7","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-31T11:28:05Z","updated_at":"2023-08-31T11:28:05Z","author_association":"MEMBER","body":"Still looking at this this morning. Will be done by noon (EDT), and we can merge after if there's no other issues.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700862203/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700897658","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1700897658","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1700897658,"node_id":"IC_kwDOACaFSM5lYaN6","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-31T11:54:50Z","updated_at":"2023-08-31T11:54:50Z","author_association":"CONTRIBUTOR","body":"> \r\n\r\n@ctubbsii I have already reduced this to simply logging.  Please re-review it when you get a chance.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1700897658/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1701067159","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1701067159","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1701067159,"node_id":"IC_kwDOACaFSM5lZDmX","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-31T13:44:05Z","updated_at":"2023-08-31T13:44:05Z","author_association":"MEMBER","body":"I merged 2.1 into this PR's branch, just to get it up-to-date before I finish reviewing.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1701067159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1701284906","html_url":"https://github.com/apache/accumulo/pull/3717#issuecomment-1701284906","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3717","id":1701284906,"node_id":"IC_kwDOACaFSM5lZ4wq","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-31T15:41:46Z","updated_at":"2023-08-31T15:41:46Z","author_association":"MEMBER","body":"I had a few ideas for what to do next with this, but they aren't ready. I can update this PR later this evening.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1701284906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1701870738","html_url":"https://github.com/apache/accumulo/pull/3728#issuecomment-1701870738","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3728","id":1701870738,"node_id":"IC_kwDOACaFSM5lcHyS","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-08-31T22:36:21Z","updated_at":"2023-08-31T22:36:21Z","author_association":"CONTRIBUTOR","body":"While looking at this locally I noticed that `TabletGroupWatcher.sendSplitRequest()` is no longer used.  Could that be removed?  Also could `MergeState.SPLITTING` be removed?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1701870738/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702121351","html_url":"https://github.com/apache/accumulo/issues/3731#issuecomment-1702121351","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3731","id":1702121351,"node_id":"IC_kwDOACaFSM5ldE-H","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-01T03:57:50Z","updated_at":"2023-09-01T03:57:50Z","author_association":"MEMBER","body":"I created https://issues.apache.org/jira/browse/THRIFT-5732 upstream.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702121351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702258482","html_url":"https://github.com/apache/accumulo/issues/3739#issuecomment-1702258482","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3739","id":1702258482,"node_id":"IC_kwDOACaFSM5ldmcy","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-01T06:52:16Z","updated_at":"2023-09-01T06:52:16Z","author_association":"MEMBER","body":"There might be downsides, but I'm leaning towards just making them accept up to `Integer.MAX_VALUE` and get rid of all of the config for this. I think the constraint might be hurting more than helping in any way.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702258482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702644095","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1702644095","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1702644095,"node_id":"IC_kwDOACaFSM5lfEl_","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-01T12:07:11Z","updated_at":"2023-09-01T12:07:11Z","author_association":"MEMBER","body":"Okay, I updated the IT to test for messages that are smaller than the configured amount (which should work), but also included the checks that @dlmarion had to verify it failed if the message was larger than the configured amount. So, we have both now. But, there are a few remaining issues:\r\n\r\n* The ssl case does not seem to have the same failure characteristics as the other server types. In some cases, when a message is sent that is larger than what is configured, it still works. I'm not sure why. In other cases, it seemed to not work, like we'd expect, but it would fail with a different message. I had to refactor the test to ensure MiniAccumuloCluster gave it separate directories so this can be debugged further. I don't think it's critical, though. For now, I've ignored the ssl case in the IT.\r\n* The more interesting thing is that if I reduce the configured max size to a lower amount (say, 20MB), the tests that send a smaller message (even if it is substantially smaller than 20MB) seem to fail with messages in the tserver logs saying that it received a message that was larger. I'm not sure how, since I never sent one that big, and I don't expect Accumulo to natively be sending itself large messages from another server. This one doesn't make sense. I got the IT to pass with 80MB... I haven't found the precise threshold where it stops working, though. Hopefully, having separate directories for the tests now will make it easier to troubleshoot each one separately.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702644095/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702731996","html_url":"https://github.com/apache/accumulo/issues/3709#issuecomment-1702731996","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3709","id":1702731996,"node_id":"IC_kwDOACaFSM5lfaDc","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-01T13:14:40Z","updated_at":"2023-09-01T13:14:40Z","author_association":"CONTRIBUTOR","body":"In general, I was thinking as we go to Elasticity it might be nice to see if we can get more things out of Zookeeper and store in Accumulo itself. Zookeeper can be a bottleneck and other projects are dropping it for performance reasons as clusters are getting larger (such as Kafka). In theory the changes in Elasticity will allow us to scale up with many more tablets since they are offline/ondemand which would require a lot more metadata tracking in ZK and I can see that could cause issues, like in this case.\r\n\r\nFor example, for the split points here, I'm wondering if in the future it would be make sense to store the split points in Accumulo in another table. Anyways, just a thought, in this case the tmp file probably makes sense since it's already doing that elsewhere and code could be shared. There also might be reasons that isn't possible but again this is just more of a general comment that could be applied to other situations too.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702731996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702828867","html_url":"https://github.com/apache/accumulo/pull/3728#issuecomment-1702828867","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3728","id":1702828867,"node_id":"IC_kwDOACaFSM5lfxtD","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-01T14:22:30Z","updated_at":"2023-09-01T14:22:30Z","author_association":"CONTRIBUTOR","body":"> While looking at this locally I noticed that `TabletGroupWatcher.sendSplitRequest()` is no longer used. Could that be removed? Also could `MergeState.SPLITTING` be removed?\r\n\r\nWe can definitely remove sendSplitRequest() as it's private and I just missed that as an oversight. For the Enum change, based on your other comment that outstanding FATE operations should prevent upgrade, it sounds like we can remove that as well as it should not be a problem.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1702828867/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1703277775","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1703277775","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1703277775,"node_id":"IC_kwDOACaFSM5lhfTP","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-01T20:19:00Z","updated_at":"2023-09-01T20:19:00Z","author_association":"CONTRIBUTOR","body":"I wrote a test using what I think is the correct stack on the client side to see the number of bytes that it ends up writing for a Mutation. It's not exhibiting the symptoms described above. Test:\r\n\r\n```\r\n  @Test\r\n  public void testThriftMessageSize() throws Exception {\r\n    ByteBuffer buf = ByteBuffer.allocate(MB10);\r\n    \r\n    ByteBufferOutputStream bbos = new ByteBufferOutputStream(buf);\r\n    \r\n    TIOStreamTransport stream = new TIOStreamTransport(bbos);\r\n    \r\n    AccumuloTFramedTransportFactory factory = new AccumuloTFramedTransportFactory(Integer.MAX_VALUE);\r\n    TTransport framedTransport = factory.getTransport(stream);\r\n    assertEquals(framedTransport.getConfiguration().getMaxFrameSize(), Integer.MAX_VALUE);\r\n    assertEquals(framedTransport.getConfiguration().getMaxMessageSize(), Integer.MAX_VALUE);\r\n    \r\n    TCompactProtocol protocol = new TCompactProtocol(framedTransport);\r\n    \r\n    Mutation m = new Mutation(new Text(FastFormat.toZeroPaddedString(0 + 0, 10, 10, \"row_\".getBytes(UTF_8))));\r\n    byte[] value = new byte[MB1];\r\n    Arrays.fill(value, (byte) 1);\r\n    m.put(new Text(\"colf_colf\"), new Text(FastFormat.toZeroPaddedString(0, 7, 10, \"colf_\".getBytes(UTF_8))),\r\n        new ColumnVisibility(), System.currentTimeMillis(), new Value(value, true));\r\n\r\n    TMutation tmut = m.toThrift();\r\n    tmut.write(protocol);\r\n    \r\n    framedTransport.flush();\r\n    assertEquals(MB1, buf.position());\r\n    buf.flip();\r\n    assertEquals(0, buf.position());\r\n    assertEquals(MB1, buf.limit());\r\n\r\n  }\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1703277775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1703352715","html_url":"https://github.com/apache/accumulo/pull/3728#issuecomment-1703352715","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3728","id":1703352715,"node_id":"IC_kwDOACaFSM5lhxmL","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-01T21:49:51Z","updated_at":"2023-09-01T21:49:51Z","author_association":"CONTRIBUTOR","body":"@keith-turner - Ok I think you can take a look at this again, I pushed a bunch of updates today and tried to address most of the comments so far.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1703352715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1706842810","html_url":"https://github.com/apache/accumulo/pull/3719#issuecomment-1706842810","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3719","id":1706842810,"node_id":"IC_kwDOACaFSM5lvFq6","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-05T15:30:06Z","updated_at":"2023-09-05T15:30:06Z","author_association":"MEMBER","body":"If nobody opposes, I think this PR is ready to merge. I think we could create a new ticket to track the addition of text indicating various system states but that might be outside the scope of this PR.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1706842810/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1707348122","html_url":"https://github.com/apache/accumulo/pull/3676#issuecomment-1707348122","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3676","id":1707348122,"node_id":"IC_kwDOACaFSM5lxBCa","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-05T21:43:24Z","updated_at":"2023-09-05T21:43:24Z","author_association":"MEMBER","body":"Some of the tests are failing when i correct the Sets.difference() issue\r\nmentioned in a previous comment. Will work to fix that tomorrow.\r\n\r\nOn Tue, Sep 5, 2023 at 4:56 PM EdColeman ***@***.***> wrote:\r\n\r\n> ***@***.**** approved this pull request.\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/apache/accumulo/pull/3676#pullrequestreview-1611918044>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/ALMD2ILJXIOXWLLDGPIV4R3XY6GTHANCNFSM6AAAAAA3BVGDWY>\r\n> .\r\n> You are receiving this because you were assigned.Message ID:\r\n> ***@***.***>\r\n>\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1707348122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1708524978","html_url":"https://github.com/apache/accumulo/pull/3676#issuecomment-1708524978","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3676","id":1708524978,"node_id":"IC_kwDOACaFSM5l1gWy","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-06T14:51:24Z","updated_at":"2023-09-06T14:51:24Z","author_association":"MEMBER","body":"Correcting the usage of Sets.difference() in the remaining two test cases (in commit eceaedf) has caused `systemConfiguration()` and `siteConfuguration()` to fail.\r\n\r\nThe `siteConfuguration()` test fails the check where `getProperties()` is called on the object and many properties are set that are not expected to be. \r\n\r\nThe `systemConfiguration` test is failing in a similar way except the `getProperties()` returns the expected properties but the `isPropertySet()` impl is indicating there are properties that are set that are not expected to be.\r\n\r\nI am not super familiar with these two and I'm assuming there are some default properties that are included with the set of properties that are manually set upon initializing the object however I don't know where those are coming from or which props are expected to be there.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1708524978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1708562165","html_url":"https://github.com/apache/accumulo/pull/3719#issuecomment-1708562165","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3719","id":1708562165,"node_id":"IC_kwDOACaFSM5l1pb1","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-06T15:06:44Z","updated_at":"2023-09-06T15:06:44Z","author_association":"CONTRIBUTOR","body":"LGTM.  I can write up a separate ticket for the text in the navbar","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1708562165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1708576907","html_url":"https://github.com/apache/accumulo/issues/3732#issuecomment-1708576907","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3732","id":1708576907,"node_id":"IC_kwDOACaFSM5l1tCL","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-06T15:14:32Z","updated_at":"2023-09-06T15:15:39Z","author_association":"CONTRIBUTOR","body":"1) \"The feature adds a lot of complexity, for a small convenience.\"  I strongly disagree with this.  For all of those that have to maintain our systems, it becomes crutial to be able to read the key-value pairs in a human readable form.  A typical example is where the value is encoded as a protobuf which is complete unreadable without a formatter.\r\n2) \"Limited maintenance functionality.\"  I strongly disagree with this.  The shell is the main utility used by all kinds of scripts throughout our systems including monitoring to be able to scan various tables and verify certain activities are being performed properly.  For example listing the ongoing scans, verifying splits are being created on our sharded tables, generating alerts when too many files are backed up on a tablet, not to mention the ability to track down various problems in our system related to queries or bad data.\r\n3) The shell is a general purpose tool used for maintenance.  I not sure why you don't think this is the case.\r\n\r\nI am ok if we split out the shell into a separate project, but we require this capability (including formatters) and will not be able to migrate to 3.x unless this functionality still exists.  Note that we do not need formatters configured on the tables, but we do need to be able to specify them when executing a scan in the shell.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1708576907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1708768308","html_url":"https://github.com/apache/accumulo/issues/3740#issuecomment-1708768308","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3740","id":1708768308,"node_id":"IC_kwDOACaFSM5l2bw0","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-06T16:57:43Z","updated_at":"2023-09-06T16:57:43Z","author_association":"CONTRIBUTOR","body":"Tried to produce this problem in a test that should have caused it and was unable to reproduce it.   Did a lot of digging and found [this code](https://github.com/apache/accumulo/blob/b1b2557f949e9212a1b1ca9b65f2d66c01a69edb/server/tserver/src/main/java/org/apache/accumulo/tserver/tablet/CompactableImpl.java#L386-L392) was preventing the race condition from occurring.  That code is called when planning a compaction to get the files that are candidates for compaction. When the set of files currently compacting is not a subset of the tablets current files, then an empty set of candidates is returned.  So a new compaction will never start running between the in memory update and metadata update because of this check.  The set of all files compacting is not updated until after the metadata update, so it just happens to cover what is needed to prevent the race condition.\r\n\r\nThe code should still be fixed because the code that prevents the problem is so far from the code where the problem is.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1708768308/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1709579266","html_url":"https://github.com/apache/accumulo/pull/3743#issuecomment-1709579266","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3743","id":1709579266,"node_id":"IC_kwDOACaFSM5l5hwC","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-07T06:55:44Z","updated_at":"2023-09-07T06:55:44Z","author_association":"CONTRIBUTOR","body":"Closing this in favor of #3745 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1709579266/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710427111","html_url":"https://github.com/apache/accumulo/pull/3715#issuecomment-1710427111","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3715","id":1710427111,"node_id":"IC_kwDOACaFSM5l8wvn","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-07T16:10:37Z","updated_at":"2023-09-07T16:10:37Z","author_association":"CONTRIBUTOR","body":"Another thought regarding the ABNF grammar, is that we can test the grammar to ensure that it's accurate. Using an ABNF parser generator (for example, https://www.parse2.com/manual-java.shtml), we can create a parser based on the ABNF, then validate a known set of examples against the parser.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710427111/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710435553","html_url":"https://github.com/apache/accumulo/pull/3715#issuecomment-1710435553","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3715","id":1710435553,"node_id":"IC_kwDOACaFSM5l8yzh","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-07T16:15:37Z","updated_at":"2023-09-07T16:15:37Z","author_association":"CONTRIBUTOR","body":"> Another thought regarding the ABNF grammar, is that we can test the grammar to ensure that it's accurate. Using an ABNF parser generator (for example, https://www.parse2.com/manual-java.shtml), we can create a parser based on the ABNF, then validate a known set of examples against the parser.\r\n\r\nThat sounds like a good idea. I created the new repo, I am going to work on getting an initial commit pushed to it with this as a starting point and then we can iterate from there.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710435553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710438844","html_url":"https://github.com/apache/accumulo/pull/3715#issuecomment-1710438844","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3715","id":1710438844,"node_id":"IC_kwDOACaFSM5l8zm8","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-07T16:17:00Z","updated_at":"2023-09-07T16:17:00Z","author_association":"CONTRIBUTOR","body":"Regarding the link I sent, I found that is has a Maven plugin. Example: https://www.parse2.com/source.php?source=maven/plugin.xml","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710438844/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710535099","html_url":"https://github.com/apache/accumulo/pull/3715#issuecomment-1710535099","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3715","id":1710535099,"node_id":"IC_kwDOACaFSM5l9LG7","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-07T17:31:25Z","updated_at":"2023-09-07T17:31:25Z","author_association":"CONTRIBUTOR","body":"Moved a subset of the changes in this PR to https://github.com/apache/accumulo-access","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710535099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710604416","html_url":"https://github.com/apache/accumulo/pull/3676#issuecomment-1710604416","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3676","id":1710604416,"node_id":"IC_kwDOACaFSM5l9cCA","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-07T18:32:33Z","updated_at":"2023-09-07T18:32:33Z","author_association":"MEMBER","body":"Fixed the two test cases that were failing in bd3ef97 and bd3ef97. Should be ready for review now.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710604416/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710764273","html_url":"https://github.com/apache/accumulo/pull/3745#issuecomment-1710764273","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3745","id":1710764273,"node_id":"IC_kwDOACaFSM5l-DDx","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-07T20:59:51Z","updated_at":"2023-09-07T20:59:51Z","author_association":"CONTRIBUTOR","body":"I did some more work and decided to change my direction and switch to adding the prefix in the message body. \r\n\r\nThe additional logger work is still under commit d083506d061ea67cd747407a2cf162f64740334c ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710764273/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710787866","html_url":"https://github.com/apache/accumulo/pull/3715#issuecomment-1710787866","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3715","id":1710787866,"node_id":"IC_kwDOACaFSM5l-I0a","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-07T21:23:57Z","updated_at":"2023-09-07T21:23:57Z","author_association":"CONTRIBUTOR","body":"Created #3746 with the accumulo changes from this PR.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1710787866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711555159","html_url":"https://github.com/apache/accumulo/issues/3732#issuecomment-1711555159","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3732","id":1711555159,"node_id":"IC_kwDOACaFSM5mBEJX","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-08T11:57:06Z","updated_at":"2023-09-08T11:58:30Z","author_association":"MEMBER","body":"(this response was originally discussed with @ivakegg outside of this ticket; I'm sharing here, to summarize that conversation and to share my views with the wider community)\r\n\r\n> to be able to read the key-value pairs in a human readable form.\r\n\r\nDefinitely agree that we want to preserve that convenience. The \"small\" convenience I was referring to was the ability to do it inside the Accumulo shell, specifically, vs. being able to do it at all. Being able to do it is essential, but being able to do it inside the Accumulo shell is not, if other ways are provided. I think we can provide those other ways, which can satisfy this use case, but also empower many others.\r\n\r\nIn the meantime, I think we can restore the formatter flag specifically in the shell, since the alternate ways are not yet ubiquitous. But, I think we should keep the interpreters out, as well as the table configuration that applies a formatter to every scan automatically, because those are where a lot of user confusion and complexity comes in.\r\n\r\n> 2. \"Limited maintenance functionality.\"  I strongly disagree with this. [snip]\r\n> 3. The shell is a general purpose tool used for maintenance.  I not sure why you don't think this is the case.\r\n\r\nI agree it's a general purpose tool. By \"limited\", all I mean is that it's not as powerful or efficient, or intended to be, as using the full Java API, which I don't think is in dispute. I think the examples you gave are great examples of the kinds of \"limited maintenance functions\" it can support that I was referring to. I am not suggesting removing support for any of these uses. But I do think there is room to improve *how* we support these uses, and I think that's where we were going with the previous changes.\r\n\r\n> I am ok if we split out the shell into a separate project, but we require this capability (including formatters) and will not be able to migrate to 3.x unless this functionality still exists. Note that we do not need formatters configured on the tables, but we do need to be able to specify them when executing a scan in the shell.\r\n\r\nThe shell is already kind of a separate project (it's a separate module right now). Some of its functions that require access to server-side config files (like the fate admin tools) have already been moved to a separate distinct utility. Some ZK maintenance tasks also now exist as separate tools, but are a bit more low-level than what the current shell supports, which may be a little redundant, but I think it's fine for now. I think what is really missing here, that would go a long ways to support your use case, is to have a separate \"scan\" utility, specifically for scanning with similar command line options as in the current shell, but which you can pipe the output in your OS shell environment to tools like grep, awk, sed, cut, paste, etc. That would make it easy for users to write their own data views, not limited to the Formatter interface we previously supported. We could also provide support for Formatters, or a more limited `BiFunction<Key,Value,String>` version of it, in that tool, but could de-emphasize it to encourage users to maintain their application-specific views/transformations outside of Java, and in their OS shell environment. I'm not actually sure whether it would be more useful for users to maintain a set of Formatters or a set of pipe-able `scan ... | myFormatter.sh` capabilities. But, having a scan tool outside of the current shell would empower users to do the latter quite easily, with no code complexity in Accumulo at all... and that would be far more powerful than what you currently get with the accumulo-shell.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711555159/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711633482","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1711633482","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1711633482,"node_id":"IC_kwDOACaFSM5mBXRK","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-08T12:59:10Z","updated_at":"2023-09-08T12:59:10Z","author_association":"CONTRIBUTOR","body":"@dlmarion @ctubbsii @keith-turner Are we good to merge this in?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711633482/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711709684","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1711709684","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1711709684,"node_id":"IC_kwDOACaFSM5mBp30","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-08T13:51:59Z","updated_at":"2023-09-08T13:51:59Z","author_association":"CONTRIBUTOR","body":"@ivakegg  I was planning on looking at this a bit later today.  If you want to merge that seems fine with me,  I will still look at the change this afternoon.  If you do merge and I see anything then I will create a new PR and tag you for reviewing it.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711709684/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711834736","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1711834736","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1711834736,"node_id":"IC_kwDOACaFSM5mCIZw","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-08T15:17:37Z","updated_at":"2023-09-08T15:17:37Z","author_association":"MEMBER","body":"I was also planning on taking another look later today. I would prefer we hold off until next week at least to give more time to review and polish. I'm particularly interested in how close the current implementation is to the outline I made in my previous comment, and where it diverges, what are the substantive differences between the rough ideas I had in my head, and how it actually is implemented. Given that #3733 has been addressed, I don't think this is particularly urgent, but I think 2.1.3 is a reasonable target, once everybody is happy with it. So, while I think we should hold off on merging it for now, I will mark it as a blocker for 2.1.3 so it doesn't get punted past the next patch release.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711834736/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711913067","html_url":"https://github.com/apache/accumulo/pull/3614#issuecomment-1711913067","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3614","id":1711913067,"node_id":"IC_kwDOACaFSM5mCbhr","user":{"login":"cshannon","id":123009,"node_id":"MDQ6VXNlcjEyMzAwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/123009?v=4","gravatar_id":"","url":"https://api.github.com/users/cshannon","html_url":"https://github.com/cshannon","followers_url":"https://api.github.com/users/cshannon/followers","following_url":"https://api.github.com/users/cshannon/following{/other_user}","gists_url":"https://api.github.com/users/cshannon/gists{/gist_id}","starred_url":"https://api.github.com/users/cshannon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cshannon/subscriptions","organizations_url":"https://api.github.com/users/cshannon/orgs","repos_url":"https://api.github.com/users/cshannon/repos","events_url":"https://api.github.com/users/cshannon/events{/privacy}","received_events_url":"https://api.github.com/users/cshannon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-08T16:10:14Z","updated_at":"2023-09-08T16:10:14Z","author_association":"CONTRIBUTOR","body":"This is just a new IT for checking if ranges are read correctly by scanners after ingesting and changing the files to fence so I'm going to ahead and merge it into the no-chop-merge branch now that I bought it up to date.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1711913067/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1712192799","html_url":"https://github.com/apache/accumulo/pull/3727#issuecomment-1712192799","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3727","id":1712192799,"node_id":"IC_kwDOACaFSM5mDf0f","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-08T20:34:49Z","updated_at":"2023-09-08T20:34:49Z","author_association":"CONTRIBUTOR","body":"I was curious what this output for this would look like in the logs and wrote [this IT](https://github.com/keith-turner/accumulo/blob/feature/logMetadataChanges-3724/test/src/main/java/org/apache/accumulo/ConsistencyCheckIT.java) to force a consistency check problem.  Below is what the output in the tserver log looked like.  I replaced URI prefix with VOLUME to shorten the data.\r\n\r\n```\r\n2023-09-08T16:27:40,956 [tablet.Tablet] ERROR: Data files in 1<< differ from in-memory data {VOLUME/accumulo/tables/1/default_tablet/F000003k.rf=237 1} {VOLUME/accumulo/tables/1/default_tablet/A000003j.rf=319 10, VOLUME/accumulo/tables/1/default_tablet/F000003k.rf=237 1} [startedCount:14,finishedCount:14] [startedCount:14,finishedCount:14]\r\n2023-09-08T16:27:40,960 [tablet.DatafileManager] ERROR: Operation log: 20230908T16:27:35.940: Initial files for 1<< : []\r\n20230908T16:27:36.054: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F0000037.rf]\r\n20230908T16:27:36.084: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F0000038.rf]\r\n20230908T16:27:36.151: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F0000039.rf]\r\n20230908T16:27:36.209: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F000003a.rf]\r\n20230908T16:27:36.238: Compacted [VOLUME/accumulo/tables/1/default_tablet/F0000039.rf, VOLUME/accumulo/tables/1/default_tablet/F0000038.rf, VOLUME/accumulo/tables/1/default_tablet/F0000037.rf, VOLUME/accumulo/tables/1/default_tablet/F000003a.rf] into Optional[VOLUME/accumulo/tables/1/default_tablet/A000003b.rf]\r\n20230908T16:27:36.273: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F000003c.rf]\r\n20230908T16:27:36.335: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F000003d.rf]\r\n20230908T16:27:36.399: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F000003e.rf]\r\n20230908T16:27:36.418: Compacted [VOLUME/accumulo/tables/1/default_tablet/F000003e.rf, VOLUME/accumulo/tables/1/default_tablet/F000003d.rf, VOLUME/accumulo/tables/1/default_tablet/F000003c.rf, VOLUME/accumulo/tables/1/default_tablet/A000003b.rf] into Optional[VOLUME/accumulo/tables/1/default_tablet/A000003f.rf]\r\n20230908T16:27:36.459: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F000003g.rf]\r\n20230908T16:27:36.521: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F000003h.rf]\r\n20230908T16:27:36.586: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F000003i.rf]\r\n20230908T16:27:36.604: Compacted [VOLUME/accumulo/tables/1/default_tablet/A000003f.rf, VOLUME/accumulo/tables/1/default_tablet/F000003g.rf, VOLUME/accumulo/tables/1/default_tablet/F000003i.rf, VOLUME/accumulo/tables/1/default_tablet/F000003h.rf] into Optional[VOLUME/accumulo/tables/1/default_tablet/A000003j.rf]\r\n20230908T16:27:36.646: Flushed into Optional[VOLUME/accumulo/tables/1/default_tablet/F000003k.rf]\r\nFinal files: [VOLUME/accumulo/tables/1/default_tablet/A000003j.rf, VOLUME/accumulo/tables/1/default_tablet/F000003k.rf]\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1712192799/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1712679210","html_url":"https://github.com/apache/accumulo/pull/3719#issuecomment-1712679210","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3719","id":1712679210,"node_id":"IC_kwDOACaFSM5mFWkq","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-10T01:27:37Z","updated_at":"2023-09-10T01:45:06Z","author_association":"MEMBER","body":"@DomGarguilo said:\r\n> If nobody opposes, I think this PR is ready to merge. I think we could create a new ticket to track the addition of text indicating various system states but that might be outside the scope of this PR.\r\n\r\nMy previous comment on the current iteration was \"But, based on the discussion, it might still not be the best solution just yet, but I think it's much closer.\" So, I'm opposed. I don't think this is the right solution if there's not consensus. This was supposed to replace the need for text. The request for text isn't outside the scope of this... it's the whole reason we went down this path as an alternative to adding verbose text to the nav bar.\r\n\r\n@ivakegg's latest comment about opening up another ticket seems to indicate the same, that it's not quite the solution that we can get consensus on. This ticket was supposed to be the one that made text in the nav bar unnecessary (because of limited real estate there) by adding an icon instead. If this ticket isn't quite right, then there's no point in merging it and opening another one... let's just reiterate and consider a different idea.\r\n\r\nHere's the considerations:\r\n\r\n1. Desire to see indication of certain states (safe mode, offline) on every page of monitor\r\n2. Some states are important enough to require immediate disambiguation, without needing to expand a menu (specifically, the manager being in safe mode should be visually distinguishable from the a couple tservers being offline)\r\n3. Limited space in nav bar\r\n\r\nI believe this PR, as is, addresses all three of these. However, @ivakegg seems to indicate that icon-only disambiguation in consideration number 2 is insufficient, and prefers to see text. However, I'm concerned that the nav bar is too space constrained to place additional text.\r\n\r\nHere's some ideas for a subsequent iteration on this, given the lack of consensus:\r\n\r\n1. If @ivakegg is willing to flex on the need for text, perhaps there's a way we can add a secondary icon:\r\n    1. We could add a new icon (like an alert) to indicate the presence of \"system messages\". This icon will not normally be present, and could never be confused for another state, but would take up minimal space. Clicking on it could bring up a modal alert window with a description of the system message.\r\n    2. We could add a new icon that is not mixed in with the server state, but indicates one very specific system message: that manager is in safe mode. If we have additional system conditions we want to alert on, we can add new, distinct icons. This idea is similar to 1.i, but instead of having one global alert icon for the presence of any system message, each system message would get its own unique icon. I'm not a fan of this option as much, because of the need to maintain a legend to track all the different icon meanings.\r\n2. If we must have text, then I think putting it in the body of the main page layout, rather than the nav bar, so it shows up on each page, would be a reasonable idea *only* if it were not presented as \"manager state\", but specifically as a generic \"system message\" alert on the main page. If it were just the manager state, it's very strange to report the manager state on the tserver page, for example. But it would make more sense for the tserver page (and other pages) to show a global system message, that just happened to come from the manager. We could have a few different system messages that could do this. But, we need to take care we don't confuse the user by saying something like \"Accumulo is in safe mode\". Instead, we should say something like \"A manager server has sent a system message that it has entered safe mode\". We don't need to be that verbose, of course, but I do think it's important we're that unambiguous, since safe mode is not a global system state, but a manager-specific one.\r\n\r\nAs for the current state of this PR, I do think it's important that the manager icon and the roll-up change color, based on the state of the manager... for example, if it didn't change yellow when the manager was in safe mode before, it certainly should now. However, I don't think we need a separate icon in this part of the nav bar, if one of these other solutions are implemented.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1712679210/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1713038224","html_url":"https://github.com/apache/accumulo/pull/3737#issuecomment-1713038224","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3737","id":1713038224,"node_id":"IC_kwDOACaFSM5mGuOQ","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-11T01:50:05Z","updated_at":"2023-09-11T01:50:05Z","author_association":"MEMBER","body":"I think it's related to the issue of the max message size counter not being reset when the transport is reused for some new messages. So, you won't see it for only a single message. I'm not sure how to verify this at the moment, though.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1713038224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1714097261","html_url":"https://github.com/apache/accumulo/pull/3719#issuecomment-1714097261","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3719","id":1714097261,"node_id":"IC_kwDOACaFSM5mKwxt","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-11T15:16:27Z","updated_at":"2023-09-11T15:16:27Z","author_association":"MEMBER","body":"@ctubbsii, thanks for the detailed explanation here. I won't merge this in until we find a good solution.\r\n\r\nAfter reading your suggestions/ideas it seems like the idea of adding an alert in the body of the main template page could work. For example, currently there is an alert banner on the manager page that might be something close to what we are looking for where it will appear whenever there is a message that should be displayed on all pages:\r\n\r\n![Manager page showing safe mode banner](https://github.com/apache/accumulo/assets/47725857/ea55b0a5-fafe-4c13-a50f-13db758f8600)\r\n\r\nWe would change the message of the banner to something closer to what is mentioned about signifying a system-wide message.\r\n\r\nIf this sounds like a good idea I am wondering if it would also be a good idea to keep the current changes in this branch where the unique icon gets displayed in addition to adding a new banner with text outlining what the message is. That way if a user is scrolled down slightly or for some reason does not see the banner at the top of a page, there is another indication present in the navbar icons. Just an idea though not sure if we would want both an icon and a banner.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1714097261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1714668403","html_url":"https://github.com/apache/accumulo/pull/3719#issuecomment-1714668403","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3719","id":1714668403,"node_id":"IC_kwDOACaFSM5mM8Nz","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-11T22:27:03Z","updated_at":"2023-09-11T22:27:03Z","author_association":"MEMBER","body":"So, after speaking with @DomGarguilo , I want to break down the next steps we discussed:\r\n\r\n1. Create an icon that is normally not present, but appears as a distinct alert, whenever a system-wide alert is active. This icon would be placed on the top bar, but not part of the server status menu. It'd be it's own icon and would not collapse into the navigation if the display width is small.\r\n    * Unknowns for this are: placement of icon, style of icon, which specific things will result in an alert (aside from a manger being in safe mode)\r\n2. Create one of the following in which to place the details of the system-wide alert:\r\n    1. A [modal window](https://getbootstrap.com/docs/5.3/components/modal/#toggle-between-modals) that pops up when clicking on the icon in step 1, or\r\n    2. An [alert box](https://getbootstrap.com/docs/5.3/components/alerts/#icons) in the page that is always present.\r\n\r\nI'm leaning towards the alert box always present, just because it's the simplest, and allows us to wrap this up quickest.\r\n\r\nA few other considerations:\r\n\r\nI think the icon shown in the alert box should match the icon in the top bar, to visually link them, just like a footnote marker or asterisk would link to a footnote.\r\n\r\nI also think the description needs to indicate where it's coming from. This is different from the \"safe mode\" alert on the manager page, because that is clear it's referring to the manager itself. Since these would be shown on all pages, more details are needed. For example, instead of just saying \"safe mode\", it might say \"Manager at \\<hostname\\> is in safe mode\". (Note: we could probably get rid of the redundant alert on the manager page, if it's going to be shown on all pages anyway).\r\n\r\nI thought we might want to make the alert dismiss-able, but I think that's too complicated. Just leaving it ever-present so long as the situation that caused the alert is still in effect, is fine.\r\n","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1714668403/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1714756924","html_url":"https://github.com/apache/accumulo/pull/3747#issuecomment-1714756924","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3747","id":1714756924,"node_id":"IC_kwDOACaFSM5mNR08","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-11T23:51:21Z","updated_at":"2023-09-11T23:52:32Z","author_association":"CONTRIBUTOR","body":"> It doesn't look like this can happen. Is this just being added to help us catch some future mistake?\r\n\r\nYes it would be very easy to make a code change in a function that calls this function that breaks the expectation.  Adding the validation may catch that in test before it has chance to cause deadlock somewhere, acquiring the locks out of order does not always cause deadlock but now if something does acquire them in the wrong order we will get an exception.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1714756924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1715690461","html_url":"https://github.com/apache/accumulo/issues/3749#issuecomment-1715690461","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3749","id":1715690461,"node_id":"IC_kwDOACaFSM5mQ1vd","user":{"login":"alerman","id":119506,"node_id":"MDQ6VXNlcjExOTUwNg==","avatar_url":"https://avatars.githubusercontent.com/u/119506?v=4","gravatar_id":"","url":"https://api.github.com/users/alerman","html_url":"https://github.com/alerman","followers_url":"https://api.github.com/users/alerman/followers","following_url":"https://api.github.com/users/alerman/following{/other_user}","gists_url":"https://api.github.com/users/alerman/gists{/gist_id}","starred_url":"https://api.github.com/users/alerman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alerman/subscriptions","organizations_url":"https://api.github.com/users/alerman/orgs","repos_url":"https://api.github.com/users/alerman/repos","events_url":"https://api.github.com/users/alerman/events{/privacy}","received_events_url":"https://api.github.com/users/alerman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-12T13:06:19Z","updated_at":"2023-09-12T13:44:01Z","author_association":"CONTRIBUTOR","body":"Changed the tserver.compaction.major.service.default.planner.opt.executors to have 3 pools (small, medium, large) to having 2 pools (large, huge).\r\nThis results in the small and medium pools being terminated.  Apparently this will get things stuck if some compactions are running in those pools.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1715690461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1715767558","html_url":"https://github.com/apache/accumulo/pull/3748#issuecomment-1715767558","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3748","id":1715767558,"node_id":"IC_kwDOACaFSM5mRIkG","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-12T13:50:51Z","updated_at":"2023-09-12T13:50:51Z","author_association":"CONTRIBUTOR","body":"Looking at the code if an exception occurs at certain place it may leave walogs that are in use not referenced.  Want to examine this case a bit more and may rework this code to handle that case and not leave the lock locked.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1715767558/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1715955060","html_url":"https://github.com/apache/accumulo/pull/3719#issuecomment-1715955060","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3719","id":1715955060,"node_id":"IC_kwDOACaFSM5mR2V0","user":{"login":"ivakegg","id":347158,"node_id":"MDQ6VXNlcjM0NzE1OA==","avatar_url":"https://avatars.githubusercontent.com/u/347158?v=4","gravatar_id":"","url":"https://api.github.com/users/ivakegg","html_url":"https://github.com/ivakegg","followers_url":"https://api.github.com/users/ivakegg/followers","following_url":"https://api.github.com/users/ivakegg/following{/other_user}","gists_url":"https://api.github.com/users/ivakegg/gists{/gist_id}","starred_url":"https://api.github.com/users/ivakegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ivakegg/subscriptions","organizations_url":"https://api.github.com/users/ivakegg/orgs","repos_url":"https://api.github.com/users/ivakegg/repos","events_url":"https://api.github.com/users/ivakegg/events{/privacy}","received_events_url":"https://api.github.com/users/ivakegg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-12T15:32:46Z","updated_at":"2023-09-12T15:32:46Z","author_association":"CONTRIBUTOR","body":"Yes, some sort of banner or alert box that is present on all pages is what I am looking for.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1715955060/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716102939","html_url":"https://github.com/apache/accumulo/pull/3676#issuecomment-1716102939","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3676","id":1716102939,"node_id":"IC_kwDOACaFSM5mSacb","user":{"login":"DomGarguilo","id":47725857,"node_id":"MDQ6VXNlcjQ3NzI1ODU3","avatar_url":"https://avatars.githubusercontent.com/u/47725857?v=4","gravatar_id":"","url":"https://api.github.com/users/DomGarguilo","html_url":"https://github.com/DomGarguilo","followers_url":"https://api.github.com/users/DomGarguilo/followers","following_url":"https://api.github.com/users/DomGarguilo/following{/other_user}","gists_url":"https://api.github.com/users/DomGarguilo/gists{/gist_id}","starred_url":"https://api.github.com/users/DomGarguilo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DomGarguilo/subscriptions","organizations_url":"https://api.github.com/users/DomGarguilo/orgs","repos_url":"https://api.github.com/users/DomGarguilo/repos","events_url":"https://api.github.com/users/DomGarguilo/events{/privacy}","received_events_url":"https://api.github.com/users/DomGarguilo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-12T16:56:35Z","updated_at":"2023-09-12T16:56:35Z","author_association":"MEMBER","body":"> @DomGarguilo I added a commit to this branch to improve the test. I kept all the test cases the same (well, some of the property values being set changed, but the actual values don't matter; that was just for convenience). But, I reorganized quite a bit of it.\r\n> \r\n> I think it's ready to merge, but I'll leave it to you to go over what I changed, and determine if you agree with the changes I made before you merge it.\r\n\r\nThe changes you made look great! I'll go ahead and merge this now.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716102939/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716215733","html_url":"https://github.com/apache/accumulo/pull/3750#issuecomment-1716215733","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3750","id":1716215733,"node_id":"IC_kwDOACaFSM5mS1-1","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-12T18:23:09Z","updated_at":"2023-09-12T18:23:09Z","author_association":"CONTRIBUTOR","body":"This change could result in over subscription of resources.  For example if a thread pool A with 10 threads is replaced by thread pool B with 15 threads, then this change will let anything running on A complete and make B available for running new compaction.  This could result in 25 compactions running for a brief period.  This change could be improved to leverage existing compaction cancellation mechanisms (not an thread interrupt) to request the 10 compactions running on A stop their-self. Was not sure about making this change, thinking it would probably be for the best. It may waste work, but would make it easier to reason about resources.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716215733/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716233654","html_url":"https://github.com/apache/accumulo/pull/3750#issuecomment-1716233654","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3750","id":1716233654,"node_id":"IC_kwDOACaFSM5mS6W2","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-12T18:37:17Z","updated_at":"2023-09-12T18:39:49Z","author_association":"CONTRIBUTOR","body":"Not cancelling majc would cause `Tablet.completeClose` to wait until it's done?\r\n\r\nUpdate: I looked, it doesn't.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716233654/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716408254","html_url":"https://github.com/apache/accumulo/pull/3750#issuecomment-1716408254","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3750","id":1716408254,"node_id":"IC_kwDOACaFSM5mTk--","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-12T20:47:28Z","updated_at":"2023-09-12T20:47:28Z","author_association":"CONTRIBUTOR","body":"Updated to cancel running compaction in the deleted thread pool in c2fd9de.  One of the tserver logs from running the new IT added in the PR looks like the following.\r\n\r\n```\r\n$ egrep \"cancel|Compacted|Compacting|Stopped\" TabletServer_1804111829.out \r\n2023-09-12T16:29:07,147 [tablet.files] DEBUG: Compacting 1;r:0020;r:0010 on i.cs1.small for USER from [F0000086.rf] size 261 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:07,147 [tablet.files] DEBUG: Compacting 1;r:0030;r:0020 on i.cs1.small for USER from [F0000084.rf] size 261 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:08,198 [tablet.files] DEBUG: Compacted 1;r:0020;r:0010 for USER created VOLUME/tables/1/t-0000051/A000009i.rf from [F0000086.rf]\r\n2023-09-12T16:29:08,198 [tablet.files] DEBUG: Compacted 1;r:0030;r:0020 for USER created VOLUME/tables/1/t-0000052/A000009j.rf from [F0000084.rf]\r\n2023-09-12T16:29:08,198 [tablet.files] DEBUG: Compacting 1;r:0990;r:0980 on i.cs1.small for USER from [F000009g.rf] size 262 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:08,198 [tablet.files] DEBUG: Compacting 1;r:0070;r:0060 on i.cs1.small for USER from [F0000087.rf] size 260 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:09,215 [tablet.files] DEBUG: Compacted 1;r:0990;r:0980 for USER created VOLUME/tables/1/t-000007q/A000009k.rf from [F000009g.rf]\r\n2023-09-12T16:29:09,215 [tablet.files] DEBUG: Compacted 1;r:0070;r:0060 for USER created VOLUME/tables/1/t-0000056/A000009l.rf from [F0000087.rf]\r\n2023-09-12T16:29:09,215 [tablet.files] DEBUG: Compacting 1;r:0970;r:0960 on i.cs1.small for USER from [F000009h.rf] size 262 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:09,215 [tablet.files] DEBUG: Compacting 1;r:0920;r:0910 on i.cs1.small for USER from [F000009f.rf] size 263 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,236 [tablet.files] DEBUG: Compacted 1;r:0920;r:0910 for USER created VOLUME/tables/1/t-000007j/A000009n.rf from [F000009f.rf]\r\n2023-09-12T16:29:10,236 [tablet.files] DEBUG: Compacted 1;r:0970;r:0960 for USER created VOLUME/tables/1/t-000007o/A000009m.rf from [F000009h.rf]\r\n2023-09-12T16:29:10,237 [tablet.files] DEBUG: Compacting 1;r:0870;r:0860 on i.cs1.small for USER from [F000009d.rf] size 262 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,237 [tablet.files] DEBUG: Compacting 1;r:0890;r:0880 on i.cs1.small for USER from [F000009e.rf] size 263 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,238 [compactions.InternalCompactionExecutor] DEBUG: Stopped compaction executor i.cs1.small running:2 canceled:42\r\n2023-09-12T16:29:10,239 [compactions.InternalCompactionExecutor] DEBUG: Stopped compaction executor i.cs1.medium running:0 canceled:0\r\n2023-09-12T16:29:10,239 [compactions.InternalCompactionExecutor] DEBUG: Stopped compaction executor i.cs1.large running:0 canceled:0\r\n2023-09-12T16:29:10,246 [compaction.FileCompactor] DEBUG: Compaction canceled 1;r:0890;r:0880\r\n2023-09-12T16:29:10,246 [compaction.FileCompactor] DEBUG: Compaction canceled 1;r:0870;r:0860\r\n2023-09-12T16:29:10,247 [tablet.CompactableImpl] DEBUG: Compaction canceled 1;r:0870;r:0860 \r\n2023-09-12T16:29:10,247 [tablet.CompactableImpl] DEBUG: Compaction canceled 1;r:0890;r:0880 \r\n2023-09-12T16:29:10,248 [tablet.files] DEBUG: Compacting 1;r:0890;r:0880 on i.cs1.little for USER from [F000009e.rf] size 263 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,248 [tablet.files] DEBUG: Compacting 1;r:0870;r:0860 on i.cs1.little for USER from [F000009d.rf] size 262 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,272 [tablet.files] DEBUG: Compacting 1;r:0080;r:0070 on i.cs1.little for USER from [F0000085.rf] size 259 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,272 [tablet.files] DEBUG: Compacting 1;r:0090;r:0080 on i.cs1.little for USER from [F0000088.rf] size 259 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,272 [tablet.files] DEBUG: Compacting 1;r:0100;r:0090 on i.cs1.little for USER from [F0000089.rf] size 263 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,273 [tablet.files] DEBUG: Compacting 1;r:0120;r:0110 on i.cs1.little for USER from [F000008a.rf] size 261 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,273 [tablet.files] DEBUG: Compacting 1;r:0130;r:0120 on i.cs1.little for USER from [F000008b.rf] size 262 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n2023-09-12T16:29:10,273 [tablet.files] DEBUG: Compacting 1;r:0140;r:0130 on i.cs1.little for USER from [F000008d.rf] size 264 bytes config [iterators=[name:SlowIterator, priority:100, class:org.apache.accumulo.test.functional.SlowIterator, properties:{sleepTime=100}]]\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716408254/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716419158","html_url":"https://github.com/apache/accumulo/pull/3752#issuecomment-1716419158","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3752","id":1716419158,"node_id":"IC_kwDOACaFSM5mTnpW","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-12T20:55:29Z","updated_at":"2023-09-12T20:55:29Z","author_association":"CONTRIBUTOR","body":"Kicked off full IT build","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716419158/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716479912","html_url":"https://github.com/apache/accumulo/pull/3752#issuecomment-1716479912","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3752","id":1716479912,"node_id":"IC_kwDOACaFSM5mT2eo","user":{"login":"ddanielr","id":12480877,"node_id":"MDQ6VXNlcjEyNDgwODc3","avatar_url":"https://avatars.githubusercontent.com/u/12480877?v=4","gravatar_id":"","url":"https://api.github.com/users/ddanielr","html_url":"https://github.com/ddanielr","followers_url":"https://api.github.com/users/ddanielr/followers","following_url":"https://api.github.com/users/ddanielr/following{/other_user}","gists_url":"https://api.github.com/users/ddanielr/gists{/gist_id}","starred_url":"https://api.github.com/users/ddanielr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddanielr/subscriptions","organizations_url":"https://api.github.com/users/ddanielr/orgs","repos_url":"https://api.github.com/users/ddanielr/repos","events_url":"https://api.github.com/users/ddanielr/events{/privacy}","received_events_url":"https://api.github.com/users/ddanielr/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-12T21:32:03Z","updated_at":"2023-09-12T21:32:03Z","author_association":"CONTRIBUTOR","body":"Thrift was originally passing `0` for the backlog. Since ServerSocket uses `50` if backlog value is less than 1, this change shouldn't modify existing behavior. \r\n\r\nhttps://github.com/openjdk/jdk/blob/a9679acd5c85b88afe827dc55dbe9a78b00c8918/src/java.base/share/classes/java/net/ServerSocket.java#L272-L273\r\n\r\nChanges look good to me!","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1716479912/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1717981310","html_url":"https://github.com/apache/accumulo/pull/3752#issuecomment-1717981310","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3752","id":1717981310,"node_id":"IC_kwDOACaFSM5mZlB-","user":{"login":"dlmarion","id":567911,"node_id":"MDQ6VXNlcjU2NzkxMQ==","avatar_url":"https://avatars.githubusercontent.com/u/567911?v=4","gravatar_id":"","url":"https://api.github.com/users/dlmarion","html_url":"https://github.com/dlmarion","followers_url":"https://api.github.com/users/dlmarion/followers","following_url":"https://api.github.com/users/dlmarion/following{/other_user}","gists_url":"https://api.github.com/users/dlmarion/gists{/gist_id}","starred_url":"https://api.github.com/users/dlmarion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dlmarion/subscriptions","organizations_url":"https://api.github.com/users/dlmarion/orgs","repos_url":"https://api.github.com/users/dlmarion/repos","events_url":"https://api.github.com/users/dlmarion/events{/privacy}","received_events_url":"https://api.github.com/users/dlmarion/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-13T16:48:42Z","updated_at":"2023-09-13T16:48:42Z","author_association":"CONTRIBUTOR","body":"Full IT build passed successfully.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1717981310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1718043320","html_url":"https://github.com/apache/accumulo/pull/3750#issuecomment-1718043320","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3750","id":1718043320,"node_id":"IC_kwDOACaFSM5mZ0K4","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-13T17:33:51Z","updated_at":"2023-09-13T17:33:51Z","author_association":"CONTRIBUTOR","body":"Would it be worth providing feedback to the user that removing the compaction queue will result in cancelling running compactions?  If I was changing the value it seems like I'd want to go ahead - I'm changing it for a reason.  But, If I know that running compactions are cancelled on the change, I would know to resubmit any that I may have cared about?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1718043320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1719450927","html_url":"https://github.com/apache/accumulo/pull/3290#issuecomment-1719450927","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3290","id":1719450927,"node_id":"IC_kwDOACaFSM5mfL0v","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-14T13:26:55Z","updated_at":"2023-09-14T13:26:55Z","author_association":"CONTRIBUTOR","body":"Is this still valid?  At this point it may be better to target 3.1 for these changes.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1719450927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1720040546","html_url":"https://github.com/apache/accumulo/issues/3486#issuecomment-1720040546","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3486","id":1720040546,"node_id":"IC_kwDOACaFSM5mhbxi","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-14T19:42:51Z","updated_at":"2023-09-14T19:42:51Z","author_association":"CONTRIBUTOR","body":"Fixed with #3676 ","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1720040546/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1720178523","html_url":"https://github.com/apache/accumulo/issues/3744#issuecomment-1720178523","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3744","id":1720178523,"node_id":"IC_kwDOACaFSM5mh9db","user":{"login":"ctubbsii","id":1280725,"node_id":"MDQ6VXNlcjEyODA3MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1280725?v=4","gravatar_id":"","url":"https://api.github.com/users/ctubbsii","html_url":"https://github.com/ctubbsii","followers_url":"https://api.github.com/users/ctubbsii/followers","following_url":"https://api.github.com/users/ctubbsii/following{/other_user}","gists_url":"https://api.github.com/users/ctubbsii/gists{/gist_id}","starred_url":"https://api.github.com/users/ctubbsii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ctubbsii/subscriptions","organizations_url":"https://api.github.com/users/ctubbsii/orgs","repos_url":"https://api.github.com/users/ctubbsii/repos","events_url":"https://api.github.com/users/ctubbsii/events{/privacy}","received_events_url":"https://api.github.com/users/ctubbsii/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-14T21:30:27Z","updated_at":"2023-09-14T21:30:27Z","author_association":"MEMBER","body":"I think changing it to `LoggerFactory.getLogger(GCRun.class.getName() + \".\" + level.name());` would be fine.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1720178523/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1720218244","html_url":"https://github.com/apache/accumulo/pull/3750#issuecomment-1720218244","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3750","id":1720218244,"node_id":"IC_kwDOACaFSM5miHKE","user":{"login":"keith-turner","id":1268739,"node_id":"MDQ6VXNlcjEyNjg3Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/1268739?v=4","gravatar_id":"","url":"https://api.github.com/users/keith-turner","html_url":"https://github.com/keith-turner","followers_url":"https://api.github.com/users/keith-turner/followers","following_url":"https://api.github.com/users/keith-turner/following{/other_user}","gists_url":"https://api.github.com/users/keith-turner/gists{/gist_id}","starred_url":"https://api.github.com/users/keith-turner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keith-turner/subscriptions","organizations_url":"https://api.github.com/users/keith-turner/orgs","repos_url":"https://api.github.com/users/keith-turner/repos","events_url":"https://api.github.com/users/keith-turner/events{/privacy}","received_events_url":"https://api.github.com/users/keith-turner/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-14T22:07:58Z","updated_at":"2023-09-14T22:07:58Z","author_association":"CONTRIBUTOR","body":"> But, If I know that running compactions are cancelled on the change, I would know to resubmit any that I may have cared about?\r\n\r\nIf a tablets need to compact then it will automatically start running on the new thread pool.  Should not need to resubmit anything.","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1720218244/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1720221147","html_url":"https://github.com/apache/accumulo/pull/3750#issuecomment-1720221147","issue_url":"https://api.github.com/repos/apache/accumulo/issues/3750","id":1720221147,"node_id":"IC_kwDOACaFSM5miH3b","user":{"login":"EdColeman","id":7047700,"node_id":"MDQ6VXNlcjcwNDc3MDA=","avatar_url":"https://avatars.githubusercontent.com/u/7047700?v=4","gravatar_id":"","url":"https://api.github.com/users/EdColeman","html_url":"https://github.com/EdColeman","followers_url":"https://api.github.com/users/EdColeman/followers","following_url":"https://api.github.com/users/EdColeman/following{/other_user}","gists_url":"https://api.github.com/users/EdColeman/gists{/gist_id}","starred_url":"https://api.github.com/users/EdColeman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EdColeman/subscriptions","organizations_url":"https://api.github.com/users/EdColeman/orgs","repos_url":"https://api.github.com/users/EdColeman/repos","events_url":"https://api.github.com/users/EdColeman/events{/privacy}","received_events_url":"https://api.github.com/users/EdColeman/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-09-14T22:11:00Z","updated_at":"2023-09-14T22:11:00Z","author_association":"CONTRIBUTOR","body":"> If a tablets need to compact then it will automatically start running on the new thread pool.\r\n\r\nSo user compactions are not impacted?","reactions":{"url":"https://api.github.com/repos/apache/accumulo/issues/comments/1720221147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]