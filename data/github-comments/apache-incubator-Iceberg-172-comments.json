[{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1135881849","html_url":"https://github.com/apache/iceberg/issues/2387#issuecomment-1135881849","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2387","id":1135881849,"node_id":"IC_kwDOCW7NX85DtC55","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T12:51:00Z","updated_at":"2022-05-24T12:51:00Z","author_association":"CONTRIBUTOR","body":"is there anthor solution? it comes up frequently. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1135881849/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136039041","html_url":"https://github.com/apache/iceberg/pull/4850#issuecomment-1136039041","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4850","id":1136039041,"node_id":"IC_kwDOCW7NX85DtpSB","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T14:57:02Z","updated_at":"2022-05-24T14:57:02Z","author_association":"CONTRIBUTOR","body":"Thanks, @singhpk234!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136039041/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136068199","html_url":"https://github.com/apache/iceberg/pull/4517#issuecomment-1136068199","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4517","id":1136068199,"node_id":"IC_kwDOCW7NX85DtwZn","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T15:21:57Z","updated_at":"2022-05-24T15:21:57Z","author_association":"CONTRIBUTOR","body":"@SreeramGarlapati @rdblue any additional comments? If not I think it is good to be merged.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136068199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136149541","html_url":"https://github.com/apache/iceberg/pull/4841#issuecomment-1136149541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4841","id":1136149541,"node_id":"IC_kwDOCW7NX85DuEQl","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T16:36:06Z","updated_at":"2022-05-24T16:36:06Z","author_association":"CONTRIBUTOR","body":"> If you wanted to add a test for this, we might be able to generate data using Spark with some combination of `spark.sql.parquet.binaryAsString` and/or `spark.sql.parquet.writeLegacyFormat`.\r\n\r\n@kbendick Yes, that would be great if we could add some tests as well. Could you please walk me through the data generation process? I'm not familiar with the the spark APIs. Shall we do it in a separate PR? ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136149541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136169415","html_url":"https://github.com/apache/iceberg/issues/2387#issuecomment-1136169415","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2387","id":1136169415,"node_id":"IC_kwDOCW7NX85DuJHH","user":{"login":"flyrain","id":1322359,"node_id":"MDQ6VXNlcjEzMjIzNTk=","avatar_url":"https://avatars.githubusercontent.com/u/1322359?v=4","gravatar_id":"","url":"https://api.github.com/users/flyrain","html_url":"https://github.com/flyrain","followers_url":"https://api.github.com/users/flyrain/followers","following_url":"https://api.github.com/users/flyrain/following{/other_user}","gists_url":"https://api.github.com/users/flyrain/gists{/gist_id}","starred_url":"https://api.github.com/users/flyrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/flyrain/subscriptions","organizations_url":"https://api.github.com/users/flyrain/orgs","repos_url":"https://api.github.com/users/flyrain/repos","events_url":"https://api.github.com/users/flyrain/events{/privacy}","received_events_url":"https://api.github.com/users/flyrain/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T16:50:30Z","updated_at":"2022-05-24T16:50:30Z","author_association":"CONTRIBUTOR","body":"@hililiwei not sure if there is another solution, it is more a Hive issue. To get a better answer, you may ping the Hive community. cc Hive expert, @szehon-ho ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136169415/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136244147","html_url":"https://github.com/apache/iceberg/issues/4624#issuecomment-1136244147","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4624","id":1136244147,"node_id":"IC_kwDOCW7NX85DubWz","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T17:32:58Z","updated_at":"2022-05-24T17:32:58Z","author_association":"CONTRIBUTOR","body":"Hi @yittg! Are you still planning on trying to get this into 1.14?\r\n\r\nI personally think it's dangerous to do, and that we should avoid it. It would only work for the newest versions(s) of Flink 1.14, and we don't have control over which version is in use. We also don't run tests across different patch releases of any framework.\r\n\r\nIf you're not, please close this issue. If you would like to patch this into 1.14 conditionally, we'll have to see what other people think as this change could only be applied to Flink versions 1.14.5+ and I don't believe there is any existing precedence for code being changed at the patch level (just the minor version level).\r\n\r\nLet us know what you think!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136244147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136244884","html_url":"https://github.com/apache/iceberg/pull/4854#issuecomment-1136244884","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4854","id":1136244884,"node_id":"IC_kwDOCW7NX85DubiU","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T17:33:47Z","updated_at":"2022-05-24T17:33:47Z","author_association":"CONTRIBUTOR","body":"LGTM, Thanks @nastra !!!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136244884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136252119","html_url":"https://github.com/apache/iceberg/issues/2387#issuecomment-1136252119","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2387","id":1136252119,"node_id":"IC_kwDOCW7NX85DudTX","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T17:41:23Z","updated_at":"2022-05-24T17:41:23Z","author_association":"COLLABORATOR","body":"Thanks :). Yea it looks like postgres DB issue, instead of Hive, looks corrupted.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136252119/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136276241","html_url":"https://github.com/apache/iceberg/pull/4443#issuecomment-1136276241","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4443","id":1136276241,"node_id":"IC_kwDOCW7NX85DujMR","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T18:07:22Z","updated_at":"2022-05-24T18:07:22Z","author_association":"CONTRIBUTOR","body":"I have a PR for consolidating configurations, it might be good to add these properties there like `spark.sql.catalog.<catalog>.s3.delete.tags.<key>`: https://github.com/apache/iceberg/pull/4801","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136276241/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136312681","html_url":"https://github.com/apache/iceberg/issues/323#issuecomment-1136312681","issue_url":"https://api.github.com/repos/apache/iceberg/issues/323","id":1136312681,"node_id":"IC_kwDOCW7NX85DusFp","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T18:46:15Z","updated_at":"2022-05-24T18:46:15Z","author_association":"CONTRIBUTOR","body":"Closing this: Build and test instructions have been added to the refactored python library: https://github.com/apache/iceberg/blob/master/python/README.md","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136312681/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136316016","html_url":"https://github.com/apache/iceberg/pull/4854#issuecomment-1136316016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4854","id":1136316016,"node_id":"IC_kwDOCW7NX85Dus5w","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T18:50:16Z","updated_at":"2022-05-24T18:50:16Z","author_association":"MEMBER","body":"Thanks @nastra !","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136316016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136317494","html_url":"https://github.com/apache/iceberg/issues/2915#issuecomment-1136317494","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2915","id":1136317494,"node_id":"IC_kwDOCW7NX85DutQ2","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T18:52:01Z","updated_at":"2022-05-24T18:52:01Z","author_association":"CONTRIBUTOR","body":"Closing this since it looks like these have already been addressed in the refactor efforts, [before](https://github.com/apache/iceberg/blob/master/python_legacy/iceberg/api/transforms/transform_util.py) and [after](https://github.com/apache/iceberg/blob/master/python/src/iceberg/utils/datetime.py)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136317494/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136346499","html_url":"https://github.com/apache/iceberg/issues/4856#issuecomment-1136346499","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4856","id":1136346499,"node_id":"IC_kwDOCW7NX85Du0WD","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T19:24:48Z","updated_at":"2022-05-24T19:24:48Z","author_association":"CONTRIBUTOR","body":"+1, looks like we should sleep atleast by 1000 ms to avoid scenarios like these [SO](https://stackoverflow.com/questions/24804618/get-file-mtime-with-millisecond-resolution-from-java) where we loose tracking millisecond precision while getting lastModification time.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136346499/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136403891","html_url":"https://github.com/apache/iceberg/issues/4820#issuecomment-1136403891","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4820","id":1136403891,"node_id":"IC_kwDOCW7NX85DvCWz","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T20:33:03Z","updated_at":"2022-05-24T20:33:03Z","author_association":"CONTRIBUTOR","body":"Hi @jeff1evesque. I noticed in your fork that you've had some activity since this. Is this something we can close? I think this is more Flink specific than Iceberg specific.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136403891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136411800","html_url":"https://github.com/apache/iceberg/pull/4734#issuecomment-1136411800","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4734","id":1136411800,"node_id":"IC_kwDOCW7NX85DvESY","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T20:42:37Z","updated_at":"2022-05-24T20:47:50Z","author_association":"CONTRIBUTOR","body":"Hi @hililiwei! Can you update the PR description, now that this PR is not updating the ORC version?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136411800/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136419077","html_url":"https://github.com/apache/iceberg/pull/4734#issuecomment-1136419077","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4734","id":1136419077,"node_id":"IC_kwDOCW7NX85DvGEF","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T20:51:06Z","updated_at":"2022-05-24T20:52:26Z","author_association":"CONTRIBUTOR","body":"Given that the tests were also updated in #4573, I think that this is good to go. Attempting to re-request review from @dongjoon-hyun - just to clear the impression that further changes are expected. Please correct me if I'm wrong.\r\n\r\nCorresponding test adjustment: https://github.com/apache/iceberg/blob/04871b79e9aba02e9534498fa035b627bcb9af6e/data/src/test/java/org/apache/iceberg/data/TestMetricsRowGroupFilter.java#L299-L321","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136419077/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136424166","html_url":"https://github.com/apache/iceberg/issues/4820#issuecomment-1136424166","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4820","id":1136424166,"node_id":"IC_kwDOCW7NX85DvHTm","user":{"login":"jeff1evesque","id":2907085,"node_id":"MDQ6VXNlcjI5MDcwODU=","avatar_url":"https://avatars.githubusercontent.com/u/2907085?v=4","gravatar_id":"","url":"https://api.github.com/users/jeff1evesque","html_url":"https://github.com/jeff1evesque","followers_url":"https://api.github.com/users/jeff1evesque/followers","following_url":"https://api.github.com/users/jeff1evesque/following{/other_user}","gists_url":"https://api.github.com/users/jeff1evesque/gists{/gist_id}","starred_url":"https://api.github.com/users/jeff1evesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeff1evesque/subscriptions","organizations_url":"https://api.github.com/users/jeff1evesque/orgs","repos_url":"https://api.github.com/users/jeff1evesque/repos","events_url":"https://api.github.com/users/jeff1evesque/events{/privacy}","received_events_url":"https://api.github.com/users/jeff1evesque/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T20:56:55Z","updated_at":"2022-05-24T20:56:55Z","author_association":"NONE","body":"@kbendick -- yessir, and thank you.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136424166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136427208","html_url":"https://github.com/apache/iceberg/issues/4856#issuecomment-1136427208","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4856","id":1136427208,"node_id":"IC_kwDOCW7NX85DvIDI","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T21:00:29Z","updated_at":"2022-05-24T21:00:29Z","author_association":"MEMBER","body":"Why not just put our \"deleteFilesOlderThan\" time in the future? I hate waiting in tests :)","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136427208/reactions","total_count":4,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136428584","html_url":"https://github.com/apache/iceberg/issues/4856#issuecomment-1136428584","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4856","id":1136428584,"node_id":"IC_kwDOCW7NX85DvIYo","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T21:02:00Z","updated_at":"2022-05-24T21:02:00Z","author_association":"CONTRIBUTOR","body":"Adding Russells suggestion now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136428584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136459562","html_url":"https://github.com/apache/iceberg/issues/4804#issuecomment-1136459562","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4804","id":1136459562,"node_id":"IC_kwDOCW7NX85DvP8q","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T21:42:25Z","updated_at":"2022-05-24T21:42:41Z","author_association":"CONTRIBUTOR","body":"I don't think that this has anything to do with it, but I noticed the jars you're using are both `iceberg-spark3-runtime` as well as `iceberg-spark3-extensions`.\r\n\r\nFirst: You don't need the `extensions` jar. Only the `runtime` jar.\r\nSecond: `iceberg-spark3-runtime` is only for Spark 3.0.x. For Spark 3.1 or 3.2, you should be using `iceberg-spark-runtime-3.1_2.12:0.13.1` or `iceberg-spark-runtime-3.2_2.12` (assuming your scala versions is 2.12). If you are using Spark 3.0.x, then that's the correct runtime jar.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136459562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136512731","html_url":"https://github.com/apache/iceberg/issues/4822#issuecomment-1136512731","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4822","id":1136512731,"node_id":"IC_kwDOCW7NX85Dvc7b","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T22:59:02Z","updated_at":"2022-05-24T22:59:02Z","author_association":"COLLABORATOR","body":"Looks like same issue as reported : https://github.com/apache/iceberg/pull/4596","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136512731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136529127","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1136529127","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1136529127,"node_id":"IC_kwDOCW7NX85Dvg7n","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-24T23:29:33Z","updated_at":"2022-05-24T23:48:12Z","author_association":"COLLABORATOR","body":"Took a little a look through the code,\r\n\r\nParallelIterable.hasNext() calls [checkTasks() ](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/util/ParallelIterable.java#L97) , which then calls submitNextTask() but only up to taskFuture size (configured thread pool size).  \r\n\r\n[submitNextTask](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/util/ParallelIterable.java#L129)  is the one that calls tasks.next(), which adds things to the queue.  I guess that's why @rdblue is mentioning, it is self-limiting.\r\n\r\nThe problem may be that each [tasks.next()](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/util/ParallelIterable.java#L65) does dump the entire nested Iterable into the queue.  \r\n\r\nSo in real life example of the planning case, it seems the level parallelism is manifest.  New manifests may be blocked to be processed if nobody is consuming, but a single or few manifests having a lot of entries may cause memory pressure as they dump all of the entries to the queue.  @lirui-apache @uncleGen is that the case?  Probably the fix is to rewriteManifests to have each manifest have more even number of entries?  \r\n\r\nI guess if we use blocking queue, it may be useful and we have another knob to limit the memory, but then it's not truly parallel by manifest, ie some manifests may be blocked a long time before they can submit their entries to the queue.  @rdblue let me know if you have any thoughts or if I may have misread the code.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136529127/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136580504","html_url":"https://github.com/apache/iceberg/pull/4831#issuecomment-1136580504","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4831","id":1136580504,"node_id":"IC_kwDOCW7NX85DvteY","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T01:03:01Z","updated_at":"2022-05-25T01:03:01Z","author_association":"CONTRIBUTOR","body":"cc @aokolnychyi @RussellSpitzer @flyrain @szehon-ho \r\nThis PR is ready for review. Thank you very much in advance!\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136580504/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136582708","html_url":"https://github.com/apache/iceberg/pull/4831#issuecomment-1136582708","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4831","id":1136582708,"node_id":"IC_kwDOCW7NX85DvuA0","user":{"login":"huaxingao","id":13592258,"node_id":"MDQ6VXNlcjEzNTkyMjU4","avatar_url":"https://avatars.githubusercontent.com/u/13592258?v=4","gravatar_id":"","url":"https://api.github.com/users/huaxingao","html_url":"https://github.com/huaxingao","followers_url":"https://api.github.com/users/huaxingao/followers","following_url":"https://api.github.com/users/huaxingao/following{/other_user}","gists_url":"https://api.github.com/users/huaxingao/gists{/gist_id}","starred_url":"https://api.github.com/users/huaxingao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huaxingao/subscriptions","organizations_url":"https://api.github.com/users/huaxingao/orgs","repos_url":"https://api.github.com/users/huaxingao/repos","events_url":"https://api.github.com/users/huaxingao/events{/privacy}","received_events_url":"https://api.github.com/users/huaxingao/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T01:05:29Z","updated_at":"2022-05-25T01:05:29Z","author_association":"CONTRIBUTOR","body":"also cc @kbendick @chenjunjiedada @rdblue ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136582708/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136612875","html_url":"https://github.com/apache/iceberg/issues/4624#issuecomment-1136612875","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4624","id":1136612875,"node_id":"IC_kwDOCW7NX85Dv1YL","user":{"login":"yittg","id":4429171,"node_id":"MDQ6VXNlcjQ0MjkxNzE=","avatar_url":"https://avatars.githubusercontent.com/u/4429171?v=4","gravatar_id":"","url":"https://api.github.com/users/yittg","html_url":"https://github.com/yittg","followers_url":"https://api.github.com/users/yittg/followers","following_url":"https://api.github.com/users/yittg/following{/other_user}","gists_url":"https://api.github.com/users/yittg/gists{/gist_id}","starred_url":"https://api.github.com/users/yittg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yittg/subscriptions","organizations_url":"https://api.github.com/users/yittg/orgs","repos_url":"https://api.github.com/users/yittg/repos","events_url":"https://api.github.com/users/yittg/events{/privacy}","received_events_url":"https://api.github.com/users/yittg/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T01:38:41Z","updated_at":"2022-05-25T01:38:41Z","author_association":"CONTRIBUTOR","body":"@kbendick Thanks for reminding, i'll close this issue directly.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136612875/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136629488","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1136629488","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1136629488,"node_id":"IC_kwDOCW7NX85Dv5bw","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T01:59:11Z","updated_at":"2022-05-25T01:59:11Z","author_association":"CONTRIBUTOR","body":"@szehon-ho, that sounds correct to me. I'm reluctant to block the queue because that introduces another bottleneck in cases where you probably don't want one.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136629488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136676402","html_url":"https://github.com/apache/iceberg/pull/4853#issuecomment-1136676402","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4853","id":1136676402,"node_id":"IC_kwDOCW7NX85DwE4y","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T03:10:35Z","updated_at":"2022-05-25T03:10:35Z","author_association":"CONTRIBUTOR","body":"@openinx can you review it? thx!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136676402/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136678474","html_url":"https://github.com/apache/iceberg/issues/4802#issuecomment-1136678474","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4802","id":1136678474,"node_id":"IC_kwDOCW7NX85DwFZK","user":{"login":"ldwnt","id":7655486,"node_id":"MDQ6VXNlcjc2NTU0ODY=","avatar_url":"https://avatars.githubusercontent.com/u/7655486?v=4","gravatar_id":"","url":"https://api.github.com/users/ldwnt","html_url":"https://github.com/ldwnt","followers_url":"https://api.github.com/users/ldwnt/followers","following_url":"https://api.github.com/users/ldwnt/following{/other_user}","gists_url":"https://api.github.com/users/ldwnt/gists{/gist_id}","starred_url":"https://api.github.com/users/ldwnt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ldwnt/subscriptions","organizations_url":"https://api.github.com/users/ldwnt/orgs","repos_url":"https://api.github.com/users/ldwnt/repos","events_url":"https://api.github.com/users/ldwnt/events{/privacy}","received_events_url":"https://api.github.com/users/ldwnt/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T03:14:18Z","updated_at":"2022-05-25T03:14:18Z","author_association":"NONE","body":"> The target size property in Iceberg is write.target-file-size-bytes\r\n\r\ntried but it seems not working. the actual size of data file is beyond the value of parameter 'write.target-file-size-bytes'\r\n\r\nddl:\r\n```\r\nCREATE TABLE ...  (\r\n...\r\n) PARTITIONED BY (`dataset`) WITH (\r\n    'format-version'='2',\r\n    'engine.hive.enabled'='true',\r\n    'write.metadata.delete-after-commit.enabled'='true',\r\n    'write.metadata.previous-versions-max'='5',\r\n    'write.target-file-size-bytes'='1024'\r\n);\r\n```\r\n\r\nmetadata file:\r\n```\r\n{\r\n...\r\n\t\"data_file\": {\r\n\t\t\"file_format\": \"PARQUET\",\r\n\t\t\"partition\": {\r\n\t\t\t\"dataset\": {\r\n\t\t\t\t\"string\": \"test.aa\"\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"record_count\": 1124,\r\n\t\t\"file_size_in_bytes\": 8663,\r\n...\r\n}\r\n```","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136678474/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136702576","html_url":"https://github.com/apache/iceberg/issues/4802#issuecomment-1136702576","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4802","id":1136702576,"node_id":"IC_kwDOCW7NX85DwLRw","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T04:08:21Z","updated_at":"2022-05-25T04:27:19Z","author_association":"MEMBER","body":"The rolling file appended only checks the buffer size  (which itself is an estimate) after writing a specific number of rows (to avoid the cost on every row). So for very small sizes are dominated by how many rows are checked before checking the size. This means setting a file size of 1kb or even less than 1meg will generally be inaccurate.\r\n\r\nSee\r\nhttps://github.com/apache/iceberg/blob/04871b79e9aba02e9534498fa035b627bcb9af6e/core/src/main/java/org/apache/iceberg/io/RollingFileWriter.java#L96\r\n\r\nand\r\n\r\nhttps://github.com/apache/iceberg/blob/04871b79e9aba02e9534498fa035b627bcb9af6e/core/src/main/java/org/apache/iceberg/io/RollingFileWriter.java#L34\r\n\r\nIn general just know that you can't use file sizing for very tiny files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136702576/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136706252","html_url":"https://github.com/apache/iceberg/pull/4806#issuecomment-1136706252","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4806","id":1136706252,"node_id":"IC_kwDOCW7NX85DwMLM","user":{"login":"danielcweeks","id":4925077,"node_id":"MDQ6VXNlcjQ5MjUwNzc=","avatar_url":"https://avatars.githubusercontent.com/u/4925077?v=4","gravatar_id":"","url":"https://api.github.com/users/danielcweeks","html_url":"https://github.com/danielcweeks","followers_url":"https://api.github.com/users/danielcweeks/followers","following_url":"https://api.github.com/users/danielcweeks/following{/other_user}","gists_url":"https://api.github.com/users/danielcweeks/gists{/gist_id}","starred_url":"https://api.github.com/users/danielcweeks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielcweeks/subscriptions","organizations_url":"https://api.github.com/users/danielcweeks/orgs","repos_url":"https://api.github.com/users/danielcweeks/repos","events_url":"https://api.github.com/users/danielcweeks/events{/privacy}","received_events_url":"https://api.github.com/users/danielcweeks/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T04:15:30Z","updated_at":"2022-05-25T04:15:30Z","author_association":"CONTRIBUTOR","body":"@findepi Yeah, I agree that the existing implementation does not adhere to the `Iterable` interface contract. \r\n\r\nI just wasn't sure if this was breaking or just an improvement to address the contract.\r\n\r\nI'd be fine with either the Iterator or Stream approaches as it's explicit that it'll be traversed only once.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136706252/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136707279","html_url":"https://github.com/apache/iceberg/issues/2327#issuecomment-1136707279","issue_url":"https://api.github.com/repos/apache/iceberg/issues/2327","id":1136707279,"node_id":"IC_kwDOCW7NX85DwMbP","user":{"login":"ajantha-bhat","id":5889404,"node_id":"MDQ6VXNlcjU4ODk0MDQ=","avatar_url":"https://avatars.githubusercontent.com/u/5889404?v=4","gravatar_id":"","url":"https://api.github.com/users/ajantha-bhat","html_url":"https://github.com/ajantha-bhat","followers_url":"https://api.github.com/users/ajantha-bhat/followers","following_url":"https://api.github.com/users/ajantha-bhat/following{/other_user}","gists_url":"https://api.github.com/users/ajantha-bhat/gists{/gist_id}","starred_url":"https://api.github.com/users/ajantha-bhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajantha-bhat/subscriptions","organizations_url":"https://api.github.com/users/ajantha-bhat/orgs","repos_url":"https://api.github.com/users/ajantha-bhat/repos","events_url":"https://api.github.com/users/ajantha-bhat/events{/privacy}","received_events_url":"https://api.github.com/users/ajantha-bhat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T04:17:38Z","updated_at":"2022-05-25T04:17:38Z","author_association":"MEMBER","body":"This scenario is passing in the latest master. Probably https://github.com/apache/iceberg/pull/3411 fixed it.\r\n0.13.2 release and onwards will have this fix. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136707279/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136736105","html_url":"https://github.com/apache/iceberg/pull/4861#issuecomment-1136736105","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4861","id":1136736105,"node_id":"IC_kwDOCW7NX85DwTdp","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T05:16:36Z","updated_at":"2022-05-25T05:16:36Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews everyone!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136736105/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136740153","html_url":"https://github.com/apache/iceberg/pull/4825#issuecomment-1136740153","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4825","id":1136740153,"node_id":"IC_kwDOCW7NX85DwUc5","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T05:23:55Z","updated_at":"2022-05-25T05:33:27Z","author_association":"CONTRIBUTOR","body":"I’m not sure if you have seen this PR I opened today, but I noticed one of these tests fail in CI (details and link in PR summary). I opened the following PR for that test case (admittedly I forgot about this one so we can close mine if you’d like) - https://github.com/apache/iceberg/pull/4859\r\n\r\nTLDR - As suggested by Russell, for the test case in my PR, we changed the “olderThan” argument to be further in the future. The benefit being no unnecessary busy waiting and all of the files are still caught. I went with 5 seconds given that the solution in the other PR adds no busy waiting and that specific test removes _every_ orphan file so the olderThan argument doesn’t need to be very precise… just far enough “in the future” relative to the timestamp of the files that Spark writes to grab them all.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136740153/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136775409","html_url":"https://github.com/apache/iceberg/pull/4428#issuecomment-1136775409","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4428","id":1136775409,"node_id":"IC_kwDOCW7NX85DwdDx","user":{"login":"jackye1995","id":29823233,"node_id":"MDQ6VXNlcjI5ODIzMjMz","avatar_url":"https://avatars.githubusercontent.com/u/29823233?v=4","gravatar_id":"","url":"https://api.github.com/users/jackye1995","html_url":"https://github.com/jackye1995","followers_url":"https://api.github.com/users/jackye1995/followers","following_url":"https://api.github.com/users/jackye1995/following{/other_user}","gists_url":"https://api.github.com/users/jackye1995/gists{/gist_id}","starred_url":"https://api.github.com/users/jackye1995/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jackye1995/subscriptions","organizations_url":"https://api.github.com/users/jackye1995/orgs","repos_url":"https://api.github.com/users/jackye1995/repos","events_url":"https://api.github.com/users/jackye1995/events{/privacy}","received_events_url":"https://api.github.com/users/jackye1995/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T06:17:08Z","updated_at":"2022-05-25T06:17:08Z","author_association":"CONTRIBUTOR","body":"Can we separate this a bit to 3 parts:\r\n1. we need to definitely add `refs()` related APIs to `Table` related places\r\n2. we want to support `useTag` that is basically the same as `useSnapshot`\r\n3. we want to support `useBranch` that can be used in combination with `asOfTime`","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136775409/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136776132","html_url":"https://github.com/apache/iceberg/pull/4851#issuecomment-1136776132","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4851","id":1136776132,"node_id":"IC_kwDOCW7NX85DwdPE","user":{"login":"XN137","id":1204398,"node_id":"MDQ6VXNlcjEyMDQzOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1204398?v=4","gravatar_id":"","url":"https://api.github.com/users/XN137","html_url":"https://github.com/XN137","followers_url":"https://api.github.com/users/XN137/followers","following_url":"https://api.github.com/users/XN137/following{/other_user}","gists_url":"https://api.github.com/users/XN137/gists{/gist_id}","starred_url":"https://api.github.com/users/XN137/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/XN137/subscriptions","organizations_url":"https://api.github.com/users/XN137/orgs","repos_url":"https://api.github.com/users/XN137/repos","events_url":"https://api.github.com/users/XN137/events{/privacy}","received_events_url":"https://api.github.com/users/XN137/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T06:18:00Z","updated_at":"2022-05-25T06:18:00Z","author_association":"CONTRIBUTOR","body":"thanks for the reviews.\r\n\r\n> I would keep in mind that these changes are not the tests that got run as part of CI in this PR (github uses the current definition in master).\r\n\r\nis this really true?\r\nwhen i check the workflow runs on this PR i see all the latest action versions being used, for example:\r\n![Screenshot from 2022-05-25 08-15-38](https://user-images.githubusercontent.com/1204398/170193046-d1175740-03fa-42db-8ebb-082ea474dbbc.png)\r\nhttps://github.com/apache/iceberg/runs/6568370241?check_suite_focus=true\r\n\r\nAfaik only the labeler workflow isnt being exercised as part of this PR (so there is a very low risk of breaking it on merge, but I would be checking that right after).\r\n\r\n> Question about explicitly setting the ubuntu version: Why not just move to 22 now? Just to keep the changes somewhat separated?\r\n\r\nthe image is still in beta, see https://github.com/actions/virtual-environments/issues/5490\r\nwhile we could try upgrading, we should do so in a separate PR imo.\r\nas stated earlier the idea to avoid using \"ubuntu-latest\" is to have full control on when that upgrade happens (to make sure CI remains stable).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136776132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136780519","html_url":"https://github.com/apache/iceberg/pull/4443#issuecomment-1136780519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4443","id":1136780519,"node_id":"IC_kwDOCW7NX85DweTn","user":{"login":"rajarshisarkar","id":4561678,"node_id":"MDQ6VXNlcjQ1NjE2Nzg=","avatar_url":"https://avatars.githubusercontent.com/u/4561678?v=4","gravatar_id":"","url":"https://api.github.com/users/rajarshisarkar","html_url":"https://github.com/rajarshisarkar","followers_url":"https://api.github.com/users/rajarshisarkar/followers","following_url":"https://api.github.com/users/rajarshisarkar/following{/other_user}","gists_url":"https://api.github.com/users/rajarshisarkar/gists{/gist_id}","starred_url":"https://api.github.com/users/rajarshisarkar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajarshisarkar/subscriptions","organizations_url":"https://api.github.com/users/rajarshisarkar/orgs","repos_url":"https://api.github.com/users/rajarshisarkar/repos","events_url":"https://api.github.com/users/rajarshisarkar/events{/privacy}","received_events_url":"https://api.github.com/users/rajarshisarkar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T06:22:46Z","updated_at":"2022-05-25T06:22:46Z","author_association":"CONTRIBUTOR","body":"@samredai Yeah, makes sense to me.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136780519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136984014","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1136984014","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1136984014,"node_id":"IC_kwDOCW7NX85DxP_O","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T09:01:06Z","updated_at":"2022-05-25T09:01:06Z","author_association":"CONTRIBUTOR","body":"Hey @szehon-ho , your understanding about the issue is correct. We did some test of iterating all manifest entries and compute aggregated stats for each partition. We tried various queue sizes ranging from 5 to 10000. In our test the consumer is pretty fast, and even the smallest queue doesn't affect the e2e latency of the job. The result might be different in other use cases where the consumer is not fast enough, but my hunch is that such job latency is bounded by consumer anyway.\r\nOne problem I can think of is when we plan files for multiple tables concurrently. And if one of the consumers is slow, it might block all the threads in the thread pool and prevent other jobs from making progress. We're investigating how to limit the resource used by each job.\r\n\r\nIn production env, we do have a background service to rewrite manifest periodically. But such optimization is asynchronous, which means if users query the table before the rewrite is done, it can still cause OOM.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1136984014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137115312","html_url":"https://github.com/apache/iceberg/issues/4805#issuecomment-1137115312","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4805","id":1137115312,"node_id":"IC_kwDOCW7NX85DxwCw","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T11:17:26Z","updated_at":"2022-05-25T11:17:26Z","author_association":"CONTRIBUTOR","body":"I\r\n\r\n> > or we can link a 4.0.0 docker image where the users can try out Hive 4.0.0.\r\n> \r\n> Is this image already available or would we need to create one?\r\n\r\n@samredai: Talked with @kgyrtkirk and he kindly helped me with the commands:\r\n```\r\n# To download and start the Hive in a docker image\r\ndocker run --rm -p 10000:10000 --name hive4 -e HIVE_VERSION=4.0.0-alpha-1 -e TEZ_VERSION=0.10.1 -v hive-dev-box_work:/work kgyrtkirk/hive-dev-box:bazaar\r\n\r\n# After the pervious command is finished (it takes some time to download the image and start Hive)\r\n# In another terminal, to connect with BeeLine to Hive\r\ndocker exec -it hive4 /bin/bash --login -e safe_bl\r\n```\r\n\r\nAfter that you are ready to create Iceberg tables through Hive. I have tried a few commands and it seems working as excepted.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137115312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137184238","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1137184238","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1137184238,"node_id":"IC_kwDOCW7NX85DyA3u","user":{"login":"rice668","id":6520673,"node_id":"MDQ6VXNlcjY1MjA2NzM=","avatar_url":"https://avatars.githubusercontent.com/u/6520673?v=4","gravatar_id":"","url":"https://api.github.com/users/rice668","html_url":"https://github.com/rice668","followers_url":"https://api.github.com/users/rice668/followers","following_url":"https://api.github.com/users/rice668/following{/other_user}","gists_url":"https://api.github.com/users/rice668/gists{/gist_id}","starred_url":"https://api.github.com/users/rice668/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rice668/subscriptions","organizations_url":"https://api.github.com/users/rice668/orgs","repos_url":"https://api.github.com/users/rice668/repos","events_url":"https://api.github.com/users/rice668/events{/privacy}","received_events_url":"https://api.github.com/users/rice668/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T12:34:37Z","updated_at":"2022-05-25T12:34:37Z","author_association":"CONTRIBUTOR","body":"Is there anything worse than OOM in production env if we do not use a blocking queue ? We may be able to use another solution to limit the flow rather than blocking queue that may cause another bottleneck.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137184238/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137468615","html_url":"https://github.com/apache/iceberg/pull/4708#issuecomment-1137468615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4708","id":1137468615,"node_id":"IC_kwDOCW7NX85DzGTH","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T15:54:52Z","updated_at":"2022-05-25T15:54:52Z","author_association":"CONTRIBUTOR","body":"PR #4870 is one way to design the CDC scan. Let me know what everybody thinks.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137468615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137476589","html_url":"https://github.com/apache/iceberg/pull/4830#issuecomment-1137476589","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4830","id":1137476589,"node_id":"IC_kwDOCW7NX85DzIPt","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T16:02:23Z","updated_at":"2022-05-25T16:02:23Z","author_association":"CONTRIBUTOR","body":"Thanks for the reviews, @kbendick and @danielcweeks!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137476589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137482818","html_url":"https://github.com/apache/iceberg/pull/4744#issuecomment-1137482818","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4744","id":1137482818,"node_id":"IC_kwDOCW7NX85DzJxC","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T16:08:11Z","updated_at":"2022-05-25T16:08:11Z","author_association":"CONTRIBUTOR","body":"I'd be interested to take a look today as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137482818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137526561","html_url":"https://github.com/apache/iceberg/pull/4858#issuecomment-1137526561","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4858","id":1137526561,"node_id":"IC_kwDOCW7NX85DzUch","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T16:37:15Z","updated_at":"2022-05-25T16:37:15Z","author_association":"CONTRIBUTOR","body":"We need a `iceberg/openapi/__init__.py` file right?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137526561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137539332","html_url":"https://github.com/apache/iceberg/pull/4858#issuecomment-1137539332","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4858","id":1137539332,"node_id":"IC_kwDOCW7NX85DzXkE","user":{"login":"Fokko","id":1134248,"node_id":"MDQ6VXNlcjExMzQyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/1134248?v=4","gravatar_id":"","url":"https://api.github.com/users/Fokko","html_url":"https://github.com/Fokko","followers_url":"https://api.github.com/users/Fokko/followers","following_url":"https://api.github.com/users/Fokko/following{/other_user}","gists_url":"https://api.github.com/users/Fokko/gists{/gist_id}","starred_url":"https://api.github.com/users/Fokko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fokko/subscriptions","organizations_url":"https://api.github.com/users/Fokko/orgs","repos_url":"https://api.github.com/users/Fokko/repos","events_url":"https://api.github.com/users/Fokko/events{/privacy}","received_events_url":"https://api.github.com/users/Fokko/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T16:46:11Z","updated_at":"2022-05-25T16:46:11Z","author_association":"CONTRIBUTOR","body":"@samredai indeed, that's missing. Thanks for pointing out! 👍🏻 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137539332/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137617957","html_url":"https://github.com/apache/iceberg/pull/4848#issuecomment-1137617957","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4848","id":1137617957,"node_id":"IC_kwDOCW7NX85Dzqwl","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T17:36:27Z","updated_at":"2022-05-25T17:36:27Z","author_association":"MEMBER","body":"I blame all typos on the fact that I don't have my external monitor","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137617957/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137635703","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1137635703","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1137635703,"node_id":"IC_kwDOCW7NX85DzvF3","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T17:48:48Z","updated_at":"2022-05-25T17:51:03Z","author_association":"COLLABORATOR","body":"@rdblue @lirui-apache thanks for confirming,  so I think using 'rewriteManifest' and specifying the commit.manifest.target-size-byte to a reasonable size (so you have an even number of entries per manifest file), along with a system property: 'iceberg.worker.num-threads' to control how many manifests are read at once.  I wonder if that will help that memory problem?  \r\n\r\nSo overall, I would double-check how many entries you have per manifest, because it looks like it's parallelizing on the level on manifests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137635703/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137703889","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1137703889","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1137703889,"node_id":"IC_kwDOCW7NX85Dz_vR","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T18:39:37Z","updated_at":"2022-05-25T18:39:37Z","author_association":"CONTRIBUTOR","body":"Good idea setting the number of threads. It could easily be that you're processing too many manifests in parallel because of the number of threads.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137703889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137868400","html_url":"https://github.com/apache/iceberg/pull/4806#issuecomment-1137868400","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4806","id":1137868400,"node_id":"IC_kwDOCW7NX85D0n5w","user":{"login":"findepi","id":144328,"node_id":"MDQ6VXNlcjE0NDMyOA==","avatar_url":"https://avatars.githubusercontent.com/u/144328?v=4","gravatar_id":"","url":"https://api.github.com/users/findepi","html_url":"https://github.com/findepi","followers_url":"https://api.github.com/users/findepi/followers","following_url":"https://api.github.com/users/findepi/following{/other_user}","gists_url":"https://api.github.com/users/findepi/gists{/gist_id}","starred_url":"https://api.github.com/users/findepi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/findepi/subscriptions","organizations_url":"https://api.github.com/users/findepi/orgs","repos_url":"https://api.github.com/users/findepi/repos","events_url":"https://api.github.com/users/findepi/events{/privacy}","received_events_url":"https://api.github.com/users/findepi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T21:34:22Z","updated_at":"2022-05-25T21:34:22Z","author_association":"MEMBER","body":"> I'd be fine with either the Iterator or Stream approaches as it's explicit that it'll be traversed only once.\r\n\r\n@danielcweeks changed to Iterator.\r\n\r\nPTAL\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137868400/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137904161","html_url":"https://github.com/apache/iceberg/pull/4873#issuecomment-1137904161","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4873","id":1137904161,"node_id":"IC_kwDOCW7NX85D0woh","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T22:29:21Z","updated_at":"2022-05-25T22:29:21Z","author_association":"CONTRIBUTOR","body":"Also cc @danielcweeks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137904161/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137927767","html_url":"https://github.com/apache/iceberg/issues/4869#issuecomment-1137927767","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4869","id":1137927767,"node_id":"IC_kwDOCW7NX85D02ZX","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T23:00:07Z","updated_at":"2022-05-25T23:00:49Z","author_association":"CONTRIBUTOR","body":"@samredai made a wonderful blog post, with an associated docker-compose file, for using minio with Spark and Iceberg\r\n\r\nBlog Post: https://tabular.io/blog/minio/\r\nAssociated Repository with Docker Compose set up: https://github.com/tabular-io/docker-spark-iceberg","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137927767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137928913","html_url":"https://github.com/apache/iceberg/issues/4869#issuecomment-1137928913","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4869","id":1137928913,"node_id":"IC_kwDOCW7NX85D02rR","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-25T23:02:01Z","updated_at":"2022-05-25T23:02:01Z","author_association":"CONTRIBUTOR","body":"Not 100% sure what BKM means, but hopefully that answers your question! I'm going to close this issue, please feel free to reopen it or open a new issue with follow up questions if this doesn't resolve your issue @ming12713 🙂 ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1137928913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138007154","html_url":"https://github.com/apache/iceberg/pull/4873#issuecomment-1138007154","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4873","id":1138007154,"node_id":"IC_kwDOCW7NX85D1Jxy","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T00:17:48Z","updated_at":"2022-05-26T00:17:48Z","author_association":"CONTRIBUTOR","body":"Looks great! Thanks @kbendick. It's great to have this cleaned up. I've been wanting to do it for a long time now.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138007154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138096307","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1138096307","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1138096307,"node_id":"IC_kwDOCW7NX85D1fiz","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T03:00:11Z","updated_at":"2022-05-26T03:00:11Z","author_association":"CONTRIBUTOR","body":"Let me clarify our use case. We have an iceberg table partitioned by date, and we run an ETL job every day to sync data from an upstream hive table into this iceberg table. The ETL job basically just runs an `INSERT INTO` with SparkSQL which adds a new partition to the iceberg table. So we end up having a manifest for each partition, and each partition has lots of data files, i.e. ranging roughly from 50k to 130k.\r\nThen we have a trino cluster where users submit ad-hoc queries. This cluster is multi-tenant and not just meant for the iceberg table mentioned above.\r\nThe problem we faced was that querying this huge iceberg table can easily make the trino coordinator unstable or even crash with OOM.\r\n\r\nI'll check whether `commit.manifest.target-size-byte` can mitigate our case. But IIUC, the iceberg worker pool is static and shared among all jobs. So we probably won't want to change the pool size.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138096307/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138125090","html_url":"https://github.com/apache/iceberg/issues/4743#issuecomment-1138125090","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4743","id":1138125090,"node_id":"IC_kwDOCW7NX85D1mki","user":{"login":"lvyanquan","id":38547014,"node_id":"MDQ6VXNlcjM4NTQ3MDE0","avatar_url":"https://avatars.githubusercontent.com/u/38547014?v=4","gravatar_id":"","url":"https://api.github.com/users/lvyanquan","html_url":"https://github.com/lvyanquan","followers_url":"https://api.github.com/users/lvyanquan/followers","following_url":"https://api.github.com/users/lvyanquan/following{/other_user}","gists_url":"https://api.github.com/users/lvyanquan/gists{/gist_id}","starred_url":"https://api.github.com/users/lvyanquan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lvyanquan/subscriptions","organizations_url":"https://api.github.com/users/lvyanquan/orgs","repos_url":"https://api.github.com/users/lvyanquan/repos","events_url":"https://api.github.com/users/lvyanquan/events{/privacy}","received_events_url":"https://api.github.com/users/lvyanquan/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T03:54:18Z","updated_at":"2022-05-26T03:54:18Z","author_association":"CONTRIBUTOR","body":"I got this error too, and I found that It may be  incompatible when you using  iceberg-flink-runtime-1.14-0.13.1.jar and flink-sql-connector-hive-3.1.2_2.12-1.14.4.jar  at the same time. You could try only put one single jar at $FLINK_HOME/lib when using SQL Client once at a time. ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138125090/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138132462","html_url":"https://github.com/apache/iceberg/pull/4795#issuecomment-1138132462","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4795","id":1138132462,"node_id":"IC_kwDOCW7NX85D1oXu","user":{"login":"CodingCat","id":678008,"node_id":"MDQ6VXNlcjY3ODAwOA==","avatar_url":"https://avatars.githubusercontent.com/u/678008?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingCat","html_url":"https://github.com/CodingCat","followers_url":"https://api.github.com/users/CodingCat/followers","following_url":"https://api.github.com/users/CodingCat/following{/other_user}","gists_url":"https://api.github.com/users/CodingCat/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingCat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingCat/subscriptions","organizations_url":"https://api.github.com/users/CodingCat/orgs","repos_url":"https://api.github.com/users/CodingCat/repos","events_url":"https://api.github.com/users/CodingCat/events{/privacy}","received_events_url":"https://api.github.com/users/CodingCat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T04:10:12Z","updated_at":"2022-05-26T04:10:12Z","author_association":"CONTRIBUTOR","body":"ping @kbendick @rdblue ?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138132462/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138139258","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1138139258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1138139258,"node_id":"IC_kwDOCW7NX85D1qB6","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T04:24:07Z","updated_at":"2022-05-26T04:24:07Z","author_association":"CONTRIBUTOR","body":"@szehon-ho Do you have an example in mind where blocking queue can hurt performance? IMHO, if a blocking queue blocks the producers, it usually means the consumer is not fast enough, in which case the bottleneck is the consumer, rather than the queue itself.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138139258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138172352","html_url":"https://github.com/apache/iceberg/pull/4873#issuecomment-1138172352","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4873","id":1138172352,"node_id":"IC_kwDOCW7NX85D1yHA","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T05:36:40Z","updated_at":"2022-05-26T05:36:40Z","author_association":"CONTRIBUTOR","body":"> Looks great! Thanks @kbendick. It's great to have this cleaned up. I've been wanting to do it for a long time now.\r\n\r\nThanks @rdblue. This makes a lot of sense to me as well, as the TableMetadata should be transmissible in a way that doesn’t immediately couple itself to the FileSystem (or choice of FileIO etc).\r\n\r\nI know it seems like a large change but it’s really mostly just tests and the FileIO is already properly serialized for Kryo etc where need be. So the change isn’t nearly as large as it seems.\r\n\r\n**Question**: Should I update tests and code for earlier Spark versions and Flink versions in this PR or in another? It would make code maintenance simpler to keep other versions in sync (either here or in another PR). But happy to slice the PRs however is deemed best.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138172352/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138174752","html_url":"https://github.com/apache/iceberg/issues/4869#issuecomment-1138174752","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4869","id":1138174752,"node_id":"IC_kwDOCW7NX85D1ysg","user":{"login":"ming12713","id":5196113,"node_id":"MDQ6VXNlcjUxOTYxMTM=","avatar_url":"https://avatars.githubusercontent.com/u/5196113?v=4","gravatar_id":"","url":"https://api.github.com/users/ming12713","html_url":"https://github.com/ming12713","followers_url":"https://api.github.com/users/ming12713/followers","following_url":"https://api.github.com/users/ming12713/following{/other_user}","gists_url":"https://api.github.com/users/ming12713/gists{/gist_id}","starred_url":"https://api.github.com/users/ming12713/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ming12713/subscriptions","organizations_url":"https://api.github.com/users/ming12713/orgs","repos_url":"https://api.github.com/users/ming12713/repos","events_url":"https://api.github.com/users/ming12713/events{/privacy}","received_events_url":"https://api.github.com/users/ming12713/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T05:41:38Z","updated_at":"2022-05-26T05:41:38Z","author_association":"NONE","body":"@kbendick thanks a lot","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138174752/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138175407","html_url":"https://github.com/apache/iceberg/issues/4869#issuecomment-1138175407","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4869","id":1138175407,"node_id":"IC_kwDOCW7NX85D1y2v","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T05:42:58Z","updated_at":"2022-05-26T05:42:58Z","author_association":"CONTRIBUTOR","body":"Yeah no problem. Happy to pass the info along. Many thanks to Sam for providing the great resource.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138175407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138182806","html_url":"https://github.com/apache/iceberg/pull/4841#issuecomment-1138182806","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4841","id":1138182806,"node_id":"IC_kwDOCW7NX85D10qW","user":{"login":"lcspinter","id":47777102,"node_id":"MDQ6VXNlcjQ3Nzc3MTAy","avatar_url":"https://avatars.githubusercontent.com/u/47777102?v=4","gravatar_id":"","url":"https://api.github.com/users/lcspinter","html_url":"https://github.com/lcspinter","followers_url":"https://api.github.com/users/lcspinter/followers","following_url":"https://api.github.com/users/lcspinter/following{/other_user}","gists_url":"https://api.github.com/users/lcspinter/gists{/gist_id}","starred_url":"https://api.github.com/users/lcspinter/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lcspinter/subscriptions","organizations_url":"https://api.github.com/users/lcspinter/orgs","repos_url":"https://api.github.com/users/lcspinter/repos","events_url":"https://api.github.com/users/lcspinter/events{/privacy}","received_events_url":"https://api.github.com/users/lcspinter/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T05:56:53Z","updated_at":"2022-05-26T05:56:53Z","author_association":"CONTRIBUTOR","body":"@kbendick I might be able to generate some binary data files with an older version of Impala and write some tests on reading those. Though, I'm not sure if it's a good practice to check in a data set generated by a 3rd party tool, rather than generating it in place. I would like to hear your opinion. Thanks","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138182806/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138187650","html_url":"https://github.com/apache/iceberg/issues/4862#issuecomment-1138187650","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4862","id":1138187650,"node_id":"IC_kwDOCW7NX85D112C","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T06:06:11Z","updated_at":"2022-05-26T06:08:56Z","author_association":"CONTRIBUTOR","body":"Thanks for the report @AndrewJudson! We are going through a coming docs refactor.\r\n\r\nIm by no means a UI / front end dev, but can you clarify what you mean by medium width? Forgive my ignorance. And is this web (if so which browser) or mobile (if so in portrait or landscape and whatever relevant info to help me wrap my mind around medium)?\r\n\r\nWe’re hoping the updated docs site will resolve some of these issues, but if you’re interested in helping in that area, I’d LOVE to be of assistance in helping you get connected with the right people and help you get reviews etc.\r\n\r\nThe docs are built with Hugo, from `/docs` and primarily from the main docs repo, https://www.github.com/apache/iceberg-docs . If front end is at all within your skill set or interests, I’d be happy to help in any way possible get you set up to contribute. No pressure, but it’s a great way to get involved / familiar with the project and community and always appreciated!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138187650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138192430","html_url":"https://github.com/apache/iceberg/issues/4849#issuecomment-1138192430","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4849","id":1138192430,"node_id":"IC_kwDOCW7NX85D13Au","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T06:13:58Z","updated_at":"2022-05-26T06:15:41Z","author_association":"CONTRIBUTOR","body":"Thanks for reporting this @schatterjee10.\r\n\r\nI’d be open to a quick demo PR, but I do worry about trying to be very “smart” with casting rules. We do allow for “incompatible” schema updates to be made, but this would require casting the data afaik and `mergeSchema` should really err on the side of caution in my opinion.\r\n\r\nThat said, if you have a sample draft POC to show this is possible, I think we’d be willing to take a look to consider it. Again though, to be really correct the data should be stored in the files as long (in my opinion) and should likely be casted.\r\n\r\nBut I will admit I’m not super familiar with this code so if it can be easily resolved, feel free to present it or discuss it. But in general, I’m hesitant about overriding the built in rules about dangerous casting. Eventually, I worry it will come back to bite us.\r\n\r\nWe also don’t want to get into the business of having a large set of overrides and logic for compatibility checks. And added casts.\r\n\r\nI’m just one person so others might disagree, but that’s my 2 cents fwiw. 🙂 \r\n\r\nMay I ask how much you felt on `mergeSchema` and how often issues like this occur for you?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138192430/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138197433","html_url":"https://github.com/apache/iceberg/issues/4849#issuecomment-1138197433","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4849","id":1138197433,"node_id":"IC_kwDOCW7NX85D14O5","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T06:21:14Z","updated_at":"2022-05-26T06:23:17Z","author_association":"CONTRIBUTOR","body":"For what it’s worth, here’s the original PR that added support.\r\n\r\nThere’s a function in `SparkSchemaUtils` it seems you can look into to check viability / ease of adding this change: This method and line in particular should be a decent jumping off point: https://github.com/apache/iceberg/commit/69c06cead6e5ddfe58c17630c4863eb98e04ff4e#diff-9eb9256d82cd6ab19f73c941a7011ff4973eb61255c7fee0b38402f922a2e48cR239","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138197433/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138247539","html_url":"https://github.com/apache/iceberg/pull/4873#issuecomment-1138247539","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4873","id":1138247539,"node_id":"IC_kwDOCW7NX85D2Edz","user":{"login":"nastra","id":271029,"node_id":"MDQ6VXNlcjI3MTAyOQ==","avatar_url":"https://avatars.githubusercontent.com/u/271029?v=4","gravatar_id":"","url":"https://api.github.com/users/nastra","html_url":"https://github.com/nastra","followers_url":"https://api.github.com/users/nastra/followers","following_url":"https://api.github.com/users/nastra/following{/other_user}","gists_url":"https://api.github.com/users/nastra/gists{/gist_id}","starred_url":"https://api.github.com/users/nastra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nastra/subscriptions","organizations_url":"https://api.github.com/users/nastra/orgs","repos_url":"https://api.github.com/users/nastra/repos","events_url":"https://api.github.com/users/nastra/events{/privacy}","received_events_url":"https://api.github.com/users/nastra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T07:26:12Z","updated_at":"2022-05-26T07:26:12Z","author_association":"CONTRIBUTOR","body":"@kbendick thanks, I'll review on monday but if anything comes up we could just do a follow-up, so no need to block on merging this.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138247539/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138324281","html_url":"https://github.com/apache/iceberg/issues/4805#issuecomment-1138324281","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4805","id":1138324281,"node_id":"IC_kwDOCW7NX85D2XM5","user":{"login":"pvary","id":19705742,"node_id":"MDQ6VXNlcjE5NzA1NzQy","avatar_url":"https://avatars.githubusercontent.com/u/19705742?v=4","gravatar_id":"","url":"https://api.github.com/users/pvary","html_url":"https://github.com/pvary","followers_url":"https://api.github.com/users/pvary/followers","following_url":"https://api.github.com/users/pvary/following{/other_user}","gists_url":"https://api.github.com/users/pvary/gists{/gist_id}","starred_url":"https://api.github.com/users/pvary/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvary/subscriptions","organizations_url":"https://api.github.com/users/pvary/orgs","repos_url":"https://api.github.com/users/pvary/repos","events_url":"https://api.github.com/users/pvary/events{/privacy}","received_events_url":"https://api.github.com/users/pvary/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T09:05:51Z","updated_at":"2022-05-26T09:05:51Z","author_association":"CONTRIBUTOR","body":"@samredai: How could we proceed with merging the Hive documentation to the site?\r\nCan we create the new pages, or you can create the new pages and link them, and we just add the code there?\r\n\r\nThanks,\r\nPeter","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138324281/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138432765","html_url":"https://github.com/apache/iceberg/pull/4865#issuecomment-1138432765","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4865","id":1138432765,"node_id":"IC_kwDOCW7NX85D2xr9","user":{"login":"wuwenchi","id":19755729,"node_id":"MDQ6VXNlcjE5NzU1NzI5","avatar_url":"https://avatars.githubusercontent.com/u/19755729?v=4","gravatar_id":"","url":"https://api.github.com/users/wuwenchi","html_url":"https://github.com/wuwenchi","followers_url":"https://api.github.com/users/wuwenchi/followers","following_url":"https://api.github.com/users/wuwenchi/following{/other_user}","gists_url":"https://api.github.com/users/wuwenchi/gists{/gist_id}","starred_url":"https://api.github.com/users/wuwenchi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuwenchi/subscriptions","organizations_url":"https://api.github.com/users/wuwenchi/orgs","repos_url":"https://api.github.com/users/wuwenchi/repos","events_url":"https://api.github.com/users/wuwenchi/events{/privacy}","received_events_url":"https://api.github.com/users/wuwenchi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T11:28:38Z","updated_at":"2022-05-26T11:28:38Z","author_association":"CONTRIBUTOR","body":"> There’s also an iceberg-docs repo, github.com/apache/iceberg-docs. \r\n\r\nAfter this PR is completed, I will provide a PR to iceberg-docs.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138432765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138440712","html_url":"https://github.com/apache/iceberg/pull/4734#issuecomment-1138440712","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4734","id":1138440712,"node_id":"IC_kwDOCW7NX85D2zoI","user":{"login":"hililiwei","id":59213263,"node_id":"MDQ6VXNlcjU5MjEzMjYz","avatar_url":"https://avatars.githubusercontent.com/u/59213263?v=4","gravatar_id":"","url":"https://api.github.com/users/hililiwei","html_url":"https://github.com/hililiwei","followers_url":"https://api.github.com/users/hililiwei/followers","following_url":"https://api.github.com/users/hililiwei/following{/other_user}","gists_url":"https://api.github.com/users/hililiwei/gists{/gist_id}","starred_url":"https://api.github.com/users/hililiwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hililiwei/subscriptions","organizations_url":"https://api.github.com/users/hililiwei/orgs","repos_url":"https://api.github.com/users/hililiwei/repos","events_url":"https://api.github.com/users/hililiwei/events{/privacy}","received_events_url":"https://api.github.com/users/hililiwei/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T11:39:45Z","updated_at":"2022-05-26T11:39:56Z","author_association":"CONTRIBUTOR","body":"> Hi @hililiwei! Can you update the PR description, now that this PR is not updating the ORC version?\r\n\r\n updated","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138440712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138615924","html_url":"https://github.com/apache/iceberg/pull/4868#issuecomment-1138615924","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4868","id":1138615924,"node_id":"IC_kwDOCW7NX85D3eZ0","user":{"login":"szlta","id":40628386,"node_id":"MDQ6VXNlcjQwNjI4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/40628386?v=4","gravatar_id":"","url":"https://api.github.com/users/szlta","html_url":"https://github.com/szlta","followers_url":"https://api.github.com/users/szlta/followers","following_url":"https://api.github.com/users/szlta/following{/other_user}","gists_url":"https://api.github.com/users/szlta/gists{/gist_id}","starred_url":"https://api.github.com/users/szlta/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szlta/subscriptions","organizations_url":"https://api.github.com/users/szlta/orgs","repos_url":"https://api.github.com/users/szlta/repos","events_url":"https://api.github.com/users/szlta/events{/privacy}","received_events_url":"https://api.github.com/users/szlta/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T14:06:20Z","updated_at":"2022-05-26T14:06:20Z","author_association":"CONTRIBUTOR","body":"Hi @kbendick , thanks a lot for taking a look.\r\n\r\nYes you're right, this issue does need a discussion. Originally I observed this in https://github.com/apache/iceberg/pull/4662#issuecomment-1125098416 where one unit test kept on failing and shed light on this discrepancy within Iceberg code in how PartitionFIeld names are generated. \r\n\r\n\r\n> My immediate concern is that if an engine is currently generating columns in one style, and begins to generate them in another, this could be a very breaking change for people's tables.\r\n\r\nI think in practice we were already using the version where transform arguments were appended to the partition field names. This is done by `BaseUpdatePartitionSpec.java`. The other method of generating the default names in `PartitionSpec$Builder` is mostly used by test code only with the one exception of Spark3Util. Well in Iceberg code right.. .. this is a public class with public methods in iceberg-api, so we will want to be careful with it, e.g. Hive calls this too.\r\n\r\n> Additionally, if we append the number of buckets / truncation width at the end of the generated column name, are we opening ourselves up to the possibility that users will be able to partition twice on the same column using the same transform (e.g. bucket_data_6 and bucket_data_8 within the same partition spec)?\r\n\r\nIs there a limitation to do this? I think the API already allows doing this by specifying the target name. My change here alters the default naming convention. I think it is a possible scenario that data_bucket_2 and data_bucket_4 are both part of the spec as the structure will be a nested one. It's probably not useful for the majority of scenarios but nevertheless the option is there.\r\n\r\nAbout your question on how the integrating engines would be affected - I'd like contributors for each engine to chime in. I can only speak for Hive. In Hive we currently generate the \"arg-less\" version of the partition name during table creation. On the other hand if we alter the spec later then the \"arg-ful\" version will kick in.\r\nE.g.:\r\n```\r\ncreate external table ptest (a string, b int) partitioned by spec (bucket(16, a)) stored by iceberg;\r\nalter table ptest set partition spec (bucket(16, a), bucket(2, b));\r\ndescribe default.ptest.partitions;\r\n+---------------+--------------------------------------+----------+\r\n|   col_name    |              data_type               | comment  |\r\n+---------------+--------------------------------------+----------+\r\n| partition     | struct<a_bucket:int,b_bucket_2:int>  |          |\r\n| record_count  | bigint                               |          |\r\n| file_count    | int                                  |          |\r\n| spec_id       | int                                  |          |\r\n+---------------+--------------------------------------+----------+\r\n```\r\ndoesn't look too nice, does it? But I think we're still early enough to unify these names in Hive.\r\n\r\nPerhaps we could also annotate the current PartitionSpec$Builder as deprecated and create a new version of it, that will already be the unified implementation, and hook unit tests, and everything else within Iceberg codebase to that. Then we can give 1-2 release worth of time before we remove the original implementation, so at least we won't cause an immediate backward incompatibility problem.\r\n\r\nDo let me know your thoughts.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138615924/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138629330","html_url":"https://github.com/apache/iceberg/pull/4644#issuecomment-1138629330","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4644","id":1138629330,"node_id":"IC_kwDOCW7NX85D3hrS","user":{"login":"Zephyr589","id":74643176,"node_id":"MDQ6VXNlcjc0NjQzMTc2","avatar_url":"https://avatars.githubusercontent.com/u/74643176?v=4","gravatar_id":"","url":"https://api.github.com/users/Zephyr589","html_url":"https://github.com/Zephyr589","followers_url":"https://api.github.com/users/Zephyr589/followers","following_url":"https://api.github.com/users/Zephyr589/following{/other_user}","gists_url":"https://api.github.com/users/Zephyr589/gists{/gist_id}","starred_url":"https://api.github.com/users/Zephyr589/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Zephyr589/subscriptions","organizations_url":"https://api.github.com/users/Zephyr589/orgs","repos_url":"https://api.github.com/users/Zephyr589/repos","events_url":"https://api.github.com/users/Zephyr589/events{/privacy}","received_events_url":"https://api.github.com/users/Zephyr589/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T14:18:53Z","updated_at":"2022-05-26T14:18:53Z","author_association":"CONTRIBUTOR","body":"@openinx Never mind ,thanks for your review.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138629330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138639623","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1138639623","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1138639623,"node_id":"IC_kwDOCW7NX85D3kMH","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T14:28:35Z","updated_at":"2022-05-26T14:28:35Z","author_association":"CONTRIBUTOR","body":"@lirui-apache, another option here is to add the ability to set parallelism on a per-table basis. Basically to prevent the parallel iterator from submitting so many tasks at once. That may help your situation.\r\n\r\nThat said, I still think the main problem is that your partitions have 50-130k files. Have you tried compacting those?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138639623/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138645962","html_url":"https://github.com/apache/iceberg/issues/4804#issuecomment-1138645962","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4804","id":1138645962,"node_id":"IC_kwDOCW7NX85D3lvK","user":{"login":"akshayar","id":9114243,"node_id":"MDQ6VXNlcjkxMTQyNDM=","avatar_url":"https://avatars.githubusercontent.com/u/9114243?v=4","gravatar_id":"","url":"https://api.github.com/users/akshayar","html_url":"https://github.com/akshayar","followers_url":"https://api.github.com/users/akshayar/followers","following_url":"https://api.github.com/users/akshayar/following{/other_user}","gists_url":"https://api.github.com/users/akshayar/gists{/gist_id}","starred_url":"https://api.github.com/users/akshayar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akshayar/subscriptions","organizations_url":"https://api.github.com/users/akshayar/orgs","repos_url":"https://api.github.com/users/akshayar/repos","events_url":"https://api.github.com/users/akshayar/events{/privacy}","received_events_url":"https://api.github.com/users/akshayar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T14:35:01Z","updated_at":"2022-05-26T15:25:50Z","author_association":"NONE","body":"> 1. aws.accessKeyId\r\n\r\n1. When I pass the aws.accessKeyId and aws.secretAccessKey then it works. \r\n2. Non Iceberg program works.  For example HUDI streaming job works without passing access key and secret access key. \r\nThe steps for job submit are provided at https://github.com/akshayar/emr-on-eks-samples/blob/main/ICEBERG-SAMPLE-KINESIS.md","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138645962/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138669016","html_url":"https://github.com/apache/iceberg/pull/4873#issuecomment-1138669016","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4873","id":1138669016,"node_id":"IC_kwDOCW7NX85D3rXY","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T14:56:42Z","updated_at":"2022-05-26T14:56:42Z","author_association":"CONTRIBUTOR","body":"> Should I update tests and code for earlier Spark versions and Flink versions in this PR or in another?\r\n\r\nI think in another PR would be best.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138669016/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138669358","html_url":"https://github.com/apache/iceberg/pull/4873#issuecomment-1138669358","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4873","id":1138669358,"node_id":"IC_kwDOCW7NX85D3rcu","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T14:57:04Z","updated_at":"2022-05-26T14:57:04Z","author_association":"CONTRIBUTOR","body":"Thanks, @kbendick! I merged this so we can move on to the follow-ups.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138669358/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138691153","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1138691153","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1138691153,"node_id":"IC_kwDOCW7NX85D3wxR","user":{"login":"lirui-apache","id":5210788,"node_id":"MDQ6VXNlcjUyMTA3ODg=","avatar_url":"https://avatars.githubusercontent.com/u/5210788?v=4","gravatar_id":"","url":"https://api.github.com/users/lirui-apache","html_url":"https://github.com/lirui-apache","followers_url":"https://api.github.com/users/lirui-apache/followers","following_url":"https://api.github.com/users/lirui-apache/following{/other_user}","gists_url":"https://api.github.com/users/lirui-apache/gists{/gist_id}","starred_url":"https://api.github.com/users/lirui-apache/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lirui-apache/subscriptions","organizations_url":"https://api.github.com/users/lirui-apache/orgs","repos_url":"https://api.github.com/users/lirui-apache/repos","events_url":"https://api.github.com/users/lirui-apache/events{/privacy}","received_events_url":"https://api.github.com/users/lirui-apache/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T15:18:36Z","updated_at":"2022-05-26T15:18:36Z","author_association":"CONTRIBUTOR","body":"@rdblue Thanks for the advice. Actually it's not a small-file problem. Each partition has over 200 billion records. We do have optimizations to make sure each query only scans a small portion. But it cannot help if we hit OOM at the planning phase.\r\n\r\nI also noticed latest code supports planning files with separate pools. So with separate pools + limited manifest entries + limited pool size, I think we can bring the memory usage under control. Although personally I still prefer the blocking queue solution, which seems easier to achieve and more reliable.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138691153/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138704180","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1138704180","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1138704180,"node_id":"IC_kwDOCW7NX85D3z80","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T15:31:29Z","updated_at":"2022-05-26T15:31:29Z","author_association":"CONTRIBUTOR","body":"@lirui-apache, the files should be added to the queue after being filtered. Won't you need to hold all these files in memory at some point anyway? Or are you avoiding that somehow?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138704180/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138712534","html_url":"https://github.com/apache/iceberg/pull/4795#issuecomment-1138712534","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4795","id":1138712534,"node_id":"IC_kwDOCW7NX85D31_W","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T15:38:35Z","updated_at":"2022-05-26T15:38:35Z","author_association":"CONTRIBUTOR","body":"@CodingCat, I don't think there is currently an option to add metadata to a commit like that. Even if there were, I'm not sure it would help in this situation. The problem is that Spark has no way to pass properties to SQL commands like DELETE and MERGE. That only works with the DataFrame methods. The approach you linked to doesn't work because that is in the SQLConf, which is at the session level. You'd need a separate session for every writer thread. If that's what you'd like to do, then we can help you get that feature in. Is that what you want?\r\n\r\nI think that we may want to introduce a different way than using write properties to set additional metadata, because of the SQL problem. We could add a way to pass this information, like this:\r\n\r\n```java\r\n  public class CommitMetadata {\r\n    private static final ThreadLocal<Map<String, String>> COMMIT_PROPERTIES = ThreadLocal.withInitial(ImmutableMap::of);\r\n\r\n    public static <R> R withCommitProperties(Map<String, String> properties, Callable<R> callable) throws Exception {\r\n      COMMIT_PROPERTIES.set(properties);\r\n      try {\r\n        return callable.call();\r\n      } finally {\r\n        COMMIT_PROPERTIES.set(ImmutableMap.of());\r\n      }\r\n    }\r\n\r\n    static Map<String, String> commitProperties() {\r\n      return COMMIT_PROPERTIES.get();\r\n    }\r\n  }\r\n```\r\n\r\nThen we would update the Spark commit path to use add the properties from that class. What do you think?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138712534/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138731340","html_url":"https://github.com/apache/iceberg/pull/4683#issuecomment-1138731340","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4683","id":1138731340,"node_id":"IC_kwDOCW7NX85D36lM","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T15:59:27Z","updated_at":"2022-05-26T15:59:27Z","author_association":"CONTRIBUTOR","body":"Let me take another look too. Sorry for the delay.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138731340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138757290","html_url":"https://github.com/apache/iceberg/pull/4873#issuecomment-1138757290","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4873","id":1138757290,"node_id":"IC_kwDOCW7NX85D4A6q","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T16:28:11Z","updated_at":"2022-05-26T16:28:11Z","author_association":"CONTRIBUTOR","body":"> @kbendick thanks, I'll review on monday but if anything comes up we could just do a follow-up, so no need to block on merging this.\r\n\r\nCool. Let me know if there's anything in particular you'd like to go over or have any questions on as I believe this will benefit you as well.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138757290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138763211","html_url":"https://github.com/apache/iceberg/pull/4443#issuecomment-1138763211","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4443","id":1138763211,"node_id":"IC_kwDOCW7NX85D4CXL","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T16:34:51Z","updated_at":"2022-05-26T16:35:12Z","author_association":"CONTRIBUTOR","body":"Added to the configurations page PR: https://github.com/apache/iceberg/pull/4801/files#diff-947e999f40ea405c702496fc987ab2c322222d2488680be54ddfa3447c3569faR155-R158","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138763211/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138764553","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1138764553","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1138764553,"node_id":"IC_kwDOCW7NX85D4CsJ","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T16:36:26Z","updated_at":"2022-05-26T18:36:16Z","author_association":"COLLABORATOR","body":"Yea , good idea to adding plan parallelism per table if not there already (it might be in Flink but not Spark)\r\n\r\nYea, also curious, in Spark it seems the FileScanTask iterator in the end gets into a concrete array, though I guess its possible in custom code to consume the FileScanTask directly in streaming fashion","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138764553/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138767414","html_url":"https://github.com/apache/iceberg/pull/4868#issuecomment-1138767414","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4868","id":1138767414,"node_id":"IC_kwDOCW7NX85D4DY2","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T16:39:47Z","updated_at":"2022-05-26T16:39:47Z","author_association":"CONTRIBUTOR","body":"I don't see much benefit to making this change. What is the underlying problem you're trying to solve? Changing 40 files just to make a slight change to field names in metadata tables doesn't seem worth it.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138767414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138768406","html_url":"https://github.com/apache/iceberg/pull/4860#issuecomment-1138768406","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4860","id":1138768406,"node_id":"IC_kwDOCW7NX85D4DoW","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T16:41:08Z","updated_at":"2022-05-26T16:41:08Z","author_association":"CONTRIBUTOR","body":"> LGTM !!\r\n> \r\n> Found [RemoveSnapshotRef](https://github.com/apache/iceberg/blob/master/core/src/main/java/org/apache/iceberg/MetadataUpdate.java#L218-#L233) also missing, added a [PR](https://github.com/apache/iceberg/pull/4866) for the same.\r\n\r\nGood catch. That was actually the main one I was thinking of.\r\n\r\nThis one is actually _not_ as important. The use case for this is actually just if people have very old table's that _don't_ already have UUID in them. I wrote the issue comment in a rush and completely misrepresented it.\r\n\r\nI am going to close this PR in favor of adding `RemoveSnapshotRef` (which is the one I was looking for). This class is mostly available in case some 3rd party needs to add UUIDs to existing tables, or make table UUIDs meet their internal standards (not something I myself use, hence the confusion).\r\n\r\nIn an effort to keep the open api spec consumable, we've decided to leave this class out as it's really just in the off chance somebody has very very old tables that haven't been touched in a while but need to add UUIDs for them. Or some third party finds a use case for it to match their internal systems (of which I don't know any).\r\n\r\nSo thanks for the find @singhpk234. As mentioned, RemoveSnapshotRef was actually the one I was thinking of when I made this issue.\r\n\r\nI'lll be writing a lot of documentation on the REST catalog coming up. (I also submitted for a talk on it to ApacheCon so if that gets accepted there will likely be more documentation than anybody wants on the subject). Cheers.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138768406/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138771607","html_url":"https://github.com/apache/iceberg/issues/4828#issuecomment-1138771607","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4828","id":1138771607,"node_id":"IC_kwDOCW7NX85D4EaX","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T16:45:17Z","updated_at":"2022-05-26T16:45:17Z","author_association":"CONTRIBUTOR","body":"In an effort to keep the OpenAPI spec slimmed down, and because this class isn't implemented, we've decided to not add it for the moment.\r\n\r\nThe use case for `AssignUUID` is almost somewhat theoretical. If people have tables that are _very_ old (e.g. from the 0.9.x days or from when the project was incubating), they might not have UUIDs (as the spec initially didn't call for them).\r\n\r\nBecause we don't think this will be a common use case within OSS (nor within any of my own work), for simplicities sake we've decided to leave it out. That's also why the logic is not fully implemented.\r\n\r\nIf somebody eventually _does_ need this (e.g. for registering tables or for updating table UUIDs for some reason other than during a normal commit workflow), then we can also add it to the spec. As @singhpk234 pointed out, the class I was actually looking for was `RemoveSnapshotRef`.\r\n\r\nMaybe Prashant should just take over my job for me 🙈.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138771607/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138828561","html_url":"https://github.com/apache/iceberg/issues/4875#issuecomment-1138828561","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4875","id":1138828561,"node_id":"IC_kwDOCW7NX85D4SUR","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T17:30:32Z","updated_at":"2022-05-26T17:40:46Z","author_association":"CONTRIBUTOR","body":"Hi @Cqz666! So it's hard for me to comment on the time it takes for your Spark job to complete, as I'm not sure how much resources you have etc. Also, it does look like you have _many_ small files that are getting compacted.\r\n\r\nA few things I would suggest for making your compactions faster (as well as speeding up your ingest somewhat).\r\n\r\nFirst off, you can see many relevent configuration keys by looking at this code here: https://github.com/apache/iceberg/blob/128d5a161fda076118a7cab1d95ab5064400e08a/spark/v3.2/spark/src/main/java/org/apache/iceberg/spark/actions/BaseRewriteDataFilesSparkAction.java#L79-L87 . I would suggest that you download the project, import it into IntelliJ, and then jump around from there to look at relevant configs. As well as looking at the unit tests.\r\n\r\n\r\nAs for things you can do to speed up the process:\r\n\r\n1. Using avro for the Flink ingestion part, then rewriting the files as parquet.\r\n    - This might be something you don't want to tackle right away (it's a large change to your pipeline), but parquet files are somewhat inefficient at such a small size, because they need things like their footer and row groups, which can increase file size. With so little data per file, using Avro might be better recommended.\r\n    - This is completely allowed, as tables can have a mixture of file formats. I would suggest, if Flink is the primary writer to this job, setting the tables `write.format.default` to `avro` and then overriding that in the `options` when using Spark. Please try this on a non-production table first.\r\n2. Breaking the job into several commit groups.\r\n    - By default, compaction jobs write all of their newly written files in _one_ commit of up to 100GB per group. You might consider using the configuration `partial-progress.enabled` se to `true` to allow for work to be committed in more batches. This will cause the data to be committed in up to 10 groups by default, helping you reduce the amount of work that needs to be redone if the underlying table has changed. There's on-going work for smarter detection of change sets so less work needs to be replayed if another writer has committed to the table.\r\n 3. WIth `partial-progress.enabled`, if you have a relatively large Spark cluster, you can also set the `max-concurrent-file-group-rewrites` to a value greater than 1, so that jobs will be submitted in parallel (similar to how you tried), but hopefully without getting that error. Keep in mind you likely need a pretty large cluster for this as each file grouo can be up to 100GB (though if you have less data than that per group because of the partitioning, then each file rewrite group will likely be less than 100GB). Be sure to give your Spark driver enough cores to manage all of the concurrent metadata from the parallel rewrite jobs. I think for you, this will help the most as your rewrite jobs seem to be only taking about a minute each. So parallelizing them is definitely the way to go.\r\n 4. Worth mentioning, but if you do enable `partial-progress`, given how large your data is for the day, you'll also want to set `partial-progress.max-commits` to a value greater than 10  (so that you can have more than 10 total actions as part of partial progress).\r\n\r\n\r\nThe other place in the code I would check would be:\r\n- [`RewriteDataFiles`](https://github.com/apache/iceberg/blob/master/api/src/main/java/org/apache/iceberg/actions/RewriteDataFiles.java) - Has good documentation for each of those configuration values.\r\n- [The unit tests, specifically `TestRewriteDataFilesAction`](https://github.com/apache/iceberg/blob/master/spark/v3.2/spark/src/test/java/org/apache/iceberg/spark/actions/TestRewriteDataFilesAction.java) - The unit tests are often a very good source of information on different options and expected behavior.\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138828561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138851351","html_url":"https://github.com/apache/iceberg/issues/4805#issuecomment-1138851351","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4805","id":1138851351,"node_id":"IC_kwDOCW7NX85D4X4X","user":{"login":"samredai","id":43911210,"node_id":"MDQ6VXNlcjQzOTExMjEw","avatar_url":"https://avatars.githubusercontent.com/u/43911210?v=4","gravatar_id":"","url":"https://api.github.com/users/samredai","html_url":"https://github.com/samredai","followers_url":"https://api.github.com/users/samredai/followers","following_url":"https://api.github.com/users/samredai/following{/other_user}","gists_url":"https://api.github.com/users/samredai/gists{/gist_id}","starred_url":"https://api.github.com/users/samredai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samredai/subscriptions","organizations_url":"https://api.github.com/users/samredai/orgs","repos_url":"https://api.github.com/users/samredai/repos","events_url":"https://api.github.com/users/samredai/events{/privacy}","received_events_url":"https://api.github.com/users/samredai/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T17:51:55Z","updated_at":"2022-05-26T17:51:55Z","author_association":"CONTRIBUTOR","body":"@pvary I've added the configuration properties to the other PR #4801. Can you open a PR to add the Type Compatibility and DDL sections to the hive page? The DDL support table at the top of the PDF can probably be placed in the beginning of the DDL section instead of \"Getting Started\". Once that's in, it would be great if you could add a quickstart for Hive. I'll play around with the `hive-dev-box` docker image, is this an official image that makes sense to use in a published quickstart?","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138851351/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138851480","html_url":"https://github.com/apache/iceberg/issues/4875#issuecomment-1138851480","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4875","id":1138851480,"node_id":"IC_kwDOCW7NX85D4X6Y","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T17:52:04Z","updated_at":"2022-05-26T17:56:27Z","author_association":"CONTRIBUTOR","body":"Lastly, all of that frequent committing that is generating small files would likely be easier to manage if you _also_ ran the `RewriteManifests` action. This will rewrite the Iceberg metadata manifests, packing them into larger files. This will reduce the time spent on planning, as likely your metadata has also gotten larger.\r\n\r\nI'll leave you with the link to the Spark SQL stored procedure, https://iceberg.apache.org/docs/latest/spark-procedures/#rewrite_manifests, but I would similarly encourage you to check out the code for further options and understanding of how it works given the scale of your table.\r\n\r\nLastly, I usually advocate for writing the data out as \"correctly\" as possible the first time. In this case, I don't think that's _entirely_ possible (and table maintenance is a fact of life with Iceberg), but if you reduce your Flink jobs commit interval just slightly, you'll likely see _significantly_ faster performance speed up. You should also try setting the write distrribution mode.\r\n\r\nIf your Flink job shuffles data to the same task manager for similar output, you'll potentially wind up with fewer files.\r\n\r\nI'd suggest starting from https://iceberg.apache.org/docs/latest/configuration/#write-properties (looking at `write.distribution.mode`), as well as looking for a larger summary in the relevant file for that configuration value, https://github.com/apache/iceberg/blob/master/api/src/main/java/org/apache/iceberg/DistributionMode.java.\r\n\r\nThe PR for adding `write.distribution.mode` support to Flink was added by openinx in https://github.com/apache/iceberg/commit/c75ac359c1de6bf9fd4894b40009c5c42d2fee9d, which might also be of interest to you to see the Flink specific behavior and any caveats. By shuffling the data for each partition to one task manager on write (or a handful of them potentially), then you'll see fewer smaller files with fewer writers for each partition.\r\n\r\nBut I think the _biggest_ thinig to help you, given that your rewrite tasks are all taking about a minute, would be to parallelize (as you tried), but via `partial-progress.enabled` and `max-concurrent-file-group-rewrites`. This will likely leave the job with the same CPU time in total, but will reduce the wall clock run time of the job significantly. That and using `write.distribution.mode` to produce fewer small files to start with (as called out in the javadoc comment for the `DistributionMode` enum). Plus committing with Flink every 2 minutes or even minute and a half instead of 1 minute will likely help a good bit and for most use cases the additional latency of 1 minute really isn't that much.\r\n\r\nBest of luck and please let me know if / when we can close this issue!","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138851480/reactions","total_count":4,"+1":4,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138858770","html_url":"https://github.com/apache/iceberg/issues/4875#issuecomment-1138858770","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4875","id":1138858770,"node_id":"IC_kwDOCW7NX85D4ZsS","user":{"login":"RussellSpitzer","id":413025,"node_id":"MDQ6VXNlcjQxMzAyNQ==","avatar_url":"https://avatars.githubusercontent.com/u/413025?v=4","gravatar_id":"","url":"https://api.github.com/users/RussellSpitzer","html_url":"https://github.com/RussellSpitzer","followers_url":"https://api.github.com/users/RussellSpitzer/followers","following_url":"https://api.github.com/users/RussellSpitzer/following{/other_user}","gists_url":"https://api.github.com/users/RussellSpitzer/gists{/gist_id}","starred_url":"https://api.github.com/users/RussellSpitzer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RussellSpitzer/subscriptions","organizations_url":"https://api.github.com/users/RussellSpitzer/orgs","repos_url":"https://api.github.com/users/RussellSpitzer/repos","events_url":"https://api.github.com/users/RussellSpitzer/events{/privacy}","received_events_url":"https://api.github.com/users/RussellSpitzer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T17:55:45Z","updated_at":"2022-05-26T17:55:45Z","author_association":"MEMBER","body":"Agree with @kbendick , Max-concurrent-file-group rewrites alone should be boosted up and that would give you way better performance. It defaults to 1, which is very good if you have very large partitions with lots of big data files, but bad if you have tons of very small partitions with very small data files.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138858770/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138859024","html_url":"https://github.com/apache/iceberg/issues/4875#issuecomment-1138859024","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4875","id":1138859024,"node_id":"IC_kwDOCW7NX85D4ZwQ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T17:55:51Z","updated_at":"2022-05-26T17:55:51Z","author_association":"CONTRIBUTOR","body":"Also, if you can eventually handle it, you can set your `target-file-size-bytes` to a slightly larger value if you add a sort key to the table.\r\n\r\nThis will make the rewrite job much more expensive, as you'll have to sort, although `write.distribution.mode` can help with that as `range` distribution will use the sort key.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138859024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138884615","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1138884615","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1138884615,"node_id":"IC_kwDOCW7NX85D4gAH","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T18:26:50Z","updated_at":"2022-05-26T18:27:53Z","author_association":"CONTRIBUTOR","body":"> @kbendick\r\n> \r\n> > Is there a reason that the files have to be 1MB?\r\n> \r\n> There is a streaming ingest job, it will create much small files.\r\n> \r\n> > But I think if you compacted files you probably wouldn’t have such issues during scan planning.\r\n> > Do you run table maintenance actions on your table?\r\n> \r\n> I have run `rewrite-files` action once a day. Ideally, reducing the interval may bypass this issue. But bypassing this issue requires carefully considering jvm heap configuration with existing small files.\r\n\r\nEven for streaming ingest, there are ways to make the small files problem better. For example, if you're ingesting with Flink, you can increase the time between commits. Or you can also play with `write.distribution.mode` to try to send data to the correct writer before generating the files. Which might reduce the overall number of files you have.\r\n\r\nBut if files are only 1MB, even if there's a large amount of data per partition, that is imho by definition going to encounter many of the common problems that encompass the \"small files problem\".","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138884615/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138888793","html_url":"https://github.com/apache/iceberg/pull/4596#issuecomment-1138888793","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4596","id":1138888793,"node_id":"IC_kwDOCW7NX85D4hBZ","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T18:32:09Z","updated_at":"2022-05-26T18:32:09Z","author_association":"CONTRIBUTOR","body":"Also, for compacting small files (as well as avoiding small files in ingest), I just wrote a somewhat in depth summary in this issue that might be relevant to your streaming ingest (and data file rewrite operations): https://github.com/apache/iceberg/issues/4875","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138888793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138891221","html_url":"https://github.com/apache/iceberg/pull/4866#issuecomment-1138891221","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4866","id":1138891221,"node_id":"IC_kwDOCW7NX85D4hnV","user":{"login":"singhpk234","id":35593236,"node_id":"MDQ6VXNlcjM1NTkzMjM2","avatar_url":"https://avatars.githubusercontent.com/u/35593236?v=4","gravatar_id":"","url":"https://api.github.com/users/singhpk234","html_url":"https://github.com/singhpk234","followers_url":"https://api.github.com/users/singhpk234/followers","following_url":"https://api.github.com/users/singhpk234/following{/other_user}","gists_url":"https://api.github.com/users/singhpk234/gists{/gist_id}","starred_url":"https://api.github.com/users/singhpk234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/singhpk234/subscriptions","organizations_url":"https://api.github.com/users/singhpk234/orgs","repos_url":"https://api.github.com/users/singhpk234/repos","events_url":"https://api.github.com/users/singhpk234/events{/privacy}","received_events_url":"https://api.github.com/users/singhpk234/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T18:35:13Z","updated_at":"2022-05-26T18:35:13Z","author_association":"CONTRIBUTOR","body":"> Thanks @singhpk234. I appreciate you taking this off my plate for me.\r\n\r\nIt was pleasure :) !!!\r\n\r\n> Having the classes and functons ordered int he same way as they are listed in MetadataUpdate\r\n\r\nThis makes perfect sense, have addressed it along with the remaining feedbacks :).\r\n\r\nThanks for thorough review @kbendick !!! \r\n\r\n","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138891221/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138954434","html_url":"https://github.com/apache/iceberg/pull/4795#issuecomment-1138954434","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4795","id":1138954434,"node_id":"IC_kwDOCW7NX85D4xDC","user":{"login":"CodingCat","id":678008,"node_id":"MDQ6VXNlcjY3ODAwOA==","avatar_url":"https://avatars.githubusercontent.com/u/678008?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingCat","html_url":"https://github.com/CodingCat","followers_url":"https://api.github.com/users/CodingCat/followers","following_url":"https://api.github.com/users/CodingCat/following{/other_user}","gists_url":"https://api.github.com/users/CodingCat/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingCat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingCat/subscriptions","organizations_url":"https://api.github.com/users/CodingCat/orgs","repos_url":"https://api.github.com/users/CodingCat/repos","events_url":"https://api.github.com/users/CodingCat/events{/privacy}","received_events_url":"https://api.github.com/users/CodingCat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T19:57:03Z","updated_at":"2022-05-26T19:57:03Z","author_association":"CONTRIBUTOR","body":"Hi, @rdblue , thanks for the reply\r\n\r\n> The approach you linked to doesn't work because that is in the SQLConf, which is at the session level. You'd need a separate session for every writer thread. If that's what you'd like to do, then we can help you get that feature in. Is that what you want?\r\n\r\nyes, this is pretty much what we did with delta lake, every thread creates a new SparkSession inherited from the parent one, and then add metadata in SQLConf...I am not a big fan of this approach since it imposed creation of a bunch of new SparkSessions across threads, that's also why I had the way in the current PR\r\n\r\n> \r\n> I think that we may want to introduce a different way than using write properties to set additional metadata, because of the SQL problem. We could add a way to pass this information, like this:\r\n> \r\n> ```java\r\n>   public class CommitMetadata {\r\n>     private static final ThreadLocal<Map<String, String>> COMMIT_PROPERTIES = ThreadLocal.withInitial(ImmutableMap::of);\r\n> \r\n>     public static <R> R withCommitProperties(Map<String, String> properties, Callable<R> callable) throws Exception {\r\n>       COMMIT_PROPERTIES.set(properties);\r\n>       try {\r\n>         return callable.call();\r\n>       } finally {\r\n>         COMMIT_PROPERTIES.set(ImmutableMap.of());\r\n>       }\r\n>     }\r\n> \r\n>     static Map<String, String> commitProperties() {\r\n>       return COMMIT_PROPERTIES.get();\r\n>     }\r\n>   }\r\n> ```\r\n> \r\n\r\nyeah, this looks neat! I can work on a PR for this","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1138954434/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139066764","html_url":"https://github.com/apache/iceberg/pull/4877#issuecomment-1139066764","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4877","id":1139066764,"node_id":"IC_kwDOCW7NX85D5MeM","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T21:17:22Z","updated_at":"2022-05-26T21:18:41Z","author_association":"CONTRIBUTOR","body":"It's worth noting that this changes only 4 lines of code that are in source files. The rest is in test files.\r\n\r\nI've checked those 4 lines for serialization concerns and there are none (other than the commented area in `BaseRewriteManifestsSparkAction`, which is already wrapped for Kryo serialization needs).","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139066764/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139073694","html_url":"https://github.com/apache/iceberg/pull/4428#issuecomment-1139073694","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4428","id":1139073694,"node_id":"IC_kwDOCW7NX85D5OKe","user":{"login":"amogh-jahagirdar","id":87500546,"node_id":"MDQ6VXNlcjg3NTAwNTQ2","avatar_url":"https://avatars.githubusercontent.com/u/87500546?v=4","gravatar_id":"","url":"https://api.github.com/users/amogh-jahagirdar","html_url":"https://github.com/amogh-jahagirdar","followers_url":"https://api.github.com/users/amogh-jahagirdar/followers","following_url":"https://api.github.com/users/amogh-jahagirdar/following{/other_user}","gists_url":"https://api.github.com/users/amogh-jahagirdar/gists{/gist_id}","starred_url":"https://api.github.com/users/amogh-jahagirdar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amogh-jahagirdar/subscriptions","organizations_url":"https://api.github.com/users/amogh-jahagirdar/orgs","repos_url":"https://api.github.com/users/amogh-jahagirdar/repos","events_url":"https://api.github.com/users/amogh-jahagirdar/events{/privacy}","received_events_url":"https://api.github.com/users/amogh-jahagirdar/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T21:24:21Z","updated_at":"2022-05-26T21:24:21Z","author_association":"CONTRIBUTOR","body":"Cool, I think for this PR I'll just add the refs() related APIS to Table. Will do the other PRs separately.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139073694/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139107853","html_url":"https://github.com/apache/iceberg/pull/4683#issuecomment-1139107853","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4683","id":1139107853,"node_id":"IC_kwDOCW7NX85D5WgN","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T22:18:28Z","updated_at":"2022-05-26T22:18:28Z","author_association":"CONTRIBUTOR","body":"This looks close to me. I'd switch to an explicit call to set the `_deleted` value to avoid any assumptions about default values.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139107853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139108197","html_url":"https://github.com/apache/iceberg/pull/4645#issuecomment-1139108197","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4645","id":1139108197,"node_id":"IC_kwDOCW7NX85D5Wll","user":{"login":"szehon-ho","id":20555759,"node_id":"MDQ6VXNlcjIwNTU1NzU5","avatar_url":"https://avatars.githubusercontent.com/u/20555759?v=4","gravatar_id":"","url":"https://api.github.com/users/szehon-ho","html_url":"https://github.com/szehon-ho","followers_url":"https://api.github.com/users/szehon-ho/followers","following_url":"https://api.github.com/users/szehon-ho/following{/other_user}","gists_url":"https://api.github.com/users/szehon-ho/gists{/gist_id}","starred_url":"https://api.github.com/users/szehon-ho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szehon-ho/subscriptions","organizations_url":"https://api.github.com/users/szehon-ho/orgs","repos_url":"https://api.github.com/users/szehon-ho/repos","events_url":"https://api.github.com/users/szehon-ho/events{/privacy}","received_events_url":"https://api.github.com/users/szehon-ho/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T22:19:05Z","updated_at":"2022-05-26T22:19:05Z","author_association":"COLLABORATOR","body":"Thanks @felixYyu for contribution, all for the review","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139108197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139109541","html_url":"https://github.com/apache/iceberg/pull/4853#issuecomment-1139109541","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4853","id":1139109541,"node_id":"IC_kwDOCW7NX85D5W6l","user":{"login":"kbendick","id":9833362,"node_id":"MDQ6VXNlcjk4MzMzNjI=","avatar_url":"https://avatars.githubusercontent.com/u/9833362?v=4","gravatar_id":"","url":"https://api.github.com/users/kbendick","html_url":"https://github.com/kbendick","followers_url":"https://api.github.com/users/kbendick/followers","following_url":"https://api.github.com/users/kbendick/following{/other_user}","gists_url":"https://api.github.com/users/kbendick/gists{/gist_id}","starred_url":"https://api.github.com/users/kbendick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kbendick/subscriptions","organizations_url":"https://api.github.com/users/kbendick/orgs","repos_url":"https://api.github.com/users/kbendick/repos","events_url":"https://api.github.com/users/kbendick/events{/privacy}","received_events_url":"https://api.github.com/users/kbendick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T22:21:44Z","updated_at":"2022-05-26T22:22:04Z","author_association":"CONTRIBUTOR","body":"You might want to rename this PR to `Flink - Modify Table Location Strings in Tests to Fix Local Test Failures`.\r\n\r\nYou'll probably get more eyes that way 👍  cc @wuwenchi","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139109541/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139111519","html_url":"https://github.com/apache/iceberg/pull/4847#issuecomment-1139111519","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4847","id":1139111519,"node_id":"IC_kwDOCW7NX85D5XZf","user":{"login":"aokolnychyi","id":6235869,"node_id":"MDQ6VXNlcjYyMzU4Njk=","avatar_url":"https://avatars.githubusercontent.com/u/6235869?v=4","gravatar_id":"","url":"https://api.github.com/users/aokolnychyi","html_url":"https://github.com/aokolnychyi","followers_url":"https://api.github.com/users/aokolnychyi/followers","following_url":"https://api.github.com/users/aokolnychyi/following{/other_user}","gists_url":"https://api.github.com/users/aokolnychyi/gists{/gist_id}","starred_url":"https://api.github.com/users/aokolnychyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aokolnychyi/subscriptions","organizations_url":"https://api.github.com/users/aokolnychyi/orgs","repos_url":"https://api.github.com/users/aokolnychyi/repos","events_url":"https://api.github.com/users/aokolnychyi/events{/privacy}","received_events_url":"https://api.github.com/users/aokolnychyi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-26T22:25:32Z","updated_at":"2022-05-26T22:25:32Z","author_association":"CONTRIBUTOR","body":"Let me take a look.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139111519/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139161258","html_url":"https://github.com/apache/iceberg/pull/4831#issuecomment-1139161258","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4831","id":1139161258,"node_id":"IC_kwDOCW7NX85D5jiq","user":{"login":"rdblue","id":87915,"node_id":"MDQ6VXNlcjg3OTE1","avatar_url":"https://avatars.githubusercontent.com/u/87915?v=4","gravatar_id":"","url":"https://api.github.com/users/rdblue","html_url":"https://github.com/rdblue","followers_url":"https://api.github.com/users/rdblue/followers","following_url":"https://api.github.com/users/rdblue/following{/other_user}","gists_url":"https://api.github.com/users/rdblue/gists{/gist_id}","starred_url":"https://api.github.com/users/rdblue/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdblue/subscriptions","organizations_url":"https://api.github.com/users/rdblue/orgs","repos_url":"https://api.github.com/users/rdblue/repos","events_url":"https://api.github.com/users/rdblue/events{/privacy}","received_events_url":"https://api.github.com/users/rdblue/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-27T00:02:28Z","updated_at":"2022-05-27T00:02:28Z","author_association":"CONTRIBUTOR","body":"Thanks for working on this, @huaxingao! It looks close overall.\r\n\r\nDoes it make sense to split this into separate read and write PRs? It seems like adding the evaluator is quite a lot to review independently, and we don't need the write path for its tests.","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139161258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139168635","html_url":"https://github.com/apache/iceberg/pull/4879#issuecomment-1139168635","issue_url":"https://api.github.com/repos/apache/iceberg/issues/4879","id":1139168635,"node_id":"IC_kwDOCW7NX85D5lV7","user":{"login":"felixYyu","id":3785228,"node_id":"MDQ6VXNlcjM3ODUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/3785228?v=4","gravatar_id":"","url":"https://api.github.com/users/felixYyu","html_url":"https://github.com/felixYyu","followers_url":"https://api.github.com/users/felixYyu/followers","following_url":"https://api.github.com/users/felixYyu/following{/other_user}","gists_url":"https://api.github.com/users/felixYyu/gists{/gist_id}","starred_url":"https://api.github.com/users/felixYyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixYyu/subscriptions","organizations_url":"https://api.github.com/users/felixYyu/orgs","repos_url":"https://api.github.com/users/felixYyu/repos","events_url":"https://api.github.com/users/felixYyu/events{/privacy}","received_events_url":"https://api.github.com/users/felixYyu/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-05-27T00:21:47Z","updated_at":"2022-05-27T00:21:47Z","author_association":"CONTRIBUTOR","body":"cc: @szehon-ho @kbendick  @RussellSpitzer ","reactions":{"url":"https://api.github.com/repos/apache/iceberg/issues/comments/1139168635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}]